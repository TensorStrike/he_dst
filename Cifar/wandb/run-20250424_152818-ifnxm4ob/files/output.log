


================================================================================

Iteration start: 1/1

==> Preparing data..
Files already downloaded and verified
Files already downloaded and verified
model ResNet50
Growth mode: global_gradients not supported!
Supported modes are: ['random', 'momentum', 'momentum_neuron', 'gradient']
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (3): Bottleneck(
      (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (3): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (4): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (5): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (classifier): Linear(in_features=2048, out_features=100, bias=False)
)
add module
Removing biases...
Removed 53 layers.
Removing 2D batch norms...
Removing bn1 of size torch.Size([64]) = 64 parameters.
Removing layer1.0.bn1 of size torch.Size([64]) = 64 parameters.
Removing layer1.0.bn2 of size torch.Size([64]) = 64 parameters.
Removing layer1.0.bn3 of size torch.Size([256]) = 256 parameters.
Removing layer1.0.shortcut.1 of size torch.Size([256]) = 256 parameters.
Removing layer1.1.bn1 of size torch.Size([64]) = 64 parameters.
Removing layer1.1.bn2 of size torch.Size([64]) = 64 parameters.
Removing layer1.1.bn3 of size torch.Size([256]) = 256 parameters.
Removing layer1.2.bn1 of size torch.Size([64]) = 64 parameters.
Removing layer1.2.bn2 of size torch.Size([64]) = 64 parameters.
Removing layer1.2.bn3 of size torch.Size([256]) = 256 parameters.
Removing layer2.0.bn1 of size torch.Size([128]) = 128 parameters.
Removing layer2.0.bn2 of size torch.Size([128]) = 128 parameters.
Removing layer2.0.bn3 of size torch.Size([512]) = 512 parameters.
Removing layer2.0.shortcut.1 of size torch.Size([512]) = 512 parameters.
Removing layer2.1.bn1 of size torch.Size([128]) = 128 parameters.
Removing layer2.1.bn2 of size torch.Size([128]) = 128 parameters.
Removing layer2.1.bn3 of size torch.Size([512]) = 512 parameters.
Removing layer2.2.bn1 of size torch.Size([128]) = 128 parameters.
Removing layer2.2.bn2 of size torch.Size([128]) = 128 parameters.
Removing layer2.2.bn3 of size torch.Size([512]) = 512 parameters.
Removing layer2.3.bn1 of size torch.Size([128]) = 128 parameters.
Removing layer2.3.bn2 of size torch.Size([128]) = 128 parameters.
Removing layer2.3.bn3 of size torch.Size([512]) = 512 parameters.
Removing layer3.0.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.0.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.0.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.0.shortcut.1 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.1.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.1.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.1.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.2.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.2.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.2.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.3.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.3.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.3.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.4.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.4.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.4.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.5.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.5.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.5.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer4.0.bn1 of size torch.Size([512]) = 512 parameters.
Removing layer4.0.bn2 of size torch.Size([512]) = 512 parameters.
Removing layer4.0.bn3 of size torch.Size([2048]) = 2048 parameters.
Removing layer4.0.shortcut.1 of size torch.Size([2048]) = 2048 parameters.
Removing layer4.1.bn1 of size torch.Size([512]) = 512 parameters.
Removing layer4.1.bn2 of size torch.Size([512]) = 512 parameters.
Removing layer4.1.bn3 of size torch.Size([2048]) = 2048 parameters.
Removing layer4.2.bn1 of size torch.Size([512]) = 512 parameters.
Removing layer4.2.bn2 of size torch.Size([512]) = 512 parameters.
Removing layer4.2.bn3 of size torch.Size([2048]) = 2048 parameters.
Removing 1D batch norms...
baseline fitler num 7552
initialize by fixed_ERK
Sparsity of var:conv1.weight had to be set to 0.
Sparsity of var:layer1.0.conv1.weight had to be set to 0.
layer: conv1.weight, shape: torch.Size([64, 3, 3, 3]), density: 1.0
layer: layer1.0.conv1.weight, shape: torch.Size([64, 64, 1, 1]), density: 1.0
layer: layer1.0.conv2.weight, shape: torch.Size([64, 64, 3, 3]), density: 0.16747319723795276
layer: layer1.0.conv3.weight, shape: torch.Size([256, 64, 1, 1]), density: 0.9054800850663938
layer: layer1.0.shortcut.0.weight, shape: torch.Size([256, 64, 1, 1]), density: 0.9054800850663938
layer: layer1.1.conv1.weight, shape: torch.Size([64, 256, 1, 1]), density: 0.9054800850663938
layer: layer1.1.conv2.weight, shape: torch.Size([64, 64, 3, 3]), density: 0.16747319723795276
layer: layer1.1.conv3.weight, shape: torch.Size([256, 64, 1, 1]), density: 0.9054800850663938
layer: layer1.2.conv1.weight, shape: torch.Size([64, 256, 1, 1]), density: 0.9054800850663938
layer: layer1.2.conv2.weight, shape: torch.Size([64, 64, 3, 3]), density: 0.16747319723795276
layer: layer1.2.conv3.weight, shape: torch.Size([256, 64, 1, 1]), density: 0.9054800850663938
layer: layer2.0.conv1.weight, shape: torch.Size([128, 256, 1, 1]), density: 0.5427256410491118
layer: layer2.0.conv2.weight, shape: torch.Size([128, 128, 3, 3]), density: 0.08186189864989481
layer: layer2.0.conv3.weight, shape: torch.Size([512, 128, 1, 1]), density: 0.4513340175563857
layer: layer2.0.shortcut.0.weight, shape: torch.Size([512, 256, 1, 1]), density: 0.2706598080361503
layer: layer2.1.conv1.weight, shape: torch.Size([128, 512, 1, 1]), density: 0.4513340175563857
layer: layer2.1.conv2.weight, shape: torch.Size([128, 128, 3, 3]), density: 0.08186189864989481
layer: layer2.1.conv3.weight, shape: torch.Size([512, 128, 1, 1]), density: 0.4513340175563857
layer: layer2.2.conv1.weight, shape: torch.Size([128, 512, 1, 1]), density: 0.4513340175563857
layer: layer2.2.conv2.weight, shape: torch.Size([128, 128, 3, 3]), density: 0.08186189864989481
layer: layer2.2.conv3.weight, shape: torch.Size([512, 128, 1, 1]), density: 0.4513340175563857
layer: layer2.3.conv1.weight, shape: torch.Size([128, 512, 1, 1]), density: 0.4513340175563857
layer: layer2.3.conv2.weight, shape: torch.Size([128, 128, 3, 3]), density: 0.08186189864989481
layer: layer2.3.conv3.weight, shape: torch.Size([512, 128, 1, 1]), density: 0.4513340175563857
layer: layer3.0.conv1.weight, shape: torch.Size([256, 512, 1, 1]), density: 0.2706598080361503
layer: layer3.0.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.0.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer3.0.shortcut.0.weight, shape: torch.Size([1024, 512, 1, 1]), density: 0.13515415089597377
layer: layer3.1.conv1.weight, shape: torch.Size([256, 1024, 1, 1]), density: 0.22531550253399008
layer: layer3.1.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.1.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer3.2.conv1.weight, shape: torch.Size([256, 1024, 1, 1]), density: 0.22531550253399008
layer: layer3.2.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.2.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer3.3.conv1.weight, shape: torch.Size([256, 1024, 1, 1]), density: 0.22531550253399008
layer: layer3.3.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.3.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer3.4.conv1.weight, shape: torch.Size([256, 1024, 1, 1]), density: 0.22531550253399008
layer: layer3.4.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.4.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer3.5.conv1.weight, shape: torch.Size([256, 1024, 1, 1]), density: 0.22531550253399008
layer: layer3.5.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.5.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer4.0.conv1.weight, shape: torch.Size([512, 1024, 1, 1]), density: 0.13515415089597377
layer: layer4.0.conv2.weight, shape: torch.Size([512, 512, 3, 3]), density: 0.02011396841827091
layer: layer4.0.conv3.weight, shape: torch.Size([2048, 512, 1, 1]), density: 0.11256987470594433
layer: layer4.0.shortcut.0.weight, shape: torch.Size([2048, 1024, 1, 1]), density: 0.06753313716746152
layer: layer4.1.conv1.weight, shape: torch.Size([512, 2048, 1, 1]), density: 0.11256987470594433
layer: layer4.1.conv2.weight, shape: torch.Size([512, 512, 3, 3]), density: 0.02011396841827091
layer: layer4.1.conv3.weight, shape: torch.Size([2048, 512, 1, 1]), density: 0.11256987470594433
layer: layer4.2.conv1.weight, shape: torch.Size([512, 2048, 1, 1]), density: 0.11256987470594433
layer: layer4.2.conv2.weight, shape: torch.Size([512, 512, 3, 3]), density: 0.02011396841827091
layer: layer4.2.conv3.weight, shape: torch.Size([2048, 512, 1, 1]), density: 0.11256987470594433
layer: classifier.weight, shape: torch.Size([100, 2048]), density: 0.48322266403046304
Overall sparsity 0.10000000000000005
conv1.weight 1728
layer1.0.conv1.weight 4096
layer1.0.conv2.weight 36864
layer1.0.conv3.weight 16384
layer1.0.shortcut.0.weight 16384
layer1.1.conv1.weight 16384
layer1.1.conv2.weight 36864
layer1.1.conv3.weight 16384
layer1.2.conv1.weight 16384
layer1.2.conv2.weight 36864
layer1.2.conv3.weight 16384
layer2.0.conv1.weight 32768
layer2.0.conv2.weight 147456
layer2.0.conv3.weight 65536
layer2.0.shortcut.0.weight 131072
layer2.1.conv1.weight 65536
layer2.1.conv2.weight 147456
layer2.1.conv3.weight 65536
layer2.2.conv1.weight 65536
layer2.2.conv2.weight 147456
layer2.2.conv3.weight 65536
layer2.3.conv1.weight 65536
layer2.3.conv2.weight 147456
layer2.3.conv3.weight 65536
layer3.0.conv1.weight 131072
layer3.0.conv2.weight 589824
layer3.0.conv3.weight 262144
layer3.0.shortcut.0.weight 524288
layer3.1.conv1.weight 262144
layer3.1.conv2.weight 589824
layer3.1.conv3.weight 262144
layer3.2.conv1.weight 262144
layer3.2.conv2.weight 589824
layer3.2.conv3.weight 262144
layer3.3.conv1.weight 262144
layer3.3.conv2.weight 589824
layer3.3.conv3.weight 262144
layer3.4.conv1.weight 262144
layer3.4.conv2.weight 589824
layer3.4.conv3.weight 262144
layer3.5.conv1.weight 262144
layer3.5.conv2.weight 589824
layer3.5.conv3.weight 262144
layer4.0.conv1.weight 524288
layer4.0.conv2.weight 2359296
layer4.0.conv3.weight 1048576
layer4.0.shortcut.0.weight 2097152
layer4.1.conv1.weight 1048576
layer4.1.conv2.weight 2359296
layer4.1.conv3.weight 1048576
layer4.2.conv1.weight 1048576
layer4.2.conv2.weight 2359296
layer4.2.conv3.weight 1048576
classifier.weight 204800
Total Model parameters after init: 2367257 23652032
Total parameters under sparsity level of 0.1: 0.10008683397688621
save_dir ./Chase_models/saved_models/test/density_0.1/stop_gmp_epochs_130/epoch_160/layer_interval_1000/start_layer_rate_0.5
=====================================
begin pre training
Train Epoch: 0 [0/50000 (0%)]	Loss: 4.644441 Accuracy: 0/100 (0.000%
Train Epoch: 0 [10000/50000 (20%)]	Loss: 4.529919 Accuracy: 160/10100 (1.584%
Train Epoch: 0 [20000/50000 (40%)]	Loss: 4.192526 Accuracy: 463/20100 (2.303%
Train Epoch: 0 [30000/50000 (60%)]	Loss: 4.062226 Accuracy: 957/30100 (3.179%
Train Epoch: 0 [40000/50000 (80%)]	Loss: 4.016282 Accuracy: 1642/40100 (4.095%
current layer rate 0.011449931725079632
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 7552.0
Total filter_masks items: 20676608.0
7552.0 / 7552 channels
Total channels to prune: 86.46988438780136
Layer ('layer2', 0, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 5/512.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 5/512.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 5/512.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 5/512.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 5/512.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 5/512.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 7490.0
Total filter_masks items: 20391071.0
After apply_mask:
Total filter_names items: 7490.0
Total filter_masks items: 20391071.0
Total pruned: 62/86.46988438780136 channels
===========done ===============

Training summary: Average loss: 4.3611, Accuracy: 2417/50000 (4.834%)


Evaluation: Average loss: 3.8575, Accuracy: 953/10000 (9.530%)

Current learning rate: 0.1. Time taken for epoch: 91.44 seconds.

Train Epoch: 1 [0/50000 (0%)]	Loss: 3.765250 Accuracy: 15/100 (15.000%
Train Epoch: 1 [10000/50000 (20%)]	Loss: 3.769640 Accuracy: 996/10100 (9.861%
Train Epoch: 1 [20000/50000 (40%)]	Loss: 3.703591 Accuracy: 2087/20100 (10.383%
Train Epoch: 1 [30000/50000 (60%)]	Loss: 3.567615 Accuracy: 3307/30100 (10.987%
Train Epoch: 1 [40000/50000 (80%)]	Loss: 3.543716 Accuracy: 4728/40100 (11.791%
current mest  death_rate 0.14997080567080823


dynamic sparse change prune
to kill -17568.200000001118 expect 2365203.200000001
conv1.weight, mask/weight parameters,1728,1728 density 1.0,1.0
before tensor 4096 mask 4096.0 4096
layer1.0.conv1.weight, mask/weight parameters,4096,4096 density 1.0,1.0
before tensor 36864 mask 6206.0 36864
layer1.0.conv2.weight, mask/weight parameters,6206,6206 density 0.16834852430555555,0.16834852430555555
before tensor 16384 mask 14835.0 16384
layer1.0.conv3.weight, mask/weight parameters,14835,14835 density 0.90545654296875,0.90545654296875
layer1.0.shortcut.0.weight, mask/weight parameters,14829,14829 density 0.90509033203125,0.90509033203125
before tensor 16384 mask 14823.0 16384
layer1.1.conv1.weight, mask/weight parameters,14823,14823 density 0.90472412109375,0.90472412109375
before tensor 36864 mask 6155.0 36864
layer1.1.conv2.weight, mask/weight parameters,6155,6155 density 0.1669650607638889,0.1669650607638889
before tensor 16384 mask 14857.0 16384
layer1.1.conv3.weight, mask/weight parameters,14857,14857 density 0.90679931640625,0.90679931640625
before tensor 16384 mask 14849.0 16384
layer1.2.conv1.weight, mask/weight parameters,14849,14849 density 0.90631103515625,0.90631103515625
before tensor 36864 mask 6104.0 36864
layer1.2.conv2.weight, mask/weight parameters,6104,6104 density 0.1655815972222222,0.1655815972222222
before tensor 16384 mask 14785.0 16384
layer1.2.conv3.weight, mask/weight parameters,14785,14785 density 0.90240478515625,0.90240478515625
before tensor 32768 mask 17692.0 32768
layer2.0.conv1.weight, mask/weight parameters,17692,17692 density 0.5441683070866141,0.5441683070866141
before tensor 147456 mask 11934.0 147456
layer2.0.conv2.weight, mask/weight parameters,11934,11934 density 0.08221216442432885,0.08221216442432885
before tensor 65536 mask 29297.0 65536
layer2.0.conv3.weight, mask/weight parameters,29297,29297 density 0.450556717519685,0.450556717519685
layer2.0.shortcut.0.weight, mask/weight parameters,35383,35383 density 0.26995086669921875,0.26995086669921875
before tensor 65536 mask 29272.0 65536
layer2.1.conv1.weight, mask/weight parameters,29272,29272 density 0.4501722440944882,0.4501722440944882
before tensor 147456 mask 11892.0 147456
layer2.1.conv2.weight, mask/weight parameters,11892,11892 density 0.0819228305123277,0.0819228305123277
before tensor 65536 mask 29353.0 65536
layer2.1.conv3.weight, mask/weight parameters,29353,29353 density 0.451417937992126,0.451417937992126
before tensor 65536 mask 29553.0 65536
layer2.2.conv1.weight, mask/weight parameters,29553,29553 density 0.4544937253937008,0.4544937253937008
before tensor 147456 mask 11902.0 147456
layer2.2.conv2.weight, mask/weight parameters,11902,11902 density 0.08199171953899463,0.08199171953899463
before tensor 65536 mask 29274.0 65536
layer2.2.conv3.weight, mask/weight parameters,29274,29274 density 0.45020300196850394,0.45020300196850394
before tensor 65536 mask 29332.0 65536
layer2.3.conv1.weight, mask/weight parameters,29332,29332 density 0.45109498031496065,0.45109498031496065
before tensor 147456 mask 11952.0 147456
layer2.3.conv2.weight, mask/weight parameters,11952,11952 density 0.08233616467232935,0.08233616467232935
before tensor 65536 mask 29449.0 65536
layer2.3.conv3.weight, mask/weight parameters,29449,29449 density 0.4528943159448819,0.4528943159448819
before tensor 131072 mask 35241.0 131072
layer3.0.conv1.weight, mask/weight parameters,35241,35241 density 0.2709845595472441,0.2709845595472441
before tensor 589824 mask 23587.0 589824
layer3.0.conv2.weight, mask/weight parameters,23587,23587 density 0.04062213679982916,0.04062213679982916
before tensor 262144 mask 58685.0 262144
layer3.0.conv3.weight, mask/weight parameters,58685,58685 density 0.22562822957677164,0.22562822957677164
layer3.0.shortcut.0.weight, mask/weight parameters,70817,70817 density 0.1350727081298828,0.1350727081298828
before tensor 262144 mask 58932.0 262144
layer3.1.conv1.weight, mask/weight parameters,58932,58932 density 0.22657787893700787,0.22657787893700787
before tensor 589824 mask 23628.0 589824
layer3.1.conv2.weight, mask/weight parameters,23628,23628 density 0.04069274805216277,0.04069274805216277
before tensor 262144 mask 58414.0 262144
layer3.1.conv3.weight, mask/weight parameters,58414,58414 density 0.2245863065944882,0.2245863065944882
before tensor 262144 mask 58149.0 262144
layer3.2.conv1.weight, mask/weight parameters,58149,58149 density 0.22356745201771652,0.22356745201771652
before tensor 589824 mask 23173.0 589824
layer3.2.conv2.weight, mask/weight parameters,23173,23173 density 0.0399091353738263,0.0399091353738263
before tensor 262144 mask 58843.0 262144
layer3.2.conv3.weight, mask/weight parameters,58843,58843 density 0.22623569758858267,0.22623569758858267
before tensor 262144 mask 58715.0 262144
layer3.3.conv1.weight, mask/weight parameters,58715,58715 density 0.2257435716043307,0.2257435716043307
before tensor 589824 mask 23623.0 589824
layer3.3.conv2.weight, mask/weight parameters,23623,23623 density 0.040684136923829405,0.040684136923829405
before tensor 262144 mask 58988.0 262144
layer3.3.conv3.weight, mask/weight parameters,58988,58988 density 0.2267931840551181,0.2267931840551181
before tensor 262144 mask 58597.0 262144
layer3.4.conv1.weight, mask/weight parameters,58597,58597 density 0.22528989296259844,0.22528989296259844
before tensor 589824 mask 23567.0 589824
layer3.4.conv2.weight, mask/weight parameters,23567,23567 density 0.04058769228649568,0.04058769228649568
before tensor 262144 mask 58081.0 262144
layer3.4.conv3.weight, mask/weight parameters,58081,58081 density 0.22330601008858267,0.22330601008858267
before tensor 262144 mask 58643.0 262144
layer3.5.conv1.weight, mask/weight parameters,58643,58643 density 0.22546675073818898,0.22546675073818898
before tensor 589824 mask 23542.0 589824
layer3.5.conv2.weight, mask/weight parameters,23542,23542 density 0.040544636644828845,0.040544636644828845
before tensor 262144 mask 58630.0 262144
layer3.5.conv3.weight, mask/weight parameters,58630,58630 density 0.2254167691929134,0.2254167691929134
before tensor 524288 mask 70097.0 524288
layer4.0.conv1.weight, mask/weight parameters,70097,70097 density 0.13501795179980275,0.13501795179980275
before tensor 2359296 mask 47060.0 2359296
layer4.0.conv2.weight, mask/weight parameters,47060,47060 density 0.0203419927285805,0.0203419927285805
before tensor 1048576 mask 116928.0 1048576
layer4.0.conv3.weight, mask/weight parameters,116928,116928 density 0.11261094674556213,0.11261094674556213
layer4.0.shortcut.0.weight, mask/weight parameters,142133,142133 density 0.06777429580688477,0.06777429580688477
before tensor 1048576 mask 117414.0 1048576
layer4.1.conv1.weight, mask/weight parameters,117414,117414 density 0.11307900332840237,0.11307900332840237
before tensor 2359296 mask 46381.0 2359296
layer4.1.conv2.weight, mask/weight parameters,46381,46381 density 0.020048490538552746,0.020048490538552746
before tensor 1048576 mask 116881.0 1048576
layer4.1.conv3.weight, mask/weight parameters,116881,116881 density 0.1125656820142998,0.1125656820142998
before tensor 1048576 mask 116728.0 1048576
layer4.2.conv1.weight, mask/weight parameters,116728,116728 density 0.1124183308678501,0.1124183308678501
before tensor 2359296 mask 46547.0 2359296
layer4.2.conv2.weight, mask/weight parameters,46547,46547 density 0.020120245124038174,0.020120245124038174
before tensor 1048576 mask 117181.0 1048576
layer4.2.conv3.weight, mask/weight parameters,117181,117181 density 0.11285460583086784,0.11285460583086784
classifier.weight, mask/weight parameters,98878,98878 density 0.482802734375,0.482802734375
Total Model parameters after dst: 2347635 2347635
Total parameters under density level of 0.1: 0.10047013897463013 0.10047013897463013 after dst
Death rate: 0.14997080567080823

dynamic sparse change grow
self.total_params*pruning_rate 3547114.2947917376
self.total_nonzero 2347635.0
to grow 1199479.2947917376
len(all_scores) 23366495 21018860
increse 1199479.0 before_mask 3547113.0 after_mask 3547113.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1728,1728 density 1.0,1.0
before tensor 4096 mask 4096.0 4096
layer1.0.conv1.weight, mask/weight parameters,4096,4096 density 1.0,1.0
before tensor 36864 mask 7863.0 36864
layer1.0.conv2.weight, mask/weight parameters,7863,6206 density 0.21329752604166666,0.16834852430555555
before tensor 16384 mask 14942.0 16384
layer1.0.conv3.weight, mask/weight parameters,14942,14835 density 0.9119873046875,0.90545654296875
layer1.0.shortcut.0.weight, mask/weight parameters,14974,14829 density 0.9139404296875,0.90509033203125
before tensor 16384 mask 14835.0 16384
layer1.1.conv1.weight, mask/weight parameters,14835,14823 density 0.90545654296875,0.90472412109375
before tensor 36864 mask 6755.0 36864
layer1.1.conv2.weight, mask/weight parameters,6755,6155 density 0.18324110243055555,0.1669650607638889
before tensor 16384 mask 14907.0 16384
layer1.1.conv3.weight, mask/weight parameters,14907,14857 density 0.90985107421875,0.90679931640625
before tensor 16384 mask 14853.0 16384
layer1.2.conv1.weight, mask/weight parameters,14853,14849 density 0.90655517578125,0.90631103515625
before tensor 36864 mask 6656.0 36864
layer1.2.conv2.weight, mask/weight parameters,6656,6104 density 0.18055555555555555,0.1655815972222222
before tensor 16384 mask 14808.0 16384
layer1.2.conv3.weight, mask/weight parameters,14808,14785 density 0.90380859375,0.90240478515625
before tensor 32768 mask 18281.0 32768
layer2.0.conv1.weight, mask/weight parameters,18281,17692 density 0.5622846948818898,0.5441683070866141
before tensor 147456 mask 17923.0 147456
layer2.0.conv2.weight, mask/weight parameters,17923,11934 density 0.12346980249516054,0.08221216442432885
before tensor 65536 mask 30461.0 65536
layer2.0.conv3.weight, mask/weight parameters,30461,29297 density 0.4684578001968504,0.450556717519685
layer2.0.shortcut.0.weight, mask/weight parameters,44411,35383 density 0.33882904052734375,0.26995086669921875
before tensor 65536 mask 30531.0 65536
layer2.1.conv1.weight, mask/weight parameters,30531,29272 density 0.46953432578740156,0.4501722440944882
before tensor 147456 mask 19583.0 147456
layer2.1.conv2.weight, mask/weight parameters,19583,11892 density 0.13490538092187296,0.0819228305123277
before tensor 65536 mask 30584.0 65536
layer2.1.conv3.weight, mask/weight parameters,30584,29353 density 0.4703494094488189,0.451417937992126
before tensor 65536 mask 30022.0 65536
layer2.2.conv1.weight, mask/weight parameters,30022,29553 density 0.4617064468503937,0.4544937253937008
before tensor 147456 mask 16038.0 147456
layer2.2.conv2.weight, mask/weight parameters,16038,11902 density 0.11048422096844193,0.08199171953899463
before tensor 65536 mask 29911.0 65536
layer2.2.conv3.weight, mask/weight parameters,29911,29274 density 0.4599993848425197,0.45020300196850394
before tensor 65536 mask 29834.0 65536
layer2.3.conv1.weight, mask/weight parameters,29834,29332 density 0.45881520669291337,0.45109498031496065
before tensor 147456 mask 16952.0 147456
layer2.3.conv2.weight, mask/weight parameters,16952,11952 density 0.11678067800580046,0.08233616467232935
before tensor 65536 mask 30037.0 65536
layer2.3.conv3.weight, mask/weight parameters,30037,29449 density 0.4619371309055118,0.4528943159448819
before tensor 131072 mask 41283.0 131072
layer3.0.conv1.weight, mask/weight parameters,41283,35241 density 0.3174443282480315,0.2709845595472441
before tensor 589824 mask 72941.0 589824
layer3.0.conv2.weight, mask/weight parameters,72941,23587 density 0.12562086235283582,0.04062213679982916
before tensor 262144 mask 68673.0 262144
layer3.0.conv3.weight, mask/weight parameters,68673,58685 density 0.26402943528543305,0.22562822957677164
layer3.0.shortcut.0.weight, mask/weight parameters,94842,70817 density 0.18089675903320312,0.1350727081298828
before tensor 262144 mask 71259.0 262144
layer3.1.conv1.weight, mask/weight parameters,71259,58932 density 0.2739719180610236,0.22657787893700787
before tensor 589824 mask 168955.0 589824
layer3.1.conv2.weight, mask/weight parameters,168955,23628 density 0.2909786375128306,0.04069274805216277
before tensor 262144 mask 81795.0 262144
layer3.1.conv3.weight, mask/weight parameters,81795,58414 density 0.3144800381397638,0.2245863065944882
before tensor 262144 mask 74205.0 262144
layer3.2.conv1.weight, mask/weight parameters,74205,58149 density 0.28529850516732286,0.22356745201771652
before tensor 589824 mask 146946.0 589824
layer3.2.conv2.weight, mask/weight parameters,146946,23173 density 0.2530741728150123,0.0399091353738263
before tensor 262144 mask 73207.0 262144
layer3.2.conv3.weight, mask/weight parameters,73207,58843 density 0.2814614603838583,0.22623569758858267
before tensor 262144 mask 66529.0 262144
layer3.3.conv1.weight, mask/weight parameters,66529,58715 density 0.2557863250492126,0.2257435716043307
before tensor 589824 mask 89885.0 589824
layer3.3.conv2.weight, mask/weight parameters,89885,23623 density 0.15480225404895254,0.040684136923829405
before tensor 262144 mask 65472.0 262144
layer3.3.conv3.weight, mask/weight parameters,65472,58988 density 0.2517224409448819,0.2267931840551181
before tensor 262144 mask 62335.0 262144
layer3.4.conv1.weight, mask/weight parameters,62335,58597 density 0.23966150959645668,0.22528989296259844
before tensor 589824 mask 58658.0 589824
layer3.4.conv2.weight, mask/weight parameters,58658,23567 density 0.10102231315573743,0.04058769228649568
before tensor 262144 mask 61229.0 262144
layer3.4.conv3.weight, mask/weight parameters,61229,58081 density 0.23540923351377951,0.22330601008858267
before tensor 262144 mask 59830.0 262144
layer3.5.conv1.weight, mask/weight parameters,59830,58643 density 0.23003045029527558,0.22546675073818898
before tensor 589824 mask 34563.0 589824
layer3.5.conv2.weight, mask/weight parameters,34563,23542 density 0.0595252857172381,0.040544636644828845
before tensor 262144 mask 59866.0 262144
layer3.5.conv3.weight, mask/weight parameters,59866,58630 density 0.23016886072834647,0.2254167691929134
before tensor 524288 mask 72171.0 524288
layer4.0.conv1.weight, mask/weight parameters,72171,70097 density 0.1390128051035503,0.13501795179980275
before tensor 2359296 mask 70653.0 2359296
layer4.0.conv2.weight, mask/weight parameters,70653,47060 density 0.03054022125483209,0.0203419927285805
before tensor 1048576 mask 120601.0 1048576
layer4.0.conv3.weight, mask/weight parameters,120601,116928 density 0.11614833733974358,0.11261094674556213
layer4.0.shortcut.0.weight, mask/weight parameters,245398,142133 density 0.11701488494873047,0.06777429580688477
before tensor 1048576 mask 146527.0 1048576
layer4.1.conv1.weight, mask/weight parameters,146527,117414 density 0.14111713356755423,0.11307900332840237
before tensor 2359296 mask 354014.0 2359296
layer4.1.conv2.weight, mask/weight parameters,354014,46381 density 0.153024866421923,0.020048490538552746
before tensor 1048576 mask 167813.0 1048576
layer4.1.conv3.weight, mask/weight parameters,167813,116881 density 0.16161724143244577,0.1125656820142998
before tensor 1048576 mask 125223.0 1048576
layer4.2.conv1.weight, mask/weight parameters,125223,116728 density 0.12059969027366864,0.1124183308678501
before tensor 2359296 mask 90615.0 2359296
layer4.2.conv2.weight, mask/weight parameters,90615,46547 density 0.03916892628772465,0.020120245124038174
before tensor 1048576 mask 126330.0 1048576
layer4.2.conv3.weight, mask/weight parameters,126330,117181 density 0.12166581915680473,0.11285460583086784
classifier.weight, mask/weight parameters,114310,98878 density 0.558154296875,0.482802734375
Total Model parameters after dst: 3547113 2347635
Total parameters under density level of 0.1: 0.15180338343427202 0.10047013897463013 after dst
Death rate: 0.14997080567080823


Training summary: Average loss: 3.6919, Accuracy: 6217/50000 (12.434%)


Evaluation: Average loss: 3.3676, Accuracy: 1782/10000 (17.820%)

Current learning rate: 0.1. Time taken for epoch: 90.83 seconds.

Train Epoch: 2 [0/50000 (0%)]	Loss: 3.374633 Accuracy: 20/100 (20.000%
Train Epoch: 2 [10000/50000 (20%)]	Loss: 3.583906 Accuracy: 1317/10100 (13.040%
Train Epoch: 2 [20000/50000 (40%)]	Loss: 3.240355 Accuracy: 2923/20100 (14.542%
Train Epoch: 2 [30000/50000 (60%)]	Loss: 2.919121 Accuracy: 4765/30100 (15.831%
Train Epoch: 2 [40000/50000 (80%)]	Loss: 3.395360 Accuracy: 6746/40100 (16.823%
current layer rate 0.03382271279016846
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 7490.0
Total filter_masks items: 20391071.0
7490.0 / 7552 channels
Total channels to prune: 193.42912699135195
Layer ('layer1', 0, 'conv1'): Pruned 1/64.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/64.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/64.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/64.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/64.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/64.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 3/127.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 13/507.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 13/507.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 13/507.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 13/507.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 13/507.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 13/507.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 7310.0
Total filter_masks items: 19616583.0
After apply_mask:
Total filter_names items: 7310.0
Total filter_masks items: 19616583.0
Total pruned: 180/193.42912699135195 channels
===========done ===============

Training summary: Average loss: 3.3791, Accuracy: 8895/50000 (17.790%)


Evaluation: Average loss: 3.3406, Accuracy: 1916/10000 (19.160%)

Current learning rate: 0.1. Time taken for epoch: 90.66 seconds.

Train Epoch: 3 [0/50000 (0%)]	Loss: 2.956795 Accuracy: 21/100 (21.000%
Train Epoch: 3 [10000/50000 (20%)]	Loss: 3.242515 Accuracy: 2309/10100 (22.861%
Train Epoch: 3 [20000/50000 (40%)]	Loss: 2.638030 Accuracy: 4770/20100 (23.731%
Train Epoch: 3 [30000/50000 (60%)]	Loss: 3.188284 Accuracy: 7325/30100 (24.336%
Train Epoch: 3 [40000/50000 (80%)]	Loss: 3.027690 Accuracy: 10134/40100 (25.272%
current mest  death_rate 0.14988329086794133


dynamic sparse change prune
to kill 1008084.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1673,1673 density 0.9681712962962963,0.9681712962962963
before tensor 4096 mask 3823.0 4096
layer1.0.conv1.weight, mask/weight parameters,3823,3823 density 0.9481646825396826,0.9481646825396826
before tensor 36864 mask 7089.0 36864
layer1.0.conv2.weight, mask/weight parameters,7089,7089 density 0.19845469051818257,0.19845469051818257
before tensor 16384 mask 13276.0 16384
layer1.0.conv3.weight, mask/weight parameters,13276,13276 density 0.8231646825396826,0.8231646825396826
layer1.0.shortcut.0.weight, mask/weight parameters,13409,13409 density 0.81842041015625,0.81842041015625
before tensor 16384 mask 13097.0 16384
layer1.1.conv1.weight, mask/weight parameters,13097,13097 density 0.8120659722222222,0.8120659722222222
before tensor 36864 mask 6083.0 36864
layer1.1.conv2.weight, mask/weight parameters,6083,6083 density 0.1702919851067999,0.1702919851067999
before tensor 16384 mask 13057.0 16384
layer1.1.conv3.weight, mask/weight parameters,13057,13057 density 0.8095858134920635,0.8095858134920635
before tensor 16384 mask 12993.0 16384
layer1.2.conv1.weight, mask/weight parameters,12993,12993 density 0.8056175595238095,0.8056175595238095
before tensor 36864 mask 5875.0 36864
layer1.2.conv2.weight, mask/weight parameters,5875,5875 density 0.16446907981299516,0.16446907981299516
before tensor 16384 mask 12772.0 16384
layer1.2.conv3.weight, mask/weight parameters,12772,12772 density 0.7919146825396826,0.7919146825396826
before tensor 32768 mask 15459.0 32768
layer2.0.conv1.weight, mask/weight parameters,15459,15459 density 0.4869896673387097,0.4869896673387097
before tensor 147456 mask 13500.0 147456
layer2.0.conv2.weight, mask/weight parameters,13500,13500 density 0.09755463059313216,0.09755463059313216
before tensor 65536 mask 24734.0 65536
layer2.0.conv3.weight, mask/weight parameters,24734,24734 density 0.38958543346774194,0.38958543346774194
layer2.0.shortcut.0.weight, mask/weight parameters,36503,36503 density 0.27849578857421875,0.27849578857421875
before tensor 65536 mask 24025.0 65536
layer2.1.conv1.weight, mask/weight parameters,24025,24025 density 0.37841796875,0.37841796875
before tensor 147456 mask 14596.0 147456
layer2.1.conv2.weight, mask/weight parameters,14596,14596 density 0.10547462134350792,0.10547462134350792
before tensor 65536 mask 24588.0 65536
layer2.1.conv3.weight, mask/weight parameters,24588,24588 density 0.38728578629032256,0.38728578629032256
before tensor 65536 mask 23005.0 65536
layer2.2.conv1.weight, mask/weight parameters,23005,23005 density 0.36235194052419356,0.36235194052419356
before tensor 147456 mask 11826.0 147456
layer2.2.conv2.weight, mask/weight parameters,11826,11826 density 0.08545785639958377,0.08545785639958377
before tensor 65536 mask 23625.0 65536
layer2.2.conv3.weight, mask/weight parameters,23625,23625 density 0.37211756552419356,0.37211756552419356
before tensor 65536 mask 22262.0 65536
layer2.3.conv1.weight, mask/weight parameters,22262,22262 density 0.35064894153225806,0.35064894153225806
before tensor 147456 mask 12687.0 147456
layer2.3.conv2.weight, mask/weight parameters,12687,12687 density 0.09167967395074575,0.09167967395074575
before tensor 65536 mask 23930.0 65536
layer2.3.conv3.weight, mask/weight parameters,23930,23930 density 0.37692162298387094,0.37692162298387094
before tensor 131072 mask 31283.0 131072
layer3.0.conv1.weight, mask/weight parameters,31283,31283 density 0.24636939264112903,0.24636939264112903
before tensor 589824 mask 48682.0 589824
layer3.0.conv2.weight, mask/weight parameters,48682,48682 density 0.08794730604694184,0.08794730604694184
before tensor 262144 mask 52669.0 262144
layer3.0.conv3.weight, mask/weight parameters,52669,52669 density 0.2073974609375,0.2073974609375
layer3.0.shortcut.0.weight, mask/weight parameters,71140,71140 density 0.13568878173828125,0.13568878173828125
before tensor 262144 mask 51216.0 262144
layer3.1.conv1.weight, mask/weight parameters,51216,51216 density 0.20167590725806453,0.20167590725806453
before tensor 589824 mask 108415.0 589824
layer3.1.conv2.weight, mask/weight parameters,108415,108415 density 0.19585898658804485,0.19585898658804485
before tensor 262144 mask 63175.0 262144
layer3.1.conv3.weight, mask/weight parameters,63175,63175 density 0.24876748361895162,0.24876748361895162
before tensor 262144 mask 54371.0 262144
layer3.2.conv1.weight, mask/weight parameters,54371,54371 density 0.21409951486895162,0.21409951486895162
before tensor 589824 mask 95980.0 589824
layer3.2.conv2.weight, mask/weight parameters,95980,95980 density 0.17339432304312638,0.17339432304312638
before tensor 262144 mask 56383.0 262144
layer3.2.conv3.weight, mask/weight parameters,56383,56383 density 0.22202227192540322,0.22202227192540322
before tensor 262144 mask 47118.0 262144
layer3.3.conv1.weight, mask/weight parameters,47118,47118 density 0.18553899949596775,0.18553899949596775
before tensor 589824 mask 56952.0 589824
layer3.3.conv2.weight, mask/weight parameters,56952,56952 density 0.10288761706555671,0.10288761706555671
before tensor 262144 mask 49148.0 262144
layer3.3.conv3.weight, mask/weight parameters,49148,49148 density 0.1935326360887097,0.1935326360887097
before tensor 262144 mask 43752.0 262144
layer3.4.conv1.weight, mask/weight parameters,43752,43752 density 0.1722845262096774,0.1722845262096774
before tensor 589824 mask 38311.0 589824
layer3.4.conv2.weight, mask/weight parameters,38311,38311 density 0.06921139727136084,0.06921139727136084
before tensor 262144 mask 45709.0 262144
layer3.4.conv3.weight, mask/weight parameters,45709,45709 density 0.17999070690524194,0.17999070690524194
before tensor 262144 mask 39457.0 262144
layer3.5.conv1.weight, mask/weight parameters,39457,39457 density 0.15537188130040322,0.15537188130040322
before tensor 589824 mask 23248.0 589824
layer3.5.conv2.weight, mask/weight parameters,23248,23248 density 0.0419990750375766,0.0419990750375766
before tensor 262144 mask 43851.0 262144
layer3.5.conv3.weight, mask/weight parameters,43851,43851 density 0.1726743636592742,0.1726743636592742
before tensor 524288 mask 46083.0 524288
layer4.0.conv1.weight, mask/weight parameters,46083,46083 density 0.09109904795040485,0.09109904795040485
before tensor 2359296 mask 39232.0 2359296
layer4.0.conv2.weight, mask/weight parameters,39232,39232 density 0.017862574010027665,0.017862574010027665
before tensor 1048576 mask 78132.0 1048576
layer4.0.conv3.weight, mask/weight parameters,78132,78132 density 0.07722751138663968,0.07722751138663968
layer4.0.shortcut.0.weight, mask/weight parameters,168727,168727 density 0.08045530319213867,0.08045530319213867
before tensor 1048576 mask 81454.0 1048576
layer4.1.conv1.weight, mask/weight parameters,81454,81454 density 0.08051105452935223,0.08051105452935223
before tensor 2359296 mask 173919.0 2359296
layer4.1.conv2.weight, mask/weight parameters,173919,173919 density 0.07918640419173127,0.07918640419173127
before tensor 1048576 mask 112718.0 1048576
layer4.1.conv3.weight, mask/weight parameters,112718,112718 density 0.11141312942813765,0.11141312942813765
before tensor 1048576 mask 56757.0 1048576
layer4.2.conv1.weight, mask/weight parameters,56757,56757 density 0.056099957300101214,0.056099957300101214
before tensor 2359296 mask 40215.0 2359296
layer4.2.conv2.weight, mask/weight parameters,40215,40215 density 0.018310140033984058,0.018310140033984058
before tensor 1048576 mask 79023.0 1048576
layer4.2.conv3.weight, mask/weight parameters,79023,79023 density 0.07810819679908906,0.07810819679908906
classifier.weight, mask/weight parameters,94198,94198 density 0.459951171875,0.459951171875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.1046921152246456 0.1046921152246456 after dst
Death rate: 0.14988329086794133

dynamic sparse change grow
self.total_params*pruning_rate 3545044.391873856
self.total_nonzero 2365205.0
to grow 1179839.391873856
len(all_scores) 22592007 20226802
increse 1179839.0 before_mask 3545042.0 after_mask 3545042.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1705,1673 density 0.9866898148148148,0.9681712962962963
before tensor 4096 mask 3868.0 4096
layer1.0.conv1.weight, mask/weight parameters,3868,3823 density 0.9593253968253969,0.9481646825396826
before tensor 36864 mask 11899.0 36864
layer1.0.conv2.weight, mask/weight parameters,11899,7089 density 0.33310937543741775,0.19845469051818257
before tensor 16384 mask 13701.0 16384
layer1.0.conv3.weight, mask/weight parameters,13701,13276 density 0.8495163690476191,0.8231646825396826
layer1.0.shortcut.0.weight, mask/weight parameters,13934,13409 density 0.8504638671875,0.81842041015625
before tensor 16384 mask 13163.0 16384
layer1.1.conv1.weight, mask/weight parameters,13163,13097 density 0.8161582341269841,0.8120659722222222
before tensor 36864 mask 6888.0 36864
layer1.1.conv2.weight, mask/weight parameters,6888,6083 density 0.19282774838330394,0.1702919851067999
before tensor 16384 mask 13120.0 16384
layer1.1.conv3.weight, mask/weight parameters,13120,13057 density 0.8134920634920635,0.8095858134920635
before tensor 16384 mask 13093.0 16384
layer1.2.conv1.weight, mask/weight parameters,13093,12993 density 0.8118179563492064,0.8056175595238095
before tensor 36864 mask 6572.0 36864
layer1.2.conv2.weight, mask/weight parameters,6572,5875 density 0.183981411494639,0.16446907981299516
before tensor 16384 mask 12810.0 16384
layer1.2.conv3.weight, mask/weight parameters,12810,12772 density 0.7942708333333334,0.7919146825396826
before tensor 32768 mask 16466.0 32768
layer2.0.conv1.weight, mask/weight parameters,16466,15459 density 0.5187121975806451,0.4869896673387097
before tensor 147456 mask 21802.0 147456
layer2.0.conv2.weight, mask/weight parameters,21802,13500 density 0.157547115273442,0.09755463059313216
before tensor 65536 mask 27068.0 65536
layer2.0.conv3.weight, mask/weight parameters,27068,24734 density 0.42634828629032256,0.38958543346774194
layer2.0.shortcut.0.weight, mask/weight parameters,49658,36503 density 0.3788604736328125,0.27849578857421875
before tensor 65536 mask 25887.0 65536
layer2.1.conv1.weight, mask/weight parameters,25887,24025 density 0.40774634576612906,0.37841796875
before tensor 147456 mask 27035.0 147456
layer2.1.conv2.weight, mask/weight parameters,27035,14596 density 0.19536218059891317,0.10547462134350792
before tensor 65536 mask 27655.0 65536
layer2.1.conv3.weight, mask/weight parameters,27655,24588 density 0.43559412802419356,0.38728578629032256
before tensor 65536 mask 25384.0 65536
layer2.2.conv1.weight, mask/weight parameters,25384,23005 density 0.39982358870967744,0.36235194052419356
before tensor 147456 mask 25093.0 147456
layer2.2.conv2.weight, mask/weight parameters,25093,11826 density 0.1813287663313678,0.08545785639958377
before tensor 65536 mask 25627.0 65536
layer2.2.conv3.weight, mask/weight parameters,25627,23625 density 0.4036510836693548,0.37211756552419356
before tensor 65536 mask 23209.0 65536
layer2.3.conv1.weight, mask/weight parameters,23209,22262 density 0.3655651461693548,0.35064894153225806
before tensor 147456 mask 22695.0 147456
layer2.3.conv2.weight, mask/weight parameters,22695,12687 density 0.1640001734304544,0.09167967395074575
before tensor 65536 mask 26841.0 65536
layer2.3.conv3.weight, mask/weight parameters,26841,23930 density 0.42277280745967744,0.37692162298387094
before tensor 131072 mask 42483.0 131072
layer3.0.conv1.weight, mask/weight parameters,42483,31283 density 0.3345750378024194,0.24636939264112903
before tensor 589824 mask 125918.0 589824
layer3.0.conv2.weight, mask/weight parameters,125918,48682 density 0.22747933287085212,0.08794730604694184
before tensor 262144 mask 77829.0 262144
layer3.0.conv3.weight, mask/weight parameters,77829,52669 density 0.30647130166330644,0.2073974609375
layer3.0.shortcut.0.weight, mask/weight parameters,112976,71140 density 0.215484619140625,0.13568878173828125
before tensor 262144 mask 66097.0 262144
layer3.1.conv1.weight, mask/weight parameters,66097,51216 density 0.2602735950100806,0.20167590725806453
before tensor 589824 mask 149136.0 589824
layer3.1.conv2.weight, mask/weight parameters,149136,108415 density 0.26942421089143254,0.19585898658804485
before tensor 262144 mask 91011.0 262144
layer3.1.conv3.weight, mask/weight parameters,91011,63175 density 0.3583787487399194,0.24876748361895162
before tensor 262144 mask 72209.0 262144
layer3.2.conv1.weight, mask/weight parameters,72209,54371 density 0.2843411353326613,0.21409951486895162
before tensor 589824 mask 144788.0 589824
layer3.2.conv2.weight, mask/weight parameters,144788,95980 density 0.2615692565614522,0.17339432304312638
before tensor 262144 mask 80789.0 262144
layer3.2.conv3.weight, mask/weight parameters,80789,56383 density 0.3181270476310484,0.22202227192540322
before tensor 262144 mask 60106.0 262144
layer3.3.conv1.weight, mask/weight parameters,60106,47118 density 0.23668252268145162,0.18553899949596775
before tensor 589824 mask 102131.0 589824
layer3.3.conv2.weight, mask/weight parameters,102131,56952 density 0.1845065180945774,0.10288761706555671
before tensor 262144 mask 63843.0 262144
layer3.3.conv3.weight, mask/weight parameters,63843,49148 density 0.2513979019657258,0.1935326360887097
before tensor 262144 mask 55843.0 262144
layer3.4.conv1.weight, mask/weight parameters,55843,43752 density 0.21989588583669356,0.1722845262096774
before tensor 589824 mask 93195.0 589824
layer3.4.conv2.weight, mask/weight parameters,93195,38311 density 0.16836303329864724,0.06921139727136084
before tensor 262144 mask 58675.0 262144
layer3.4.conv3.weight, mask/weight parameters,58675,45709 density 0.23104759954637097,0.17999070690524194
before tensor 262144 mask 46585.0 262144
layer3.5.conv1.weight, mask/weight parameters,46585,39457 density 0.18344017767137097,0.15537188130040322
before tensor 589824 mask 83291.0 589824
layer3.5.conv2.weight, mask/weight parameters,83291,23248 density 0.15047079142097353,0.0419990750375766
before tensor 262144 mask 53308.0 262144
layer3.5.conv3.weight, mask/weight parameters,53308,43851 density 0.20991368447580644,0.1726743636592742
before tensor 524288 mask 68804.0 524288
layer4.0.conv1.weight, mask/weight parameters,68804,46083 density 0.13601499240890688,0.09109904795040485
before tensor 2359296 mask 199338.0 2359296
layer4.0.conv2.weight, mask/weight parameters,199338,39232 density 0.09075983324864638,0.017862574010027665
before tensor 1048576 mask 114332.0 1048576
layer4.0.conv3.weight, mask/weight parameters,114332,78132 density 0.11300844509109312,0.07722751138663968
layer4.0.shortcut.0.weight, mask/weight parameters,272372,168727 density 0.12987709045410156,0.08045530319213867
before tensor 1048576 mask 103748.0 1048576
layer4.1.conv1.weight, mask/weight parameters,103748,81454 density 0.10254696988866396,0.08051105452935223
before tensor 2359296 mask 231908.0 2359296
layer4.1.conv2.weight, mask/weight parameters,231908,173919 density 0.10558915715531952,0.07918640419173127
before tensor 1048576 mask 159782.0 1048576
layer4.1.conv3.weight, mask/weight parameters,159782,112718 density 0.1579322969382591,0.11141312942813765
before tensor 1048576 mask 64526.0 1048576
layer4.2.conv1.weight, mask/weight parameters,64526,56757 density 0.06377902011639676,0.056099957300101214
before tensor 2359296 mask 88406.0 2359296
layer4.2.conv2.weight, mask/weight parameters,88406,40215 density 0.04025180255736403,0.018310140033984058
before tensor 1048576 mask 92855.0 1048576
layer4.2.conv3.weight, mask/weight parameters,92855,79023 density 0.09178007179908906,0.07810819679908906
classifier.weight, mask/weight parameters,113585,94198 density 0.5546142578125,0.459951171875
Total Model parameters after dst: 3545042 2365205
Total parameters under density level of 0.1: 0.1569157622870779 0.1046921152246456 after dst
Death rate: 0.14988329086794133


Training summary: Average loss: 2.9211, Accuracy: 13033/50000 (26.066%)


Evaluation: Average loss: 2.8926, Accuracy: 2769/10000 (27.690%)

Current learning rate: 0.1. Time taken for epoch: 91.71 seconds.

Train Epoch: 4 [0/50000 (0%)]	Loss: 2.738606 Accuracy: 26/100 (26.000%
Train Epoch: 4 [10000/50000 (20%)]	Loss: 2.845358 Accuracy: 3082/10100 (30.515%
Train Epoch: 4 [20000/50000 (40%)]	Loss: 2.662542 Accuracy: 6152/20100 (30.607%
Train Epoch: 4 [30000/50000 (60%)]	Loss: 2.739458 Accuracy: 9412/30100 (31.269%
Train Epoch: 4 [40000/50000 (80%)]	Loss: 2.244678 Accuracy: 12791/40100 (31.898%
current layer rate 0.05550182066454251
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 7310.0
Total filter_masks items: 19616583.0
7310.0 / 7552 channels
Total channels to prune: 177.1497496586253
Layer ('layer1', 0, 'conv1'): Pruned 1/63.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/63.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/63.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/63.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/63.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/63.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 3/124.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 11/494.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 11/494.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 11/494.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 11/494.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 11/494.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 11/494.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 7142.0
Total filter_masks items: 18930395.0
After apply_mask:
Total filter_names items: 7142.0
Total filter_masks items: 18930395.0
Total pruned: 168/177.1497496586253 channels
===========done ===============

Training summary: Average loss: 2.5936, Accuracy: 16327/50000 (32.654%)


Evaluation: Average loss: 3.8439, Accuracy: 1533/10000 (15.330%)

Current learning rate: 0.1. Time taken for epoch: 93.13 seconds.

Train Epoch: 5 [0/50000 (0%)]	Loss: 2.400045 Accuracy: 36/100 (36.000%
Train Epoch: 5 [10000/50000 (20%)]	Loss: 2.529777 Accuracy: 3671/10100 (36.347%
Train Epoch: 5 [20000/50000 (40%)]	Loss: 2.315957 Accuracy: 7383/20100 (36.731%
Train Epoch: 5 [30000/50000 (60%)]	Loss: 2.263972 Accuracy: 11229/30100 (37.306%
Train Epoch: 5 [40000/50000 (80%)]	Loss: 2.374827 Accuracy: 15116/40100 (37.696%
current mest  death_rate 0.14973765998627658


dynamic sparse change prune
to kill 1011812.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1616,1616 density 0.9351851851851852,0.9351851851851852
before tensor 4096 mask 3494.0 4096
layer1.0.conv1.weight, mask/weight parameters,3494,3494 density 0.8805443548387096,0.8805443548387096
before tensor 36864 mask 9383.0 36864
layer1.0.conv2.weight, mask/weight parameters,9383,9383 density 0.27121632558677305,0.27121632558677305
before tensor 16384 mask 11581.0 16384
layer1.0.conv3.weight, mask/weight parameters,11581,11581 density 0.7296496975806451,0.7296496975806451
layer1.0.shortcut.0.weight, mask/weight parameters,12110,12110 density 0.7391357421875,0.7391357421875
before tensor 16384 mask 11204.0 16384
layer1.1.conv1.weight, mask/weight parameters,11204,11204 density 0.7058971774193549,0.7058971774193549
before tensor 36864 mask 5685.0 36864
layer1.1.conv2.weight, mask/weight parameters,5685,5685 density 0.1643253555324315,0.1643253555324315
before tensor 16384 mask 10999.0 16384
layer1.1.conv3.weight, mask/weight parameters,10999,10999 density 0.6929813508064516,0.6929813508064516
before tensor 16384 mask 11039.0 16384
layer1.2.conv1.weight, mask/weight parameters,11039,11039 density 0.6955015120967742,0.6955015120967742
before tensor 36864 mask 5570.0 36864
layer1.2.conv2.weight, mask/weight parameters,5570,5570 density 0.16100127182333218,0.16100127182333218
before tensor 16384 mask 10677.0 16384
layer1.2.conv3.weight, mask/weight parameters,10677,10677 density 0.6726940524193549,0.6726940524193549
before tensor 32768 mask 13139.0 32768
layer2.0.conv1.weight, mask/weight parameters,13139,13139 density 0.424167097107438,0.424167097107438
before tensor 147456 mask 14604.0 147456
layer2.0.conv2.weight, mask/weight parameters,14604,14604 density 0.11083031669057214,0.11083031669057214
before tensor 65536 mask 20740.0 65536
layer2.0.conv3.weight, mask/weight parameters,20740,20740 density 0.3347753099173554,0.3347753099173554
layer2.0.shortcut.0.weight, mask/weight parameters,38333,38333 density 0.29245758056640625,0.29245758056640625
before tensor 65536 mask 19158.0 65536
layer2.1.conv1.weight, mask/weight parameters,19158,19158 density 0.3092394111570248,0.3092394111570248
before tensor 147456 mask 17631.0 147456
layer2.1.conv2.weight, mask/weight parameters,17631,17631 density 0.13380233590601734,0.13380233590601734
before tensor 65536 mask 21162.0 65536
layer2.1.conv3.weight, mask/weight parameters,21162,21162 density 0.34158703512396693,0.34158703512396693
before tensor 65536 mask 18623.0 65536
layer2.2.conv1.weight, mask/weight parameters,18623,18623 density 0.3006036931818182,0.3006036931818182
before tensor 147456 mask 16629.0 147456
layer2.2.conv2.weight, mask/weight parameters,16629,16629 density 0.12619811943628623,0.12619811943628623
before tensor 65536 mask 19145.0 65536
layer2.2.conv3.weight, mask/weight parameters,19145,19145 density 0.30902957128099173,0.30902957128099173
before tensor 65536 mask 16468.0 65536
layer2.3.conv1.weight, mask/weight parameters,16468,16468 density 0.2658186983471074,0.2658186983471074
before tensor 147456 mask 14469.0 147456
layer2.3.conv2.weight, mask/weight parameters,14469,14469 density 0.10980579650752453,0.10980579650752453
before tensor 65536 mask 19935.0 65536
layer2.3.conv3.weight, mask/weight parameters,19935,19935 density 0.3217813791322314,0.3217813791322314
before tensor 131072 mask 30565.0 131072
layer3.0.conv1.weight, mask/weight parameters,30565,30565 density 0.24668291580578514,0.24668291580578514
before tensor 589824 mask 77526.0 589824
layer3.0.conv2.weight, mask/weight parameters,77526,77526 density 0.14708694761286797,0.14708694761286797
before tensor 262144 mask 57510.0 262144
layer3.0.conv3.weight, mask/weight parameters,57510,57510 density 0.23207483212809918,0.23207483212809918
layer3.0.shortcut.0.weight, mask/weight parameters,80568,80568 density 0.1536712646484375,0.1536712646484375
before tensor 262144 mask 47003.0 262144
layer3.1.conv1.weight, mask/weight parameters,47003,47003 density 0.18967507102272727,0.18967507102272727
before tensor 589824 mask 99405.0 589824
layer3.1.conv2.weight, mask/weight parameters,99405,99405 density 0.18859709036268013,0.18859709036268013
before tensor 262144 mask 67170.0 262144
layer3.1.conv3.weight, mask/weight parameters,67170,67170 density 0.27105662448347106,0.27105662448347106
before tensor 262144 mask 52576.0 262144
layer3.2.conv1.weight, mask/weight parameters,52576,52576 density 0.2121642561983471,0.2121642561983471
before tensor 589824 mask 97701.0 589824
layer3.2.conv2.weight, mask/weight parameters,97701,97701 density 0.18536416000728548,0.18536416000728548
before tensor 262144 mask 59734.0 262144
layer3.2.conv3.weight, mask/weight parameters,59734,59734 density 0.2410495222107438,0.2410495222107438
before tensor 262144 mask 43110.0 262144
layer3.3.conv1.weight, mask/weight parameters,43110,43110 density 0.17396532799586778,0.17396532799586778
before tensor 589824 mask 66951.0 589824
layer3.3.conv2.weight, mask/weight parameters,66951,66951 density 0.12702342736151903,0.12702342736151903
before tensor 262144 mask 46639.0 262144
layer3.3.conv3.weight, mask/weight parameters,46639,46639 density 0.18820619189049587,0.18820619189049587
before tensor 262144 mask 39522.0 262144
layer3.4.conv1.weight, mask/weight parameters,39522,39522 density 0.15948637654958678,0.15948637654958678
before tensor 589824 mask 58884.0 589824
layer3.4.conv2.weight, mask/weight parameters,58884,58884 density 0.11171823418254673,0.11171823418254673
before tensor 262144 mask 42296.0 262144
layer3.4.conv3.weight, mask/weight parameters,42296,42296 density 0.17068052685950413,0.17068052685950413
before tensor 262144 mask 31500.0 262144
layer3.5.conv1.weight, mask/weight parameters,31500,31500 density 0.1271145402892562,0.1271145402892562
before tensor 589824 mask 46966.0 589824
layer3.5.conv2.weight, mask/weight parameters,46966,46966 density 0.08910669429076641,0.08910669429076641
before tensor 262144 mask 37417.0 262144
layer3.5.conv3.weight, mask/weight parameters,37417,37417 density 0.15099189695247933,0.15099189695247933
before tensor 524288 mask 45905.0 524288
layer4.0.conv1.weight, mask/weight parameters,45905,45905 density 0.09281387487060042,0.09281387487060042
before tensor 2359296 mask 89758.0 2359296
layer4.0.conv2.weight, mask/weight parameters,89758,89758 density 0.04275002726708551,0.04275002726708551
before tensor 1048576 mask 71817.0 1048576
layer4.0.conv3.weight, mask/weight parameters,71817,71817 density 0.07260226611024845,0.07260226611024845
layer4.0.shortcut.0.weight, mask/weight parameters,178493,178493 density 0.08511209487915039,0.08511209487915039
before tensor 1048576 mask 68528.0 1048576
layer4.1.conv1.weight, mask/weight parameters,68528,68528 density 0.06927730331262939,0.06927730331262939
before tensor 2359296 mask 144918.0 2359296
layer4.1.conv2.weight, mask/weight parameters,144918,144918 density 0.0690216855488257,0.0690216855488257
before tensor 1048576 mask 106950.0 1048576
layer4.1.conv3.weight, mask/weight parameters,106950,106950 density 0.10811941964285714,0.10811941964285714
before tensor 1048576 mask 37050.0 1048576
layer4.2.conv1.weight, mask/weight parameters,37050,37050 density 0.037455114518633544,0.037455114518633544
before tensor 2359296 mask 40931.0 2359296
layer4.2.conv2.weight, mask/weight parameters,40931,40931 density 0.019494656365661858,0.019494656365661858
before tensor 1048576 mask 56897.0 1048576
layer4.2.conv3.weight, mask/weight parameters,56897,56897 density 0.05751912687629399,0.05751912687629399
classifier.weight, mask/weight parameters,97521,97521 density 0.4761767578125,0.4761767578125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.10797153943433935 0.10797153943433935 after dst
Death rate: 0.14973765998627658

dynamic sparse change grow
self.total_params*pruning_rate 3541599.9256005334
self.total_nonzero 2365205.0
to grow 1176394.9256005334
len(all_scores) 21905819 19539000
increse 1176394.0 before_mask 3541598.0 after_mask 3541598.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1660,1616 density 0.9606481481481481,0.9351851851851852
before tensor 4096 mask 3565.0 4096
layer1.0.conv1.weight, mask/weight parameters,3565,3494 density 0.8984375,0.8805443548387096
before tensor 36864 mask 12105.0 36864
layer1.0.conv2.weight, mask/weight parameters,12105,9383 density 0.3498959417273673,0.27121632558677305
before tensor 16384 mask 12031.0 16384
layer1.0.conv3.weight, mask/weight parameters,12031,11581 density 0.7580015120967742,0.7296496975806451
layer1.0.shortcut.0.weight, mask/weight parameters,12640,12110 density 0.771484375,0.7391357421875
before tensor 16384 mask 11517.0 16384
layer1.1.conv1.weight, mask/weight parameters,11517,11204 density 0.725617439516129,0.7058971774193549
before tensor 36864 mask 9516.0 36864
layer1.1.conv2.weight, mask/weight parameters,9516,5685 density 0.2750607006590357,0.1643253555324315
before tensor 16384 mask 11337.0 16384
layer1.1.conv3.weight, mask/weight parameters,11337,10999 density 0.7142767137096774,0.6929813508064516
before tensor 16384 mask 11329.0 16384
layer1.2.conv1.weight, mask/weight parameters,11329,11039 density 0.7137726814516129,0.6955015120967742
before tensor 36864 mask 8242.0 36864
layer1.2.conv2.weight, mask/weight parameters,8242,5570 density 0.23823563417736154,0.16100127182333218
before tensor 16384 mask 10994.0 16384
layer1.2.conv3.weight, mask/weight parameters,10994,10677 density 0.6926663306451613,0.6726940524193549
before tensor 32768 mask 14619.0 32768
layer2.0.conv1.weight, mask/weight parameters,14619,13139 density 0.4719460227272727,0.424167097107438
before tensor 147456 mask 26654.0 147456
layer2.0.conv2.weight, mask/weight parameters,26654,14604 density 0.20227822932556216,0.11083031669057214
before tensor 65536 mask 24277.0 65536
layer2.0.conv3.weight, mask/weight parameters,24277,20740 density 0.3918678977272727,0.3347753099173554
layer2.0.shortcut.0.weight, mask/weight parameters,46475,38333 density 0.35457611083984375,0.29245758056640625
before tensor 65536 mask 20024.0 65536
layer2.1.conv1.weight, mask/weight parameters,20024,19158 density 0.32321797520661155,0.3092394111570248
before tensor 147456 mask 23632.0 147456
layer2.1.conv2.weight, mask/weight parameters,23632,17631 density 0.17934415530208167,0.13380233590601734
before tensor 65536 mask 23859.0 65536
layer2.1.conv3.weight, mask/weight parameters,23859,21162 density 0.38512073863636365,0.34158703512396693
before tensor 65536 mask 19645.0 65536
layer2.2.conv1.weight, mask/weight parameters,19645,18623 density 0.31710033574380164,0.3006036931818182
before tensor 147456 mask 21721.0 147456
layer2.2.conv2.weight, mask/weight parameters,21721,16629 density 0.16484150293316333,0.12619811943628623
before tensor 65536 mask 21055.0 65536
layer2.2.conv3.weight, mask/weight parameters,21055,19145 density 0.3398598915289256,0.30902957128099173
before tensor 65536 mask 18518.0 65536
layer2.3.conv1.weight, mask/weight parameters,18518,16468 density 0.2989088326446281,0.2658186983471074
before tensor 147456 mask 19934.0 147456
layer2.3.conv2.weight, mask/weight parameters,19934,14469 density 0.15127989132497022,0.10980579650752453
before tensor 65536 mask 21924.0 65536
layer2.3.conv3.weight, mask/weight parameters,21924,19935 density 0.35388688016528924,0.3217813791322314
before tensor 131072 mask 41065.0 131072
layer3.0.conv1.weight, mask/weight parameters,41065,30565 density 0.33142594266528924,0.24668291580578514
before tensor 589824 mask 116974.0 589824
layer3.0.conv2.weight, mask/weight parameters,116974,77526 density 0.22193004424409382,0.14708694761286797
before tensor 262144 mask 81491.0 262144
layer3.0.conv3.weight, mask/weight parameters,81491,57510 density 0.32884733341942146,0.23207483212809918
layer3.0.shortcut.0.weight, mask/weight parameters,112787,80568 density 0.21512413024902344,0.1536712646484375
before tensor 262144 mask 57765.0 262144
layer3.1.conv1.weight, mask/weight parameters,57765,47003 density 0.23310385459710745,0.18967507102272727
before tensor 589824 mask 131562.0 589824
layer3.1.conv2.weight, mask/weight parameters,131562,99405 density 0.2496072672631651,0.18859709036268013
before tensor 262144 mask 88053.0 262144
layer3.1.conv3.weight, mask/weight parameters,88053,67170 density 0.35532751162190085,0.27105662448347106
before tensor 262144 mask 67744.0 262144
layer3.2.conv1.weight, mask/weight parameters,67744,52576 density 0.2733729338842975,0.2121642561983471
before tensor 589824 mask 137858.0 589824
layer3.2.conv2.weight, mask/weight parameters,137858,97701 density 0.2615524136936609,0.18536416000728548
before tensor 262144 mask 79918.0 262144
layer3.2.conv3.weight, mask/weight parameters,79918,59734 density 0.32249967716942146,0.2410495222107438
before tensor 262144 mask 60017.0 262144
layer3.3.conv1.weight, mask/weight parameters,60017,43110 density 0.2421915353822314,0.17396532799586778
before tensor 589824 mask 107829.0 589824
layer3.3.conv2.weight, mask/weight parameters,107829,66951 density 0.2045796052182228,0.12702342736151903
before tensor 262144 mask 68461.0 262144
layer3.3.conv3.weight, mask/weight parameters,68461,46639 density 0.2762663029442149,0.18820619189049587
before tensor 262144 mask 56151.0 262144
layer3.4.conv1.weight, mask/weight parameters,56151,39522 density 0.22659074767561985,0.15948637654958678
before tensor 589824 mask 98289.0 589824
layer3.4.conv2.weight, mask/weight parameters,98289,58884 density 0.18647974865104844,0.11171823418254673
before tensor 262144 mask 63372.0 262144
layer3.4.conv3.weight, mask/weight parameters,63372,42296 density 0.255730242768595,0.17068052685950413
before tensor 262144 mask 44551.0 262144
layer3.5.conv1.weight, mask/weight parameters,44551,31500 density 0.1797803137913223,0.1271145402892562
before tensor 589824 mask 78330.0 589824
layer3.5.conv2.weight, mask/weight parameters,78330,46966 density 0.14861234432984996,0.08910669429076641
before tensor 262144 mask 52755.0 262144
layer3.5.conv3.weight, mask/weight parameters,52755,37417 density 0.2128865896177686,0.15099189695247933
before tensor 524288 mask 99824.0 524288
layer4.0.conv1.weight, mask/weight parameters,99824,45905 density 0.20183100414078675,0.09281387487060042
before tensor 2359296 mask 237419.0 2359296
layer4.0.conv2.weight, mask/weight parameters,237419,89758 density 0.1130781515154546,0.04275002726708551
before tensor 1048576 mask 133056.0 1048576
layer4.0.conv3.weight, mask/weight parameters,133056,71817 density 0.13451086956521738,0.07260226611024845
layer4.0.shortcut.0.weight, mask/weight parameters,248505,178493 density 0.11849641799926758,0.08511209487915039
before tensor 1048576 mask 98599.0 1048576
layer4.1.conv1.weight, mask/weight parameters,98599,68528 density 0.0996771075957557,0.06927730331262939
before tensor 2359296 mask 248518.0 2359296
layer4.1.conv2.weight, mask/weight parameters,248518,144918 density 0.11836439399676414,0.0690216855488257
before tensor 1048576 mask 159204.0 1048576
layer4.1.conv3.weight, mask/weight parameters,159204,106950 density 0.16094477872670807,0.10811941964285714
before tensor 1048576 mask 56766.0 1048576
layer4.2.conv1.weight, mask/weight parameters,56766,37050 density 0.05738669448757764,0.037455114518633544
before tensor 2359296 mask 109410.0 2359296
layer4.2.conv2.weight, mask/weight parameters,109410,40931 density 0.052109900881167424,0.019494656365661858
before tensor 1048576 mask 83394.0 1048576
layer4.2.conv3.weight, mask/weight parameters,83394,56897 density 0.0843058520962733,0.05751912687629399
classifier.weight, mask/weight parameters,114658,97521 density 0.559853515625,0.4761767578125
Total Model parameters after dst: 3541598 2365205
Total parameters under density level of 0.1: 0.16167384565717446 0.10797153943433935 after dst
Death rate: 0.14973765998627658


Training summary: Average loss: 2.3255, Accuracy: 19118/50000 (38.236%)


Evaluation: Average loss: 2.4520, Accuracy: 3715/10000 (37.150%)

Current learning rate: 0.1. Time taken for epoch: 91.15 seconds.

Train Epoch: 6 [0/50000 (0%)]	Loss: 1.982812 Accuracy: 46/100 (46.000%
Train Epoch: 6 [10000/50000 (20%)]	Loss: 2.025892 Accuracy: 4166/10100 (41.248%
Train Epoch: 6 [20000/50000 (40%)]	Loss: 2.255222 Accuracy: 8367/20100 (41.627%
Train Epoch: 6 [30000/50000 (60%)]	Loss: 2.057548 Accuracy: 12664/30100 (42.073%
Train Epoch: 6 [40000/50000 (80%)]	Loss: 2.071421 Accuracy: 17032/40100 (42.474%
current layer rate 0.0764981793354575
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 7142.0
Total filter_masks items: 18930395.0
7142.0 / 7552 channels
Total channels to prune: 167.7142503413752
Layer ('layer1', 0, 'conv1'): Pruned 1/62.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/62.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/62.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/62.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/62.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/62.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/121.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 11/483.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 11/483.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 11/483.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 11/483.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 11/483.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 11/483.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6994.0
Total filter_masks items: 18305021.0
After apply_mask:
Total filter_names items: 6994.0
Total filter_masks items: 18305021.0
Total pruned: 148/167.7142503413752 channels
===========done ===============

Training summary: Average loss: 2.1182, Accuracy: 21416/50000 (42.832%)


Evaluation: Average loss: 3.0592, Accuracy: 2737/10000 (27.370%)

Current learning rate: 0.1. Time taken for epoch: 89.43 seconds.

Train Epoch: 7 [0/50000 (0%)]	Loss: 1.952888 Accuracy: 43/100 (43.000%
Train Epoch: 7 [10000/50000 (20%)]	Loss: 2.041151 Accuracy: 4648/10100 (46.020%
Train Epoch: 7 [20000/50000 (40%)]	Loss: 1.851412 Accuracy: 9204/20100 (45.791%
Train Epoch: 7 [30000/50000 (60%)]	Loss: 1.793034 Accuracy: 13855/30100 (46.030%
Train Epoch: 7 [40000/50000 (80%)]	Loss: 1.994308 Accuracy: 18471/40100 (46.062%
current mest  death_rate 0.14953425315348498


dynamic sparse change prune
to kill 1030526.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1554,1554 density 0.8993055555555556,0.8993055555555556
before tensor 4096 mask 3110.0 4096
layer1.0.conv1.weight, mask/weight parameters,3110,3110 density 0.7966188524590164,0.7966188524590164
before tensor 36864 mask 9365.0 36864
layer1.0.conv2.weight, mask/weight parameters,9365,9365 density 0.27964406222938876,0.27964406222938876
before tensor 16384 mask 9734.0 16384
layer1.0.conv3.weight, mask/weight parameters,9734,9734 density 0.6233350409836066,0.6233350409836066
layer1.0.shortcut.0.weight, mask/weight parameters,10659,10659 density 0.65057373046875,0.65057373046875
before tensor 16384 mask 9352.0 16384
layer1.1.conv1.weight, mask/weight parameters,9352,9352 density 0.5988729508196722,0.5988729508196722
before tensor 36864 mask 6994.0 36864
layer1.1.conv2.weight, mask/weight parameters,6994,6994 density 0.20884469527307475,0.20884469527307475
before tensor 16384 mask 9045.0 16384
layer1.1.conv3.weight, mask/weight parameters,9045,9045 density 0.5792136270491803,0.5792136270491803
before tensor 16384 mask 8797.0 16384
layer1.2.conv1.weight, mask/weight parameters,8797,8797 density 0.5633324795081968,0.5633324795081968
before tensor 36864 mask 5888.0 36864
layer1.2.conv2.weight, mask/weight parameters,5888,5888 density 0.1758189256173669,0.1758189256173669
before tensor 16384 mask 8513.0 16384
layer1.2.conv3.weight, mask/weight parameters,8513,8513 density 0.5451460040983607,0.5451460040983607
before tensor 32768 mask 11068.0 32768
layer2.0.conv1.weight, mask/weight parameters,11068,11068 density 0.3633140756302521,0.3633140756302521
before tensor 147456 mask 18063.0 147456
layer2.0.conv2.weight, mask/weight parameters,18063,18063 density 0.1417272791469529,0.1417272791469529
before tensor 65536 mask 18248.0 65536
layer2.0.conv3.weight, mask/weight parameters,18248,18248 density 0.29950105042016806,0.29950105042016806
layer2.0.shortcut.0.weight, mask/weight parameters,35613,35613 density 0.27170562744140625,0.27170562744140625
before tensor 65536 mask 14941.0 65536
layer2.1.conv1.weight, mask/weight parameters,14941,14941 density 0.24522387079831934,0.24522387079831934
before tensor 147456 mask 16361.0 147456
layer2.1.conv2.weight, mask/weight parameters,16361,16361 density 0.1283729177945688,0.1283729177945688
before tensor 65536 mask 18032.0 65536
layer2.1.conv3.weight, mask/weight parameters,18032,18032 density 0.2959558823529412,0.2959558823529412
before tensor 65536 mask 14467.0 65536
layer2.2.conv1.weight, mask/weight parameters,14467,14467 density 0.23744419642857142,0.23744419642857142
before tensor 147456 mask 14993.0 147456
layer2.2.conv2.weight, mask/weight parameters,14993,14993 density 0.1176392125477642,0.1176392125477642
before tensor 65536 mask 15676.0 65536
layer2.2.conv3.weight, mask/weight parameters,15676,15676 density 0.2572872899159664,0.2572872899159664
before tensor 65536 mask 12774.0 65536
layer2.3.conv1.weight, mask/weight parameters,12774,12774 density 0.20965730042016806,0.20965730042016806
before tensor 147456 mask 13344.0 147456
layer2.3.conv2.weight, mask/weight parameters,13344,13344 density 0.10470070381093614,0.10470070381093614
before tensor 65536 mask 16222.0 65536
layer2.3.conv3.weight, mask/weight parameters,16222,16222 density 0.2662486869747899,0.2662486869747899
before tensor 131072 mask 29753.0 131072
layer3.0.conv1.weight, mask/weight parameters,29753,29753 density 0.2451954773206751,0.2451954773206751
before tensor 589824 mask 78502.0 589824
layer3.0.conv2.weight, mask/weight parameters,78502,78502 density 0.1552892955980068,0.1552892955980068
before tensor 262144 mask 60032.0 262144
layer3.0.conv3.weight, mask/weight parameters,60032,60032 density 0.24736286919831224,0.24736286919831224
layer3.0.shortcut.0.weight, mask/weight parameters,81998,81998 density 0.15639877319335938,0.15639877319335938
before tensor 262144 mask 41819.0 262144
layer3.1.conv1.weight, mask/weight parameters,41819,41819 density 0.17231589530590719,0.17231589530590719
before tensor 589824 mask 91334.0 589824
layer3.1.conv2.weight, mask/weight parameters,91334,91334 density 0.18067300863861244,0.18067300863861244
before tensor 262144 mask 65981.0 262144
layer3.1.conv3.weight, mask/weight parameters,65981,65981 density 0.2718758241033755,0.2718758241033755
before tensor 262144 mask 49672.0 262144
layer3.2.conv1.weight, mask/weight parameters,49672,49672 density 0.20467431434599156,0.20467431434599156
before tensor 589824 mask 95790.0 589824
layer3.2.conv2.weight, mask/weight parameters,95790,95790 density 0.18948767706979533,0.18948767706979533
before tensor 262144 mask 58972.0 262144
layer3.2.conv3.weight, mask/weight parameters,58972,58972 density 0.24299512130801687,0.24299512130801687
before tensor 262144 mask 42844.0 262144
layer3.3.conv1.weight, mask/weight parameters,42844,42844 density 0.17653942510548523,0.17653942510548523
before tensor 589824 mask 71593.0 589824
layer3.3.conv2.weight, mask/weight parameters,71593,71593 density 0.14162220758385902,0.14162220758385902
before tensor 262144 mask 49228.0 262144
layer3.3.conv3.weight, mask/weight parameters,49228,49228 density 0.20284480485232068,0.20284480485232068
before tensor 262144 mask 39559.0 262144
layer3.4.conv1.weight, mask/weight parameters,39559,39559 density 0.16300352716244726,0.16300352716244726
before tensor 589824 mask 62742.0 589824
layer3.4.conv2.weight, mask/weight parameters,62742,62742 density 0.12411353830998119,0.12411353830998119
before tensor 262144 mask 44308.0 262144
layer3.4.conv3.weight, mask/weight parameters,44308,44308 density 0.18257186181434598,0.18257186181434598
before tensor 262144 mask 30887.0 262144
layer3.5.conv1.weight, mask/weight parameters,30887,30887 density 0.12727040479957805,0.12727040479957805
before tensor 589824 mask 49085.0 589824
layer3.5.conv2.weight, mask/weight parameters,49085,49085 density 0.0970978455890062,0.0970978455890062
before tensor 262144 mask 36767.0 262144
layer3.5.conv3.weight, mask/weight parameters,36767,36767 density 0.15149904404008438,0.15149904404008438
before tensor 524288 mask 65380.0 524288
layer4.0.conv1.weight, mask/weight parameters,65380,65380 density 0.13527045815677965,0.13527045815677965
before tensor 2359296 mask 116878.0 2359296
layer4.0.conv2.weight, mask/weight parameters,116878,116878 density 0.058291638737272174,0.058291638737272174
before tensor 1048576 mask 80912.0 1048576
layer4.0.conv3.weight, mask/weight parameters,80912,80912 density 0.08370299258474577,0.08370299258474577
layer4.0.shortcut.0.weight, mask/weight parameters,166797,166797 density 0.07953500747680664,0.07953500747680664
before tensor 1048576 mask 67874.0 1048576
layer4.1.conv1.weight, mask/weight parameters,67874,67874 density 0.0702152575476695,0.0702152575476695
before tensor 2359296 mask 153421.0 2359296
layer4.1.conv2.weight, mask/weight parameters,153421,153421 density 0.07651706486003383,0.07651706486003383
before tensor 1048576 mask 103355.0 1048576
layer4.1.conv3.weight, mask/weight parameters,103355,103355 density 0.10692014532574153,0.10692014532574153
before tensor 1048576 mask 34194.0 1048576
layer4.2.conv1.weight, mask/weight parameters,34194,34194 density 0.03537349377648305,0.03537349377648305
before tensor 2359296 mask 44360.0 2359296
layer4.2.conv2.weight, mask/weight parameters,44360,44360 density 0.022124070350154807,0.022124070350154807
before tensor 1048576 mask 48607.0 1048576
layer4.2.conv3.weight, mask/weight parameters,48607,48607 density 0.05028365830243644,0.05028365830243644
classifier.weight, mask/weight parameters,99748,99748 density 0.48705078125,0.48705078125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.11114452728784573 0.11114452728784573 after dst
Death rate: 0.14953425315348498

dynamic sparse change grow
self.total_params*pruning_rate 3536788.940682328
self.total_nonzero 2365205.0
to grow 1171583.9406823278
len(all_scores) 21280445 18913015
increse 1171583.0 before_mask 3536787.0 after_mask 3536787.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1650,1554 density 0.9548611111111112,0.8993055555555556
before tensor 4096 mask 3302.0 4096
layer1.0.conv1.weight, mask/weight parameters,3302,3110 density 0.8457991803278688,0.7966188524590164
before tensor 36864 mask 11602.0 36864
layer1.0.conv2.weight, mask/weight parameters,11602,9365 density 0.3464421153214488,0.27964406222938876
before tensor 16384 mask 10254.0 16384
layer1.0.conv3.weight, mask/weight parameters,10254,9734 density 0.6566342213114754,0.6233350409836066
layer1.0.shortcut.0.weight, mask/weight parameters,11578,10659 density 0.7066650390625,0.65057373046875
before tensor 16384 mask 9704.0 16384
layer1.1.conv1.weight, mask/weight parameters,9704,9352 density 0.6214139344262295,0.5988729508196722
before tensor 36864 mask 8724.0 36864
layer1.1.conv2.weight, mask/weight parameters,8724,6994 density 0.26050344889366656,0.20884469527307475
before tensor 16384 mask 9389.0 16384
layer1.1.conv3.weight, mask/weight parameters,9389,9045 density 0.6012423155737705,0.5792136270491803
before tensor 16384 mask 8953.0 16384
layer1.2.conv1.weight, mask/weight parameters,8953,8797 density 0.5733222336065574,0.5633324795081968
before tensor 36864 mask 6501.0 36864
layer1.2.conv2.weight, mask/weight parameters,6501,5888 density 0.19412344351876737,0.1758189256173669
before tensor 16384 mask 8643.0 16384
layer1.2.conv3.weight, mask/weight parameters,8643,8513 density 0.5534707991803278,0.5451460040983607
before tensor 32768 mask 12384.0 32768
layer2.0.conv1.weight, mask/weight parameters,12384,11068 density 0.4065126050420168,0.3633140756302521
before tensor 147456 mask 22390.0 147456
layer2.0.conv2.weight, mask/weight parameters,22390,18063 density 0.1756781143830081,0.1417272791469529
before tensor 65536 mask 20880.0 65536
layer2.0.conv3.weight, mask/weight parameters,20880,18248 density 0.3426995798319328,0.29950105042016806
layer2.0.shortcut.0.weight, mask/weight parameters,44309,35613 density 0.33805084228515625,0.27170562744140625
before tensor 65536 mask 16882.0 65536
layer2.1.conv1.weight, mask/weight parameters,16882,14941 density 0.2770811449579832,0.24522387079831934
before tensor 147456 mask 21194.0 147456
layer2.1.conv2.weight, mask/weight parameters,21194,16361 density 0.16629396856781928,0.1283729177945688
before tensor 65536 mask 21154.0 65536
layer2.1.conv3.weight, mask/weight parameters,21154,18032 density 0.34719669117647056,0.2959558823529412
before tensor 65536 mask 17218.0 65536
layer2.2.conv1.weight, mask/weight parameters,17218,14467 density 0.2825958508403361,0.23744419642857142
before tensor 147456 mask 25926.0 147456
layer2.2.conv2.weight, mask/weight parameters,25926,14993 density 0.20342254548878375,0.1176392125477642
before tensor 65536 mask 20305.0 65536
layer2.2.conv3.weight, mask/weight parameters,20305,15676 density 0.33326221113445376,0.2572872899159664
before tensor 65536 mask 14810.0 65536
layer2.3.conv1.weight, mask/weight parameters,14810,12774 density 0.24307379201680673,0.20965730042016806
before tensor 147456 mask 19002.0 147456
layer2.3.conv2.weight, mask/weight parameters,19002,13344 density 0.14909493209048325,0.10470070381093614
before tensor 65536 mask 19123.0 65536
layer2.3.conv3.weight, mask/weight parameters,19123,16222 density 0.31386226365546216,0.2662486869747899
before tensor 131072 mask 40548.0 131072
layer3.0.conv1.weight, mask/weight parameters,40548,29753 density 0.3341574367088608,0.2451954773206751
before tensor 589824 mask 118161.0 589824
layer3.0.conv2.weight, mask/weight parameters,118161,78502 density 0.23374103152984743,0.1552892955980068
before tensor 262144 mask 86329.0 262144
layer3.0.conv3.weight, mask/weight parameters,86329,60032 density 0.35572010152953587,0.24736286919831224
layer3.0.shortcut.0.weight, mask/weight parameters,116368,81998 density 0.221954345703125,0.15639877319335938
before tensor 262144 mask 57559.0 262144
layer3.1.conv1.weight, mask/weight parameters,57559,41819 density 0.23717283095991562,0.17231589530590719
before tensor 589824 mask 134147.0 589824
layer3.1.conv2.weight, mask/weight parameters,134147,91334 density 0.2653638523424348,0.18067300863861244
before tensor 262144 mask 90162.0 262144
layer3.1.conv3.weight, mask/weight parameters,90162,65981 density 0.371514042721519,0.2718758241033755
before tensor 262144 mask 68690.0 262144
layer3.2.conv1.weight, mask/weight parameters,68690,49672 density 0.2830383043248945,0.20467431434599156
before tensor 589824 mask 146138.0 589824
layer3.2.conv2.weight, mask/weight parameters,146138,95790 density 0.2890839351876579,0.18948767706979533
before tensor 262144 mask 83818.0 262144
layer3.2.conv3.weight, mask/weight parameters,83818,58972 density 0.34537348364978904,0.24299512130801687
before tensor 262144 mask 63141.0 262144
layer3.3.conv1.weight, mask/weight parameters,63141,42844 density 0.26017355617088606,0.17653942510548523
before tensor 589824 mask 116420.0 589824
layer3.3.conv2.weight, mask/weight parameters,116420,71593 density 0.23029705986497098,0.14162220758385902
before tensor 262144 mask 72775.0 262144
layer3.3.conv3.weight, mask/weight parameters,72775,49228 density 0.2998706157700422,0.20284480485232068
before tensor 262144 mask 59505.0 262144
layer3.4.conv1.weight, mask/weight parameters,59505,39559 density 0.24519135680379747,0.16300352716244726
before tensor 589824 mask 99644.0 589824
layer3.4.conv2.weight, mask/weight parameters,99644,62742 density 0.19711149487360566,0.12411353830998119
before tensor 262144 mask 65225.0 262144
layer3.4.conv3.weight, mask/weight parameters,65225,44308 density 0.26876071334388185,0.18257186181434598
before tensor 262144 mask 53699.0 262144
layer3.5.conv1.weight, mask/weight parameters,53699,30887 density 0.2212676358122363,0.12727040479957805
before tensor 589824 mask 82767.0 589824
layer3.5.conv2.weight, mask/weight parameters,82767,49085 density 0.16372613600621932,0.0970978455890062
before tensor 262144 mask 58028.0 262144
layer3.5.conv3.weight, mask/weight parameters,58028,36767 density 0.23910535337552744,0.15149904404008438
before tensor 524288 mask 113156.0 524288
layer4.0.conv1.weight, mask/weight parameters,113156,65380 density 0.23411844544491525,0.13527045815677965
before tensor 2359296 mask 228615.0 2359296
layer4.0.conv2.weight, mask/weight parameters,228615,116878 density 0.11401925931245811,0.058291638737272174
before tensor 1048576 mask 128102.0 1048576
layer4.0.conv3.weight, mask/weight parameters,128102,80912 density 0.13252077264300846,0.08370299258474577
layer4.0.shortcut.0.weight, mask/weight parameters,252925,166797 density 0.12060403823852539,0.07953500747680664
before tensor 1048576 mask 97359.0 1048576
layer4.1.conv1.weight, mask/weight parameters,97359,67874 density 0.10071731826006355,0.0702152575476695
before tensor 2359296 mask 238973.0 2359296
layer4.1.conv2.weight, mask/weight parameters,238973,153421 density 0.11918519981486801,0.07651706486003383
before tensor 1048576 mask 147399.0 1048576
layer4.1.conv3.weight, mask/weight parameters,147399,103355 density 0.1524834067134534,0.10692014532574153
before tensor 1048576 mask 52839.0 1048576
layer4.2.conv1.weight, mask/weight parameters,52839,34194 density 0.05466163764565678,0.03537349377648305
before tensor 2359296 mask 96500.0 2359296
layer4.2.conv2.weight, mask/weight parameters,96500,44360 density 0.0481283315777714,0.022124070350154807
before tensor 1048576 mask 83032.0 1048576
layer4.2.conv3.weight, mask/weight parameters,83032,48607 density 0.08589612023305085,0.05028365830243644
classifier.weight, mask/weight parameters,118886,99748 density 0.580498046875,0.48705078125
Total Model parameters after dst: 3536787 2365205
Total parameters under density level of 0.1: 0.16619892112218518 0.11114452728784573 after dst
Death rate: 0.14953425315348498


Training summary: Average loss: 1.9717, Accuracy: 23239/50000 (46.478%)


Evaluation: Average loss: 2.0985, Accuracy: 4391/10000 (43.910%)

Current learning rate: 0.1. Time taken for epoch: 89.20 seconds.

Train Epoch: 8 [0/50000 (0%)]	Loss: 1.966638 Accuracy: 45/100 (45.000%
Train Epoch: 8 [10000/50000 (20%)]	Loss: 2.285843 Accuracy: 4784/10100 (47.366%
Train Epoch: 8 [20000/50000 (40%)]	Loss: 1.817912 Accuracy: 9565/20100 (47.587%
Train Epoch: 8 [30000/50000 (60%)]	Loss: 2.034744 Accuracy: 14332/30100 (47.615%
Train Epoch: 8 [40000/50000 (80%)]	Loss: 1.730170 Accuracy: 19270/40100 (48.055%
current layer rate 0.09682271279016841
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6994.0
Total filter_masks items: 18305021.0
6994.0 / 7552 channels
Total channels to prune: 173.2051269913518
Layer ('layer1', 0, 'conv1'): Pruned 1/61.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/61.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/61.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/61.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/61.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/61.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/119.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 11/472.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 11/472.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 11/472.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 11/472.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 11/472.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 11/472.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6846.0
Total filter_masks items: 17689223.0
After apply_mask:
Total filter_names items: 6846.0
Total filter_masks items: 17689223.0
Total pruned: 148/173.2051269913518 channels
===========done ===============

Training summary: Average loss: 1.8935, Accuracy: 23992/50000 (47.984%)


Evaluation: Average loss: 2.5919, Accuracy: 3420/10000 (34.200%)

Current learning rate: 0.1. Time taken for epoch: 89.02 seconds.

Train Epoch: 9 [0/50000 (0%)]	Loss: 1.740895 Accuracy: 51/100 (51.000%
Train Epoch: 9 [10000/50000 (20%)]	Loss: 1.909877 Accuracy: 5039/10100 (49.891%
Train Epoch: 9 [20000/50000 (40%)]	Loss: 1.995347 Accuracy: 9961/20100 (49.557%
Train Epoch: 9 [30000/50000 (60%)]	Loss: 2.168685 Accuracy: 14922/30100 (49.575%
Train Epoch: 9 [40000/50000 (80%)]	Loss: 1.611123 Accuracy: 20014/40100 (49.910%
current mest  death_rate 0.14927354543565144


dynamic sparse change prune
to kill 1023497.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1525,1525 density 0.8825231481481481,0.8825231481481481
before tensor 4096 mask 2714.0 4096
layer1.0.conv1.weight, mask/weight parameters,2714,2714 density 0.7067708333333333,0.7067708333333333
before tensor 36864 mask 8732.0 36864
layer1.0.conv2.weight, mask/weight parameters,8732,8732 density 0.2695061728395062,0.2695061728395062
before tensor 16384 mask 8021.0 16384
layer1.0.conv3.weight, mask/weight parameters,8021,8021 density 0.5222005208333333,0.5222005208333333
layer1.0.shortcut.0.weight, mask/weight parameters,9574,9574 density 0.5843505859375,0.5843505859375
before tensor 16384 mask 7310.0 16384
layer1.1.conv1.weight, mask/weight parameters,7310,7310 density 0.4759114583333333,0.4759114583333333
before tensor 36864 mask 6255.0 36864
layer1.1.conv2.weight, mask/weight parameters,6255,6255 density 0.19305555555555556,0.19305555555555556
before tensor 16384 mask 7232.0 16384
layer1.1.conv3.weight, mask/weight parameters,7232,7232 density 0.4708333333333333,0.4708333333333333
before tensor 16384 mask 6565.0 16384
layer1.2.conv1.weight, mask/weight parameters,6565,6565 density 0.4274088541666667,0.4274088541666667
before tensor 36864 mask 4844.0 36864
layer1.2.conv2.weight, mask/weight parameters,4844,4844 density 0.14950617283950618,0.14950617283950618
before tensor 16384 mask 6466.0 16384
layer1.2.conv3.weight, mask/weight parameters,6466,6466 density 0.42096354166666666,0.42096354166666666
before tensor 32768 mask 8776.0 32768
layer2.0.conv1.weight, mask/weight parameters,8776,8776 density 0.29300213675213677,0.29300213675213677
before tensor 147456 mask 16216.0 147456
layer2.0.conv2.weight, mask/weight parameters,16216,16216 density 0.1316223082604849,0.1316223082604849
before tensor 65536 mask 15514.0 65536
layer2.0.conv3.weight, mask/weight parameters,15514,15514 density 0.2589810363247863,0.2589810363247863
layer2.0.shortcut.0.weight, mask/weight parameters,33404,33404 density 0.254852294921875,0.254852294921875
before tensor 65536 mask 12221.0 65536
layer2.1.conv1.weight, mask/weight parameters,12221,12221 density 0.20400974893162394,0.20400974893162394
before tensor 147456 mask 14503.0 147456
layer2.1.conv2.weight, mask/weight parameters,14503,14503 density 0.11771820033928296,0.11771820033928296
before tensor 65536 mask 15437.0 65536
layer2.1.conv3.weight, mask/weight parameters,15437,15437 density 0.25769564636752135,0.25769564636752135
before tensor 65536 mask 12374.0 65536
layer2.2.conv1.weight, mask/weight parameters,12374,12374 density 0.20656383547008547,0.20656383547008547
before tensor 147456 mask 16998.0 147456
layer2.2.conv2.weight, mask/weight parameters,16998,16998 density 0.1379696593371807,0.1379696593371807
before tensor 65536 mask 14549.0 65536
layer2.2.conv3.weight, mask/weight parameters,14549,14549 density 0.24287192841880342,0.24287192841880342
before tensor 65536 mask 10086.0 65536
layer2.3.conv1.weight, mask/weight parameters,10086,10086 density 0.16836939102564102,0.16836939102564102
before tensor 147456 mask 12969.0 147456
layer2.3.conv2.weight, mask/weight parameters,12969,12969 density 0.10526700270290014,0.10526700270290014
before tensor 65536 mask 13937.0 65536
layer2.3.conv3.weight, mask/weight parameters,13937,13937 density 0.23265558226495728,0.23265558226495728
before tensor 131072 mask 29047.0 131072
layer3.0.conv1.weight, mask/weight parameters,29047,29047 density 0.24453630118534483,0.24453630118534483
before tensor 589824 mask 79587.0 589824
layer3.0.conv2.weight, mask/weight parameters,79587,79587 density 0.16429473840665873,0.16429473840665873
before tensor 262144 mask 63051.0 262144
layer3.0.conv3.weight, mask/weight parameters,63051,63051 density 0.2654019059806034,0.2654019059806034
layer3.0.shortcut.0.weight, mask/weight parameters,83677,83677 density 0.15960121154785156,0.15960121154785156
before tensor 262144 mask 40303.0 262144
layer3.1.conv1.weight, mask/weight parameters,40303,40303 density 0.16964826912715517,0.16964826912715517
before tensor 589824 mask 89656.0 589824
layer3.1.conv2.weight, mask/weight parameters,89656,89656 density 0.18508059188796405,0.18508059188796405
before tensor 262144 mask 66065.0 262144
layer3.1.conv3.weight, mask/weight parameters,66065,66065 density 0.27808879983836204,0.27808879983836204
before tensor 262144 mask 49508.0 262144
layer3.2.conv1.weight, mask/weight parameters,49508,49508 density 0.20839507004310345,0.20839507004310345
before tensor 589824 mask 99476.0 589824
layer3.2.conv2.weight, mask/weight parameters,99476,99476 density 0.20535242436253137,0.20535242436253137
before tensor 262144 mask 61225.0 262144
layer3.2.conv3.weight, mask/weight parameters,61225,61225 density 0.25771568561422414,0.25771568561422414
before tensor 262144 mask 43999.0 262144
layer3.3.conv1.weight, mask/weight parameters,43999,43999 density 0.18520591998922414,0.18520591998922414
before tensor 589824 mask 75202.0 589824
layer3.3.conv2.weight, mask/weight parameters,75202,75202 density 0.1552426014004492,0.1552426014004492
before tensor 262144 mask 51068.0 262144
layer3.3.conv3.weight, mask/weight parameters,51068,51068 density 0.2149616109913793,0.2149616109913793
before tensor 262144 mask 41275.0 262144
layer3.4.conv1.weight, mask/weight parameters,41275,41275 density 0.17373972925646552,0.17373972925646552
before tensor 589824 mask 63945.0 589824
layer3.4.conv2.weight, mask/weight parameters,63945,63945 density 0.1320043103448276,0.1320043103448276
before tensor 262144 mask 45039.0 262144
layer3.4.conv3.weight, mask/weight parameters,45039,45039 density 0.18958361395474138,0.18958361395474138
before tensor 262144 mask 35255.0 262144
layer3.5.conv1.weight, mask/weight parameters,35255,35255 density 0.14839961610991378,0.14839961610991378
before tensor 589824 mask 50686.0 589824
layer3.5.conv2.weight, mask/weight parameters,50686,50686 density 0.10463320782137667,0.10463320782137667
before tensor 262144 mask 38370.0 262144
layer3.5.conv3.weight, mask/weight parameters,38370,38370 density 0.16151165140086207,0.16151165140086207
before tensor 524288 mask 76100.0 524288
layer4.0.conv1.weight, mask/weight parameters,76100,76100 density 0.16120695498915402,0.16120695498915402
before tensor 2359296 mask 129399.0 2359296
layer4.0.conv2.weight, mask/weight parameters,129399,129399 density 0.0676529221425961,0.0676529221425961
before tensor 1048576 mask 82088.0 1048576
layer4.0.conv3.weight, mask/weight parameters,82088,82088 density 0.08694583785249457,0.08694583785249457
layer4.0.shortcut.0.weight, mask/weight parameters,166218,166218 density 0.07925891876220703,0.07925891876220703
before tensor 1048576 mask 67279.0 1048576
layer4.1.conv1.weight, mask/weight parameters,67279,67279 density 0.07126046468275488,0.07126046468275488
before tensor 2359296 mask 149979.0 2359296
layer4.1.conv2.weight, mask/weight parameters,149979,149979 density 0.07841264314271687,0.07841264314271687
before tensor 1048576 mask 97084.0 1048576
layer4.1.conv3.weight, mask/weight parameters,97084,97084 density 0.10282927738611713,0.10282927738611713
before tensor 1048576 mask 32369.0 1048576
layer4.2.conv1.weight, mask/weight parameters,32369,32369 density 0.03428454616323211,0.03428454616323211
before tensor 2359296 mask 42895.0 2359296
layer4.2.conv2.weight, mask/weight parameters,42895,42895 density 0.02242654189991159,0.02242654189991159
before tensor 1048576 mask 46177.0 1048576
layer4.2.conv3.weight, mask/weight parameters,46177,46177 density 0.048909681738069415,0.048909681738069415
classifier.weight, mask/weight parameters,102961,102961 density 0.5027392578125,0.5027392578125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.11445658858822993 0.11445658858822993 after dst
Death rate: 0.14927354543565144

dynamic sparse change grow
self.total_params*pruning_rate 3530622.673397482
self.total_nonzero 2365205.0
to grow 1165417.673397482
len(all_scores) 20664647 18289020
increse 1165417.0 before_mask 3530621.0 after_mask 3530621.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1617,1525 density 0.9357638888888888,0.8825231481481481
before tensor 4096 mask 2902.0 4096
layer1.0.conv1.weight, mask/weight parameters,2902,2714 density 0.7557291666666667,0.7067708333333333
before tensor 36864 mask 10565.0 36864
layer1.0.conv2.weight, mask/weight parameters,10565,8732 density 0.32608024691358023,0.2695061728395062
before tensor 16384 mask 8907.0 16384
layer1.0.conv3.weight, mask/weight parameters,8907,8021 density 0.5798828125,0.5222005208333333
layer1.0.shortcut.0.weight, mask/weight parameters,10492,9574 density 0.640380859375,0.5843505859375
before tensor 16384 mask 7737.0 16384
layer1.1.conv1.weight, mask/weight parameters,7737,7310 density 0.5037109375,0.4759114583333333
before tensor 36864 mask 8543.0 36864
layer1.1.conv2.weight, mask/weight parameters,8543,6255 density 0.2636728395061728,0.19305555555555556
before tensor 16384 mask 8051.0 16384
layer1.1.conv3.weight, mask/weight parameters,8051,7232 density 0.5241536458333333,0.4708333333333333
before tensor 16384 mask 7027.0 16384
layer1.2.conv1.weight, mask/weight parameters,7027,6565 density 0.45748697916666664,0.4274088541666667
before tensor 36864 mask 7152.0 36864
layer1.2.conv2.weight, mask/weight parameters,7152,4844 density 0.22074074074074074,0.14950617283950618
before tensor 16384 mask 7212.0 16384
layer1.2.conv3.weight, mask/weight parameters,7212,6466 density 0.46953125,0.42096354166666666
before tensor 32768 mask 10339.0 32768
layer2.0.conv1.weight, mask/weight parameters,10339,8776 density 0.3451856303418803,0.29300213675213677
before tensor 147456 mask 21602.0 147456
layer2.0.conv2.weight, mask/weight parameters,21602,16216 density 0.17533948588079643,0.1316223082604849
before tensor 65536 mask 17616.0 65536
layer2.0.conv3.weight, mask/weight parameters,17616,15514 density 0.29407051282051283,0.2589810363247863
layer2.0.shortcut.0.weight, mask/weight parameters,42035,33404 density 0.32070159912109375,0.254852294921875
before tensor 65536 mask 14644.0 65536
layer2.1.conv1.weight, mask/weight parameters,14644,12221 density 0.24445779914529914,0.20400974893162394
before tensor 147456 mask 22713.0 147456
layer2.1.conv2.weight, mask/weight parameters,22713,14503 density 0.18435726982735529,0.11771820033928296
before tensor 65536 mask 17991.0 65536
layer2.1.conv3.weight, mask/weight parameters,17991,15437 density 0.30033052884615385,0.25769564636752135
before tensor 65536 mask 15010.0 65536
layer2.2.conv1.weight, mask/weight parameters,15010,12374 density 0.2505675747863248,0.20656383547008547
before tensor 147456 mask 25746.0 147456
layer2.2.conv2.weight, mask/weight parameters,25746,16998 density 0.208975576496944,0.1379696593371807
before tensor 65536 mask 18482.0 65536
layer2.2.conv3.weight, mask/weight parameters,18482,14549 density 0.30852697649572647,0.24287192841880342
before tensor 65536 mask 12095.0 65536
layer2.3.conv1.weight, mask/weight parameters,12095,10086 density 0.20190638354700854,0.16836939102564102
before tensor 147456 mask 17734.0 147456
layer2.3.conv2.weight, mask/weight parameters,17734,12969 density 0.1439436368211297,0.10526700270290014
before tensor 65536 mask 16228.0 65536
layer2.3.conv3.weight, mask/weight parameters,16228,13937 density 0.27090010683760685,0.23265558226495728
before tensor 131072 mask 39555.0 131072
layer3.0.conv1.weight, mask/weight parameters,39555,29047 density 0.3329993938577586,0.24453630118534483
before tensor 589824 mask 121252.0 589824
layer3.0.conv2.weight, mask/weight parameters,121252,79587 density 0.2503055225260933,0.16429473840665873
before tensor 262144 mask 86161.0 262144
layer3.0.conv3.weight, mask/weight parameters,86161,63051 density 0.3626793170797414,0.2654019059806034
layer3.0.shortcut.0.weight, mask/weight parameters,112273,83677 density 0.2141437530517578,0.15960121154785156
before tensor 262144 mask 52880.0 262144
layer3.1.conv1.weight, mask/weight parameters,52880,40303 density 0.22258890086206898,0.16964826912715517
before tensor 589824 mask 129544.0 589824
layer3.1.conv2.weight, mask/weight parameters,129544,89656 density 0.26742304135288675,0.18508059188796405
before tensor 262144 mask 87280.0 262144
layer3.1.conv3.weight, mask/weight parameters,87280,66065 density 0.3673895474137931,0.27808879983836204
before tensor 262144 mask 71578.0 262144
layer3.2.conv1.weight, mask/weight parameters,71578,49508 density 0.30129478717672414,0.20839507004310345
before tensor 589824 mask 149061.0 589824
layer3.2.conv2.weight, mask/weight parameters,149061,99476 density 0.30771279231074117,0.20535242436253137
before tensor 262144 mask 85342.0 262144
layer3.2.conv3.weight, mask/weight parameters,85342,61225 density 0.3592318830818966,0.25771568561422414
before tensor 262144 mask 62953.0 262144
layer3.3.conv1.weight, mask/weight parameters,62953,43999 density 0.26498939251077586,0.18520591998922414
before tensor 589824 mask 112679.0 589824
layer3.3.conv2.weight, mask/weight parameters,112679,75202 density 0.23260792376800105,0.1552426014004492
before tensor 262144 mask 71463.0 262144
layer3.3.conv3.weight, mask/weight parameters,71463,51068 density 0.3008107152478448,0.2149616109913793
before tensor 262144 mask 61022.0 262144
layer3.4.conv1.weight, mask/weight parameters,61022,41275 density 0.25686119342672414,0.17373972925646552
before tensor 589824 mask 101902.0 589824
layer3.4.conv2.weight, mask/weight parameters,101902,63945 density 0.21036051658079005,0.1320043103448276
before tensor 262144 mask 64530.0 262144
layer3.4.conv3.weight, mask/weight parameters,64530,45039 density 0.2716274919181034,0.18958361395474138
before tensor 262144 mask 53682.0 262144
layer3.5.conv1.weight, mask/weight parameters,53682,35255 density 0.22596477640086207,0.14839961610991378
before tensor 589824 mask 83741.0 589824
layer3.5.conv2.weight, mask/weight parameters,83741,50686 density 0.17287001255119566,0.10463320782137667
before tensor 262144 mask 57150.0 262144
layer3.5.conv3.weight, mask/weight parameters,57150,38370 density 0.24056270204741378,0.16151165140086207
before tensor 524288 mask 124304.0 524288
layer4.0.conv1.weight, mask/weight parameters,124304,76100 density 0.26332022776572667,0.16120695498915402
before tensor 2359296 mask 265507.0 2359296
layer4.0.conv2.weight, mask/weight parameters,265507,129399 density 0.1388134715052996,0.0676529221425961
before tensor 1048576 mask 136955.0 1048576
layer4.0.conv3.weight, mask/weight parameters,136955,82088 density 0.14505978002982647,0.08694583785249457
layer4.0.shortcut.0.weight, mask/weight parameters,239654,166218 density 0.11427593231201172,0.07925891876220703
before tensor 1048576 mask 102192.0 1048576
layer4.1.conv1.weight, mask/weight parameters,102192,67279 density 0.10823956073752712,0.07126046468275488
before tensor 2359296 mask 251654.0 2359296
layer4.1.conv2.weight, mask/weight parameters,251654,149979 density 0.13157078855998022,0.07841264314271687
before tensor 1048576 mask 143159.0 1048576
layer4.1.conv3.weight, mask/weight parameters,143159,97084 density 0.151630922925705,0.10282927738611713
before tensor 1048576 mask 51846.0 1048576
layer4.2.conv1.weight, mask/weight parameters,51846,32369 density 0.05491416418112798,0.03428454616323211
before tensor 2359296 mask 91744.0 2359296
layer4.2.conv2.weight, mask/weight parameters,91744,42895 density 0.04796597878693295,0.02242654189991159
before tensor 1048576 mask 70044.0 1048576
layer4.2.conv3.weight, mask/weight parameters,70044,46177 density 0.07418909300433839,0.048909681738069415
classifier.weight, mask/weight parameters,117074,102961 density 0.571650390625,0.5027392578125
Total Model parameters after dst: 3530621 2365205
Total parameters under density level of 0.1: 0.17085319676643884 0.11445658858822993 after dst
Death rate: 0.14927354543565144


Training summary: Average loss: 1.8089, Accuracy: 25060/50000 (50.120%)


Evaluation: Average loss: 2.0929, Accuracy: 4466/10000 (44.660%)

Current learning rate: 0.1. Time taken for epoch: 90.77 seconds.

Train Epoch: 10 [0/50000 (0%)]	Loss: 1.828689 Accuracy: 52/100 (52.000%
Train Epoch: 10 [10000/50000 (20%)]	Loss: 1.734816 Accuracy: 5153/10100 (51.020%
Train Epoch: 10 [20000/50000 (40%)]	Loss: 1.981554 Accuracy: 10176/20100 (50.627%
Train Epoch: 10 [30000/50000 (60%)]	Loss: 1.615222 Accuracy: 15331/30100 (50.934%
Train Epoch: 10 [40000/50000 (80%)]	Loss: 1.741738 Accuracy: 20435/40100 (50.960%
current layer rate 0.11648634501593086
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6846.0
Total filter_masks items: 17689223.0
6846.0 / 7552 channels
Total channels to prune: 173.7048775603098
Layer ('layer1', 0, 'conv1'): Pruned 1/60.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/60.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/60.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/60.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/60.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/60.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/117.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 11/461.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 11/461.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 11/461.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 11/461.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 11/461.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 11/461.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6698.0
Total filter_masks items: 17083001.0
After apply_mask:
Total filter_names items: 6698.0
Total filter_masks items: 17083001.0
Total pruned: 148/173.7048775603098 channels
===========done ===============

Training summary: Average loss: 1.7592, Accuracy: 25570/50000 (51.140%)


Evaluation: Average loss: 2.1804, Accuracy: 4271/10000 (42.710%)

Current learning rate: 0.1. Time taken for epoch: 91.08 seconds.

Train Epoch: 11 [0/50000 (0%)]	Loss: 1.608652 Accuracy: 56/100 (56.000%
Train Epoch: 11 [10000/50000 (20%)]	Loss: 1.960636 Accuracy: 5311/10100 (52.584%
Train Epoch: 11 [20000/50000 (40%)]	Loss: 1.866695 Accuracy: 10616/20100 (52.816%
Train Epoch: 11 [30000/50000 (60%)]	Loss: 1.840957 Accuracy: 15795/30100 (52.475%
Train Epoch: 11 [40000/50000 (80%)]	Loss: 1.752931 Accuracy: 21025/40100 (52.431%
current mest  death_rate 0.14895614572772894


dynamic sparse change prune
to kill 1017976.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1497,1497 density 0.8663194444444444,0.8663194444444444
before tensor 4096 mask 2317.0 4096
layer1.0.conv1.weight, mask/weight parameters,2317,2317 density 0.6136122881355932,0.6136122881355932
before tensor 36864 mask 7961.0 36864
layer1.0.conv2.weight, mask/weight parameters,7961,7961 density 0.2541096109036356,0.2541096109036356
before tensor 16384 mask 6699.0 16384
layer1.0.conv3.weight, mask/weight parameters,6699,6699 density 0.4435248940677966,0.4435248940677966
layer1.0.shortcut.0.weight, mask/weight parameters,8647,8647 density 0.52777099609375,0.52777099609375
before tensor 16384 mask 5527.0 16384
layer1.1.conv1.weight, mask/weight parameters,5527,5527 density 0.3659295550847458,0.3659295550847458
before tensor 36864 mask 6076.0 36864
layer1.1.conv2.weight, mask/weight parameters,6076,6076 density 0.19394171534361135,0.19394171534361135
before tensor 16384 mask 5909.0 16384
layer1.1.conv3.weight, mask/weight parameters,5909,5909 density 0.3912208686440678,0.3912208686440678
before tensor 16384 mask 4903.0 16384
layer1.2.conv1.weight, mask/weight parameters,4903,4903 density 0.3246159957627119,0.3246159957627119
before tensor 36864 mask 4773.0 36864
layer1.2.conv2.weight, mask/weight parameters,4773,4773 density 0.15235085703341952,0.15235085703341952
before tensor 16384 mask 5102.0 16384
layer1.2.conv3.weight, mask/weight parameters,5102,5102 density 0.337791313559322,0.337791313559322
before tensor 32768 mask 6950.0 32768
layer2.0.conv1.weight, mask/weight parameters,6950,6950 density 0.23607336956521738,0.23607336956521738
before tensor 147456 mask 15404.0 147456
layer2.0.conv2.weight, mask/weight parameters,15404,15404 density 0.12941818945599665,0.12941818945599665
before tensor 65536 mask 13037.0 65536
layer2.0.conv3.weight, mask/weight parameters,13037,13037 density 0.2214164402173913,0.2214164402173913
layer2.0.shortcut.0.weight, mask/weight parameters,31612,31612 density 0.241180419921875,0.241180419921875
before tensor 65536 mask 10399.0 65536
layer2.1.conv1.weight, mask/weight parameters,10399,10399 density 0.17661345108695653,0.17661345108695653
before tensor 147456 mask 14456.0 147456
layer2.1.conv2.weight, mask/weight parameters,14456,14456 density 0.12145347616047049,0.12145347616047049
before tensor 65536 mask 13166.0 65536
layer2.1.conv3.weight, mask/weight parameters,13166,13166 density 0.22360733695652174,0.22360733695652174
before tensor 65536 mask 10900.0 65536
layer2.2.conv1.weight, mask/weight parameters,10900,10900 density 0.18512228260869565,0.18512228260869565
before tensor 147456 mask 16984.0 147456
layer2.2.conv2.weight, mask/weight parameters,16984,16984 density 0.14269271161520689,0.14269271161520689
before tensor 65536 mask 13336.0 65536
layer2.2.conv3.weight, mask/weight parameters,13336,13336 density 0.2264945652173913,0.2264945652173913
before tensor 65536 mask 8317.0 65536
layer2.3.conv1.weight, mask/weight parameters,8317,8317 density 0.14125339673913043,0.14125339673913043
before tensor 147456 mask 12094.0 147456
layer2.3.conv2.weight, mask/weight parameters,12094,12094 density 0.10160890569208149,0.10160890569208149
before tensor 65536 mask 11849.0 65536
layer2.3.conv3.weight, mask/weight parameters,11849,11849 density 0.2012398097826087,0.2012398097826087
before tensor 131072 mask 28632.0 131072
layer3.0.conv1.weight, mask/weight parameters,28632,28632 density 0.24635187224669602,0.24635187224669602
before tensor 589824 mask 82485.0 589824
layer3.0.conv2.weight, mask/weight parameters,82485,82485 density 0.17786101030487686,0.17786101030487686
before tensor 262144 mask 64013.0 262144
layer3.0.conv3.weight, mask/weight parameters,64013,64013 density 0.27538632296255505,0.27538632296255505
layer3.0.shortcut.0.weight, mask/weight parameters,81777,81777 density 0.1559772491455078,0.1559772491455078
before tensor 262144 mask 38101.0 262144
layer3.1.conv1.weight, mask/weight parameters,38101,38101 density 0.1639119286894273,0.1639119286894273
before tensor 589824 mask 87151.0 589824
layer3.1.conv2.weight, mask/weight parameters,87151,87151 density 0.1879222271816733,0.1879222271816733
before tensor 262144 mask 64557.0 262144
layer3.1.conv3.weight, mask/weight parameters,64557,64557 density 0.2777266313325991,0.2777266313325991
before tensor 262144 mask 50308.0 262144
layer3.2.conv1.weight, mask/weight parameters,50308,50308 density 0.21642689977973567,0.21642689977973567
before tensor 589824 mask 100919.0 589824
layer3.2.conv2.weight, mask/weight parameters,100919,100919 density 0.2176099327024049,0.2176099327024049
before tensor 262144 mask 62506.0 262144
layer3.2.conv3.weight, mask/weight parameters,62506,62506 density 0.26890315253303965,0.26890315253303965
before tensor 262144 mask 43982.0 262144
layer3.3.conv1.weight, mask/weight parameters,43982,43982 density 0.1892122109030837,0.1892122109030837
before tensor 589824 mask 74591.0 589824
layer3.3.conv2.weight, mask/weight parameters,74591,74591 density 0.1608393116281878,0.1608393116281878
before tensor 262144 mask 50468.0 262144
layer3.3.conv3.weight, mask/weight parameters,50468,50468 density 0.2171152257709251,0.2171152257709251
before tensor 262144 mask 42255.0 262144
layer3.4.conv1.weight, mask/weight parameters,42255,42255 density 0.18178259223568283,0.18178259223568283
before tensor 589824 mask 65286.0 589824
layer3.4.conv2.weight, mask/weight parameters,65286,65286 density 0.14077509751790254,0.14077509751790254
before tensor 262144 mask 44724.0 262144
layer3.4.conv3.weight, mask/weight parameters,44724,44724 density 0.19240432268722468,0.19240432268722468
before tensor 262144 mask 35977.0 262144
layer3.5.conv1.weight, mask/weight parameters,35977,35977 density 0.15477440115638766,0.15477440115638766
before tensor 589824 mask 51644.0 589824
layer3.5.conv2.weight, mask/weight parameters,51644,51644 density 0.11135908366594,0.11135908366594
before tensor 262144 mask 38124.0 262144
layer3.5.conv3.weight, mask/weight parameters,38124,38124 density 0.1640108755506608,0.1640108755506608
before tensor 524288 mask 86091.0 524288
layer4.0.conv1.weight, mask/weight parameters,86091,86091 density 0.18682942708333333,0.18682942708333333
before tensor 2359296 mask 152803.0 2359296
layer4.0.conv2.weight, mask/weight parameters,152803,152803 density 0.08384252400548697,0.08384252400548697
before tensor 1048576 mask 86083.0 1048576
layer4.0.conv3.weight, mask/weight parameters,86083,86083 density 0.09340603298611111,0.09340603298611111
layer4.0.shortcut.0.weight, mask/weight parameters,159628,159628 density 0.07611656188964844,0.07611656188964844
before tensor 1048576 mask 69573.0 1048576
layer4.1.conv1.weight, mask/weight parameters,69573,69573 density 0.07549153645833333,0.07549153645833333
before tensor 2359296 mask 154535.0 2359296
layer4.1.conv2.weight, mask/weight parameters,154535,154535 density 0.0847928669410151,0.0847928669410151
before tensor 1048576 mask 92715.0 1048576
layer4.1.conv3.weight, mask/weight parameters,92715,92715 density 0.10060221354166667,0.10060221354166667
before tensor 1048576 mask 31366.0 1048576
layer4.2.conv1.weight, mask/weight parameters,31366,31366 density 0.03403428819444444,0.03403428819444444
before tensor 2359296 mask 42739.0 2359296
layer4.2.conv2.weight, mask/weight parameters,42739,42739 density 0.023450754458161867,0.023450754458161867
before tensor 1048576 mask 41561.0 1048576
layer4.2.conv3.weight, mask/weight parameters,41561,41561 density 0.04509657118055556,0.04509657118055556
classifier.weight, mask/weight parameters,102696,102696 density 0.5014453125,0.5014453125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.11791578850283609 0.11791578850283609 after dst
Death rate: 0.14895614572772894

dynamic sparse change grow
self.total_params*pruning_rate 3523115.5253489083
self.total_nonzero 2365205.0
to grow 1157910.5253489083
len(all_scores) 20058425 17676995
increse 1157910.0 before_mask 3523114.0 after_mask 3523114.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1609,1497 density 0.9311342592592593,0.8663194444444444
before tensor 4096 mask 2513.0 4096
layer1.0.conv1.weight, mask/weight parameters,2513,2317 density 0.6655190677966102,0.6136122881355932
before tensor 36864 mask 10125.0 36864
layer1.0.conv2.weight, mask/weight parameters,10125,7961 density 0.32318299339270323,0.2541096109036356
before tensor 16384 mask 7420.0 16384
layer1.0.conv3.weight, mask/weight parameters,7420,6699 density 0.491260593220339,0.4435248940677966
layer1.0.shortcut.0.weight, mask/weight parameters,9586,8647 density 0.5850830078125,0.52777099609375
before tensor 16384 mask 6213.0 16384
layer1.1.conv1.weight, mask/weight parameters,6213,5527 density 0.4113479872881356,0.3659295550847458
before tensor 36864 mask 7750.0 36864
layer1.1.conv2.weight, mask/weight parameters,7750,6076 density 0.24737463691787162,0.19394171534361135
before tensor 16384 mask 6385.0 16384
layer1.1.conv3.weight, mask/weight parameters,6385,5909 density 0.4227356991525424,0.3912208686440678
before tensor 16384 mask 5462.0 16384
layer1.2.conv1.weight, mask/weight parameters,5462,4903 density 0.3616260593220339,0.3246159957627119
before tensor 36864 mask 6031.0 36864
layer1.2.conv2.weight, mask/weight parameters,6031,4773 density 0.19250534648408824,0.15235085703341952
before tensor 16384 mask 5731.0 16384
layer1.2.conv3.weight, mask/weight parameters,5731,5102 density 0.3794359110169492,0.337791313559322
before tensor 32768 mask 8434.0 32768
layer2.0.conv1.weight, mask/weight parameters,8434,6950 density 0.28648097826086955,0.23607336956521738
before tensor 147456 mask 21145.0 147456
layer2.0.conv2.weight, mask/weight parameters,21145,15404 density 0.17765175383322832,0.12941818945599665
before tensor 65536 mask 14984.0 65536
layer2.0.conv3.weight, mask/weight parameters,14984,13037 density 0.25448369565217394,0.2214164402173913
layer2.0.shortcut.0.weight, mask/weight parameters,40621,31612 density 0.30991363525390625,0.241180419921875
before tensor 65536 mask 13297.0 65536
layer2.1.conv1.weight, mask/weight parameters,13297,10399 density 0.22583220108695654,0.17661345108695653
before tensor 147456 mask 20958.0 147456
layer2.1.conv2.weight, mask/weight parameters,20958,14456 density 0.17608065532451167,0.12145347616047049
before tensor 65536 mask 16268.0 65536
layer2.1.conv3.weight, mask/weight parameters,16268,13166 density 0.2762907608695652,0.22360733695652174
before tensor 65536 mask 15037.0 65536
layer2.2.conv1.weight, mask/weight parameters,15037,10900 density 0.25538383152173916,0.18512228260869565
before tensor 147456 mask 23631.0 147456
layer2.2.conv2.weight, mask/weight parameters,23631,16984 density 0.1985381222432262,0.14269271161520689
before tensor 65536 mask 17715.0 65536
layer2.2.conv3.weight, mask/weight parameters,17715,13336 density 0.30086616847826086,0.2264945652173913
before tensor 65536 mask 12864.0 65536
layer2.3.conv1.weight, mask/weight parameters,12864,8317 density 0.2184782608695652,0.14125339673913043
before tensor 147456 mask 17554.0 147456
layer2.3.conv2.weight, mask/weight parameters,17554,12094 density 0.14748162150808652,0.10160890569208149
before tensor 65536 mask 14252.0 65536
layer2.3.conv3.weight, mask/weight parameters,14252,11849 density 0.24205163043478262,0.2012398097826087
before tensor 131072 mask 42763.0 131072
layer3.0.conv1.weight, mask/weight parameters,42763,28632 density 0.3679360545154185,0.24635187224669602
before tensor 589824 mask 126663.0 589824
layer3.0.conv2.weight, mask/weight parameters,126663,82485 density 0.27312128445470835,0.17786101030487686
before tensor 262144 mask 86782.0 262144
layer3.0.conv3.weight, mask/weight parameters,86782,64013 density 0.3733394135462555,0.27538632296255505
layer3.0.shortcut.0.weight, mask/weight parameters,113673,81777 density 0.2168140411376953,0.1559772491455078
before tensor 262144 mask 52210.0 262144
layer3.1.conv1.weight, mask/weight parameters,52210,38101 density 0.224609375,0.1639119286894273
before tensor 589824 mask 123543.0 589824
layer3.1.conv2.weight, mask/weight parameters,123543,87151 density 0.26639368122804635,0.1879222271816733
before tensor 262144 mask 86461.0 262144
layer3.1.conv3.weight, mask/weight parameters,86461,64557 density 0.3719584595264317,0.2777266313325991
before tensor 262144 mask 66442.0 262144
layer3.2.conv1.weight, mask/weight parameters,66442,50308 density 0.28583597191629956,0.21642689977973567
before tensor 589824 mask 142274.0 589824
layer3.2.conv2.weight, mask/weight parameters,142274,100919 density 0.30678301970195854,0.2176099327024049
before tensor 262144 mask 82556.0 262144
layer3.2.conv3.weight, mask/weight parameters,82556,62506 density 0.35515900330396477,0.26890315253303965
before tensor 262144 mask 63820.0 262144
layer3.3.conv1.weight, mask/weight parameters,63820,43982 density 0.2745560297356828,0.1892122109030837
before tensor 589824 mask 116395.0 589824
layer3.3.conv2.weight, mask/weight parameters,116395,74591 density 0.25098056973311683,0.1608393116281878
before tensor 262144 mask 71186.0 262144
layer3.3.conv3.weight, mask/weight parameters,71186,50468 density 0.3062448375550661,0.2171152257709251
before tensor 262144 mask 61025.0 262144
layer3.4.conv1.weight, mask/weight parameters,61025,42255 density 0.2625318350770925,0.18178259223568283
before tensor 589824 mask 102603.0 589824
layer3.4.conv2.weight, mask/weight parameters,102603,65286 density 0.22124111341833402,0.14077509751790254
before tensor 262144 mask 63064.0 262144
layer3.4.conv3.weight, mask/weight parameters,63064,44724 density 0.27130368942731276,0.19240432268722468
before tensor 262144 mask 52852.0 262144
layer3.5.conv1.weight, mask/weight parameters,52852,35977 density 0.22737128303964757,0.15477440115638766
before tensor 589824 mask 81131.0 589824
layer3.5.conv2.weight, mask/weight parameters,81131,51644 density 0.17494140300715239,0.11135908366594
before tensor 262144 mask 53025.0 262144
layer3.5.conv3.weight, mask/weight parameters,53025,38124 density 0.22811553551762115,0.1640108755506608
before tensor 524288 mask 135559.0 524288
layer4.0.conv1.weight, mask/weight parameters,135559,86091 density 0.2941818576388889,0.18682942708333333
before tensor 2359296 mask 279676.0 2359296
layer4.0.conv2.weight, mask/weight parameters,279676,152803 density 0.15345733882030177,0.08384252400548697
before tensor 1048576 mask 135658.0 1048576
layer4.0.conv3.weight, mask/weight parameters,135658,86083 density 0.14719835069444445,0.09340603298611111
layer4.0.shortcut.0.weight, mask/weight parameters,236705,159628 density 0.1128697395324707,0.07611656188964844
before tensor 1048576 mask 104265.0 1048576
layer4.1.conv1.weight, mask/weight parameters,104265,69573 density 0.113134765625,0.07549153645833333
before tensor 2359296 mask 251390.0 2359296
layer4.1.conv2.weight, mask/weight parameters,251390,154535 density 0.13793689986282578,0.0847928669410151
before tensor 1048576 mask 134128.0 1048576
layer4.1.conv3.weight, mask/weight parameters,134128,92715 density 0.14553819444444444,0.10060221354166667
before tensor 1048576 mask 52410.0 1048576
layer4.2.conv1.weight, mask/weight parameters,52410,31366 density 0.056868489583333334,0.03403428819444444
before tensor 2359296 mask 110509.0 2359296
layer4.2.conv2.weight, mask/weight parameters,110509,42739 density 0.06063593964334705,0.023450754458161867
before tensor 1048576 mask 73186.0 1048576
layer4.2.conv3.weight, mask/weight parameters,73186,41561 density 0.07941189236111111,0.04509657118055556
classifier.weight, mask/weight parameters,115575,102696 density 0.5643310546875,0.5014453125
Total Model parameters after dst: 3523114 2365205
Total parameters under density level of 0.1: 0.17564260404293958 0.11791578850283609 after dst
Death rate: 0.14895614572772894


Training summary: Average loss: 1.7091, Accuracy: 26278/50000 (52.556%)


Evaluation: Average loss: 1.8126, Accuracy: 5088/10000 (50.880%)

Current learning rate: 0.1. Time taken for epoch: 90.47 seconds.

Train Epoch: 12 [0/50000 (0%)]	Loss: 1.557929 Accuracy: 59/100 (59.000%
Train Epoch: 12 [10000/50000 (20%)]	Loss: 1.583695 Accuracy: 5511/10100 (54.564%
Train Epoch: 12 [20000/50000 (40%)]	Loss: 1.535376 Accuracy: 10886/20100 (54.159%
Train Epoch: 12 [30000/50000 (60%)]	Loss: 1.904087 Accuracy: 16271/30100 (54.056%
Train Epoch: 12 [40000/50000 (80%)]	Loss: 1.690384 Accuracy: 21547/40100 (53.733%
current layer rate 0.13549999999999995
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6698.0
Total filter_masks items: 17083001.0
6698.0 / 7552 channels
Total channels to prune: 169.29599999999937
Layer ('layer1', 0, 'conv1'): Pruned 1/59.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/59.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/59.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/59.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/59.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/59.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/115.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 11/450.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 11/450.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 11/450.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 11/450.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 11/450.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 11/450.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6550.0
Total filter_masks items: 16486355.0
After apply_mask:
Total filter_names items: 6550.0
Total filter_masks items: 16486355.0
Total pruned: 148/169.29599999999937 channels
===========done ===============

Training summary: Average loss: 1.6712, Accuracy: 26809/50000 (53.618%)


Evaluation: Average loss: 2.1216, Accuracy: 4397/10000 (43.970%)

Current learning rate: 0.1. Time taken for epoch: 89.80 seconds.

Train Epoch: 13 [0/50000 (0%)]	Loss: 1.636457 Accuracy: 53/100 (53.000%
Train Epoch: 13 [10000/50000 (20%)]	Loss: 1.464236 Accuracy: 5502/10100 (54.475%
Train Epoch: 13 [20000/50000 (40%)]	Loss: 1.885491 Accuracy: 11001/20100 (54.731%
Train Epoch: 13 [30000/50000 (60%)]	Loss: 1.448863 Accuracy: 16418/30100 (54.545%
Train Epoch: 13 [40000/50000 (80%)]	Loss: 1.567338 Accuracy: 21912/40100 (54.643%
current mest  death_rate 0.1485827953314434


dynamic sparse change prune
to kill 1004270.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1465,1465 density 0.8478009259259259,0.8478009259259259
before tensor 4096 mask 1929.0 4096
layer1.0.conv1.weight, mask/weight parameters,1929,1929 density 0.5196659482758621,0.5196659482758621
before tensor 36864 mask 7350.0 36864
layer1.0.conv2.weight, mask/weight parameters,7350,7350 density 0.24276654776060247,0.24276654776060247
before tensor 16384 mask 5581.0 16384
layer1.0.conv3.weight, mask/weight parameters,5581,5581 density 0.3758755387931034,0.3758755387931034
layer1.0.shortcut.0.weight, mask/weight parameters,8027,8027 density 0.48992919921875,0.48992919921875
before tensor 16384 mask 4323.0 16384
layer1.1.conv1.weight, mask/weight parameters,4323,4323 density 0.29115032327586204,0.29115032327586204
before tensor 36864 mask 5495.0 36864
layer1.1.conv2.weight, mask/weight parameters,5495,5495 density 0.18149689523054566,0.18149689523054566
before tensor 16384 mask 4612.0 16384
layer1.1.conv3.weight, mask/weight parameters,4612,4612 density 0.31061422413793105,0.31061422413793105
before tensor 16384 mask 3704.0 16384
layer1.2.conv1.weight, mask/weight parameters,3704,3704 density 0.2494612068965517,0.2494612068965517
before tensor 36864 mask 4214.0 36864
layer1.2.conv2.weight, mask/weight parameters,4214,4214 density 0.13918615404941206,0.13918615404941206
before tensor 16384 mask 4132.0 16384
layer1.2.conv3.weight, mask/weight parameters,4132,4132 density 0.2782866379310345,0.2782866379310345
before tensor 32768 mask 5682.0 32768
layer2.0.conv1.weight, mask/weight parameters,5682,5682 density 0.1964186946902655,0.1964186946902655
before tensor 147456 mask 14952.0 147456
layer2.0.conv2.weight, mask/weight parameters,14952,14952 density 0.1301067689978333,0.1301067689978333
before tensor 65536 mask 11271.0 65536
layer2.0.conv3.weight, mask/weight parameters,11271,11271 density 0.19481125553097345,0.19481125553097345
layer2.0.shortcut.0.weight, mask/weight parameters,30253,30253 density 0.23081207275390625,0.23081207275390625
before tensor 65536 mask 9486.0 65536
layer2.1.conv1.weight, mask/weight parameters,9486,9486 density 0.16395879424778761,0.16395879424778761
before tensor 147456 mask 13588.0 147456
layer2.1.conv2.weight, mask/weight parameters,13588,13588 density 0.11823774592981265,0.11823774592981265
before tensor 65536 mask 11685.0 65536
layer2.1.conv3.weight, mask/weight parameters,11685,11685 density 0.2019669524336283,0.2019669524336283
before tensor 65536 mask 10685.0 65536
layer2.2.conv1.weight, mask/weight parameters,10685,10685 density 0.1846826603982301,0.1846826603982301
before tensor 147456 mask 16294.0 147456
layer2.2.conv2.weight, mask/weight parameters,16294,16294 density 0.1417843562099181,0.1417843562099181
before tensor 65536 mask 12421.0 65536
layer2.2.conv3.weight, mask/weight parameters,12421,12421 density 0.2146881913716814,0.2146881913716814
before tensor 65536 mask 7816.0 65536
layer2.3.conv1.weight, mask/weight parameters,7816,7816 density 0.13509402654867256,0.13509402654867256
before tensor 147456 mask 11193.0 147456
layer2.3.conv2.weight, mask/weight parameters,11193,11193 density 0.09739734252225442,0.09739734252225442
before tensor 65536 mask 10298.0 65536
layer2.3.conv3.weight, mask/weight parameters,10298,10298 density 0.17799363938053098,0.17799363938053098
before tensor 131072 mask 29758.0 131072
layer3.0.conv1.weight, mask/weight parameters,29758,29758 density 0.2618067286036036,0.2618067286036036
before tensor 589824 mask 85708.0 589824
layer3.0.conv2.weight, mask/weight parameters,85708,85708 density 0.19322926530133738,0.19322926530133738
before tensor 262144 mask 64663.0 262144
layer3.0.conv3.weight, mask/weight parameters,64663,64663 density 0.28444802224099097,0.28444802224099097
layer3.0.shortcut.0.weight, mask/weight parameters,82066,82066 density 0.15652847290039062,0.15652847290039062
before tensor 262144 mask 37489.0 262144
layer3.1.conv1.weight, mask/weight parameters,37489,37489 density 0.16491149352477477,0.16491149352477477
before tensor 589824 mask 84832.0 589824
layer3.1.conv2.weight, mask/weight parameters,84832,84832 density 0.19125431738044352,0.19125431738044352
before tensor 262144 mask 64287.0 262144
layer3.1.conv3.weight, mask/weight parameters,64287,64287 density 0.28279402449324326,0.28279402449324326
before tensor 262144 mask 48089.0 262144
layer3.2.conv1.weight, mask/weight parameters,48089,48089 density 0.21154015343468469,0.21154015343468469
before tensor 589824 mask 98594.0 589824
layer3.2.conv2.weight, mask/weight parameters,98594,98594 density 0.2222808393979565,0.2222808393979565
before tensor 262144 mask 60978.0 262144
layer3.2.conv3.weight, mask/weight parameters,60978,60978 density 0.26823796452702703,0.26823796452702703
before tensor 262144 mask 45043.0 262144
layer3.3.conv1.weight, mask/weight parameters,45043,45043 density 0.19814101210585586,0.19814101210585586
before tensor 589824 mask 76790.0 589824
layer3.3.conv2.weight, mask/weight parameters,76790,76790 density 0.17312357402447492,0.17312357402447492
before tensor 262144 mask 50505.0 262144
layer3.3.conv3.weight, mask/weight parameters,50505,50505 density 0.22216796875,0.22216796875
before tensor 262144 mask 42429.0 262144
layer3.4.conv1.weight, mask/weight parameters,42429,42429 density 0.18664220861486486,0.18664220861486486
before tensor 589824 mask 65849.0 589824
layer3.4.conv2.weight, mask/weight parameters,65849,65849 density 0.14845701557413268,0.14845701557413268
before tensor 262144 mask 43640.0 262144
layer3.4.conv3.weight, mask/weight parameters,43640,43640 density 0.19196931306306306,0.19196931306306306
before tensor 262144 mask 36813.0 262144
layer3.5.conv1.weight, mask/weight parameters,36813,36813 density 0.16193781672297297,0.16193781672297297
before tensor 589824 mask 51615.0 589824
layer3.5.conv2.weight, mask/weight parameters,51615,51615 density 0.11636636636636637,0.11636636636636637
before tensor 262144 mask 36738.0 262144
layer3.5.conv3.weight, mask/weight parameters,36738,36738 density 0.16160789695945946,0.16160789695945946
before tensor 524288 mask 94677.0 524288
layer4.0.conv1.weight, mask/weight parameters,94677,94677 density 0.21061049615603644,0.21061049615603644
before tensor 2359296 mask 166653.0 2359296
layer4.0.conv2.weight, mask/weight parameters,166653,166653 density 0.09608190077884611,0.09608190077884611
before tensor 1048576 mask 88232.0 1048576
layer4.0.conv3.weight, mask/weight parameters,88232,88232 density 0.09813674544419135,0.09813674544419135
layer4.0.shortcut.0.weight, mask/weight parameters,156968,156968 density 0.07484817504882812,0.07484817504882812
before tensor 1048576 mask 71622.0 1048576
layer4.1.conv1.weight, mask/weight parameters,71622,71622 density 0.07966214051822323,0.07966214051822323
before tensor 2359296 mask 157623.0 2359296
layer4.1.conv2.weight, mask/weight parameters,157623,157623 density 0.0908757564908166,0.0908757564908166
before tensor 1048576 mask 89007.0 1048576
layer4.1.conv3.weight, mask/weight parameters,89007,89007 density 0.09899874537300683,0.09899874537300683
before tensor 1048576 mask 31696.0 1048576
layer4.2.conv1.weight, mask/weight parameters,31696,31696 density 0.035254128701594535,0.035254128701594535
before tensor 2359296 mask 44156.0 2359296
layer4.2.conv2.weight, mask/weight parameters,44156,44156 density 0.025457641991387666,0.025457641991387666
before tensor 1048576 mask 40019.0 1048576
layer4.2.conv3.weight, mask/weight parameters,40019,40019 density 0.04451145180808656,0.04451145180808656
classifier.weight, mask/weight parameters,102210,102210 density 0.499072265625,0.499072265625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.12153077064537625 0.12153077064537625 after dst
Death rate: 0.1485827953314434

dynamic sparse change grow
self.total_params*pruning_rate 3514285.0298287496
self.total_nonzero 2365205.0
to grow 1149080.0298287496
len(all_scores) 19461779 17073786
increse 1149080.0 before_mask 3514284.0 after_mask 3514284.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1557,1465 density 0.9010416666666666,0.8478009259259259
before tensor 4096 mask 2095.0 4096
layer1.0.conv1.weight, mask/weight parameters,2095,1929 density 0.564385775862069,0.5196659482758621
before tensor 36864 mask 9324.0 36864
layer1.0.conv2.weight, mask/weight parameters,9324,7350 density 0.3079667063020214,0.24276654776060247
before tensor 16384 mask 6486.0 16384
layer1.0.conv3.weight, mask/weight parameters,6486,5581 density 0.43682650862068967,0.3758755387931034
layer1.0.shortcut.0.weight, mask/weight parameters,9116,8027 density 0.556396484375,0.48992919921875
before tensor 16384 mask 4938.0 16384
layer1.1.conv1.weight, mask/weight parameters,4938,4323 density 0.3325700431034483,0.29115032327586204
before tensor 36864 mask 7066.0 36864
layer1.1.conv2.weight, mask/weight parameters,7066,5495 density 0.2333861804729819,0.18149689523054566
before tensor 16384 mask 5334.0 16384
layer1.1.conv3.weight, mask/weight parameters,5334,4612 density 0.35924030172413796,0.31061422413793105
before tensor 16384 mask 4320.0 16384
layer1.2.conv1.weight, mask/weight parameters,4320,3704 density 0.29094827586206895,0.2494612068965517
before tensor 36864 mask 5892.0 36864
layer1.2.conv2.weight, mask/weight parameters,5892,4214 density 0.19460959175584622,0.13918615404941206
before tensor 16384 mask 4912.0 16384
layer1.2.conv3.weight, mask/weight parameters,4912,4132 density 0.3308189655172414,0.2782866379310345
before tensor 32768 mask 7800.0 32768
layer2.0.conv1.weight, mask/weight parameters,7800,5682 density 0.2696349557522124,0.1964186946902655
before tensor 147456 mask 19874.0 147456
layer2.0.conv2.weight, mask/weight parameters,19874,14952 density 0.17293619094856466,0.1301067689978333
before tensor 65536 mask 13862.0 65536
layer2.0.conv3.weight, mask/weight parameters,13862,11271 density 0.23959485619469026,0.19481125553097345
layer2.0.shortcut.0.weight, mask/weight parameters,38841,30253 density 0.29633331298828125,0.23081207275390625
before tensor 65536 mask 12269.0 65536
layer2.1.conv1.weight, mask/weight parameters,12269,9486 density 0.2120609789823009,0.16395879424778761
before tensor 147456 mask 21257.0 147456
layer2.1.conv2.weight, mask/weight parameters,21257,13588 density 0.18497054498307533,0.11823774592981265
before tensor 65536 mask 14562.0 65536
layer2.1.conv3.weight, mask/weight parameters,14562,11685 density 0.251693860619469,0.2019669524336283
before tensor 65536 mask 13866.0 65536
layer2.2.conv1.weight, mask/weight parameters,13866,10685 density 0.23966399336283187,0.1846826603982301
before tensor 147456 mask 26699.0 147456
layer2.2.conv2.weight, mask/weight parameters,26699,16294 density 0.2323248144377442,0.1417843562099181
before tensor 65536 mask 16311.0 65536
layer2.2.conv3.weight, mask/weight parameters,16311,12421 density 0.2819240873893805,0.2146881913716814
before tensor 65536 mask 9735.0 65536
layer2.3.conv1.weight, mask/weight parameters,9735,7816 density 0.16826258296460178,0.13509402654867256
before tensor 147456 mask 15337.0 147456
layer2.3.conv2.weight, mask/weight parameters,15337,11193 density 0.13345689647671008,0.09739734252225442
before tensor 65536 mask 12577.0 65536
layer2.3.conv3.weight, mask/weight parameters,12577,10298 density 0.21738454092920353,0.17799363938053098
before tensor 131072 mask 40608.0 131072
layer3.0.conv1.weight, mask/weight parameters,40608,29758 density 0.3572635135135135,0.2618067286036036
before tensor 589824 mask 126762.0 589824
layer3.0.conv2.weight, mask/weight parameters,126762,85708 density 0.2857857857857858,0.19322926530133738
before tensor 262144 mask 87990.0 262144
layer3.0.conv3.weight, mask/weight parameters,87990,64663 density 0.38706186655405406,0.28444802224099097
layer3.0.shortcut.0.weight, mask/weight parameters,115085,82066 density 0.21950721740722656,0.15652847290039062
before tensor 262144 mask 52699.0 262144
layer3.1.conv1.weight, mask/weight parameters,52699,37489 density 0.23181922156531531,0.16491149352477477
before tensor 589824 mask 126120.0 589824
layer3.1.conv2.weight, mask/weight parameters,126120,84832 density 0.28433839244650055,0.19125431738044352
before tensor 262144 mask 86093.0 262144
layer3.1.conv3.weight, mask/weight parameters,86093,64287 density 0.37871709600225223,0.28279402449324326
before tensor 262144 mask 65946.0 262144
layer3.2.conv1.weight, mask/weight parameters,65946,48089 density 0.29009184966216217,0.21154015343468469
before tensor 589824 mask 144299.0 589824
layer3.2.conv2.weight, mask/weight parameters,144299,98594 density 0.3253230708185663,0.2222808393979565
before tensor 262144 mask 83708.0 262144
layer3.2.conv3.weight, mask/weight parameters,83708,60978 density 0.3682256475225225,0.26823796452702703
before tensor 262144 mask 59808.0 262144
layer3.3.conv1.weight, mask/weight parameters,59808,45043 density 0.26309121621621623,0.19814101210585586
before tensor 589824 mask 108870.0 589824
layer3.3.conv2.weight, mask/weight parameters,108870,76790 density 0.24544815085355626,0.17312357402447492
before tensor 262144 mask 67933.0 262144
layer3.3.conv3.weight, mask/weight parameters,67933,50505 density 0.29883252393018017,0.22216796875
before tensor 262144 mask 62025.0 262144
layer3.4.conv1.weight, mask/weight parameters,62025,42429 density 0.27284364442567566,0.18664220861486486
before tensor 589824 mask 97904.0 589824
layer3.4.conv2.weight, mask/weight parameters,97904,65849 density 0.22072522973423875,0.14845701557413268
before tensor 262144 mask 60809.0 262144
layer3.4.conv3.weight, mask/weight parameters,60809,43640 density 0.26749454532657657,0.19196931306306306
before tensor 262144 mask 53343.0 262144
layer3.5.conv1.weight, mask/weight parameters,53343,36813 density 0.23465213260135134,0.16193781672297297
before tensor 589824 mask 81250.0 589824
layer3.5.conv2.weight, mask/weight parameters,81250,51615 density 0.18317867416966516,0.11636636636636637
before tensor 262144 mask 52458.0 262144
layer3.5.conv3.weight, mask/weight parameters,52458,36738 density 0.23075907939189189,0.16160789695945946
before tensor 524288 mask 140501.0 524288
layer4.0.conv1.weight, mask/weight parameters,140501,94677 density 0.3125467148348519,0.21061049615603644
before tensor 2359296 mask 296228.0 2359296
layer4.0.conv2.weight, mask/weight parameters,296228,166653 density 0.17078690034932478,0.09608190077884611
before tensor 1048576 mask 140473.0 1048576
layer4.0.conv3.weight, mask/weight parameters,140473,88232 density 0.15624221419419135,0.09813674544419135
layer4.0.shortcut.0.weight, mask/weight parameters,235616,156968 density 0.1123504638671875,0.07484817504882812
before tensor 1048576 mask 104187.0 1048576
layer4.1.conv1.weight, mask/weight parameters,104187,71622 density 0.11588282139806379,0.07966214051822323
before tensor 2359296 mask 259589.0 2359296
layer4.1.conv2.weight, mask/weight parameters,259589,157623 density 0.1496630996218483,0.0908757564908166
before tensor 1048576 mask 136597.0 1048576
layer4.1.conv3.weight, mask/weight parameters,136597,89007 density 0.15193110229214124,0.09899874537300683
before tensor 1048576 mask 53828.0 1048576
layer4.2.conv1.weight, mask/weight parameters,53828,31696 density 0.05987062215261959,0.035254128701594535
before tensor 2359296 mask 107194.0 2359296
layer4.2.conv2.weight, mask/weight parameters,107194,44156 density 0.06180148735448884,0.025457641991387666
before tensor 1048576 mask 65404.0 1048576
layer4.2.conv3.weight, mask/weight parameters,65404,40019 density 0.07274612044419135,0.04451145180808656
classifier.weight, mask/weight parameters,116927,102210 density 0.5709326171875,0.499072265625
Total Model parameters after dst: 3514284 2365205
Total parameters under density level of 0.1: 0.18057362587459244 0.12153077064537625 after dst
Death rate: 0.1485827953314434


Training summary: Average loss: 1.6247, Accuracy: 27331/50000 (54.662%)


Evaluation: Average loss: 2.0245, Accuracy: 4598/10000 (45.980%)

Current learning rate: 0.1. Time taken for epoch: 90.77 seconds.

Train Epoch: 14 [0/50000 (0%)]	Loss: 1.577967 Accuracy: 51/100 (51.000%
Train Epoch: 14 [10000/50000 (20%)]	Loss: 1.655307 Accuracy: 5493/10100 (54.386%
Train Epoch: 14 [20000/50000 (40%)]	Loss: 1.703537 Accuracy: 11003/20100 (54.741%
Train Epoch: 14 [30000/50000 (60%)]	Loss: 1.673421 Accuracy: 16439/30100 (54.615%
Train Epoch: 14 [40000/50000 (80%)]	Loss: 1.651381 Accuracy: 21911/40100 (54.641%
current layer rate 0.15387460172963136
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6550.0
Total filter_masks items: 16486355.0
6550.0 / 7552 channels
Total channels to prune: 160.0609922621752
Layer ('layer1', 0, 'conv1'): Pruned 1/58.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/58.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/58.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/58.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/58.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/58.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/113.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 10/439.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 10/439.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 10/439.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 10/439.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 10/439.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 10/439.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6408.0
Total filter_masks items: 15933688.0
After apply_mask:
Total filter_names items: 6408.0
Total filter_masks items: 15933688.0
Total pruned: 142/160.0609922621752 channels
===========done ===============

Training summary: Average loss: 1.6109, Accuracy: 27353/50000 (54.706%)


Evaluation: Average loss: 1.8741, Accuracy: 4896/10000 (48.960%)

Current learning rate: 0.1. Time taken for epoch: 89.30 seconds.

Train Epoch: 15 [0/50000 (0%)]	Loss: 1.348906 Accuracy: 61/100 (61.000%
Train Epoch: 15 [10000/50000 (20%)]	Loss: 1.473843 Accuracy: 5667/10100 (56.109%
Train Epoch: 15 [20000/50000 (40%)]	Loss: 1.511206 Accuracy: 11299/20100 (56.214%
Train Epoch: 15 [30000/50000 (60%)]	Loss: 1.688497 Accuracy: 16769/30100 (55.711%
Train Epoch: 15 [40000/50000 (80%)]	Loss: 1.801753 Accuracy: 22186/40100 (55.327%
current mest  death_rate 0.14815436622394432


dynamic sparse change prune
to kill 998810.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1427,1427 density 0.8258101851851852,0.8258101851851852
before tensor 4096 mask 1671.0 4096
layer1.0.conv1.weight, mask/weight parameters,1671,1671 density 0.45805921052631576,0.45805921052631576
before tensor 36864 mask 6842.0 36864
layer1.0.conv2.weight, mask/weight parameters,6842,6842 density 0.23398652576861256,0.23398652576861256
before tensor 16384 mask 4961.0 16384
layer1.0.conv3.weight, mask/weight parameters,4961,4961 density 0.3399808114035088,0.3399808114035088
layer1.0.shortcut.0.weight, mask/weight parameters,7636,7636 density 0.466064453125,0.466064453125
before tensor 16384 mask 3550.0 16384
layer1.1.conv1.weight, mask/weight parameters,3550,3550 density 0.24328399122807018,0.24328399122807018
before tensor 36864 mask 5069.0 36864
layer1.1.conv2.weight, mask/weight parameters,5069,5069 density 0.17335248452515303,0.17335248452515303
before tensor 16384 mask 3884.0 16384
layer1.1.conv3.weight, mask/weight parameters,3884,3884 density 0.2661732456140351,0.2661732456140351
before tensor 16384 mask 3013.0 16384
layer1.2.conv1.weight, mask/weight parameters,3013,3013 density 0.20648300438596492,0.20648300438596492
before tensor 36864 mask 3928.0 36864
layer1.2.conv2.weight, mask/weight parameters,3928,3928 density 0.13433193119250367,0.13433193119250367
before tensor 16384 mask 3535.0 16384
layer1.2.conv3.weight, mask/weight parameters,3535,3535 density 0.2422560307017544,0.2422560307017544
before tensor 32768 mask 5045.0 32768
layer2.0.conv1.weight, mask/weight parameters,5045,5045 density 0.17754082207207209,0.17754082207207209
before tensor 147456 mask 13886.0 147456
layer2.0.conv2.weight, mask/weight parameters,13886,13886 density 0.12522432342252163,0.12522432342252163
before tensor 65536 mask 10195.0 65536
layer2.0.conv3.weight, mask/weight parameters,10195,10195 density 0.17938837274774774,0.17938837274774774
layer2.0.shortcut.0.weight, mask/weight parameters,29213,29213 density 0.22287750244140625,0.22287750244140625
before tensor 65536 mask 8750.0 65536
layer2.1.conv1.weight, mask/weight parameters,8750,8750 density 0.15396255630630631,0.15396255630630631
before tensor 147456 mask 13537.0 147456
layer2.1.conv2.weight, mask/weight parameters,13537,13537 density 0.12207703198694189,0.12207703198694189
before tensor 65536 mask 10435.0 65536
layer2.1.conv3.weight, mask/weight parameters,10435,10435 density 0.18361134572072071,0.18361134572072071
before tensor 65536 mask 10181.0 65536
layer2.2.conv1.weight, mask/weight parameters,10181,10181 density 0.17914203265765766,0.17914203265765766
before tensor 147456 mask 17487.0 147456
layer2.2.conv2.weight, mask/weight parameters,17487,17487 density 0.15769823877931985,0.15769823877931985
before tensor 65536 mask 11587.0 65536
layer2.2.conv3.weight, mask/weight parameters,11587,11587 density 0.203881615990991,0.203881615990991
before tensor 65536 mask 6838.0 65536
layer2.3.conv1.weight, mask/weight parameters,6838,6838 density 0.12031953828828829,0.12031953828828829
before tensor 147456 mask 10813.0 147456
layer2.3.conv2.weight, mask/weight parameters,10813,10813 density 0.09751192634075517,0.09751192634075517
before tensor 65536 mask 9068.0 65536
layer2.3.conv3.weight, mask/weight parameters,9068,9068 density 0.15955799549549549,0.15955799549549549
before tensor 131072 mask 28806.0 131072
layer3.0.conv1.weight, mask/weight parameters,28806,28806 density 0.25927059331797236,0.25927059331797236
before tensor 589824 mask 86117.0 589824
layer3.0.conv2.weight, mask/weight parameters,86117,86117 density 0.2032015025920184,0.2032015025920184
before tensor 262144 mask 65723.0 262144
layer3.0.conv3.weight, mask/weight parameters,65723,65723 density 0.2957724294354839,0.2957724294354839
layer3.0.shortcut.0.weight, mask/weight parameters,82681,82681 density 0.1577014923095703,0.1577014923095703
before tensor 262144 mask 37104.0 262144
layer3.1.conv1.weight, mask/weight parameters,37104,37104 density 0.1669786866359447,0.1669786866359447
before tensor 589824 mask 85200.0 589824
layer3.1.conv2.weight, mask/weight parameters,85200,85200 density 0.2010377512087041,0.2010377512087041
before tensor 262144 mask 63792.0 262144
layer3.1.conv3.weight, mask/weight parameters,63792,63792 density 0.2870823732718894,0.2870823732718894
before tensor 262144 mask 47722.0 262144
layer3.2.conv1.weight, mask/weight parameters,47722,47722 density 0.2147627448156682,0.2147627448156682
before tensor 589824 mask 100280.0 589824
layer3.2.conv2.weight, mask/weight parameters,100280,100280 density 0.23662048933343716,0.23662048933343716
before tensor 262144 mask 61806.0 262144
layer3.2.conv3.weight, mask/weight parameters,61806,61806 density 0.2781448012672811,0.2781448012672811
before tensor 262144 mask 43106.0 262144
layer3.3.conv1.weight, mask/weight parameters,43106,43106 density 0.19398941532258066,0.19398941532258066
before tensor 589824 mask 74410.0 589824
layer3.3.conv2.weight, mask/weight parameters,74410,74410 density 0.17557768858497266,0.17557768858497266
before tensor 262144 mask 48990.0 262144
layer3.3.conv3.weight, mask/weight parameters,48990,48990 density 0.22046911002304148,0.22046911002304148
before tensor 262144 mask 43105.0 262144
layer3.4.conv1.weight, mask/weight parameters,43105,43105 density 0.19398491503456222,0.19398491503456222
before tensor 589824 mask 64356.0 589824
layer3.4.conv2.weight, mask/weight parameters,64356,64356 density 0.15185429010313803,0.15185429010313803
before tensor 262144 mask 42553.0 262144
layer3.4.conv3.weight, mask/weight parameters,42553,42553 density 0.1915007560483871,0.1915007560483871
before tensor 262144 mask 36985.0 262144
layer3.5.conv1.weight, mask/weight parameters,36985,36985 density 0.16644315236175114,0.16644315236175114
before tensor 589824 mask 52635.0 589824
layer3.5.conv2.weight, mask/weight parameters,52635,52635 density 0.12419744172382793,0.12419744172382793
before tensor 262144 mask 36397.0 262144
layer3.5.conv3.weight, mask/weight parameters,36397,36397 density 0.16379698300691245,0.16379698300691245
before tensor 524288 mask 100533.0 524288
layer4.0.conv1.weight, mask/weight parameters,100533,100533 density 0.2288502513111888,0.2288502513111888
before tensor 2359296 mask 178332.0 2359296
layer4.0.conv2.weight, mask/weight parameters,178332,178332 density 0.10766441535672305,0.10766441535672305
before tensor 1048576 mask 90459.0 1048576
layer4.0.conv3.weight, mask/weight parameters,90459,90459 density 0.10295905266608392,0.10295905266608392
layer4.0.shortcut.0.weight, mask/weight parameters,154559,154559 density 0.0736994743347168,0.0736994743347168
before tensor 1048576 mask 71550.0 1048576
layer4.1.conv1.weight, mask/weight parameters,71550,71550 density 0.08143711756993006,0.08143711756993006
before tensor 2359296 mask 161215.0 2359296
layer4.1.conv2.weight, mask/weight parameters,161215,161215 density 0.09733036539563346,0.09733036539563346
before tensor 1048576 mask 88871.0 1048576
layer4.1.conv3.weight, mask/weight parameters,88871,88871 density 0.10115161531177157,0.10115161531177157
before tensor 1048576 mask 31687.0 1048576
layer4.2.conv1.weight, mask/weight parameters,31687,31687 density 0.03606565960081585,0.03606565960081585
before tensor 2359296 mask 44003.0 2359296
layer4.2.conv2.weight, mask/weight parameters,44003,44003 density 0.02656594031885407,0.02656594031885407
before tensor 1048576 mask 37307.0 1048576
layer4.2.conv3.weight, mask/weight parameters,37307,37307 density 0.04246225779428905,0.04246225779428905
classifier.weight, mask/weight parameters,102370,102370 density 0.499853515625,0.499853515625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.12508281721531925 0.12508281721531925 after dst
Death rate: 0.14815436622394432

dynamic sparse change grow
self.total_params*pruning_rate 3504151.81086845
self.total_nonzero 2365205.0
to grow 1138946.81086845
len(all_scores) 18909112 16511694
increse 1138947.0 before_mask 3504150.0 after_mask 3504150.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1579,1427 density 0.9137731481481481,0.8258101851851852
before tensor 4096 mask 1863.0 4096
layer1.0.conv1.weight, mask/weight parameters,1863,1671 density 0.5106907894736842,0.45805921052631576
before tensor 36864 mask 8947.0 36864
layer1.0.conv2.weight, mask/weight parameters,8947,6842 density 0.30597448787661163,0.23398652576861256
before tensor 16384 mask 5853.0 16384
layer1.0.conv3.weight, mask/weight parameters,5853,4961 density 0.4011101973684211,0.3399808114035088
layer1.0.shortcut.0.weight, mask/weight parameters,8761,7636 density 0.53472900390625,0.466064453125
before tensor 16384 mask 4543.0 16384
layer1.1.conv1.weight, mask/weight parameters,4543,3550 density 0.31133497807017546,0.24328399122807018
before tensor 36864 mask 6828.0 36864
layer1.1.conv2.weight, mask/weight parameters,6828,5069 density 0.23350774597311993,0.17335248452515303
before tensor 16384 mask 4579.0 16384
layer1.1.conv3.weight, mask/weight parameters,4579,3884 density 0.3138020833333333,0.2661732456140351
before tensor 16384 mask 4011.0 16384
layer1.2.conv1.weight, mask/weight parameters,4011,3013 density 0.2748766447368421,0.20648300438596492
before tensor 36864 mask 5642.0 36864
layer1.2.conv2.weight, mask/weight parameters,5642,3928 density 0.19294825758353,0.13433193119250367
before tensor 16384 mask 4393.0 16384
layer1.2.conv3.weight, mask/weight parameters,4393,3535 density 0.30105537280701755,0.2422560307017544
before tensor 32768 mask 6442.0 32768
layer2.0.conv1.weight, mask/weight parameters,6442,5045 density 0.22670326576576577,0.17754082207207209
before tensor 147456 mask 18510.0 147456
layer2.0.conv2.weight, mask/weight parameters,18510,13886 density 0.16692368043719394,0.12522432342252163
before tensor 65536 mask 12835.0 65536
layer2.0.conv3.weight, mask/weight parameters,12835,10195 density 0.22584107545045046,0.17938837274774774
layer2.0.shortcut.0.weight, mask/weight parameters,38722,29213 density 0.2954254150390625,0.22287750244140625
before tensor 65536 mask 10567.0 65536
layer2.1.conv1.weight, mask/weight parameters,10567,8750 density 0.18593398085585586,0.15396255630630631
before tensor 147456 mask 18763.0 147456
layer2.1.conv2.weight, mask/weight parameters,18763,13537 density 0.16920524127731335,0.12207703198694189
before tensor 65536 mask 13150.0 65536
layer2.1.conv3.weight, mask/weight parameters,13150,10435 density 0.23138372747747749,0.18361134572072071
before tensor 65536 mask 12832.0 65536
layer2.2.conv1.weight, mask/weight parameters,12832,10181 density 0.22578828828828829,0.17914203265765766
before tensor 147456 mask 23181.0 147456
layer2.2.conv2.weight, mask/weight parameters,23181,17487 density 0.2090468847225604,0.15769823877931985
before tensor 65536 mask 15179.0 65536
layer2.2.conv3.weight, mask/weight parameters,15179,11587 density 0.26708544481981983,0.203881615990991
before tensor 65536 mask 9566.0 65536
layer2.3.conv1.weight, mask/weight parameters,9566,6838 density 0.16832066441441443,0.12031953828828829
before tensor 147456 mask 15562.0 147456
layer2.3.conv2.weight, mask/weight parameters,15562,10813 density 0.14033853673493313,0.09751192634075517
before tensor 65536 mask 11651.0 65536
layer2.3.conv3.weight, mask/weight parameters,11651,9068 density 0.20500774211711711,0.15955799549549549
before tensor 131072 mask 38640.0 131072
layer3.0.conv1.weight, mask/weight parameters,38640,28806 density 0.3477822580645161,0.25927059331797236
before tensor 589824 mask 123618.0 589824
layer3.0.conv2.weight, mask/weight parameters,123618,86117 density 0.29168878789809366,0.2032015025920184
before tensor 262144 mask 88564.0 262144
layer3.0.conv3.weight, mask/weight parameters,88564,65723 density 0.3985635080645161,0.2957724294354839
layer3.0.shortcut.0.weight, mask/weight parameters,118443,82681 density 0.22591209411621094,0.1577014923095703
before tensor 262144 mask 51487.0 262144
layer3.1.conv1.weight, mask/weight parameters,51487,37104 density 0.23170632920506912,0.1669786866359447
before tensor 589824 mask 127744.0 589824
layer3.1.conv2.weight, mask/weight parameters,127744,85200 density 0.3014244893239988,0.2010377512087041
before tensor 262144 mask 85874.0 262144
layer3.1.conv3.weight, mask/weight parameters,85874,63792 density 0.3864577332949309,0.2870823732718894
before tensor 262144 mask 66132.0 262144
layer3.2.conv1.weight, mask/weight parameters,66132,47722 density 0.297613047235023,0.2147627448156682
before tensor 589824 mask 143308.0 589824
layer3.2.conv2.weight, mask/weight parameters,143308,100280 density 0.33814927288987046,0.23662048933343716
before tensor 262144 mask 84223.0 262144
layer3.2.conv3.weight, mask/weight parameters,84223,61806 density 0.3790277577764977,0.2781448012672811
before tensor 262144 mask 63931.0 262144
layer3.3.conv1.weight, mask/weight parameters,63931,43106 density 0.2877079133064516,0.19398941532258066
before tensor 589824 mask 116026.0 589824
layer3.3.conv2.weight, mask/weight parameters,116026,74410 density 0.2737747197387453,0.17557768858497266
before tensor 262144 mask 70745.0 262144
layer3.3.conv3.weight, mask/weight parameters,70745,48990 density 0.3183728758640553,0.22046911002304148
before tensor 262144 mask 61239.0 262144
layer3.4.conv1.weight, mask/weight parameters,61239,43105 density 0.2755931379608295,0.19398491503456222
before tensor 589824 mask 97196.0 589824
layer3.4.conv2.weight, mask/weight parameters,97196,64356 density 0.2293434890432066,0.15185429010313803
before tensor 262144 mask 61701.0 262144
layer3.4.conv3.weight, mask/weight parameters,61701,42553 density 0.27767227102534564,0.1915007560483871
before tensor 262144 mask 55432.0 262144
layer3.5.conv1.weight, mask/weight parameters,55432,36985 density 0.249459965437788,0.16644315236175114
before tensor 589824 mask 84004.0 589824
layer3.5.conv2.weight, mask/weight parameters,84004,52635 density 0.19821567197812182,0.12419744172382793
before tensor 262144 mask 54343.0 262144
layer3.5.conv3.weight, mask/weight parameters,54343,36397 density 0.24455915178571427,0.16379698300691245
before tensor 524288 mask 150057.0 524288
layer4.0.conv1.weight, mask/weight parameters,150057,100533 density 0.34158517263986016,0.2288502513111888
before tensor 2359296 mask 302117.0 2359296
layer4.0.conv2.weight, mask/weight parameters,302117,178332 density 0.18239715908713577,0.10766441535672305
before tensor 1048576 mask 138316.0 1048576
layer4.0.conv3.weight, mask/weight parameters,138316,90459 density 0.15742915938228438,0.10295905266608392
layer4.0.shortcut.0.weight, mask/weight parameters,227805,154559 density 0.10862588882446289,0.0736994743347168
before tensor 1048576 mask 104940.0 1048576
layer4.1.conv1.weight, mask/weight parameters,104940,71550 density 0.11944110576923077,0.08143711756993006
before tensor 2359296 mask 264940.0 2359296
layer4.1.conv2.weight, mask/weight parameters,264940,161215 density 0.15995228116440238,0.09733036539563346
before tensor 1048576 mask 131323.0 1048576
layer4.1.conv3.weight, mask/weight parameters,131323,88871 density 0.1494698335518648,0.10115161531177157
before tensor 1048576 mask 52499.0 1048576
layer4.2.conv1.weight, mask/weight parameters,52499,31687 density 0.05975356024184149,0.03606565960081585
before tensor 2359296 mask 99788.0 2359296
layer4.2.conv2.weight, mask/weight parameters,99788,44003 density 0.06024502994199964,0.02656594031885407
before tensor 1048576 mask 61871.0 1048576
layer4.2.conv3.weight, mask/weight parameters,61871,37307 density 0.07042062754953379,0.04246225779428905
classifier.weight, mask/weight parameters,113885,102370 density 0.5560791015625,0.499853515625
Total Model parameters after dst: 3504150 2365205
Total parameters under density level of 0.1: 0.18531541830203344 0.12508281721531925 after dst
Death rate: 0.14815436622394432


Training summary: Average loss: 1.5763, Accuracy: 27700/50000 (55.400%)


Evaluation: Average loss: 1.8185, Accuracy: 5081/10000 (50.810%)

Current learning rate: 0.1. Time taken for epoch: 89.16 seconds.

Train Epoch: 16 [0/50000 (0%)]	Loss: 1.409347 Accuracy: 57/100 (57.000%
Train Epoch: 16 [10000/50000 (20%)]	Loss: 1.762500 Accuracy: 5774/10100 (57.168%
Train Epoch: 16 [20000/50000 (40%)]	Loss: 1.806496 Accuracy: 11362/20100 (56.527%
Train Epoch: 16 [30000/50000 (60%)]	Loss: 1.602747 Accuracy: 16948/30100 (56.306%
Train Epoch: 16 [40000/50000 (80%)]	Loss: 1.802691 Accuracy: 22587/40100 (56.327%
current layer rate 0.17162107419208006
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6408.0
Total filter_masks items: 15933688.0
6408.0 / 7552 channels
Total channels to prune: 152.08235229858838
Layer ('layer1', 0, 'conv1'): Pruned 1/57.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/57.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/57.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/57.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/57.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/57.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/111.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 10/429.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 10/429.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 10/429.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 10/429.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 10/429.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 10/429.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6266.0
Total filter_masks items: 15389463.0
After apply_mask:
Total filter_names items: 6266.0
Total filter_masks items: 15389463.0
Total pruned: 142/152.08235229858838 channels
===========done ===============

Training summary: Average loss: 1.5519, Accuracy: 28148/50000 (56.296%)


Evaluation: Average loss: 2.0855, Accuracy: 4522/10000 (45.220%)

Current learning rate: 0.1. Time taken for epoch: 90.58 seconds.

Train Epoch: 17 [0/50000 (0%)]	Loss: 1.653041 Accuracy: 57/100 (57.000%
Train Epoch: 17 [10000/50000 (20%)]	Loss: 1.547944 Accuracy: 5737/10100 (56.802%
Train Epoch: 17 [20000/50000 (40%)]	Loss: 1.804428 Accuracy: 11455/20100 (56.990%
Train Epoch: 17 [30000/50000 (60%)]	Loss: 1.612859 Accuracy: 17164/30100 (57.023%
Train Epoch: 17 [40000/50000 (80%)]	Loss: 1.489684 Accuracy: 22849/40100 (56.980%
current mest  death_rate 0.14767185902126345


dynamic sparse change prune
to kill 996645.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1439,1439 density 0.8327546296296297,0.8327546296296297
before tensor 4096 mask 1491.0 4096
layer1.0.conv1.weight, mask/weight parameters,1491,1491 density 0.416015625,0.416015625
before tensor 36864 mask 6458.0 36864
layer1.0.conv2.weight, mask/weight parameters,6458,6458 density 0.22881235827664398,0.22881235827664398
before tensor 16384 mask 4457.0 16384
layer1.0.conv3.weight, mask/weight parameters,4457,4457 density 0.31089564732142855,0.31089564732142855
layer1.0.shortcut.0.weight, mask/weight parameters,7312,7312 density 0.4462890625,0.4462890625
before tensor 16384 mask 3186.0 16384
layer1.1.conv1.weight, mask/weight parameters,3186,3186 density 0.22223772321428573,0.22223772321428573
before tensor 36864 mask 4997.0 36864
layer1.1.conv2.weight, mask/weight parameters,4997,4997 density 0.17704790249433106,0.17704790249433106
before tensor 16384 mask 3451.0 16384
layer1.1.conv3.weight, mask/weight parameters,3451,3451 density 0.24072265625,0.24072265625
before tensor 16384 mask 2660.0 16384
layer1.2.conv1.weight, mask/weight parameters,2660,2660 density 0.185546875,0.185546875
before tensor 36864 mask 3858.0 36864
layer1.2.conv2.weight, mask/weight parameters,3858,3858 density 0.1366921768707483,0.1366921768707483
before tensor 16384 mask 3095.0 16384
layer1.2.conv3.weight, mask/weight parameters,3095,3095 density 0.21589006696428573,0.21589006696428573
before tensor 32768 mask 4506.0 32768
layer2.0.conv1.weight, mask/weight parameters,4506,4506 density 0.1614822247706422,0.1614822247706422
before tensor 147456 mask 13151.0 147456
layer2.0.conv2.weight, mask/weight parameters,13151,13151 density 0.1229881510160948,0.1229881510160948
before tensor 65536 mask 9427.0 65536
layer2.0.conv3.weight, mask/weight parameters,9427,9427 density 0.16891843463302753,0.16891843463302753
layer2.0.shortcut.0.weight, mask/weight parameters,28576,28576 density 0.218017578125,0.218017578125
before tensor 65536 mask 7840.0 65536
layer2.1.conv1.weight, mask/weight parameters,7840,7840 density 0.1404816513761468,0.1404816513761468
before tensor 147456 mask 12983.0 147456
layer2.1.conv2.weight, mask/weight parameters,12983,12983 density 0.12141701502866388,0.12141701502866388
before tensor 65536 mask 9731.0 65536
layer2.1.conv3.weight, mask/weight parameters,9731,9731 density 0.17436568233944955,0.17436568233944955
before tensor 65536 mask 9541.0 65536
layer2.2.conv1.weight, mask/weight parameters,9541,9541 density 0.17096115252293578,0.17096115252293578
before tensor 147456 mask 16077.0 147456
layer2.2.conv2.weight, mask/weight parameters,16077,16077 density 0.15035210279718317,0.15035210279718317
before tensor 65536 mask 10894.0 65536
layer2.2.conv3.weight, mask/weight parameters,10894,10894 density 0.1952049885321101,0.1952049885321101
before tensor 65536 mask 6662.0 65536
layer2.3.conv1.weight, mask/weight parameters,6662,6662 density 0.11937356651376146,0.11937356651376146
before tensor 147456 mask 10861.0 147456
layer2.3.conv2.weight, mask/weight parameters,10861,10861 density 0.10157207118742342,0.10157207118742342
before tensor 65536 mask 8205.0 65536
layer2.3.conv3.weight, mask/weight parameters,8205,8205 density 0.14702193233944955,0.14702193233944955
before tensor 131072 mask 27879.0 131072
layer3.0.conv1.weight, mask/weight parameters,27879,27879 density 0.2568451503537736,0.2568451503537736
before tensor 589824 mask 85355.0 589824
layer3.0.conv2.weight, mask/weight parameters,85355,85355 density 0.21101568371504292,0.21101568371504292
before tensor 262144 mask 66177.0 262144
layer3.0.conv3.weight, mask/weight parameters,66177,66177 density 0.3048395120872642,0.3048395120872642
layer3.0.shortcut.0.weight, mask/weight parameters,84540,84540 density 0.16124725341796875,0.16124725341796875
before tensor 262144 mask 36531.0 262144
layer3.1.conv1.weight, mask/weight parameters,36531,36531 density 0.1682773806014151,0.1682773806014151
before tensor 589824 mask 85976.0 589824
layer3.1.conv2.weight, mask/weight parameters,85976,85976 density 0.2125509275740675,0.2125509275740675
before tensor 262144 mask 63473.0 262144
layer3.1.conv3.weight, mask/weight parameters,63473,63473 density 0.29238373378537735,0.29238373378537735
before tensor 262144 mask 47384.0 262144
layer3.2.conv1.weight, mask/weight parameters,47384,47384 density 0.2182709316037736,0.2182709316037736
before tensor 589824 mask 98956.0 589824
layer3.2.conv2.weight, mask/weight parameters,98956,98956 density 0.24464024366124756,0.24464024366124756
before tensor 262144 mask 62041.0 262144
layer3.2.conv3.weight, mask/weight parameters,62041,62041 density 0.2857873304834906,0.2857873304834906
before tensor 262144 mask 44031.0 262144
layer3.3.conv1.weight, mask/weight parameters,44031,44031 density 0.2028255822523585,0.2028255822523585
before tensor 589824 mask 76054.0 589824
layer3.3.conv2.weight, mask/weight parameters,76054,76054 density 0.18802163680234169,0.18802163680234169
before tensor 262144 mask 49811.0 262144
layer3.3.conv3.weight, mask/weight parameters,49811,49811 density 0.22945072965801888,0.22945072965801888
before tensor 262144 mask 42730.0 262144
layer3.4.conv1.weight, mask/weight parameters,42730,42730 density 0.1968326208726415,0.1968326208726415
before tensor 589824 mask 63593.0 589824
layer3.4.conv2.weight, mask/weight parameters,63593,63593 density 0.1572153989161821,0.1572153989161821
before tensor 262144 mask 42470.0 262144
layer3.4.conv3.weight, mask/weight parameters,42470,42470 density 0.19563494988207547,0.19563494988207547
before tensor 262144 mask 38381.0 262144
layer3.5.conv1.weight, mask/weight parameters,38381,38381 density 0.17679927034198112,0.17679927034198112
before tensor 589824 mask 53883.0 589824
layer3.5.conv2.weight, mask/weight parameters,53883,53883 density 0.13321021715913137,0.13321021715913137
before tensor 262144 mask 36956.0 262144
layer3.5.conv3.weight, mask/weight parameters,36956,36956 density 0.17023511202830188,0.17023511202830188
before tensor 524288 mask 107404.0 524288
layer4.0.conv1.weight, mask/weight parameters,107404,107404 density 0.2503262977326969,0.2503262977326969
before tensor 2359296 mask 187722.0 2359296
layer4.0.conv2.weight, mask/weight parameters,187722,187722 density 0.11880770786222453,0.11880770786222453
before tensor 1048576 mask 91238.0 1048576
layer4.0.conv3.weight, mask/weight parameters,91238,91238 density 0.10632411619928402,0.10632411619928402
layer4.0.shortcut.0.weight, mask/weight parameters,149352,149352 density 0.07121658325195312,0.07121658325195312
before tensor 1048576 mask 72306.0 1048576
layer4.1.conv1.weight, mask/weight parameters,72306,72306 density 0.08426172807279236,0.08426172807279236
before tensor 2359296 mask 163975.0 2359296
layer4.1.conv2.weight, mask/weight parameters,163975,163975 density 0.10377842712472841,0.10377842712472841
before tensor 1048576 mask 85239.0 1048576
layer4.1.conv3.weight, mask/weight parameters,85239,85239 density 0.09933318727625298,0.09933318727625298
before tensor 1048576 mask 31602.0 1048576
layer4.2.conv1.weight, mask/weight parameters,31602,31602 density 0.036827360531026254,0.036827360531026254
before tensor 2359296 mask 43388.0 2359296
layer4.2.conv2.weight, mask/weight parameters,43388,43388 density 0.027459907888932558,0.027459907888932558
before tensor 1048576 mask 35207.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35207,35207 density 0.04102844383949881,0.04102844383949881
classifier.weight, mask/weight parameters,100693,100693 density 0.4916650390625,0.4916650390625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.12878952100277014 0.12878952100277014 after dst
Death rate: 0.14767185902126345

dynamic sparse change grow
self.total_params*pruning_rate 3492739.535070412
self.total_nonzero 2365205.0
to grow 1127534.5350704119
len(all_scores) 18364887 15947216
increse 1127534.0 before_mask 3492738.0 after_mask 3492738.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1554,1439 density 0.8993055555555556,0.8327546296296297
before tensor 4096 mask 1733.0 4096
layer1.0.conv1.weight, mask/weight parameters,1733,1491 density 0.48353794642857145,0.416015625
before tensor 36864 mask 8358.0 36864
layer1.0.conv2.weight, mask/weight parameters,8358,6458 density 0.2961309523809524,0.22881235827664398
before tensor 16384 mask 5819.0 16384
layer1.0.conv3.weight, mask/weight parameters,5819,4457 density 0.40590122767857145,0.31089564732142855
layer1.0.shortcut.0.weight, mask/weight parameters,8818,7312 density 0.5382080078125,0.4462890625
before tensor 16384 mask 4413.0 16384
layer1.1.conv1.weight, mask/weight parameters,4413,3186 density 0.30782645089285715,0.22223772321428573
before tensor 36864 mask 6704.0 36864
layer1.1.conv2.weight, mask/weight parameters,6704,4997 density 0.23752834467120182,0.17704790249433106
before tensor 16384 mask 4806.0 16384
layer1.1.conv3.weight, mask/weight parameters,4806,3451 density 0.33523995535714285,0.24072265625
before tensor 16384 mask 3525.0 16384
layer1.2.conv1.weight, mask/weight parameters,3525,2660 density 0.24588448660714285,0.185546875
before tensor 36864 mask 5268.0 36864
layer1.2.conv2.weight, mask/weight parameters,5268,3858 density 0.18664965986394558,0.1366921768707483
before tensor 16384 mask 4375.0 16384
layer1.2.conv3.weight, mask/weight parameters,4375,3095 density 0.30517578125,0.21589006696428573
before tensor 32768 mask 7497.0 32768
layer2.0.conv1.weight, mask/weight parameters,7497,4506 density 0.26867115825688076,0.1614822247706422
before tensor 147456 mask 18007.0 147456
layer2.0.conv2.weight, mask/weight parameters,18007,13151 density 0.1684014626527883,0.1229881510160948
before tensor 65536 mask 11756.0 65536
layer2.0.conv3.weight, mask/weight parameters,11756,9427 density 0.2106508027522936,0.16891843463302753
layer2.0.shortcut.0.weight, mask/weight parameters,40112,28576 density 0.3060302734375,0.218017578125
before tensor 65536 mask 9908.0 65536
layer2.1.conv1.weight, mask/weight parameters,9908,7840 density 0.17753727064220184,0.1404816513761468
before tensor 147456 mask 21857.0 147456
layer2.1.conv2.weight, mask/weight parameters,21857,12983 density 0.2044066623647467,0.12141701502866388
before tensor 65536 mask 14572.0 65536
layer2.1.conv3.weight, mask/weight parameters,14572,9731 density 0.26110951834862384,0.17436568233944955
before tensor 65536 mask 14309.0 65536
layer2.2.conv1.weight, mask/weight parameters,14309,9541 density 0.25639693233944955,0.17096115252293578
before tensor 147456 mask 24107.0 147456
layer2.2.conv2.weight, mask/weight parameters,24107,16077 density 0.22544866219641072,0.15035210279718317
before tensor 65536 mask 15512.0 65536
layer2.2.conv3.weight, mask/weight parameters,15512,10894 density 0.27795298165137616,0.1952049885321101
before tensor 65536 mask 9805.0 65536
layer2.3.conv1.weight, mask/weight parameters,9805,6662 density 0.17569165711009174,0.11937356651376146
before tensor 147456 mask 14137.0 147456
layer2.3.conv2.weight, mask/weight parameters,14137,10861 density 0.1322092229423262,0.10157207118742342
before tensor 65536 mask 10442.0 65536
layer2.3.conv3.weight, mask/weight parameters,10442,8205 density 0.18710579128440366,0.14702193233944955
before tensor 131072 mask 39326.0 131072
layer3.0.conv1.weight, mask/weight parameters,39326,27879 density 0.3623046875,0.2568451503537736
before tensor 589824 mask 120307.0 589824
layer3.0.conv2.weight, mask/weight parameters,120307,85355 density 0.2974244491910921,0.21101568371504292
before tensor 262144 mask 88752.0 262144
layer3.0.conv3.weight, mask/weight parameters,88752,66177 density 0.40882959905660377,0.3048395120872642
layer3.0.shortcut.0.weight, mask/weight parameters,121916,84540 density 0.23253631591796875,0.16124725341796875
before tensor 262144 mask 49259.0 262144
layer3.1.conv1.weight, mask/weight parameters,49259,36531 density 0.22690798201650944,0.1682773806014151
before tensor 589824 mask 130336.0 589824
layer3.1.conv2.weight, mask/weight parameters,130336,85976 density 0.3222182666824888,0.2125509275740675
before tensor 262144 mask 85648.0 262144
layer3.1.conv3.weight, mask/weight parameters,85648,63473 density 0.39453125,0.29238373378537735
before tensor 262144 mask 65524.0 262144
layer3.2.conv1.weight, mask/weight parameters,65524,47384 density 0.3018315153301887,0.2182709316037736
before tensor 589824 mask 142838.0 589824
layer3.2.conv2.weight, mask/weight parameters,142838,98956 density 0.35312586527431666,0.24464024366124756
before tensor 262144 mask 84947.0 262144
layer3.2.conv3.weight, mask/weight parameters,84947,62041 density 0.39130214475235847,0.2857873304834906
before tensor 262144 mask 61686.0 262144
layer3.3.conv1.weight, mask/weight parameters,61686,44031 density 0.28415204893867924,0.2028255822523585
before tensor 589824 mask 109431.0 589824
layer3.3.conv2.weight, mask/weight parameters,109431,76054 density 0.2705366678533286,0.18802163680234169
before tensor 262144 mask 69412.0 262144
layer3.3.conv3.weight, mask/weight parameters,69412,49811 density 0.31974130306603776,0.22945072965801888
before tensor 262144 mask 59256.0 262144
layer3.4.conv1.weight, mask/weight parameters,59256,42730 density 0.2729584316037736,0.1968326208726415
before tensor 589824 mask 94383.0 589824
layer3.4.conv2.weight, mask/weight parameters,94383,63593 density 0.23333481666073336,0.1572153989161821
before tensor 262144 mask 60765.0 262144
layer3.4.conv3.weight, mask/weight parameters,60765,42470 density 0.2799095297759434,0.19563494988207547
before tensor 262144 mask 53231.0 262144
layer3.5.conv1.weight, mask/weight parameters,53231,38381 density 0.24520470961084906,0.17679927034198112
before tensor 589824 mask 78650.0 589824
layer3.5.conv2.weight, mask/weight parameters,78650,53883 density 0.1944395000197777,0.13321021715913137
before tensor 262144 mask 52800.0 262144
layer3.5.conv3.weight, mask/weight parameters,52800,36956 density 0.2432193396226415,0.17023511202830188
before tensor 524288 mask 152817.0 524288
layer4.0.conv1.weight, mask/weight parameters,152817,107404 density 0.35617029012529833,0.2503262977326969
before tensor 2359296 mask 316123.0 2359296
layer4.0.conv2.weight, mask/weight parameters,316123,187722 density 0.20007164334776958,0.11880770786222453
before tensor 1048576 mask 142027.0 1048576
layer4.0.conv3.weight, mask/weight parameters,142027,91238 density 0.16551102886336516,0.10632411619928402
layer4.0.shortcut.0.weight, mask/weight parameters,236888,149352 density 0.11295700073242188,0.07121658325195312
before tensor 1048576 mask 103567.0 1048576
layer4.1.conv1.weight, mask/weight parameters,103567,72306 density 0.1206917045793556,0.08426172807279236
before tensor 2359296 mask 247185.0 2359296
layer4.1.conv2.weight, mask/weight parameters,247185,163975 density 0.15644135086949834,0.10377842712472841
before tensor 1048576 mask 122403.0 1048576
layer4.1.conv3.weight, mask/weight parameters,122403,85239 density 0.14264221919749404,0.09933318727625298
before tensor 1048576 mask 58066.0 1048576
layer4.2.conv1.weight, mask/weight parameters,58066,31602 density 0.06766715766706444,0.036827360531026254
before tensor 2359296 mask 104703.0 2359296
layer4.2.conv2.weight, mask/weight parameters,104703,43388 density 0.06626566644452166,0.027459907888932558
before tensor 1048576 mask 59867.0 1048576
layer4.2.conv3.weight, mask/weight parameters,59867,35207 density 0.06976595129773269,0.04102844383949881
classifier.weight, mask/weight parameters,113231,100693 density 0.5528857421875,0.4916650390625
Total Model parameters after dst: 3492738 2365205
Total parameters under density level of 0.1: 0.190185651564314 0.12878952100277014 after dst
Death rate: 0.14767185902126345


Training summary: Average loss: 1.5285, Accuracy: 28467/50000 (56.934%)


Evaluation: Average loss: 1.8226, Accuracy: 5140/10000 (51.400%)

Current learning rate: 0.1. Time taken for epoch: 90.94 seconds.

Train Epoch: 18 [0/50000 (0%)]	Loss: 1.342299 Accuracy: 60/100 (60.000%
Train Epoch: 18 [10000/50000 (20%)]	Loss: 1.214818 Accuracy: 5759/10100 (57.020%
Train Epoch: 18 [20000/50000 (40%)]	Loss: 1.613894 Accuracy: 11455/20100 (56.990%
Train Epoch: 18 [30000/50000 (60%)]	Loss: 1.789273 Accuracy: 17095/30100 (56.794%
Train Epoch: 18 [40000/50000 (80%)]	Loss: 1.561582 Accuracy: 22815/40100 (56.895%
current layer rate 0.18875034137460178
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6266.0
Total filter_masks items: 15389463.0
6266.0 / 7552 channels
Total channels to prune: 139.44257806099267
Layer ('layer1', 0, 'conv1'): Pruned 1/56.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/56.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/56.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/56.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/56.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/56.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/109.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 9/419.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 9/419.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 9/419.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 9/419.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 9/419.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 9/419.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6142.0
Total filter_masks items: 14921243.0
After apply_mask:
Total filter_names items: 6142.0
Total filter_masks items: 14921243.0
Total pruned: 124/139.44257806099267 channels
===========done ===============

Training summary: Average loss: 1.5204, Accuracy: 28494/50000 (56.988%)


Evaluation: Average loss: 1.8017, Accuracy: 5019/10000 (50.190%)

Current learning rate: 0.1. Time taken for epoch: 90.18 seconds.

Train Epoch: 19 [0/50000 (0%)]	Loss: 1.238158 Accuracy: 64/100 (64.000%
Train Epoch: 19 [10000/50000 (20%)]	Loss: 1.394203 Accuracy: 5929/10100 (58.703%
Train Epoch: 19 [20000/50000 (40%)]	Loss: 1.648310 Accuracy: 11808/20100 (58.746%
Train Epoch: 19 [30000/50000 (60%)]	Loss: 1.616938 Accuracy: 17541/30100 (58.276%
Train Epoch: 19 [40000/50000 (80%)]	Loss: 1.407716 Accuracy: 23368/40100 (58.274%
current mest  death_rate 0.14713640064133


dynamic sparse change prune
to kill 1005315.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1415,1415 density 0.8188657407407407,0.8188657407407407
before tensor 4096 mask 1377.0 4096
layer1.0.conv1.weight, mask/weight parameters,1377,1377 density 0.3911931818181818,0.3911931818181818
before tensor 36864 mask 6269.0 36864
layer1.0.conv2.weight, mask/weight parameters,6269,6269 density 0.23026629935720844,0.23026629935720844
before tensor 16384 mask 4284.0 16384
layer1.0.conv3.weight, mask/weight parameters,4284,4284 density 0.30426136363636364,0.30426136363636364
layer1.0.shortcut.0.weight, mask/weight parameters,7281,7281 density 0.44439697265625,0.44439697265625
before tensor 16384 mask 3184.0 16384
layer1.1.conv1.weight, mask/weight parameters,3184,3184 density 0.22613636363636364,0.22613636363636364
before tensor 36864 mask 4899.0 36864
layer1.1.conv2.weight, mask/weight parameters,4899,4899 density 0.17994490358126722,0.17994490358126722
before tensor 16384 mask 3393.0 16384
layer1.1.conv3.weight, mask/weight parameters,3393,3393 density 0.24098011363636362,0.24098011363636362
before tensor 16384 mask 2456.0 16384
layer1.2.conv1.weight, mask/weight parameters,2456,2456 density 0.1744318181818182,0.1744318181818182
before tensor 36864 mask 3710.0 36864
layer1.2.conv2.weight, mask/weight parameters,3710,3710 density 0.13627180899908173,0.13627180899908173
before tensor 16384 mask 2876.0 16384
layer1.2.conv3.weight, mask/weight parameters,2876,2876 density 0.20426136363636363,0.20426136363636363
before tensor 32768 mask 4587.0 32768
layer2.0.conv1.weight, mask/weight parameters,4587,4587 density 0.16745765186915887,0.16745765186915887
before tensor 147456 mask 13207.0 147456
layer2.0.conv2.weight, mask/weight parameters,13207,13207 density 0.1281722809367145,0.1281722809367145
before tensor 65536 mask 8805.0 65536
layer2.0.conv3.weight, mask/weight parameters,8805,8805 density 0.1607221086448598,0.1607221086448598
layer2.0.shortcut.0.weight, mask/weight parameters,28732,28732 density 0.219207763671875,0.219207763671875
before tensor 65536 mask 7460.0 65536
layer2.1.conv1.weight, mask/weight parameters,7460,7460 density 0.13617114485981308,0.13617114485981308
before tensor 147456 mask 13192.0 147456
layer2.1.conv2.weight, mask/weight parameters,13192,13192 density 0.12802670781533565,0.12802670781533565
before tensor 65536 mask 9813.0 65536
layer2.1.conv3.weight, mask/weight parameters,9813,9813 density 0.1791216413551402,0.1791216413551402
before tensor 65536 mask 9905.0 65536
layer2.2.conv1.weight, mask/weight parameters,9905,9905 density 0.18080096378504673,0.18080096378504673
before tensor 147456 mask 16703.0 147456
layer2.2.conv2.weight, mask/weight parameters,16703,16703 density 0.1621005230927495,0.1621005230927495
before tensor 65536 mask 11051.0 65536
layer2.2.conv3.weight, mask/weight parameters,11051,11051 density 0.20171948014018692,0.20171948014018692
before tensor 65536 mask 6667.0 65536
layer2.3.conv1.weight, mask/weight parameters,6667,6667 density 0.12169611565420561,0.12169611565420561
before tensor 147456 mask 10572.0 147456
layer2.3.conv2.weight, mask/weight parameters,10572,10572 density 0.1025999359478266,0.1025999359478266
before tensor 65536 mask 7588.0 65536
layer2.3.conv3.weight, mask/weight parameters,7588,7588 density 0.13850759345794392,0.13850759345794392
before tensor 131072 mask 28480.0 131072
layer3.0.conv1.weight, mask/weight parameters,28480,28480 density 0.26742788461538464,0.26742788461538464
before tensor 589824 mask 84848.0 589824
layer3.0.conv2.weight, mask/weight parameters,84848,84848 density 0.21790762656147272,0.21790762656147272
before tensor 262144 mask 66157.0 262144
layer3.0.conv3.weight, mask/weight parameters,66157,66157 density 0.31060791015625,0.31060791015625
layer3.0.shortcut.0.weight, mask/weight parameters,85667,85667 density 0.16339683532714844,0.16339683532714844
before tensor 262144 mask 35572.0 262144
layer3.1.conv1.weight, mask/weight parameters,35572,35572 density 0.16701096754807693,0.16701096754807693
before tensor 589824 mask 86934.0 589824
layer3.1.conv2.weight, mask/weight parameters,86934,86934 density 0.22326491617357003,0.22326491617357003
before tensor 262144 mask 63061.0 262144
layer3.1.conv3.weight, mask/weight parameters,63061,63061 density 0.29607215294471156,0.29607215294471156
before tensor 262144 mask 47057.0 262144
layer3.2.conv1.weight, mask/weight parameters,47057,47057 density 0.22093318058894232,0.22093318058894232
before tensor 589824 mask 99698.0 589824
layer3.2.conv2.weight, mask/weight parameters,99698,99698 density 0.256045570348455,0.256045570348455
before tensor 262144 mask 62719.0 262144
layer3.2.conv3.weight, mask/weight parameters,62719,62719 density 0.29446645883413464,0.29446645883413464
before tensor 262144 mask 43394.0 262144
layer3.3.conv1.weight, mask/weight parameters,43394,43394 density 0.2037353515625,0.2037353515625
before tensor 589824 mask 74919.0 589824
layer3.3.conv2.weight, mask/weight parameters,74919,74919 density 0.19240785256410256,0.19240785256410256
before tensor 262144 mask 49426.0 262144
layer3.3.conv3.weight, mask/weight parameters,49426,49426 density 0.2320556640625,0.2320556640625
before tensor 262144 mask 41782.0 262144
layer3.4.conv1.weight, mask/weight parameters,41782,41782 density 0.1961669921875,0.1961669921875
before tensor 589824 mask 62663.0 589824
layer3.4.conv2.weight, mask/weight parameters,62663,62663 density 0.16093184993425377,0.16093184993425377
before tensor 262144 mask 41788.0 262144
layer3.4.conv3.weight, mask/weight parameters,41788,41788 density 0.1961951622596154,0.1961951622596154
before tensor 262144 mask 37392.0 262144
layer3.5.conv1.weight, mask/weight parameters,37392,37392 density 0.17555588942307693,0.17555588942307693
before tensor 589824 mask 51913.0 589824
layer3.5.conv2.weight, mask/weight parameters,51913,51913 density 0.1333235741288626,0.1333235741288626
before tensor 262144 mask 36870.0 262144
layer3.5.conv3.weight, mask/weight parameters,36870,36870 density 0.17310509314903846,0.17310509314903846
before tensor 524288 mask 111886.0 524288
layer4.0.conv1.weight, mask/weight parameters,111886,111886 density 0.2664967606707317,0.2664967606707317
before tensor 2359296 mask 199583.0 2359296
layer4.0.conv2.weight, mask/weight parameters,199583,199583 density 0.13192081433009453,0.13192081433009453
before tensor 1048576 mask 93114.0 1048576
layer4.0.conv3.weight, mask/weight parameters,93114,93114 density 0.11089224466463414,0.11089224466463414
layer4.0.shortcut.0.weight, mask/weight parameters,150223,150223 density 0.07163190841674805,0.07163190841674805
before tensor 1048576 mask 70797.0 1048576
layer4.1.conv1.weight, mask/weight parameters,70797,70797 density 0.08431426257621952,0.08431426257621952
before tensor 2359296 mask 157996.0 2359296
layer4.1.conv2.weight, mask/weight parameters,157996,157996 density 0.10443254676449204,0.10443254676449204
before tensor 1048576 mask 81354.0 1048576
layer4.1.conv3.weight, mask/weight parameters,81354,81354 density 0.0968869092987805,0.0968869092987805
before tensor 1048576 mask 32190.0 1048576
layer4.2.conv1.weight, mask/weight parameters,32190,32190 density 0.038336032774390245,0.038336032774390245
before tensor 2359296 mask 44016.0 2359296
layer4.2.conv2.weight, mask/weight parameters,44016,44016 density 0.02909379337695816,0.02909379337695816
before tensor 1048576 mask 34290.0 1048576
layer4.2.conv3.weight, mask/weight parameters,34290,34290 density 0.040836985518292686,0.040836985518292686
classifier.weight, mask/weight parameters,99990,99990 density 0.488232421875,0.488232421875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.13215896568897437 0.13215896568897437 after dst
Death rate: 0.14713640064133

dynamic sparse change grow
self.total_params*pruning_rate 3480074.8563335575
self.total_nonzero 2365205.0
to grow 1114869.8563335575
len(all_scores) 17896667 15456781
increse 1114869.0 before_mask 3480073.0 after_mask 3480073.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1586,1415 density 0.9178240740740741,0.8188657407407407
before tensor 4096 mask 1649.0 4096
layer1.0.conv1.weight, mask/weight parameters,1649,1377 density 0.46846590909090907,0.3911931818181818
before tensor 36864 mask 7999.0 36864
layer1.0.conv2.weight, mask/weight parameters,7999,6269 density 0.29381083562901744,0.23026629935720844
before tensor 16384 mask 5579.0 16384
layer1.0.conv3.weight, mask/weight parameters,5579,4284 density 0.39623579545454546,0.30426136363636364
layer1.0.shortcut.0.weight, mask/weight parameters,8735,7281 density 0.53314208984375,0.44439697265625
before tensor 16384 mask 4247.0 16384
layer1.1.conv1.weight, mask/weight parameters,4247,3184 density 0.30163352272727273,0.22613636363636364
before tensor 36864 mask 6901.0 36864
layer1.1.conv2.weight, mask/weight parameters,6901,4899 density 0.25348025711662076,0.17994490358126722
before tensor 16384 mask 4425.0 16384
layer1.1.conv3.weight, mask/weight parameters,4425,3393 density 0.3142755681818182,0.24098011363636362
before tensor 16384 mask 3455.0 16384
layer1.2.conv1.weight, mask/weight parameters,3455,2456 density 0.24538352272727273,0.1744318181818182
before tensor 36864 mask 5396.0 36864
layer1.2.conv2.weight, mask/weight parameters,5396,3710 density 0.1982001836547291,0.13627180899908173
before tensor 16384 mask 4147.0 16384
layer1.2.conv3.weight, mask/weight parameters,4147,2876 density 0.29453125,0.20426136363636363
before tensor 32768 mask 7188.0 32768
layer2.0.conv1.weight, mask/weight parameters,7188,4587 density 0.2624123831775701,0.16745765186915887
before tensor 147456 mask 18150.0 147456
layer2.0.conv2.weight, mask/weight parameters,18150,13207 density 0.17614347686843101,0.1281722809367145
before tensor 65536 mask 11642.0 65536
layer2.0.conv3.weight, mask/weight parameters,11642,8805 density 0.21250730140186916,0.1607221086448598
layer2.0.shortcut.0.weight, mask/weight parameters,40304,28732 density 0.3074951171875,0.219207763671875
before tensor 65536 mask 10675.0 65536
layer2.1.conv1.weight, mask/weight parameters,10675,7460 density 0.19485616238317757,0.13617114485981308
before tensor 147456 mask 19384.0 147456
layer2.1.conv2.weight, mask/weight parameters,19384,13192 density 0.1881192923205326,0.12802670781533565
before tensor 65536 mask 13642.0 65536
layer2.1.conv3.weight, mask/weight parameters,13642,9813 density 0.24901431074766356,0.1791216413551402
before tensor 65536 mask 12620.0 65536
layer2.2.conv1.weight, mask/weight parameters,12620,9905 density 0.23035922897196262,0.18080096378504673
before tensor 147456 mask 25039.0 147456
layer2.2.conv2.weight, mask/weight parameters,25039,16703 density 0.24300035908036607,0.1621005230927495
before tensor 65536 mask 16126.0 65536
layer2.2.conv3.weight, mask/weight parameters,16126,11051 density 0.2943560163551402,0.20171948014018692
before tensor 65536 mask 9719.0 65536
layer2.3.conv1.weight, mask/weight parameters,9719,6667 density 0.17740581191588786,0.12169611565420561
before tensor 147456 mask 14551.0 147456
layer2.3.conv2.weight, mask/weight parameters,14551,10572 density 0.14121563261226114,0.1025999359478266
before tensor 65536 mask 10086.0 65536
layer2.3.conv3.weight, mask/weight parameters,10086,7588 density 0.18410484813084113,0.13850759345794392
before tensor 131072 mask 41559.0 131072
layer3.0.conv1.weight, mask/weight parameters,41559,28480 density 0.3902400090144231,0.26742788461538464
before tensor 589824 mask 133158.0 589824
layer3.0.conv2.weight, mask/weight parameters,133158,84848 density 0.3419779339250493,0.21790762656147272
before tensor 262144 mask 89406.0 262144
layer3.0.conv3.weight, mask/weight parameters,89406,66157 density 0.41976224459134615,0.31060791015625
layer3.0.shortcut.0.weight, mask/weight parameters,120151,85667 density 0.2291698455810547,0.16339683532714844
before tensor 262144 mask 51223.0 262144
layer3.1.conv1.weight, mask/weight parameters,51223,35572 density 0.24049260066105768,0.16701096754807693
before tensor 589824 mask 124514.0 589824
layer3.1.conv2.weight, mask/weight parameters,124514,86934 density 0.31977831196581197,0.22326491617357003
before tensor 262144 mask 86138.0 262144
layer3.1.conv3.weight, mask/weight parameters,86138,63061 density 0.4044189453125,0.29607215294471156
before tensor 262144 mask 66052.0 262144
layer3.2.conv1.weight, mask/weight parameters,66052,47057 density 0.3101149338942308,0.22093318058894232
before tensor 589824 mask 141852.0 589824
layer3.2.conv2.weight, mask/weight parameters,141852,99698 density 0.36430596646942803,0.256045570348455
before tensor 262144 mask 85598.0 262144
layer3.2.conv3.weight, mask/weight parameters,85598,62719 density 0.40188363882211536,0.29446645883413464
before tensor 262144 mask 60176.0 262144
layer3.3.conv1.weight, mask/weight parameters,60176,43394 density 0.2825270432692308,0.2037353515625
before tensor 589824 mask 108831.0 589824
layer3.3.conv2.weight, mask/weight parameters,108831,74919 density 0.27950104783037477,0.19240785256410256
before tensor 262144 mask 68575.0 262144
layer3.3.conv3.weight, mask/weight parameters,68575,49426 density 0.32196044921875,0.2320556640625
before tensor 262144 mask 59196.0 262144
layer3.4.conv1.weight, mask/weight parameters,59196,41782 density 0.27792593149038464,0.1961669921875
before tensor 589824 mask 92507.0 589824
layer3.4.conv2.weight, mask/weight parameters,92507,62663 density 0.2375775599934254,0.16093184993425377
before tensor 262144 mask 59421.0 262144
layer3.4.conv3.weight, mask/weight parameters,59421,41788 density 0.27898230919471156,0.1961951622596154
before tensor 262144 mask 59687.0 262144
layer3.5.conv1.weight, mask/weight parameters,59687,37392 density 0.2802311823918269,0.17555588942307693
before tensor 589824 mask 83534.0 589824
layer3.5.conv2.weight, mask/weight parameters,83534,51913 density 0.21453299638395792,0.1333235741288626
before tensor 262144 mask 53940.0 262144
layer3.5.conv3.weight, mask/weight parameters,53940,36870 density 0.2532489483173077,0.17310509314903846
before tensor 524288 mask 160466.0 524288
layer4.0.conv1.weight, mask/weight parameters,160466,111886 density 0.3822075076219512,0.2664967606707317
before tensor 2359296 mask 329823.0 2359296
layer4.0.conv2.weight, mask/weight parameters,329823,199583 density 0.21800713860797144,0.13192081433009453
before tensor 1048576 mask 145082.0 1048576
layer4.0.conv3.weight, mask/weight parameters,145082,93114 density 0.17278248856707318,0.11089224466463414
layer4.0.shortcut.0.weight, mask/weight parameters,228326,150223 density 0.10887432098388672,0.07163190841674805
before tensor 1048576 mask 102557.0 1048576
layer4.1.conv1.weight, mask/weight parameters,102557,70797 density 0.12213819550304877,0.08431426257621952
before tensor 2359296 mask 235461.0 2359296
layer4.1.conv2.weight, mask/weight parameters,235461,157996 density 0.15563553440412453,0.10443254676449204
before tensor 1048576 mask 121659.0 1048576
layer4.1.conv3.weight, mask/weight parameters,121659,81354 density 0.1448873380335366,0.0968869092987805
before tensor 1048576 mask 49938.0 1048576
layer4.2.conv1.weight, mask/weight parameters,49938,32190 density 0.05947265625,0.038336032774390245
before tensor 2359296 mask 87791.0 2359296
layer4.2.conv2.weight, mask/weight parameters,87791,44016 density 0.058028290038997954,0.02909379337695816
before tensor 1048576 mask 58002.0 1048576
layer4.2.conv3.weight, mask/weight parameters,58002,34290 density 0.06907631478658537,0.040836985518292686
classifier.weight, mask/weight parameters,112205,99990 density 0.5478759765625,0.488232421875
Total Model parameters after dst: 3480073 2365205
Total parameters under density level of 0.1: 0.19445369352852127 0.13215896568897437 after dst
Death rate: 0.14713640064133


Training summary: Average loss: 1.4863, Accuracy: 29032/50000 (58.064%)


Evaluation: Average loss: 1.7446, Accuracy: 5366/10000 (53.660%)

Current learning rate: 0.1. Time taken for epoch: 91.32 seconds.

Train Epoch: 20 [0/50000 (0%)]	Loss: 1.265898 Accuracy: 66/100 (66.000%
Train Epoch: 20 [10000/50000 (20%)]	Loss: 1.672911 Accuracy: 5924/10100 (58.653%
Train Epoch: 20 [20000/50000 (40%)]	Loss: 1.474277 Accuracy: 11721/20100 (58.313%
Train Epoch: 20 [30000/50000 (60%)]	Loss: 1.473071 Accuracy: 17508/30100 (58.166%
Train Epoch: 20 [40000/50000 (80%)]	Loss: 1.508394 Accuracy: 23386/40100 (58.319%
current layer rate 0.20527332726445152
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6142.0
Total filter_masks items: 14921243.0
6142.0 / 7552 channels
Total channels to prune: 140.22416750113825
Layer ('layer1', 0, 'conv1'): Pruned 1/55.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/55.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/55.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/55.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/55.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/55.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/107.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 9/410.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 9/410.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 9/410.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 9/410.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 9/410.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 9/410.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6018.0
Total filter_masks items: 14459467.0
After apply_mask:
Total filter_names items: 6018.0
Total filter_masks items: 14459467.0
Total pruned: 124/140.22416750113825 channels
===========done ===============

Training summary: Average loss: 1.4782, Accuracy: 29080/50000 (58.160%)


Evaluation: Average loss: 1.7619, Accuracy: 5248/10000 (52.480%)

Current learning rate: 0.1. Time taken for epoch: 89.75 seconds.

Train Epoch: 21 [0/50000 (0%)]	Loss: 1.356320 Accuracy: 60/100 (60.000%
Train Epoch: 21 [10000/50000 (20%)]	Loss: 1.311525 Accuracy: 6036/10100 (59.762%
Train Epoch: 21 [20000/50000 (40%)]	Loss: 1.598093 Accuracy: 11959/20100 (59.498%
Train Epoch: 21 [30000/50000 (60%)]	Loss: 1.272204 Accuracy: 17826/30100 (59.223%
Train Epoch: 21 [40000/50000 (80%)]	Loss: 1.529474 Accuracy: 23625/40100 (58.915%
current mest  death_rate 0.14654924167200092


dynamic sparse change prune
to kill 996487.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1418,1418 density 0.8206018518518519,0.8206018518518519
before tensor 4096 mask 1322.0 4096
layer1.0.conv1.weight, mask/weight parameters,1322,1322 density 0.38252314814814814,0.38252314814814814
before tensor 36864 mask 5959.0 36864
layer1.0.conv2.weight, mask/weight parameters,5959,5959 density 0.22706142356348116,0.22706142356348116
before tensor 16384 mask 4141.0 16384
layer1.0.conv3.weight, mask/weight parameters,4141,4141 density 0.29955150462962965,0.29955150462962965
layer1.0.shortcut.0.weight, mask/weight parameters,7213,7213 density 0.44024658203125,0.44024658203125
before tensor 16384 mask 3075.0 16384
layer1.1.conv1.weight, mask/weight parameters,3075,3075 density 0.2224392361111111,0.2224392361111111
before tensor 36864 mask 4968.0 36864
layer1.1.conv2.weight, mask/weight parameters,4968,4968 density 0.18930041152263374,0.18930041152263374
before tensor 16384 mask 3239.0 16384
layer1.1.conv3.weight, mask/weight parameters,3239,3239 density 0.23430266203703703,0.23430266203703703
before tensor 16384 mask 2376.0 16384
layer1.2.conv1.weight, mask/weight parameters,2376,2376 density 0.171875,0.171875
before tensor 36864 mask 3759.0 36864
layer1.2.conv2.weight, mask/weight parameters,3759,3759 density 0.14323273891175126,0.14323273891175126
before tensor 16384 mask 2796.0 16384
layer1.2.conv3.weight, mask/weight parameters,2796,2796 density 0.20225694444444445,0.20225694444444445
before tensor 32768 mask 4409.0 32768
layer2.0.conv1.weight, mask/weight parameters,4409,4409 density 0.1640252976190476,0.1640252976190476
before tensor 147456 mask 13058.0 147456
layer2.0.conv2.weight, mask/weight parameters,13058,13058 density 0.13159989921894683,0.13159989921894683
before tensor 65536 mask 8482.0 65536
layer2.0.conv3.weight, mask/weight parameters,8482,8482 density 0.15777529761904763,0.15777529761904763
layer2.0.shortcut.0.weight, mask/weight parameters,28443,28443 density 0.21700286865234375,0.21700286865234375
before tensor 65536 mask 7580.0 65536
layer2.1.conv1.weight, mask/weight parameters,7580,7580 density 0.1409970238095238,0.1409970238095238
before tensor 147456 mask 12694.0 147456
layer2.1.conv2.weight, mask/weight parameters,12694,12694 density 0.12793146888384985,0.12793146888384985
before tensor 65536 mask 9574.0 65536
layer2.1.conv3.weight, mask/weight parameters,9574,9574 density 0.1780877976190476,0.1780877976190476
before tensor 65536 mask 9197.0 65536
layer2.2.conv1.weight, mask/weight parameters,9197,9197 density 0.17107514880952382,0.17107514880952382
before tensor 147456 mask 17400.0 147456
layer2.2.conv2.weight, mask/weight parameters,17400,17400 density 0.17535903250188964,0.17535903250188964
before tensor 65536 mask 11324.0 65536
layer2.2.conv3.weight, mask/weight parameters,11324,11324 density 0.21063988095238095,0.21063988095238095
before tensor 65536 mask 6684.0 65536
layer2.3.conv1.weight, mask/weight parameters,6684,6684 density 0.12433035714285715,0.12433035714285715
before tensor 147456 mask 10734.0 147456
layer2.3.conv2.weight, mask/weight parameters,10734,10734 density 0.10817838246409675,0.10817838246409675
before tensor 65536 mask 7115.0 65536
layer2.3.conv3.weight, mask/weight parameters,7115,7115 density 0.13234747023809523,0.13234747023809523
before tensor 131072 mask 29050.0 131072
layer3.0.conv1.weight, mask/weight parameters,29050,29050 density 0.27812882965686275,0.27812882965686275
before tensor 589824 mask 89998.0 589824
layer3.0.conv2.weight, mask/weight parameters,89998,89998 density 0.2402868554829339,0.2402868554829339
before tensor 262144 mask 66724.0 262144
layer3.0.conv3.weight, mask/weight parameters,66724,66724 density 0.3194125306372549,0.3194125306372549
layer3.0.shortcut.0.weight, mask/weight parameters,85105,85105 density 0.1623249053955078,0.1623249053955078
before tensor 262144 mask 35953.0 262144
layer3.1.conv1.weight, mask/weight parameters,35953,35953 density 0.17210956648284315,0.17210956648284315
before tensor 589824 mask 85416.0 589824
layer3.1.conv2.weight, mask/weight parameters,85416,85416 density 0.22805331282839933,0.22805331282839933
before tensor 262144 mask 62805.0 262144
layer3.1.conv3.weight, mask/weight parameters,62805,62805 density 0.30065199908088236,0.30065199908088236
before tensor 262144 mask 46885.0 262144
layer3.2.conv1.weight, mask/weight parameters,46885,46885 density 0.22444182751225492,0.22444182751225492
before tensor 589824 mask 99630.0 589824
layer3.2.conv2.weight, mask/weight parameters,99630,99630 density 0.26600346020761245,0.26600346020761245
before tensor 262144 mask 63154.0 262144
layer3.2.conv3.weight, mask/weight parameters,63154,63154 density 0.3023226868872549,0.3023226868872549
before tensor 262144 mask 42676.0 262144
layer3.3.conv1.weight, mask/weight parameters,42676,42676 density 0.20429304534313725,0.20429304534313725
before tensor 589824 mask 74772.0 589824
layer3.3.conv2.weight, mask/weight parameters,74772,74772 density 0.19963475586312956,0.19963475586312956
before tensor 262144 mask 49147.0 262144
layer3.3.conv3.weight, mask/weight parameters,49147,49147 density 0.23527018229166666,0.23527018229166666
before tensor 262144 mask 41509.0 262144
layer3.4.conv1.weight, mask/weight parameters,41509,41509 density 0.19870653339460784,0.19870653339460784
before tensor 589824 mask 62174.0 589824
layer3.4.conv2.weight, mask/weight parameters,62174,62174 density 0.16599918834636251,0.16599918834636251
before tensor 262144 mask 41212.0 262144
layer3.4.conv3.weight, mask/weight parameters,41212,41212 density 0.19728477328431374,0.19728477328431374
before tensor 262144 mask 40228.0 262144
layer3.5.conv1.weight, mask/weight parameters,40228,40228 density 0.19257429534313725,0.19257429534313725
before tensor 589824 mask 53656.0 589824
layer3.5.conv2.weight, mask/weight parameters,53656,53656 density 0.14325686701695928,0.14325686701695928
before tensor 262144 mask 36604.0 262144
layer3.5.conv3.weight, mask/weight parameters,36604,36604 density 0.17522594975490197,0.17522594975490197
before tensor 524288 mask 116847.0 524288
layer4.0.conv1.weight, mask/weight parameters,116847,116847 density 0.2845595971009975,0.2845595971009975
before tensor 2359296 mask 207266.0 2359296
layer4.0.conv2.weight, mask/weight parameters,207266,207266 density 0.1432177384192608,0.1432177384192608
before tensor 1048576 mask 94190.0 1048576
layer4.0.conv3.weight, mask/weight parameters,94190,94190 density 0.11469129909600997,0.11469129909600997
layer4.0.shortcut.0.weight, mask/weight parameters,145884,145884 density 0.06956291198730469,0.06956291198730469
before tensor 1048576 mask 70255.0 1048576
layer4.1.conv1.weight, mask/weight parameters,70255,70255 density 0.08554663146820449,0.08554663146820449
before tensor 2359296 mask 153726.0 2359296
layer4.1.conv2.weight, mask/weight parameters,153726,153726 density 0.10622239082261097,0.10622239082261097
before tensor 1048576 mask 79397.0 1048576
layer4.1.conv3.weight, mask/weight parameters,79397,79397 density 0.09667846984102245,0.09667846984102245
before tensor 1048576 mask 31090.0 1048576
layer4.2.conv1.weight, mask/weight parameters,31090,31090 density 0.03785701761221945,0.03785701761221945
before tensor 2359296 mask 41822.0 2359296
layer4.2.conv2.weight, mask/weight parameters,41822,41822 density 0.028898383025533977,0.028898383025533977
before tensor 1048576 mask 32376.0 1048576
layer4.2.conv3.weight, mask/weight parameters,32376,32376 density 0.03942292705735661,0.03942292705735661
classifier.weight, mask/weight parameters,98694,98694 density 0.481904296875,0.481904296875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.13565929376902902 0.13565929376902902 after dst
Death rate: 0.14654924167200092

dynamic sparse change grow
self.total_params*pruning_rate 3466187.3536018995
self.total_nonzero 2365205.0
to grow 1100982.3536018995
len(all_scores) 17434891 14973509
increse 1100982.0 before_mask 3466186.0 after_mask 3466186.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1547,1418 density 0.8952546296296297,0.8206018518518519
before tensor 4096 mask 1701.0 4096
layer1.0.conv1.weight, mask/weight parameters,1701,1322 density 0.4921875,0.38252314814814814
before tensor 36864 mask 7689.0 36864
layer1.0.conv2.weight, mask/weight parameters,7689,5959 density 0.2929812528577961,0.22706142356348116
before tensor 16384 mask 5003.0 16384
layer1.0.conv3.weight, mask/weight parameters,5003,4141 density 0.3619068287037037,0.29955150462962965
layer1.0.shortcut.0.weight, mask/weight parameters,8967,7213 density 0.54730224609375,0.44024658203125
before tensor 16384 mask 4401.0 16384
layer1.1.conv1.weight, mask/weight parameters,4401,3075 density 0.318359375,0.2224392361111111
before tensor 36864 mask 6941.0 36864
layer1.1.conv2.weight, mask/weight parameters,6941,4968 density 0.2644795000762079,0.18930041152263374
before tensor 16384 mask 4322.0 16384
layer1.1.conv3.weight, mask/weight parameters,4322,3239 density 0.31264467592592593,0.23430266203703703
before tensor 16384 mask 3274.0 16384
layer1.2.conv1.weight, mask/weight parameters,3274,2376 density 0.23683449074074073,0.171875
before tensor 36864 mask 4885.0 36864
layer1.2.conv2.weight, mask/weight parameters,4885,3759 density 0.18613778387440938,0.14323273891175126
before tensor 16384 mask 3741.0 16384
layer1.2.conv3.weight, mask/weight parameters,3741,2796 density 0.2706163194444444,0.20225694444444445
before tensor 32768 mask 6219.0 32768
layer2.0.conv1.weight, mask/weight parameters,6219,4409 density 0.23136160714285714,0.1640252976190476
before tensor 147456 mask 16963.0 147456
layer2.0.conv2.weight, mask/weight parameters,16963,13058 density 0.17095490047871,0.13159989921894683
before tensor 65536 mask 11027.0 65536
layer2.0.conv3.weight, mask/weight parameters,11027,8482 density 0.2051153273809524,0.15777529761904763
layer2.0.shortcut.0.weight, mask/weight parameters,41016,28443 density 0.31292724609375,0.21700286865234375
before tensor 65536 mask 10519.0 65536
layer2.1.conv1.weight, mask/weight parameters,10519,7580 density 0.1956659226190476,0.1409970238095238
before tensor 147456 mask 23684.0 147456
layer2.1.conv2.weight, mask/weight parameters,23684,12694 density 0.23868984630889392,0.12793146888384985
before tensor 65536 mask 13013.0 65536
layer2.1.conv3.weight, mask/weight parameters,13013,9574 density 0.24205729166666667,0.1780877976190476
before tensor 65536 mask 12868.0 65536
layer2.2.conv1.weight, mask/weight parameters,12868,9197 density 0.23936011904761906,0.17107514880952382
before tensor 147456 mask 26221.0 147456
layer2.2.conv2.weight, mask/weight parameters,26221,17400 density 0.26425799949609474,0.17535903250188964
before tensor 65536 mask 16402.0 65536
layer2.2.conv3.weight, mask/weight parameters,16402,11324 density 0.3050967261904762,0.21063988095238095
before tensor 65536 mask 11288.0 65536
layer2.3.conv1.weight, mask/weight parameters,11288,6684 density 0.2099702380952381,0.12433035714285715
before tensor 147456 mask 16787.0 147456
layer2.3.conv2.weight, mask/weight parameters,16787,10734 density 0.16918115394305872,0.10817838246409675
before tensor 65536 mask 10311.0 65536
layer2.3.conv3.weight, mask/weight parameters,10311,7115 density 0.191796875,0.13234747023809523
before tensor 131072 mask 42398.0 131072
layer3.0.conv1.weight, mask/weight parameters,42398,29050 density 0.4059244791666667,0.27812882965686275
before tensor 589824 mask 130116.0 589824
layer3.0.conv2.weight, mask/weight parameters,130116,89998 density 0.3473984364987825,0.2402868554829339
before tensor 262144 mask 88378.0 262144
layer3.0.conv3.weight, mask/weight parameters,88378,66724 density 0.42307176776960786,0.3194125306372549
layer3.0.shortcut.0.weight, mask/weight parameters,127461,85105 density 0.24311256408691406,0.1623249053955078
before tensor 262144 mask 50887.0 262144
layer3.1.conv1.weight, mask/weight parameters,50887,35953 density 0.24359968596813725,0.17210956648284315
before tensor 589824 mask 131987.0 589824
layer3.1.conv2.weight, mask/weight parameters,131987,85416 density 0.35239384424793885,0.22805331282839933
before tensor 262144 mask 85416.0 262144
layer3.1.conv3.weight, mask/weight parameters,85416,62805 density 0.4088924632352941,0.30065199908088236
before tensor 262144 mask 64510.0 262144
layer3.2.conv1.weight, mask/weight parameters,64510,46885 density 0.30881395526960786,0.22444182751225492
before tensor 589824 mask 141291.0 589824
layer3.2.conv2.weight, mask/weight parameters,141291,99630 density 0.3772347174163783,0.26600346020761245
before tensor 262144 mask 85124.0 262144
layer3.2.conv3.weight, mask/weight parameters,85124,63154 density 0.40749463848039214,0.3023226868872549
before tensor 262144 mask 65166.0 262144
layer3.3.conv1.weight, mask/weight parameters,65166,42676 density 0.3119542738970588,0.20429304534313725
before tensor 589824 mask 114502.0 589824
layer3.3.conv2.weight, mask/weight parameters,114502,74772 density 0.3057104105258661,0.19963475586312956
before tensor 262144 mask 70651.0 262144
layer3.3.conv3.weight, mask/weight parameters,70651,49147 density 0.3382113587622549,0.23527018229166666
before tensor 262144 mask 62567.0 262144
layer3.4.conv1.weight, mask/weight parameters,62567,41509 density 0.2995126761642157,0.19870653339460784
before tensor 589824 mask 95031.0 589824
layer3.4.conv2.weight, mask/weight parameters,95031,62174 density 0.2537245290272972,0.16599918834636251
before tensor 262144 mask 58004.0 262144
layer3.4.conv3.weight, mask/weight parameters,58004,41212 density 0.2776692708333333,0.19728477328431374
before tensor 262144 mask 55831.0 262144
layer3.5.conv1.weight, mask/weight parameters,55831,40228 density 0.26726696537990197,0.19257429534313725
before tensor 589824 mask 76881.0 589824
layer3.5.conv2.weight, mask/weight parameters,76881,53656 density 0.20526560297321542,0.14325686701695928
before tensor 262144 mask 50654.0 262144
layer3.5.conv3.weight, mask/weight parameters,50654,36604 density 0.24248429840686275,0.17522594975490197
before tensor 524288 mask 161465.0 524288
layer4.0.conv1.weight, mask/weight parameters,161465,116847 density 0.3932186136221945,0.2845595971009975
before tensor 2359296 mask 319571.0 2359296
layer4.0.conv2.weight, mask/weight parameters,319571,207266 density 0.22081883128145277,0.1432177384192608
before tensor 1048576 mask 143526.0 1048576
layer4.0.conv3.weight, mask/weight parameters,143526,94190 density 0.1747657224127182,0.11469129909600997
layer4.0.shortcut.0.weight, mask/weight parameters,227753,145884 density 0.10860109329223633,0.06956291198730469
before tensor 1048576 mask 99037.0 1048576
layer4.1.conv1.weight, mask/weight parameters,99037,70255 density 0.12059329216022444,0.08554663146820449
before tensor 2359296 mask 230461.0 2359296
layer4.1.conv2.weight, mask/weight parameters,230461,153726 density 0.1592451401283436,0.10622239082261097
before tensor 1048576 mask 122622.0 1048576
layer4.1.conv3.weight, mask/weight parameters,122622,79397 density 0.14931177914588528,0.09667846984102245
before tensor 1048576 mask 48854.0 1048576
layer4.2.conv1.weight, mask/weight parameters,48854,31090 density 0.059487511689526186,0.03785701761221945
before tensor 2359296 mask 84062.0 2359296
layer4.2.conv2.weight, mask/weight parameters,84062,41822 density 0.05808559786457934,0.028898383025533977
before tensor 1048576 mask 52593.0 1048576
layer4.2.conv3.weight, mask/weight parameters,52593,32376 density 0.06404033860660847,0.03942292705735661
classifier.weight, mask/weight parameters,110598,98694 density 0.540029296875,0.481904296875
Total Model parameters after dst: 3466186 2365205
Total parameters under density level of 0.1: 0.19880743733929854 0.13565929376902902 after dst
Death rate: 0.14654924167200092


Training summary: Average loss: 1.4599, Accuracy: 29335/50000 (58.670%)


Evaluation: Average loss: 1.7014, Accuracy: 5360/10000 (53.600%)

Current learning rate: 0.1. Time taken for epoch: 91.25 seconds.

Train Epoch: 22 [0/50000 (0%)]	Loss: 1.297151 Accuracy: 56/100 (56.000%
Train Epoch: 22 [10000/50000 (20%)]	Loss: 1.583393 Accuracy: 6010/10100 (59.505%
Train Epoch: 22 [20000/50000 (40%)]	Loss: 1.622276 Accuracy: 11838/20100 (58.896%
Train Epoch: 22 [30000/50000 (60%)]	Loss: 1.296269 Accuracy: 17707/30100 (58.827%
Train Epoch: 22 [40000/50000 (80%)]	Loss: 1.310391 Accuracy: 23619/40100 (58.900%
current layer rate 0.22120095584888488
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6018.0
Total filter_masks items: 14459467.0
6018.0 / 7552 channels
Total channels to prune: 136.5096185707789
Layer ('layer1', 0, 'conv1'): Pruned 1/54.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/54.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/54.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/54.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/54.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/54.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/105.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 9/401.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 9/401.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 9/401.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 9/401.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 9/401.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 9/401.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5894.0
Total filter_masks items: 14004135.0
After apply_mask:
Total filter_names items: 5894.0
Total filter_masks items: 14004135.0
Total pruned: 124/136.5096185707789 channels
===========done ===============

Training summary: Average loss: 1.4527, Accuracy: 29429/50000 (58.858%)


Evaluation: Average loss: 1.8930, Accuracy: 4912/10000 (49.120%)

Current learning rate: 0.1. Time taken for epoch: 91.17 seconds.

Train Epoch: 23 [0/50000 (0%)]	Loss: 1.302038 Accuracy: 66/100 (66.000%
Train Epoch: 23 [10000/50000 (20%)]	Loss: 1.643521 Accuracy: 6039/10100 (59.792%
Train Epoch: 23 [20000/50000 (40%)]	Loss: 1.332348 Accuracy: 11978/20100 (59.592%
Train Epoch: 23 [30000/50000 (60%)]	Loss: 1.455873 Accuracy: 17834/30100 (59.249%
Train Epoch: 23 [40000/50000 (80%)]	Loss: 1.607934 Accuracy: 23797/40100 (59.344%
current mest  death_rate 0.1459117534502555


dynamic sparse change prune
to kill 978643.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1412,1412 density 0.8171296296296297,0.8171296296296297
before tensor 4096 mask 1308.0 4096
layer1.0.conv1.weight, mask/weight parameters,1308,1308 density 0.3856132075471698,0.3856132075471698
before tensor 36864 mask 5521.0 36864
layer1.0.conv2.weight, mask/weight parameters,5521,5521 density 0.2183853486808275,0.2183853486808275
before tensor 16384 mask 3845.0 16384
layer1.0.conv3.weight, mask/weight parameters,3845,3845 density 0.2833873820754717,0.2833873820754717
layer1.0.shortcut.0.weight, mask/weight parameters,7144,7144 density 0.43603515625,0.43603515625
before tensor 16384 mask 3135.0 16384
layer1.1.conv1.weight, mask/weight parameters,3135,3135 density 0.23105837264150944,0.23105837264150944
before tensor 36864 mask 5044.0 36864
layer1.1.conv2.weight, mask/weight parameters,5044,5044 density 0.1995174241525256,0.1995174241525256
before tensor 16384 mask 3105.0 16384
layer1.1.conv3.weight, mask/weight parameters,3105,3105 density 0.22884728773584906,0.22884728773584906
before tensor 16384 mask 2301.0 16384
layer1.2.conv1.weight, mask/weight parameters,2301,2301 density 0.16959021226415094,0.16959021226415094
before tensor 36864 mask 3436.0 36864
layer1.2.conv2.weight, mask/weight parameters,3436,3436 density 0.13591234523950793,0.13591234523950793
before tensor 16384 mask 2560.0 16384
layer1.2.conv3.weight, mask/weight parameters,2560,2560 density 0.18867924528301888,0.18867924528301888
before tensor 32768 mask 4396.0 32768
layer2.0.conv1.weight, mask/weight parameters,4396,4396 density 0.16671723300970873,0.16671723300970873
before tensor 147456 mask 13208.0 147456
layer2.0.conv2.weight, mask/weight parameters,13208,13208 density 0.1383311863093181,0.1383311863093181
before tensor 65536 mask 8309.0 65536
layer2.0.conv3.weight, mask/weight parameters,8309,8309 density 0.15755840412621358,0.15755840412621358
layer2.0.shortcut.0.weight, mask/weight parameters,28647,28647 density 0.21855926513671875,0.21855926513671875
before tensor 65536 mask 7459.0 65536
layer2.1.conv1.weight, mask/weight parameters,7459,7459 density 0.1414403822815534,0.1414403822815534
before tensor 147456 mask 14017.0 147456
layer2.1.conv2.weight, mask/weight parameters,14017,14017 density 0.1468040762036426,0.1468040762036426
before tensor 65536 mask 9278.0 65536
layer2.1.conv3.weight, mask/weight parameters,9278,9278 density 0.1759329490291262,0.1759329490291262
before tensor 65536 mask 9382.0 65536
layer2.2.conv1.weight, mask/weight parameters,9382,9382 density 0.177905036407767,0.177905036407767
before tensor 147456 mask 18409.0 147456
layer2.2.conv2.weight, mask/weight parameters,18409,18409 density 0.19280275656936982,0.19280275656936982
before tensor 65536 mask 11402.0 65536
layer2.2.conv3.weight, mask/weight parameters,11402,11402 density 0.21620904126213591,0.21620904126213591
before tensor 65536 mask 7263.0 65536
layer2.3.conv1.weight, mask/weight parameters,7263,7263 density 0.13772375606796117,0.13772375606796117
before tensor 147456 mask 11987.0 147456
layer2.3.conv2.weight, mask/weight parameters,11987,11987 density 0.12554330180873682,0.12554330180873682
before tensor 65536 mask 7209.0 65536
layer2.3.conv3.weight, mask/weight parameters,7209,7209 density 0.13669978762135923,0.13669978762135923
before tensor 131072 mask 29841.0 131072
layer3.0.conv1.weight, mask/weight parameters,29841,29841 density 0.291416015625,0.291416015625
before tensor 589824 mask 90669.0 589824
layer3.0.conv2.weight, mask/weight parameters,90669,90669 density 0.25185833333333335,0.25185833333333335
before tensor 262144 mask 66333.0 262144
layer3.0.conv3.weight, mask/weight parameters,66333,66333 density 0.3238916015625,0.3238916015625
layer3.0.shortcut.0.weight, mask/weight parameters,88838,88838 density 0.16944503784179688,0.16944503784179688
before tensor 262144 mask 35727.0 262144
layer3.1.conv1.weight, mask/weight parameters,35727,35727 density 0.1744482421875,0.1744482421875
before tensor 589824 mask 87542.0 589824
layer3.1.conv2.weight, mask/weight parameters,87542,87542 density 0.24317222222222223,0.24317222222222223
before tensor 262144 mask 62614.0 262144
layer3.1.conv3.weight, mask/weight parameters,62614,62614 density 0.305732421875,0.305732421875
before tensor 262144 mask 46145.0 262144
layer3.2.conv1.weight, mask/weight parameters,46145,46145 density 0.2253173828125,0.2253173828125
before tensor 589824 mask 99100.0 589824
layer3.2.conv2.weight, mask/weight parameters,99100,99100 density 0.2752777777777778,0.2752777777777778
before tensor 262144 mask 63197.0 262144
layer3.2.conv3.weight, mask/weight parameters,63197,63197 density 0.3085791015625,0.3085791015625
before tensor 262144 mask 44688.0 262144
layer3.3.conv1.weight, mask/weight parameters,44688,44688 density 0.218203125,0.218203125
before tensor 589824 mask 76647.0 589824
layer3.3.conv2.weight, mask/weight parameters,76647,76647 density 0.21290833333333334,0.21290833333333334
before tensor 262144 mask 49970.0 262144
layer3.3.conv3.weight, mask/weight parameters,49970,49970 density 0.243994140625,0.243994140625
before tensor 262144 mask 42401.0 262144
layer3.4.conv1.weight, mask/weight parameters,42401,42401 density 0.2070361328125,0.2070361328125
before tensor 589824 mask 61923.0 589824
layer3.4.conv2.weight, mask/weight parameters,61923,61923 density 0.17200833333333335,0.17200833333333335
before tensor 262144 mask 40286.0 262144
layer3.4.conv3.weight, mask/weight parameters,40286,40286 density 0.196708984375,0.196708984375
before tensor 262144 mask 38795.0 262144
layer3.5.conv1.weight, mask/weight parameters,38795,38795 density 0.1894287109375,0.1894287109375
before tensor 589824 mask 51702.0 589824
layer3.5.conv2.weight, mask/weight parameters,51702,51702 density 0.14361666666666667,0.14361666666666667
before tensor 262144 mask 35691.0 262144
layer3.5.conv3.weight, mask/weight parameters,35691,35691 density 0.1742724609375,0.1742724609375
before tensor 524288 mask 119068.0 524288
layer4.0.conv1.weight, mask/weight parameters,119068,119068 density 0.2966258769132653,0.2966258769132653
before tensor 2359296 mask 206884.0 2359296
layer4.0.conv2.weight, mask/weight parameters,206884,206884 density 0.1495933407376556,0.1495933407376556
before tensor 1048576 mask 94630.0 1048576
layer4.0.conv3.weight, mask/weight parameters,94630,94630 density 0.1178725884885204,0.1178725884885204
layer4.0.shortcut.0.weight, mask/weight parameters,144162,144162 density 0.0687417984008789,0.0687417984008789
before tensor 1048576 mask 68964.0 1048576
layer4.1.conv1.weight, mask/weight parameters,68964,68964 density 0.08590262276785714,0.08590262276785714
before tensor 2359296 mask 150065.0 2359296
layer4.1.conv2.weight, mask/weight parameters,150065,150065 density 0.1085087521403119,0.1085087521403119
before tensor 1048576 mask 78501.0 1048576
layer4.1.conv3.weight, mask/weight parameters,78501,78501 density 0.09778205715880102,0.09778205715880102
before tensor 1048576 mask 30951.0 1048576
layer4.2.conv1.weight, mask/weight parameters,30951,30951 density 0.03855304328762755,0.03855304328762755
before tensor 2359296 mask 41141.0 2359296
layer4.2.conv2.weight, mask/weight parameters,41141,41141 density 0.029748166273312046,0.029748166273312046
before tensor 1048576 mask 31276.0 1048576
layer4.2.conv3.weight, mask/weight parameters,31276,31276 density 0.03895786830357143,0.03895786830357143
classifier.weight, mask/weight parameters,97677,97677 density 0.4769384765625,0.4769384765625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.13929719847258695 0.13929719847258695 after dst
Death rate: 0.1459117534502555

dynamic sparse change grow
self.total_params*pruning_rate 3451109.4617815535
self.total_nonzero 2365205.0
to grow 1085904.4617815535
len(all_scores) 16979559 14487261
increse 1085904.0 before_mask 3451108.0 after_mask 3451108.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1560,1412 density 0.9027777777777778,0.8171296296296297
before tensor 4096 mask 1712.0 4096
layer1.0.conv1.weight, mask/weight parameters,1712,1308 density 0.5047169811320755,0.3856132075471698
before tensor 36864 mask 7919.0 36864
layer1.0.conv2.weight, mask/weight parameters,7919,5521 density 0.3132391914876785,0.2183853486808275
before tensor 16384 mask 5431.0 16384
layer1.0.conv3.weight, mask/weight parameters,5431,3845 density 0.400280070754717,0.2833873820754717
layer1.0.shortcut.0.weight, mask/weight parameters,8754,7144 density 0.5343017578125,0.43603515625
before tensor 16384 mask 5086.0 16384
layer1.1.conv1.weight, mask/weight parameters,5086,3135 density 0.37485259433962265,0.23105837264150944
before tensor 36864 mask 7408.0 36864
layer1.1.conv2.weight, mask/weight parameters,7408,5044 density 0.29302638345002174,0.1995174241525256
before tensor 16384 mask 4228.0 16384
layer1.1.conv3.weight, mask/weight parameters,4228,3105 density 0.3116155660377358,0.22884728773584906
before tensor 16384 mask 3733.0 16384
layer1.2.conv1.weight, mask/weight parameters,3733,2301 density 0.27513266509433965,0.16959021226415094
before tensor 36864 mask 4995.0 36864
layer1.2.conv2.weight, mask/weight parameters,4995,3436 density 0.19757920968316126,0.13591234523950793
before tensor 16384 mask 3610.0 16384
layer1.2.conv3.weight, mask/weight parameters,3610,2560 density 0.26606721698113206,0.18867924528301888
before tensor 32768 mask 6821.0 32768
layer2.0.conv1.weight, mask/weight parameters,6821,4396 density 0.2586847694174757,0.16671723300970873
before tensor 147456 mask 16806.0 147456
layer2.0.conv2.weight, mask/weight parameters,16806,13208 density 0.17601407609890973,0.1383311863093181
before tensor 65536 mask 11185.0 65536
layer2.0.conv3.weight, mask/weight parameters,11185,8309 density 0.21209420509708737,0.15755840412621358
layer2.0.shortcut.0.weight, mask/weight parameters,39805,28647 density 0.30368804931640625,0.21855926513671875
before tensor 65536 mask 9948.0 65536
layer2.1.conv1.weight, mask/weight parameters,9948,7459 density 0.1886377427184466,0.1414403822815534
before tensor 147456 mask 19072.0 147456
layer2.1.conv2.weight, mask/weight parameters,19072,14017 density 0.19974654643332182,0.1468040762036426
before tensor 65536 mask 12428.0 65536
layer2.1.conv3.weight, mask/weight parameters,12428,9278 density 0.2356644417475728,0.1759329490291262
before tensor 65536 mask 12531.0 65536
layer2.2.conv1.weight, mask/weight parameters,12531,9382 density 0.2376175667475728,0.177905036407767
before tensor 147456 mask 24716.0 147456
layer2.2.conv2.weight, mask/weight parameters,24716,18409 density 0.25885778322388747,0.19280275656936982
before tensor 65536 mask 14894.0 65536
layer2.2.conv3.weight, mask/weight parameters,14894,11402 density 0.28242566747572817,0.21620904126213591
before tensor 65536 mask 9815.0 65536
layer2.3.conv1.weight, mask/weight parameters,9815,7263 density 0.1861157463592233,0.13772375606796117
before tensor 147456 mask 16121.0 147456
layer2.3.conv2.weight, mask/weight parameters,16121,11987 density 0.16883987390161392,0.12554330180873682
before tensor 65536 mask 10759.0 65536
layer2.3.conv3.weight, mask/weight parameters,10759,7209 density 0.2040162317961165,0.13669978762135923
before tensor 131072 mask 38967.0 131072
layer3.0.conv1.weight, mask/weight parameters,38967,29841 density 0.380537109375,0.291416015625
before tensor 589824 mask 125117.0 589824
layer3.0.conv2.weight, mask/weight parameters,125117,90669 density 0.34754722222222223,0.25185833333333335
before tensor 262144 mask 88881.0 262144
layer3.0.conv3.weight, mask/weight parameters,88881,66333 density 0.4339892578125,0.3238916015625
layer3.0.shortcut.0.weight, mask/weight parameters,122472,88838 density 0.2335968017578125,0.16944503784179688
before tensor 262144 mask 49510.0 262144
layer3.1.conv1.weight, mask/weight parameters,49510,35727 density 0.241748046875,0.1744482421875
before tensor 589824 mask 125899.0 589824
layer3.1.conv2.weight, mask/weight parameters,125899,87542 density 0.34971944444444447,0.24317222222222223
before tensor 262144 mask 84638.0 262144
layer3.1.conv3.weight, mask/weight parameters,84638,62614 density 0.413271484375,0.305732421875
before tensor 262144 mask 63138.0 262144
layer3.2.conv1.weight, mask/weight parameters,63138,46145 density 0.308291015625,0.2253173828125
before tensor 589824 mask 138040.0 589824
layer3.2.conv2.weight, mask/weight parameters,138040,99100 density 0.3834444444444444,0.2752777777777778
before tensor 262144 mask 84205.0 262144
layer3.2.conv3.weight, mask/weight parameters,84205,63197 density 0.4111572265625,0.3085791015625
before tensor 262144 mask 60202.0 262144
layer3.3.conv1.weight, mask/weight parameters,60202,44688 density 0.293955078125,0.218203125
before tensor 589824 mask 106472.0 589824
layer3.3.conv2.weight, mask/weight parameters,106472,76647 density 0.29575555555555555,0.21290833333333334
before tensor 262144 mask 68462.0 262144
layer3.3.conv3.weight, mask/weight parameters,68462,49970 density 0.334287109375,0.243994140625
before tensor 262144 mask 55554.0 262144
layer3.4.conv1.weight, mask/weight parameters,55554,42401 density 0.271259765625,0.2070361328125
before tensor 589824 mask 85225.0 589824
layer3.4.conv2.weight, mask/weight parameters,85225,61923 density 0.23673611111111112,0.17200833333333335
before tensor 262144 mask 55547.0 262144
layer3.4.conv3.weight, mask/weight parameters,55547,40286 density 0.2712255859375,0.196708984375
before tensor 262144 mask 52870.0 262144
layer3.5.conv1.weight, mask/weight parameters,52870,38795 density 0.258154296875,0.1894287109375
before tensor 589824 mask 74673.0 589824
layer3.5.conv2.weight, mask/weight parameters,74673,51702 density 0.207425,0.14361666666666667
before tensor 262144 mask 49273.0 262144
layer3.5.conv3.weight, mask/weight parameters,49273,35691 density 0.2405908203125,0.1742724609375
before tensor 524288 mask 167347.0 524288
layer4.0.conv1.weight, mask/weight parameters,167347,119068 density 0.41690001195790816,0.2966258769132653
before tensor 2359296 mask 335779.0 2359296
layer4.0.conv2.weight, mask/weight parameters,335779,206884 density 0.24279452427229395,0.1495933407376556
before tensor 1048576 mask 149213.0 1048576
layer4.0.conv3.weight, mask/weight parameters,149213,94630 density 0.18586201570471939,0.1178725884885204
layer4.0.shortcut.0.weight, mask/weight parameters,228112,144162 density 0.10877227783203125,0.0687417984008789
before tensor 1048576 mask 105276.0 1048576
layer4.1.conv1.weight, mask/weight parameters,105276,68964 density 0.13113341039540816,0.08590262276785714
before tensor 2359296 mask 238273.0 2359296
layer4.1.conv2.weight, mask/weight parameters,238273,150065 density 0.17229004697116942,0.1085087521403119
before tensor 1048576 mask 124089.0 1048576
layer4.1.conv3.weight, mask/weight parameters,124089,78501 density 0.15456717354910715,0.09778205715880102
before tensor 1048576 mask 56572.0 1048576
layer4.2.conv1.weight, mask/weight parameters,56572,30951 density 0.07046695631377552,0.03855304328762755
before tensor 2359296 mask 89133.0 2359296
layer4.2.conv2.weight, mask/weight parameters,89133,41141 density 0.06445014230181868,0.029748166273312046
before tensor 1048576 mask 57479.0 1048576
layer4.2.conv3.weight, mask/weight parameters,57479,31276 density 0.07159672951211735,0.03895786830357143
classifier.weight, mask/weight parameters,111353,97677 density 0.5437158203125,0.4769384765625
Total Model parameters after dst: 3451108 2365205
Total parameters under density level of 0.1: 0.20325074402697973 0.13929719847258695 after dst
Death rate: 0.1459117534502555


Training summary: Average loss: 1.4358, Accuracy: 29651/50000 (59.302%)


Evaluation: Average loss: 1.6250, Accuracy: 5537/10000 (55.370%)

Current learning rate: 0.1. Time taken for epoch: 90.21 seconds.

Train Epoch: 24 [0/50000 (0%)]	Loss: 1.358943 Accuracy: 61/100 (61.000%
Train Epoch: 24 [10000/50000 (20%)]	Loss: 1.457597 Accuracy: 6133/10100 (60.723%
Train Epoch: 24 [20000/50000 (40%)]	Loss: 1.504319 Accuracy: 12029/20100 (59.846%
Train Epoch: 24 [30000/50000 (60%)]	Loss: 1.260494 Accuracy: 17902/30100 (59.475%
Train Epoch: 24 [40000/50000 (80%)]	Loss: 1.496729 Accuracy: 23979/40100 (59.798%
current layer rate 0.23654415111515703
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5894.0
Total filter_masks items: 14004135.0
5894.0 / 7552 channels
Total channels to prune: 128.3814292216657
Layer ('layer1', 0, 'conv1'): Pruned 1/53.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/53.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/53.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/53.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/53.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/53.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/103.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 8/392.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 8/392.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 8/392.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 8/392.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 8/392.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 8/392.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5776.0
Total filter_masks items: 13587220.0
After apply_mask:
Total filter_names items: 5776.0
Total filter_masks items: 13587220.0
Total pruned: 118/128.3814292216657 channels
===========done ===============

Training summary: Average loss: 1.4285, Accuracy: 29724/50000 (59.448%)


Evaluation: Average loss: 1.9042, Accuracy: 4915/10000 (49.150%)

Current learning rate: 0.1. Time taken for epoch: 88.93 seconds.

Train Epoch: 25 [0/50000 (0%)]	Loss: 1.500303 Accuracy: 55/100 (55.000%
Train Epoch: 25 [10000/50000 (20%)]	Loss: 1.260384 Accuracy: 6218/10100 (61.564%
Train Epoch: 25 [20000/50000 (40%)]	Loss: 1.488643 Accuracy: 12074/20100 (60.070%
Train Epoch: 25 [30000/50000 (60%)]	Loss: 1.622188 Accuracy: 17961/30100 (59.671%
Train Epoch: 25 [40000/50000 (80%)]	Loss: 1.888263 Accuracy: 23861/40100 (59.504%
current mest  death_rate 0.1452254248593737


dynamic sparse change prune
to kill 961162.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1425,1425 density 0.8246527777777778,0.8246527777777778
before tensor 4096 mask 1317.0 4096
layer1.0.conv1.weight, mask/weight parameters,1317,1317 density 0.3957331730769231,0.3957331730769231
before tensor 36864 mask 5382.0 36864
layer1.0.conv2.weight, mask/weight parameters,5382,5382 density 0.22115384615384615,0.22115384615384615
before tensor 16384 mask 3905.0 16384
layer1.0.conv3.weight, mask/weight parameters,3905,3905 density 0.29334435096153844,0.29334435096153844
layer1.0.shortcut.0.weight, mask/weight parameters,7054,7054 density 0.4305419921875,0.4305419921875
before tensor 16384 mask 3370.0 16384
layer1.1.conv1.weight, mask/weight parameters,3370,3370 density 0.2531550480769231,0.2531550480769231
before tensor 36864 mask 5373.0 36864
layer1.1.conv2.weight, mask/weight parameters,5373,5373 density 0.22078402366863906,0.22078402366863906
before tensor 16384 mask 3035.0 16384
layer1.1.conv3.weight, mask/weight parameters,3035,3035 density 0.22798978365384615,0.22798978365384615
before tensor 16384 mask 2323.0 16384
layer1.2.conv1.weight, mask/weight parameters,2323,2323 density 0.17450420673076922,0.17450420673076922
before tensor 36864 mask 3476.0 36864
layer1.2.conv2.weight, mask/weight parameters,3476,3476 density 0.1428336620644313,0.1428336620644313
before tensor 16384 mask 2510.0 16384
layer1.2.conv3.weight, mask/weight parameters,2510,2510 density 0.18855168269230768,0.18855168269230768
before tensor 32768 mask 4572.0 32768
layer2.0.conv1.weight, mask/weight parameters,4572,4572 density 0.17682549504950495,0.17682549504950495
before tensor 147456 mask 12777.0 147456
layer2.0.conv2.weight, mask/weight parameters,12777,12777 density 0.13916936248080253,0.13916936248080253
before tensor 65536 mask 8259.0 65536
layer2.0.conv3.weight, mask/weight parameters,8259,8259 density 0.15971147896039603,0.15971147896039603
layer2.0.shortcut.0.weight, mask/weight parameters,28330,28330 density 0.2161407470703125,0.2161407470703125
before tensor 65536 mask 7249.0 65536
layer2.1.conv1.weight, mask/weight parameters,7249,7249 density 0.14018022896039603,0.14018022896039603
before tensor 147456 mask 12711.0 147456
layer2.1.conv2.weight, mask/weight parameters,12711,12711 density 0.13845047871123747,0.13845047871123747
before tensor 65536 mask 8940.0 65536
layer2.1.conv3.weight, mask/weight parameters,8940,8940 density 0.1728805693069307,0.1728805693069307
before tensor 65536 mask 9456.0 65536
layer2.2.conv1.weight, mask/weight parameters,9456,9456 density 0.1828589108910891,0.1828589108910891
before tensor 147456 mask 18398.0 147456
layer2.2.conv2.weight, mask/weight parameters,18398,18398 density 0.20039429685542812,0.20039429685542812
before tensor 65536 mask 11039.0 65536
layer2.2.conv3.weight, mask/weight parameters,11039,11039 density 0.21347076113861385,0.21347076113861385
before tensor 65536 mask 6978.0 65536
layer2.3.conv1.weight, mask/weight parameters,6978,6978 density 0.13493966584158415,0.13493966584158415
before tensor 147456 mask 12007.0 147456
layer2.3.conv2.weight, mask/weight parameters,12007,12007 density 0.13078238516920998,0.13078238516920998
before tensor 65536 mask 7584.0 65536
layer2.3.conv3.weight, mask/weight parameters,7584,7584 density 0.14665841584158415,0.14665841584158415
before tensor 131072 mask 28507.0 131072
layer3.0.conv1.weight, mask/weight parameters,28507,28507 density 0.28407007334183676,0.28407007334183676
before tensor 589824 mask 87321.0 589824
layer3.0.conv2.weight, mask/weight parameters,87321,87321 density 0.25255969734832706,0.25255969734832706
before tensor 262144 mask 66727.0 262144
layer3.0.conv3.weight, mask/weight parameters,66727,66727 density 0.3324647241709184,0.3324647241709184
layer3.0.shortcut.0.weight, mask/weight parameters,87662,87662 density 0.16720199584960938,0.16720199584960938
before tensor 262144 mask 35516.0 262144
layer3.1.conv1.weight, mask/weight parameters,35516,35516 density 0.17695711096938777,0.17695711096938777
before tensor 589824 mask 86339.0 589824
layer3.1.conv2.weight, mask/weight parameters,86339,86339 density 0.2497194456013698,0.2497194456013698
before tensor 262144 mask 62310.0 262144
layer3.1.conv3.weight, mask/weight parameters,62310,62310 density 0.31045719068877553,0.31045719068877553
before tensor 262144 mask 45176.0 262144
layer3.2.conv1.weight, mask/weight parameters,45176,45176 density 0.22508769132653061,0.22508769132653061
before tensor 589824 mask 97200.0 589824
layer3.2.conv2.weight, mask/weight parameters,97200,97200 density 0.2811328613077884,0.2811328613077884
before tensor 262144 mask 62594.0 262144
layer3.2.conv3.weight, mask/weight parameters,62594,62594 density 0.31187220982142855,0.31187220982142855
before tensor 262144 mask 42582.0 262144
layer3.3.conv1.weight, mask/weight parameters,42582,42582 density 0.2121631855867347,0.2121631855867347
before tensor 589824 mask 73281.0 589824
layer3.3.conv2.weight, mask/weight parameters,73281,73281 density 0.21195161738164653,0.21195161738164653
before tensor 262144 mask 48882.0 262144
layer3.3.conv3.weight, mask/weight parameters,48882,48882 density 0.24355269451530612,0.24355269451530612
before tensor 262144 mask 39418.0 262144
layer3.4.conv1.weight, mask/weight parameters,39418,39418 density 0.19639867665816327,0.19639867665816327
before tensor 589824 mask 58711.0 589824
layer3.4.conv2.weight, mask/weight parameters,58711,58711 density 0.16981061131935768,0.16981061131935768
before tensor 262144 mask 39101.0 262144
layer3.4.conv3.weight, mask/weight parameters,39101,39101 density 0.1948192362882653,0.1948192362882653
before tensor 262144 mask 37611.0 262144
layer3.5.conv1.weight, mask/weight parameters,37611,37611 density 0.18739536830357142,0.18739536830357142
before tensor 589824 mask 51626.0 589824
layer3.5.conv2.weight, mask/weight parameters,51626,51626 density 0.14931857096580128,0.14931857096580128
before tensor 262144 mask 34883.0 262144
layer3.5.conv3.weight, mask/weight parameters,34883,34883 density 0.17380321269132654,0.17380321269132654
before tensor 524288 mask 123710.0 524288
layer4.0.conv1.weight, mask/weight parameters,123710,123710 density 0.3146107991536458,0.3146107991536458
before tensor 2359296 mask 217813.0 2359296
layer4.0.conv2.weight, mask/weight parameters,217813,217813 density 0.16412654923804013,0.16412654923804013
before tensor 1048576 mask 97482.0 1048576
layer4.0.conv3.weight, mask/weight parameters,97482,97482 density 0.12395477294921875,0.12395477294921875
layer4.0.shortcut.0.weight, mask/weight parameters,143891,143891 density 0.06861257553100586,0.06861257553100586
before tensor 1048576 mask 71411.0 1048576
layer4.1.conv1.weight, mask/weight parameters,71411,71411 density 0.0908037821451823,0.0908037821451823
before tensor 2359296 mask 153604.0 2359296
layer4.1.conv2.weight, mask/weight parameters,153604,153604 density 0.11574375482253087,0.11574375482253087
before tensor 1048576 mask 78899.0 1048576
layer4.1.conv3.weight, mask/weight parameters,78899,78899 density 0.1003252665201823,0.1003252665201823
before tensor 1048576 mask 33313.0 1048576
layer4.2.conv1.weight, mask/weight parameters,33313,33313 density 0.04235967000325521,0.04235967000325521
before tensor 2359296 mask 42901.0 2359296
layer4.2.conv2.weight, mask/weight parameters,42901,42901 density 0.03232678071952161,0.03232678071952161
before tensor 1048576 mask 31506.0 1048576
layer4.2.conv3.weight, mask/weight parameters,31506,31506 density 0.04006195068359375,0.04006195068359375
classifier.weight, mask/weight parameters,97759,97759 density 0.4773388671875,0.4773388671875
Total Model parameters after dst: 2365206 2365206
Total parameters under density level of 0.1: 0.14280364898261413 0.14280364898261413 after dst
Death rate: 0.1452254248593737

dynamic sparse change grow
self.total_params*pruning_rate 3434876.3959875023
self.total_nonzero 2365206.0
to grow 1069670.3959875023
len(all_scores) 16562644 14000749
increse 1069670.0 before_mask 3434875.0 after_mask 3434875.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1527,1425 density 0.8836805555555556,0.8246527777777778
before tensor 4096 mask 1423.0 4096
layer1.0.conv1.weight, mask/weight parameters,1423,1317 density 0.42758413461538464,0.3957331730769231
before tensor 36864 mask 6998.0 36864
layer1.0.conv2.weight, mask/weight parameters,6998,5382 density 0.28755752794214334,0.22115384615384615
before tensor 16384 mask 4850.0 16384
layer1.0.conv3.weight, mask/weight parameters,4850,3905 density 0.3643329326923077,0.29334435096153844
layer1.0.shortcut.0.weight, mask/weight parameters,8387,7054 density 0.51190185546875,0.4305419921875
before tensor 16384 mask 4047.0 16384
layer1.1.conv1.weight, mask/weight parameters,4047,3370 density 0.3040114182692308,0.2531550480769231
before tensor 36864 mask 6432.0 36864
layer1.1.conv2.weight, mask/weight parameters,6432,5373 density 0.26429980276134124,0.22078402366863906
before tensor 16384 mask 4240.0 16384
layer1.1.conv3.weight, mask/weight parameters,4240,3035 density 0.31850961538461536,0.22798978365384615
before tensor 16384 mask 3178.0 16384
layer1.2.conv1.weight, mask/weight parameters,3178,2323 density 0.23873197115384615,0.17450420673076922
before tensor 36864 mask 4671.0 36864
layer1.2.conv2.weight, mask/weight parameters,4671,3476 density 0.1919378698224852,0.1428336620644313
before tensor 16384 mask 3634.0 16384
layer1.2.conv3.weight, mask/weight parameters,3634,2510 density 0.27298677884615385,0.18855168269230768
before tensor 32768 mask 6986.0 32768
layer2.0.conv1.weight, mask/weight parameters,6986,4572 density 0.2701887376237624,0.17682549504950495
before tensor 147456 mask 17310.0 147456
layer2.0.conv2.weight, mask/weight parameters,17310,12777 density 0.1885436068359311,0.13916936248080253
before tensor 65536 mask 11322.0 65536
layer2.0.conv3.weight, mask/weight parameters,11322,8259 density 0.21894337871287128,0.15971147896039603
layer2.0.shortcut.0.weight, mask/weight parameters,41639,28330 density 0.31768035888671875,0.2161407470703125
before tensor 65536 mask 10080.0 65536
layer2.1.conv1.weight, mask/weight parameters,10080,7249 density 0.19492574257425743,0.14018022896039603
before tensor 147456 mask 20339.0 147456
layer2.1.conv2.weight, mask/weight parameters,20339,12711 density 0.22153601498763736,0.13845047871123747
before tensor 65536 mask 12510.0 65536
layer2.1.conv3.weight, mask/weight parameters,12510,8940 density 0.2419167698019802,0.1728805693069307
before tensor 65536 mask 13393.0 65536
layer2.2.conv1.weight, mask/weight parameters,13393,9456 density 0.25899211014851486,0.1828589108910891
before tensor 147456 mask 27617.0 147456
layer2.2.conv2.weight, mask/weight parameters,27617,18398 density 0.30080928884967706,0.20039429685542812
before tensor 65536 mask 16148.0 65536
layer2.2.conv3.weight, mask/weight parameters,16148,11039 density 0.31226794554455445,0.21347076113861385
before tensor 65536 mask 9667.0 65536
layer2.3.conv1.weight, mask/weight parameters,9667,6978 density 0.18693920173267325,0.13493966584158415
before tensor 147456 mask 15626.0 147456
layer2.3.conv2.weight, mask/weight parameters,15626,12007 density 0.17020117853369496,0.13078238516920998
before tensor 65536 mask 10352.0 65536
layer2.3.conv3.weight, mask/weight parameters,10352,7584 density 0.20018564356435645,0.14665841584158415
before tensor 131072 mask 42820.0 131072
layer3.0.conv1.weight, mask/weight parameters,42820,28507 density 0.4266980229591837,0.28407007334183676
before tensor 589824 mask 130951.0 589824
layer3.0.conv2.weight, mask/weight parameters,130951,87321 density 0.37875133046415843,0.25255969734832706
before tensor 262144 mask 88675.0 262144
layer3.0.conv3.weight, mask/weight parameters,88675,66727 density 0.4418197943239796,0.3324647241709184
layer3.0.shortcut.0.weight, mask/weight parameters,124668,87662 density 0.23778533935546875,0.16720199584960938
before tensor 262144 mask 50465.0 262144
layer3.1.conv1.weight, mask/weight parameters,50465,35516 density 0.25143993144132654,0.17695711096938777
before tensor 589824 mask 123856.0 589824
layer3.1.conv2.weight, mask/weight parameters,123856,86339 density 0.35823036697672267,0.2497194456013698
before tensor 262144 mask 82554.0 262144
layer3.1.conv3.weight, mask/weight parameters,82554,62310 density 0.4113221460459184,0.31045719068877553
before tensor 262144 mask 63729.0 262144
layer3.2.conv1.weight, mask/weight parameters,63729,45176 density 0.31752730389030615,0.22508769132653061
before tensor 589824 mask 137019.0 589824
layer3.2.conv2.weight, mask/weight parameters,137019,97200 density 0.39630188810217964,0.2811328613077884
before tensor 262144 mask 83922.0 262144
layer3.2.conv3.weight, mask/weight parameters,83922,62594 density 0.4181381536989796,0.31187220982142855
before tensor 262144 mask 60382.0 262144
layer3.3.conv1.weight, mask/weight parameters,60382,42582 density 0.3008510044642857,0.2121631855867347
before tensor 589824 mask 105010.0 589824
layer3.3.conv2.weight, mask/weight parameters,105010,73281 density 0.30372182886760146,0.21195161738164653
before tensor 262144 mask 67064.0 262144
layer3.3.conv3.weight, mask/weight parameters,67064,48882 density 0.3341438137755102,0.24355269451530612
before tensor 262144 mask 58050.0 262144
layer3.4.conv1.weight, mask/weight parameters,58050,39418 density 0.2892319036989796,0.19639867665816327
before tensor 589824 mask 90522.0 589824
layer3.4.conv2.weight, mask/weight parameters,90522,58711 density 0.2618179925031237,0.16981061131935768
before tensor 262144 mask 57985.0 262144
layer3.4.conv3.weight, mask/weight parameters,57985,39101 density 0.28890804368622447,0.1948192362882653
before tensor 262144 mask 54513.0 262144
layer3.5.conv1.weight, mask/weight parameters,54513,37611 density 0.2716089365433674,0.18739536830357142
before tensor 589824 mask 76302.0 589824
layer3.5.conv2.weight, mask/weight parameters,76302,51626 density 0.22068929612661392,0.14931857096580128
before tensor 262144 mask 50045.0 262144
layer3.5.conv3.weight, mask/weight parameters,50045,34883 density 0.2493472975127551,0.17380321269132654
before tensor 524288 mask 166613.0 524288
layer4.0.conv1.weight, mask/weight parameters,166613,123710 density 0.42371877034505206,0.3146107991536458
before tensor 2359296 mask 332122.0 2359296
layer4.0.conv2.weight, mask/weight parameters,332122,217813 density 0.2502607180748457,0.16412654923804013
before tensor 1048576 mask 146974.0 1048576
layer4.0.conv3.weight, mask/weight parameters,146974,97482 density 0.1868871053059896,0.12395477294921875
layer4.0.shortcut.0.weight, mask/weight parameters,218996,143891 density 0.10442543029785156,0.06861257553100586
before tensor 1048576 mask 104187.0 1048576
layer4.1.conv1.weight, mask/weight parameters,104187,71411 density 0.13248062133789062,0.0908037821451823
before tensor 2359296 mask 235489.0 2359296
layer4.1.conv2.weight, mask/weight parameters,235489,153604 density 0.17744577666859568,0.11574375482253087
before tensor 1048576 mask 117034.0 1048576
layer4.1.conv3.weight, mask/weight parameters,117034,78899 density 0.1488164265950521,0.1003252665201823
before tensor 1048576 mask 55175.0 1048576
layer4.2.conv1.weight, mask/weight parameters,55175,33313 density 0.0701586405436198,0.04235967000325521
before tensor 2359296 mask 88393.0 2359296
layer4.2.conv2.weight, mask/weight parameters,88393,42901 density 0.06660593291859568,0.03232678071952161
before tensor 1048576 mask 49816.0 1048576
layer4.2.conv3.weight, mask/weight parameters,49816,31506 density 0.06334431966145833,0.04006195068359375
classifier.weight, mask/weight parameters,109168,97759 density 0.533046875,0.4773388671875
Total Model parameters after dst: 3434875 2365206
Total parameters under density level of 0.1: 0.20738687615334847 0.14280364898261413 after dst
Death rate: 0.1452254248593737


Training summary: Average loss: 1.4102, Accuracy: 29836/50000 (59.672%)


Evaluation: Average loss: 1.5999, Accuracy: 5651/10000 (56.510%)

Current learning rate: 0.1. Time taken for epoch: 89.13 seconds.

Train Epoch: 26 [0/50000 (0%)]	Loss: 1.365774 Accuracy: 61/100 (61.000%
Train Epoch: 26 [10000/50000 (20%)]	Loss: 1.492823 Accuracy: 6185/10100 (61.238%
Train Epoch: 26 [20000/50000 (40%)]	Loss: 1.891077 Accuracy: 12114/20100 (60.269%
Train Epoch: 26 [30000/50000 (60%)]	Loss: 1.461957 Accuracy: 18094/30100 (60.113%
Train Epoch: 26 [40000/50000 (80%)]	Loss: 1.305197 Accuracy: 24083/40100 (60.057%
current layer rate 0.25131383705052346
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5776.0
Total filter_masks items: 13587220.0
5776.0 / 7552 channels
Total channels to prune: 121.92209740555336
Layer ('layer1', 0, 'conv1'): Pruned 1/52.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/52.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/52.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/52.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/52.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/52.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/101.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 8/384.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 8/384.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 8/384.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 8/384.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 8/384.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 8/384.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5658.0
Total filter_masks items: 13175831.0
After apply_mask:
Total filter_names items: 5658.0
Total filter_masks items: 13175831.0
Total pruned: 118/121.92209740555336 channels
===========done ===============

Training summary: Average loss: 1.4005, Accuracy: 30115/50000 (60.230%)


Evaluation: Average loss: 1.8175, Accuracy: 5145/10000 (51.450%)

Current learning rate: 0.1. Time taken for epoch: 88.93 seconds.

Train Epoch: 27 [0/50000 (0%)]	Loss: 1.171273 Accuracy: 64/100 (64.000%
Train Epoch: 27 [10000/50000 (20%)]	Loss: 1.535951 Accuracy: 6136/10100 (60.752%
Train Epoch: 27 [20000/50000 (40%)]	Loss: 1.364651 Accuracy: 12143/20100 (60.413%
Train Epoch: 27 [30000/50000 (60%)]	Loss: 1.435674 Accuracy: 18084/30100 (60.080%
Train Epoch: 27 [40000/50000 (80%)]	Loss: 1.343465 Accuracy: 24176/40100 (60.289%
current mest  death_rate 0.14449185885158072


dynamic sparse change prune
to kill 950755.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1396,1396 density 0.8078703703703703,0.8078703703703703
before tensor 4096 mask 1111.0 4096
layer1.0.conv1.weight, mask/weight parameters,1111,1111 density 0.3403799019607843,0.3403799019607843
before tensor 36864 mask 4946.0 36864
layer1.0.conv2.weight, mask/weight parameters,4946,4946 density 0.21128625742235893,0.21128625742235893
before tensor 16384 mask 3555.0 16384
layer1.0.conv3.weight, mask/weight parameters,3555,3555 density 0.27228860294117646,0.27228860294117646
layer1.0.shortcut.0.weight, mask/weight parameters,6875,6875 density 0.41961669921875,0.41961669921875
before tensor 16384 mask 2972.0 16384
layer1.1.conv1.weight, mask/weight parameters,2972,2972 density 0.22763480392156862,0.22763480392156862
before tensor 36864 mask 4786.0 36864
layer1.1.conv2.weight, mask/weight parameters,4786,4786 density 0.20445127942244437,0.20445127942244437
before tensor 16384 mask 3039.0 16384
layer1.1.conv3.weight, mask/weight parameters,3039,3039 density 0.23276654411764705,0.23276654411764705
before tensor 16384 mask 2264.0 16384
layer1.2.conv1.weight, mask/weight parameters,2264,2264 density 0.17340686274509803,0.17340686274509803
before tensor 36864 mask 3366.0 36864
layer1.2.conv2.weight, mask/weight parameters,3366,3366 density 0.1437908496732026,0.1437908496732026
before tensor 16384 mask 2527.0 16384
layer1.2.conv3.weight, mask/weight parameters,2527,2527 density 0.19355085784313725,0.19355085784313725
before tensor 32768 mask 4671.0 32768
layer2.0.conv1.weight, mask/weight parameters,4671,4671 density 0.18430397727272727,0.18430397727272727
before tensor 147456 mask 12459.0 147456
layer2.0.conv2.weight, mask/weight parameters,12459,12459 density 0.14124409073904023,0.14124409073904023
before tensor 65536 mask 8159.0 65536
layer2.0.conv3.weight, mask/weight parameters,8159,8159 density 0.16096511994949494,0.16096511994949494
layer2.0.shortcut.0.weight, mask/weight parameters,28979,28979 density 0.22109222412109375,0.22109222412109375
before tensor 65536 mask 7289.0 65536
layer2.1.conv1.weight, mask/weight parameters,7289,7289 density 0.1438012941919192,0.1438012941919192
before tensor 147456 mask 12900.0 147456
layer2.1.conv2.weight, mask/weight parameters,12900,12900 density 0.14624358058701492,0.14624358058701492
before tensor 65536 mask 8794.0 65536
layer2.1.conv3.weight, mask/weight parameters,8794,8794 density 0.1734927398989899,0.1734927398989899
before tensor 65536 mask 9414.0 65536
layer2.2.conv1.weight, mask/weight parameters,9414,9414 density 0.18572443181818182,0.18572443181818182
before tensor 147456 mask 19055.0 147456
layer2.2.conv2.weight, mask/weight parameters,19055,19055 density 0.21602104093686586,0.21602104093686586
before tensor 65536 mask 11395.0 65536
layer2.2.conv3.weight, mask/weight parameters,11395,11395 density 0.22480666035353536,0.22480666035353536
before tensor 65536 mask 7061.0 65536
layer2.3.conv1.weight, mask/weight parameters,7061,7061 density 0.13930318813131312,0.13930318813131312
before tensor 147456 mask 11879.0 147456
layer2.3.conv2.weight, mask/weight parameters,11879,11879 density 0.13466879796846126,0.13466879796846126
before tensor 65536 mask 7497.0 65536
layer2.3.conv3.weight, mask/weight parameters,7497,7497 density 0.14790482954545456,0.14790482954545456
before tensor 131072 mask 30057.0 131072
layer3.0.conv1.weight, mask/weight parameters,30057,30057 density 0.305755615234375,0.305755615234375
before tensor 589824 mask 90881.0 589824
layer3.0.conv2.weight, mask/weight parameters,90881,90881 density 0.2739227671682099,0.2739227671682099
before tensor 262144 mask 66744.0 262144
layer3.0.conv3.weight, mask/weight parameters,66744,66744 density 0.3394775390625,0.3394775390625
layer3.0.shortcut.0.weight, mask/weight parameters,89109,89109 density 0.16996192932128906,0.16996192932128906
before tensor 262144 mask 35344.0 262144
layer3.1.conv1.weight, mask/weight parameters,35344,35344 density 0.17976888020833334,0.17976888020833334
before tensor 589824 mask 84733.0 589824
layer3.1.conv2.weight, mask/weight parameters,84733,84733 density 0.25539219232253085,0.25539219232253085
before tensor 262144 mask 61176.0 262144
layer3.1.conv3.weight, mask/weight parameters,61176,61176 density 0.3111572265625,0.3111572265625
before tensor 262144 mask 45661.0 262144
layer3.2.conv1.weight, mask/weight parameters,45661,45661 density 0.23224385579427084,0.23224385579427084
before tensor 589824 mask 96965.0 589824
layer3.2.conv2.weight, mask/weight parameters,96965,96965 density 0.292260440779321,0.292260440779321
before tensor 262144 mask 62455.0 262144
layer3.2.conv3.weight, mask/weight parameters,62455,62455 density 0.3176625569661458,0.3176625569661458
before tensor 262144 mask 42453.0 262144
layer3.3.conv1.weight, mask/weight parameters,42453,42453 density 0.2159271240234375,0.2159271240234375
before tensor 589824 mask 72767.0 589824
layer3.3.conv2.weight, mask/weight parameters,72767,72767 density 0.21932568962191357,0.21932568962191357
before tensor 262144 mask 47954.0 262144
layer3.3.conv3.weight, mask/weight parameters,47954,47954 density 0.24390665690104166,0.24390665690104166
before tensor 262144 mask 40505.0 262144
layer3.4.conv1.weight, mask/weight parameters,40505,40505 density 0.20601908365885416,0.20601908365885416
before tensor 589824 mask 60146.0 589824
layer3.4.conv2.weight, mask/weight parameters,60146,60146 density 0.18128496334876543,0.18128496334876543
before tensor 262144 mask 40059.0 262144
layer3.4.conv3.weight, mask/weight parameters,40059,40059 density 0.2037506103515625,0.2037506103515625
before tensor 262144 mask 38532.0 262144
layer3.5.conv1.weight, mask/weight parameters,38532,38532 density 0.19598388671875,0.19598388671875
before tensor 589824 mask 52309.0 589824
layer3.5.conv2.weight, mask/weight parameters,52309,52309 density 0.1576636043595679,0.1576636043595679
before tensor 262144 mask 35266.0 262144
layer3.5.conv3.weight, mask/weight parameters,35266,35266 density 0.17937215169270834,0.17937215169270834
before tensor 524288 mask 125286.0 524288
layer4.0.conv1.weight, mask/weight parameters,125286,125286 density 0.32539789727393614,0.32539789727393614
before tensor 2359296 mask 220421.0 2359296
layer4.0.conv2.weight, mask/weight parameters,220421,220421 density 0.17323465243197023,0.17323465243197023
before tensor 1048576 mask 97367.0 1048576
layer4.0.conv3.weight, mask/weight parameters,97367,97367 density 0.12644276720412234,0.12644276720412234
layer4.0.shortcut.0.weight, mask/weight parameters,139714,139714 density 0.0666208267211914,0.0666208267211914
before tensor 1048576 mask 71129.0 1048576
layer4.1.conv1.weight, mask/weight parameters,71129,71129 density 0.0923695665724734,0.0923695665724734
before tensor 2359296 mask 153079.0 2359296
layer4.1.conv2.weight, mask/weight parameters,153079,153079 density 0.1203088061465721,0.1203088061465721
before tensor 1048576 mask 75954.0 1048576
layer4.1.conv3.weight, mask/weight parameters,75954,75954 density 0.09863540974069149,0.09863540974069149
before tensor 1048576 mask 33355.0 1048576
layer4.2.conv1.weight, mask/weight parameters,33355,33355 density 0.04331548163231383,0.04331548163231383
before tensor 2359296 mask 43019.0 2359296
layer4.2.conv2.weight, mask/weight parameters,43019,43019 density 0.03380976183290579,0.03380976183290579
before tensor 1048576 mask 29708.0 1048576
layer4.2.conv3.weight, mask/weight parameters,29708,29708 density 0.03857941323138298,0.03857941323138298
classifier.weight, mask/weight parameters,96668,96668 density 0.47201171875,0.47201171875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.14644094220541995 0.14644094220541995 after dst
Death rate: 0.14449185885158072

dynamic sparse change grow
self.total_params*pruning_rate 3417526.0692970706
self.total_nonzero 2365205.0
to grow 1052321.0692970706
len(all_scores) 16151255 13541693
increse 1052321.0 before_mask 3417525.0 after_mask 3417525.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1545,1396 density 0.8940972222222222,0.8078703703703703
before tensor 4096 mask 1382.0 4096
layer1.0.conv1.weight, mask/weight parameters,1382,1111 density 0.42340686274509803,0.3403799019607843
before tensor 36864 mask 7031.0 36864
layer1.0.conv2.weight, mask/weight parameters,7031,4946 density 0.3003545644837456,0.21128625742235893
before tensor 16384 mask 4726.0 16384
layer1.0.conv3.weight, mask/weight parameters,4726,3555 density 0.3619791666666667,0.27228860294117646
layer1.0.shortcut.0.weight, mask/weight parameters,8172,6875 density 0.498779296875,0.41961669921875
before tensor 16384 mask 4215.0 16384
layer1.1.conv1.weight, mask/weight parameters,4215,2972 density 0.32284007352941174,0.22763480392156862
before tensor 36864 mask 6662.0 36864
layer1.1.conv2.weight, mask/weight parameters,6662,4786 density 0.2845913964714426,0.20445127942244437
before tensor 16384 mask 4216.0 16384
layer1.1.conv3.weight, mask/weight parameters,4216,3039 density 0.3229166666666667,0.23276654411764705
before tensor 16384 mask 3482.0 16384
layer1.2.conv1.weight, mask/weight parameters,3482,2264 density 0.26669730392156865,0.17340686274509803
before tensor 36864 mask 4535.0 36864
layer1.2.conv2.weight, mask/weight parameters,4535,3366 density 0.1937289076850784,0.1437908496732026
before tensor 16384 mask 3629.0 16384
layer1.2.conv3.weight, mask/weight parameters,3629,2527 density 0.2779564950980392,0.19355085784313725
before tensor 32768 mask 6369.0 32768
layer2.0.conv1.weight, mask/weight parameters,6369,4671 density 0.2513020833333333,0.18430397727272727
before tensor 147456 mask 15700.0 147456
layer2.0.conv2.weight, mask/weight parameters,15700,12459 density 0.17798637327256855,0.14124409073904023
before tensor 65536 mask 10497.0 65536
layer2.0.conv3.weight, mask/weight parameters,10497,8159 density 0.2070904356060606,0.16096511994949494
layer2.0.shortcut.0.weight, mask/weight parameters,39840,28979 density 0.303955078125,0.22109222412109375
before tensor 65536 mask 9779.0 65536
layer2.1.conv1.weight, mask/weight parameters,9779,7289 density 0.1929253472222222,0.1438012941919192
before tensor 147456 mask 16918.0 147456
layer2.1.conv2.weight, mask/weight parameters,16918,12900 density 0.1917944880907844,0.14624358058701492
before tensor 65536 mask 12226.0 65536
layer2.1.conv3.weight, mask/weight parameters,12226,8794 density 0.24120107323232323,0.1734927398989899
before tensor 65536 mask 11991.0 65536
layer2.2.conv1.weight, mask/weight parameters,11991,9414 density 0.23656486742424243,0.18572443181818182
before tensor 147456 mask 26069.0 147456
layer2.2.conv2.weight, mask/weight parameters,26069,19055 density 0.2955367366141777,0.21602104093686586
before tensor 65536 mask 15269.0 65536
layer2.2.conv3.weight, mask/weight parameters,15269,11395 density 0.3012350063131313,0.22480666035353536
before tensor 65536 mask 9618.0 65536
layer2.3.conv1.weight, mask/weight parameters,9618,7061 density 0.18974905303030304,0.13930318813131312
before tensor 147456 mask 15644.0 147456
layer2.3.conv2.weight, mask/weight parameters,15644,11879 density 0.1773515174188575,0.13466879796846126
before tensor 65536 mask 10105.0 65536
layer2.3.conv3.weight, mask/weight parameters,10105,7497 density 0.19935684974747475,0.14790482954545456
before tensor 131072 mask 41266.0 131072
layer3.0.conv1.weight, mask/weight parameters,41266,30057 density 0.4197794596354167,0.305755615234375
before tensor 589824 mask 128156.0 589824
layer3.0.conv2.weight, mask/weight parameters,128156,90881 density 0.3862726658950617,0.2739227671682099
before tensor 262144 mask 88529.0 262144
layer3.0.conv3.weight, mask/weight parameters,88529,66744 density 0.4502817789713542,0.3394775390625
layer3.0.shortcut.0.weight, mask/weight parameters,126179,89109 density 0.24066734313964844,0.16996192932128906
before tensor 262144 mask 46470.0 262144
layer3.1.conv1.weight, mask/weight parameters,46470,35344 density 0.236358642578125,0.17976888020833334
before tensor 589824 mask 116505.0 589824
layer3.1.conv2.weight, mask/weight parameters,116505,84733 density 0.3511555989583333,0.25539219232253085
before tensor 262144 mask 80726.0 262144
layer3.1.conv3.weight, mask/weight parameters,80726,61176 density 0.4105936686197917,0.3111572265625
before tensor 262144 mask 59514.0 262144
layer3.2.conv1.weight, mask/weight parameters,59514,45661 density 0.302703857421875,0.23224385579427084
before tensor 589824 mask 129134.0 589824
layer3.2.conv2.weight, mask/weight parameters,129134,96965 density 0.38922043788580246,0.292260440779321
before tensor 262144 mask 83615.0 262144
layer3.2.conv3.weight, mask/weight parameters,83615,62455 density 0.4252878824869792,0.3176625569661458
before tensor 262144 mask 60728.0 262144
layer3.3.conv1.weight, mask/weight parameters,60728,42453 density 0.3088785807291667,0.2159271240234375
before tensor 589824 mask 105444.0 589824
layer3.3.conv2.weight, mask/weight parameters,105444,72767 density 0.3178168402777778,0.21932568962191357
before tensor 262144 mask 66912.0 262144
layer3.3.conv3.weight, mask/weight parameters,66912,47954 density 0.34033203125,0.24390665690104166
before tensor 262144 mask 56742.0 262144
layer3.4.conv1.weight, mask/weight parameters,56742,40505 density 0.288604736328125,0.20601908365885416
before tensor 589824 mask 83645.0 589824
layer3.4.conv2.weight, mask/weight parameters,83645,60146 density 0.25211287133487653,0.18128496334876543
before tensor 262144 mask 54652.0 262144
layer3.4.conv3.weight, mask/weight parameters,54652,40059 density 0.2779744466145833,0.2037506103515625
before tensor 262144 mask 58163.0 262144
layer3.5.conv1.weight, mask/weight parameters,58163,38532 density 0.2958323160807292,0.19598388671875
before tensor 589824 mask 81565.0 589824
layer3.5.conv2.weight, mask/weight parameters,81565,52309 density 0.24584358121141975,0.1576636043595679
before tensor 262144 mask 51762.0 262144
layer3.5.conv3.weight, mask/weight parameters,51762,35266 density 0.263275146484375,0.17937215169270834
before tensor 524288 mask 169019.0 524288
layer4.0.conv1.weight, mask/weight parameters,169019,125286 density 0.43898302443484044,0.32539789727393614
before tensor 2359296 mask 339228.0 2359296
layer4.0.conv2.weight, mask/weight parameters,339228,220421 density 0.26660819375282935,0.17323465243197023
before tensor 1048576 mask 149241.0 1048576
layer4.0.conv3.weight, mask/weight parameters,149241,97367 density 0.19380739901928193,0.12644276720412234
layer4.0.shortcut.0.weight, mask/weight parameters,223404,139714 density 0.10652732849121094,0.0666208267211914
before tensor 1048576 mask 104947.0 1048576
layer4.1.conv1.weight, mask/weight parameters,104947,71129 density 0.13628630942486702,0.0923695665724734
before tensor 2359296 mask 231976.0 2359296
layer4.1.conv2.weight, mask/weight parameters,231976,153079 density 0.18231603038076555,0.1203088061465721
before tensor 1048576 mask 115416.0 1048576
layer4.1.conv3.weight, mask/weight parameters,115416,75954 density 0.14988156582446807,0.09863540974069149
before tensor 1048576 mask 60571.0 1048576
layer4.2.conv1.weight, mask/weight parameters,60571,33355 density 0.07865873296210106,0.04331548163231383
before tensor 2359296 mask 91093.0 2359296
layer4.2.conv2.weight, mask/weight parameters,91093,43019 density 0.0715923809164529,0.03380976183290579
before tensor 1048576 mask 54529.0 1048576
layer4.2.conv3.weight, mask/weight parameters,54529,29708 density 0.07081246883311171,0.03857941323138298
classifier.weight, mask/weight parameters,108774,96668 density 0.531123046875,0.47201171875
Total Model parameters after dst: 3417525 2365205
Total parameters under density level of 0.1: 0.2115950122761358 0.14644094220541995 after dst
Death rate: 0.14449185885158072


Training summary: Average loss: 1.3968, Accuracy: 30202/50000 (60.404%)


Evaluation: Average loss: 1.5816, Accuracy: 5655/10000 (56.550%)

Current learning rate: 0.1. Time taken for epoch: 89.15 seconds.

Train Epoch: 28 [0/50000 (0%)]	Loss: 1.224041 Accuracy: 58/100 (58.000%
Train Epoch: 28 [10000/50000 (20%)]	Loss: 1.193538 Accuracy: 6232/10100 (61.703%
Train Epoch: 28 [20000/50000 (40%)]	Loss: 1.362532 Accuracy: 12400/20100 (61.692%
Train Epoch: 28 [30000/50000 (60%)]	Loss: 1.781140 Accuracy: 18405/30100 (61.146%
Train Epoch: 28 [40000/50000 (80%)]	Loss: 1.494971 Accuracy: 24440/40100 (60.948%
current layer rate 0.2655209376422394
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5658.0
Total filter_masks items: 13175831.0
5658.0 / 7552 channels
Total channels to prune: 111.21412107419201
Layer ('layer1', 0, 'conv1'): Pruned 1/51.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/51.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/51.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/51.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/51.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/51.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/99.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 7/376.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 7/376.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 7/376.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 7/376.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 7/376.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 7/376.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5566.0
Total filter_masks items: 12844125.0
After apply_mask:
Total filter_names items: 5566.0
Total filter_masks items: 12844125.0
Total pruned: 92/111.21412107419201 channels
===========done ===============

Training summary: Average loss: 1.3878, Accuracy: 30456/50000 (60.912%)


Evaluation: Average loss: 1.7521, Accuracy: 5268/10000 (52.680%)

Current learning rate: 0.1. Time taken for epoch: 90.96 seconds.

Train Epoch: 29 [0/50000 (0%)]	Loss: 1.396267 Accuracy: 61/100 (61.000%
Train Epoch: 29 [10000/50000 (20%)]	Loss: 1.185677 Accuracy: 6232/10100 (61.703%
Train Epoch: 29 [20000/50000 (40%)]	Loss: 1.457731 Accuracy: 12284/20100 (61.114%
Train Epoch: 29 [30000/50000 (60%)]	Loss: 1.481953 Accuracy: 18347/30100 (60.953%
Train Epoch: 29 [40000/50000 (80%)]	Loss: 1.211481 Accuracy: 24428/40100 (60.918%
current mest  death_rate 0.14371276870427754


dynamic sparse change prune
to kill 950477.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1402,1402 density 0.8113425925925926,0.8113425925925926
before tensor 4096 mask 1062.0 4096
layer1.0.conv1.weight, mask/weight parameters,1062,1062 density 0.331875,0.331875
before tensor 36864 mask 4761.0 36864
layer1.0.conv2.weight, mask/weight parameters,4761,4761 density 0.2116,0.2116
before tensor 16384 mask 3477.0 16384
layer1.0.conv3.weight, mask/weight parameters,3477,3477 density 0.271640625,0.271640625
layer1.0.shortcut.0.weight, mask/weight parameters,6774,6774 density 0.4134521484375,0.4134521484375
before tensor 16384 mask 2947.0 16384
layer1.1.conv1.weight, mask/weight parameters,2947,2947 density 0.230234375,0.230234375
before tensor 36864 mask 4856.0 36864
layer1.1.conv2.weight, mask/weight parameters,4856,4856 density 0.21582222222222222,0.21582222222222222
before tensor 16384 mask 2974.0 16384
layer1.1.conv3.weight, mask/weight parameters,2974,2974 density 0.23234375,0.23234375
before tensor 16384 mask 2207.0 16384
layer1.2.conv1.weight, mask/weight parameters,2207,2207 density 0.172421875,0.172421875
before tensor 36864 mask 3218.0 36864
layer1.2.conv2.weight, mask/weight parameters,3218,3218 density 0.14302222222222222,0.14302222222222222
before tensor 16384 mask 2408.0 16384
layer1.2.conv3.weight, mask/weight parameters,2408,2408 density 0.188125,0.188125
before tensor 32768 mask 4450.0 32768
layer2.0.conv1.weight, mask/weight parameters,4450,4450 density 0.17737563775510204,0.17737563775510204
before tensor 147456 mask 12226.0 147456
layer2.0.conv2.weight, mask/weight parameters,12226,12226 density 0.14144569392382803,0.14144569392382803
before tensor 65536 mask 7798.0 65536
layer2.0.conv3.weight, mask/weight parameters,7798,7798 density 0.15541294642857142,0.15541294642857142
layer2.0.shortcut.0.weight, mask/weight parameters,28242,28242 density 0.2154693603515625,0.2154693603515625
before tensor 65536 mask 7100.0 65536
layer2.1.conv1.weight, mask/weight parameters,7100,7100 density 0.14150191326530612,0.14150191326530612
before tensor 147456 mask 12345.0 147456
layer2.1.conv2.weight, mask/weight parameters,12345,12345 density 0.14282243509648757,0.14282243509648757
before tensor 65536 mask 8688.0 65536
layer2.1.conv3.weight, mask/weight parameters,8688,8688 density 0.17315051020408162,0.17315051020408162
before tensor 65536 mask 9204.0 65536
layer2.2.conv1.weight, mask/weight parameters,9204,9204 density 0.1834343112244898,0.1834343112244898
before tensor 147456 mask 19149.0 147456
layer2.2.conv2.weight, mask/weight parameters,19149,19149 density 0.22153963626266834,0.22153963626266834
before tensor 65536 mask 11282.0 65536
layer2.2.conv3.weight, mask/weight parameters,11282,11282 density 0.2248485331632653,0.2248485331632653
before tensor 65536 mask 6927.0 65536
layer2.3.conv1.weight, mask/weight parameters,6927,6927 density 0.13805404974489796,0.13805404974489796
before tensor 147456 mask 12311.0 147456
layer2.3.conv2.weight, mask/weight parameters,12311,12311 density 0.1424290804757277,0.1424290804757277
before tensor 65536 mask 7460.0 65536
layer2.3.conv3.weight, mask/weight parameters,7460,7460 density 0.1486766581632653,0.1486766581632653
before tensor 131072 mask 29633.0 131072
layer3.0.conv1.weight, mask/weight parameters,29633,29633 density 0.30622726521164023,0.30622726521164023
before tensor 589824 mask 90591.0 589824
layer3.0.conv2.weight, mask/weight parameters,90591,90591 density 0.2817856909567668,0.2817856909567668
before tensor 262144 mask 67387.0 262144
layer3.0.conv3.weight, mask/weight parameters,67387,67387 density 0.34818845072751325,0.34818845072751325
layer3.0.shortcut.0.weight, mask/weight parameters,89520,89520 density 0.170745849609375,0.170745849609375
before tensor 262144 mask 33597.0 262144
layer3.1.conv1.weight, mask/weight parameters,33597,33597 density 0.17359561011904762,0.17359561011904762
before tensor 589824 mask 81961.0 589824
layer3.1.conv2.weight, mask/weight parameters,81961,81961 density 0.25494184871022024,0.25494184871022024
before tensor 262144 mask 60225.0 262144
layer3.1.conv3.weight, mask/weight parameters,60225,60225 density 0.3111824156746032,0.3111824156746032
before tensor 262144 mask 43458.0 262144
layer3.2.conv1.weight, mask/weight parameters,43458,43458 density 0.22454737103174602,0.22454737103174602
before tensor 589824 mask 93640.0 589824
layer3.2.conv2.weight, mask/weight parameters,93640,93640 density 0.2912696857435247,0.2912696857435247
before tensor 262144 mask 62558.0 262144
layer3.2.conv3.weight, mask/weight parameters,62558,62558 density 0.3232370205026455,0.3232370205026455
before tensor 262144 mask 42742.0 262144
layer3.3.conv1.weight, mask/weight parameters,42742,42742 density 0.22084780092592593,0.22084780092592593
before tensor 589824 mask 73554.0 589824
layer3.3.conv2.weight, mask/weight parameters,73554,73554 density 0.22879165383574554,0.22879165383574554
before tensor 262144 mask 48469.0 262144
layer3.3.conv3.weight, mask/weight parameters,48469,48469 density 0.25043919477513227,0.25043919477513227
before tensor 262144 mask 40081.0 262144
layer3.4.conv1.weight, mask/weight parameters,40081,40081 density 0.20709842096560846,0.20709842096560846
before tensor 589824 mask 57921.0 589824
layer3.4.conv2.weight, mask/weight parameters,57921,57921 density 0.18016479568507787,0.18016479568507787
before tensor 262144 mask 38841.0 262144
layer3.4.conv3.weight, mask/weight parameters,38841,38841 density 0.20069134424603174,0.20069134424603174
before tensor 262144 mask 40170.0 262144
layer3.5.conv1.weight, mask/weight parameters,40170,40170 density 0.20755828373015872,0.20755828373015872
before tensor 589824 mask 54655.0 589824
layer3.5.conv2.weight, mask/weight parameters,54655,54655 density 0.17000581668424114,0.17000581668424114
before tensor 262144 mask 35931.0 262144
layer3.5.conv3.weight, mask/weight parameters,35931,35931 density 0.18565538194444445,0.18565538194444445
before tensor 524288 mask 126803.0 524288
layer4.0.conv1.weight, mask/weight parameters,126803,126803 density 0.3355855140582656,0.3355855140582656
before tensor 2359296 mask 224092.0 2359296
layer4.0.conv2.weight, mask/weight parameters,224092,224092 density 0.18286521919720852,0.18286521919720852
before tensor 1048576 mask 98713.0 1048576
layer4.0.conv3.weight, mask/weight parameters,98713,98713 density 0.1306225122798103,0.1306225122798103
layer4.0.shortcut.0.weight, mask/weight parameters,141111,141111 density 0.06728696823120117,0.06728696823120117
before tensor 1048576 mask 71824.0 1048576
layer4.1.conv1.weight, mask/weight parameters,71824,71824 density 0.0950414972899729,0.0950414972899729
before tensor 2359296 mask 152097.0 2359296
layer4.1.conv2.weight, mask/weight parameters,152097,152097 density 0.12411532426074035,0.12411532426074035
before tensor 1048576 mask 75347.0 1048576
layer4.1.conv3.weight, mask/weight parameters,75347,75347 density 0.09970332613482384,0.09970332613482384
before tensor 1048576 mask 35569.0 1048576
layer4.2.conv1.weight, mask/weight parameters,35569,35569 density 0.047066872035907856,0.047066872035907856
before tensor 2359296 mask 44802.0 2359296
layer4.2.conv2.weight, mask/weight parameters,44802,44802 density 0.03655966098956383,0.03655966098956383
before tensor 1048576 mask 30369.0 1048576
layer4.2.conv3.weight, mask/weight parameters,30369,30369 density 0.040185943851626015,0.040185943851626015
classifier.weight, mask/weight parameters,96277,96277 density 0.4701025390625,0.4701025390625
Total Model parameters after dst: 2365206 2365206
Total parameters under density level of 0.1: 0.14951159479957363 0.14951159479957363 after dst
Death rate: 0.14371276870427754

dynamic sparse change grow
self.total_params*pruning_rate 3399099.004202171
self.total_nonzero 2365206.0
to grow 1033893.0042021712
len(all_scores) 15819549 13151652
increse 1033894.0 before_mask 3399098.0 after_mask 3399098.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1542,1402 density 0.8923611111111112,0.8113425925925926
before tensor 4096 mask 1373.0 4096
layer1.0.conv1.weight, mask/weight parameters,1373,1062 density 0.4290625,0.331875
before tensor 36864 mask 5929.0 36864
layer1.0.conv2.weight, mask/weight parameters,5929,4761 density 0.2635111111111111,0.2116
before tensor 16384 mask 4571.0 16384
layer1.0.conv3.weight, mask/weight parameters,4571,3477 density 0.357109375,0.271640625
layer1.0.shortcut.0.weight, mask/weight parameters,8119,6774 density 0.49554443359375,0.4134521484375
before tensor 16384 mask 3514.0 16384
layer1.1.conv1.weight, mask/weight parameters,3514,2947 density 0.27453125,0.230234375
before tensor 36864 mask 6038.0 36864
layer1.1.conv2.weight, mask/weight parameters,6038,4856 density 0.26835555555555557,0.21582222222222222
before tensor 16384 mask 4123.0 16384
layer1.1.conv3.weight, mask/weight parameters,4123,2974 density 0.322109375,0.23234375
before tensor 16384 mask 3084.0 16384
layer1.2.conv1.weight, mask/weight parameters,3084,2207 density 0.2409375,0.172421875
before tensor 36864 mask 3977.0 36864
layer1.2.conv2.weight, mask/weight parameters,3977,3218 density 0.17675555555555555,0.14302222222222222
before tensor 16384 mask 3627.0 16384
layer1.2.conv3.weight, mask/weight parameters,3627,2408 density 0.283359375,0.188125
before tensor 32768 mask 5547.0 32768
layer2.0.conv1.weight, mask/weight parameters,5547,4450 density 0.2211017219387755,0.17737563775510204
before tensor 147456 mask 14455.0 147456
layer2.0.conv2.weight, mask/weight parameters,14455,12226 density 0.16723356009070295,0.14144569392382803
before tensor 65536 mask 10492.0 65536
layer2.0.conv3.weight, mask/weight parameters,10492,7798 density 0.20910395408163265,0.15541294642857142
layer2.0.shortcut.0.weight, mask/weight parameters,40350,28242 density 0.3078460693359375,0.2154693603515625
before tensor 65536 mask 10105.0 65536
layer2.1.conv1.weight, mask/weight parameters,10105,7100 density 0.20139110331632654,0.14150191326530612
before tensor 147456 mask 21293.0 147456
layer2.1.conv2.weight, mask/weight parameters,21293,12345 density 0.24634411587764357,0.14282243509648757
before tensor 65536 mask 12387.0 65536
layer2.1.conv3.weight, mask/weight parameters,12387,8688 density 0.24687101403061223,0.17315051020408162
before tensor 65536 mask 13998.0 65536
layer2.2.conv1.weight, mask/weight parameters,13998,9204 density 0.2789779974489796,0.1834343112244898
before tensor 147456 mask 27862.0 147456
layer2.2.conv2.weight, mask/weight parameters,27862,19149 density 0.32234254245916055,0.22153963626266834
before tensor 65536 mask 16256.0 65536
layer2.2.conv3.weight, mask/weight parameters,16256,11282 density 0.3239795918367347,0.2248485331632653
before tensor 65536 mask 10377.0 65536
layer2.3.conv1.weight, mask/weight parameters,10377,6927 density 0.20681202168367346,0.13805404974489796
before tensor 147456 mask 16008.0 147456
layer2.3.conv2.weight, mask/weight parameters,16008,12311 density 0.18520061085658754,0.1424290804757277
before tensor 65536 mask 10103.0 65536
layer2.3.conv3.weight, mask/weight parameters,10103,7460 density 0.20135124362244897,0.1486766581632653
before tensor 131072 mask 41581.0 131072
layer3.0.conv1.weight, mask/weight parameters,41581,29633 density 0.429697833994709,0.30622726521164023
before tensor 589824 mask 127133.0 589824
layer3.0.conv2.weight, mask/weight parameters,127133,90591 density 0.3954505441865818,0.2817856909567668
before tensor 262144 mask 87260.0 262144
layer3.0.conv3.weight, mask/weight parameters,87260,67387 density 0.45087218915343913,0.34818845072751325
layer3.0.shortcut.0.weight, mask/weight parameters,127482,89520 density 0.24315261840820312,0.170745849609375
before tensor 262144 mask 46787.0 262144
layer3.1.conv1.weight, mask/weight parameters,46787,33597 density 0.24174830522486773,0.17359561011904762
before tensor 589824 mask 123342.0 589824
layer3.1.conv2.weight, mask/weight parameters,123342,81961 density 0.38365853886136075,0.25494184871022024
before tensor 262144 mask 81994.0 262144
layer3.1.conv3.weight, mask/weight parameters,81994,60225 density 0.4236627810846561,0.3111824156746032
before tensor 262144 mask 63528.0 262144
layer3.2.conv1.weight, mask/weight parameters,63528,43458 density 0.32824900793650796,0.22454737103174602
before tensor 589824 mask 131190.0 589824
layer3.2.conv2.weight, mask/weight parameters,131190,93640 density 0.4080699495161576,0.2912696857435247
before tensor 262144 mask 82618.0 262144
layer3.2.conv3.weight, mask/weight parameters,82618,62558 density 0.42688698743386244,0.3232370205026455
before tensor 262144 mask 60555.0 262144
layer3.3.conv1.weight, mask/weight parameters,60555,42742 density 0.3128875248015873,0.22084780092592593
before tensor 589824 mask 105053.0 589824
layer3.3.conv2.weight, mask/weight parameters,105053,73554 density 0.3267701227724743,0.22879165383574554
before tensor 262144 mask 67243.0 262144
layer3.3.conv3.weight, mask/weight parameters,67243,48469 density 0.3474444031084656,0.25043919477513227
before tensor 262144 mask 57976.0 262144
layer3.4.conv1.weight, mask/weight parameters,57976,40081 density 0.2995618386243386,0.20709842096560846
before tensor 589824 mask 88738.0 589824
layer3.4.conv2.weight, mask/weight parameters,88738,57921 density 0.27602188566327307,0.18016479568507787
before tensor 262144 mask 54689.0 262144
layer3.4.conv3.weight, mask/weight parameters,54689,38841 density 0.2825779183201058,0.20069134424603174
before tensor 262144 mask 59409.0 262144
layer3.5.conv1.weight, mask/weight parameters,59409,40170 density 0.3069661458333333,0.20755828373015872
before tensor 589824 mask 80274.0 589824
layer3.5.conv2.weight, mask/weight parameters,80274,54655 density 0.2496943907878652,0.17000581668424114
before tensor 262144 mask 50146.0 262144
layer3.5.conv3.weight, mask/weight parameters,50146,35931 density 0.25910424933862436,0.18565538194444445
before tensor 524288 mask 167582.0 524288
layer4.0.conv1.weight, mask/weight parameters,167582,126803 density 0.44350757960704607,0.3355855140582656
before tensor 2359296 mask 329905.0 2359296
layer4.0.conv2.weight, mask/weight parameters,329905,224092 density 0.26921152981478624,0.18286521919720852
before tensor 1048576 mask 148764.0 1048576
layer4.0.conv3.weight, mask/weight parameters,148764,98713 density 0.19685276930894308,0.1306225122798103
layer4.0.shortcut.0.weight, mask/weight parameters,215636,141111 density 0.10282325744628906,0.06728696823120117
before tensor 1048576 mask 106422.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106422,71824 density 0.14082348831300814,0.0950414972899729
before tensor 2359296 mask 223482.0 2359296
layer4.1.conv2.weight, mask/weight parameters,223482,152097 density 0.18236744246394587,0.12411532426074035
before tensor 1048576 mask 114672.0 1048576
layer4.1.conv3.weight, mask/weight parameters,114672,75347 density 0.15174034552845528,0.09970332613482384
before tensor 1048576 mask 54978.0 1048576
layer4.2.conv1.weight, mask/weight parameters,54978,35569 density 0.07274993648373984,0.047066872035907856
before tensor 2359296 mask 86906.0 2359296
layer4.2.conv2.weight, mask/weight parameters,86906,44802 density 0.07091767996872983,0.03655966098956383
before tensor 1048576 mask 50687.0 1048576
layer4.2.conv3.weight, mask/weight parameters,50687,30369 density 0.06707184747628726,0.040185943851626015
classifier.weight, mask/weight parameters,107936,96277 density 0.52703125,0.4701025390625
Total Model parameters after dst: 3399098 2365206
Total parameters under density level of 0.1: 0.21486693457569492 0.14951159479957363 after dst
Death rate: 0.14371276870427754


Training summary: Average loss: 1.3710, Accuracy: 30461/50000 (60.922%)


Evaluation: Average loss: 1.6666, Accuracy: 5484/10000 (54.840%)

Current learning rate: 0.1. Time taken for epoch: 91.96 seconds.

Train Epoch: 30 [0/50000 (0%)]	Loss: 1.151031 Accuracy: 66/100 (66.000%
Train Epoch: 30 [10000/50000 (20%)]	Loss: 1.486267 Accuracy: 6263/10100 (62.010%
Train Epoch: 30 [20000/50000 (40%)]	Loss: 1.267221 Accuracy: 12356/20100 (61.473%
Train Epoch: 30 [30000/50000 (60%)]	Loss: 1.351810 Accuracy: 18434/30100 (61.243%
Train Epoch: 30 [40000/50000 (80%)]	Loss: 1.274713 Accuracy: 24476/40100 (61.037%
current layer rate 0.27917637687756036
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5566.0
Total filter_masks items: 12844125.0
5566.0 / 7552 channels
Total channels to prune: 122.33999817933545
Layer ('layer1', 0, 'conv1'): Pruned 1/50.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/50.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/50.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/50.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/50.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/50.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/98.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 8/369.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 8/369.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 8/369.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 8/369.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 8/369.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 8/369.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5448.0
Total filter_masks items: 12442780.0
After apply_mask:
Total filter_names items: 5448.0
Total filter_masks items: 12442780.0
Total pruned: 118/122.33999817933545 channels
===========done ===============

Training summary: Average loss: 1.3630, Accuracy: 30525/50000 (61.050%)


Evaluation: Average loss: 1.8223, Accuracy: 5060/10000 (50.600%)

Current learning rate: 0.1. Time taken for epoch: 94.16 seconds.

Train Epoch: 31 [0/50000 (0%)]	Loss: 1.170137 Accuracy: 69/100 (69.000%
Train Epoch: 31 [10000/50000 (20%)]	Loss: 1.484380 Accuracy: 6377/10100 (63.139%
Train Epoch: 31 [20000/50000 (40%)]	Loss: 1.334649 Accuracy: 12495/20100 (62.164%
Train Epoch: 31 [30000/50000 (60%)]	Loss: 1.442054 Accuracy: 18644/30100 (61.940%
Train Epoch: 31 [40000/50000 (80%)]	Loss: 1.454260 Accuracy: 24635/40100 (61.434%
current mest  death_rate 0.14288997401860276


dynamic sparse change prune
to kill 914031.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1408,1408 density 0.8148148148148148,0.8148148148148148
before tensor 4096 mask 1048.0 4096
layer1.0.conv1.weight, mask/weight parameters,1048,1048 density 0.33418367346938777,0.33418367346938777
before tensor 36864 mask 4423.0 36864
layer1.0.conv2.weight, mask/weight parameters,4423,4423 density 0.20468323383775278,0.20468323383775278
before tensor 16384 mask 3342.0 16384
layer1.0.conv3.weight, mask/weight parameters,3342,3342 density 0.266422193877551,0.266422193877551
layer1.0.shortcut.0.weight, mask/weight parameters,6743,6743 density 0.41156005859375,0.41156005859375
before tensor 16384 mask 2764.0 16384
layer1.1.conv1.weight, mask/weight parameters,2764,2764 density 0.22034438775510204,0.22034438775510204
before tensor 36864 mask 4441.0 36864
layer1.1.conv2.weight, mask/weight parameters,4441,4441 density 0.20551622009347956,0.20551622009347956
before tensor 16384 mask 2886.0 16384
layer1.1.conv3.weight, mask/weight parameters,2886,2886 density 0.2300701530612245,0.2300701530612245
before tensor 16384 mask 2242.0 16384
layer1.2.conv1.weight, mask/weight parameters,2242,2242 density 0.17873086734693877,0.17873086734693877
before tensor 36864 mask 2968.0 36864
layer1.2.conv2.weight, mask/weight parameters,2968,2968 density 0.1373501781665047,0.1373501781665047
before tensor 16384 mask 2400.0 16384
layer1.2.conv3.weight, mask/weight parameters,2400,2400 density 0.1913265306122449,0.1913265306122449
before tensor 32768 mask 4293.0 32768
layer2.0.conv1.weight, mask/weight parameters,4293,4293 density 0.1746826171875,0.1746826171875
before tensor 147456 mask 11856.0 147456
layer2.0.conv2.weight, mask/weight parameters,11856,11856 density 0.14293981481481483,0.14293981481481483
before tensor 65536 mask 7716.0 65536
layer2.0.conv3.weight, mask/weight parameters,7716,7716 density 0.156982421875,0.156982421875
layer2.0.shortcut.0.weight, mask/weight parameters,28831,28831 density 0.21996307373046875,0.21996307373046875
before tensor 65536 mask 7143.0 65536
layer2.1.conv1.weight, mask/weight parameters,7143,7143 density 0.14532470703125,0.14532470703125
before tensor 147456 mask 12665.0 147456
layer2.1.conv2.weight, mask/weight parameters,12665,12665 density 0.15269338348765432,0.15269338348765432
before tensor 65536 mask 8591.0 65536
layer2.1.conv3.weight, mask/weight parameters,8591,8591 density 0.17478434244791666,0.17478434244791666
before tensor 65536 mask 9820.0 65536
layer2.2.conv1.weight, mask/weight parameters,9820,9820 density 0.19978841145833334,0.19978841145833334
before tensor 147456 mask 19462.0 147456
layer2.2.conv2.weight, mask/weight parameters,19462,19462 density 0.23464023919753085,0.23464023919753085
before tensor 65536 mask 11532.0 65536
layer2.2.conv3.weight, mask/weight parameters,11532,11532 density 0.234619140625,0.234619140625
before tensor 65536 mask 7323.0 65536
layer2.3.conv1.weight, mask/weight parameters,7323,7323 density 0.14898681640625,0.14898681640625
before tensor 147456 mask 12645.0 147456
layer2.3.conv2.weight, mask/weight parameters,12645,12645 density 0.15245225694444445,0.15245225694444445
before tensor 65536 mask 7546.0 65536
layer2.3.conv3.weight, mask/weight parameters,7546,7546 density 0.15352376302083334,0.15352376302083334
before tensor 131072 mask 29912.0 131072
layer3.0.conv1.weight, mask/weight parameters,29912,29912 density 0.3157939189189189,0.3157939189189189
before tensor 589824 mask 89957.0 589824
layer3.0.conv2.weight, mask/weight parameters,89957,89957 density 0.29204447690934177,0.29204447690934177
before tensor 262144 mask 66470.0 262144
layer3.0.conv3.weight, mask/weight parameters,66470,66470 density 0.3508762668918919,0.3508762668918919
layer3.0.shortcut.0.weight, mask/weight parameters,90903,90903 density 0.1733837127685547,0.1733837127685547
before tensor 262144 mask 33503.0 262144
layer3.1.conv1.weight, mask/weight parameters,33503,33503 density 0.1768528293918919,0.1768528293918919
before tensor 589824 mask 84074.0 589824
layer3.1.conv2.weight, mask/weight parameters,84074,84074 density 0.2729453778102427,0.2729453778102427
before tensor 262144 mask 60649.0 262144
layer3.1.conv3.weight, mask/weight parameters,60649,60649 density 0.3201488597972973,0.3201488597972973
before tensor 262144 mask 45198.0 262144
layer3.2.conv1.weight, mask/weight parameters,45198,45198 density 0.23858741554054055,0.23858741554054055
before tensor 589824 mask 93780.0 589824
layer3.2.conv2.weight, mask/weight parameters,93780,93780 density 0.30445580715850984,0.30445580715850984
before tensor 262144 mask 61889.0 262144
layer3.2.conv3.weight, mask/weight parameters,61889,61889 density 0.3266944679054054,0.3266944679054054
before tensor 262144 mask 42543.0 262144
layer3.3.conv1.weight, mask/weight parameters,42543,42543 density 0.2245724239864865,0.2245724239864865
before tensor 589824 mask 73093.0 589824
layer3.3.conv2.weight, mask/weight parameters,73093,73093 density 0.23729567405243082,0.23729567405243082
before tensor 262144 mask 48657.0 262144
layer3.3.conv3.weight, mask/weight parameters,48657,48657 density 0.25684649493243245,0.25684649493243245
before tensor 262144 mask 40962.0 262144
layer3.4.conv1.weight, mask/weight parameters,40962,40962 density 0.21622677364864865,0.21622677364864865
before tensor 589824 mask 59730.0 589824
layer3.4.conv2.weight, mask/weight parameters,59730,59730 density 0.1939128317506696,0.1939128317506696
before tensor 262144 mask 38880.0 262144
layer3.4.conv3.weight, mask/weight parameters,38880,38880 density 0.20523648648648649,0.20523648648648649
before tensor 262144 mask 41082.0 262144
layer3.5.conv1.weight, mask/weight parameters,41082,41082 density 0.2168602195945946,0.2168602195945946
before tensor 589824 mask 53931.0 589824
layer3.5.conv2.weight, mask/weight parameters,53931,53931 density 0.1750864377891405,0.1750864377891405
before tensor 262144 mask 35418.0 262144
layer3.5.conv3.weight, mask/weight parameters,35418,35418 density 0.18696157094594595,0.18696157094594595
before tensor 524288 mask 127720.0 524288
layer4.0.conv1.weight, mask/weight parameters,127720,127720 density 0.3455029432132964,0.3455029432132964
before tensor 2359296 mask 222924.0 2359296
layer4.0.conv2.weight, mask/weight parameters,222924,222924 density 0.19006402140355994,0.19006402140355994
before tensor 1048576 mask 99040.0 1048576
layer4.0.conv3.weight, mask/weight parameters,99040,99040 density 0.13395948753462603,0.13395948753462603
layer4.0.shortcut.0.weight, mask/weight parameters,138513,138513 density 0.06604814529418945,0.06604814529418945
before tensor 1048576 mask 72898.0 1048576
layer4.1.conv1.weight, mask/weight parameters,72898,72898 density 0.09860035058864267,0.09860035058864267
before tensor 2359296 mask 150398.0 2359296
layer4.1.conv2.weight, mask/weight parameters,150398,150398 density 0.12822867296052737,0.12822867296052737
before tensor 1048576 mask 75386.0 1048576
layer4.1.conv3.weight, mask/weight parameters,75386,75386 density 0.10196556873268699,0.10196556873268699
before tensor 1048576 mask 34757.0 1048576
layer4.2.conv1.weight, mask/weight parameters,34757,34757 density 0.04701161054362881,0.04701161054362881
before tensor 2359296 mask 43743.0 2359296
layer4.2.conv2.weight, mask/weight parameters,43743,43743 density 0.03729508930512606,0.03729508930512606
before tensor 1048576 mask 29387.0 1048576
layer4.2.conv3.weight, mask/weight parameters,29387,29387 density 0.03974825787742382,0.03974825787742382
classifier.weight, mask/weight parameters,95720,95720 density 0.4673828125,0.4673828125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.15340340548094966 0.15340340548094966 after dst
Death rate: 0.14288997401860276

dynamic sparse change grow
self.total_params*pruning_rate 3379638.237967161
self.total_nonzero 2365205.0
to grow 1014433.237967161
len(all_scores) 15418204 12681007
increse 1014433.0 before_mask 3379637.0 after_mask 3379637.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1548,1408 density 0.8958333333333334,0.8148148148148148
before tensor 4096 mask 1214.0 4096
layer1.0.conv1.weight, mask/weight parameters,1214,1048 density 0.38711734693877553,0.33418367346938777
before tensor 36864 mask 5485.0 36864
layer1.0.conv2.weight, mask/weight parameters,5485,4423 density 0.2538294229256328,0.20468323383775278
before tensor 16384 mask 4125.0 16384
layer1.0.conv3.weight, mask/weight parameters,4125,3342 density 0.3288424744897959,0.266422193877551
layer1.0.shortcut.0.weight, mask/weight parameters,8330,6743 density 0.5084228515625,0.41156005859375
before tensor 16384 mask 3915.0 16384
layer1.1.conv1.weight, mask/weight parameters,3915,2764 density 0.31210140306122447,0.22034438775510204
before tensor 36864 mask 5825.0 36864
layer1.1.conv2.weight, mask/weight parameters,5825,4441 density 0.26956360775602756,0.20551622009347956
before tensor 16384 mask 4021.0 16384
layer1.1.conv3.weight, mask/weight parameters,4021,2886 density 0.3205516581632653,0.2300701530612245
before tensor 16384 mask 3282.0 16384
layer1.2.conv1.weight, mask/weight parameters,3282,2242 density 0.2616390306122449,0.17873086734693877
before tensor 36864 mask 3880.0 36864
layer1.2.conv2.weight, mask/weight parameters,3880,2968 density 0.17955481512332824,0.1373501781665047
before tensor 16384 mask 3136.0 16384
layer1.2.conv3.weight, mask/weight parameters,3136,2400 density 0.25,0.1913265306122449
before tensor 32768 mask 6084.0 32768
layer2.0.conv1.weight, mask/weight parameters,6084,4293 density 0.24755859375,0.1746826171875
before tensor 147456 mask 14663.0 147456
layer2.0.conv2.weight, mask/weight parameters,14663,11856 density 0.17678192515432098,0.14293981481481483
before tensor 65536 mask 10480.0 65536
layer2.0.conv3.weight, mask/weight parameters,10480,7716 density 0.21321614583333334,0.156982421875
layer2.0.shortcut.0.weight, mask/weight parameters,40185,28831 density 0.30658721923828125,0.21996307373046875
before tensor 65536 mask 9617.0 65536
layer2.1.conv1.weight, mask/weight parameters,9617,7143 density 0.19565836588541666,0.14532470703125
before tensor 147456 mask 19088.0 147456
layer2.1.conv2.weight, mask/weight parameters,19088,12665 density 0.23013117283950618,0.15269338348765432
before tensor 65536 mask 12288.0 65536
layer2.1.conv3.weight, mask/weight parameters,12288,8591 density 0.25,0.17478434244791666
before tensor 65536 mask 13212.0 65536
layer2.2.conv1.weight, mask/weight parameters,13212,9820 density 0.268798828125,0.19978841145833334
before tensor 147456 mask 25472.0 147456
layer2.2.conv2.weight, mask/weight parameters,25472,19462 density 0.30709876543209874,0.23464023919753085
before tensor 65536 mask 15495.0 65536
layer2.2.conv3.weight, mask/weight parameters,15495,11532 density 0.31524658203125,0.234619140625
before tensor 65536 mask 10783.0 65536
layer2.3.conv1.weight, mask/weight parameters,10783,7323 density 0.21938069661458334,0.14898681640625
before tensor 147456 mask 17473.0 147456
layer2.3.conv2.weight, mask/weight parameters,17473,12645 density 0.21066020447530864,0.15245225694444445
before tensor 65536 mask 10471.0 65536
layer2.3.conv3.weight, mask/weight parameters,10471,7546 density 0.21303304036458334,0.15352376302083334
before tensor 131072 mask 40847.0 131072
layer3.0.conv1.weight, mask/weight parameters,40847,29912 density 0.4312394425675676,0.3157939189189189
before tensor 589824 mask 122170.0 589824
layer3.0.conv2.weight, mask/weight parameters,122170,89957 density 0.3966236506777047,0.29204447690934177
before tensor 262144 mask 86140.0 262144
layer3.0.conv3.weight, mask/weight parameters,86140,66470 density 0.45470861486486486,0.3508762668918919
layer3.0.shortcut.0.weight, mask/weight parameters,124728,90903 density 0.2378997802734375,0.1733837127685547
before tensor 262144 mask 46140.0 262144
layer3.1.conv1.weight, mask/weight parameters,46140,33503 density 0.24355996621621623,0.1768528293918919
before tensor 589824 mask 117016.0 589824
layer3.1.conv2.weight, mask/weight parameters,117016,84074 density 0.3798912425939453,0.2729453778102427
before tensor 262144 mask 79618.0 262144
layer3.1.conv3.weight, mask/weight parameters,79618,60649 density 0.4202808277027027,0.3201488597972973
before tensor 262144 mask 63163.0 262144
layer3.2.conv1.weight, mask/weight parameters,63163,45198 density 0.33341955236486487,0.23858741554054055
before tensor 589824 mask 129972.0 589824
layer3.2.conv2.weight, mask/weight parameters,129972,93780 density 0.4219527635743852,0.30445580715850984
before tensor 262144 mask 83881.0 262144
layer3.2.conv3.weight, mask/weight parameters,83881,61889 density 0.4427839949324324,0.3266944679054054
before tensor 262144 mask 59832.0 262144
layer3.3.conv1.weight, mask/weight parameters,59832,42543 density 0.3158361486486487,0.2245724239864865
before tensor 589824 mask 102735.0 589824
layer3.3.conv2.weight, mask/weight parameters,102735,73093 density 0.3335281227173119,0.23729567405243082
before tensor 262144 mask 68551.0 262144
layer3.3.conv3.weight, mask/weight parameters,68551,48657 density 0.36186127533783785,0.25684649493243245
before tensor 262144 mask 55364.0 262144
layer3.4.conv1.weight, mask/weight parameters,55364,40962 density 0.2922508445945946,0.21622677364864865
before tensor 589824 mask 83773.0 589824
layer3.4.conv2.weight, mask/weight parameters,83773,59730 density 0.2719681844006168,0.1939128317506696
before tensor 262144 mask 54998.0 262144
layer3.4.conv3.weight, mask/weight parameters,54998,38880 density 0.29031883445945944,0.20523648648648649
before tensor 262144 mask 56566.0 262144
layer3.5.conv1.weight, mask/weight parameters,56566,41082 density 0.2985958614864865,0.2168602195945946
before tensor 589824 mask 75552.0 589824
layer3.5.conv2.weight, mask/weight parameters,75552,53931 density 0.24527879230581934,0.1750864377891405
before tensor 262144 mask 49569.0 262144
layer3.5.conv3.weight, mask/weight parameters,49569,35418 density 0.26166068412162163,0.18696157094594595
before tensor 524288 mask 172087.0 524288
layer4.0.conv1.weight, mask/weight parameters,172087,127720 density 0.46552274497922436,0.3455029432132964
before tensor 2359296 mask 332168.0 2359296
layer4.0.conv2.weight, mask/weight parameters,332168,222924 density 0.2832049750658417,0.19006402140355994
before tensor 1048576 mask 149805.0 1048576
layer4.0.conv3.weight, mask/weight parameters,149805,99040 density 0.2026231929536011,0.13395948753462603
layer4.0.shortcut.0.weight, mask/weight parameters,225342,138513 density 0.1074514389038086,0.06604814529418945
before tensor 1048576 mask 106912.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106912,72898 density 0.1446069944598338,0.09860035058864267
before tensor 2359296 mask 226911.0 2359296
layer4.1.conv2.weight, mask/weight parameters,226911,150398 density 0.19346332005841985,0.12822867296052737
before tensor 1048576 mask 113561.0 1048576
layer4.1.conv3.weight, mask/weight parameters,113561,75386 density 0.15360029648545706,0.10196556873268699
before tensor 1048576 mask 58883.0 1048576
layer4.2.conv1.weight, mask/weight parameters,58883,34757 density 0.07964394693559557,0.04701161054362881
before tensor 2359296 mask 86031.0 2359296
layer4.2.conv2.weight, mask/weight parameters,86031,43743 density 0.0733496520131061,0.03729508930512606
before tensor 1048576 mask 49041.0 1048576
layer4.2.conv3.weight, mask/weight parameters,49041,29387 density 0.06633185811980609,0.03974825787742382
classifier.weight, mask/weight parameters,108209,95720 density 0.5283642578125,0.4673828125
Total Model parameters after dst: 3379637 2365205
Total parameters under density level of 0.1: 0.2191978391257503 0.15340340548094966 after dst
Death rate: 0.14288997401860276


Training summary: Average loss: 1.3543, Accuracy: 30710/50000 (61.420%)


Evaluation: Average loss: 1.5552, Accuracy: 5743/10000 (57.430%)

Current learning rate: 0.1. Time taken for epoch: 97.41 seconds.

Train Epoch: 32 [0/50000 (0%)]	Loss: 1.267318 Accuracy: 71/100 (71.000%
Train Epoch: 32 [10000/50000 (20%)]	Loss: 1.458084 Accuracy: 6246/10100 (61.842%
Train Epoch: 32 [20000/50000 (40%)]	Loss: 1.120327 Accuracy: 12338/20100 (61.383%
Train Epoch: 32 [30000/50000 (60%)]	Loss: 1.526650 Accuracy: 18445/30100 (61.279%
Train Epoch: 32 [40000/50000 (80%)]	Loss: 1.661708 Accuracy: 24605/40100 (61.359%
current layer rate 0.2922910787437415
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5448.0
Total filter_masks items: 12442780.0
5448.0 / 7552 channels
Total channels to prune: 103.38222667273567
Layer ('layer2', 0, 'conv1'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/96.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/361.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/361.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/361.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/361.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/361.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/361.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5368.0
Total filter_masks items: 12153706.0
After apply_mask:
Total filter_names items: 5368.0
Total filter_masks items: 12153706.0
Total pruned: 80/103.38222667273567 channels
===========done ===============

Training summary: Average loss: 1.3633, Accuracy: 30689/50000 (61.378%)


Evaluation: Average loss: 1.6483, Accuracy: 5455/10000 (54.550%)

Current learning rate: 0.1. Time taken for epoch: 97.72 seconds.

Train Epoch: 33 [0/50000 (0%)]	Loss: 0.886118 Accuracy: 74/100 (74.000%
Train Epoch: 33 [10000/50000 (20%)]	Loss: 1.655850 Accuracy: 6375/10100 (63.119%
Train Epoch: 33 [20000/50000 (40%)]	Loss: 1.451235 Accuracy: 12564/20100 (62.507%
Train Epoch: 33 [30000/50000 (60%)]	Loss: 1.359139 Accuracy: 18646/30100 (61.947%
Train Epoch: 33 [40000/50000 (80%)]	Loss: 1.004355 Accuracy: 24785/40100 (61.808%
current mest  death_rate 0.14202539646966958


dynamic sparse change prune
to kill 923673.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1417,1417 density 0.8200231481481481,0.8200231481481481
before tensor 4096 mask 1017.0 4096
layer1.0.conv1.weight, mask/weight parameters,1017,1017 density 0.3242984693877551,0.3242984693877551
before tensor 36864 mask 4364.0 36864
layer1.0.conv2.weight, mask/weight parameters,4364,4364 density 0.20195288999953723,0.20195288999953723
before tensor 16384 mask 3162.0 16384
layer1.0.conv3.weight, mask/weight parameters,3162,3162 density 0.2520727040816326,0.2520727040816326
layer1.0.shortcut.0.weight, mask/weight parameters,6712,6712 density 0.40966796875,0.40966796875
before tensor 16384 mask 2997.0 16384
layer1.1.conv1.weight, mask/weight parameters,2997,2997 density 0.2389190051020408,0.2389190051020408
before tensor 36864 mask 4648.0 36864
layer1.1.conv2.weight, mask/weight parameters,4648,4648 density 0.21509556203433755,0.21509556203433755
before tensor 16384 mask 3023.0 16384
layer1.1.conv3.weight, mask/weight parameters,3023,3023 density 0.24099170918367346,0.24099170918367346
before tensor 16384 mask 2373.0 16384
layer1.2.conv1.weight, mask/weight parameters,2373,2373 density 0.18917410714285715,0.18917410714285715
before tensor 36864 mask 3076.0 36864
layer1.2.conv2.weight, mask/weight parameters,3076,3076 density 0.14234809570086537,0.14234809570086537
before tensor 16384 mask 2219.0 16384
layer1.2.conv3.weight, mask/weight parameters,2219,2219 density 0.17689732142857142,0.17689732142857142
before tensor 32768 mask 4307.0 32768
layer2.0.conv1.weight, mask/weight parameters,4307,4307 density 0.17709703947368421,0.17709703947368421
before tensor 147456 mask 11743.0 147456
layer2.0.conv2.weight, mask/weight parameters,11743,11743 density 0.14457371498922744,0.14457371498922744
before tensor 65536 mask 7827.0 65536
layer2.0.conv3.weight, mask/weight parameters,7827,7827 density 0.1609169407894737,0.1609169407894737
layer2.0.shortcut.0.weight, mask/weight parameters,28816,28816 density 0.2198486328125,0.2198486328125
before tensor 65536 mask 6957.0 65536
layer2.1.conv1.weight, mask/weight parameters,6957,6957 density 0.14303042763157894,0.14303042763157894
before tensor 147456 mask 12916.0 147456
layer2.1.conv2.weight, mask/weight parameters,12916,12916 density 0.159015081563558,0.159015081563558
before tensor 65536 mask 8631.0 65536
layer2.1.conv3.weight, mask/weight parameters,8631,8631 density 0.17744654605263158,0.17744654605263158
before tensor 65536 mask 9672.0 65536
layer2.2.conv1.weight, mask/weight parameters,9672,9672 density 0.19884868421052632,0.19884868421052632
before tensor 147456 mask 19006.0 147456
layer2.2.conv2.weight, mask/weight parameters,19006,19006 density 0.23399199753770392,0.23399199753770392
before tensor 65536 mask 11453.0 65536
layer2.2.conv3.weight, mask/weight parameters,11453,11453 density 0.23546463815789473,0.23546463815789473
before tensor 65536 mask 7475.0 65536
layer2.3.conv1.weight, mask/weight parameters,7475,7475 density 0.15368009868421054,0.15368009868421054
before tensor 147456 mask 13011.0 147456
layer2.3.conv2.weight, mask/weight parameters,13011,13011 density 0.16018467220683288,0.16018467220683288
before tensor 65536 mask 7851.0 65536
layer2.3.conv3.weight, mask/weight parameters,7851,7851 density 0.16141036184210528,0.16141036184210528
before tensor 131072 mask 29894.0 131072
layer3.0.conv1.weight, mask/weight parameters,29894,29894 density 0.32080614697802196,0.32080614697802196
before tensor 589824 mask 88830.0 589824
layer3.0.conv2.weight, mask/weight parameters,88830,88830 density 0.29797125950972103,0.29797125950972103
before tensor 262144 mask 66423.0 262144
layer3.0.conv3.weight, mask/weight parameters,66423,66423 density 0.35640775240384615,0.35640775240384615
layer3.0.shortcut.0.weight, mask/weight parameters,90011,90011 density 0.17168235778808594,0.17168235778808594
before tensor 262144 mask 33224.0 262144
layer3.1.conv1.weight, mask/weight parameters,33224,33224 density 0.1782709478021978,0.1782709478021978
before tensor 589824 mask 82451.0 589824
layer3.1.conv2.weight, mask/weight parameters,82451,82451 density 0.2765735485515705,0.2765735485515705
before tensor 262144 mask 59635.0 262144
layer3.1.conv3.weight, mask/weight parameters,59635,59635 density 0.31998519059065933,0.31998519059065933
before tensor 262144 mask 45149.0 262144
layer3.2.conv1.weight, mask/weight parameters,45149,45149 density 0.24225725446428573,0.24225725446428573
before tensor 589824 mask 94123.0 589824
layer3.2.conv2.weight, mask/weight parameters,94123,94123 density 0.31572609319862066,0.31572609319862066
before tensor 262144 mask 62707.0 262144
layer3.2.conv3.weight, mask/weight parameters,62707,62707 density 0.3364687070741758,0.3364687070741758
before tensor 262144 mask 42346.0 262144
layer3.3.conv1.weight, mask/weight parameters,42346,42346 density 0.2272171188186813,0.2272171188186813
before tensor 589824 mask 72993.0 589824
layer3.3.conv2.weight, mask/weight parameters,72993,72993 density 0.24484764319929156,0.24484764319929156
before tensor 262144 mask 49402.0 262144
layer3.3.conv3.weight, mask/weight parameters,49402,49402 density 0.26507769574175827,0.26507769574175827
before tensor 262144 mask 39461.0 262144
layer3.4.conv1.weight, mask/weight parameters,39461,39461 density 0.21173699347527472,0.21173699347527472
before tensor 589824 mask 57915.0 589824
layer3.4.conv2.weight, mask/weight parameters,57915,57915 density 0.19427001569858712,0.19427001569858712
before tensor 262144 mask 38876.0 262144
layer3.4.conv3.weight, mask/weight parameters,38876,38876 density 0.20859804258241757,0.20859804258241757
before tensor 262144 mask 40146.0 262144
layer3.5.conv1.weight, mask/weight parameters,40146,40146 density 0.21541251717032966,0.21541251717032966
before tensor 589824 mask 52814.0 589824
layer3.5.conv2.weight, mask/weight parameters,52814,52814 density 0.17715922660977607,0.17715922660977607
before tensor 262144 mask 35198.0 262144
layer3.5.conv3.weight, mask/weight parameters,35198,35198 density 0.18886289491758243,0.18886289491758243
before tensor 524288 mask 131295.0 524288
layer4.0.conv1.weight, mask/weight parameters,131295,131295 density 0.36117682658450706,0.36117682658450706
before tensor 2359296 mask 226570.0 2359296
layer4.0.conv2.weight, mask/weight parameters,226570,226570 density 0.1997575436972382,0.1997575436972382
before tensor 1048576 mask 99299.0 1048576
layer4.0.conv3.weight, mask/weight parameters,99299,99299 density 0.13657983054577466,0.13657983054577466
layer4.0.shortcut.0.weight, mask/weight parameters,140051,140051 density 0.06678152084350586,0.06678152084350586
before tensor 1048576 mask 73077.0 1048576
layer4.1.conv1.weight, mask/weight parameters,73077,73077 density 0.1005130391725352,0.1005130391725352
before tensor 2359296 mask 150116.0 2359296
layer4.1.conv2.weight, mask/weight parameters,150116,150116 density 0.13235116489232737,0.13235116489232737
before tensor 1048576 mask 74203.0 1048576
layer4.1.conv3.weight, mask/weight parameters,74203,74203 density 0.10206178477112676,0.10206178477112676
before tensor 1048576 mask 36227.0 1048576
layer4.2.conv1.weight, mask/weight parameters,36227,36227 density 0.04982806998239436,0.04982806998239436
before tensor 2359296 mask 43886.0 2359296
layer4.2.conv2.weight, mask/weight parameters,43886,43886 density 0.03869249928365183,0.03869249928365183
before tensor 1048576 mask 28505.0 1048576
layer4.2.conv3.weight, mask/weight parameters,28505,28505 density 0.039206921214788734,0.039206921214788734
classifier.weight, mask/weight parameters,95705,95705 density 0.4673095703125,0.4673095703125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.15633450171953048 0.15633450171953048 after dst
Death rate: 0.14202539646966958

dynamic sparse change grow
self.total_params*pruning_rate 3359189.2221133118
self.total_nonzero 2365205.0
to grow 993984.2221133118
len(all_scores) 15129130 12305263
increse 993984.0 before_mask 3359188.0 after_mask 3359188.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1533,1417 density 0.8871527777777778,0.8200231481481481
before tensor 4096 mask 1221.0 4096
layer1.0.conv1.weight, mask/weight parameters,1221,1017 density 0.3893494897959184,0.3242984693877551
before tensor 36864 mask 5212.0 36864
layer1.0.conv2.weight, mask/weight parameters,5212,4364 density 0.24119579804711,0.20195288999953723
before tensor 16384 mask 4063.0 16384
layer1.0.conv3.weight, mask/weight parameters,4063,3162 density 0.3238998724489796,0.2520727040816326
layer1.0.shortcut.0.weight, mask/weight parameters,8129,6712 density 0.49615478515625,0.40966796875
before tensor 16384 mask 3849.0 16384
layer1.1.conv1.weight, mask/weight parameters,3849,2997 density 0.30683992346938777,0.2389190051020408
before tensor 36864 mask 5652.0 36864
layer1.1.conv2.weight, mask/weight parameters,5652,4648 density 0.2615576842982091,0.21509556203433755
before tensor 16384 mask 3980.0 16384
layer1.1.conv3.weight, mask/weight parameters,3980,3023 density 0.31728316326530615,0.24099170918367346
before tensor 16384 mask 2982.0 16384
layer1.2.conv1.weight, mask/weight parameters,2982,2373 density 0.23772321428571427,0.18917410714285715
before tensor 36864 mask 3792.0 36864
layer1.2.conv2.weight, mask/weight parameters,3792,3076 density 0.17548243787310844,0.14234809570086537
before tensor 16384 mask 3009.0 16384
layer1.2.conv3.weight, mask/weight parameters,3009,2219 density 0.23987563775510204,0.17689732142857142
before tensor 32768 mask 5482.0 32768
layer2.0.conv1.weight, mask/weight parameters,5482,4307 density 0.2254111842105263,0.17709703947368421
before tensor 147456 mask 13801.0 147456
layer2.0.conv2.weight, mask/weight parameters,13801,11743 density 0.16991074176669743,0.14457371498922744
before tensor 65536 mask 10100.0 65536
layer2.0.conv3.weight, mask/weight parameters,10100,7827 density 0.20764802631578946,0.1609169407894737
layer2.0.shortcut.0.weight, mask/weight parameters,39729,28816 density 0.30310821533203125,0.2198486328125
before tensor 65536 mask 9548.0 65536
layer2.1.conv1.weight, mask/weight parameters,9548,6957 density 0.19629934210526315,0.14303042763157894
before tensor 147456 mask 17320.0 147456
layer2.1.conv2.weight, mask/weight parameters,17320,12916 density 0.21323484148968913,0.159015081563558
before tensor 65536 mask 11476.0 65536
layer2.1.conv3.weight, mask/weight parameters,11476,8631 density 0.2359375,0.17744654605263158
before tensor 65536 mask 13816.0 65536
layer2.2.conv1.weight, mask/weight parameters,13816,9672 density 0.28404605263157895,0.19884868421052632
before tensor 147456 mask 26497.0 147456
layer2.2.conv2.weight, mask/weight parameters,26497,19006 density 0.32621729763004004,0.23399199753770392
before tensor 65536 mask 15206.0 65536
layer2.2.conv3.weight, mask/weight parameters,15206,11453 density 0.3126233552631579,0.23546463815789473
before tensor 65536 mask 12518.0 65536
layer2.3.conv1.weight, mask/weight parameters,12518,7475 density 0.25736019736842103,0.15368009868421054
before tensor 147456 mask 18418.0 147456
layer2.3.conv2.weight, mask/weight parameters,18418,13011 density 0.22675284702985535,0.16018467220683288
before tensor 65536 mask 10570.0 65536
layer2.3.conv3.weight, mask/weight parameters,10570,7851 density 0.21731085526315788,0.16141036184210528
before tensor 131072 mask 41321.0 131072
layer3.0.conv1.weight, mask/weight parameters,41321,29894 density 0.4434344951923077,0.32080614697802196
before tensor 589824 mask 122131.0 589824
layer3.0.conv2.weight, mask/weight parameters,122131,88830 density 0.4096760992365388,0.29797125950972103
before tensor 262144 mask 86090.0 262144
layer3.0.conv3.weight, mask/weight parameters,86090,66423 density 0.46193552541208793,0.35640775240384615
layer3.0.shortcut.0.weight, mask/weight parameters,127792,90011 density 0.243743896484375,0.17168235778808594
before tensor 262144 mask 46395.0 262144
layer3.1.conv1.weight, mask/weight parameters,46395,33224 density 0.24894295157967034,0.1782709478021978
before tensor 589824 mask 118240.0 589824
layer3.1.conv2.weight, mask/weight parameters,118240,82451 density 0.39662413288786913,0.2765735485515705
before tensor 262144 mask 80741.0 262144
layer3.1.conv3.weight, mask/weight parameters,80741,59635 density 0.4332342462225275,0.31998519059065933
before tensor 262144 mask 61013.0 262144
layer3.2.conv1.weight, mask/weight parameters,61013,45149 density 0.32737916380494503,0.24225725446428573
before tensor 589824 mask 124843.0 589824
layer3.2.conv2.weight, mask/weight parameters,124843,94123 density 0.41877322921278964,0.31572609319862066
before tensor 262144 mask 80782.0 262144
layer3.2.conv3.weight, mask/weight parameters,80782,62707 density 0.43345424107142855,0.3364687070741758
before tensor 262144 mask 58587.0 262144
layer3.3.conv1.weight, mask/weight parameters,58587,42346 density 0.31436190762362637,0.2272171188186813
before tensor 589824 mask 101873.0 589824
layer3.3.conv2.weight, mask/weight parameters,101873,72993 density 0.34172268512927856,0.24484764319929156
before tensor 262144 mask 65935.0 262144
layer3.3.conv3.weight, mask/weight parameters,65935,49402 density 0.3537892771291209,0.26507769574175827
before tensor 262144 mask 56959.0 262144
layer3.4.conv1.weight, mask/weight parameters,56959,39461 density 0.30562650240384615,0.21173699347527472
before tensor 589824 mask 85033.0 589824
layer3.4.conv2.weight, mask/weight parameters,85033,57915 density 0.28523460666317807,0.19427001569858712
before tensor 262144 mask 54570.0 262144
layer3.4.conv3.weight, mask/weight parameters,54570,38876 density 0.29280777815934067,0.20859804258241757
before tensor 262144 mask 55318.0 262144
layer3.5.conv1.weight, mask/weight parameters,55318,40146 density 0.2968213427197802,0.21541251717032966
before tensor 589824 mask 72715.0 589824
layer3.5.conv2.weight, mask/weight parameters,72715,52814 density 0.24391512028874665,0.17715922660977607
before tensor 262144 mask 47361.0 262144
layer3.5.conv3.weight, mask/weight parameters,47361,35198 density 0.2541262448489011,0.18886289491758243
before tensor 524288 mask 172481.0 524288
layer4.0.conv1.weight, mask/weight parameters,172481,131295 density 0.4744745818661972,0.36117682658450706
before tensor 2359296 mask 334704.0 2359296
layer4.0.conv2.weight, mask/weight parameters,334704,226570 density 0.29509488858030813,0.1997575436972382
before tensor 1048576 mask 151520.0 1048576
layer4.0.conv3.weight, mask/weight parameters,151520,99299 density 0.20840669014084506,0.13657983054577466
layer4.0.shortcut.0.weight, mask/weight parameters,221635,140051 density 0.10568380355834961,0.06678152084350586
before tensor 1048576 mask 107511.0 1048576
layer4.1.conv1.weight, mask/weight parameters,107511,73077 density 0.14787494498239437,0.1005130391725352
before tensor 2359296 mask 224171.0 2359296
layer4.1.conv2.weight, mask/weight parameters,224171,150116 density 0.19764244307787254,0.13235116489232737
before tensor 1048576 mask 109810.0 1048576
layer4.1.conv3.weight, mask/weight parameters,109810,74203 density 0.1510370818661972,0.10206178477112676
before tensor 1048576 mask 61100.0 1048576
layer4.2.conv1.weight, mask/weight parameters,61100,36227 density 0.0840393926056338,0.04982806998239436
before tensor 2359296 mask 83856.0 2359296
layer4.2.conv2.weight, mask/weight parameters,83856,43886 density 0.07393242081597566,0.03869249928365183
before tensor 1048576 mask 48766.0 1048576
layer4.2.conv3.weight, mask/weight parameters,48766,28505 density 0.0670747139084507,0.039206921214788734
classifier.weight, mask/weight parameters,108032,95705 density 0.5275,0.4673095703125
Total Model parameters after dst: 3359188 2365205
Total parameters under density level of 0.1: 0.22203444613140347 0.15633450171953048 after dst
Death rate: 0.14202539646966958


Training summary: Average loss: 1.3495, Accuracy: 30729/50000 (61.458%)


Evaluation: Average loss: 1.6490, Accuracy: 5505/10000 (55.050%)

Current learning rate: 0.1. Time taken for epoch: 98.26 seconds.

Train Epoch: 34 [0/50000 (0%)]	Loss: 1.376695 Accuracy: 59/100 (59.000%
Train Epoch: 34 [10000/50000 (20%)]	Loss: 1.396014 Accuracy: 6354/10100 (62.911%
Train Epoch: 34 [20000/50000 (40%)]	Loss: 1.118839 Accuracy: 12619/20100 (62.781%
Train Epoch: 34 [30000/50000 (60%)]	Loss: 1.280472 Accuracy: 18707/30100 (62.150%
Train Epoch: 34 [40000/50000 (80%)]	Loss: 1.301820 Accuracy: 24857/40100 (61.988%
current layer rate 0.30487596722803817
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5368.0
Total filter_masks items: 12153706.0
5368.0 / 7552 channels
Total channels to prune: 118.42330450614372
Layer ('layer1', 0, 'conv1'): Pruned 1/49.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/49.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/49.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/49.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/49.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/49.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/95.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 7/355.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 7/355.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 7/355.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 7/355.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 7/355.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 7/355.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5256.0
Total filter_masks items: 11791948.0
After apply_mask:
Total filter_names items: 5256.0
Total filter_masks items: 11791948.0
Total pruned: 112/118.42330450614372 channels
===========done ===============

Training summary: Average loss: 1.3366, Accuracy: 30869/50000 (61.738%)


Evaluation: Average loss: 1.9166, Accuracy: 4823/10000 (48.230%)

Current learning rate: 0.1. Time taken for epoch: 95.67 seconds.

Train Epoch: 35 [0/50000 (0%)]	Loss: 1.317717 Accuracy: 65/100 (65.000%
Train Epoch: 35 [10000/50000 (20%)]	Loss: 1.346339 Accuracy: 6357/10100 (62.941%
Train Epoch: 35 [20000/50000 (40%)]	Loss: 1.370921 Accuracy: 12583/20100 (62.602%
Train Epoch: 35 [30000/50000 (60%)]	Loss: 1.262807 Accuracy: 18711/30100 (62.163%
Train Epoch: 35 [40000/50000 (80%)]	Loss: 1.251563 Accuracy: 24826/40100 (61.910%
current mest  death_rate 0.1411210553184042


dynamic sparse change prune
to kill 886638.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1392,1392 density 0.8055555555555556,0.8055555555555556
before tensor 4096 mask 956.0 4096
layer1.0.conv1.weight, mask/weight parameters,956,956 density 0.3111979166666667,0.3111979166666667
before tensor 36864 mask 3838.0 36864
layer1.0.conv2.weight, mask/weight parameters,3838,3838 density 0.18508873456790123,0.18508873456790123
before tensor 16384 mask 3102.0 16384
layer1.0.conv3.weight, mask/weight parameters,3102,3102 density 0.25244140625,0.25244140625
layer1.0.shortcut.0.weight, mask/weight parameters,6614,6614 density 0.4036865234375,0.4036865234375
before tensor 16384 mask 2918.0 16384
layer1.1.conv1.weight, mask/weight parameters,2918,2918 density 0.23746744791666666,0.23746744791666666
before tensor 36864 mask 4451.0 36864
layer1.1.conv2.weight, mask/weight parameters,4451,4451 density 0.2146508487654321,0.2146508487654321
before tensor 16384 mask 2901.0 16384
layer1.1.conv3.weight, mask/weight parameters,2901,2901 density 0.236083984375,0.236083984375
before tensor 16384 mask 2167.0 16384
layer1.2.conv1.weight, mask/weight parameters,2167,2167 density 0.17635091145833334,0.17635091145833334
before tensor 36864 mask 2894.0 36864
layer1.2.conv2.weight, mask/weight parameters,2894,2894 density 0.13956404320987653,0.13956404320987653
before tensor 16384 mask 2122.0 16384
layer1.2.conv3.weight, mask/weight parameters,2122,2122 density 0.17268880208333334,0.17268880208333334
before tensor 32768 mask 3913.0 32768
layer2.0.conv1.weight, mask/weight parameters,3913,3913 density 0.1643565188172043,0.1643565188172043
before tensor 147456 mask 10770.0 147456
layer2.0.conv2.weight, mask/weight parameters,10770,10770 density 0.13835896250048174,0.13835896250048174
before tensor 65536 mask 7647.0 65536
layer2.0.conv3.weight, mask/weight parameters,7647,7647 density 0.16059727822580644,0.16059727822580644
layer2.0.shortcut.0.weight, mask/weight parameters,28798,28798 density 0.2197113037109375,0.2197113037109375
before tensor 65536 mask 6944.0 65536
layer2.1.conv1.weight, mask/weight parameters,6944,6944 density 0.14583333333333334,0.14583333333333334
before tensor 147456 mask 11848.0 147456
layer2.1.conv2.weight, mask/weight parameters,11848,11848 density 0.15220770545085494,0.15220770545085494
before tensor 65536 mask 8133.0 65536
layer2.1.conv3.weight, mask/weight parameters,8133,8133 density 0.1708039314516129,0.1708039314516129
before tensor 65536 mask 9895.0 65536
layer2.2.conv1.weight, mask/weight parameters,9895,9895 density 0.20780829973118278,0.20780829973118278
before tensor 147456 mask 19323.0 147456
layer2.2.conv2.weight, mask/weight parameters,19323,19323 density 0.2482367903803908,0.2482367903803908
before tensor 65536 mask 11432.0 65536
layer2.2.conv3.weight, mask/weight parameters,11432,11432 density 0.24008736559139784,0.24008736559139784
before tensor 65536 mask 8242.0 65536
layer2.3.conv1.weight, mask/weight parameters,8242,8242 density 0.17309307795698925,0.17309307795698925
before tensor 147456 mask 13849.0 147456
layer2.3.conv2.weight, mask/weight parameters,13849,13849 density 0.17791395280122302,0.17791395280122302
before tensor 65536 mask 7933.0 65536
layer2.3.conv3.weight, mask/weight parameters,7933,7933 density 0.1666036626344086,0.1666036626344086
before tensor 131072 mask 30312.0 131072
layer3.0.conv1.weight, mask/weight parameters,30312,30312 density 0.33260182584269665,0.33260182584269665
before tensor 589824 mask 88470.0 589824
layer3.0.conv2.weight, mask/weight parameters,88470,88470 density 0.31025123090518875,0.31025123090518875
before tensor 262144 mask 65855.0 262144
layer3.0.conv3.weight, mask/weight parameters,65855,65855 density 0.3613006934691011,0.3613006934691011
layer3.0.shortcut.0.weight, mask/weight parameters,92421,92421 density 0.17627906799316406,0.17627906799316406
before tensor 262144 mask 33396.0 262144
layer3.1.conv1.weight, mask/weight parameters,33396,33396 density 0.18322068117977527,0.18322068117977527
before tensor 589824 mask 82216.0 589824
layer3.1.conv2.weight, mask/weight parameters,82216,82216 density 0.28831937606082286,0.28831937606082286
before tensor 262144 mask 59909.0 262144
layer3.1.conv3.weight, mask/weight parameters,59909,59909 density 0.3286791169241573,0.3286791169241573
before tensor 262144 mask 44337.0 262144
layer3.2.conv1.weight, mask/weight parameters,44337,44337 density 0.24324635709269662,0.24324635709269662
before tensor 589824 mask 91317.0 589824
layer3.2.conv2.weight, mask/weight parameters,91317,91317 density 0.3202352396582923,0.3202352396582923
before tensor 262144 mask 60991.0 262144
layer3.2.conv3.weight, mask/weight parameters,60991,60991 density 0.33461530021067415,0.33461530021067415
before tensor 262144 mask 42085.0 262144
layer3.3.conv1.weight, mask/weight parameters,42085,42085 density 0.2308911955758427,0.2308911955758427
before tensor 589824 mask 71990.0 589824
layer3.3.conv2.weight, mask/weight parameters,71990,71990 density 0.252458303525088,0.252458303525088
before tensor 262144 mask 48325.0 262144
layer3.3.conv3.weight, mask/weight parameters,48325,48325 density 0.26512574613764045,0.26512574613764045
before tensor 262144 mask 40296.0 262144
layer3.4.conv1.weight, mask/weight parameters,40296,40296 density 0.22107619382022473,0.22107619382022473
before tensor 589824 mask 57472.0 589824
layer3.4.conv2.weight, mask/weight parameters,57472,57472 density 0.20154582053332212,0.20154582053332212
before tensor 262144 mask 38635.0 262144
layer3.4.conv3.weight, mask/weight parameters,38635,38635 density 0.21196343925561797,0.21196343925561797
before tensor 262144 mask 39745.0 262144
layer3.5.conv1.weight, mask/weight parameters,39745,39745 density 0.21805323911516855,0.21805323911516855
before tensor 589824 mask 51458.0 589824
layer3.5.conv2.weight, mask/weight parameters,51458,51458 density 0.18045561026245283,0.18045561026245283
before tensor 262144 mask 34025.0 262144
layer3.5.conv3.weight, mask/weight parameters,34025,34025 density 0.18667156776685392,0.18667156776685392
before tensor 524288 mask 132724.0 524288
layer4.0.conv1.weight, mask/weight parameters,132724,132724 density 0.37245195761494254,0.37245195761494254
before tensor 2359296 mask 230039.0 2359296
layer4.0.conv2.weight, mask/weight parameters,230039,230039 density 0.2110573464863992,0.2110573464863992
before tensor 1048576 mask 100534.0 1048576
layer4.0.conv3.weight, mask/weight parameters,100534,100534 density 0.14105996318247127,0.14105996318247127
layer4.0.shortcut.0.weight, mask/weight parameters,140859,140859 density 0.06716680526733398,0.06716680526733398
before tensor 1048576 mask 74358.0 1048576
layer4.1.conv1.weight, mask/weight parameters,74358,74358 density 0.1043322332974138,0.1043322332974138
before tensor 2359296 mask 151233.0 2359296
layer4.1.conv2.weight, mask/weight parameters,151233,151233 density 0.13875401858457745,0.13875401858457745
before tensor 1048576 mask 72625.0 1048576
layer4.1.conv3.weight, mask/weight parameters,72625,72625 density 0.1019006487966954,0.1019006487966954
before tensor 1048576 mask 37256.0 1048576
layer4.2.conv1.weight, mask/weight parameters,37256,37256 density 0.0522741558908046,0.0522741558908046
before tensor 2359296 mask 45012.0 2359296
layer4.2.conv2.weight, mask/weight parameters,45012,45012 density 0.041297837671202715,0.041297837671202715
before tensor 1048576 mask 29424.0 1048576
layer4.2.conv3.weight, mask/weight parameters,29424,29424 density 0.04128502155172414,0.04128502155172414
classifier.weight, mask/weight parameters,95804,95804 density 0.46779296875,0.46779296875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.16016424587936162 0.16016424587936162 after dst
Death rate: 0.1411210553184042

dynamic sparse change grow
self.total_params*pruning_rate 3337799.716264666
self.total_nonzero 2365205.0
to grow 972594.716264666
len(all_scores) 14767372 11883232
increse 972594.0 before_mask 3337797.0 after_mask 3337797.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1519,1392 density 0.8790509259259259,0.8055555555555556
before tensor 4096 mask 1156.0 4096
layer1.0.conv1.weight, mask/weight parameters,1156,956 density 0.3763020833333333,0.3111979166666667
before tensor 36864 mask 4974.0 36864
layer1.0.conv2.weight, mask/weight parameters,4974,3838 density 0.23987268518518517,0.18508873456790123
before tensor 16384 mask 3820.0 16384
layer1.0.conv3.weight, mask/weight parameters,3820,3102 density 0.3108723958333333,0.25244140625
layer1.0.shortcut.0.weight, mask/weight parameters,7808,6614 density 0.4765625,0.4036865234375
before tensor 16384 mask 3491.0 16384
layer1.1.conv1.weight, mask/weight parameters,3491,2918 density 0.2840983072916667,0.23746744791666666
before tensor 36864 mask 5764.0 36864
layer1.1.conv2.weight, mask/weight parameters,5764,4451 density 0.2779706790123457,0.2146508487654321
before tensor 16384 mask 3884.0 16384
layer1.1.conv3.weight, mask/weight parameters,3884,2901 density 0.3160807291666667,0.236083984375
before tensor 16384 mask 2935.0 16384
layer1.2.conv1.weight, mask/weight parameters,2935,2167 density 0.23885091145833334,0.17635091145833334
before tensor 36864 mask 3849.0 36864
layer1.2.conv2.weight, mask/weight parameters,3849,2894 density 0.18561921296296297,0.13956404320987653
before tensor 16384 mask 2914.0 16384
layer1.2.conv3.weight, mask/weight parameters,2914,2122 density 0.23714192708333334,0.17268880208333334
before tensor 32768 mask 5256.0 32768
layer2.0.conv1.weight, mask/weight parameters,5256,3913 density 0.22076612903225806,0.1643565188172043
before tensor 147456 mask 13050.0 147456
layer2.0.conv2.weight, mask/weight parameters,13050,10770 density 0.1676494392415308,0.13835896250048174
before tensor 65536 mask 10044.0 65536
layer2.0.conv3.weight, mask/weight parameters,10044,7647 density 0.2109375,0.16059727822580644
layer2.0.shortcut.0.weight, mask/weight parameters,39040,28798 density 0.2978515625,0.2197113037109375
before tensor 65536 mask 9540.0 65536
layer2.1.conv1.weight, mask/weight parameters,9540,6944 density 0.20035282258064516,0.14583333333333334
before tensor 147456 mask 18541.0 147456
layer2.1.conv2.weight, mask/weight parameters,18541,11848 density 0.23819067072622396,0.15220770545085494
before tensor 65536 mask 10928.0 65536
layer2.1.conv3.weight, mask/weight parameters,10928,8133 density 0.229502688172043,0.1708039314516129
before tensor 65536 mask 12749.0 65536
layer2.2.conv1.weight, mask/weight parameters,12749,9895 density 0.2677461357526882,0.20780829973118278
before tensor 147456 mask 25951.0 147456
layer2.2.conv2.weight, mask/weight parameters,25951,19323 density 0.33338472013463344,0.2482367903803908
before tensor 65536 mask 15695.0 65536
layer2.2.conv3.weight, mask/weight parameters,15695,11432 density 0.3296160954301075,0.24008736559139784
before tensor 65536 mask 10627.0 65536
layer2.3.conv1.weight, mask/weight parameters,10627,8242 density 0.22318128360215053,0.17309307795698925
before tensor 147456 mask 17453.0 147456
layer2.3.conv2.weight, mask/weight parameters,17453,13849 density 0.22421346077260057,0.17791395280122302
before tensor 65536 mask 10407.0 65536
layer2.3.conv3.weight, mask/weight parameters,10407,7933 density 0.2185609879032258,0.1666036626344086
before tensor 131072 mask 40418.0 131072
layer3.0.conv1.weight, mask/weight parameters,40418,30312 density 0.4434910463483146,0.33260182584269665
before tensor 589824 mask 122193.0 589824
layer3.0.conv2.weight, mask/weight parameters,122193,88470 density 0.4285128140386315,0.31025123090518875
before tensor 262144 mask 84958.0 262144
layer3.0.conv3.weight, mask/weight parameters,84958,65855 density 0.4661056004213483,0.3613006934691011
layer3.0.shortcut.0.weight, mask/weight parameters,128237,92421 density 0.24459266662597656,0.17627906799316406
before tensor 262144 mask 47702.0 262144
layer3.1.conv1.weight, mask/weight parameters,47702,33396 density 0.26170777738764045,0.18322068117977527
before tensor 589824 mask 114959.0 589824
layer3.1.conv2.weight, mask/weight parameters,114959,82216 density 0.40314424385248776,0.28831937606082286
before tensor 262144 mask 77918.0 262144
layer3.1.conv3.weight, mask/weight parameters,77918,59909 density 0.42748200491573035,0.3286791169241573
before tensor 262144 mask 60061.0 262144
layer3.2.conv1.weight, mask/weight parameters,60061,44337 density 0.32951303546348315,0.24324635709269662
before tensor 589824 mask 125267.0 589824
layer3.2.conv2.weight, mask/weight parameters,125267,91317 density 0.43929287828416724,0.3202352396582923
before tensor 262144 mask 81007.0 262144
layer3.2.conv3.weight, mask/weight parameters,81007,60991 density 0.4444292047050562,0.33461530021067415
before tensor 262144 mask 61970.0 262144
layer3.3.conv1.weight, mask/weight parameters,61970,42085 density 0.33998639396067415,0.2308911955758427
before tensor 589824 mask 101175.0 589824
layer3.3.conv2.weight, mask/weight parameters,101175,71990 density 0.35480579051466565,0.252458303525088
before tensor 262144 mask 67286.0 262144
layer3.3.conv3.weight, mask/weight parameters,67286,48325 density 0.36915159761235955,0.26512574613764045
before tensor 262144 mask 60215.0 262144
layer3.4.conv1.weight, mask/weight parameters,60215,40296 density 0.33035792661516855,0.22107619382022473
before tensor 589824 mask 82683.0 589824
layer3.4.conv2.weight, mask/weight parameters,82683,57472 density 0.2899570761267517,0.20154582053332212
before tensor 262144 mask 53259.0 262144
layer3.4.conv3.weight, mask/weight parameters,53259,38635 density 0.2921951808286517,0.21196343925561797
before tensor 262144 mask 55672.0 262144
layer3.5.conv1.weight, mask/weight parameters,55672,39745 density 0.30543363764044945,0.21805323911516855
before tensor 589824 mask 73325.0 589824
layer3.5.conv2.weight, mask/weight parameters,73325,51458 density 0.25713995146516294,0.18045561026245283
before tensor 262144 mask 47867.0 262144
layer3.5.conv3.weight, mask/weight parameters,47867,34025 density 0.26261301790730335,0.18667156776685392
before tensor 524288 mask 173429.0 524288
layer4.0.conv1.weight, mask/weight parameters,173429,132724 density 0.48667890176005746,0.37245195761494254
before tensor 2359296 mask 341114.0 2359296
layer4.0.conv2.weight, mask/weight parameters,341114,230039 density 0.3129669998972417,0.2110573464863992
before tensor 1048576 mask 148648.0 1048576
layer4.0.conv3.weight, mask/weight parameters,148648,100534 density 0.20856905531609196,0.14105996318247127
layer4.0.shortcut.0.weight, mask/weight parameters,219340,140859 density 0.10458946228027344,0.06716680526733398
before tensor 1048576 mask 106631.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106631,74358 density 0.14961470680675287,0.1043322332974138
before tensor 2359296 mask 217516.0 2359296
layer4.1.conv2.weight, mask/weight parameters,217516,151233 density 0.1995676810381527,0.13875401858457745
before tensor 1048576 mask 105920.0 1048576
layer4.1.conv3.weight, mask/weight parameters,105920,72625 density 0.14861709770114942,0.1019006487966954
before tensor 1048576 mask 58932.0 1048576
layer4.2.conv1.weight, mask/weight parameters,58932,37256 density 0.08268790409482758,0.0522741558908046
before tensor 2359296 mask 83110.0 2359296
layer4.2.conv2.weight, mask/weight parameters,83110,45012 density 0.07625218361445076,0.041297837671202715
before tensor 1048576 mask 47129.0 1048576
layer4.2.conv3.weight, mask/weight parameters,47129,29424 density 0.06612703169899425,0.04128502155172414
classifier.weight, mask/weight parameters,108461,95804 density 0.5295947265625,0.46779296875
Total Model parameters after dst: 3337797 2365205
Total parameters under density level of 0.1: 0.22602511807788142 0.16016424587936162 after dst
Death rate: 0.1411210553184042


Training summary: Average loss: 1.3396, Accuracy: 30825/50000 (61.650%)


Evaluation: Average loss: 1.7377, Accuracy: 5449/10000 (54.490%)

Current learning rate: 0.1. Time taken for epoch: 97.41 seconds.

Train Epoch: 36 [0/50000 (0%)]	Loss: 1.424325 Accuracy: 57/100 (57.000%
Train Epoch: 36 [10000/50000 (20%)]	Loss: 1.712850 Accuracy: 6395/10100 (63.317%
Train Epoch: 36 [20000/50000 (40%)]	Loss: 1.307428 Accuracy: 12578/20100 (62.577%
Train Epoch: 36 [30000/50000 (60%)]	Loss: 1.292160 Accuracy: 18676/30100 (62.047%
Train Epoch: 36 [40000/50000 (80%)]	Loss: 1.660979 Accuracy: 24896/40100 (62.085%
current layer rate 0.316941966317706
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5256.0
Total filter_masks items: 11791948.0
5256.0 / 7552 channels
Total channels to prune: 97.54572963131523
Layer ('layer2', 0, 'conv1'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/93.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/348.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/348.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/348.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/348.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/348.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/348.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5176.0
Total filter_masks items: 11509570.0
After apply_mask:
Total filter_names items: 5176.0
Total filter_masks items: 11509570.0
Total pruned: 80/97.54572963131523 channels
===========done ===============

Training summary: Average loss: 1.3326, Accuracy: 30958/50000 (61.916%)


Evaluation: Average loss: 1.6676, Accuracy: 5444/10000 (54.440%)

Current learning rate: 0.1. Time taken for epoch: 96.85 seconds.

Train Epoch: 37 [0/50000 (0%)]	Loss: 1.357374 Accuracy: 59/100 (59.000%
Train Epoch: 37 [10000/50000 (20%)]	Loss: 1.349504 Accuracy: 6380/10100 (63.168%
Train Epoch: 37 [20000/50000 (40%)]	Loss: 1.278604 Accuracy: 12523/20100 (62.303%
Train Epoch: 37 [30000/50000 (60%)]	Loss: 1.538666 Accuracy: 18698/30100 (62.120%
Train Epoch: 37 [40000/50000 (80%)]	Loss: 1.126076 Accuracy: 24839/40100 (61.943%
current mest  death_rate 0.14017906269546812


dynamic sparse change prune
to kill 884657.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1385,1385 density 0.8015046296296297,0.8015046296296297
before tensor 4096 mask 935.0 4096
layer1.0.conv1.weight, mask/weight parameters,935,935 density 0.3043619791666667,0.3043619791666667
before tensor 36864 mask 3938.0 36864
layer1.0.conv2.weight, mask/weight parameters,3938,3938 density 0.18991126543209877,0.18991126543209877
before tensor 16384 mask 2929.0 16384
layer1.0.conv3.weight, mask/weight parameters,2929,2929 density 0.23836263020833334,0.23836263020833334
layer1.0.shortcut.0.weight, mask/weight parameters,6442,6442 density 0.3931884765625,0.3931884765625
before tensor 16384 mask 2814.0 16384
layer1.1.conv1.weight, mask/weight parameters,2814,2814 density 0.22900390625,0.22900390625
before tensor 36864 mask 4683.0 36864
layer1.1.conv2.weight, mask/weight parameters,4683,4683 density 0.22583912037037038,0.22583912037037038
before tensor 16384 mask 2843.0 16384
layer1.1.conv3.weight, mask/weight parameters,2843,2843 density 0.23136393229166666,0.23136393229166666
before tensor 16384 mask 2260.0 16384
layer1.2.conv1.weight, mask/weight parameters,2260,2260 density 0.18391927083333334,0.18391927083333334
before tensor 36864 mask 3073.0 36864
layer1.2.conv2.weight, mask/weight parameters,3073,3073 density 0.14819637345679013,0.14819637345679013
before tensor 16384 mask 2120.0 16384
layer1.2.conv3.weight, mask/weight parameters,2120,2120 density 0.17252604166666666,0.17252604166666666
before tensor 32768 mask 3811.0 32768
layer2.0.conv1.weight, mask/weight parameters,3811,3811 density 0.16181216032608695,0.16181216032608695
before tensor 147456 mask 10535.0 147456
layer2.0.conv2.weight, mask/weight parameters,10535,10535 density 0.13829815164881326,0.13829815164881326
before tensor 65536 mask 7406.0 65536
layer2.0.conv3.weight, mask/weight parameters,7406,7406 density 0.1572265625,0.1572265625
layer2.0.shortcut.0.weight, mask/weight parameters,28582,28582 density 0.2180633544921875,0.2180633544921875
before tensor 65536 mask 6984.0 65536
layer2.1.conv1.weight, mask/weight parameters,6984,6984 density 0.14826766304347827,0.14826766304347827
before tensor 147456 mask 12579.0 147456
layer2.1.conv2.weight, mask/weight parameters,12579,12579 density 0.16513074984247006,0.16513074984247006
before tensor 65536 mask 8029.0 65536
layer2.1.conv3.weight, mask/weight parameters,8029,8029 density 0.17045261548913043,0.17045261548913043
before tensor 65536 mask 9563.0 65536
layer2.2.conv1.weight, mask/weight parameters,9563,9563 density 0.20301885190217392,0.20301885190217392
before tensor 147456 mask 19730.0 147456
layer2.2.conv2.weight, mask/weight parameters,19730,19730 density 0.25900546103759714,0.25900546103759714
before tensor 65536 mask 11744.0 65536
layer2.2.conv3.weight, mask/weight parameters,11744,11744 density 0.24932065217391305,0.24932065217391305
before tensor 65536 mask 7746.0 65536
layer2.3.conv1.weight, mask/weight parameters,7746,7746 density 0.16444463315217392,0.16444463315217392
before tensor 147456 mask 13468.0 147456
layer2.3.conv2.weight, mask/weight parameters,13468,13468 density 0.17680109220751944,0.17680109220751944
before tensor 65536 mask 7759.0 65536
layer2.3.conv3.weight, mask/weight parameters,7759,7759 density 0.16472061820652173,0.16472061820652173
before tensor 131072 mask 30091.0 131072
layer3.0.conv1.weight, mask/weight parameters,30091,30091 density 0.33583705357142857,0.33583705357142857
before tensor 589824 mask 89163.0 589824
layer3.0.conv2.weight, mask/weight parameters,89163,89163 density 0.3234938775510204,0.3234938775510204
before tensor 262144 mask 65176.0 262144
layer3.0.conv3.weight, mask/weight parameters,65176,65176 density 0.3637053571428571,0.3637053571428571
layer3.0.shortcut.0.weight, mask/weight parameters,92521,92521 density 0.1764698028564453,0.1764698028564453
before tensor 262144 mask 34057.0 262144
layer3.1.conv1.weight, mask/weight parameters,34057,34057 density 0.19005022321428572,0.19005022321428572
before tensor 589824 mask 81652.0 589824
layer3.1.conv2.weight, mask/weight parameters,81652,81652 density 0.29624308390022674,0.29624308390022674
before tensor 262144 mask 58988.0 262144
layer3.1.conv3.weight, mask/weight parameters,58988,58988 density 0.32917410714285716,0.32917410714285716
before tensor 262144 mask 43772.0 262144
layer3.2.conv1.weight, mask/weight parameters,43772,43772 density 0.24426339285714285,0.24426339285714285
before tensor 589824 mask 91396.0 589824
layer3.2.conv2.weight, mask/weight parameters,91396,91396 density 0.3315954648526077,0.3315954648526077
before tensor 262144 mask 61279.0 262144
layer3.2.conv3.weight, mask/weight parameters,61279,61279 density 0.34195870535714284,0.34195870535714284
before tensor 262144 mask 43226.0 262144
layer3.3.conv1.weight, mask/weight parameters,43226,43226 density 0.24121651785714285,0.24121651785714285
before tensor 589824 mask 71244.0 589824
layer3.3.conv2.weight, mask/weight parameters,71244,71244 density 0.25848163265306123,0.25848163265306123
before tensor 262144 mask 48784.0 262144
layer3.3.conv3.weight, mask/weight parameters,48784,48784 density 0.27223214285714287,0.27223214285714287
before tensor 262144 mask 42253.0 262144
layer3.4.conv1.weight, mask/weight parameters,42253,42253 density 0.23578683035714285,0.23578683035714285
before tensor 589824 mask 57276.0 589824
layer3.4.conv2.weight, mask/weight parameters,57276,57276 density 0.20780408163265307,0.20780408163265307
before tensor 262144 mask 38174.0 262144
layer3.4.conv3.weight, mask/weight parameters,38174,38174 density 0.21302455357142858,0.21302455357142858
before tensor 262144 mask 40197.0 262144
layer3.5.conv1.weight, mask/weight parameters,40197,40197 density 0.22431361607142858,0.22431361607142858
before tensor 589824 mask 52075.0 589824
layer3.5.conv2.weight, mask/weight parameters,52075,52075 density 0.18893424036281178,0.18893424036281178
before tensor 262144 mask 34509.0 262144
layer3.5.conv3.weight, mask/weight parameters,34509,34509 density 0.19257254464285714,0.19257254464285714
before tensor 524288 mask 133754.0 524288
layer4.0.conv1.weight, mask/weight parameters,133754,133754 density 0.38192731176900585,0.38192731176900585
before tensor 2359296 mask 234643.0 2359296
layer4.0.conv2.weight, mask/weight parameters,234643,234643 density 0.2229014435590818,0.2229014435590818
before tensor 1048576 mask 100075.0 1048576
layer4.0.conv3.weight, mask/weight parameters,100075,100075 density 0.14287937454312866,0.14287937454312866
layer4.0.shortcut.0.weight, mask/weight parameters,139247,139247 density 0.06639814376831055,0.06639814376831055
before tensor 1048576 mask 73694.0 1048576
layer4.1.conv1.weight, mask/weight parameters,73694,73694 density 0.10521461531432749,0.10521461531432749
before tensor 2359296 mask 148449.0 2359296
layer4.1.conv2.weight, mask/weight parameters,148449,148449 density 0.14102059893072513,0.14102059893072513
before tensor 1048576 mask 71225.0 1048576
layer4.1.conv3.weight, mask/weight parameters,71225,71225 density 0.10168956734283625,0.10168956734283625
before tensor 1048576 mask 37627.0 1048576
layer4.2.conv1.weight, mask/weight parameters,37627,37627 density 0.053720931560672515,0.053720931560672515
before tensor 2359296 mask 44965.0 2359296
layer4.2.conv2.weight, mask/weight parameters,44965,44965 density 0.04271494742921849,0.04271494742921849
before tensor 1048576 mask 28537.0 1048576
layer4.2.conv3.weight, mask/weight parameters,28537,28537 density 0.04074292991593567,0.04074292991593567
classifier.weight, mask/weight parameters,95798,95798 density 0.467763671875,0.467763671875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.16328657091608045 0.16328657091608045 after dst
Death rate: 0.14017906269546812

dynamic sparse change grow
self.total_params*pruning_rate 3315519.676603218
self.total_nonzero 2365205.0
to grow 950314.6766032181
len(all_scores) 14484994 11546489
increse 950314.0 before_mask 3315518.0 after_mask 3315518.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1512,1385 density 0.875,0.8015046296296297
before tensor 4096 mask 1083.0 4096
layer1.0.conv1.weight, mask/weight parameters,1083,935 density 0.3525390625,0.3043619791666667
before tensor 36864 mask 4897.0 36864
layer1.0.conv2.weight, mask/weight parameters,4897,3938 density 0.2361593364197531,0.18991126543209877
before tensor 16384 mask 3775.0 16384
layer1.0.conv3.weight, mask/weight parameters,3775,2929 density 0.3072102864583333,0.23836263020833334
layer1.0.shortcut.0.weight, mask/weight parameters,7817,6442 density 0.47711181640625,0.3931884765625
before tensor 16384 mask 3568.0 16384
layer1.1.conv1.weight, mask/weight parameters,3568,2814 density 0.2903645833333333,0.22900390625
before tensor 36864 mask 5453.0 36864
layer1.1.conv2.weight, mask/weight parameters,5453,4683 density 0.26297260802469136,0.22583912037037038
before tensor 16384 mask 3552.0 16384
layer1.1.conv3.weight, mask/weight parameters,3552,2843 density 0.2890625,0.23136393229166666
before tensor 16384 mask 3154.0 16384
layer1.2.conv1.weight, mask/weight parameters,3154,2260 density 0.2566731770833333,0.18391927083333334
before tensor 36864 mask 3699.0 36864
layer1.2.conv2.weight, mask/weight parameters,3699,3073 density 0.17838541666666666,0.14819637345679013
before tensor 16384 mask 2894.0 16384
layer1.2.conv3.weight, mask/weight parameters,2894,2120 density 0.23551432291666666,0.17252604166666666
before tensor 32768 mask 5690.0 32768
layer2.0.conv1.weight, mask/weight parameters,5690,3811 density 0.24159307065217392,0.16181216032608695
before tensor 147456 mask 12551.0 147456
layer2.0.conv2.weight, mask/weight parameters,12551,10535 density 0.1647631800042008,0.13829815164881326
before tensor 65536 mask 9162.0 65536
layer2.0.conv3.weight, mask/weight parameters,9162,7406 density 0.19450577445652173,0.1572265625
layer2.0.shortcut.0.weight, mask/weight parameters,39655,28582 density 0.30254364013671875,0.2180633544921875
before tensor 65536 mask 8844.0 65536
layer2.1.conv1.weight, mask/weight parameters,8844,6984 density 0.18775475543478262,0.14826766304347827
before tensor 147456 mask 18021.0 147456
layer2.1.conv2.weight, mask/weight parameters,18021,12579 density 0.2365705734089477,0.16513074984247006
before tensor 65536 mask 11086.0 65536
layer2.1.conv3.weight, mask/weight parameters,11086,8029 density 0.2353515625,0.17045261548913043
before tensor 65536 mask 12604.0 65536
layer2.2.conv1.weight, mask/weight parameters,12604,9563 density 0.267578125,0.20301885190217392
before tensor 147456 mask 24889.0 147456
layer2.2.conv2.weight, mask/weight parameters,24889,19730 density 0.32673020373871037,0.25900546103759714
before tensor 65536 mask 15266.0 65536
layer2.2.conv3.weight, mask/weight parameters,15266,11744 density 0.3240913722826087,0.24932065217391305
before tensor 65536 mask 11523.0 65536
layer2.3.conv1.weight, mask/weight parameters,11523,7746 density 0.24462890625,0.16444463315217392
before tensor 147456 mask 16945.0 147456
layer2.3.conv2.weight, mask/weight parameters,16945,13468 density 0.22244538962402857,0.17680109220751944
before tensor 65536 mask 9618.0 65536
layer2.3.conv3.weight, mask/weight parameters,9618,7759 density 0.20418648097826086,0.16472061820652173
before tensor 131072 mask 39323.0 131072
layer3.0.conv1.weight, mask/weight parameters,39323,30091 density 0.43887276785714285,0.33583705357142857
before tensor 589824 mask 115005.0 589824
layer3.0.conv2.weight, mask/weight parameters,115005,89163 density 0.4172517006802721,0.3234938775510204
before tensor 262144 mask 81732.0 262144
layer3.0.conv3.weight, mask/weight parameters,81732,65176 density 0.45609375,0.3637053571428571
layer3.0.shortcut.0.weight, mask/weight parameters,127802,92521 density 0.24376296997070312,0.1764698028564453
before tensor 262144 mask 44107.0 262144
layer3.1.conv1.weight, mask/weight parameters,44107,34057 density 0.2461328125,0.19005022321428572
before tensor 589824 mask 108532.0 589824
layer3.1.conv2.weight, mask/weight parameters,108532,81652 density 0.39376689342403626,0.29624308390022674
before tensor 262144 mask 75524.0 262144
layer3.1.conv3.weight, mask/weight parameters,75524,58988 density 0.4214508928571429,0.32917410714285716
before tensor 262144 mask 56835.0 262144
layer3.2.conv1.weight, mask/weight parameters,56835,43772 density 0.3171595982142857,0.24426339285714285
before tensor 589824 mask 122922.0 589824
layer3.2.conv2.weight, mask/weight parameters,122922,91396 density 0.44597551020408166,0.3315954648526077
before tensor 262144 mask 80949.0 262144
layer3.2.conv3.weight, mask/weight parameters,80949,61279 density 0.4517243303571429,0.34195870535714284
before tensor 262144 mask 57168.0 262144
layer3.3.conv1.weight, mask/weight parameters,57168,43226 density 0.31901785714285713,0.24121651785714285
before tensor 589824 mask 97044.0 589824
layer3.3.conv2.weight, mask/weight parameters,97044,71244 density 0.35208707482993196,0.25848163265306123
before tensor 262144 mask 66276.0 262144
layer3.3.conv3.weight, mask/weight parameters,66276,48784 density 0.36984375,0.27223214285714287
before tensor 262144 mask 53807.0 262144
layer3.4.conv1.weight, mask/weight parameters,53807,42253 density 0.30026227678571427,0.23578683035714285
before tensor 589824 mask 76091.0 589824
layer3.4.conv2.weight, mask/weight parameters,76091,57276 density 0.2760671201814059,0.20780408163265307
before tensor 262144 mask 51733.0 262144
layer3.4.conv3.weight, mask/weight parameters,51733,38174 density 0.2886886160714286,0.21302455357142858
before tensor 262144 mask 57806.0 262144
layer3.5.conv1.weight, mask/weight parameters,57806,40197 density 0.322578125,0.22431361607142858
before tensor 589824 mask 74631.0 589824
layer3.5.conv2.weight, mask/weight parameters,74631,52075 density 0.2707700680272109,0.18893424036281178
before tensor 262144 mask 47635.0 262144
layer3.5.conv3.weight, mask/weight parameters,47635,34509 density 0.2658203125,0.19257254464285714
before tensor 524288 mask 173957.0 524288
layer4.0.conv1.weight, mask/weight parameters,173957,133754 density 0.4967248035453216,0.38192731176900585
before tensor 2359296 mask 336505.0 2359296
layer4.0.conv2.weight, mask/weight parameters,336505,234643 density 0.3196662600838245,0.2229014435590818
before tensor 1048576 mask 153407.0 1048576
layer4.0.conv3.weight, mask/weight parameters,153407,100075 density 0.21902269508406433,0.14287937454312866
layer4.0.shortcut.0.weight, mask/weight parameters,235331,139247 density 0.11221456527709961,0.06639814376831055
before tensor 1048576 mask 111679.0 1048576
layer4.1.conv1.weight, mask/weight parameters,111679,73694 density 0.15944667169225146,0.10521461531432749
before tensor 2359296 mask 224840.0 2359296
layer4.1.conv2.weight, mask/weight parameters,224840,148449 density 0.21358898654476782,0.14102059893072513
before tensor 1048576 mask 109673.0 1048576
layer4.1.conv3.weight, mask/weight parameters,109673,71225 density 0.1565826594480994,0.10168956734283625
before tensor 1048576 mask 58588.0 1048576
layer4.2.conv1.weight, mask/weight parameters,58588,37627 density 0.08364743238304094,0.053720931560672515
before tensor 2359296 mask 81753.0 2359296
layer4.2.conv2.weight, mask/weight parameters,81753,44965 density 0.07766207266053372,0.04271494742921849
before tensor 1048576 mask 49106.0 1048576
layer4.2.conv3.weight, mask/weight parameters,49106,28537 density 0.07010976334064327,0.04074292991593567
classifier.weight, mask/weight parameters,108499,95798 density 0.5297802734375,0.467763671875
Total Model parameters after dst: 3315518 2365205
Total parameters under density level of 0.1: 0.22889329467447483 0.16328657091608045 after dst
Death rate: 0.14017906269546812


Training summary: Average loss: 1.3225, Accuracy: 31058/50000 (62.116%)


Evaluation: Average loss: 1.5540, Accuracy: 5694/10000 (56.940%)

Current learning rate: 0.1. Time taken for epoch: 97.18 seconds.

Train Epoch: 38 [0/50000 (0%)]	Loss: 1.260133 Accuracy: 65/100 (65.000%
Train Epoch: 38 [10000/50000 (20%)]	Loss: 1.420776 Accuracy: 6376/10100 (63.129%
Train Epoch: 38 [20000/50000 (40%)]	Loss: 1.259015 Accuracy: 12622/20100 (62.796%
Train Epoch: 38 [30000/50000 (60%)]	Loss: 1.378829 Accuracy: 18830/30100 (62.558%
Train Epoch: 38 [40000/50000 (80%)]	Loss: 1.361686 Accuracy: 25006/40100 (62.359%
current layer rate 0.3285
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5176.0
Total filter_masks items: 11509570.0
5176.0 / 7552 channels
Total channels to prune: 104.83200000000033
Layer ('layer2', 0, 'conv1'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/92.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/342.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/342.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/342.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/342.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/342.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/342.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5096.0
Total filter_masks items: 11230180.0
After apply_mask:
Total filter_names items: 5096.0
Total filter_masks items: 11230180.0
Total pruned: 80/104.83200000000033 channels
===========done ===============

Training summary: Average loss: 1.3150, Accuracy: 31186/50000 (62.372%)


Evaluation: Average loss: 1.5939, Accuracy: 5608/10000 (56.080%)

Current learning rate: 0.1. Time taken for epoch: 96.84 seconds.

Train Epoch: 39 [0/50000 (0%)]	Loss: 1.228966 Accuracy: 64/100 (64.000%
Train Epoch: 39 [10000/50000 (20%)]	Loss: 1.386055 Accuracy: 6421/10100 (63.574%
Train Epoch: 39 [20000/50000 (40%)]	Loss: 1.449916 Accuracy: 12703/20100 (63.199%
Train Epoch: 39 [30000/50000 (60%)]	Loss: 1.335296 Accuracy: 18779/30100 (62.389%
Train Epoch: 39 [40000/50000 (80%)]	Loss: 1.079779 Accuracy: 25007/40100 (62.362%
current mest  death_rate 0.1392016186682789


dynamic sparse change prune
to kill 860636.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1398,1398 density 0.8090277777777778,0.8090277777777778
before tensor 4096 mask 904.0 4096
layer1.0.conv1.weight, mask/weight parameters,904,904 density 0.2942708333333333,0.2942708333333333
before tensor 36864 mask 3925.0 36864
layer1.0.conv2.weight, mask/weight parameters,3925,3925 density 0.1892843364197531,0.1892843364197531
before tensor 16384 mask 2913.0 16384
layer1.0.conv3.weight, mask/weight parameters,2913,2913 density 0.237060546875,0.237060546875
layer1.0.shortcut.0.weight, mask/weight parameters,6378,6378 density 0.3892822265625,0.3892822265625
before tensor 16384 mask 2736.0 16384
layer1.1.conv1.weight, mask/weight parameters,2736,2736 density 0.22265625,0.22265625
before tensor 36864 mask 4527.0 36864
layer1.1.conv2.weight, mask/weight parameters,4527,4527 density 0.2183159722222222,0.2183159722222222
before tensor 16384 mask 2798.0 16384
layer1.1.conv3.weight, mask/weight parameters,2798,2798 density 0.22770182291666666,0.22770182291666666
before tensor 16384 mask 2434.0 16384
layer1.2.conv1.weight, mask/weight parameters,2434,2434 density 0.19807942708333334,0.19807942708333334
before tensor 36864 mask 3105.0 36864
layer1.2.conv2.weight, mask/weight parameters,3105,3105 density 0.14973958333333334,0.14973958333333334
before tensor 16384 mask 2171.0 16384
layer1.2.conv3.weight, mask/weight parameters,2171,2171 density 0.17667643229166666,0.17667643229166666
before tensor 32768 mask 3950.0 32768
layer2.0.conv1.weight, mask/weight parameters,3950,3950 density 0.1695570054945055,0.1695570054945055
before tensor 147456 mask 10249.0 147456
layer2.0.conv2.weight, mask/weight parameters,10249,10249 density 0.1375169397147419,0.1375169397147419
before tensor 65536 mask 7023.0 65536
layer2.0.conv3.weight, mask/weight parameters,7023,7023 density 0.1507340315934066,0.1507340315934066
layer2.0.shortcut.0.weight, mask/weight parameters,28652,28652 density 0.218597412109375,0.218597412109375
before tensor 65536 mask 6736.0 65536
layer2.1.conv1.weight, mask/weight parameters,6736,6736 density 0.14457417582417584,0.14457417582417584
before tensor 147456 mask 12226.0 147456
layer2.1.conv2.weight, mask/weight parameters,12226,12226 density 0.1640435266808893,0.1640435266808893
before tensor 65536 mask 8071.0 65536
layer2.1.conv3.weight, mask/weight parameters,8071,8071 density 0.17322716346153846,0.17322716346153846
before tensor 65536 mask 9454.0 65536
layer2.2.conv1.weight, mask/weight parameters,9454,9454 density 0.20291037087912087,0.20291037087912087
before tensor 147456 mask 19214.0 147456
layer2.2.conv2.weight, mask/weight parameters,19214,19214 density 0.25780568637711493,0.25780568637711493
before tensor 65536 mask 11691.0 65536
layer2.2.conv3.weight, mask/weight parameters,11691,11691 density 0.2509229052197802,0.2509229052197802
before tensor 65536 mask 8137.0 65536
layer2.3.conv1.weight, mask/weight parameters,8137,8137 density 0.17464371565934067,0.17464371565934067
before tensor 147456 mask 13487.0 147456
layer2.3.conv2.weight, mask/weight parameters,13487,13487 density 0.1809631150290491,0.1809631150290491
before tensor 65536 mask 7261.0 65536
layer2.3.conv3.weight, mask/weight parameters,7261,7261 density 0.15584220467032966,0.15584220467032966
before tensor 131072 mask 29659.0 131072
layer3.0.conv1.weight, mask/weight parameters,29659,29659 density 0.33678915334302323,0.33678915334302323
before tensor 589824 mask 85680.0 589824
layer3.0.conv2.weight, mask/weight parameters,85680,85680 density 0.32179556517036234,0.32179556517036234
before tensor 262144 mask 63750.0 262144
layer3.0.conv3.weight, mask/weight parameters,63750,63750 density 0.36195267078488375,0.36195267078488375
layer3.0.shortcut.0.weight, mask/weight parameters,93071,93071 density 0.1775188446044922,0.1775188446044922
before tensor 262144 mask 32924.0 262144
layer3.1.conv1.weight, mask/weight parameters,32924,32924 density 0.18693223110465115,0.18693223110465115
before tensor 589824 mask 78760.0 589824
layer3.1.conv2.weight, mask/weight parameters,78760,78760 density 0.2958055405324199,0.2958055405324199
before tensor 262144 mask 57652.0 262144
layer3.1.conv3.weight, mask/weight parameters,57652,57652 density 0.32733012354651164,0.32733012354651164
before tensor 262144 mask 42221.0 262144
layer3.2.conv1.weight, mask/weight parameters,42221,42221 density 0.23971770530523256,0.23971770530523256
before tensor 589824 mask 90498.0 589824
layer3.2.conv2.weight, mask/weight parameters,90498,90498 density 0.33989093203533444,0.33989093203533444
before tensor 262144 mask 61424.0 262144
layer3.2.conv3.weight, mask/weight parameters,61424,61424 density 0.34874636627906974,0.34874636627906974
before tensor 262144 mask 41655.0 262144
layer3.3.conv1.weight, mask/weight parameters,41655,41655 density 0.23650413335755813,0.23650413335755813
before tensor 589824 mask 70718.0 589824
layer3.3.conv2.weight, mask/weight parameters,70718,70718 density 0.2656015263505799,0.2656015263505799
before tensor 262144 mask 49022.0 262144
layer3.3.conv3.weight, mask/weight parameters,49022,49022 density 0.278331667877907,0.278331667877907
before tensor 262144 mask 39205.0 262144
layer3.4.conv1.weight, mask/weight parameters,39205,39205 density 0.22259379542151161,0.22259379542151161
before tensor 589824 mask 54757.0 589824
layer3.4.conv2.weight, mask/weight parameters,54757,54757 density 0.20565545940748753,0.20565545940748753
before tensor 262144 mask 37783.0 262144
layer3.4.conv3.weight, mask/weight parameters,37783,37783 density 0.21452012172965115,0.21452012172965115
before tensor 262144 mask 41581.0 262144
layer3.5.conv1.weight, mask/weight parameters,41581,41581 density 0.236083984375,0.236083984375
before tensor 589824 mask 52419.0 589824
layer3.5.conv2.weight, mask/weight parameters,52419,52419 density 0.1968744366324139,0.1968744366324139
before tensor 262144 mask 34518.0 262144
layer3.5.conv3.weight, mask/weight parameters,34518,34518 density 0.19598246729651161,0.19598246729651161
before tensor 524288 mask 135763.0 524288
layer4.0.conv1.weight, mask/weight parameters,135763,135763 density 0.39458647228422616,0.39458647228422616
before tensor 2359296 mask 236037.0 2359296
layer4.0.conv2.weight, mask/weight parameters,236037,236037 density 0.2323052484882842,0.2323052484882842
before tensor 1048576 mask 102342.0 1048576
layer4.0.conv3.weight, mask/weight parameters,102342,102342 density 0.14872523716517858,0.14872523716517858
layer4.0.shortcut.0.weight, mask/weight parameters,145620,145620 density 0.06943702697753906,0.06943702697753906
before tensor 1048576 mask 76535.0 1048576
layer4.1.conv1.weight, mask/weight parameters,76535,76535 density 0.11122204008556548,0.11122204008556548
before tensor 2359296 mask 152476.0 2359296
layer4.1.conv2.weight, mask/weight parameters,152476,152476 density 0.15006535021415973,0.15006535021415973
before tensor 1048576 mask 71351.0 1048576
layer4.1.conv3.weight, mask/weight parameters,71351,71351 density 0.10368855794270833,0.10368855794270833
before tensor 1048576 mask 37783.0 1048576
layer4.2.conv1.weight, mask/weight parameters,37783,37783 density 0.05490693591889881,0.05490693591889881
before tensor 2359296 mask 45321.0 2359296
layer4.2.conv2.weight, mask/weight parameters,45321,45321 density 0.04460447373393802,0.04460447373393802
before tensor 1048576 mask 29137.0 1048576
layer4.2.conv3.weight, mask/weight parameters,29137,29137 density 0.04234241303943452,0.04234241303943452
classifier.weight, mask/weight parameters,96103,96103 density 0.4692529296875,0.4692529296875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.16649802430083227 0.16649802430083227 after dst
Death rate: 0.1392016186682789

dynamic sparse change grow
self.total_params*pruning_rate 3292401.13919393
self.total_nonzero 2365205.0
to grow 927196.1391939302
len(all_scores) 14205604 11212345
increse 927196.0 before_mask 3292400.0 after_mask 3292400.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1492,1398 density 0.8634259259259259,0.8090277777777778
before tensor 4096 mask 1091.0 4096
layer1.0.conv1.weight, mask/weight parameters,1091,904 density 0.3551432291666667,0.2942708333333333
before tensor 36864 mask 4711.0 36864
layer1.0.conv2.weight, mask/weight parameters,4711,3925 density 0.22718942901234568,0.1892843364197531
before tensor 16384 mask 3548.0 16384
layer1.0.conv3.weight, mask/weight parameters,3548,2913 density 0.2887369791666667,0.237060546875
layer1.0.shortcut.0.weight, mask/weight parameters,7908,6378 density 0.482666015625,0.3892822265625
before tensor 16384 mask 3488.0 16384
layer1.1.conv1.weight, mask/weight parameters,3488,2736 density 0.2838541666666667,0.22265625
before tensor 36864 mask 5726.0 36864
layer1.1.conv2.weight, mask/weight parameters,5726,4527 density 0.2761381172839506,0.2183159722222222
before tensor 16384 mask 3902.0 16384
layer1.1.conv3.weight, mask/weight parameters,3902,2798 density 0.3175455729166667,0.22770182291666666
before tensor 16384 mask 3159.0 16384
layer1.2.conv1.weight, mask/weight parameters,3159,2434 density 0.257080078125,0.19807942708333334
before tensor 36864 mask 3840.0 36864
layer1.2.conv2.weight, mask/weight parameters,3840,3105 density 0.18518518518518517,0.14973958333333334
before tensor 16384 mask 3234.0 16384
layer1.2.conv3.weight, mask/weight parameters,3234,2171 density 0.26318359375,0.17667643229166666
before tensor 32768 mask 5309.0 32768
layer2.0.conv1.weight, mask/weight parameters,5309,3950 density 0.22789320054945056,0.1695570054945055
before tensor 147456 mask 12274.0 147456
layer2.0.conv2.weight, mask/weight parameters,12274,10249 density 0.16468757128097788,0.1375169397147419
before tensor 65536 mask 9613.0 65536
layer2.0.conv3.weight, mask/weight parameters,9613,7023 density 0.2063229739010989,0.1507340315934066
layer2.0.shortcut.0.weight, mask/weight parameters,41481,28652 density 0.31647491455078125,0.218597412109375
before tensor 65536 mask 9824.0 65536
layer2.1.conv1.weight, mask/weight parameters,9824,6736 density 0.21085164835164835,0.14457417582417584
before tensor 147456 mask 18338.0 147456
layer2.1.conv2.weight, mask/weight parameters,18338,12226 density 0.2460518724254988,0.1640435266808893
before tensor 65536 mask 11228.0 65536
layer2.1.conv3.weight, mask/weight parameters,11228,8071 density 0.24098557692307693,0.17322716346153846
before tensor 65536 mask 13995.0 65536
layer2.2.conv1.weight, mask/weight parameters,13995,9454 density 0.30037345467032966,0.20291037087912087
before tensor 147456 mask 26020.0 147456
layer2.2.conv2.weight, mask/weight parameters,26020,19214 density 0.34912584363133814,0.25780568637711493
before tensor 65536 mask 16402.0 65536
layer2.2.conv3.weight, mask/weight parameters,16402,11691 density 0.3520346840659341,0.2509229052197802
before tensor 65536 mask 10991.0 65536
layer2.3.conv1.weight, mask/weight parameters,10991,8137 density 0.23589886675824176,0.17464371565934067
before tensor 147456 mask 17484.0 147456
layer2.3.conv2.weight, mask/weight parameters,17484,13487 density 0.23459324558225658,0.1809631150290491
before tensor 65536 mask 10146.0 65536
layer2.3.conv3.weight, mask/weight parameters,10146,7261 density 0.21776270604395603,0.15584220467032966
before tensor 131072 mask 40809.0 131072
layer3.0.conv1.weight, mask/weight parameters,40809,29659 density 0.46340161700581395,0.33678915334302323
before tensor 589824 mask 114443.0 589824
layer3.0.conv2.weight, mask/weight parameters,114443,85680 density 0.4298231776936482,0.32179556517036234
before tensor 262144 mask 81053.0 262144
layer3.0.conv3.weight, mask/weight parameters,81053,63750 density 0.460193722747093,0.36195267078488375
layer3.0.shortcut.0.weight, mask/weight parameters,129535,93071 density 0.2470684051513672,0.1775188446044922
before tensor 262144 mask 46308.0 262144
layer3.1.conv1.weight, mask/weight parameters,46308,32924 density 0.26292242005813954,0.18693223110465115
before tensor 589824 mask 108270.0 589824
layer3.1.conv2.weight, mask/weight parameters,108270,78760 density 0.40663872363439696,0.2958055405324199
before tensor 262144 mask 75165.0 262144
layer3.1.conv3.weight, mask/weight parameters,75165,57652 density 0.4267634901889535,0.32733012354651164
before tensor 262144 mask 56520.0 262144
layer3.2.conv1.weight, mask/weight parameters,56520,42221 density 0.32090297965116277,0.23971770530523256
before tensor 589824 mask 118147.0 589824
layer3.2.conv2.weight, mask/weight parameters,118147,90498 density 0.4437346012859804,0.33989093203533444
before tensor 262144 mask 78831.0 262144
layer3.2.conv3.weight, mask/weight parameters,78831,61424 density 0.44757789789244184,0.34874636627906974
before tensor 262144 mask 57171.0 262144
layer3.3.conv1.weight, mask/weight parameters,57171,41655 density 0.32459915515988375,0.23650413335755813
before tensor 589824 mask 95222.0 589824
layer3.3.conv2.weight, mask/weight parameters,95222,70718 density 0.3576332552130281,0.2656015263505799
before tensor 262144 mask 64306.0 262144
layer3.3.conv3.weight, mask/weight parameters,64306,49022 density 0.36510946584302323,0.278331667877907
before tensor 262144 mask 54925.0 262144
layer3.4.conv1.weight, mask/weight parameters,54925,39205 density 0.3118470657703488,0.22259379542151161
before tensor 589824 mask 79084.0 589824
layer3.4.conv2.weight, mask/weight parameters,79084,54757 density 0.29702241451835826,0.20565545940748753
before tensor 262144 mask 51128.0 262144
layer3.4.conv3.weight, mask/weight parameters,51128,37783 density 0.2902888808139535,0.21452012172965115
before tensor 262144 mask 53861.0 262144
layer3.5.conv1.weight, mask/weight parameters,53861,41581 density 0.30580600472383723,0.236083984375
before tensor 589824 mask 71223.0 589824
layer3.5.conv2.weight, mask/weight parameters,71223,52419 density 0.26749819722372453,0.1968744366324139
before tensor 262144 mask 46354.0 262144
layer3.5.conv3.weight, mask/weight parameters,46354,34518 density 0.26318359375,0.19598246729651161
before tensor 524288 mask 173289.0 524288
layer4.0.conv1.weight, mask/weight parameters,173289,135763 density 0.5036533900669643,0.39458647228422616
before tensor 2359296 mask 329280.0 2359296
layer4.0.conv2.weight, mask/weight parameters,329280,236037 density 0.32407407407407407,0.2323052484882842
before tensor 1048576 mask 150938.0 1048576
layer4.0.conv3.weight, mask/weight parameters,150938,102342 density 0.21934581938244047,0.14872523716517858
layer4.0.shortcut.0.weight, mask/weight parameters,221919,145620 density 0.1058192253112793,0.06943702697753906
before tensor 1048576 mask 109404.0 1048576
layer4.1.conv1.weight, mask/weight parameters,109404,76535 density 0.15898786272321427,0.11122204008556548
before tensor 2359296 mask 216354.0 2359296
layer4.1.conv2.weight, mask/weight parameters,216354,152476 density 0.2129334372637944,0.15006535021415973
before tensor 1048576 mask 111422.0 1048576
layer4.1.conv3.weight, mask/weight parameters,111422,71351 density 0.1619204566592262,0.10368855794270833
before tensor 1048576 mask 63366.0 1048576
layer4.2.conv1.weight, mask/weight parameters,63366,37783 density 0.09208461216517858,0.05490693591889881
before tensor 2359296 mask 87546.0 2359296
layer4.2.conv2.weight, mask/weight parameters,87546,45321 density 0.08616189531368103,0.04460447373393802
before tensor 1048576 mask 51619.0 1048576
layer4.2.conv3.weight, mask/weight parameters,51619,29137 density 0.07501366024925596,0.04234241303943452
classifier.weight, mask/weight parameters,109704,96103 density 0.5356640625,0.4692529296875
Total Model parameters after dst: 3292400 2365205
Total parameters under density level of 0.1: 0.2317676883010395 0.16649802430083227 after dst
Death rate: 0.1392016186682789


Training summary: Average loss: 1.3142, Accuracy: 31098/50000 (62.196%)


Evaluation: Average loss: 1.6289, Accuracy: 5692/10000 (56.920%)

Current learning rate: 0.1. Time taken for epoch: 97.60 seconds.

Train Epoch: 40 [0/50000 (0%)]	Loss: 1.073017 Accuracy: 76/100 (76.000%
Train Epoch: 40 [10000/50000 (20%)]	Loss: 1.191069 Accuracy: 6421/10100 (63.574%
Train Epoch: 40 [20000/50000 (40%)]	Loss: 1.275062 Accuracy: 12736/20100 (63.363%
Train Epoch: 40 [30000/50000 (60%)]	Loss: 1.130691 Accuracy: 18876/30100 (62.711%
Train Epoch: 40 [40000/50000 (80%)]	Loss: 1.229754 Accuracy: 25070/40100 (62.519%
current layer rate 0.3395609922621757
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5096.0
Total filter_masks items: 11230180.0
5096.0 / 7552 channels
Total channels to prune: 108.36461356395012
Layer ('layer1', 0, 'conv1'): Pruned 1/48.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/48.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/48.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/48.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/48.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/48.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/91.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 7/336.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 7/336.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 7/336.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 7/336.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 7/336.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 7/336.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5004.0
Total filter_masks items: 10920812.0
After apply_mask:
Total filter_names items: 5004.0
Total filter_masks items: 10920812.0
Total pruned: 92/108.36461356395012 channels
===========done ===============

Training summary: Average loss: 1.3046, Accuracy: 31294/50000 (62.588%)


Evaluation: Average loss: 1.6665, Accuracy: 5473/10000 (54.730%)

Current learning rate: 0.1. Time taken for epoch: 97.68 seconds.

Train Epoch: 41 [0/50000 (0%)]	Loss: 1.085554 Accuracy: 65/100 (65.000%
Train Epoch: 41 [10000/50000 (20%)]	Loss: 1.275444 Accuracy: 6354/10100 (62.911%
Train Epoch: 41 [20000/50000 (40%)]	Loss: 1.259672 Accuracy: 12574/20100 (62.557%
Train Epoch: 41 [30000/50000 (60%)]	Loss: 1.236627 Accuracy: 18855/30100 (62.641%
Train Epoch: 41 [40000/50000 (80%)]	Loss: 1.327122 Accuracy: 25031/40100 (62.421%
current mest  death_rate 0.13819100610265317


dynamic sparse change prune
to kill 826275.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1367,1367 density 0.7910879629629629,0.7910879629629629
before tensor 4096 mask 849.0 4096
layer1.0.conv1.weight, mask/weight parameters,849,849 density 0.2822473404255319,0.2822473404255319
before tensor 36864 mask 3476.0 36864
layer1.0.conv2.weight, mask/weight parameters,3476,3476 density 0.1748402997837131,0.1748402997837131
before tensor 16384 mask 2720.0 16384
layer1.0.conv3.weight, mask/weight parameters,2720,2720 density 0.22606382978723405,0.22606382978723405
layer1.0.shortcut.0.weight, mask/weight parameters,6450,6450 density 0.3936767578125,0.3936767578125
before tensor 16384 mask 2658.0 16384
layer1.1.conv1.weight, mask/weight parameters,2658,2658 density 0.22091090425531915,0.22091090425531915
before tensor 36864 mask 4346.0 36864
layer1.1.conv2.weight, mask/weight parameters,4346,4346 density 0.21860067401036165,0.21860067401036165
before tensor 16384 mask 2880.0 16384
layer1.1.conv3.weight, mask/weight parameters,2880,2880 density 0.2393617021276596,0.2393617021276596
before tensor 16384 mask 2267.0 16384
layer1.2.conv1.weight, mask/weight parameters,2267,2267 density 0.18841422872340424,0.18841422872340424
before tensor 36864 mask 2974.0 36864
layer1.2.conv2.weight, mask/weight parameters,2974,2974 density 0.14959006086212967,0.14959006086212967
before tensor 16384 mask 2264.0 16384
layer1.2.conv3.weight, mask/weight parameters,2264,2264 density 0.18816489361702127,0.18816489361702127
before tensor 32768 mask 3806.0 32768
layer2.0.conv1.weight, mask/weight parameters,3806,3806 density 0.16519097222222223,0.16519097222222223
before tensor 147456 mask 10196.0 147456
layer2.0.conv2.weight, mask/weight parameters,10196,10196 density 0.13986282578875173,0.13986282578875173
before tensor 65536 mask 7360.0 65536
layer2.0.conv3.weight, mask/weight parameters,7360,7360 density 0.1597222222222222,0.1597222222222222
layer2.0.shortcut.0.weight, mask/weight parameters,29600,29600 density 0.225830078125,0.225830078125
before tensor 65536 mask 7085.0 65536
layer2.1.conv1.weight, mask/weight parameters,7085,7085 density 0.1537543402777778,0.1537543402777778
before tensor 147456 mask 12785.0 147456
layer2.1.conv2.weight, mask/weight parameters,12785,12785 density 0.17537722908093278,0.17537722908093278
before tensor 65536 mask 8263.0 65536
layer2.1.conv3.weight, mask/weight parameters,8263,8263 density 0.1793185763888889,0.1793185763888889
before tensor 65536 mask 10127.0 65536
layer2.2.conv1.weight, mask/weight parameters,10127,10127 density 0.21976996527777778,0.21976996527777778
before tensor 147456 mask 19758.0 147456
layer2.2.conv2.weight, mask/weight parameters,19758,19758 density 0.2710288065843621,0.2710288065843621
before tensor 65536 mask 12338.0 65536
layer2.2.conv3.weight, mask/weight parameters,12338,12338 density 0.26775173611111114,0.26775173611111114
before tensor 65536 mask 8198.0 65536
layer2.3.conv1.weight, mask/weight parameters,8198,8198 density 0.1779079861111111,0.1779079861111111
before tensor 147456 mask 13947.0 147456
layer2.3.conv2.weight, mask/weight parameters,13947,13947 density 0.19131687242798354,0.19131687242798354
before tensor 65536 mask 7631.0 65536
layer2.3.conv3.weight, mask/weight parameters,7631,7631 density 0.16560329861111112,0.16560329861111112
before tensor 131072 mask 30436.0 131072
layer3.0.conv1.weight, mask/weight parameters,30436,30436 density 0.35174741124260356,0.35174741124260356
before tensor 589824 mask 85665.0 589824
layer3.0.conv2.weight, mask/weight parameters,85665,85665 density 0.3332633077740042,0.3332633077740042
before tensor 262144 mask 63740.0 262144
layer3.0.conv3.weight, mask/weight parameters,63740,63740 density 0.36832008136094674,0.36832008136094674
layer3.0.shortcut.0.weight, mask/weight parameters,94847,94847 density 0.1809062957763672,0.1809062957763672
before tensor 262144 mask 33761.0 262144
layer3.1.conv1.weight, mask/weight parameters,33761,33761 density 0.19508713942307693,0.19508713942307693
before tensor 589824 mask 78666.0 589824
layer3.1.conv2.weight, mask/weight parameters,78666,78666 density 0.30603503612151767,0.30603503612151767
before tensor 262144 mask 57547.0 262144
layer3.1.conv3.weight, mask/weight parameters,57547,57547 density 0.3325339774408284,0.3325339774408284
before tensor 262144 mask 42605.0 262144
layer3.2.conv1.weight, mask/weight parameters,42605,42605 density 0.24619198409763313,0.24619198409763313
before tensor 589824 mask 89245.0 589824
layer3.2.conv2.weight, mask/weight parameters,89245,89245 density 0.34719061346280283,0.34719061346280283
before tensor 262144 mask 60867.0 262144
layer3.2.conv3.weight, mask/weight parameters,60867,60867 density 0.35171851886094674,0.35171851886094674
before tensor 262144 mask 41835.0 262144
layer3.3.conv1.weight, mask/weight parameters,41835,41835 density 0.2417425573224852,0.2417425573224852
before tensor 589824 mask 69719.0 589824
layer3.3.conv2.weight, mask/weight parameters,69719,69719 density 0.27122844282607594,0.27122844282607594
before tensor 262144 mask 48129.0 262144
layer3.3.conv3.weight, mask/weight parameters,48129,48129 density 0.278112287352071,0.278112287352071
before tensor 262144 mask 39852.0 262144
layer3.4.conv1.weight, mask/weight parameters,39852,39852 density 0.23028383875739644,0.23028383875739644
before tensor 589824 mask 55620.0 589824
layer3.4.conv2.weight, mask/weight parameters,55620,55620 density 0.21637897832708938,0.21637897832708938
before tensor 262144 mask 37210.0 262144
layer3.4.conv3.weight, mask/weight parameters,37210,37210 density 0.21501710428994084,0.21501710428994084
before tensor 262144 mask 40082.0 262144
layer3.5.conv1.weight, mask/weight parameters,40082,40082 density 0.23161288831360946,0.23161288831360946
before tensor 589824 mask 51291.0 589824
layer3.5.conv2.weight, mask/weight parameters,51291,51291 density 0.1995378313084276,0.1995378313084276
before tensor 262144 mask 34249.0 262144
layer3.5.conv3.weight, mask/weight parameters,34249,34249 density 0.19790703587278108,0.19790703587278108
before tensor 524288 mask 135926.0 524288
layer4.0.conv1.weight, mask/weight parameters,135926,135926 density 0.4034657579787234,0.4034657579787234
before tensor 2359296 mask 232933.0 2359296
layer4.0.conv2.weight, mask/weight parameters,232933,232933 density 0.23910943583710834,0.23910943583710834
before tensor 1048576 mask 102900.0 1048576
layer4.0.conv3.weight, mask/weight parameters,102900,102900 density 0.15271775265957446,0.15271775265957446
layer4.0.shortcut.0.weight, mask/weight parameters,143915,143915 density 0.06862401962280273,0.06862401962280273
before tensor 1048576 mask 76170.0 1048576
layer4.1.conv1.weight, mask/weight parameters,76170,76170 density 0.11304675626899696,0.11304675626899696
before tensor 2359296 mask 148448.0 2359296
layer4.1.conv2.weight, mask/weight parameters,148448,148448 density 0.1523842372319382,0.1523842372319382
before tensor 1048576 mask 73096.0 1048576
layer4.1.conv3.weight, mask/weight parameters,73096,73096 density 0.10848451747720365,0.10848451747720365
before tensor 1048576 mask 39736.0 1048576
layer4.2.conv1.weight, mask/weight parameters,39736,39736 density 0.05897368920972644,0.05897368920972644
before tensor 2359296 mask 46633.0 2359296
layer4.2.conv2.weight, mask/weight parameters,46633,46633 density 0.04786951750671598,0.04786951750671598
before tensor 1048576 mask 29736.0 1048576
layer4.2.conv3.weight, mask/weight parameters,29736,29736 density 0.04413231382978723,0.04413231382978723
classifier.weight, mask/weight parameters,97001,97001 density 0.4736376953125,0.4736376953125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.1702047230631374 0.1702047230631374 after dst
Death rate: 0.13819100610265317

dynamic sparse change grow
self.total_params*pruning_rate 3268498.098452148
self.total_nonzero 2365205.0
to grow 903293.098452148
len(all_scores) 13896236 10865037
increse 903293.0 before_mask 3268497.0 after_mask 3268497.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1492,1367 density 0.8634259259259259,0.7910879629629629
before tensor 4096 mask 1042.0 4096
layer1.0.conv1.weight, mask/weight parameters,1042,849 density 0.3464095744680851,0.2822473404255319
before tensor 36864 mask 4442.0 36864
layer1.0.conv2.weight, mask/weight parameters,4442,3476 density 0.22342940495950908,0.1748402997837131
before tensor 16384 mask 3437.0 16384
layer1.0.conv3.weight, mask/weight parameters,3437,2720 density 0.28565492021276595,0.22606382978723405
layer1.0.shortcut.0.weight, mask/weight parameters,8017,6450 density 0.48931884765625,0.3936767578125
before tensor 16384 mask 3344.0 16384
layer1.1.conv1.weight, mask/weight parameters,3344,2658 density 0.2779255319148936,0.22091090425531915
before tensor 36864 mask 5578.0 36864
layer1.1.conv2.weight, mask/weight parameters,5578,4346 density 0.28056938785775365,0.21860067401036165
before tensor 16384 mask 3857.0 16384
layer1.1.conv3.weight, mask/weight parameters,3857,2880 density 0.320561835106383,0.2393617021276596
before tensor 16384 mask 3046.0 16384
layer1.2.conv1.weight, mask/weight parameters,3046,2267 density 0.2531582446808511,0.18841422872340424
before tensor 36864 mask 3603.0 36864
layer1.2.conv2.weight, mask/weight parameters,3603,2974 density 0.1812283084351894,0.14959006086212967
before tensor 16384 mask 3000.0 16384
layer1.2.conv3.weight, mask/weight parameters,3000,2264 density 0.24933510638297873,0.18816489361702127
before tensor 32768 mask 5377.0 32768
layer2.0.conv1.weight, mask/weight parameters,5377,3806 density 0.23337673611111112,0.16519097222222223
before tensor 147456 mask 12738.0 147456
layer2.0.conv2.weight, mask/weight parameters,12738,10196 density 0.17473251028806586,0.13986282578875173
before tensor 65536 mask 9299.0 65536
layer2.0.conv3.weight, mask/weight parameters,9299,7360 density 0.20180121527777778,0.1597222222222222
layer2.0.shortcut.0.weight, mask/weight parameters,41218,29600 density 0.3144683837890625,0.225830078125
before tensor 65536 mask 9957.0 65536
layer2.1.conv1.weight, mask/weight parameters,9957,7085 density 0.21608072916666668,0.1537543402777778
before tensor 147456 mask 19678.0 147456
layer2.1.conv2.weight, mask/weight parameters,19678,12785 density 0.26993141289437583,0.17537722908093278
before tensor 65536 mask 12221.0 65536
layer2.1.conv3.weight, mask/weight parameters,12221,8263 density 0.2652126736111111,0.1793185763888889
before tensor 65536 mask 13808.0 65536
layer2.2.conv1.weight, mask/weight parameters,13808,10127 density 0.29965277777777777,0.21976996527777778
before tensor 147456 mask 26650.0 147456
layer2.2.conv2.weight, mask/weight parameters,26650,19758 density 0.3655692729766804,0.2710288065843621
before tensor 65536 mask 16421.0 65536
layer2.2.conv3.weight, mask/weight parameters,16421,12338 density 0.35635850694444443,0.26775173611111114
before tensor 65536 mask 11760.0 65536
layer2.3.conv1.weight, mask/weight parameters,11760,8198 density 0.2552083333333333,0.1779079861111111
before tensor 147456 mask 18617.0 147456
layer2.3.conv2.weight, mask/weight parameters,18617,13947 density 0.2553772290809328,0.19131687242798354
before tensor 65536 mask 10206.0 65536
layer2.3.conv3.weight, mask/weight parameters,10206,7631 density 0.221484375,0.16560329861111112
before tensor 131072 mask 40123.0 131072
layer3.0.conv1.weight, mask/weight parameters,40123,30436 density 0.4636996116863905,0.35174741124260356
before tensor 589824 mask 116171.0 589824
layer3.0.conv2.weight, mask/weight parameters,116171,85665 density 0.45194106960151564,0.3332633077740042
before tensor 262144 mask 81778.0 262144
layer3.0.conv3.weight, mask/weight parameters,81778,63740 density 0.4725522374260355,0.36832008136094674
layer3.0.shortcut.0.weight, mask/weight parameters,134856,94847 density 0.2572174072265625,0.1809062957763672
before tensor 262144 mask 47076.0 262144
layer3.1.conv1.weight, mask/weight parameters,47076,33761 density 0.2720275517751479,0.19508713942307693
before tensor 589824 mask 109546.0 589824
layer3.1.conv2.weight, mask/weight parameters,109546,78666 density 0.42616777345953494,0.30603503612151767
before tensor 262144 mask 76211.0 262144
layer3.1.conv3.weight, mask/weight parameters,76211,57547 density 0.4403834596893491,0.3325339774408284
before tensor 262144 mask 57111.0 262144
layer3.2.conv1.weight, mask/weight parameters,57111,42605 density 0.33001456176035504,0.24619198409763313
before tensor 589824 mask 118109.0 589824
layer3.2.conv2.weight, mask/weight parameters,118109,89245 density 0.4594804881559547,0.34719061346280283
before tensor 262144 mask 79577.0 262144
layer3.2.conv3.weight, mask/weight parameters,79577,60867 density 0.4598338110207101,0.35171851886094674
before tensor 262144 mask 55138.0 262144
layer3.3.conv1.weight, mask/weight parameters,55138,41835 density 0.3186136279585799,0.2417425573224852
before tensor 589824 mask 94043.0 589824
layer3.3.conv2.weight, mask/weight parameters,94043,69719 density 0.36585631533287427,0.27122844282607594
before tensor 262144 mask 64663.0 262144
layer3.3.conv3.weight, mask/weight parameters,64663,48129 density 0.3736536150147929,0.278112287352071
before tensor 262144 mask 55425.0 262144
layer3.4.conv1.weight, mask/weight parameters,55425,39852 density 0.3202720506656805,0.23028383875739644
before tensor 589824 mask 75720.0 589824
layer3.4.conv2.weight, mask/weight parameters,75720,55620 density 0.294574186244646,0.21637897832708938
before tensor 262144 mask 50913.0 262144
layer3.4.conv3.weight, mask/weight parameters,50913,37210 density 0.2941995654585799,0.21501710428994084
before tensor 262144 mask 57561.0 262144
layer3.5.conv1.weight, mask/weight parameters,57561,40082 density 0.33261487610946744,0.23161288831360946
before tensor 589824 mask 72916.0 589824
layer3.5.conv2.weight, mask/weight parameters,72916,51291 density 0.28366576022470424,0.1995378313084276
before tensor 262144 mask 47270.0 262144
layer3.5.conv3.weight, mask/weight parameters,47270,34249 density 0.27314857618343197,0.19790703587278108
before tensor 524288 mask 174821.0 524288
layer4.0.conv1.weight, mask/weight parameters,174821,135926 density 0.5189168170592705,0.4034657579787234
before tensor 2359296 mask 326170.0 2359296
layer4.0.conv2.weight, mask/weight parameters,326170,232933 density 0.33481870188848134,0.23910943583710834
before tensor 1048576 mask 148029.0 1048576
layer4.0.conv3.weight, mask/weight parameters,148029,102900 density 0.21969539561170212,0.15271775265957446
layer4.0.shortcut.0.weight, mask/weight parameters,227338,143915 density 0.10840320587158203,0.06862401962280273
before tensor 1048576 mask 108604.0 1048576
layer4.1.conv1.weight, mask/weight parameters,108604,76170 density 0.1611832731762918,0.11304675626899696
before tensor 2359296 mask 212081.0 2359296
layer4.1.conv2.weight, mask/weight parameters,212081,148448 density 0.21770452560079412,0.1523842372319382
before tensor 1048576 mask 104818.0 1048576
layer4.1.conv3.weight, mask/weight parameters,104818,73096 density 0.1555643284574468,0.10848451747720365
before tensor 1048576 mask 56752.0 1048576
layer4.2.conv1.weight, mask/weight parameters,56752,39736 density 0.084227773556231,0.05897368920972644
before tensor 2359296 mask 74484.0 2359296
layer4.2.conv2.weight, mask/weight parameters,74484,46633 density 0.07645901275856654,0.04786951750671598
before tensor 1048576 mask 44329.0 1048576
layer4.2.conv3.weight, mask/weight parameters,44329,29736 density 0.06579033292173252,0.04413231382978723
classifier.weight, mask/weight parameters,108056,97001 density 0.5276171875,0.4736376953125
Total Model parameters after dst: 3268497 2365205
Total parameters under density level of 0.1: 0.23520736118759064 0.1702047230631374 after dst
Death rate: 0.13819100610265317


Training summary: Average loss: 1.3147, Accuracy: 31150/50000 (62.300%)


Evaluation: Average loss: 1.5989, Accuracy: 5647/10000 (56.470%)

Current learning rate: 0.1. Time taken for epoch: 97.96 seconds.

Train Epoch: 42 [0/50000 (0%)]	Loss: 1.251764 Accuracy: 64/100 (64.000%
Train Epoch: 42 [10000/50000 (20%)]	Loss: 1.231937 Accuracy: 6327/10100 (62.644%
Train Epoch: 42 [20000/50000 (40%)]	Loss: 1.342124 Accuracy: 12716/20100 (63.264%
Train Epoch: 42 [30000/50000 (60%)]	Loss: 1.014949 Accuracy: 18933/30100 (62.900%
Train Epoch: 42 [40000/50000 (80%)]	Loss: 1.038739 Accuracy: 25055/40100 (62.481%
current layer rate 0.35013586709148836
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5004.0
Total filter_masks items: 10920812.0
5004.0 / 7552 channels
Total channels to prune: 96.22606827492018
Layer ('layer2', 0, 'conv1'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/90.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/329.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/329.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/329.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/329.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/329.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/329.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4924.0
Total filter_masks items: 10647722.0
After apply_mask:
Total filter_names items: 4924.0
Total filter_masks items: 10647722.0
Total pruned: 80/96.22606827492018 channels
===========done ===============

Training summary: Average loss: 1.3045, Accuracy: 31318/50000 (62.636%)


Evaluation: Average loss: 1.7024, Accuracy: 5515/10000 (55.150%)

Current learning rate: 0.1. Time taken for epoch: 97.27 seconds.

Train Epoch: 43 [0/50000 (0%)]	Loss: 1.193270 Accuracy: 65/100 (65.000%
Train Epoch: 43 [10000/50000 (20%)]	Loss: 1.271487 Accuracy: 6343/10100 (62.802%
Train Epoch: 43 [20000/50000 (40%)]	Loss: 1.036476 Accuracy: 12724/20100 (63.303%
Train Epoch: 43 [30000/50000 (60%)]	Loss: 1.396026 Accuracy: 18930/30100 (62.890%
Train Epoch: 43 [40000/50000 (80%)]	Loss: 1.413986 Accuracy: 25123/40100 (62.651%
current mest  death_rate 0.1371495853310652


dynamic sparse change prune
to kill 812247.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1374,1374 density 0.7951388888888888,0.7951388888888888
before tensor 4096 mask 871.0 4096
layer1.0.conv1.weight, mask/weight parameters,871,871 density 0.28956117021276595,0.28956117021276595
before tensor 36864 mask 3574.0 36864
layer1.0.conv2.weight, mask/weight parameters,3574,3574 density 0.1797696292943011,0.1797696292943011
before tensor 16384 mask 2712.0 16384
layer1.0.conv3.weight, mask/weight parameters,2712,2712 density 0.22539893617021275,0.22539893617021275
layer1.0.shortcut.0.weight, mask/weight parameters,6490,6490 density 0.3961181640625,0.3961181640625
before tensor 16384 mask 2619.0 16384
layer1.1.conv1.weight, mask/weight parameters,2619,2619 density 0.2176695478723404,0.2176695478723404
before tensor 36864 mask 4544.0 36864
layer1.1.conv2.weight, mask/weight parameters,4544,4544 density 0.22855993159297822,0.22855993159297822
before tensor 16384 mask 2921.0 16384
layer1.1.conv3.weight, mask/weight parameters,2921,2921 density 0.2427692819148936,0.2427692819148936
before tensor 16384 mask 2272.0 16384
layer1.2.conv1.weight, mask/weight parameters,2272,2272 density 0.18882978723404256,0.18882978723404256
before tensor 36864 mask 2997.0 36864
layer1.2.conv2.weight, mask/weight parameters,2997,2997 density 0.15074694431869623,0.15074694431869623
before tensor 16384 mask 2295.0 16384
layer1.2.conv3.weight, mask/weight parameters,2295,2295 density 0.19074135638297873,0.19074135638297873
before tensor 32768 mask 3905.0 32768
layer2.0.conv1.weight, mask/weight parameters,3905,3905 density 0.17139220505617977,0.17139220505617977
before tensor 147456 mask 10160.0 147456
layer2.0.conv2.weight, mask/weight parameters,10160,10160 density 0.14251848111209303,0.14251848111209303
before tensor 65536 mask 7158.0 65536
layer2.0.conv3.weight, mask/weight parameters,7158,7158 density 0.15708391853932585,0.15708391853932585
layer2.0.shortcut.0.weight, mask/weight parameters,30048,30048 density 0.229248046875,0.229248046875
before tensor 65536 mask 7303.0 65536
layer2.1.conv1.weight, mask/weight parameters,7303,7303 density 0.1602659761235955,0.1602659761235955
before tensor 147456 mask 13354.0 147456
layer2.1.conv2.weight, mask/weight parameters,13354,13354 density 0.18732202724122937,0.18732202724122937
before tensor 65536 mask 8746.0 65536
layer2.1.conv3.weight, mask/weight parameters,8746,8746 density 0.19193293539325842,0.19193293539325842
before tensor 65536 mask 10224.0 65536
layer2.2.conv1.weight, mask/weight parameters,10224,10224 density 0.2243679775280899,0.2243679775280899
before tensor 147456 mask 20345.0 147456
layer2.2.conv2.weight, mask/weight parameters,20345,20345 density 0.285387647463143,0.285387647463143
before tensor 65536 mask 12501.0 65536
layer2.2.conv3.weight, mask/weight parameters,12501,12501 density 0.27433725421348315,0.27433725421348315
before tensor 65536 mask 8483.0 65536
layer2.3.conv1.weight, mask/weight parameters,8483,8483 density 0.18616134129213482,0.18616134129213482
before tensor 147456 mask 14274.0 147456
layer2.3.conv2.weight, mask/weight parameters,14274,14274 density 0.2002272440348441,0.2002272440348441
before tensor 65536 mask 7918.0 65536
layer2.3.conv3.weight, mask/weight parameters,7918,7918 density 0.1737622893258427,0.1737622893258427
before tensor 131072 mask 30467.0 131072
layer3.0.conv1.weight, mask/weight parameters,30467,30467 density 0.35846903237951805,0.35846903237951805
before tensor 589824 mask 86381.0 589824
layer3.0.conv2.weight, mask/weight parameters,86381,86381 density 0.34830486605054756,0.34830486605054756
before tensor 262144 mask 63907.0 262144
layer3.0.conv3.weight, mask/weight parameters,63907,63907 density 0.3759589137801205,0.3759589137801205
layer3.0.shortcut.0.weight, mask/weight parameters,97809,97809 density 0.1865558624267578,0.1865558624267578
before tensor 262144 mask 34274.0 262144
layer3.1.conv1.weight, mask/weight parameters,34274,34274 density 0.20163074171686746,0.20163074171686746
before tensor 589824 mask 79017.0 589824
layer3.1.conv2.weight, mask/weight parameters,79017,79017 density 0.3186117965839261,0.3186117965839261
before tensor 262144 mask 57721.0 262144
layer3.1.conv3.weight, mask/weight parameters,57721,57721 density 0.3395672533885542,0.3395672533885542
before tensor 262144 mask 42277.0 262144
layer3.2.conv1.weight, mask/weight parameters,42277,42277 density 0.24871164344879518,0.24871164344879518
before tensor 589824 mask 88129.0 589824
layer3.2.conv2.weight, mask/weight parameters,88129,88129 density 0.3553531394654925,0.3553531394654925
before tensor 262144 mask 61261.0 262144
layer3.2.conv3.weight, mask/weight parameters,61261,61261 density 0.36039274284638556,0.36039274284638556
before tensor 262144 mask 40534.0 262144
layer3.3.conv1.weight, mask/weight parameters,40534,40534 density 0.23845773719879518,0.23845773719879518
before tensor 589824 mask 68414.0 589824
layer3.3.conv2.weight, mask/weight parameters,68414,68414 density 0.2758584538959049,0.2758584538959049
before tensor 262144 mask 48241.0 262144
layer3.3.conv3.weight, mask/weight parameters,48241,48241 density 0.2837972985692771,0.2837972985692771
before tensor 262144 mask 40195.0 262144
layer3.4.conv1.weight, mask/weight parameters,40195,40195 density 0.23646343185240964,0.23646343185240964
before tensor 589824 mask 54289.0 589824
layer3.4.conv2.weight, mask/weight parameters,54289,54289 density 0.21890372735923613,0.21890372735923613
before tensor 262144 mask 37375.0 262144
layer3.4.conv3.weight, mask/weight parameters,37375,37375 density 0.21987363516566266,0.21987363516566266
before tensor 262144 mask 41936.0 262144
layer3.5.conv1.weight, mask/weight parameters,41936,41936 density 0.24670557228915663,0.24670557228915663
before tensor 589824 mask 52455.0 589824
layer3.5.conv2.weight, mask/weight parameters,52455,52455 density 0.21150868534378478,0.21150868534378478
before tensor 262144 mask 34695.0 262144
layer3.5.conv3.weight, mask/weight parameters,34695,34695 density 0.2041074454066265,0.2041074454066265
before tensor 524288 mask 137852.0 524288
layer4.0.conv1.weight, mask/weight parameters,137852,137852 density 0.41678357198142413,0.41678357198142413
before tensor 2359296 mask 233417.0 2359296
layer4.0.conv2.weight, mask/weight parameters,233417,233417 density 0.24859072954041755,0.24859072954041755
before tensor 1048576 mask 101211.0 1048576
layer4.0.conv3.weight, mask/weight parameters,101211,101211 density 0.15300134239551083,0.15300134239551083
layer4.0.shortcut.0.weight, mask/weight parameters,145986,145986 density 0.0696115493774414,0.0696115493774414
before tensor 1048576 mask 76307.0 1048576
layer4.1.conv1.weight, mask/weight parameters,76307,76307 density 0.1153537998258514,0.1153537998258514
before tensor 2359296 mask 147116.0 2359296
layer4.1.conv2.weight, mask/weight parameters,147116,147116 density 0.1566795639009501,0.1566795639009501
before tensor 1048576 mask 70393.0 1048576
layer4.1.conv3.weight, mask/weight parameters,70393,70393 density 0.10641356666021672,0.10641356666021672
before tensor 1048576 mask 37916.0 1048576
layer4.2.conv1.weight, mask/weight parameters,37916,37916 density 0.057317869582043345,0.057317869582043345
before tensor 2359296 mask 44241.0 2359296
layer4.2.conv2.weight, mask/weight parameters,44241,44241 density 0.047116972909417965,0.047116972909417965
before tensor 1048576 mask 27919.0 1048576
layer4.2.conv3.weight, mask/weight parameters,27919,27919 density 0.04220533813854489,0.04220533813854489
classifier.weight, mask/weight parameters,96382,96382 density 0.470615234375,0.470615234375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.17361665213013205 0.17361665213013205 after dst
Death rate: 0.1371495853310652

dynamic sparse change grow
self.total_params*pruning_rate 3243866.3810370844
self.total_nonzero 2365205.0
to grow 878661.3810370844
len(all_scores) 13623146 10558855
increse 878661.0 before_mask 3243865.0 after_mask 3243865.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1483,1374 density 0.8582175925925926,0.7951388888888888
before tensor 4096 mask 1105.0 4096
layer1.0.conv1.weight, mask/weight parameters,1105,871 density 0.3673537234042553,0.28956117021276595
before tensor 36864 mask 4613.0 36864
layer1.0.conv2.weight, mask/weight parameters,4613,3574 density 0.23203058196267792,0.1797696292943011
before tensor 16384 mask 3605.0 16384
layer1.0.conv3.weight, mask/weight parameters,3605,2712 density 0.2996176861702128,0.22539893617021275
layer1.0.shortcut.0.weight, mask/weight parameters,7960,6490 density 0.48583984375,0.3961181640625
before tensor 16384 mask 3537.0 16384
layer1.1.conv1.weight, mask/weight parameters,3537,2619 density 0.2939660904255319,0.2176695478723404
before tensor 36864 mask 5720.0 36864
layer1.1.conv2.weight, mask/weight parameters,5720,4544 density 0.2877118857200342,0.22855993159297822
before tensor 16384 mask 4108.0 16384
layer1.1.conv3.weight, mask/weight parameters,4108,2921 density 0.3414228723404255,0.2427692819148936
before tensor 16384 mask 3182.0 16384
layer1.2.conv1.weight, mask/weight parameters,3182,2272 density 0.2644614361702128,0.18882978723404256
before tensor 36864 mask 3800.0 36864
layer1.2.conv2.weight, mask/weight parameters,3800,2997 density 0.19113726673708567,0.15074694431869623
before tensor 16384 mask 3337.0 16384
layer1.2.conv3.weight, mask/weight parameters,3337,2295 density 0.27734375,0.19074135638297873
before tensor 32768 mask 5661.0 32768
layer2.0.conv1.weight, mask/weight parameters,5661,3905 density 0.24846383426966293,0.17139220505617977
before tensor 147456 mask 12243.0 147456
layer2.0.conv2.weight, mask/weight parameters,12243,10160 density 0.17173757522198377,0.14251848111209303
before tensor 65536 mask 9726.0 65536
layer2.0.conv3.weight, mask/weight parameters,9726,7158 density 0.21343925561797752,0.15708391853932585
layer2.0.shortcut.0.weight, mask/weight parameters,43158,30048 density 0.3292694091796875,0.229248046875
before tensor 65536 mask 10681.0 65536
layer2.1.conv1.weight, mask/weight parameters,10681,7303 density 0.2343969452247191,0.1602659761235955
before tensor 147456 mask 19653.0 147456
layer2.1.conv2.weight, mask/weight parameters,19653,13354 density 0.2756806800488154,0.18732202724122937
before tensor 65536 mask 11921.0 65536
layer2.1.conv3.weight, mask/weight parameters,11921,8746 density 0.2616090238764045,0.19193293539325842
before tensor 65536 mask 13704.0 65536
layer2.2.conv1.weight, mask/weight parameters,13704,10224 density 0.3007373595505618,0.2243679775280899
before tensor 147456 mask 26648.0 147456
layer2.2.conv2.weight, mask/weight parameters,26648,20345 density 0.37380240990896213,0.285387647463143
before tensor 65536 mask 16470.0 65536
layer2.2.conv3.weight, mask/weight parameters,16470,12501 density 0.3614378511235955,0.27433725421348315
before tensor 65536 mask 12343.0 65536
layer2.3.conv1.weight, mask/weight parameters,12343,8483 density 0.27086990870786515,0.18616134129213482
before tensor 147456 mask 18082.0 147456
layer2.3.conv2.weight, mask/weight parameters,18082,14274 density 0.25364361963276244,0.2002272440348441
before tensor 65536 mask 10696.0 65536
layer2.3.conv3.weight, mask/weight parameters,10696,7918 density 0.23472612359550563,0.1737622893258427
before tensor 131072 mask 41267.0 131072
layer3.0.conv1.weight, mask/weight parameters,41267,30467 density 0.48553981551204817,0.35846903237951805
before tensor 589824 mask 111665.0 589824
layer3.0.conv2.weight, mask/weight parameters,111665,86381 density 0.45025483459944193,0.34830486605054756
before tensor 262144 mask 80487.0 262144
layer3.0.conv3.weight, mask/weight parameters,80487,63907 density 0.47349750564759036,0.3759589137801205
layer3.0.shortcut.0.weight, mask/weight parameters,134652,97809 density 0.25682830810546875,0.1865558624267578
before tensor 262144 mask 46788.0 262144
layer3.1.conv1.weight, mask/weight parameters,46788,34274 density 0.27524943524096385,0.20163074171686746
before tensor 589824 mask 107370.0 589824
layer3.1.conv2.weight, mask/weight parameters,107370,79017 density 0.4329365655392655,0.3186117965839261
before tensor 262144 mask 74613.0 262144
layer3.1.conv3.weight, mask/weight parameters,74613,57721 density 0.43894131212349397,0.3395672533885542
before tensor 262144 mask 57746.0 262144
layer3.2.conv1.weight, mask/weight parameters,57746,42277 density 0.33971432605421686,0.24871164344879518
before tensor 589824 mask 116223.0 589824
layer3.2.conv2.weight, mask/weight parameters,116223,88129 density 0.46863357042628345,0.3553531394654925
before tensor 262144 mask 78615.0 262144
layer3.2.conv3.weight, mask/weight parameters,78615,61261 density 0.46248470444277107,0.36039274284638556
before tensor 262144 mask 55816.0 262144
layer3.3.conv1.weight, mask/weight parameters,55816,40534 density 0.32836031626506024,0.23845773719879518
before tensor 589824 mask 92836.0 589824
layer3.3.conv2.weight, mask/weight parameters,92836,68414 density 0.37433267205367654,0.2758584538959049
before tensor 262144 mask 64120.0 262144
layer3.3.conv3.weight, mask/weight parameters,64120,48241 density 0.37721197289156627,0.2837972985692771
before tensor 262144 mask 54330.0 262144
layer3.4.conv1.weight, mask/weight parameters,54330,40195 density 0.3196183170180723,0.23646343185240964
before tensor 589824 mask 72732.0 589824
layer3.4.conv2.weight, mask/weight parameters,72732,54289 density 0.29326946339575166,0.21890372735923613
before tensor 262144 mask 50146.0 262144
layer3.4.conv3.weight, mask/weight parameters,50146,37375 density 0.29500423569277107,0.21987363516566266
before tensor 262144 mask 56716.0 262144
layer3.5.conv1.weight, mask/weight parameters,56716,41936 density 0.3336549322289157,0.24670557228915663
before tensor 589824 mask 71652.0 589824
layer3.5.conv2.weight, mask/weight parameters,71652,52455 density 0.2889146949242754,0.21150868534378478
before tensor 262144 mask 47040.0 262144
layer3.5.conv3.weight, mask/weight parameters,47040,34695 density 0.2767319277108434,0.2041074454066265
before tensor 524288 mask 175016.0 524288
layer4.0.conv1.weight, mask/weight parameters,175016,137852 density 0.5291457043343654,0.41678357198142413
before tensor 2359296 mask 324017.0 2359296
layer4.0.conv2.weight, mask/weight parameters,324017,233417 density 0.34508036010015325,0.24859072954041755
before tensor 1048576 mask 145669.0 1048576
layer4.0.conv3.weight, mask/weight parameters,145669,101211 density 0.2202087969233746,0.15300134239551083
layer4.0.shortcut.0.weight, mask/weight parameters,219896,145986 density 0.10485458374023438,0.0696115493774414
before tensor 1048576 mask 106815.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106815,76307 density 0.16147294649767802,0.1153537998258514
before tensor 2359296 mask 203870.0 2359296
layer4.1.conv2.weight, mask/weight parameters,203870,147116 density 0.21712296889860175,0.1566795639009501
before tensor 1048576 mask 101630.0 1048576
layer4.1.conv3.weight, mask/weight parameters,101630,70393 density 0.15363474748452013,0.10641356666021672
before tensor 1048576 mask 63489.0 1048576
layer4.2.conv1.weight, mask/weight parameters,63489,37916 density 0.09597674390479877,0.057317869582043345
before tensor 2359296 mask 81982.0 2359296
layer4.2.conv2.weight, mask/weight parameters,81982,44241 density 0.0873114005800028,0.047116972909417965
before tensor 1048576 mask 45030.0 1048576
layer4.2.conv3.weight, mask/weight parameters,45030,27919 density 0.06807215073529412,0.04220533813854489
classifier.weight, mask/weight parameters,108201,96382 density 0.5283251953125,0.470615234375
Total Model parameters after dst: 3243865 2365205
Total parameters under density level of 0.1: 0.23811423587473848 0.17361665213013205 after dst
Death rate: 0.1371495853310652


Training summary: Average loss: 1.3001, Accuracy: 31357/50000 (62.714%)


Evaluation: Average loss: 1.5689, Accuracy: 5677/10000 (56.770%)

Current learning rate: 0.1. Time taken for epoch: 97.03 seconds.

Train Epoch: 44 [0/50000 (0%)]	Loss: 1.091825 Accuracy: 64/100 (64.000%
Train Epoch: 44 [10000/50000 (20%)]	Loss: 1.084593 Accuracy: 6378/10100 (63.149%
Train Epoch: 44 [20000/50000 (40%)]	Loss: 1.543279 Accuracy: 12759/20100 (63.478%
Train Epoch: 44 [30000/50000 (60%)]	Loss: 1.331281 Accuracy: 18954/30100 (62.970%
Train Epoch: 44 [40000/50000 (80%)]	Loss: 1.547502 Accuracy: 25159/40100 (62.741%
current layer rate 0.36023554847519346
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4924.0
Total filter_masks items: 10647722.0
4924.0 / 7552 channels
Total channels to prune: 92.49886208466069
Layer ('layer2', 0, 'conv1'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/89.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/323.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/323.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/323.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/323.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/323.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/323.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4844.0
Total filter_masks items: 10377620.0
After apply_mask:
Total filter_names items: 4844.0
Total filter_masks items: 10377620.0
Total pruned: 80/92.49886208466069 channels
===========done ===============

Training summary: Average loss: 1.3046, Accuracy: 31297/50000 (62.594%)


Evaluation: Average loss: 1.5478, Accuracy: 5683/10000 (56.830%)

Current learning rate: 0.1. Time taken for epoch: 97.31 seconds.

Train Epoch: 45 [0/50000 (0%)]	Loss: 1.232909 Accuracy: 63/100 (63.000%
Train Epoch: 45 [10000/50000 (20%)]	Loss: 1.136058 Accuracy: 6451/10100 (63.871%
Train Epoch: 45 [20000/50000 (40%)]	Loss: 1.280787 Accuracy: 12774/20100 (63.552%
Train Epoch: 45 [30000/50000 (60%)]	Loss: 1.163432 Accuracy: 19056/30100 (63.309%
Train Epoch: 45 [40000/50000 (80%)]	Loss: 1.245797 Accuracy: 25372/40100 (63.272%
current mest  death_rate 0.13607978863998121


dynamic sparse change prune
to kill 789845.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1367,1367 density 0.7910879629629629,0.7910879629629629
before tensor 4096 mask 868.0 4096
layer1.0.conv1.weight, mask/weight parameters,868,868 density 0.28856382978723405,0.28856382978723405
before tensor 36864 mask 3724.0 36864
layer1.0.conv2.weight, mask/weight parameters,3724,3724 density 0.18731452140234395,0.18731452140234395
before tensor 16384 mask 2770.0 16384
layer1.0.conv3.weight, mask/weight parameters,2770,2770 density 0.23021941489361702,0.23021941489361702
layer1.0.shortcut.0.weight, mask/weight parameters,6510,6510 density 0.3973388671875,0.3973388671875
before tensor 16384 mask 2750.0 16384
layer1.1.conv1.weight, mask/weight parameters,2750,2750 density 0.22855718085106383,0.22855718085106383
before tensor 36864 mask 4647.0 36864
layer1.1.conv2.weight, mask/weight parameters,4647,4647 density 0.23374075750716763,0.23374075750716763
before tensor 16384 mask 3124.0 16384
layer1.1.conv3.weight, mask/weight parameters,3124,3124 density 0.2596409574468085,0.2596409574468085
before tensor 16384 mask 2386.0 16384
layer1.2.conv1.weight, mask/weight parameters,2386,2386 density 0.19830452127659576,0.19830452127659576
before tensor 36864 mask 3107.0 36864
layer1.2.conv2.weight, mask/weight parameters,3107,3107 density 0.15627986519792766,0.15627986519792766
before tensor 16384 mask 2340.0 16384
layer1.2.conv3.weight, mask/weight parameters,2340,2340 density 0.19448138297872342,0.19448138297872342
before tensor 32768 mask 4014.0 32768
layer2.0.conv1.weight, mask/weight parameters,4014,4014 density 0.17817826704545456,0.17817826704545456
before tensor 147456 mask 9801.0 147456
layer2.0.conv2.weight, mask/weight parameters,9801,9801 density 0.140625,0.140625
before tensor 65536 mask 7260.0 65536
layer2.0.conv3.weight, mask/weight parameters,7260,7260 density 0.1611328125,0.1611328125
layer2.0.shortcut.0.weight, mask/weight parameters,30715,30715 density 0.23433685302734375,0.23433685302734375
before tensor 65536 mask 7595.0 65536
layer2.1.conv1.weight, mask/weight parameters,7595,7595 density 0.16856800426136365,0.16856800426136365
before tensor 147456 mask 13726.0 147456
layer2.1.conv2.weight, mask/weight parameters,13726,13726 density 0.19694100091827366,0.19694100091827366
before tensor 65536 mask 8543.0 65536
layer2.1.conv3.weight, mask/weight parameters,8543,8543 density 0.1896084872159091,0.1896084872159091
before tensor 65536 mask 10267.0 65536
layer2.2.conv1.weight, mask/weight parameters,10267,10267 density 0.2278719815340909,0.2278719815340909
before tensor 147456 mask 20562.0 147456
layer2.2.conv2.weight, mask/weight parameters,20562,20562 density 0.29502410468319556,0.29502410468319556
before tensor 65536 mask 12523.0 65536
layer2.2.conv3.weight, mask/weight parameters,12523,12523 density 0.27794300426136365,0.27794300426136365
before tensor 65536 mask 8960.0 65536
layer2.3.conv1.weight, mask/weight parameters,8960,8960 density 0.19886363636363635,0.19886363636363635
before tensor 147456 mask 14510.0 147456
layer2.3.conv2.weight, mask/weight parameters,14510,14510 density 0.2081898530762167,0.2081898530762167
before tensor 65536 mask 8122.0 65536
layer2.3.conv3.weight, mask/weight parameters,8122,8122 density 0.1802645596590909,0.1802645596590909
before tensor 131072 mask 31068.0 131072
layer3.0.conv1.weight, mask/weight parameters,31068,31068 density 0.37226802147239263,0.37226802147239263
before tensor 589824 mask 83881.0 589824
layer3.0.conv2.weight, mask/weight parameters,83881,83881 density 0.350788931126919,0.350788931126919
before tensor 262144 mask 63376.0 262144
layer3.0.conv3.weight, mask/weight parameters,63376,63376 density 0.3796970858895706,0.3796970858895706
layer3.0.shortcut.0.weight, mask/weight parameters,99185,99185 density 0.1891803741455078,0.1891803741455078
before tensor 262144 mask 34206.0 262144
layer3.1.conv1.weight, mask/weight parameters,34206,34206 density 0.20493433665644173,0.20493433665644173
before tensor 589824 mask 77989.0 589824
layer3.1.conv2.weight, mask/weight parameters,77989,77989 density 0.326148686229984,0.326148686229984
before tensor 262144 mask 57313.0 262144
layer3.1.conv3.weight, mask/weight parameters,57313,57313 density 0.3433725555981595,0.3433725555981595
before tensor 262144 mask 42680.0 262144
layer3.2.conv1.weight, mask/weight parameters,42680,42680 density 0.2557036042944785,0.2557036042944785
before tensor 589824 mask 86857.0 589824
layer3.2.conv2.weight, mask/weight parameters,86857,86857 density 0.3632345130707884,0.3632345130707884
before tensor 262144 mask 61058.0 262144
layer3.2.conv3.weight, mask/weight parameters,61058,61058 density 0.36580952837423314,0.36580952837423314
before tensor 262144 mask 40998.0 262144
layer3.3.conv1.weight, mask/weight parameters,40998,40998 density 0.24562643788343558,0.24562643788343558
before tensor 589824 mask 68051.0 589824
layer3.3.conv2.weight, mask/weight parameters,68051,68051 density 0.28458813738651145,0.28458813738651145
before tensor 262144 mask 48224.0 262144
layer3.3.conv3.weight, mask/weight parameters,48224,48224 density 0.28891871165644173,0.28891871165644173
before tensor 262144 mask 39956.0 262144
layer3.4.conv1.weight, mask/weight parameters,39956,39956 density 0.2393836273006135,0.2393836273006135
before tensor 589824 mask 53375.0 589824
layer3.4.conv2.weight, mask/weight parameters,53375,53375 density 0.2232133522358973,0.2232133522358973
before tensor 262144 mask 37312.0 262144
layer3.4.conv3.weight, mask/weight parameters,37312,37312 density 0.22354294478527606,0.22354294478527606
before tensor 262144 mask 41669.0 262144
layer3.5.conv1.weight, mask/weight parameters,41669,41669 density 0.2496465203220859,0.2496465203220859
before tensor 589824 mask 51911.0 589824
layer3.5.conv2.weight, mask/weight parameters,51911,51911 density 0.2170909288602841,0.2170909288602841
before tensor 262144 mask 34676.0 262144
layer3.5.conv3.weight, mask/weight parameters,34676,34676 density 0.2077501917177914,0.2077501917177914
before tensor 524288 mask 138697.0 524288
layer4.0.conv1.weight, mask/weight parameters,138697,138697 density 0.427275359818612,0.427275359818612
before tensor 2359296 mask 233816.0 2359296
layer4.0.conv2.weight, mask/weight parameters,233816,233816 density 0.2585313373160799,0.2585313373160799
before tensor 1048576 mask 101153.0 1048576
layer4.0.conv3.weight, mask/weight parameters,101153,101153 density 0.15580792833201892,0.15580792833201892
layer4.0.shortcut.0.weight, mask/weight parameters,144447,144447 density 0.0688776969909668,0.0688776969909668
before tensor 1048576 mask 76059.0 1048576
layer4.1.conv1.weight, mask/weight parameters,76059,76059 density 0.11715515329258674,0.11715515329258674
before tensor 2359296 mask 144614.0 2359296
layer4.1.conv2.weight, mask/weight parameters,144614,144614 density 0.15990030970775132,0.15990030970775132
before tensor 1048576 mask 69392.0 1048576
layer4.1.conv3.weight, mask/weight parameters,69392,69392 density 0.10688584384858044,0.10688584384858044
before tensor 1048576 mask 40622.0 1048576
layer4.2.conv1.weight, mask/weight parameters,40622,40622 density 0.06257085469242903,0.06257085469242903
before tensor 2359296 mask 47500.0 2359296
layer4.2.conv2.weight, mask/weight parameters,47500,47500 density 0.05252095033066085,0.05252095033066085
before tensor 1048576 mask 28361.0 1048576
layer4.2.conv3.weight, mask/weight parameters,28361,28361 density 0.04368499852129337,0.04368499852129337
classifier.weight, mask/weight parameters,96568,96568 density 0.4715234375,0.4715234375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.1771285259001618 0.1771285259001618 after dst
Death rate: 0.13607978863998121

dynamic sparse change grow
self.total_params*pruning_rate 3218563.515466072
self.total_nonzero 2365205.0
to grow 853358.5154660721
len(all_scores) 13353044 10237994
increse 853358.0 before_mask 3218562.0 after_mask 3218562.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1558,1367 density 0.9016203703703703,0.7910879629629629
before tensor 4096 mask 993.0 4096
layer1.0.conv1.weight, mask/weight parameters,993,868 density 0.33011968085106386,0.28856382978723405
before tensor 36864 mask 4596.0 36864
layer1.0.conv2.weight, mask/weight parameters,4596,3724 density 0.23117549419043307,0.18731452140234395
before tensor 16384 mask 3506.0 16384
layer1.0.conv3.weight, mask/weight parameters,3506,2770 density 0.2913896276595745,0.23021941489361702
layer1.0.shortcut.0.weight, mask/weight parameters,7592,6510 density 0.46337890625,0.3973388671875
before tensor 16384 mask 3741.0 16384
layer1.1.conv1.weight, mask/weight parameters,3741,2750 density 0.3109208776595745,0.22855718085106383
before tensor 36864 mask 5785.0 36864
layer1.1.conv2.weight, mask/weight parameters,5785,4647 density 0.2909813389668528,0.23374075750716763
before tensor 16384 mask 4134.0 16384
layer1.1.conv3.weight, mask/weight parameters,4134,3124 density 0.3435837765957447,0.2596409574468085
before tensor 16384 mask 3258.0 16384
layer1.2.conv1.weight, mask/weight parameters,3258,2386 density 0.2707779255319149,0.19830452127659576
before tensor 36864 mask 3831.0 36864
layer1.2.conv2.weight, mask/weight parameters,3831,3107 density 0.19269654443941453,0.15627986519792766
before tensor 16384 mask 2964.0 16384
layer1.2.conv3.weight, mask/weight parameters,2964,2340 density 0.24634308510638298,0.19448138297872342
before tensor 32768 mask 5300.0 32768
layer2.0.conv1.weight, mask/weight parameters,5300,4014 density 0.2352627840909091,0.17817826704545456
before tensor 147456 mask 11040.0 147456
layer2.0.conv2.weight, mask/weight parameters,11040,9801 density 0.1584022038567493,0.140625
before tensor 65536 mask 9231.0 65536
layer2.0.conv3.weight, mask/weight parameters,9231,7260 density 0.20487837357954544,0.1611328125
layer2.0.shortcut.0.weight, mask/weight parameters,40993,30715 density 0.31275177001953125,0.23433685302734375
before tensor 65536 mask 10076.0 65536
layer2.1.conv1.weight, mask/weight parameters,10076,7595 density 0.2236328125,0.16856800426136365
before tensor 147456 mask 17862.0 147456
layer2.1.conv2.weight, mask/weight parameters,17862,13726 density 0.25628443526170797,0.19694100091827366
before tensor 65536 mask 11025.0 65536
layer2.1.conv3.weight, mask/weight parameters,11025,8543 density 0.24469549005681818,0.1896084872159091
before tensor 65536 mask 12687.0 65536
layer2.2.conv1.weight, mask/weight parameters,12687,10267 density 0.2815829190340909,0.2278719815340909
before tensor 147456 mask 25107.0 147456
layer2.2.conv2.weight, mask/weight parameters,25107,20562 density 0.3602358815426997,0.29502410468319556
before tensor 65536 mask 15661.0 65536
layer2.2.conv3.weight, mask/weight parameters,15661,12523 density 0.3475896661931818,0.27794300426136365
before tensor 65536 mask 11038.0 65536
layer2.3.conv1.weight, mask/weight parameters,11038,8960 density 0.24498401988636365,0.19886363636363635
before tensor 147456 mask 17142.0 147456
layer2.3.conv2.weight, mask/weight parameters,17142,14510 density 0.2459538567493113,0.2081898530762167
before tensor 65536 mask 10253.0 65536
layer2.3.conv3.weight, mask/weight parameters,10253,8122 density 0.22756125710227273,0.1802645596590909
before tensor 131072 mask 39747.0 131072
layer3.0.conv1.weight, mask/weight parameters,39747,31068 density 0.47626294095092025,0.37226802147239263
before tensor 589824 mask 107981.0 589824
layer3.0.conv2.weight, mask/weight parameters,107981,83881 density 0.45157472576645297,0.350788931126919
before tensor 262144 mask 79110.0 262144
layer3.0.conv3.weight, mask/weight parameters,79110,63376 density 0.47396232745398775,0.3796970858895706
layer3.0.shortcut.0.weight, mask/weight parameters,132288,99185 density 0.2523193359375,0.1891803741455078
before tensor 262144 mask 44490.0 262144
layer3.1.conv1.weight, mask/weight parameters,44490,34206 density 0.26654764187116564,0.20493433665644173
before tensor 589824 mask 102469.0 589824
layer3.1.conv2.weight, mask/weight parameters,102469,77989 density 0.4285236344779421,0.326148686229984
before tensor 262144 mask 73112.0 262144
layer3.1.conv3.weight, mask/weight parameters,73112,57313 density 0.4380272239263804,0.3433725555981595
before tensor 262144 mask 55750.0 262144
layer3.2.conv1.weight, mask/weight parameters,55750,42680 density 0.3340083397239264,0.2557036042944785
before tensor 589824 mask 111757.0 589824
layer3.2.conv2.weight, mask/weight parameters,111757,86857 density 0.4673658942543733,0.3632345130707884
before tensor 262144 mask 77605.0 262144
layer3.2.conv3.weight, mask/weight parameters,77605,61058 density 0.4649456000766871,0.36580952837423314
before tensor 262144 mask 54202.0 262144
layer3.3.conv1.weight, mask/weight parameters,54202,40998 density 0.3247339915644172,0.24562643788343558
before tensor 589824 mask 89716.0 589824
layer3.3.conv2.weight, mask/weight parameters,89716,68051 density 0.3751908029825904,0.28458813738651145
before tensor 262144 mask 63214.0 262144
layer3.3.conv3.weight, mask/weight parameters,63214,48224 density 0.3787265145705521,0.28891871165644173
before tensor 262144 mask 52308.0 262144
layer3.4.conv1.weight, mask/weight parameters,52308,39956 density 0.3133866947852761,0.2393836273006135
before tensor 589824 mask 73788.0 589824
layer3.4.conv2.weight, mask/weight parameters,73788,53375 density 0.3085801748905366,0.2232133522358973
before tensor 262144 mask 51070.0 262144
layer3.4.conv3.weight, mask/weight parameters,51070,37312 density 0.30596961273006135,0.22354294478527606
before tensor 262144 mask 57021.0 262144
layer3.5.conv1.weight, mask/weight parameters,57021,41669 density 0.3416231307515337,0.2496465203220859
before tensor 589824 mask 69250.0 589824
layer3.5.conv2.weight, mask/weight parameters,69250,51911 density 0.28960233521940776,0.2170909288602841
before tensor 262144 mask 46691.0 262144
layer3.5.conv3.weight, mask/weight parameters,46691,34676 density 0.2797342312116564,0.2077501917177914
before tensor 524288 mask 174467.0 524288
layer4.0.conv1.weight, mask/weight parameters,174467,138697 density 0.5374698097397477,0.427275359818612
before tensor 2359296 mask 320393.0 2359296
layer4.0.conv2.weight, mask/weight parameters,320393,233816 density 0.3542598913535036,0.2585313373160799
before tensor 1048576 mask 146165.0 1048576
layer4.0.conv3.weight, mask/weight parameters,146165,101153 density 0.22514078519321767,0.15580792833201892
layer4.0.shortcut.0.weight, mask/weight parameters,232913,144447 density 0.11106157302856445,0.0688776969909668
before tensor 1048576 mask 109330.0 1048576
layer4.1.conv1.weight, mask/weight parameters,109330,76059 density 0.1684031200709779,0.11715515329258674
before tensor 2359296 mask 209723.0 2359296
layer4.1.conv2.weight, mask/weight parameters,209723,144614 density 0.23189160560415126,0.15990030970775132
before tensor 1048576 mask 106089.0 1048576
layer4.1.conv3.weight, mask/weight parameters,106089,69392 density 0.1634109448935331,0.10688584384858044
before tensor 1048576 mask 63243.0 1048576
layer4.2.conv1.weight, mask/weight parameters,63243,40622 density 0.09741441985410094,0.06257085469242903
before tensor 2359296 mask 81274.0 2359296
layer4.2.conv2.weight, mask/weight parameters,81274,47500 density 0.08986500457208695,0.05252095033066085
before tensor 1048576 mask 45281.0 1048576
layer4.2.conv3.weight, mask/weight parameters,45281,28361 density 0.06974720277996846,0.04368499852129337
classifier.weight, mask/weight parameters,108742,96568 density 0.530966796875,0.4715234375
Total Model parameters after dst: 3218562 2365205
Total parameters under density level of 0.1: 0.2410358267373342 0.1771285259001618 after dst
Death rate: 0.13607978863998121


Training summary: Average loss: 1.2956, Accuracy: 31467/50000 (62.934%)


Evaluation: Average loss: 1.7061, Accuracy: 5436/10000 (54.360%)

Current learning rate: 0.1. Time taken for epoch: 97.72 seconds.

Train Epoch: 46 [0/50000 (0%)]	Loss: 1.357430 Accuracy: 57/100 (57.000%
Train Epoch: 46 [10000/50000 (20%)]	Loss: 1.238644 Accuracy: 6413/10100 (63.495%
Train Epoch: 46 [20000/50000 (40%)]	Loss: 1.004166 Accuracy: 12703/20100 (63.199%
Train Epoch: 46 [30000/50000 (60%)]	Loss: 1.185182 Accuracy: 19016/30100 (63.176%
Train Epoch: 46 [40000/50000 (80%)]	Loss: 1.336115 Accuracy: 25286/40100 (63.057%
current layer rate 0.36987096040054623
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4844.0
Total filter_masks items: 10377620.0
4844.0 / 7552 channels
Total channels to prune: 85.26549294492543
Layer ('layer2', 0, 'conv1'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/88.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 5/317.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 5/317.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 5/317.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 5/317.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 5/317.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 5/317.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4782.0
Total filter_masks items: 10167701.0
After apply_mask:
Total filter_names items: 4782.0
Total filter_masks items: 10167701.0
Total pruned: 62/85.26549294492543 channels
===========done ===============

Training summary: Average loss: 1.2916, Accuracy: 31551/50000 (63.102%)


Evaluation: Average loss: 1.6646, Accuracy: 5422/10000 (54.220%)

Current learning rate: 0.1. Time taken for epoch: 97.60 seconds.

Train Epoch: 47 [0/50000 (0%)]	Loss: 1.445405 Accuracy: 64/100 (64.000%
Train Epoch: 47 [10000/50000 (20%)]	Loss: 1.149320 Accuracy: 6451/10100 (63.871%
Train Epoch: 47 [20000/50000 (40%)]	Loss: 1.383044 Accuracy: 12678/20100 (63.075%
Train Epoch: 47 [30000/50000 (60%)]	Loss: 1.315818 Accuracy: 18977/30100 (63.047%
Train Epoch: 47 [40000/50000 (80%)]	Loss: 1.051119 Accuracy: 25267/40100 (63.010%
current mest  death_rate 0.13498411458914245


dynamic sparse change prune
to kill 784426.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1415,1415 density 0.8188657407407407,0.8188657407407407
before tensor 4096 mask 849.0 4096
layer1.0.conv1.weight, mask/weight parameters,849,849 density 0.2822473404255319,0.2822473404255319
before tensor 36864 mask 3654.0 36864
layer1.0.conv2.weight, mask/weight parameters,3654,3654 density 0.18379357175192396,0.18379357175192396
before tensor 16384 mask 2654.0 16384
layer1.0.conv3.weight, mask/weight parameters,2654,2654 density 0.2205784574468085,0.2205784574468085
layer1.0.shortcut.0.weight, mask/weight parameters,6359,6359 density 0.38812255859375,0.38812255859375
before tensor 16384 mask 2833.0 16384
layer1.1.conv1.weight, mask/weight parameters,2833,2833 density 0.2354554521276596,0.2354554521276596
before tensor 36864 mask 4645.0 36864
layer1.1.conv2.weight, mask/weight parameters,4645,4645 density 0.23364015894572707,0.23364015894572707
before tensor 16384 mask 3139.0 16384
layer1.1.conv3.weight, mask/weight parameters,3139,3139 density 0.2608876329787234,0.2608876329787234
before tensor 16384 mask 2516.0 16384
layer1.2.conv1.weight, mask/weight parameters,2516,2516 density 0.2091090425531915,0.2091090425531915
before tensor 36864 mask 3156.0 36864
layer1.2.conv2.weight, mask/weight parameters,3156,3156 density 0.15874452995322166,0.15874452995322166
before tensor 16384 mask 2246.0 16384
layer1.2.conv3.weight, mask/weight parameters,2246,2246 density 0.18666888297872342,0.18666888297872342
before tensor 32768 mask 3827.0 32768
layer2.0.conv1.weight, mask/weight parameters,3827,3827 density 0.17183010057471265,0.17183010057471265
before tensor 147456 mask 9169.0 147456
layer2.0.conv2.weight, mask/weight parameters,9169,9169 density 0.13459872873269624,0.13459872873269624
before tensor 65536 mask 7016.0 65536
layer2.0.conv3.weight, mask/weight parameters,7016,7016 density 0.15750718390804597,0.15750718390804597
layer2.0.shortcut.0.weight, mask/weight parameters,30511,30511 density 0.23278045654296875,0.23278045654296875
before tensor 65536 mask 7505.0 65536
layer2.1.conv1.weight, mask/weight parameters,7505,7505 density 0.16848509339080459,0.16848509339080459
before tensor 147456 mask 13366.0 147456
layer2.1.conv2.weight, mask/weight parameters,13366,13366 density 0.1962096857063167,0.1962096857063167
before tensor 65536 mask 8304.0 65536
layer2.1.conv3.weight, mask/weight parameters,8304,8304 density 0.18642241379310345,0.18642241379310345
before tensor 65536 mask 9902.0 65536
layer2.2.conv1.weight, mask/weight parameters,9902,9902 density 0.22229705459770116,0.22229705459770116
before tensor 147456 mask 19759.0 147456
layer2.2.conv2.weight, mask/weight parameters,19759,19759 density 0.2900573978655627,0.2900573978655627
before tensor 65536 mask 12100.0 65536
layer2.2.conv3.weight, mask/weight parameters,12100,12100 density 0.27164152298850575,0.27164152298850575
before tensor 65536 mask 8459.0 65536
layer2.3.conv1.weight, mask/weight parameters,8459,8459 density 0.18990211925287356,0.18990211925287356
before tensor 147456 mask 13998.0 147456
layer2.3.conv2.weight, mask/weight parameters,13998,13998 density 0.20548729466684282,0.20548729466684282
before tensor 65536 mask 7813.0 65536
layer2.3.conv3.weight, mask/weight parameters,7813,7813 density 0.17539960488505746,0.17539960488505746
before tensor 131072 mask 30398.0 131072
layer3.0.conv1.weight, mask/weight parameters,30398,30398 density 0.36876455745341613,0.36876455745341613
before tensor 589824 mask 82869.0 589824
layer3.0.conv2.weight, mask/weight parameters,82869,82869 density 0.3552203490091689,0.3552203490091689
before tensor 262144 mask 63048.0 262144
layer3.0.conv3.weight, mask/weight parameters,63048,63048 density 0.38242430124223603,0.38242430124223603
layer3.0.shortcut.0.weight, mask/weight parameters,98462,98462 density 0.18780136108398438,0.18780136108398438
before tensor 262144 mask 33513.0 262144
layer3.1.conv1.weight, mask/weight parameters,33513,33513 density 0.20327664013975155,0.20327664013975155
before tensor 589824 mask 76426.0 589824
layer3.1.conv2.weight, mask/weight parameters,76426,76426 density 0.32760224442644104,0.32760224442644104
before tensor 262144 mask 56736.0 262144
layer3.1.conv3.weight, mask/weight parameters,56736,56736 density 0.34413819875776397,0.34413819875776397
before tensor 262144 mask 41817.0 262144
layer3.2.conv1.weight, mask/weight parameters,41817,41817 density 0.25364542895962733,0.25364542895962733
before tensor 589824 mask 85543.0 589824
layer3.2.conv2.weight, mask/weight parameters,85543,85543 density 0.3666825268229535,0.3666825268229535
before tensor 262144 mask 60811.0 262144
layer3.2.conv3.weight, mask/weight parameters,60811,60811 density 0.3688555415372671,0.3688555415372671
before tensor 262144 mask 40431.0 262144
layer3.3.conv1.weight, mask/weight parameters,40431,40431 density 0.24523849961180125,0.24523849961180125
before tensor 589824 mask 67478.0 589824
layer3.3.conv2.weight, mask/weight parameters,67478,67478 density 0.28924638538465164,0.28924638538465164
before tensor 262144 mask 47957.0 262144
layer3.3.conv3.weight, mask/weight parameters,47957,47957 density 0.2908882472826087,0.2908882472826087
before tensor 262144 mask 39050.0 262144
layer3.4.conv1.weight, mask/weight parameters,39050,39050 density 0.23686189829192547,0.23686189829192547
before tensor 589824 mask 53639.0 589824
layer3.4.conv2.weight, mask/weight parameters,53639,53639 density 0.22992511434315377,0.22992511434315377
before tensor 262144 mask 37573.0 262144
layer3.4.conv3.weight, mask/weight parameters,37573,37573 density 0.22790299883540371,0.22790299883540371
before tensor 262144 mask 42347.0 262144
layer3.5.conv1.weight, mask/weight parameters,42347,42347 density 0.25686019992236025,0.25686019992236025
before tensor 589824 mask 50815.0 589824
layer3.5.conv2.weight, mask/weight parameters,50815,50815 density 0.2178199572204433,0.2178199572204433
before tensor 262144 mask 34800.0 262144
layer3.5.conv3.weight, mask/weight parameters,34800,34800 density 0.2110830745341615,0.2110830745341615
before tensor 524288 mask 139448.0 524288
layer4.0.conv1.weight, mask/weight parameters,139448,139448 density 0.4364733573717949,0.4364733573717949
before tensor 2359296 mask 234222.0 2359296
layer4.0.conv2.weight, mask/weight parameters,234222,234222 density 0.2673474139820294,0.2673474139820294
before tensor 1048576 mask 101783.0 1048576
layer4.0.conv3.weight, mask/weight parameters,101783,101783 density 0.15929080278445512,0.15929080278445512
layer4.0.shortcut.0.weight, mask/weight parameters,149132,149132 density 0.07111167907714844,0.07111167907714844
before tensor 1048576 mask 77420.0 1048576
layer4.1.conv1.weight, mask/weight parameters,77420,77420 density 0.12116261017628205,0.12116261017628205
before tensor 2359296 mask 148004.0 2359296
layer4.1.conv2.weight, mask/weight parameters,148004,148004 density 0.16893582438454233,0.16893582438454233
before tensor 1048576 mask 71400.0 1048576
layer4.1.conv3.weight, mask/weight parameters,71400,71400 density 0.1117412860576923,0.1117412860576923
before tensor 1048576 mask 41870.0 1048576
layer4.2.conv1.weight, mask/weight parameters,41870,41870 density 0.06552671774839744,0.06552671774839744
before tensor 2359296 mask 47561.0 2359296
layer4.2.conv2.weight, mask/weight parameters,47561,47561 density 0.05428742968807072,0.05428742968807072
before tensor 1048576 mask 28314.0 1048576
layer4.2.conv3.weight, mask/weight parameters,28314,28314 density 0.0443115234375,0.0443115234375
classifier.weight, mask/weight parameters,97143,97143 density 0.4743310546875,0.4743310546875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.17995758238622855 0.17995758238622855 after dst
Death rate: 0.13498411458914245

dynamic sparse change grow
self.total_params*pruning_rate 3192648.597754064
self.total_nonzero 2365205.0
to grow 827443.597754064
len(all_scores) 13143125 9966295
increse 827443.0 before_mask 3192647.0 after_mask 3192647.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1520,1415 density 0.8796296296296297,0.8188657407407407
before tensor 4096 mask 948.0 4096
layer1.0.conv1.weight, mask/weight parameters,948,849 density 0.3151595744680851,0.2822473404255319
before tensor 36864 mask 4220.0 36864
layer1.0.conv2.weight, mask/weight parameters,4220,3654 density 0.21226296463960564,0.18379357175192396
before tensor 16384 mask 3292.0 16384
layer1.0.conv3.weight, mask/weight parameters,3292,2654 density 0.2736037234042553,0.2205784574468085
layer1.0.shortcut.0.weight, mask/weight parameters,7462,6359 density 0.4554443359375,0.38812255859375
before tensor 16384 mask 3326.0 16384
layer1.1.conv1.weight, mask/weight parameters,3326,2833 density 0.27642952127659576,0.2354554521276596
before tensor 36864 mask 5544.0 36864
layer1.1.conv2.weight, mask/weight parameters,5544,4645 density 0.27885921231326394,0.23364015894572707
before tensor 16384 mask 4034.0 16384
layer1.1.conv3.weight, mask/weight parameters,4034,3139 density 0.33527260638297873,0.2608876329787234
before tensor 16384 mask 3481.0 16384
layer1.2.conv1.weight, mask/weight parameters,3481,2516 density 0.289311835106383,0.2091090425531915
before tensor 36864 mask 4037.0 36864
layer1.2.conv2.weight, mask/weight parameters,4037,3156 density 0.20305819626779337,0.15874452995322166
before tensor 16384 mask 3121.0 16384
layer1.2.conv3.weight, mask/weight parameters,3121,2246 density 0.2593916223404255,0.18666888297872342
before tensor 32768 mask 5339.0 32768
layer2.0.conv1.weight, mask/weight parameters,5339,3827 density 0.23971803160919541,0.17183010057471265
before tensor 147456 mask 11258.0 147456
layer2.0.conv2.weight, mask/weight parameters,11258,9169 density 0.1652647494898783,0.13459872873269624
before tensor 65536 mask 8969.0 65536
layer2.0.conv3.weight, mask/weight parameters,8969,7016 density 0.20135147270114942,0.15750718390804597
layer2.0.shortcut.0.weight, mask/weight parameters,39688,30511 density 0.30279541015625,0.23278045654296875
before tensor 65536 mask 9352.0 65536
layer2.1.conv1.weight, mask/weight parameters,9352,7505 density 0.20994971264367815,0.16848509339080459
before tensor 147456 mask 17826.0 147456
layer2.1.conv2.weight, mask/weight parameters,17826,13366 density 0.26168141982648524,0.1962096857063167
before tensor 65536 mask 11322.0 65536
layer2.1.conv3.weight, mask/weight parameters,11322,8304 density 0.25417564655172414,0.18642241379310345
before tensor 65536 mask 13067.0 65536
layer2.2.conv1.weight, mask/weight parameters,13067,9902 density 0.29335039511494254,0.22229705459770116
before tensor 147456 mask 25311.0 147456
layer2.2.conv2.weight, mask/weight parameters,25311,19759 density 0.37155943101246314,0.2900573978655627
before tensor 65536 mask 15901.0 65536
layer2.2.conv3.weight, mask/weight parameters,15901,12100 density 0.35697288074712646,0.27164152298850575
before tensor 65536 mask 12172.0 65536
layer2.3.conv1.weight, mask/weight parameters,12172,8459 density 0.27325790229885055,0.18990211925287356
before tensor 147456 mask 17765.0 147456
layer2.3.conv2.weight, mask/weight parameters,17765,13998 density 0.2607859544046623,0.20548729466684282
before tensor 65536 mask 10225.0 65536
layer2.3.conv3.weight, mask/weight parameters,10225,7813 density 0.2295483117816092,0.17539960488505746
before tensor 131072 mask 39905.0 131072
layer3.0.conv1.weight, mask/weight parameters,39905,30398 density 0.48409598214285715,0.36876455745341613
before tensor 589824 mask 108843.0 589824
layer3.0.conv2.weight, mask/weight parameters,108843,82869 density 0.46655864614276715,0.3552203490091689
before tensor 262144 mask 78442.0 262144
layer3.0.conv3.weight, mask/weight parameters,78442,63048 density 0.47579823369565216,0.38242430124223603
layer3.0.shortcut.0.weight, mask/weight parameters,133352,98462 density 0.2543487548828125,0.18780136108398438
before tensor 262144 mask 44059.0 262144
layer3.1.conv1.weight, mask/weight parameters,44059,33513 density 0.26724451669254656,0.20327664013975155
before tensor 589824 mask 101828.0 589824
layer3.1.conv2.weight, mask/weight parameters,101828,76426 density 0.43648864712866875,0.32760224442644104
before tensor 262144 mask 71444.0 262144
layer3.1.conv3.weight, mask/weight parameters,71444,56736 density 0.4333511257763975,0.34413819875776397
before tensor 262144 mask 53231.0 262144
layer3.2.conv1.weight, mask/weight parameters,53231,41817 density 0.3228782511645963,0.25364542895962733
before tensor 589824 mask 108494.0 589824
layer3.2.conv2.weight, mask/weight parameters,108494,85543 density 0.465062647617333,0.3666825268229535
before tensor 262144 mask 75969.0 262144
layer3.2.conv3.weight, mask/weight parameters,75969,60811 density 0.46079799107142855,0.3688555415372671
before tensor 262144 mask 53276.0 262144
layer3.3.conv1.weight, mask/weight parameters,53276,40431 density 0.32315120341614906,0.24523849961180125
before tensor 589824 mask 89964.0 589824
layer3.3.conv2.weight, mask/weight parameters,89964,67478 density 0.3856332703213611,0.28924638538465164
before tensor 262144 mask 62766.0 262144
layer3.3.conv3.weight, mask/weight parameters,62766,47957 density 0.3807138004658385,0.2908882472826087
before tensor 262144 mask 49477.0 262144
layer3.4.conv1.weight, mask/weight parameters,49477,39050 density 0.3001079677795031,0.23686189829192547
before tensor 589824 mask 67963.0 589824
layer3.4.conv2.weight, mask/weight parameters,67963,53639 density 0.2913253518168452,0.22992511434315377
before tensor 262144 mask 48790.0 262144
layer3.4.conv3.weight, mask/weight parameters,48790,37573 density 0.29594089673913043,0.22790299883540371
before tensor 262144 mask 54163.0 262144
layer3.5.conv1.weight, mask/weight parameters,54163,42347 density 0.32853139557453415,0.25686019992236025
before tensor 589824 mask 66299.0 589824
layer3.5.conv2.weight, mask/weight parameters,66299,50815 density 0.28419256801649456,0.2178199572204433
before tensor 262144 mask 45812.0 262144
layer3.5.conv3.weight, mask/weight parameters,45812,34800 density 0.27787752329192544,0.2110830745341615
before tensor 524288 mask 173761.0 524288
layer4.0.conv1.weight, mask/weight parameters,173761,139448 density 0.5438733223157052,0.4364733573717949
before tensor 2359296 mask 324110.0 2359296
layer4.0.conv2.weight, mask/weight parameters,324110,234222 density 0.36994804222368327,0.2673474139820294
before tensor 1048576 mask 149340.0 1048576
layer4.0.conv3.weight, mask/weight parameters,149340,101783 density 0.23371769831730768,0.15929080278445512
layer4.0.shortcut.0.weight, mask/weight parameters,230363,149132 density 0.10984563827514648,0.07111167907714844
before tensor 1048576 mask 110027.0 1048576
layer4.1.conv1.weight, mask/weight parameters,110027,77420 density 0.1721926958133013,0.12116261017628205
before tensor 2359296 mask 207147.0 2359296
layer4.1.conv2.weight, mask/weight parameters,207147,148004 density 0.23644326649134342,0.16893582438454233
before tensor 1048576 mask 104206.0 1048576
layer4.1.conv3.weight, mask/weight parameters,104206,71400 density 0.16308280749198717,0.1117412860576923
before tensor 1048576 mask 64821.0 1048576
layer4.2.conv1.weight, mask/weight parameters,64821,41870 density 0.10144512469951923,0.06552671774839744
before tensor 2359296 mask 80794.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80794,47561 density 0.09222048725253854,0.05428742968807072
before tensor 1048576 mask 45372.0 1048576
layer4.2.conv3.weight, mask/weight parameters,45372,28314 density 0.07100736177884616,0.0443115234375
classifier.weight, mask/weight parameters,109449,97143 density 0.5344189453125,0.4743310546875
Total Model parameters after dst: 3192647 2365205
Total parameters under density level of 0.1: 0.24291384278853012 0.17995758238622855 after dst
Death rate: 0.13498411458914245


Training summary: Average loss: 1.2918, Accuracy: 31417/50000 (62.834%)


Evaluation: Average loss: 1.5845, Accuracy: 5721/10000 (57.210%)

Current learning rate: 0.1. Time taken for epoch: 97.03 seconds.

Train Epoch: 48 [0/50000 (0%)]	Loss: 1.153610 Accuracy: 71/100 (71.000%
Train Epoch: 48 [10000/50000 (20%)]	Loss: 0.859157 Accuracy: 6550/10100 (64.851%
Train Epoch: 48 [20000/50000 (40%)]	Loss: 1.159801 Accuracy: 12794/20100 (63.652%
Train Epoch: 48 [30000/50000 (60%)]	Loss: 1.444965 Accuracy: 19096/30100 (63.442%
Train Epoch: 48 [40000/50000 (80%)]	Loss: 1.185097 Accuracy: 25385/40100 (63.304%
current layer rate 0.379053026854802
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4782.0
Total filter_masks items: 10167701.0
4782.0 / 7552 channels
Total channels to prune: 92.60845880746456
Layer ('layer2', 0, 'conv1'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/87.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/312.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/312.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/312.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/312.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/312.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/312.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4702.0
Total filter_masks items: 9902927.0
After apply_mask:
Total filter_names items: 4702.0
Total filter_masks items: 9902927.0
Total pruned: 80/92.60845880746456 channels
===========done ===============

Training summary: Average loss: 1.2808, Accuracy: 31622/50000 (63.244%)


Evaluation: Average loss: 1.7253, Accuracy: 5272/10000 (52.720%)

Current learning rate: 0.1. Time taken for epoch: 97.14 seconds.

Train Epoch: 49 [0/50000 (0%)]	Loss: 1.420934 Accuracy: 59/100 (59.000%
Train Epoch: 49 [10000/50000 (20%)]	Loss: 1.223688 Accuracy: 6465/10100 (64.010%
Train Epoch: 49 [20000/50000 (40%)]	Loss: 1.228630 Accuracy: 12779/20100 (63.577%
Train Epoch: 49 [30000/50000 (60%)]	Loss: 1.469161 Accuracy: 19120/30100 (63.522%
Train Epoch: 49 [40000/50000 (80%)]	Loss: 1.241008 Accuracy: 25477/40100 (63.534%
current mest  death_rate 0.1338651221760631


dynamic sparse change prune
to kill 734423.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1402,1402 density 0.8113425925925926,0.8113425925925926
before tensor 4096 mask 818.0 4096
layer1.0.conv1.weight, mask/weight parameters,818,818 density 0.27194148936170215,0.27194148936170215
before tensor 36864 mask 3552.0 36864
layer1.0.conv2.weight, mask/weight parameters,3552,3552 density 0.1786630451184548,0.1786630451184548
before tensor 16384 mask 2622.0 16384
layer1.0.conv3.weight, mask/weight parameters,2622,2622 density 0.21791888297872342,0.21791888297872342
layer1.0.shortcut.0.weight, mask/weight parameters,6331,6331 density 0.38641357421875,0.38641357421875
before tensor 16384 mask 2659.0 16384
layer1.1.conv1.weight, mask/weight parameters,2659,2659 density 0.2209940159574468,0.2209940159574468
before tensor 36864 mask 4612.0 36864
layer1.1.conv2.weight, mask/weight parameters,4612,4612 density 0.23198028268195764,0.23198028268195764
before tensor 16384 mask 3071.0 16384
layer1.1.conv3.weight, mask/weight parameters,3071,3071 density 0.25523603723404253,0.25523603723404253
before tensor 16384 mask 2571.0 16384
layer1.2.conv1.weight, mask/weight parameters,2571,2571 density 0.21368018617021275,0.21368018617021275
before tensor 36864 mask 3298.0 36864
layer1.2.conv2.weight, mask/weight parameters,3298,3298 density 0.16588702781550224,0.16588702781550224
before tensor 16384 mask 2348.0 16384
layer1.2.conv3.weight, mask/weight parameters,2348,2348 density 0.19514627659574468,0.19514627659574468
before tensor 32768 mask 3858.0 32768
layer2.0.conv1.weight, mask/weight parameters,3858,3858 density 0.17523619186046513,0.17523619186046513
before tensor 147456 mask 9333.0 147456
layer2.0.conv2.weight, mask/weight parameters,9333,9333 density 0.1402109248242293,0.1402109248242293
before tensor 65536 mask 6980.0 65536
layer2.0.conv3.weight, mask/weight parameters,6980,6980 density 0.15852107558139536,0.15852107558139536
layer2.0.shortcut.0.weight, mask/weight parameters,30219,30219 density 0.23055267333984375,0.23055267333984375
before tensor 65536 mask 7268.0 65536
layer2.1.conv1.weight, mask/weight parameters,7268,7268 density 0.16506177325581395,0.16506177325581395
before tensor 147456 mask 13238.0 147456
layer2.1.conv2.weight, mask/weight parameters,13238,13238 density 0.19887626945496065,0.19887626945496065
before tensor 65536 mask 8309.0 65536
layer2.1.conv3.weight, mask/weight parameters,8309,8309 density 0.18870367005813954,0.18870367005813954
before tensor 65536 mask 9952.0 65536
layer2.2.conv1.weight, mask/weight parameters,9952,9952 density 0.22601744186046513,0.22601744186046513
before tensor 147456 mask 20044.0 147456
layer2.2.conv2.weight, mask/weight parameters,20044,20044 density 0.3011237305450394,0.3011237305450394
before tensor 65536 mask 12318.0 65536
layer2.2.conv3.weight, mask/weight parameters,12318,12318 density 0.2797510901162791,0.2797510901162791
before tensor 65536 mask 9001.0 65536
layer2.3.conv1.weight, mask/weight parameters,9001,9001 density 0.20441951308139536,0.20441951308139536
before tensor 147456 mask 14363.0 147456
layer2.3.conv2.weight, mask/weight parameters,14363,14363 density 0.21577729703743764,0.21577729703743764
before tensor 65536 mask 7943.0 65536
layer2.3.conv3.weight, mask/weight parameters,7943,7943 density 0.18039153343023256,0.18039153343023256
before tensor 131072 mask 30837.0 131072
layer3.0.conv1.weight, mask/weight parameters,30837,30837 density 0.3811931368670886,0.3811931368670886
before tensor 589824 mask 82882.0 589824
layer3.0.conv2.weight, mask/weight parameters,82882,82882 density 0.36889565418647297,0.36889565418647297
before tensor 262144 mask 62935.0 262144
layer3.0.conv3.weight, mask/weight parameters,62935,62935 density 0.3889870945411392,0.3889870945411392
layer3.0.shortcut.0.weight, mask/weight parameters,100831,100831 density 0.1923198699951172,0.1923198699951172
before tensor 262144 mask 33218.0 262144
layer3.1.conv1.weight, mask/weight parameters,33218,33218 density 0.2053129944620253,0.2053129944620253
before tensor 589824 mask 75949.0 589824
layer3.1.conv2.weight, mask/weight parameters,75949,75949 density 0.3380378856664708,0.3380378856664708
before tensor 262144 mask 56262.0 262144
layer3.1.conv3.weight, mask/weight parameters,56262,56262 density 0.3477427808544304,0.3477427808544304
before tensor 262144 mask 40676.0 262144
layer3.2.conv1.weight, mask/weight parameters,40676,40676 density 0.2514092167721519,0.2514092167721519
before tensor 589824 mask 83603.0 589824
layer3.2.conv2.weight, mask/weight parameters,83603,83603 density 0.3721047196852356,0.3721047196852356
before tensor 262144 mask 59702.0 262144
layer3.2.conv3.weight, mask/weight parameters,59702,59702 density 0.369004647943038,0.369004647943038
before tensor 262144 mask 39682.0 262144
layer3.3.conv1.weight, mask/weight parameters,39682,39682 density 0.24526552610759494,0.24526552610759494
before tensor 589824 mask 66970.0 589824
layer3.3.conv2.weight, mask/weight parameters,66970,66970 density 0.29807367053000766,0.29807367053000766
before tensor 262144 mask 47828.0 262144
layer3.3.conv3.weight, mask/weight parameters,47828,47828 density 0.29561412183544306,0.29561412183544306
before tensor 262144 mask 37671.0 262144
layer3.4.conv1.weight, mask/weight parameters,37671,37671 density 0.23283598694620253,0.23283598694620253
before tensor 589824 mask 50748.0 589824
layer3.4.conv2.weight, mask/weight parameters,50748,50748 density 0.2258719222346846,0.2258719222346846
before tensor 262144 mask 36818.0 262144
layer3.4.conv3.weight, mask/weight parameters,36818,36818 density 0.22756378560126583,0.22756378560126583
before tensor 262144 mask 40891.0 262144
layer3.5.conv1.weight, mask/weight parameters,40891,40891 density 0.2527380834651899,0.2527380834651899
before tensor 589824 mask 49046.0 589824
layer3.5.conv2.weight, mask/weight parameters,49046,49046 density 0.2182965692819883,0.2182965692819883
before tensor 262144 mask 34293.0 262144
layer3.5.conv3.weight, mask/weight parameters,34293,34293 density 0.2119573279272152,0.2119573279272152
before tensor 524288 mask 139214.0 524288
layer4.0.conv1.weight, mask/weight parameters,139214,139214 density 0.4442848754084967,0.4442848754084967
before tensor 2359296 mask 237093.0 2359296
layer4.0.conv2.weight, mask/weight parameters,237093,237093 density 0.2813412220371082,0.2813412220371082
before tensor 1048576 mask 104272.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104272,104272 density 0.1663858251633987,0.1663858251633987
layer4.0.shortcut.0.weight, mask/weight parameters,152183,152183 density 0.07256650924682617,0.07256650924682617
before tensor 1048576 mask 78439.0 1048576
layer4.1.conv1.weight, mask/weight parameters,78439,78439 density 0.12516435610702614,0.12516435610702614
before tensor 2359296 mask 147034.0 2359296
layer4.1.conv2.weight, mask/weight parameters,147034,147034 density 0.17447467972906908,0.17447467972906908
before tensor 1048576 mask 71097.0 1048576
layer4.1.conv3.weight, mask/weight parameters,71097,71097 density 0.1134487974877451,0.1134487974877451
before tensor 1048576 mask 43281.0 1048576
layer4.2.conv1.weight, mask/weight parameters,43281,43281 density 0.06906307444852941,0.06906307444852941
before tensor 2359296 mask 48914.0 2359296
layer4.2.conv2.weight, mask/weight parameters,48914,48914 density 0.058042728105524466,0.058042728105524466
before tensor 1048576 mask 28546.0 1048576
layer4.2.conv3.weight, mask/weight parameters,28546,28546 density 0.045550577001633986,0.045550577001633986
classifier.weight, mask/weight parameters,98180,98180 density 0.47939453125,0.47939453125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.18365744185726884 0.18365744185726884 after dst
Death rate: 0.1338651221760631

dynamic sparse change grow
self.total_params*pruning_rate 3166182.1533921543
self.total_nonzero 2365205.0
to grow 800977.1533921543
len(all_scores) 12878351 9668234
increse 800977.0 before_mask 3166181.0 after_mask 3166181.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1533,1402 density 0.8871527777777778,0.8113425925925926
before tensor 4096 mask 974.0 4096
layer1.0.conv1.weight, mask/weight parameters,974,818 density 0.3238031914893617,0.27194148936170215
before tensor 36864 mask 4538.0 36864
layer1.0.conv2.weight, mask/weight parameters,4538,3552 density 0.2282581359086565,0.1786630451184548
before tensor 16384 mask 3451.0 16384
layer1.0.conv3.weight, mask/weight parameters,3451,2622 density 0.28681848404255317,0.21791888297872342
layer1.0.shortcut.0.weight, mask/weight parameters,7891,6331 density 0.48162841796875,0.38641357421875
before tensor 16384 mask 3475.0 16384
layer1.1.conv1.weight, mask/weight parameters,3475,2659 density 0.288813164893617,0.2209940159574468
before tensor 36864 mask 5974.0 36864
layer1.1.conv2.weight, mask/weight parameters,5974,4612 density 0.3004879030229868,0.23198028268195764
before tensor 16384 mask 3760.0 16384
layer1.1.conv3.weight, mask/weight parameters,3760,3071 density 0.3125,0.25523603723404253
before tensor 16384 mask 3349.0 16384
layer1.2.conv1.weight, mask/weight parameters,3349,2571 density 0.2783410904255319,0.21368018617021275
before tensor 36864 mask 4016.0 36864
layer1.2.conv2.weight, mask/weight parameters,4016,3298 density 0.20200191137266738,0.16588702781550224
before tensor 16384 mask 3329.0 16384
layer1.2.conv3.weight, mask/weight parameters,3329,2348 density 0.27667885638297873,0.19514627659574468
before tensor 32768 mask 5105.0 32768
layer2.0.conv1.weight, mask/weight parameters,5105,3858 density 0.23187681686046513,0.17523619186046513
before tensor 147456 mask 10589.0 147456
layer2.0.conv2.weight, mask/weight parameters,10589,9333 density 0.15907998317408809,0.1402109248242293
before tensor 65536 mask 8964.0 65536
layer2.0.conv3.weight, mask/weight parameters,8964,6980 density 0.20357921511627908,0.15852107558139536
layer2.0.shortcut.0.weight, mask/weight parameters,43070,30219 density 0.3285980224609375,0.23055267333984375
before tensor 65536 mask 10150.0 65536
layer2.1.conv1.weight, mask/weight parameters,10150,7268 density 0.2305141715116279,0.16506177325581395
before tensor 147456 mask 18493.0 147456
layer2.1.conv2.weight, mask/weight parameters,18493,13238 density 0.2778228471846644,0.19887626945496065
before tensor 65536 mask 11604.0 65536
layer2.1.conv3.weight, mask/weight parameters,11604,8309 density 0.26353561046511625,0.18870367005813954
before tensor 65536 mask 12995.0 65536
layer2.2.conv1.weight, mask/weight parameters,12995,9952 density 0.2951262718023256,0.22601744186046513
before tensor 147456 mask 25664.0 147456
layer2.2.conv2.weight, mask/weight parameters,25664,20044 density 0.3855537527792801,0.3011237305450394
before tensor 65536 mask 16001.0 65536
layer2.2.conv3.weight, mask/weight parameters,16001,12318 density 0.36339480377906974,0.2797510901162791
before tensor 65536 mask 11864.0 65536
layer2.3.conv1.weight, mask/weight parameters,11864,9001 density 0.2694404069767442,0.20441951308139536
before tensor 147456 mask 17788.0 147456
layer2.3.conv2.weight, mask/weight parameters,17788,14363 density 0.2672315365663121,0.21577729703743764
before tensor 65536 mask 9847.0 65536
layer2.3.conv3.weight, mask/weight parameters,9847,7943 density 0.2236328125,0.18039153343023256
before tensor 131072 mask 40447.0 131072
layer3.0.conv1.weight, mask/weight parameters,40447,30837 density 0.4999876384493671,0.3811931368670886
before tensor 589824 mask 108368.0 589824
layer3.0.conv2.weight, mask/weight parameters,108368,82882 density 0.48233011091527356,0.36889565418647297
before tensor 262144 mask 78278.0 262144
layer3.0.conv3.weight, mask/weight parameters,78278,62935 density 0.483818730221519,0.3889870945411392
layer3.0.shortcut.0.weight, mask/weight parameters,136140,100831 density 0.25966644287109375,0.1923198699951172
before tensor 262144 mask 45391.0 262144
layer3.1.conv1.weight, mask/weight parameters,45391,33218 density 0.2805515723892405,0.2053129944620253
before tensor 589824 mask 100113.0 589824
layer3.1.conv2.weight, mask/weight parameters,100113,75949 density 0.44558831383859426,0.3380378856664708
before tensor 262144 mask 71554.0 262144
layer3.1.conv3.weight, mask/weight parameters,71554,56262 density 0.4422591969936709,0.3477427808544304
before tensor 262144 mask 54280.0 262144
layer3.2.conv1.weight, mask/weight parameters,54280,40676 density 0.33549248417721517,0.2514092167721519
before tensor 589824 mask 106620.0 589824
layer3.2.conv2.weight, mask/weight parameters,106620,83603 density 0.47455001869358543,0.3721047196852356
before tensor 262144 mask 75657.0 262144
layer3.2.conv3.weight, mask/weight parameters,75657,59702 density 0.4676189181170886,0.369004647943038
before tensor 262144 mask 51613.0 262144
layer3.3.conv1.weight, mask/weight parameters,51613,39682 density 0.31900835640822783,0.24526552610759494
before tensor 589824 mask 86855.0 589824
layer3.3.conv2.weight, mask/weight parameters,86855,66970 density 0.3865788958322206,0.29807367053000766
before tensor 262144 mask 61647.0 262144
layer3.3.conv3.weight, mask/weight parameters,61647,47828 density 0.3810262559335443,0.29561412183544306
before tensor 262144 mask 52265.0 262144
layer3.4.conv1.weight, mask/weight parameters,52265,37671 density 0.32303822191455694,0.23283598694620253
before tensor 589824 mask 71687.0 589824
layer3.4.conv2.weight, mask/weight parameters,71687,50748 density 0.31906834730901384,0.2258719222346846
before tensor 262144 mask 48800.0 262144
layer3.4.conv3.weight, mask/weight parameters,48800,36818 density 0.301621835443038,0.22756378560126583
before tensor 262144 mask 53141.0 262144
layer3.5.conv1.weight, mask/weight parameters,53141,40891 density 0.32845258109177217,0.2527380834651899
before tensor 589824 mask 66608.0 589824
layer3.5.conv2.weight, mask/weight parameters,66608,49046 density 0.29646246150011574,0.2182965692819883
before tensor 262144 mask 45220.0 262144
layer3.5.conv3.weight, mask/weight parameters,45220,34293 density 0.27949465981012656,0.2119573279272152
before tensor 524288 mask 171942.0 524288
layer4.0.conv1.weight, mask/weight parameters,171942,139214 density 0.5487323835784313,0.4442848754084967
before tensor 2359296 mask 317717.0 2359296
layer4.0.conv2.weight, mask/weight parameters,317717,237093 density 0.3770119279859124,0.2813412220371082
before tensor 1048576 mask 145092.0 1048576
layer4.0.conv3.weight, mask/weight parameters,145092,104272 density 0.23152190563725492,0.1663858251633987
layer4.0.shortcut.0.weight, mask/weight parameters,225631,152183 density 0.1075892448425293,0.07256650924682617
before tensor 1048576 mask 109819.0 1048576
layer4.1.conv1.weight, mask/weight parameters,109819,78439 density 0.1752371195874183,0.12516435610702614
before tensor 2359296 mask 198198.0 2359296
layer4.1.conv2.weight, mask/weight parameters,198198,147034 density 0.23518732111581017,0.17447467972906908
before tensor 1048576 mask 99474.0 1048576
layer4.1.conv3.weight, mask/weight parameters,99474,71097 density 0.15872970281862744,0.1134487974877451
before tensor 1048576 mask 67285.0 1048576
layer4.2.conv1.weight, mask/weight parameters,67285,43281 density 0.1073660258374183,0.06906307444852941
before tensor 2359296 mask 78068.0 2359296
layer4.2.conv2.weight, mask/weight parameters,78068,48914 density 0.09263768446134203,0.058042728105524466
before tensor 1048576 mask 44941.0 1048576
layer4.2.conv3.weight, mask/weight parameters,44941,28546 density 0.07171192044526144,0.045550577001633986
classifier.weight, mask/weight parameters,108906,98180 density 0.531767578125,0.47939453125
Total Model parameters after dst: 3166181 2365205
Total parameters under density level of 0.1: 0.2458529822645772 0.18365744185726884 after dst
Death rate: 0.1338651221760631


Training summary: Average loss: 1.2851, Accuracy: 31701/50000 (63.402%)


Evaluation: Average loss: 1.6082, Accuracy: 5604/10000 (56.040%)

Current learning rate: 0.1. Time taken for epoch: 98.28 seconds.

Train Epoch: 50 [0/50000 (0%)]	Loss: 1.391388 Accuracy: 62/100 (62.000%
Train Epoch: 50 [10000/50000 (20%)]	Loss: 1.438340 Accuracy: 6558/10100 (64.931%
Train Epoch: 50 [20000/50000 (40%)]	Loss: 1.103534 Accuracy: 12898/20100 (64.169%
Train Epoch: 50 [30000/50000 (60%)]	Loss: 1.152042 Accuracy: 19174/30100 (63.701%
Train Epoch: 50 [40000/50000 (80%)]	Loss: 1.056436 Accuracy: 25483/40100 (63.549%
current layer rate 0.38779267182521615
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4702.0
Total filter_masks items: 9902927.0
4702.0 / 7552 channels
Total channels to prune: 78.61025762403278
Layer ('layer2', 0, 'conv1'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/86.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 5/306.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 5/306.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 5/306.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 5/306.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 5/306.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 5/306.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4640.0
Total filter_masks items: 9697202.0
After apply_mask:
Total filter_names items: 4640.0
Total filter_masks items: 9697202.0
Total pruned: 62/78.61025762403278 channels
===========done ===============

Training summary: Average loss: 1.2916, Accuracy: 31567/50000 (63.134%)


Evaluation: Average loss: 1.5542, Accuracy: 5701/10000 (57.010%)

Current learning rate: 0.1. Time taken for epoch: 97.90 seconds.

Train Epoch: 51 [0/50000 (0%)]	Loss: 1.068306 Accuracy: 70/100 (70.000%
Train Epoch: 51 [10000/50000 (20%)]	Loss: 1.342141 Accuracy: 6524/10100 (64.594%
Train Epoch: 51 [20000/50000 (40%)]	Loss: 1.208637 Accuracy: 12866/20100 (64.010%
Train Epoch: 51 [30000/50000 (60%)]	Loss: 1.300548 Accuracy: 19150/30100 (63.621%
Train Epoch: 51 [40000/50000 (80%)]	Loss: 1.194348 Accuracy: 25434/40100 (63.426%
current mest  death_rate 0.13272542485937322


dynamic sparse change prune
to kill 733591.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1416,1416 density 0.8194444444444444,0.8194444444444444
before tensor 4096 mask 801.0 4096
layer1.0.conv1.weight, mask/weight parameters,801,801 density 0.26628989361702127,0.26628989361702127
before tensor 36864 mask 3676.0 36864
layer1.0.conv2.weight, mask/weight parameters,3676,3676 density 0.18490015592777023,0.18490015592777023
before tensor 16384 mask 2711.0 16384
layer1.0.conv3.weight, mask/weight parameters,2711,2711 density 0.2253158244680851,0.2253158244680851
layer1.0.shortcut.0.weight, mask/weight parameters,6501,6501 density 0.39678955078125,0.39678955078125
before tensor 16384 mask 2778.0 16384
layer1.1.conv1.weight, mask/weight parameters,2778,2778 density 0.2308843085106383,0.2308843085106383
before tensor 36864 mask 4921.0 36864
layer1.1.conv2.weight, mask/weight parameters,4921,4921 density 0.24752276042452592,0.24752276042452592
before tensor 16384 mask 3039.0 16384
layer1.1.conv3.weight, mask/weight parameters,3039,3039 density 0.25257646276595747,0.25257646276595747
before tensor 16384 mask 2494.0 16384
layer1.2.conv1.weight, mask/weight parameters,2494,2494 density 0.20728058510638298,0.20728058510638298
before tensor 36864 mask 3290.0 36864
layer1.2.conv2.weight, mask/weight parameters,3290,3290 density 0.16548463356973994,0.16548463356973994
before tensor 16384 mask 2406.0 16384
layer1.2.conv3.weight, mask/weight parameters,2406,2406 density 0.19996675531914893,0.19996675531914893
before tensor 32768 mask 3641.0 32768
layer2.0.conv1.weight, mask/weight parameters,3641,3641 density 0.16732536764705883,0.16732536764705883
before tensor 147456 mask 8781.0 147456
layer2.0.conv2.weight, mask/weight parameters,8781,8781 density 0.135040369088812,0.135040369088812
before tensor 65536 mask 6880.0 65536
layer2.0.conv3.weight, mask/weight parameters,6880,6880 density 0.15808823529411764,0.15808823529411764
layer2.0.shortcut.0.weight, mask/weight parameters,31187,31187 density 0.23793792724609375,0.23793792724609375
before tensor 65536 mask 7295.0 65536
layer2.1.conv1.weight, mask/weight parameters,7295,7295 density 0.16762408088235295,0.16762408088235295
before tensor 147456 mask 13257.0 147456
layer2.1.conv2.weight, mask/weight parameters,13257,13257 density 0.20387543252595156,0.20387543252595156
before tensor 65536 mask 8460.0 65536
layer2.1.conv3.weight, mask/weight parameters,8460,8460 density 0.19439338235294118,0.19439338235294118
before tensor 65536 mask 9956.0 65536
layer2.2.conv1.weight, mask/weight parameters,9956,9956 density 0.22876838235294117,0.22876838235294117
before tensor 147456 mask 20095.0 147456
layer2.2.conv2.weight, mask/weight parameters,20095,20095 density 0.30903498654363704,0.30903498654363704
before tensor 65536 mask 12382.0 65536
layer2.2.conv3.weight, mask/weight parameters,12382,12382 density 0.2845128676470588,0.2845128676470588
before tensor 65536 mask 9165.0 65536
layer2.3.conv1.weight, mask/weight parameters,9165,9165 density 0.21059283088235295,0.21059283088235295
before tensor 147456 mask 14550.0 147456
layer2.3.conv2.weight, mask/weight parameters,14550,14550 density 0.223760092272203,0.223760092272203
before tensor 65536 mask 7919.0 65536
layer2.3.conv3.weight, mask/weight parameters,7919,7919 density 0.1819623161764706,0.1819623161764706
before tensor 131072 mask 31192.0 131072
layer3.0.conv1.weight, mask/weight parameters,31192,31192 density 0.39052483974358976,0.39052483974358976
before tensor 589824 mask 84130.0 589824
layer3.0.conv2.weight, mask/weight parameters,84130,84130 density 0.384113156549054,0.384113156549054
before tensor 262144 mask 63080.0 262144
layer3.0.conv3.weight, mask/weight parameters,63080,63080 density 0.3948818108974359,0.3948818108974359
layer3.0.shortcut.0.weight, mask/weight parameters,101773,101773 density 0.19411659240722656,0.19411659240722656
before tensor 262144 mask 34187.0 262144
layer3.1.conv1.weight, mask/weight parameters,34187,34187 density 0.21401116786858973,0.21401116786858973
before tensor 589824 mask 75500.0 589824
layer3.1.conv2.weight, mask/weight parameters,75500,75500 density 0.3447110818905691,0.3447110818905691
before tensor 262144 mask 56373.0 262144
layer3.1.conv3.weight, mask/weight parameters,56373,56373 density 0.35289588341346156,0.35289588341346156
before tensor 262144 mask 41311.0 262144
layer3.2.conv1.weight, mask/weight parameters,41311,41311 density 0.2586075220352564,0.2586075220352564
before tensor 589824 mask 82925.0 589824
layer3.2.conv2.weight, mask/weight parameters,82925,82925 density 0.3786114763678866,0.3786114763678866
before tensor 262144 mask 59806.0 262144
layer3.2.conv3.weight, mask/weight parameters,59806,59806 density 0.37438651842948717,0.37438651842948717
before tensor 262144 mask 39182.0 262144
layer3.3.conv1.weight, mask/weight parameters,39182,39182 density 0.24527994791666666,0.24527994791666666
before tensor 589824 mask 66204.0 589824
layer3.3.conv2.weight, mask/weight parameters,66204,66204 density 0.3022682445759369,0.3022682445759369
before tensor 262144 mask 47562.0 262144
layer3.3.conv3.weight, mask/weight parameters,47562,47562 density 0.29773888221153844,0.29773888221153844
before tensor 262144 mask 38999.0 262144
layer3.4.conv1.weight, mask/weight parameters,38999,38999 density 0.24413436498397437,0.24413436498397437
before tensor 589824 mask 52961.0 589824
layer3.4.conv2.weight, mask/weight parameters,52961,52961 density 0.2418045510994229,0.2418045510994229
before tensor 262144 mask 36905.0 262144
layer3.4.conv3.weight, mask/weight parameters,36905,36905 density 0.23102589142628205,0.23102589142628205
before tensor 262144 mask 40554.0 262144
layer3.5.conv1.weight, mask/weight parameters,40554,40554 density 0.25386868990384615,0.25386868990384615
before tensor 589824 mask 50183.0 589824
layer3.5.conv2.weight, mask/weight parameters,50183,50183 density 0.22912100956972753,0.22912100956972753
before tensor 262144 mask 34067.0 262144
layer3.5.conv3.weight, mask/weight parameters,34067,34067 density 0.21325996594551283,0.21325996594551283
before tensor 524288 mask 139148.0 524288
layer4.0.conv1.weight, mask/weight parameters,139148,139148 density 0.45145089285714285,0.45145089285714285
before tensor 2359296 mask 235620.0 2359296
layer4.0.conv2.weight, mask/weight parameters,235620,235620 density 0.2889592830101213,0.2889592830101213
before tensor 1048576 mask 102733.0 1048576
layer4.0.conv3.weight, mask/weight parameters,102733,102733 density 0.16665314835963455,0.16665314835963455
layer4.0.shortcut.0.weight, mask/weight parameters,150280,150280 density 0.07165908813476562,0.07165908813476562
before tensor 1048576 mask 78956.0 1048576
layer4.1.conv1.weight, mask/weight parameters,78956,78956 density 0.12808217400332225,0.12808217400332225
before tensor 2359296 mask 143455.0 2359296
layer4.1.conv2.weight, mask/weight parameters,143455,143455 density 0.17593011605218975,0.17593011605218975
before tensor 1048576 mask 69339.0 1048576
layer4.1.conv3.weight, mask/weight parameters,69339,69339 density 0.11248150695598007,0.11248150695598007
before tensor 1048576 mask 44790.0 1048576
layer4.2.conv1.weight, mask/weight parameters,44790,44790 density 0.07265819663621262,0.07265819663621262
before tensor 2359296 mask 49371.0 2359296
layer4.2.conv2.weight, mask/weight parameters,49371,49371 density 0.06054752890880528,0.06054752890880528
before tensor 1048576 mask 29083.0 1048576
layer4.2.conv3.weight, mask/weight parameters,29083,29083 density 0.047178350809800665,0.047178350809800665
classifier.weight, mask/weight parameters,97935,97935 density 0.4781982421875,0.4781982421875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.18663890183455267 0.18663890183455267 after dst
Death rate: 0.13272542485937322

dynamic sparse change grow
self.total_params*pruning_rate 3139225.9959874908
self.total_nonzero 2365205.0
to grow 774020.9959874908
len(all_scores) 12672626 9446233
increse 774020.0 before_mask 3139224.0 after_mask 3139224.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1520,1416 density 0.8796296296296297,0.8194444444444444
before tensor 4096 mask 973.0 4096
layer1.0.conv1.weight, mask/weight parameters,973,801 density 0.3234707446808511,0.26628989361702127
before tensor 36864 mask 4276.0 36864
layer1.0.conv2.weight, mask/weight parameters,4276,3676 density 0.21507972435994166,0.18490015592777023
before tensor 16384 mask 3460.0 16384
layer1.0.conv3.weight, mask/weight parameters,3460,2711 density 0.28756648936170215,0.2253158244680851
layer1.0.shortcut.0.weight, mask/weight parameters,7929,6501 density 0.48394775390625,0.39678955078125
before tensor 16384 mask 3496.0 16384
layer1.1.conv1.weight, mask/weight parameters,3496,2778 density 0.29055851063829785,0.2308843085106383
before tensor 36864 mask 5903.0 36864
layer1.1.conv2.weight, mask/weight parameters,5903,4921 density 0.2969166540918465,0.24752276042452592
before tensor 16384 mask 4149.0 16384
layer1.1.conv3.weight, mask/weight parameters,4149,3039 density 0.34483045212765956,0.25257646276595747
before tensor 16384 mask 3177.0 16384
layer1.2.conv1.weight, mask/weight parameters,3177,2494 density 0.2640458776595745,0.20728058510638298
before tensor 36864 mask 4085.0 36864
layer1.2.conv2.weight, mask/weight parameters,4085,3290 density 0.20547256174236708,0.16548463356973994
before tensor 16384 mask 3483.0 16384
layer1.2.conv3.weight, mask/weight parameters,3483,2406 density 0.2894780585106383,0.19996675531914893
before tensor 32768 mask 5048.0 32768
layer2.0.conv1.weight, mask/weight parameters,5048,3641 density 0.23198529411764707,0.16732536764705883
before tensor 147456 mask 10458.0 147456
layer2.0.conv2.weight, mask/weight parameters,10458,8781 density 0.16083044982698963,0.135040369088812
before tensor 65536 mask 8610.0 65536
layer2.0.conv3.weight, mask/weight parameters,8610,6880 density 0.19784007352941177,0.15808823529411764
layer2.0.shortcut.0.weight, mask/weight parameters,42656,31187 density 0.325439453125,0.23793792724609375
before tensor 65536 mask 9548.0 65536
layer2.1.conv1.weight, mask/weight parameters,9548,7295 density 0.21939338235294117,0.16762408088235295
before tensor 147456 mask 18044.0 147456
layer2.1.conv2.weight, mask/weight parameters,18044,13257 density 0.27749327181853134,0.20387543252595156
before tensor 65536 mask 11551.0 65536
layer2.1.conv3.weight, mask/weight parameters,11551,8460 density 0.2654181985294118,0.19439338235294118
before tensor 65536 mask 13124.0 65536
layer2.2.conv1.weight, mask/weight parameters,13124,9956 density 0.3015625,0.22876838235294117
before tensor 147456 mask 25674.0 147456
layer2.2.conv2.weight, mask/weight parameters,25674,20095 density 0.3948327566320646,0.30903498654363704
before tensor 65536 mask 16295.0 65536
layer2.2.conv3.weight, mask/weight parameters,16295,12382 density 0.37442555147058826,0.2845128676470588
before tensor 65536 mask 12037.0 65536
layer2.3.conv1.weight, mask/weight parameters,12037,9165 density 0.2765854779411765,0.21059283088235295
before tensor 147456 mask 18051.0 147456
layer2.3.conv2.weight, mask/weight parameters,18051,14550 density 0.27760092272202996,0.223760092272203
before tensor 65536 mask 11366.0 65536
layer2.3.conv3.weight, mask/weight parameters,11366,7919 density 0.2611672794117647,0.1819623161764706
before tensor 131072 mask 41081.0 131072
layer3.0.conv1.weight, mask/weight parameters,41081,31192 density 0.514335436698718,0.39052483974358976
before tensor 589824 mask 108150.0 589824
layer3.0.conv2.weight, mask/weight parameters,108150,84130 density 0.49378150339688803,0.384113156549054
before tensor 262144 mask 77425.0 262144
layer3.0.conv3.weight, mask/weight parameters,77425,63080 density 0.4846817407852564,0.3948818108974359
layer3.0.shortcut.0.weight, mask/weight parameters,138445,101773 density 0.26406288146972656,0.19411659240722656
before tensor 262144 mask 44421.0 262144
layer3.1.conv1.weight, mask/weight parameters,44421,34187 density 0.278076171875,0.21401116786858973
before tensor 589824 mask 96049.0 589824
layer3.1.conv2.weight, mask/weight parameters,96049,75500 density 0.43853185039082476,0.3447110818905691
before tensor 262144 mask 70696.0 262144
layer3.1.conv3.weight, mask/weight parameters,70696,56373 density 0.44255809294871795,0.35289588341346156
before tensor 262144 mask 54567.0 262144
layer3.2.conv1.weight, mask/weight parameters,54567,41311 density 0.34159029447115385,0.2586075220352564
before tensor 589824 mask 105811.0 589824
layer3.2.conv2.weight, mask/weight parameters,105811,82925 density 0.48310230842282126,0.3786114763678866
before tensor 262144 mask 74206.0 262144
layer3.2.conv3.weight, mask/weight parameters,74206,59806 density 0.46453074919871795,0.37438651842948717
before tensor 262144 mask 53760.0 262144
layer3.3.conv1.weight, mask/weight parameters,53760,39182 density 0.33653846153846156,0.24527994791666666
before tensor 589824 mask 88009.0 589824
layer3.3.conv2.weight, mask/weight parameters,88009,66204 density 0.40182354445174956,0.3022682445759369
before tensor 262144 mask 61143.0 262144
layer3.3.conv3.weight, mask/weight parameters,61143,47562 density 0.3827561598557692,0.29773888221153844
before tensor 262144 mask 52605.0 262144
layer3.4.conv1.weight, mask/weight parameters,52605,38999 density 0.32930814302884615,0.24413436498397437
before tensor 589824 mask 71278.0 589824
layer3.4.conv2.weight, mask/weight parameters,71278,52961 density 0.32543465556286066,0.2418045510994229
before tensor 262144 mask 48864.0 262144
layer3.4.conv3.weight, mask/weight parameters,48864,36905 density 0.3058894230769231,0.23102589142628205
before tensor 262144 mask 52903.0 262144
layer3.5.conv1.weight, mask/weight parameters,52903,40554 density 0.33117362780448717,0.25386868990384615
before tensor 589824 mask 66324.0 589824
layer3.5.conv2.weight, mask/weight parameters,66324,50183 density 0.3028161297392067,0.22912100956972753
before tensor 262144 mask 45567.0 262144
layer3.5.conv3.weight, mask/weight parameters,45567,34067 density 0.28525015024038464,0.21325996594551283
before tensor 524288 mask 169061.0 524288
layer4.0.conv1.weight, mask/weight parameters,169061,139148 density 0.5485004412375415,0.45145089285714285
before tensor 2359296 mask 306865.0 2359296
layer4.0.conv2.weight, mask/weight parameters,306865,235620 density 0.37633261344920155,0.2889592830101213
before tensor 1048576 mask 141701.0 1048576
layer4.0.conv3.weight, mask/weight parameters,141701,102733 density 0.22986691497093023,0.16665314835963455
layer4.0.shortcut.0.weight, mask/weight parameters,217477,150280 density 0.10370111465454102,0.07165908813476562
before tensor 1048576 mask 106779.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106779,78956 density 0.1732165567898671,0.12808217400332225
before tensor 2359296 mask 194048.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194048,143455 density 0.23797627938862584,0.17593011605218975
before tensor 1048576 mask 100325.0 1048576
layer4.1.conv3.weight, mask/weight parameters,100325,69339 density 0.16274689835963455,0.11248150695598007
before tensor 1048576 mask 69085.0 1048576
layer4.2.conv1.weight, mask/weight parameters,69085,44790 density 0.1120694689576412,0.07265819663621262
before tensor 2359296 mask 83301.0 2359296
layer4.2.conv2.weight, mask/weight parameters,83301,49371 density 0.1021585486547242,0.06054752890880528
before tensor 1048576 mask 46454.0 1048576
layer4.2.conv3.weight, mask/weight parameters,46454,29083 density 0.07535753218438539,0.047178350809800665
classifier.weight, mask/weight parameters,107911,97935 density 0.5269091796875,0.4781982421875
Total Model parameters after dst: 3139224 2365205
Total parameters under density level of 0.1: 0.24771692938780013 0.18663890183455267 after dst
Death rate: 0.13272542485937322


Training summary: Average loss: 1.2783, Accuracy: 31708/50000 (63.416%)


Evaluation: Average loss: 1.5338, Accuracy: 5848/10000 (58.480%)

Current learning rate: 0.1. Time taken for epoch: 97.51 seconds.

Train Epoch: 52 [0/50000 (0%)]	Loss: 0.932954 Accuracy: 69/100 (69.000%
Train Epoch: 52 [10000/50000 (20%)]	Loss: 1.066053 Accuracy: 6454/10100 (63.901%
Train Epoch: 52 [20000/50000 (40%)]	Loss: 1.234015 Accuracy: 12775/20100 (63.557%
Train Epoch: 52 [30000/50000 (60%)]	Loss: 1.131855 Accuracy: 19109/30100 (63.485%
Train Epoch: 52 [40000/50000 (80%)]	Loss: 0.875279 Accuracy: 25431/40100 (63.419%
current layer rate 0.39610081929904417
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4640.0
Total filter_masks items: 9697202.0
4640.0 / 7552 channels
Total channels to prune: 79.35338734638117
Layer ('layer2', 0, 'conv1'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/85.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 5/301.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 5/301.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 5/301.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 5/301.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 5/301.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 5/301.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4578.0
Total filter_masks items: 9493331.0
After apply_mask:
Total filter_names items: 4578.0
Total filter_masks items: 9493331.0
Total pruned: 62/79.35338734638117 channels
===========done ===============

Training summary: Average loss: 1.2822, Accuracy: 31578/50000 (63.156%)


Evaluation: Average loss: 1.9123, Accuracy: 5127/10000 (51.270%)

Current learning rate: 0.1. Time taken for epoch: 96.78 seconds.

Train Epoch: 53 [0/50000 (0%)]	Loss: 1.219102 Accuracy: 62/100 (62.000%
Train Epoch: 53 [10000/50000 (20%)]	Loss: 1.322223 Accuracy: 6606/10100 (65.406%
Train Epoch: 53 [20000/50000 (40%)]	Loss: 1.491122 Accuracy: 12954/20100 (64.448%
Train Epoch: 53 [30000/50000 (60%)]	Loss: 1.417026 Accuracy: 19322/30100 (64.193%
Train Epoch: 53 [40000/50000 (80%)]	Loss: 1.180802 Accuracy: 25637/40100 (63.933%
current mest  death_rate 0.13156768445496475


dynamic sparse change prune
to kill 705833.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1407,1407 density 0.8142361111111112,0.8142361111111112
before tensor 4096 mask 781.0 4096
layer1.0.conv1.weight, mask/weight parameters,781,781 density 0.2596409574468085,0.2596409574468085
before tensor 36864 mask 3563.0 36864
layer1.0.conv2.weight, mask/weight parameters,3563,3563 density 0.17921633720637795,0.17921633720637795
before tensor 16384 mask 2718.0 16384
layer1.0.conv3.weight, mask/weight parameters,2718,2718 density 0.22589760638297873,0.22589760638297873
layer1.0.shortcut.0.weight, mask/weight parameters,6602,6602 density 0.4029541015625,0.4029541015625
before tensor 16384 mask 2832.0 16384
layer1.1.conv1.weight, mask/weight parameters,2832,2832 density 0.23537234042553193,0.23537234042553193
before tensor 36864 mask 4941.0 36864
layer1.1.conv2.weight, mask/weight parameters,4941,4941 density 0.24852874603893163,0.24852874603893163
before tensor 16384 mask 3142.0 16384
layer1.1.conv3.weight, mask/weight parameters,3142,3142 density 0.2611369680851064,0.2611369680851064
before tensor 16384 mask 2551.0 16384
layer1.2.conv1.weight, mask/weight parameters,2551,2551 density 0.2120179521276596,0.2120179521276596
before tensor 36864 mask 3387.0 36864
layer1.2.conv2.weight, mask/weight parameters,3387,3387 density 0.17036366379960766,0.17036366379960766
before tensor 16384 mask 2455.0 16384
layer1.2.conv3.weight, mask/weight parameters,2455,2455 density 0.20403922872340424,0.20403922872340424
before tensor 32768 mask 3881.0 32768
layer2.0.conv1.weight, mask/weight parameters,3881,3881 density 0.18047805059523808,0.18047805059523808
before tensor 147456 mask 8996.0 147456
layer2.0.conv2.weight, mask/weight parameters,8996,8996 density 0.14166036785084404,0.14166036785084404
before tensor 65536 mask 6751.0 65536
layer2.0.conv3.weight, mask/weight parameters,6751,6751 density 0.15697079613095238,0.15697079613095238
layer2.0.shortcut.0.weight, mask/weight parameters,31603,31603 density 0.24111175537109375,0.24111175537109375
before tensor 65536 mask 7357.0 65536
layer2.1.conv1.weight, mask/weight parameters,7357,7357 density 0.17106119791666666,0.17106119791666666
before tensor 147456 mask 13173.0 147456
layer2.1.conv2.weight, mask/weight parameters,13173,13173 density 0.20743575207860923,0.20743575207860923
before tensor 65536 mask 8491.0 65536
layer2.1.conv3.weight, mask/weight parameters,8491,8491 density 0.19742838541666666,0.19742838541666666
before tensor 65536 mask 10115.0 65536
layer2.2.conv1.weight, mask/weight parameters,10115,10115 density 0.23518880208333334,0.23518880208333334
before tensor 147456 mask 20386.0 147456
layer2.2.conv2.weight, mask/weight parameters,20386,20386 density 0.32101914840010076,0.32101914840010076
before tensor 65536 mask 12621.0 65536
layer2.2.conv3.weight, mask/weight parameters,12621,12621 density 0.29345703125,0.29345703125
before tensor 65536 mask 9249.0 65536
layer2.3.conv1.weight, mask/weight parameters,9249,9249 density 0.21505301339285715,0.21505301339285715
before tensor 147456 mask 14714.0 147456
layer2.3.conv2.weight, mask/weight parameters,14714,14714 density 0.23170194003527336,0.23170194003527336
before tensor 65536 mask 9090.0 65536
layer2.3.conv3.weight, mask/weight parameters,9090,9090 density 0.21135602678571427,0.21135602678571427
before tensor 131072 mask 31772.0 131072
layer3.0.conv1.weight, mask/weight parameters,31772,31772 density 0.4029525162337662,0.4029525162337662
before tensor 589824 mask 84203.0 589824
layer3.0.conv2.weight, mask/weight parameters,84203,84203 density 0.39449691722418995,0.39449691722418995
before tensor 262144 mask 62858.0 262144
layer3.0.conv3.weight, mask/weight parameters,62858,62858 density 0.3986023741883117,0.3986023741883117
layer3.0.shortcut.0.weight, mask/weight parameters,103492,103492 density 0.19739532470703125,0.19739532470703125
before tensor 262144 mask 34059.0 262144
layer3.1.conv1.weight, mask/weight parameters,34059,34059 density 0.2159788453733766,0.2159788453733766
before tensor 589824 mask 73602.0 589824
layer3.1.conv2.weight, mask/weight parameters,73602,73602 density 0.34483049418114353,0.34483049418114353
before tensor 262144 mask 55734.0 262144
layer3.1.conv3.weight, mask/weight parameters,55734,55734 density 0.3534268465909091,0.3534268465909091
before tensor 262144 mask 41721.0 262144
layer3.2.conv1.weight, mask/weight parameters,41721,41721 density 0.26456600040584416,0.26456600040584416
before tensor 589824 mask 82506.0 589824
layer3.2.conv2.weight, mask/weight parameters,82506,82506 density 0.3865463540788216,0.3865463540788216
before tensor 262144 mask 59334.0 262144
layer3.2.conv3.weight, mask/weight parameters,59334,59334 density 0.37625558035714285,0.37625558035714285
before tensor 262144 mask 40558.0 262144
layer3.3.conv1.weight, mask/weight parameters,40558,40558 density 0.25719105113636365,0.25719105113636365
before tensor 589824 mask 67064.0 589824
layer3.3.conv2.weight, mask/weight parameters,67064,67064 density 0.31419950900470384,0.31419950900470384
before tensor 262144 mask 47652.0 262144
layer3.3.conv3.weight, mask/weight parameters,47652,47652 density 0.3021763392857143,0.3021763392857143
before tensor 262144 mask 40054.0 262144
layer3.4.conv1.weight, mask/weight parameters,40054,40054 density 0.2539950284090909,0.2539950284090909
before tensor 589824 mask 53639.0 589824
layer3.4.conv2.weight, mask/weight parameters,53639,53639 density 0.2513024493543974,0.2513024493543974
before tensor 262144 mask 37214.0 262144
layer3.4.conv3.weight, mask/weight parameters,37214,37214 density 0.2359856939935065,0.2359856939935065
before tensor 262144 mask 40637.0 262144
layer3.5.conv1.weight, mask/weight parameters,40637,40637 density 0.2576920150162338,0.2576920150162338
before tensor 589824 mask 50436.0 589824
layer3.5.conv2.weight, mask/weight parameters,50436,50436 density 0.23629617136110642,0.23629617136110642
before tensor 262144 mask 34629.0 262144
layer3.5.conv3.weight, mask/weight parameters,34629,34629 density 0.21959339488636365,0.21959339488636365
before tensor 524288 mask 137644.0 524288
layer4.0.conv1.weight, mask/weight parameters,137644,137644 density 0.4541147592905405,0.4541147592905405
before tensor 2359296 mask 231542.0 2359296
layer4.0.conv2.weight, mask/weight parameters,231542,231542 density 0.2936323147471796,0.2936323147471796
before tensor 1048576 mask 102039.0 1048576
layer4.0.conv3.weight, mask/weight parameters,102039,102039 density 0.16832341374577703,0.16832341374577703
layer4.0.shortcut.0.weight, mask/weight parameters,147870,147870 density 0.0705099105834961,0.0705099105834961
before tensor 1048576 mask 78048.0 1048576
layer4.1.conv1.weight, mask/weight parameters,78048,78048 density 0.12874788851351351,0.12874788851351351
before tensor 2359296 mask 142685.0 2359296
layer4.1.conv2.weight, mask/weight parameters,142685,142685 density 0.1809474170116062,0.1809474170116062
before tensor 1048576 mask 69769.0 1048576
layer4.1.conv3.weight, mask/weight parameters,69769,69769 density 0.11509085990287163,0.11509085990287163
before tensor 1048576 mask 45556.0 1048576
layer4.2.conv1.weight, mask/weight parameters,45556,45556 density 0.07514912373310811,0.07514912373310811
before tensor 2359296 mask 50951.0 2359296
layer4.2.conv2.weight, mask/weight parameters,50951,50951 density 0.06461402280659037,0.06461402280659037
before tensor 1048576 mask 29676.0 1048576
layer4.2.conv3.weight, mask/weight parameters,29676,29676 density 0.048953494510135136,0.048953494510135136
classifier.weight, mask/weight parameters,97455,97455 density 0.4758544921875,0.4758544921875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.18969055050002986 0.18969055050002986 after dst
Death rate: 0.13156768445496475

dynamic sparse change grow
self.total_params*pruning_rate 3111843.082894729
self.total_nonzero 2365205.0
to grow 746638.082894729
len(all_scores) 12468755 9231205
increse 746638.0 before_mask 3111842.0 after_mask 3111842.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1511,1407 density 0.8744212962962963,0.8142361111111112
before tensor 4096 mask 928.0 4096
layer1.0.conv1.weight, mask/weight parameters,928,781 density 0.30851063829787234,0.2596409574468085
before tensor 36864 mask 4100.0 36864
layer1.0.conv2.weight, mask/weight parameters,4100,3563 density 0.20622705095317137,0.17921633720637795
before tensor 16384 mask 3273.0 16384
layer1.0.conv3.weight, mask/weight parameters,3273,2718 density 0.2720246010638298,0.22589760638297873
layer1.0.shortcut.0.weight, mask/weight parameters,7681,6602 density 0.46881103515625,0.4029541015625
before tensor 16384 mask 3477.0 16384
layer1.1.conv1.weight, mask/weight parameters,3477,2832 density 0.28897938829787234,0.23537234042553193
before tensor 36864 mask 6000.0 36864
layer1.1.conv2.weight, mask/weight parameters,6000,4941 density 0.3017956843217142,0.24852874603893163
before tensor 16384 mask 4028.0 16384
layer1.1.conv3.weight, mask/weight parameters,4028,3142 density 0.3347739361702128,0.2611369680851064
before tensor 16384 mask 3064.0 16384
layer1.2.conv1.weight, mask/weight parameters,3064,2551 density 0.2546542553191489,0.2120179521276596
before tensor 36864 mask 3911.0 36864
layer1.2.conv2.weight, mask/weight parameters,3911,3387 density 0.19672048689703736,0.17036366379960766
before tensor 16384 mask 3343.0 16384
layer1.2.conv3.weight, mask/weight parameters,3343,2455 density 0.27784242021276595,0.20403922872340424
before tensor 32768 mask 4727.0 32768
layer2.0.conv1.weight, mask/weight parameters,4727,3881 density 0.21981956845238096,0.18047805059523808
before tensor 147456 mask 10013.0 147456
layer2.0.conv2.weight, mask/weight parameters,10013,8996 density 0.15767510707986898,0.14166036785084404
before tensor 65536 mask 8872.0 65536
layer2.0.conv3.weight, mask/weight parameters,8872,6751 density 0.20628720238095238,0.15697079613095238
layer2.0.shortcut.0.weight, mask/weight parameters,41693,31603 density 0.31809234619140625,0.24111175537109375
before tensor 65536 mask 9612.0 65536
layer2.1.conv1.weight, mask/weight parameters,9612,7357 density 0.22349330357142858,0.17106119791666666
before tensor 147456 mask 17880.0 147456
layer2.1.conv2.weight, mask/weight parameters,17880,13173 density 0.281557067271353,0.20743575207860923
before tensor 65536 mask 11345.0 65536
layer2.1.conv3.weight, mask/weight parameters,11345,8491 density 0.26378813244047616,0.19742838541666666
before tensor 65536 mask 13106.0 65536
layer2.2.conv1.weight, mask/weight parameters,13106,10115 density 0.30473400297619047,0.23518880208333334
before tensor 147456 mask 25504.0 147456
layer2.2.conv2.weight, mask/weight parameters,25504,20386 density 0.4016124968505921,0.32101914840010076
before tensor 65536 mask 16143.0 65536
layer2.2.conv3.weight, mask/weight parameters,16143,12621 density 0.37534877232142855,0.29345703125
before tensor 65536 mask 12387.0 65536
layer2.3.conv1.weight, mask/weight parameters,12387,9249 density 0.2880161830357143,0.21505301339285715
before tensor 147456 mask 18308.0 147456
layer2.3.conv2.weight, mask/weight parameters,18308,14714 density 0.2882968002015621,0.23170194003527336
before tensor 65536 mask 11502.0 65536
layer2.3.conv3.weight, mask/weight parameters,11502,9090 density 0.26743861607142855,0.21135602678571427
before tensor 131072 mask 41236.0 131072
layer3.0.conv1.weight, mask/weight parameters,41236,31772 density 0.5229809253246753,0.4029525162337662
before tensor 589824 mask 107293.0 589824
layer3.0.conv2.weight, mask/weight parameters,107293,84203 density 0.5026751747530969,0.39449691722418995
before tensor 262144 mask 77143.0 262144
layer3.0.conv3.weight, mask/weight parameters,77143,62858 density 0.4891880580357143,0.3986023741883117
layer3.0.shortcut.0.weight, mask/weight parameters,135700,103492 density 0.25882720947265625,0.19739532470703125
before tensor 262144 mask 44044.0 262144
layer3.1.conv1.weight, mask/weight parameters,44044,34059 density 0.279296875,0.2159788453733766
before tensor 589824 mask 95021.0 589824
layer3.1.conv2.weight, mask/weight parameters,95021,73602 density 0.4451800003748056,0.34483049418114353
before tensor 262144 mask 69356.0 262144
layer3.1.conv3.weight, mask/weight parameters,69356,55734 density 0.43980823863636365,0.3534268465909091
before tensor 262144 mask 54076.0 262144
layer3.2.conv1.weight, mask/weight parameters,54076,41721 density 0.34291294642857145,0.26456600040584416
before tensor 589824 mask 105925.0 589824
layer3.2.conv2.weight, mask/weight parameters,105925,82506 density 0.49626599951275274,0.3865463540788216
before tensor 262144 mask 76047.0 262144
layer3.2.conv3.weight, mask/weight parameters,76047,59334 density 0.48223797686688313,0.37625558035714285
before tensor 262144 mask 54283.0 262144
layer3.3.conv1.weight, mask/weight parameters,54283,40558 density 0.34422559862012986,0.25719105113636365
before tensor 589824 mask 87513.0 589824
layer3.3.conv2.weight, mask/weight parameters,87513,67064 density 0.41000449766683533,0.31419950900470384
before tensor 262144 mask 61682.0 262144
layer3.3.conv3.weight, mask/weight parameters,61682,47652 density 0.3911449878246753,0.3021763392857143
before tensor 262144 mask 54171.0 262144
layer3.4.conv1.weight, mask/weight parameters,54171,40054 density 0.3435153713474026,0.2539950284090909
before tensor 589824 mask 69623.0 589824
layer3.4.conv2.weight, mask/weight parameters,69623,53639 density 0.3261886021626281,0.2513024493543974
before tensor 262144 mask 47698.0 262144
layer3.4.conv3.weight, mask/weight parameters,47698,37214 density 0.3024680397727273,0.2359856939935065
before tensor 262144 mask 56710.0 262144
layer3.5.conv1.weight, mask/weight parameters,56710,40637 density 0.3596159699675325,0.2576920150162338
before tensor 589824 mask 68434.0 589824
layer3.5.conv2.weight, mask/weight parameters,68434,50436 density 0.32061805438428814,0.23629617136110642
before tensor 262144 mask 47557.0 262144
layer3.5.conv3.weight, mask/weight parameters,47557,34629 density 0.30157391436688313,0.21959339488636365
before tensor 524288 mask 169109.0 524288
layer4.0.conv1.weight, mask/weight parameters,169109,137644 density 0.5579240128800675,0.4541147592905405
before tensor 2359296 mask 301277.0 2359296
layer4.0.conv2.weight, mask/weight parameters,301277,231542 density 0.382067455969483,0.2936323147471796
before tensor 1048576 mask 141625.0 1048576
layer4.0.conv3.weight, mask/weight parameters,141625,102039 density 0.23362443253800674,0.16832341374577703
layer4.0.shortcut.0.weight, mask/weight parameters,217232,147870 density 0.10358428955078125,0.0705099105834961
before tensor 1048576 mask 106289.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106289,78048 density 0.1753342087204392,0.12874788851351351
before tensor 2359296 mask 190179.0 2359296
layer4.1.conv2.weight, mask/weight parameters,190179,142685 density 0.24117741051862673,0.1809474170116062
before tensor 1048576 mask 96382.0 1048576
layer4.1.conv3.weight, mask/weight parameters,96382,69769 density 0.15899163323479729,0.11509085990287163
before tensor 1048576 mask 66332.0 1048576
layer4.2.conv1.weight, mask/weight parameters,66332,45556 density 0.10942118876689189,0.07514912373310811
before tensor 2359296 mask 76153.0 2359296
layer4.2.conv2.weight, mask/weight parameters,76153,50951 density 0.09657419243567893,0.06461402280659037
before tensor 1048576 mask 43348.0 1048576
layer4.2.conv3.weight, mask/weight parameters,43348,29676 density 0.07150680954391891,0.048953494510135136
classifier.weight, mask/weight parameters,107996,97455 density 0.52732421875,0.4758544921875
Total Model parameters after dst: 3111842 2365205
Total parameters under density level of 0.1: 0.24957118814187945 0.18969055050002986 after dst
Death rate: 0.13156768445496475


Training summary: Average loss: 1.2699, Accuracy: 31810/50000 (63.620%)


Evaluation: Average loss: 1.5911, Accuracy: 5664/10000 (56.640%)

Current learning rate: 0.1. Time taken for epoch: 97.72 seconds.

Train Epoch: 54 [0/50000 (0%)]	Loss: 1.110033 Accuracy: 64/100 (64.000%
Train Epoch: 54 [10000/50000 (20%)]	Loss: 1.169913 Accuracy: 6555/10100 (64.901%
Train Epoch: 54 [20000/50000 (40%)]	Loss: 1.423363 Accuracy: 12884/20100 (64.100%
Train Epoch: 54 [30000/50000 (60%)]	Loss: 1.303318 Accuracy: 19228/30100 (63.880%
Train Epoch: 54 [40000/50000 (80%)]	Loss: 1.598892 Accuracy: 25506/40100 (63.606%
current layer rate 0.4039883932635412
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4578.0
Total filter_masks items: 9493331.0
4578.0 / 7552 channels
Total channels to prune: 76.92034592626351
Layer ('layer2', 0, 'conv1'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/84.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 4/296.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 4/296.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 4/296.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 4/296.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 4/296.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 4/296.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4522.0
Total filter_masks items: 9318319.0
After apply_mask:
Total filter_names items: 4522.0
Total filter_masks items: 9318319.0
Total pruned: 56/76.92034592626351 channels
===========done ===============

Training summary: Average loss: 1.2748, Accuracy: 31725/50000 (63.450%)


Evaluation: Average loss: 1.7445, Accuracy: 5325/10000 (53.250%)

Current learning rate: 0.1. Time taken for epoch: 93.32 seconds.

Train Epoch: 55 [0/50000 (0%)]	Loss: 1.311505 Accuracy: 63/100 (63.000%
Train Epoch: 55 [10000/50000 (20%)]	Loss: 1.340427 Accuracy: 6498/10100 (64.337%
Train Epoch: 55 [20000/50000 (40%)]	Loss: 1.319240 Accuracy: 12914/20100 (64.249%
Train Epoch: 55 [30000/50000 (60%)]	Loss: 1.370885 Accuracy: 19231/30100 (63.890%
Train Epoch: 55 [40000/50000 (80%)]	Loss: 1.239276 Accuracy: 25460/40100 (63.491%
current mest  death_rate 0.1303946049191954


dynamic sparse change prune
to kill 684351.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1400,1400 density 0.8101851851851852,0.8101851851851852
before tensor 4096 mask 794.0 4096
layer1.0.conv1.weight, mask/weight parameters,794,794 density 0.26396276595744683,0.26396276595744683
before tensor 36864 mask 3436.0 36864
layer1.0.conv2.weight, mask/weight parameters,3436,3436 density 0.17282832855490166,0.17282832855490166
before tensor 16384 mask 2622.0 16384
layer1.0.conv3.weight, mask/weight parameters,2622,2622 density 0.21791888297872342,0.21791888297872342
layer1.0.shortcut.0.weight, mask/weight parameters,6438,6438 density 0.3929443359375,0.3929443359375
before tensor 16384 mask 2853.0 16384
layer1.1.conv1.weight, mask/weight parameters,2853,2853 density 0.23711768617021275,0.23711768617021275
before tensor 36864 mask 4951.0 36864
layer1.1.conv2.weight, mask/weight parameters,4951,4951 density 0.2490317388461345,0.2490317388461345
before tensor 16384 mask 3077.0 16384
layer1.1.conv3.weight, mask/weight parameters,3077,3077 density 0.2557347074468085,0.2557347074468085
before tensor 16384 mask 2517.0 16384
layer1.2.conv1.weight, mask/weight parameters,2517,2517 density 0.20919215425531915,0.20919215425531915
before tensor 36864 mask 3280.0 36864
layer1.2.conv2.weight, mask/weight parameters,3280,3280 density 0.1649816407625371,0.1649816407625371
before tensor 16384 mask 2440.0 16384
layer1.2.conv3.weight, mask/weight parameters,2440,2440 density 0.20279255319148937,0.20279255319148937
before tensor 32768 mask 3617.0 32768
layer2.0.conv1.weight, mask/weight parameters,3617,3617 density 0.1702277861445783,0.1702277861445783
before tensor 147456 mask 8460.0 147456
layer2.0.conv2.weight, mask/weight parameters,8460,8460 density 0.13644941210625636,0.13644941210625636
before tensor 65536 mask 6876.0 65536
layer2.0.conv3.weight, mask/weight parameters,6876,6876 density 0.1618034638554217,0.1618034638554217
layer2.0.shortcut.0.weight, mask/weight parameters,31524,31524 density 0.240509033203125,0.240509033203125
before tensor 65536 mask 7274.0 65536
layer2.1.conv1.weight, mask/weight parameters,7274,7274 density 0.1711690512048193,0.1711690512048193
before tensor 147456 mask 13173.0 147456
layer2.1.conv2.weight, mask/weight parameters,13173,13173 density 0.21246431509169206,0.21246431509169206
before tensor 65536 mask 8525.0 65536
layer2.1.conv3.weight, mask/weight parameters,8525,8525 density 0.20060711596385541,0.20060711596385541
before tensor 65536 mask 10235.0 65536
layer2.2.conv1.weight, mask/weight parameters,10235,10235 density 0.24084619728915663,0.24084619728915663
before tensor 147456 mask 20283.0 147456
layer2.2.conv2.weight, mask/weight parameters,20283,20283 density 0.3271398848405671,0.3271398848405671
before tensor 65536 mask 12609.0 65536
layer2.2.conv3.weight, mask/weight parameters,12609,12609 density 0.2967102786144578,0.2967102786144578
before tensor 65536 mask 9361.0 65536
layer2.3.conv1.weight, mask/weight parameters,9361,9361 density 0.22027955572289157,0.22027955572289157
before tensor 147456 mask 14613.0 147456
layer2.3.conv2.weight, mask/weight parameters,14613,14613 density 0.2356897469395655,0.2356897469395655
before tensor 65536 mask 9211.0 65536
layer2.3.conv3.weight, mask/weight parameters,9211,9211 density 0.21674981174698796,0.21674981174698796
before tensor 131072 mask 32126.0 131072
layer3.0.conv1.weight, mask/weight parameters,32126,32126 density 0.41280324835526316,0.41280324835526316
before tensor 589824 mask 83930.0 589824
layer3.0.conv2.weight, mask/weight parameters,83930,83930 density 0.403633810403201,0.403633810403201
before tensor 262144 mask 62766.0 262144
layer3.0.conv3.weight, mask/weight parameters,62766,62766 density 0.40325606496710525,0.40325606496710525
layer3.0.shortcut.0.weight, mask/weight parameters,103346,103346 density 0.19711685180664062,0.19711685180664062
before tensor 262144 mask 33712.0 262144
layer3.1.conv1.weight, mask/weight parameters,33712,33712 density 0.21659128289473684,0.21659128289473684
before tensor 589824 mask 72841.0 589824
layer3.1.conv2.weight, mask/weight parameters,72841,72841 density 0.35030490150815635,0.35030490150815635
before tensor 262144 mask 55319.0 262144
layer3.1.conv3.weight, mask/weight parameters,55319,55319 density 0.35541092722039475,0.35541092722039475
before tensor 262144 mask 41615.0 262144
layer3.2.conv1.weight, mask/weight parameters,41615,41615 density 0.26736610814144735,0.26736610814144735
before tensor 589824 mask 82996.0 589824
layer3.2.conv2.weight, mask/weight parameters,82996,82996 density 0.3991420437057556,0.3991420437057556
before tensor 262144 mask 60499.0 262144
layer3.2.conv3.weight, mask/weight parameters,60499,60499 density 0.3886911492598684,0.3886911492598684
before tensor 262144 mask 41061.0 262144
layer3.3.conv1.weight, mask/weight parameters,41061,41061 density 0.2638067948190789,0.2638067948190789
before tensor 589824 mask 67193.0 589824
layer3.3.conv2.weight, mask/weight parameters,67193,67193 density 0.3231426977531548,0.3231426977531548
before tensor 262144 mask 47893.0 262144
layer3.3.conv3.weight, mask/weight parameters,47893,47893 density 0.30770070929276316,0.30770070929276316
before tensor 262144 mask 41231.0 262144
layer3.4.conv1.weight, mask/weight parameters,41231,41231 density 0.2648990028782895,0.2648990028782895
before tensor 589824 mask 53138.0 589824
layer3.4.conv2.weight, mask/weight parameters,53138,53138 density 0.25554978454909205,0.25554978454909205
before tensor 262144 mask 36623.0 262144
layer3.4.conv3.weight, mask/weight parameters,36623,36623 density 0.23529373972039475,0.23529373972039475
before tensor 262144 mask 42851.0 262144
layer3.5.conv1.weight, mask/weight parameters,42851,42851 density 0.27530710320723684,0.27530710320723684
before tensor 589824 mask 51324.0 589824
layer3.5.conv2.weight, mask/weight parameters,51324,51324 density 0.24682594644506,0.24682594644506
before tensor 262144 mask 35829.0 262144
layer3.5.conv3.weight, mask/weight parameters,35829,35829 density 0.23019248560855263,0.23019248560855263
before tensor 524288 mask 138571.0 524288
layer4.0.conv1.weight, mask/weight parameters,138571,138571 density 0.4634357609160959,0.4634357609160959
before tensor 2359296 mask 229919.0 2359296
layer4.0.conv2.weight, mask/weight parameters,229919,229919 density 0.29961713684034946,0.29961713684034946
before tensor 1048576 mask 102339.0 1048576
layer4.0.conv3.weight, mask/weight parameters,102339,102339 density 0.1711308727525685,0.1711308727525685
layer4.0.shortcut.0.weight, mask/weight parameters,147275,147275 density 0.07022619247436523,0.07022619247436523
before tensor 1048576 mask 79112.0 1048576
layer4.1.conv1.weight, mask/weight parameters,79112,79112 density 0.1322907748287671,0.1322907748287671
before tensor 2359296 mask 141037.0 2359296
layer4.1.conv2.weight, mask/weight parameters,141037,141037 density 0.18379125748003586,0.18379125748003586
before tensor 1048576 mask 68272.0 1048576
layer4.1.conv3.weight, mask/weight parameters,68272,68272 density 0.11416416952054795,0.11416416952054795
before tensor 1048576 mask 46196.0 1048576
layer4.2.conv1.weight, mask/weight parameters,46196,46196 density 0.07724876926369863,0.07724876926369863
before tensor 2359296 mask 49810.0 2359296
layer4.2.conv2.weight, mask/weight parameters,49810,49810 density 0.064909509810054,0.064909509810054
before tensor 1048576 mask 29136.0 1048576
layer4.2.conv3.weight, mask/weight parameters,29136,29136 density 0.0487211044520548,0.0487211044520548
classifier.weight, mask/weight parameters,97676,97676 density 0.47693359375,0.47693359375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.19239095855509586 0.19239095855509586 after dst
Death rate: 0.1303946049191954

dynamic sparse change grow
self.total_params*pruning_rate 3084097.3681761674
self.total_nonzero 2365205.0
to grow 718892.3681761674
len(all_scores) 12293743 9030401
increse 718892.0 before_mask 3084096.0 after_mask 3084096.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1492,1400 density 0.8634259259259259,0.8101851851851852
before tensor 4096 mask 914.0 4096
layer1.0.conv1.weight, mask/weight parameters,914,794 density 0.3038563829787234,0.26396276595744683
before tensor 36864 mask 3734.0 36864
layer1.0.conv2.weight, mask/weight parameters,3734,3436 density 0.18781751420954682,0.17282832855490166
before tensor 16384 mask 3177.0 16384
layer1.0.conv3.weight, mask/weight parameters,3177,2622 density 0.2640458776595745,0.21791888297872342
layer1.0.shortcut.0.weight, mask/weight parameters,7401,6438 density 0.45172119140625,0.3929443359375
before tensor 16384 mask 3480.0 16384
layer1.1.conv1.weight, mask/weight parameters,3480,2853 density 0.2892287234042553,0.23711768617021275
before tensor 36864 mask 5631.0 36864
layer1.1.conv2.weight, mask/weight parameters,5631,4951 density 0.2832352497359288,0.2490317388461345
before tensor 16384 mask 3857.0 16384
layer1.1.conv3.weight, mask/weight parameters,3857,3077 density 0.320561835106383,0.2557347074468085
before tensor 16384 mask 3019.0 16384
layer1.2.conv1.weight, mask/weight parameters,3019,2517 density 0.25091422872340424,0.20919215425531915
before tensor 36864 mask 3705.0 36864
layer1.2.conv2.weight, mask/weight parameters,3705,3280 density 0.18635883506865852,0.1649816407625371
before tensor 16384 mask 3204.0 16384
layer1.2.conv3.weight, mask/weight parameters,3204,2440 density 0.26628989361702127,0.20279255319148937
before tensor 32768 mask 4386.0 32768
layer2.0.conv1.weight, mask/weight parameters,4386,3617 density 0.20641942771084337,0.1702277861445783
before tensor 147456 mask 9586.0 147456
layer2.0.conv2.weight, mask/weight parameters,9586,8460 density 0.15461040950952404,0.13644941210625636
before tensor 65536 mask 8851.0 65536
layer2.0.conv3.weight, mask/weight parameters,8851,6876 density 0.2082784262048193,0.1618034638554217
layer2.0.shortcut.0.weight, mask/weight parameters,41681,31524 density 0.31800079345703125,0.240509033203125
before tensor 65536 mask 9782.0 65536
layer2.1.conv1.weight, mask/weight parameters,9782,7274 density 0.23018637048192772,0.1711690512048193
before tensor 147456 mask 17086.0 147456
layer2.1.conv2.weight, mask/weight parameters,17086,13173 density 0.27557620038386477,0.21246431509169206
before tensor 65536 mask 11179.0 65536
layer2.1.conv3.weight, mask/weight parameters,11179,8525 density 0.2630600527108434,0.20060711596385541
before tensor 65536 mask 12932.0 65536
layer2.2.conv1.weight, mask/weight parameters,12932,10235 density 0.3043109939759036,0.24084619728915663
before tensor 147456 mask 26062.0 147456
layer2.2.conv2.weight, mask/weight parameters,26062,20283 density 0.4203480589022758,0.3271398848405671
before tensor 65536 mask 16513.0 65536
layer2.2.conv3.weight, mask/weight parameters,16513,12609 density 0.3885777484939759,0.2967102786144578
before tensor 65536 mask 13135.0 65536
layer2.3.conv1.weight, mask/weight parameters,13135,9361 density 0.3090879141566265,0.22027955572289157
before tensor 147456 mask 18528.0 147456
layer2.3.conv2.weight, mask/weight parameters,18528,14613 density 0.29883388977597136,0.2356897469395655
before tensor 65536 mask 11348.0 65536
layer2.3.conv3.weight, mask/weight parameters,11348,9211 density 0.2670368975903614,0.21674981174698796
before tensor 131072 mask 41887.0 131072
layer3.0.conv1.weight, mask/weight parameters,41887,32126 density 0.5382272820723685,0.41280324835526316
before tensor 589824 mask 105753.0 589824
layer3.0.conv2.weight, mask/weight parameters,105753,83930 density 0.5085843721144968,0.403633810403201
before tensor 262144 mask 76738.0 262144
layer3.0.conv3.weight, mask/weight parameters,76738,62766 density 0.4930227179276316,0.40325606496710525
layer3.0.shortcut.0.weight, mask/weight parameters,136006,103346 density 0.2594108581542969,0.19711685180664062
before tensor 262144 mask 44303.0 262144
layer3.1.conv1.weight, mask/weight parameters,44303,33712 density 0.28463584498355265,0.21659128289473684
before tensor 589824 mask 96014.0 589824
layer3.1.conv2.weight, mask/weight parameters,96014,72841 density 0.4617478454909203,0.35030490150815635
before tensor 262144 mask 69470.0 262144
layer3.1.conv3.weight, mask/weight parameters,69470,55319 density 0.44632761101973684,0.35541092722039475
before tensor 262144 mask 53894.0 262144
layer3.2.conv1.weight, mask/weight parameters,53894,41615 density 0.34625565378289475,0.26736610814144735
before tensor 589824 mask 102633.0 589824
layer3.2.conv2.weight, mask/weight parameters,102633,82996 density 0.49357975530932596,0.3991420437057556
before tensor 262144 mask 73917.0 262144
layer3.2.conv3.weight, mask/weight parameters,73917,60499 density 0.4748984888980263,0.3886911492598684
before tensor 262144 mask 53555.0 262144
layer3.3.conv1.weight, mask/weight parameters,53555,41061 density 0.34407766241776316,0.2638067948190789
before tensor 589824 mask 83901.0 589824
layer3.3.conv2.weight, mask/weight parameters,83901,67193 density 0.4034943444136657,0.3231426977531548
before tensor 262144 mask 60191.0 262144
layer3.3.conv3.weight, mask/weight parameters,60191,47893 density 0.3867123252467105,0.30770070929276316
before tensor 262144 mask 51003.0 262144
layer3.4.conv1.weight, mask/weight parameters,51003,41231 density 0.3276816920230263,0.2648990028782895
before tensor 589824 mask 67072.0 589824
layer3.4.conv2.weight, mask/weight parameters,67072,53138 density 0.3225607879347491,0.25554978454909205
before tensor 262144 mask 47149.0 262144
layer3.4.conv3.weight, mask/weight parameters,47149,36623 density 0.30292069284539475,0.23529373972039475
before tensor 262144 mask 54941.0 262144
layer3.5.conv1.weight, mask/weight parameters,54941,42851 density 0.3529823704769737,0.27530710320723684
before tensor 589824 mask 64314.0 589824
layer3.5.conv2.weight, mask/weight parameters,64314,51324 density 0.30929709141274236,0.24682594644506
before tensor 262144 mask 45420.0 262144
layer3.5.conv3.weight, mask/weight parameters,45420,35829 density 0.29181229440789475,0.23019248560855263
before tensor 524288 mask 169783.0 524288
layer4.0.conv1.weight, mask/weight parameters,169783,138571 density 0.5678209278681506,0.4634357609160959
before tensor 2359296 mask 300393.0 2359296
layer4.0.conv2.weight, mask/weight parameters,300393,229919 density 0.3914547757553012,0.29961713684034946
before tensor 1048576 mask 142828.0 1048576
layer4.0.conv3.weight, mask/weight parameters,142828,102339 density 0.23883641909246575,0.1711308727525685
layer4.0.shortcut.0.weight, mask/weight parameters,216710,147275 density 0.10333538055419922,0.07022619247436523
before tensor 1048576 mask 104885.0 1048576
layer4.1.conv1.weight, mask/weight parameters,104885,79112 density 0.1753882839255137,0.1322907748287671
before tensor 2359296 mask 185864.0 2359296
layer4.1.conv2.weight, mask/weight parameters,185864,141037 density 0.24220721002481183,0.18379125748003586
before tensor 1048576 mask 97990.0 1048576
layer4.1.conv3.weight, mask/weight parameters,97990,68272 density 0.16385849208047945,0.11416416952054795
before tensor 1048576 mask 67071.0 1048576
layer4.2.conv1.weight, mask/weight parameters,67071,46196 density 0.1121558620505137,0.07724876926369863
before tensor 2359296 mask 77258.0 2359296
layer4.2.conv2.weight, mask/weight parameters,77258,49810 density 0.10067815516774045,0.064909509810054
before tensor 1048576 mask 43408.0 1048576
layer4.2.conv3.weight, mask/weight parameters,43408,29136 density 0.07258668664383562,0.0487211044520548
classifier.weight, mask/weight parameters,109062,97676 density 0.532529296875,0.47693359375
Total Model parameters after dst: 3084096 2365205
Total parameters under density level of 0.1: 0.250867128099229 0.19239095855509586 after dst
Death rate: 0.1303946049191954


Training summary: Average loss: 1.2731, Accuracy: 31688/50000 (63.376%)


Evaluation: Average loss: 1.5374, Accuracy: 5843/10000 (58.430%)

Current learning rate: 0.1. Time taken for epoch: 92.55 seconds.

Train Epoch: 56 [0/50000 (0%)]	Loss: 1.024931 Accuracy: 69/100 (69.000%
Train Epoch: 56 [10000/50000 (20%)]	Loss: 1.453975 Accuracy: 6494/10100 (64.297%
Train Epoch: 56 [20000/50000 (40%)]	Loss: 1.432133 Accuracy: 12894/20100 (64.149%
Train Epoch: 56 [30000/50000 (60%)]	Loss: 1.122024 Accuracy: 19348/30100 (64.279%
Train Epoch: 56 [40000/50000 (80%)]	Loss: 1.451303 Accuracy: 25701/40100 (64.092%
current layer rate 0.41146631770596265
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4522.0
Total filter_masks items: 9318319.0
4522.0 / 7552 channels
Total channels to prune: 77.39363131542996
Layer ('layer2', 0, 'conv1'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/83.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 4/292.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 4/292.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 4/292.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 4/292.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 4/292.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 4/292.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4466.0
Total filter_masks items: 9144675.0
After apply_mask:
Total filter_names items: 4466.0
Total filter_masks items: 9144675.0
Total pruned: 56/77.39363131542996 channels
===========done ===============

Training summary: Average loss: 1.2622, Accuracy: 31890/50000 (63.780%)


Evaluation: Average loss: 1.7440, Accuracy: 5330/10000 (53.300%)

Current learning rate: 0.1. Time taken for epoch: 91.16 seconds.

Train Epoch: 57 [0/50000 (0%)]	Loss: 1.174336 Accuracy: 62/100 (62.000%

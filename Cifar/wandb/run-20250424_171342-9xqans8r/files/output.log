


================================================================================

Iteration start: 1/1

==> Preparing data..
Files already downloaded and verified
Files already downloaded and verified
model ResNet50
Growth mode: global_gradients not supported!
Supported modes are: ['random', 'momentum', 'momentum_neuron', 'gradient']
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (3): Bottleneck(
      (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (3): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (4): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (5): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (classifier): Linear(in_features=2048, out_features=100, bias=False)
)
add module
Removing biases...
Removed 53 layers.
Removing 2D batch norms...
Removing bn1 of size torch.Size([64]) = 64 parameters.
Removing layer1.0.bn1 of size torch.Size([64]) = 64 parameters.
Removing layer1.0.bn2 of size torch.Size([64]) = 64 parameters.
Removing layer1.0.bn3 of size torch.Size([256]) = 256 parameters.
Removing layer1.0.shortcut.1 of size torch.Size([256]) = 256 parameters.
Removing layer1.1.bn1 of size torch.Size([64]) = 64 parameters.
Removing layer1.1.bn2 of size torch.Size([64]) = 64 parameters.
Removing layer1.1.bn3 of size torch.Size([256]) = 256 parameters.
Removing layer1.2.bn1 of size torch.Size([64]) = 64 parameters.
Removing layer1.2.bn2 of size torch.Size([64]) = 64 parameters.
Removing layer1.2.bn3 of size torch.Size([256]) = 256 parameters.
Removing layer2.0.bn1 of size torch.Size([128]) = 128 parameters.
Removing layer2.0.bn2 of size torch.Size([128]) = 128 parameters.
Removing layer2.0.bn3 of size torch.Size([512]) = 512 parameters.
Removing layer2.0.shortcut.1 of size torch.Size([512]) = 512 parameters.
Removing layer2.1.bn1 of size torch.Size([128]) = 128 parameters.
Removing layer2.1.bn2 of size torch.Size([128]) = 128 parameters.
Removing layer2.1.bn3 of size torch.Size([512]) = 512 parameters.
Removing layer2.2.bn1 of size torch.Size([128]) = 128 parameters.
Removing layer2.2.bn2 of size torch.Size([128]) = 128 parameters.
Removing layer2.2.bn3 of size torch.Size([512]) = 512 parameters.
Removing layer2.3.bn1 of size torch.Size([128]) = 128 parameters.
Removing layer2.3.bn2 of size torch.Size([128]) = 128 parameters.
Removing layer2.3.bn3 of size torch.Size([512]) = 512 parameters.
Removing layer3.0.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.0.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.0.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.0.shortcut.1 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.1.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.1.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.1.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.2.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.2.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.2.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.3.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.3.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.3.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.4.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.4.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.4.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer3.5.bn1 of size torch.Size([256]) = 256 parameters.
Removing layer3.5.bn2 of size torch.Size([256]) = 256 parameters.
Removing layer3.5.bn3 of size torch.Size([1024]) = 1024 parameters.
Removing layer4.0.bn1 of size torch.Size([512]) = 512 parameters.
Removing layer4.0.bn2 of size torch.Size([512]) = 512 parameters.
Removing layer4.0.bn3 of size torch.Size([2048]) = 2048 parameters.
Removing layer4.0.shortcut.1 of size torch.Size([2048]) = 2048 parameters.
Removing layer4.1.bn1 of size torch.Size([512]) = 512 parameters.
Removing layer4.1.bn2 of size torch.Size([512]) = 512 parameters.
Removing layer4.1.bn3 of size torch.Size([2048]) = 2048 parameters.
Removing layer4.2.bn1 of size torch.Size([512]) = 512 parameters.
Removing layer4.2.bn2 of size torch.Size([512]) = 512 parameters.
Removing layer4.2.bn3 of size torch.Size([2048]) = 2048 parameters.
Removing 1D batch norms...
baseline fitler num 7552
initialize by fixed_ERK
Sparsity of var:conv1.weight had to be set to 0.
Sparsity of var:layer1.0.conv1.weight had to be set to 0.
layer: conv1.weight, shape: torch.Size([64, 3, 3, 3]), density: 1.0
layer: layer1.0.conv1.weight, shape: torch.Size([64, 64, 1, 1]), density: 1.0
layer: layer1.0.conv2.weight, shape: torch.Size([64, 64, 3, 3]), density: 0.16747319723795276
layer: layer1.0.conv3.weight, shape: torch.Size([256, 64, 1, 1]), density: 0.9054800850663938
layer: layer1.0.shortcut.0.weight, shape: torch.Size([256, 64, 1, 1]), density: 0.9054800850663938
layer: layer1.1.conv1.weight, shape: torch.Size([64, 256, 1, 1]), density: 0.9054800850663938
layer: layer1.1.conv2.weight, shape: torch.Size([64, 64, 3, 3]), density: 0.16747319723795276
layer: layer1.1.conv3.weight, shape: torch.Size([256, 64, 1, 1]), density: 0.9054800850663938
layer: layer1.2.conv1.weight, shape: torch.Size([64, 256, 1, 1]), density: 0.9054800850663938
layer: layer1.2.conv2.weight, shape: torch.Size([64, 64, 3, 3]), density: 0.16747319723795276
layer: layer1.2.conv3.weight, shape: torch.Size([256, 64, 1, 1]), density: 0.9054800850663938
layer: layer2.0.conv1.weight, shape: torch.Size([128, 256, 1, 1]), density: 0.5427256410491118
layer: layer2.0.conv2.weight, shape: torch.Size([128, 128, 3, 3]), density: 0.08186189864989481
layer: layer2.0.conv3.weight, shape: torch.Size([512, 128, 1, 1]), density: 0.4513340175563857
layer: layer2.0.shortcut.0.weight, shape: torch.Size([512, 256, 1, 1]), density: 0.2706598080361503
layer: layer2.1.conv1.weight, shape: torch.Size([128, 512, 1, 1]), density: 0.4513340175563857
layer: layer2.1.conv2.weight, shape: torch.Size([128, 128, 3, 3]), density: 0.08186189864989481
layer: layer2.1.conv3.weight, shape: torch.Size([512, 128, 1, 1]), density: 0.4513340175563857
layer: layer2.2.conv1.weight, shape: torch.Size([128, 512, 1, 1]), density: 0.4513340175563857
layer: layer2.2.conv2.weight, shape: torch.Size([128, 128, 3, 3]), density: 0.08186189864989481
layer: layer2.2.conv3.weight, shape: torch.Size([512, 128, 1, 1]), density: 0.4513340175563857
layer: layer2.3.conv1.weight, shape: torch.Size([128, 512, 1, 1]), density: 0.4513340175563857
layer: layer2.3.conv2.weight, shape: torch.Size([128, 128, 3, 3]), density: 0.08186189864989481
layer: layer2.3.conv3.weight, shape: torch.Size([512, 128, 1, 1]), density: 0.4513340175563857
layer: layer3.0.conv1.weight, shape: torch.Size([256, 512, 1, 1]), density: 0.2706598080361503
layer: layer3.0.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.0.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer3.0.shortcut.0.weight, shape: torch.Size([1024, 512, 1, 1]), density: 0.13515415089597377
layer: layer3.1.conv1.weight, shape: torch.Size([256, 1024, 1, 1]), density: 0.22531550253399008
layer: layer3.1.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.1.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer3.2.conv1.weight, shape: torch.Size([256, 1024, 1, 1]), density: 0.22531550253399008
layer: layer3.2.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.2.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer3.3.conv1.weight, shape: torch.Size([256, 1024, 1, 1]), density: 0.22531550253399008
layer: layer3.3.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.3.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer3.4.conv1.weight, shape: torch.Size([256, 1024, 1, 1]), density: 0.22531550253399008
layer: layer3.4.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.4.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer3.5.conv1.weight, shape: torch.Size([256, 1024, 1, 1]), density: 0.22531550253399008
layer: layer3.5.conv2.weight, shape: torch.Size([256, 256, 3, 3]), density: 0.04046227433267702
layer: layer3.5.conv3.weight, shape: torch.Size([1024, 256, 1, 1]), density: 0.22531550253399008
layer: layer4.0.conv1.weight, shape: torch.Size([512, 1024, 1, 1]), density: 0.13515415089597377
layer: layer4.0.conv2.weight, shape: torch.Size([512, 512, 3, 3]), density: 0.02011396841827091
layer: layer4.0.conv3.weight, shape: torch.Size([2048, 512, 1, 1]), density: 0.11256987470594433
layer: layer4.0.shortcut.0.weight, shape: torch.Size([2048, 1024, 1, 1]), density: 0.06753313716746152
layer: layer4.1.conv1.weight, shape: torch.Size([512, 2048, 1, 1]), density: 0.11256987470594433
layer: layer4.1.conv2.weight, shape: torch.Size([512, 512, 3, 3]), density: 0.02011396841827091
layer: layer4.1.conv3.weight, shape: torch.Size([2048, 512, 1, 1]), density: 0.11256987470594433
layer: layer4.2.conv1.weight, shape: torch.Size([512, 2048, 1, 1]), density: 0.11256987470594433
layer: layer4.2.conv2.weight, shape: torch.Size([512, 512, 3, 3]), density: 0.02011396841827091
layer: layer4.2.conv3.weight, shape: torch.Size([2048, 512, 1, 1]), density: 0.11256987470594433
layer: classifier.weight, shape: torch.Size([100, 2048]), density: 0.48322266403046304
Overall sparsity 0.10000000000000005
conv1.weight 1728
layer1.0.conv1.weight 4096
layer1.0.conv2.weight 36864
layer1.0.conv3.weight 16384
layer1.0.shortcut.0.weight 16384
layer1.1.conv1.weight 16384
layer1.1.conv2.weight 36864
layer1.1.conv3.weight 16384
layer1.2.conv1.weight 16384
layer1.2.conv2.weight 36864
layer1.2.conv3.weight 16384
layer2.0.conv1.weight 32768
layer2.0.conv2.weight 147456
layer2.0.conv3.weight 65536
layer2.0.shortcut.0.weight 131072
layer2.1.conv1.weight 65536
layer2.1.conv2.weight 147456
layer2.1.conv3.weight 65536
layer2.2.conv1.weight 65536
layer2.2.conv2.weight 147456
layer2.2.conv3.weight 65536
layer2.3.conv1.weight 65536
layer2.3.conv2.weight 147456
layer2.3.conv3.weight 65536
layer3.0.conv1.weight 131072
layer3.0.conv2.weight 589824
layer3.0.conv3.weight 262144
layer3.0.shortcut.0.weight 524288
layer3.1.conv1.weight 262144
layer3.1.conv2.weight 589824
layer3.1.conv3.weight 262144
layer3.2.conv1.weight 262144
layer3.2.conv2.weight 589824
layer3.2.conv3.weight 262144
layer3.3.conv1.weight 262144
layer3.3.conv2.weight 589824
layer3.3.conv3.weight 262144
layer3.4.conv1.weight 262144
layer3.4.conv2.weight 589824
layer3.4.conv3.weight 262144
layer3.5.conv1.weight 262144
layer3.5.conv2.weight 589824
layer3.5.conv3.weight 262144
layer4.0.conv1.weight 524288
layer4.0.conv2.weight 2359296
layer4.0.conv3.weight 1048576
layer4.0.shortcut.0.weight 2097152
layer4.1.conv1.weight 1048576
layer4.1.conv2.weight 2359296
layer4.1.conv3.weight 1048576
layer4.2.conv1.weight 1048576
layer4.2.conv2.weight 2359296
layer4.2.conv3.weight 1048576
classifier.weight 204800
Total Model parameters after init: 2367257 23652032
Total parameters under sparsity level of 0.1: 0.10008683397688621
save_dir ./Chase_models/saved_models/test/density_0.1/stop_gmp_epochs_130/epoch_160/layer_interval_1000/start_layer_rate_0.5
=====================================
begin pre training
Train Epoch: 0 [0/50000 (0%)]	Loss: 4.644446 Accuracy: 0/100 (0.000%
Train Epoch: 0 [10000/50000 (20%)]	Loss: 4.588133 Accuracy: 118/10100 (1.168%
Train Epoch: 0 [20000/50000 (40%)]	Loss: 4.315729 Accuracy: 394/20100 (1.960%
Train Epoch: 0 [30000/50000 (60%)]	Loss: 4.157476 Accuracy: 853/30100 (2.834%
Train Epoch: 0 [40000/50000 (80%)]	Loss: 3.974595 Accuracy: 1520/40100 (3.791%
current layer rate 0.011449931725079632
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 7552.0
Total filter_masks items: 20676608.0
7552.0 / 7552 channels
Total channels to prune: 86.46988438780136
Layer ('layer2', 0, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 5/512.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 5/512.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 5/512.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 5/512.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 5/512.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 5/512.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 7490.0
Total filter_masks items: 20391071.0
After apply_mask:
Total filter_names items: 7490.0
Total filter_masks items: 20391071.0
Total pruned: 62/86.46988438780136 channels
===========done ===============

Training summary: Average loss: 4.4043, Accuracy: 2301/50000 (4.602%)


Evaluation: Average loss: 3.8712, Accuracy: 902/10000 (9.020%)

Current learning rate: 0.1. Time taken for epoch: 91.49 seconds.

Train Epoch: 1 [0/50000 (0%)]	Loss: 3.756457 Accuracy: 14/100 (14.000%
Train Epoch: 1 [10000/50000 (20%)]	Loss: 3.773712 Accuracy: 970/10100 (9.604%
Train Epoch: 1 [20000/50000 (40%)]	Loss: 3.746484 Accuracy: 2065/20100 (10.274%
Train Epoch: 1 [30000/50000 (60%)]	Loss: 3.450678 Accuracy: 3336/30100 (11.083%
Train Epoch: 1 [40000/50000 (80%)]	Loss: 3.497306 Accuracy: 4751/40100 (11.848%
current mest  death_rate 0.14997080567080823


dynamic sparse change prune
to kill -17509.200000001118 expect 2365203.200000001
conv1.weight, mask/weight parameters,1728,1728 density 1.0,1.0
before tensor 4096 mask 4096.0 4096
layer1.0.conv1.weight, mask/weight parameters,4096,4096 density 1.0,1.0
before tensor 36864 mask 6206.0 36864
layer1.0.conv2.weight, mask/weight parameters,6206,6206 density 0.16834852430555555,0.16834852430555555
before tensor 16384 mask 14835.0 16384
layer1.0.conv3.weight, mask/weight parameters,14835,14835 density 0.90545654296875,0.90545654296875
layer1.0.shortcut.0.weight, mask/weight parameters,14829,14829 density 0.90509033203125,0.90509033203125
before tensor 16384 mask 14823.0 16384
layer1.1.conv1.weight, mask/weight parameters,14823,14823 density 0.90472412109375,0.90472412109375
before tensor 36864 mask 6155.0 36864
layer1.1.conv2.weight, mask/weight parameters,6155,6155 density 0.1669650607638889,0.1669650607638889
before tensor 16384 mask 14857.0 16384
layer1.1.conv3.weight, mask/weight parameters,14857,14857 density 0.90679931640625,0.90679931640625
before tensor 16384 mask 14849.0 16384
layer1.2.conv1.weight, mask/weight parameters,14849,14849 density 0.90631103515625,0.90631103515625
before tensor 36864 mask 6104.0 36864
layer1.2.conv2.weight, mask/weight parameters,6104,6104 density 0.1655815972222222,0.1655815972222222
before tensor 16384 mask 14785.0 16384
layer1.2.conv3.weight, mask/weight parameters,14785,14785 density 0.90240478515625,0.90240478515625
before tensor 32768 mask 17695.0 32768
layer2.0.conv1.weight, mask/weight parameters,17695,17695 density 0.5442605807086615,0.5442605807086615
before tensor 147456 mask 11943.0 147456
layer2.0.conv2.weight, mask/weight parameters,11943,11943 density 0.0822741645483291,0.0822741645483291
before tensor 65536 mask 29297.0 65536
layer2.0.conv3.weight, mask/weight parameters,29297,29297 density 0.450556717519685,0.450556717519685
layer2.0.shortcut.0.weight, mask/weight parameters,35383,35383 density 0.26995086669921875,0.26995086669921875
before tensor 65536 mask 29288.0 65536
layer2.1.conv1.weight, mask/weight parameters,29288,29288 density 0.4504183070866142,0.4504183070866142
before tensor 147456 mask 11904.0 147456
layer2.1.conv2.weight, mask/weight parameters,11904,11904 density 0.08200549734432802,0.08200549734432802
before tensor 65536 mask 29353.0 65536
layer2.1.conv3.weight, mask/weight parameters,29353,29353 density 0.451417937992126,0.451417937992126
before tensor 65536 mask 29603.0 65536
layer2.2.conv1.weight, mask/weight parameters,29603,29603 density 0.4552626722440945,0.4552626722440945
before tensor 147456 mask 11894.0 147456
layer2.2.conv2.weight, mask/weight parameters,11894,11894 density 0.08193660831766109,0.08193660831766109
before tensor 65536 mask 29292.0 65536
layer2.2.conv3.weight, mask/weight parameters,29292,29292 density 0.45047982283464566,0.45047982283464566
before tensor 65536 mask 29334.0 65536
layer2.3.conv1.weight, mask/weight parameters,29334,29334 density 0.4511257381889764,0.4511257381889764
before tensor 147456 mask 11941.0 147456
layer2.3.conv2.weight, mask/weight parameters,11941,11941 density 0.08226038674299571,0.08226038674299571
before tensor 65536 mask 29452.0 65536
layer2.3.conv3.weight, mask/weight parameters,29452,29452 density 0.4529404527559055,0.4529404527559055
before tensor 131072 mask 35252.0 131072
layer3.0.conv1.weight, mask/weight parameters,35252,35252 density 0.2710691437007874,0.2710691437007874
before tensor 589824 mask 23569.0 589824
layer3.0.conv2.weight, mask/weight parameters,23569,23569 density 0.040591136737829034,0.040591136737829034
before tensor 262144 mask 58661.0 262144
layer3.0.conv3.weight, mask/weight parameters,58661,58661 density 0.22553595595472442,0.22553595595472442
layer3.0.shortcut.0.weight, mask/weight parameters,70817,70817 density 0.1350727081298828,0.1350727081298828
before tensor 262144 mask 58920.0 262144
layer3.1.conv1.weight, mask/weight parameters,58920,58920 density 0.22653174212598426,0.22653174212598426
before tensor 589824 mask 23662.0 589824
layer3.1.conv2.weight, mask/weight parameters,23662,23662 density 0.04075130372482967,0.04075130372482967
before tensor 262144 mask 58388.0 262144
layer3.1.conv3.weight, mask/weight parameters,58388,58388 density 0.224486343503937,0.224486343503937
before tensor 262144 mask 58178.0 262144
layer3.2.conv1.weight, mask/weight parameters,58178,58178 density 0.2236789493110236,0.2236789493110236
before tensor 589824 mask 23159.0 589824
layer3.2.conv2.weight, mask/weight parameters,23159,23159 density 0.03988502421449287,0.03988502421449287
before tensor 262144 mask 58811.0 262144
layer3.2.conv3.weight, mask/weight parameters,58811,58811 density 0.22611266609251968,0.22611266609251968
before tensor 262144 mask 58699.0 262144
layer3.3.conv1.weight, mask/weight parameters,58699,58699 density 0.22568205585629922,0.22568205585629922
before tensor 589824 mask 23667.0 589824
layer3.3.conv2.weight, mask/weight parameters,23667,23667 density 0.04075991485316304,0.04075991485316304
before tensor 262144 mask 58916.0 262144
layer3.3.conv3.weight, mask/weight parameters,58916,58916 density 0.2265163631889764,0.2265163631889764
before tensor 262144 mask 58549.0 262144
layer3.4.conv1.weight, mask/weight parameters,58549,58549 density 0.22510534571850394,0.22510534571850394
before tensor 589824 mask 23508.0 589824
layer3.4.conv2.weight, mask/weight parameters,23508,23508 density 0.04048608097216194,0.04048608097216194
before tensor 262144 mask 58081.0 262144
layer3.4.conv3.weight, mask/weight parameters,58081,58081 density 0.22330601008858267,0.22330601008858267
before tensor 262144 mask 58621.0 262144
layer3.5.conv1.weight, mask/weight parameters,58621,58621 density 0.22538216658464566,0.22538216658464566
before tensor 589824 mask 23554.0 589824
layer3.5.conv2.weight, mask/weight parameters,23554,23554 density 0.04056530335282893,0.04056530335282893
before tensor 262144 mask 58669.0 262144
layer3.5.conv3.weight, mask/weight parameters,58669,58669 density 0.22556671382874016,0.22556671382874016
before tensor 524288 mask 70119.0 524288
layer4.0.conv1.weight, mask/weight parameters,70119,70119 density 0.1350603272928994,0.1350603272928994
before tensor 2359296 mask 47078.0 2359296
layer4.0.conv2.weight, mask/weight parameters,47078,47078 density 0.02034977334628374,0.02034977334628374
before tensor 1048576 mask 116948.0 1048576
layer4.0.conv3.weight, mask/weight parameters,116948,116948 density 0.11263020833333333,0.11263020833333333
layer4.0.shortcut.0.weight, mask/weight parameters,142133,142133 density 0.06777429580688477,0.06777429580688477
before tensor 1048576 mask 117436.0 1048576
layer4.1.conv1.weight, mask/weight parameters,117436,117436 density 0.11310019107495069,0.11310019107495069
before tensor 2359296 mask 46354.0 2359296
layer4.1.conv2.weight, mask/weight parameters,46354,46354 density 0.020036819611997884,0.020036819611997884
before tensor 1048576 mask 116899.0 1048576
layer4.1.conv3.weight, mask/weight parameters,116899,116899 density 0.11258301744329388,0.11258301744329388
before tensor 1048576 mask 116712.0 1048576
layer4.2.conv1.weight, mask/weight parameters,116712,116712 density 0.11240292159763314,0.11240292159763314
before tensor 2359296 mask 46602.0 2359296
layer4.2.conv2.weight, mask/weight parameters,46602,46602 density 0.02014401923368696,0.02014401923368696
before tensor 1048576 mask 117208.0 1048576
layer4.2.conv3.weight, mask/weight parameters,117208,117208 density 0.11288060897435898,0.11288060897435898
classifier.weight, mask/weight parameters,98878,98878 density 0.482802734375,0.482802734375
Total Model parameters after dst: 2347694 2347694
Total parameters under density level of 0.1: 0.10047266395751694 0.10047266395751694 after dst
Death rate: 0.14997080567080823

dynamic sparse change grow
self.total_params*pruning_rate 3547114.2947917376
self.total_nonzero 2347694.0
to grow 1199420.2947917376
len(all_scores) 23366495 21018800
increse 1199420.0 before_mask 3547113.0 after_mask 3547113.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1728,1728 density 1.0,1.0
before tensor 4096 mask 4096.0 4096
layer1.0.conv1.weight, mask/weight parameters,4096,4096 density 1.0,1.0
before tensor 36864 mask 9341.0 36864
layer1.0.conv2.weight, mask/weight parameters,9341,6206 density 0.2533908420138889,0.16834852430555555
before tensor 16384 mask 15065.0 16384
layer1.0.conv3.weight, mask/weight parameters,15065,14835 density 0.91949462890625,0.90545654296875
layer1.0.shortcut.0.weight, mask/weight parameters,15066,14829 density 0.9195556640625,0.90509033203125
before tensor 16384 mask 14864.0 16384
layer1.1.conv1.weight, mask/weight parameters,14864,14823 density 0.9072265625,0.90472412109375
before tensor 36864 mask 6832.0 36864
layer1.1.conv2.weight, mask/weight parameters,6832,6155 density 0.1853298611111111,0.1669650607638889
before tensor 16384 mask 14946.0 16384
layer1.1.conv3.weight, mask/weight parameters,14946,14857 density 0.9122314453125,0.90679931640625
before tensor 16384 mask 14852.0 16384
layer1.2.conv1.weight, mask/weight parameters,14852,14849 density 0.906494140625,0.90631103515625
before tensor 36864 mask 6187.0 36864
layer1.2.conv2.weight, mask/weight parameters,6187,6104 density 0.16783311631944445,0.1655815972222222
before tensor 16384 mask 14809.0 16384
layer1.2.conv3.weight, mask/weight parameters,14809,14785 density 0.90386962890625,0.90240478515625
before tensor 32768 mask 18372.0 32768
layer2.0.conv1.weight, mask/weight parameters,18372,17695 density 0.5650836614173228,0.5442605807086615
before tensor 147456 mask 15496.0 147456
layer2.0.conv2.weight, mask/weight parameters,15496,11943 density 0.10675043572309367,0.0822741645483291
before tensor 65536 mask 30380.0 65536
layer2.0.conv3.weight, mask/weight parameters,30380,29297 density 0.4672121062992126,0.450556717519685
layer2.0.shortcut.0.weight, mask/weight parameters,46426,35383 density 0.3542022705078125,0.26995086669921875
before tensor 65536 mask 30631.0 65536
layer2.1.conv1.weight, mask/weight parameters,30631,29288 density 0.471072219488189,0.4504183070866142
before tensor 147456 mask 19721.0 147456
layer2.1.conv2.weight, mask/weight parameters,19721,11904 density 0.13585604948987676,0.08200549734432802
before tensor 65536 mask 30313.0 65536
layer2.1.conv3.weight, mask/weight parameters,30313,29353 density 0.466181717519685,0.451417937992126
before tensor 65536 mask 29971.0 65536
layer2.2.conv1.weight, mask/weight parameters,29971,29603 density 0.46092212106299213,0.4552626722440945
before tensor 147456 mask 18021.0 147456
layer2.2.conv2.weight, mask/weight parameters,18021,11894 density 0.12414491495649659,0.08193660831766109
before tensor 65536 mask 29922.0 65536
layer2.2.conv3.weight, mask/weight parameters,29922,29292 density 0.4601685531496063,0.45047982283464566
before tensor 65536 mask 30281.0 65536
layer2.3.conv1.weight, mask/weight parameters,30281,29334 density 0.46568959153543305,0.4511257381889764
before tensor 147456 mask 18469.0 147456
layer2.3.conv2.weight, mask/weight parameters,18469,11941 density 0.12723114335117558,0.08226038674299571
before tensor 65536 mask 30054.0 65536
layer2.3.conv3.weight, mask/weight parameters,30054,29452 density 0.46219857283464566,0.4529404527559055
before tensor 131072 mask 39106.0 131072
layer3.0.conv1.weight, mask/weight parameters,39106,35252 density 0.30070435531496065,0.2710691437007874
before tensor 589824 mask 54113.0 589824
layer3.0.conv2.weight, mask/weight parameters,54113,23569 density 0.09319479750070611,0.040591136737829034
before tensor 262144 mask 65627.0 262144
layer3.0.conv3.weight, mask/weight parameters,65627,58661 density 0.252318374753937,0.22553595595472442
layer3.0.shortcut.0.weight, mask/weight parameters,96462,70817 density 0.18398666381835938,0.1350727081298828
before tensor 262144 mask 67673.0 262144
layer3.1.conv1.weight, mask/weight parameters,67673,58920 density 0.2601847010334646,0.22653174212598426
before tensor 589824 mask 123118.0 589824
layer3.1.conv2.weight, mask/weight parameters,123118,23662 density 0.21203697962951482,0.04075130372482967
before tensor 262144 mask 74365.0 262144
layer3.1.conv3.weight, mask/weight parameters,74365,58388 density 0.2859136626476378,0.224486343503937
before tensor 262144 mask 66014.0 262144
layer3.2.conv1.weight, mask/weight parameters,66014,58178 density 0.25380628690944884,0.2236789493110236
before tensor 589824 mask 79805.0 589824
layer3.2.conv2.weight, mask/weight parameters,79805,23159 density 0.1374422193288831,0.03988502421449287
before tensor 262144 mask 66140.0 262144
layer3.2.conv3.weight, mask/weight parameters,66140,58811 density 0.2542907234251969,0.22611266609251968
before tensor 262144 mask 62757.0 262144
layer3.3.conv1.weight, mask/weight parameters,62757,58699 density 0.2412839874507874,0.22568205585629922
before tensor 589824 mask 56241.0 589824
layer3.3.conv2.weight, mask/weight parameters,56241,23667 density 0.09685969371938744,0.04075991485316304
before tensor 262144 mask 62203.0 262144
layer3.3.conv3.weight, mask/weight parameters,62203,58916 density 0.23915400467519685,0.2265163631889764
before tensor 262144 mask 60219.0 262144
layer3.4.conv1.weight, mask/weight parameters,60219,58549 density 0.23152605191929135,0.22510534571850394
before tensor 589824 mask 41815.0 589824
layer3.4.conv2.weight, mask/weight parameters,41815,23508 density 0.07201486625195473,0.04048608097216194
before tensor 262144 mask 59894.0 262144
layer3.4.conv3.weight, mask/weight parameters,59894,58081 density 0.23027651328740156,0.22330601008858267
before tensor 262144 mask 59440.0 262144
layer3.5.conv1.weight, mask/weight parameters,59440,58621 density 0.22853100393700787,0.22538216658464566
before tensor 589824 mask 33256.0 589824
layer3.5.conv2.weight, mask/weight parameters,33256,23554 density 0.057274336770895766,0.04056530335282893
before tensor 262144 mask 59425.0 262144
layer3.5.conv3.weight, mask/weight parameters,59425,58669 density 0.22847333292322836,0.22556671382874016
before tensor 524288 mask 77953.0 524288
layer4.0.conv1.weight, mask/weight parameters,77953,70119 density 0.15014985515285997,0.1350603272928994
before tensor 2359296 mask 102021.0 2359296
layer4.0.conv2.weight, mask/weight parameters,102021,47078 density 0.044099244372344054,0.02034977334628374
before tensor 1048576 mask 127086.0 1048576
layer4.0.conv3.weight, mask/weight parameters,127086,116948 density 0.12239390717455621,0.11263020833333333
layer4.0.shortcut.0.weight, mask/weight parameters,235898,142133 density 0.11248493194580078,0.06777429580688477
before tensor 1048576 mask 158635.0 1048576
layer4.1.conv1.weight, mask/weight parameters,158635,117436 density 0.15277809880424062,0.11310019107495069
before tensor 2359296 mask 519185.0 2359296
layer4.1.conv2.weight, mask/weight parameters,519185,46354 density 0.22442111123646552,0.020036819611997884
before tensor 1048576 mask 192430.0 1048576
layer4.1.conv3.weight, mask/weight parameters,192430,116899 density 0.18532536674063116,0.11258301744329388
before tensor 1048576 mask 121217.0 1048576
layer4.2.conv1.weight, mask/weight parameters,121217,116712 density 0.11674159424309664,0.11240292159763314
before tensor 2359296 mask 76711.0 2359296
layer4.2.conv2.weight, mask/weight parameters,76711,46602 density 0.033158831368511235,0.02014401923368696
before tensor 1048576 mask 125661.0 1048576
layer4.2.conv3.weight, mask/weight parameters,125661,117208 density 0.12102151904585799,0.11288060897435898
classifier.weight, mask/weight parameters,116800,98878 density 0.5703125,0.482802734375
Total Model parameters after dst: 3547113 2347694
Total parameters under density level of 0.1: 0.15180338343427202 0.10047266395751694 after dst
Death rate: 0.14997080567080823


Training summary: Average loss: 3.6893, Accuracy: 6228/50000 (12.456%)


Evaluation: Average loss: 3.5081, Accuracy: 1679/10000 (16.790%)

Current learning rate: 0.1. Time taken for epoch: 90.51 seconds.

Train Epoch: 2 [0/50000 (0%)]	Loss: 3.455348 Accuracy: 17/100 (17.000%
Train Epoch: 2 [10000/50000 (20%)]	Loss: 3.652415 Accuracy: 1344/10100 (13.307%
Train Epoch: 2 [20000/50000 (40%)]	Loss: 3.322376 Accuracy: 2934/20100 (14.597%
Train Epoch: 2 [30000/50000 (60%)]	Loss: 3.044296 Accuracy: 4773/30100 (15.857%
Train Epoch: 2 [40000/50000 (80%)]	Loss: 3.463454 Accuracy: 6692/40100 (16.688%
current layer rate 0.03382271279016846
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 7490.0
Total filter_masks items: 20391071.0
7490.0 / 7552 channels
Total channels to prune: 193.42912699135195
Layer ('layer1', 0, 'conv1'): Pruned 1/64.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/64.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/64.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/64.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/64.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/64.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 3/127.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 3/127.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 6/254.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 6/254.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 13/507.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 13/507.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 13/507.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 13/507.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 13/507.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 13/507.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 7310.0
Total filter_masks items: 19616583.0
After apply_mask:
Total filter_names items: 7310.0
Total filter_masks items: 19616583.0
Total pruned: 180/193.42912699135195 channels
===========done ===============

Training summary: Average loss: 3.3937, Accuracy: 8756/50000 (17.512%)


Evaluation: Average loss: 3.5970, Accuracy: 1560/10000 (15.600%)

Current learning rate: 0.1. Time taken for epoch: 91.11 seconds.

Train Epoch: 3 [0/50000 (0%)]	Loss: 3.080323 Accuracy: 23/100 (23.000%
Train Epoch: 3 [10000/50000 (20%)]	Loss: 3.148507 Accuracy: 2339/10100 (23.158%
Train Epoch: 3 [20000/50000 (40%)]	Loss: 2.700975 Accuracy: 4664/20100 (23.204%
Train Epoch: 3 [30000/50000 (60%)]	Loss: 3.155693 Accuracy: 7174/30100 (23.834%
Train Epoch: 3 [40000/50000 (80%)]	Loss: 3.117637 Accuracy: 9880/40100 (24.638%
current mest  death_rate 0.14988329086794133


dynamic sparse change prune
to kill 1010708.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1686,1686 density 0.9756944444444444,0.9756944444444444
before tensor 4096 mask 3805.0 4096
layer1.0.conv1.weight, mask/weight parameters,3805,3805 density 0.9437003968253969,0.9437003968253969
before tensor 36864 mask 8131.0 36864
layer1.0.conv2.weight, mask/weight parameters,8131,8131 density 0.2276252064611853,0.2276252064611853
before tensor 16384 mask 13301.0 16384
layer1.0.conv3.weight, mask/weight parameters,13301,13301 density 0.8247147817460317,0.8247147817460317
layer1.0.shortcut.0.weight, mask/weight parameters,13423,13423 density 0.81927490234375,0.81927490234375
before tensor 16384 mask 12966.0 16384
layer1.1.conv1.weight, mask/weight parameters,12966,12966 density 0.8039434523809523,0.8039434523809523
before tensor 36864 mask 6026.0 36864
layer1.1.conv2.weight, mask/weight parameters,6026,6026 density 0.1686962850984015,0.1686962850984015
before tensor 16384 mask 12883.0 16384
layer1.1.conv3.weight, mask/weight parameters,12883,12883 density 0.798797123015873,0.798797123015873
before tensor 16384 mask 12587.0 16384
layer1.2.conv1.weight, mask/weight parameters,12587,12587 density 0.7804439484126984,0.7804439484126984
before tensor 36864 mask 5465.0 36864
layer1.2.conv2.weight, mask/weight parameters,5465,5465 density 0.1529912376473223,0.1529912376473223
before tensor 16384 mask 12677.0 16384
layer1.2.conv3.weight, mask/weight parameters,12677,12677 density 0.7860243055555556,0.7860243055555556
before tensor 32768 mask 15074.0 32768
layer2.0.conv1.weight, mask/weight parameters,15074,15074 density 0.47486139112903225,0.47486139112903225
before tensor 147456 mask 12320.0 147456
layer2.0.conv2.weight, mask/weight parameters,12320,12320 density 0.08902763325239912,0.08902763325239912
before tensor 65536 mask 24344.0 65536
layer2.0.conv3.weight, mask/weight parameters,24344,24344 density 0.3834425403225806,0.3834425403225806
layer2.0.shortcut.0.weight, mask/weight parameters,37537,37537 density 0.28638458251953125,0.28638458251953125
before tensor 65536 mask 23863.0 65536
layer2.1.conv1.weight, mask/weight parameters,23863,23863 density 0.3758663054435484,0.3758663054435484
before tensor 147456 mask 14745.0 147456
layer2.1.conv2.weight, mask/weight parameters,14745,14745 density 0.10655133541449878,0.10655133541449878
before tensor 65536 mask 24491.0 65536
layer2.1.conv3.weight, mask/weight parameters,24491,24491 density 0.3857579385080645,0.3857579385080645
before tensor 65536 mask 22613.0 65536
layer2.2.conv1.weight, mask/weight parameters,22613,22613 density 0.35617754536290325,0.35617754536290325
before tensor 147456 mask 13030.0 147456
layer2.2.conv2.weight, mask/weight parameters,13030,13030 density 0.0941582841947046,0.0941582841947046
before tensor 65536 mask 23858.0 65536
layer2.2.conv3.weight, mask/weight parameters,23858,23858 density 0.3757875504032258,0.3757875504032258
before tensor 65536 mask 22427.0 65536
layer2.3.conv1.weight, mask/weight parameters,22427,22427 density 0.35324785786290325,0.35324785786290325
before tensor 147456 mask 13279.0 147456
layer2.3.conv2.weight, mask/weight parameters,13279,13279 density 0.09595762515897792,0.09595762515897792
before tensor 65536 mask 23942.0 65536
layer2.3.conv3.weight, mask/weight parameters,23942,23942 density 0.3771106350806452,0.3771106350806452
before tensor 131072 mask 29546.0 131072
layer3.0.conv1.weight, mask/weight parameters,29546,29546 density 0.23268964213709678,0.23268964213709678
before tensor 589824 mask 35484.0 589824
layer3.0.conv2.weight, mask/weight parameters,35484,35484 density 0.06410423170308706,0.06410423170308706
before tensor 262144 mask 49938.0 262144
layer3.0.conv3.weight, mask/weight parameters,49938,49938 density 0.19664346018145162,0.19664346018145162
layer3.0.shortcut.0.weight, mask/weight parameters,69995,69995 density 0.13350486755371094,0.13350486755371094
before tensor 262144 mask 46487.0 262144
layer3.1.conv1.weight, mask/weight parameters,46487,46487 density 0.1830542779737903,0.1830542779737903
before tensor 589824 mask 77645.0 589824
layer3.1.conv2.weight, mask/weight parameters,77645,77645 density 0.1402709128222916,0.1402709128222916
before tensor 262144 mask 56626.0 262144
layer3.1.conv3.weight, mask/weight parameters,56626,56626 density 0.2229791456653226,0.2229791456653226
before tensor 262144 mask 45751.0 262144
layer3.2.conv1.weight, mask/weight parameters,45751,45751 density 0.18015609248991934,0.18015609248991934
before tensor 589824 mask 51314.0 589824
layer3.2.conv2.weight, mask/weight parameters,51314,51314 density 0.09270219100474043,0.09270219100474043
before tensor 262144 mask 49481.0 262144
layer3.2.conv3.weight, mask/weight parameters,49481,49481 density 0.19484390751008066,0.19484390751008066
before tensor 262144 mask 41628.0 262144
layer3.3.conv1.weight, mask/weight parameters,41628,41628 density 0.16392074092741934,0.16392074092741934
before tensor 589824 mask 34257.0 589824
layer3.3.conv2.weight, mask/weight parameters,34257,34257 density 0.061887573707943115,0.061887573707943115
before tensor 262144 mask 45542.0 262144
layer3.3.conv3.weight, mask/weight parameters,45542,45542 density 0.17933310231854838,0.17933310231854838
before tensor 262144 mask 39430.0 262144
layer3.4.conv1.weight, mask/weight parameters,39430,39430 density 0.15526556199596775,0.15526556199596775
before tensor 589824 mask 27475.0 589824
layer3.4.conv2.weight, mask/weight parameters,27475,27475 density 0.049635434732339,0.049635434732339
before tensor 262144 mask 44038.0 262144
layer3.4.conv3.weight, mask/weight parameters,44038,44038 density 0.1734107232862903,0.1734107232862903
before tensor 262144 mask 38543.0 262144
layer3.5.conv1.weight, mask/weight parameters,38543,38543 density 0.15177277595766128,0.15177277595766128
before tensor 589824 mask 22797.0 589824
layer3.5.conv2.weight, mask/weight parameters,22797,22797 density 0.04118431321540062,0.04118431321540062
before tensor 262144 mask 43448.0 262144
layer3.5.conv3.weight, mask/weight parameters,43448,43448 density 0.1710874495967742,0.1710874495967742
before tensor 524288 mask 52441.0 524288
layer4.0.conv1.weight, mask/weight parameters,52441,52441 density 0.10366784223178138,0.10366784223178138
before tensor 2359296 mask 54753.0 2359296
layer4.0.conv2.weight, mask/weight parameters,54753,54753 density 0.02492938200374808,0.02492938200374808
before tensor 1048576 mask 84318.0 1048576
layer4.0.conv3.weight, mask/weight parameters,84318,84318 density 0.08334189967105263,0.08334189967105263
layer4.0.shortcut.0.weight, mask/weight parameters,158746,158746 density 0.07569599151611328,0.07569599151611328
before tensor 1048576 mask 100268.0 1048576
layer4.1.conv1.weight, mask/weight parameters,100268,100268 density 0.09910725581983805,0.09910725581983805
before tensor 2359296 mask 280318.0 2359296
layer4.1.conv2.weight, mask/weight parameters,280318,280318 density 0.12763053174303973,0.12763053174303973
before tensor 1048576 mask 136179.0 1048576
layer4.1.conv3.weight, mask/weight parameters,136179,136179 density 0.13460253510880565,0.13460253510880565
before tensor 1048576 mask 59050.0 1048576
layer4.2.conv1.weight, mask/weight parameters,59050,59050 density 0.05836641257591093,0.05836641257591093
before tensor 2359296 mask 37155.0 2359296
layer4.2.conv2.weight, mask/weight parameters,37155,37155 density 0.016916902970599966,0.016916902970599966
before tensor 1048576 mask 80602.0 1048576
layer4.2.conv3.weight, mask/weight parameters,80602,80602 density 0.07966891763663968,0.07966891763663968
classifier.weight, mask/weight parameters,97477,97477 density 0.4759619140625,0.4759619140625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.1046921152246456 0.1046921152246456 after dst
Death rate: 0.14988329086794133

dynamic sparse change grow
self.total_params*pruning_rate 3545044.391873856
self.total_nonzero 2365205.0
to grow 1179839.391873856
len(all_scores) 22592007 20226744
increse 1179839.0 before_mask 3545043.0 after_mask 3545043.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1705,1686 density 0.9866898148148148,0.9756944444444444
before tensor 4096 mask 3849.0 4096
layer1.0.conv1.weight, mask/weight parameters,3849,3805 density 0.9546130952380952,0.9437003968253969
before tensor 36864 mask 13169.0 36864
layer1.0.conv2.weight, mask/weight parameters,13169,8131 density 0.36866269141401414,0.2276252064611853
before tensor 16384 mask 13786.0 16384
layer1.0.conv3.weight, mask/weight parameters,13786,13301 density 0.8547867063492064,0.8247147817460317
layer1.0.shortcut.0.weight, mask/weight parameters,13936,13423 density 0.8505859375,0.81927490234375
before tensor 16384 mask 13050.0 16384
layer1.1.conv1.weight, mask/weight parameters,13050,12966 density 0.8091517857142857,0.8039434523809523
before tensor 36864 mask 7692.0 36864
layer1.1.conv2.weight, mask/weight parameters,7692,6026 density 0.21533551692281852,0.1686962850984015
before tensor 16384 mask 13041.0 16384
layer1.1.conv3.weight, mask/weight parameters,13041,12883 density 0.80859375,0.798797123015873
before tensor 16384 mask 12599.0 16384
layer1.2.conv1.weight, mask/weight parameters,12599,12587 density 0.781187996031746,0.7804439484126984
before tensor 36864 mask 5750.0 36864
layer1.2.conv2.weight, mask/weight parameters,5750,5465 density 0.1609697376893144,0.1529912376473223
before tensor 16384 mask 12715.0 16384
layer1.2.conv3.weight, mask/weight parameters,12715,12677 density 0.7883804563492064,0.7860243055555556
before tensor 32768 mask 16011.0 32768
layer2.0.conv1.weight, mask/weight parameters,16011,15074 density 0.5043787802419355,0.47486139112903225
before tensor 147456 mask 18171.0 147456
layer2.0.conv2.weight, mask/weight parameters,18171,12320 density 0.13130853277835589,0.08902763325239912
before tensor 65536 mask 26095.0 65536
layer2.0.conv3.weight, mask/weight parameters,26095,24344 density 0.4110225554435484,0.3834425403225806
layer2.0.shortcut.0.weight, mask/weight parameters,48068,37537 density 0.366729736328125,0.28638458251953125
before tensor 65536 mask 24959.0 65536
layer2.1.conv1.weight, mask/weight parameters,24959,23863 density 0.39312941028225806,0.3758663054435484
before tensor 147456 mask 26949.0 147456
layer2.1.conv2.weight, mask/weight parameters,26949,14745 density 0.19474072147069024,0.10655133541449878
before tensor 65536 mask 27280.0 65536
layer2.1.conv3.weight, mask/weight parameters,27280,24491 density 0.4296875,0.3857579385080645
before tensor 65536 mask 24617.0 65536
layer2.2.conv1.weight, mask/weight parameters,24617,22613 density 0.38774256552419356,0.35617754536290325
before tensor 147456 mask 28835.0 147456
layer2.2.conv2.weight, mask/weight parameters,28835,13030 density 0.20836946467799747,0.0941582841947046
before tensor 65536 mask 26538.0 65536
layer2.2.conv3.weight, mask/weight parameters,26538,23858 density 0.41800025201612906,0.3757875504032258
before tensor 65536 mask 24570.0 65536
layer2.3.conv1.weight, mask/weight parameters,24570,22427 density 0.3870022681451613,0.35324785786290325
before tensor 147456 mask 29807.0 147456
layer2.3.conv2.weight, mask/weight parameters,29807,13279 density 0.21539339808070296,0.09595762515897792
before tensor 65536 mask 26738.0 65536
layer2.3.conv3.weight, mask/weight parameters,26738,23942 density 0.42115045362903225,0.3771106350806452
before tensor 131072 mask 41103.0 131072
layer3.0.conv1.weight, mask/weight parameters,41103,29546 density 0.32370684223790325,0.23268964213709678
before tensor 589824 mask 133111.0 589824
layer3.0.conv2.weight, mask/weight parameters,133111,35484 density 0.24047397097930395,0.06410423170308706
before tensor 262144 mask 71430.0 262144
layer3.0.conv3.weight, mask/weight parameters,71430,49938 density 0.28127362651209675,0.19664346018145162
layer3.0.shortcut.0.weight, mask/weight parameters,104941,69995 density 0.20015907287597656,0.13350486755371094
before tensor 262144 mask 52622.0 262144
layer3.1.conv1.weight, mask/weight parameters,52622,46487 density 0.20721238659274194,0.1830542779737903
before tensor 589824 mask 109798.0 589824
layer3.1.conv2.weight, mask/weight parameters,109798,77645 density 0.19835746907156895,0.1402709128222916
before tensor 262144 mask 75735.0 262144
layer3.1.conv3.weight, mask/weight parameters,75735,56626 density 0.29822564894153225,0.2229791456653226
before tensor 262144 mask 54851.0 262144
layer3.2.conv1.weight, mask/weight parameters,54851,45751 density 0.21598963583669356,0.18015609248991934
before tensor 589824 mask 100732.0 589824
layer3.2.conv2.weight, mask/weight parameters,100732,51314 density 0.181979130535322,0.09270219100474043
before tensor 262144 mask 64003.0 262144
layer3.2.conv3.weight, mask/weight parameters,64003,49481 density 0.25202794228830644,0.19484390751008066
before tensor 262144 mask 49780.0 262144
layer3.3.conv1.weight, mask/weight parameters,49780,41628 density 0.19602129536290322,0.16392074092741934
before tensor 589824 mask 81572.0 589824
layer3.3.conv2.weight, mask/weight parameters,81572,34257 density 0.14736530234709214,0.061887573707943115
before tensor 262144 mask 55490.0 262144
layer3.3.conv3.weight, mask/weight parameters,55490,45542 density 0.218505859375,0.17933310231854838
before tensor 262144 mask 46815.0 262144
layer3.4.conv1.weight, mask/weight parameters,46815,39430 density 0.18434586063508066,0.15526556199596775
before tensor 589824 mask 83263.0 589824
layer3.4.conv2.weight, mask/weight parameters,83263,27475 density 0.15042020753844376,0.049635434732339
before tensor 262144 mask 54673.0 262144
layer3.4.conv3.weight, mask/weight parameters,54673,44038 density 0.2152887159778226,0.1734107232862903
before tensor 262144 mask 48212.0 262144
layer3.5.conv1.weight, mask/weight parameters,48212,38543 density 0.1898469002016129,0.15177277595766128
before tensor 589824 mask 81726.0 589824
layer3.5.conv2.weight, mask/weight parameters,81726,22797 density 0.1476435137010059,0.04118431321540062
before tensor 262144 mask 52725.0 262144
layer3.5.conv3.weight, mask/weight parameters,52725,43448 density 0.20761797505040322,0.1710874495967742
before tensor 524288 mask 87889.0 524288
layer4.0.conv1.weight, mask/weight parameters,87889,52441 density 0.17374312057186234,0.10366784223178138
before tensor 2359296 mask 263738.0 2359296
layer4.0.conv2.weight, mask/weight parameters,263738,54753 density 0.12008155445189325,0.02492938200374808
before tensor 1048576 mask 126494.0 1048576
layer4.0.conv3.weight, mask/weight parameters,126494,84318 density 0.1250296527074899,0.08334189967105263
layer4.0.shortcut.0.weight, mask/weight parameters,243286,158746 density 0.11600780487060547,0.07569599151611328
before tensor 1048576 mask 134729.0 1048576
layer4.1.conv1.weight, mask/weight parameters,134729,100268 density 0.13316932091346154,0.09910725581983805
before tensor 2359296 mask 341776.0 2359296
layer4.1.conv2.weight, mask/weight parameters,341776,280318 density 0.1556127420180265,0.12763053174303973
before tensor 1048576 mask 195388.0 1048576
layer4.1.conv3.weight, mask/weight parameters,195388,136179 density 0.19312610703441296,0.13460253510880565
before tensor 1048576 mask 62645.0 1048576
layer4.2.conv1.weight, mask/weight parameters,62645,59050 density 0.061919795356781375,0.05836641257591093
before tensor 2359296 mask 63197.0 2359296
layer4.2.conv2.weight, mask/weight parameters,63197,37155 density 0.02877398780872039,0.016916902970599966
before tensor 1048576 mask 87486.0 1048576
layer4.2.conv3.weight, mask/weight parameters,87486,80602 density 0.08647322558198381,0.07966891763663968
classifier.weight, mask/weight parameters,115903,97477 density 0.5659326171875,0.4759619140625
Total Model parameters after dst: 3545043 2365205
Total parameters under density level of 0.1: 0.1569158065505203 0.1046921152246456 after dst
Death rate: 0.14988329086794133


Training summary: Average loss: 2.9629, Accuracy: 12729/50000 (25.458%)


Evaluation: Average loss: 2.7395, Accuracy: 2975/10000 (29.750%)

Current learning rate: 0.1. Time taken for epoch: 90.52 seconds.

Train Epoch: 4 [0/50000 (0%)]	Loss: 2.782354 Accuracy: 25/100 (25.000%
Train Epoch: 4 [10000/50000 (20%)]	Loss: 2.879411 Accuracy: 2967/10100 (29.376%
Train Epoch: 4 [20000/50000 (40%)]	Loss: 2.668737 Accuracy: 6065/20100 (30.174%
Train Epoch: 4 [30000/50000 (60%)]	Loss: 2.771944 Accuracy: 9211/30100 (30.601%
Train Epoch: 4 [40000/50000 (80%)]	Loss: 2.299944 Accuracy: 12575/40100 (31.359%
current layer rate 0.05550182066454251
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 7310.0
Total filter_masks items: 19616583.0
7310.0 / 7552 channels
Total channels to prune: 177.1497496586253
Layer ('layer1', 0, 'conv1'): Pruned 1/63.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/63.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/63.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/63.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/63.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/63.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 3/124.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 3/124.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 6/248.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 6/248.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 11/494.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 11/494.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 11/494.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 11/494.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 11/494.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 11/494.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 7142.0
Total filter_masks items: 18930395.0
After apply_mask:
Total filter_names items: 7142.0
Total filter_masks items: 18930395.0
Total pruned: 168/177.1497496586253 channels
===========done ===============

Training summary: Average loss: 2.6211, Accuracy: 16038/50000 (32.076%)


Evaluation: Average loss: 3.2758, Accuracy: 2136/10000 (21.360%)

Current learning rate: 0.1. Time taken for epoch: 90.48 seconds.

Train Epoch: 5 [0/50000 (0%)]	Loss: 2.343393 Accuracy: 37/100 (37.000%
Train Epoch: 5 [10000/50000 (20%)]	Loss: 2.512497 Accuracy: 3577/10100 (35.416%
Train Epoch: 5 [20000/50000 (40%)]	Loss: 2.393488 Accuracy: 7224/20100 (35.940%
Train Epoch: 5 [30000/50000 (60%)]	Loss: 2.327193 Accuracy: 11060/30100 (36.744%
Train Epoch: 5 [40000/50000 (80%)]	Loss: 2.425403 Accuracy: 14940/40100 (37.257%
current mest  death_rate 0.14973765998627658


dynamic sparse change prune
to kill 1012975.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1618,1618 density 0.9363425925925926,0.9363425925925926
before tensor 4096 mask 3463.0 4096
layer1.0.conv1.weight, mask/weight parameters,3463,3463 density 0.8727318548387096,0.8727318548387096
before tensor 36864 mask 10040.0 36864
layer1.0.conv2.weight, mask/weight parameters,10040,10040 density 0.2902069603422361,0.2902069603422361
before tensor 16384 mask 11611.0 16384
layer1.0.conv3.weight, mask/weight parameters,11611,11611 density 0.7315398185483871,0.7315398185483871
layer1.0.shortcut.0.weight, mask/weight parameters,11927,11927 density 0.72796630859375,0.72796630859375
before tensor 16384 mask 10877.0 16384
layer1.1.conv1.weight, mask/weight parameters,10877,10877 density 0.6852948588709677,0.6852948588709677
before tensor 36864 mask 6272.0 36864
layer1.1.conv2.weight, mask/weight parameters,6272,6272 density 0.18129263498670367,0.18129263498670367
before tensor 16384 mask 10709.0 16384
layer1.1.conv3.weight, mask/weight parameters,10709,10709 density 0.6747101814516129,0.6747101814516129
before tensor 16384 mask 10189.0 16384
layer1.2.conv1.weight, mask/weight parameters,10189,10189 density 0.6419480846774194,0.6419480846774194
before tensor 36864 mask 4885.0 36864
layer1.2.conv2.weight, mask/weight parameters,4885,4885 density 0.14120129494739275,0.14120129494739275
before tensor 16384 mask 10379.0 16384
layer1.2.conv3.weight, mask/weight parameters,10379,10379 density 0.6539188508064516,0.6539188508064516
before tensor 32768 mask 12466.0 32768
layer2.0.conv1.weight, mask/weight parameters,12466,12466 density 0.40244059917355374,0.40244059917355374
before tensor 147456 mask 12446.0 147456
layer2.0.conv2.weight, mask/weight parameters,12446,12446 density 0.09445317183859633,0.09445317183859633
before tensor 65536 mask 19986.0 65536
layer2.0.conv3.weight, mask/weight parameters,19986,19986 density 0.322604597107438,0.322604597107438
layer2.0.shortcut.0.weight, mask/weight parameters,37468,37468 density 0.285858154296875,0.285858154296875
before tensor 65536 mask 18360.0 65536
layer2.1.conv1.weight, mask/weight parameters,18360,18360 density 0.2963584710743802,0.2963584710743802
before tensor 147456 mask 17484.0 147456
layer2.1.conv2.weight, mask/weight parameters,17484,17484 density 0.1326867472622544,0.1326867472622544
before tensor 65536 mask 20803.0 65536
layer2.1.conv3.weight, mask/weight parameters,20803,20803 density 0.3357922262396694,0.3357922262396694
before tensor 65536 mask 17731.0 65536
layer2.2.conv1.weight, mask/weight parameters,17731,17731 density 0.2862054493801653,0.2862054493801653
before tensor 147456 mask 18944.0 147456
layer2.2.conv2.weight, mask/weight parameters,18944,18944 density 0.14376674331595443,0.14376674331595443
before tensor 65536 mask 19948.0 65536
layer2.2.conv3.weight, mask/weight parameters,19948,19948 density 0.32199121900826444,0.32199121900826444
before tensor 65536 mask 17494.0 65536
layer2.3.conv1.weight, mask/weight parameters,17494,17494 density 0.2823799070247934,0.2823799070247934
before tensor 147456 mask 19644.0 147456
layer2.3.conv2.weight, mask/weight parameters,19644,19644 density 0.1490790701910161,0.1490790701910161
before tensor 65536 mask 19897.0 65536
layer2.3.conv3.weight, mask/weight parameters,19897,19897 density 0.32116800103305787,0.32116800103305787
before tensor 131072 mask 29654.0 131072
layer3.0.conv1.weight, mask/weight parameters,29654,29654 density 0.2393304493801653,0.2393304493801653
before tensor 589824 mask 78495.0 589824
layer3.0.conv2.weight, mask/weight parameters,78495,78495 density 0.14892539216355896,0.14892539216355896
before tensor 262144 mask 52287.0 262144
layer3.0.conv3.weight, mask/weight parameters,52287,52287 density 0.21099803073347106,0.21099803073347106
layer3.0.shortcut.0.weight, mask/weight parameters,74375,74375 density 0.1418590545654297,0.1418590545654297
before tensor 262144 mask 37559.0 262144
layer3.1.conv1.weight, mask/weight parameters,37559,37559 density 0.15156492122933884,0.15156492122933884
before tensor 589824 mask 72723.0 589824
layer3.1.conv2.weight, mask/weight parameters,72723,72723 density 0.137974409762539,0.137974409762539
before tensor 262144 mask 55545.0 262144
layer3.1.conv3.weight, mask/weight parameters,55545,55545 density 0.22414530604338842,0.22414530604338842
before tensor 262144 mask 38234.0 262144
layer3.2.conv1.weight, mask/weight parameters,38234,38234 density 0.1542888042355372,0.1542888042355372
before tensor 589824 mask 64948.0 589824
layer3.2.conv2.weight, mask/weight parameters,64948,64948 density 0.1232232163862517,0.1232232163862517
before tensor 262144 mask 46598.0 262144
layer3.2.conv3.weight, mask/weight parameters,46598,46598 density 0.18804074121900827,0.18804074121900827
before tensor 262144 mask 33921.0 262144
layer3.3.conv1.weight, mask/weight parameters,33921,33921 density 0.1368842006714876,0.1368842006714876
before tensor 589824 mask 48389.0 589824
layer3.3.conv2.weight, mask/weight parameters,48389,48389 density 0.09180649469905668,0.09180649469905668
before tensor 262144 mask 39079.0 262144
layer3.3.conv3.weight, mask/weight parameters,39079,39079 density 0.15769870222107438,0.15769870222107438
before tensor 262144 mask 31637.0 262144
layer3.4.conv1.weight, mask/weight parameters,31637,31637 density 0.12766738765495866,0.12766738765495866
before tensor 589824 mask 46963.0 589824
layer3.4.conv2.weight, mask/weight parameters,46963,46963 density 0.08910100251197171,0.08910100251197171
before tensor 262144 mask 38310.0 262144
layer3.4.conv3.weight, mask/weight parameters,38310,38310 density 0.15459549328512398,0.15459549328512398
before tensor 262144 mask 31801.0 262144
layer3.5.conv1.weight, mask/weight parameters,31801,31801 density 0.1283291903409091,0.1283291903409091
before tensor 589824 mask 45023.0 589824
layer3.5.conv2.weight, mask/weight parameters,45023,45023 density 0.08542031889139327,0.08542031889139327
before tensor 262144 mask 36438.0 262144
layer3.5.conv3.weight, mask/weight parameters,36438,36438 density 0.1470412577479339,0.1470412577479339
before tensor 524288 mask 59470.0 524288
layer4.0.conv1.weight, mask/weight parameters,59470,59470 density 0.12024052148033126,0.12024052148033126
before tensor 2359296 mask 127501.0 2359296
layer4.0.conv2.weight, mask/weight parameters,127501,127501 density 0.06072629990174323,0.06072629990174323
before tensor 1048576 mask 84179.0 1048576
layer4.0.conv3.weight, mask/weight parameters,84179,84179 density 0.08509943549430642,0.08509943549430642
layer4.0.shortcut.0.weight, mask/weight parameters,162678,162678 density 0.07757091522216797,0.07757091522216797
before tensor 1048576 mask 93968.0 1048576
layer4.1.conv1.weight, mask/weight parameters,93968,93968 density 0.09499547101449275,0.09499547101449275
before tensor 2359296 mask 226404.0 2359296
layer4.1.conv2.weight, mask/weight parameters,226404,226404 density 0.10783191663558933,0.10783191663558933
before tensor 1048576 mask 135205.0 1048576
layer4.1.conv3.weight, mask/weight parameters,135205,135205 density 0.13668336730072464,0.13668336730072464
before tensor 1048576 mask 38310.0 1048576
layer4.2.conv1.weight, mask/weight parameters,38310,38310 density 0.038728891692546584,0.038728891692546584
before tensor 2359296 mask 33885.0 2359296
layer4.2.conv2.weight, mask/weight parameters,33885,33885 density 0.016138780654038554,0.016138780654038554
before tensor 1048576 mask 56506.0 1048576
layer4.2.conv3.weight, mask/weight parameters,56506,56506 density 0.05712385157867495,0.05712385157867495
classifier.weight, mask/weight parameters,100479,100479 density 0.4906201171875,0.4906201171875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.10797153943433935 0.10797153943433935 after dst
Death rate: 0.14973765998627658

dynamic sparse change grow
self.total_params*pruning_rate 3541599.9256005334
self.total_nonzero 2365205.0
to grow 1176394.9256005334
len(all_scores) 21905819 19539591
increse 1176394.0 before_mask 3541598.0 after_mask 3541598.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1681,1618 density 0.9728009259259259,0.9363425925925926
before tensor 4096 mask 3523.0 4096
layer1.0.conv1.weight, mask/weight parameters,3523,3463 density 0.8878528225806451,0.8727318548387096
before tensor 36864 mask 12254.0 36864
layer1.0.conv2.weight, mask/weight parameters,12254,10040 density 0.3542027980113308,0.2902069603422361
before tensor 16384 mask 12153.0 16384
layer1.0.conv3.weight, mask/weight parameters,12153,11611 density 0.7656880040322581,0.7315398185483871
layer1.0.shortcut.0.weight, mask/weight parameters,12616,11927 density 0.77001953125,0.72796630859375
before tensor 16384 mask 11109.0 16384
layer1.1.conv1.weight, mask/weight parameters,11109,10877 density 0.6999117943548387,0.6852948588709677
before tensor 36864 mask 9219.0 36864
layer1.1.conv2.weight, mask/weight parameters,9219,6272 density 0.2664758931668401,0.18129263498670367
before tensor 16384 mask 11107.0 16384
layer1.1.conv3.weight, mask/weight parameters,11107,10709 density 0.6997857862903226,0.6747101814516129
before tensor 16384 mask 10201.0 16384
layer1.2.conv1.weight, mask/weight parameters,10201,10189 density 0.6427041330645161,0.6419480846774194
before tensor 36864 mask 5182.0 36864
layer1.2.conv2.weight, mask/weight parameters,5182,4885 density 0.1497861024395884,0.14120129494739275
before tensor 16384 mask 10392.0 16384
layer1.2.conv3.weight, mask/weight parameters,10392,10379 density 0.6547379032258065,0.6539188508064516
before tensor 32768 mask 14203.0 32768
layer2.0.conv1.weight, mask/weight parameters,14203,12466 density 0.458516270661157,0.40244059917355374
before tensor 147456 mask 21019.0 147456
layer2.0.conv2.weight, mask/weight parameters,21019,12446 density 0.1595139979813158,0.09445317183859633
before tensor 65536 mask 22812.0 65536
layer2.0.conv3.weight, mask/weight parameters,22812,19986 density 0.3682205578512397,0.322604597107438
layer2.0.shortcut.0.weight, mask/weight parameters,45970,37468 density 0.3507232666015625,0.285858154296875
before tensor 65536 mask 19596.0 65536
layer2.1.conv1.weight, mask/weight parameters,19596,18360 density 0.31630940082644626,0.2963584710743802
before tensor 147456 mask 23324.0 147456
layer2.1.conv2.weight, mask/weight parameters,23324,17484 density 0.17700673147705454,0.1326867472622544
before tensor 65536 mask 23552.0 65536
layer2.1.conv3.weight, mask/weight parameters,23552,20803 density 0.38016528925619836,0.3357922262396694
before tensor 65536 mask 19835.0 65536
layer2.2.conv1.weight, mask/weight parameters,19835,17731 density 0.3201672262396694,0.2862054493801653
before tensor 147456 mask 29572.0 147456
layer2.2.conv2.weight, mask/weight parameters,29572,18944 density 0.22442304335617633,0.14376674331595443
before tensor 65536 mask 23563.0 65536
layer2.2.conv3.weight, mask/weight parameters,23563,19948 density 0.3803428460743802,0.32199121900826444
before tensor 65536 mask 19562.0 65536
layer2.3.conv1.weight, mask/weight parameters,19562,17494 density 0.3157605888429752,0.2823799070247934
before tensor 147456 mask 29224.0 147456
layer2.3.conv2.weight, mask/weight parameters,29224,19644 density 0.2217820579954314,0.1490790701910161
before tensor 65536 mask 22775.0 65536
layer2.3.conv3.weight, mask/weight parameters,22775,19897 density 0.36762332128099173,0.32116800103305787
before tensor 131072 mask 39093.0 131072
layer3.0.conv1.weight, mask/weight parameters,39093,29654 density 0.3155103951446281,0.2393304493801653
before tensor 589824 mask 106066.0 589824
layer3.0.conv2.weight, mask/weight parameters,106066,78495 density 0.20123473654653218,0.14892539216355896
before tensor 262144 mask 72534.0 262144
layer3.0.conv3.weight, mask/weight parameters,72534,52287 density 0.2927024147727273,0.21099803073347106
layer3.0.shortcut.0.weight, mask/weight parameters,103509,74375 density 0.19742774963378906,0.1418590545654297
before tensor 262144 mask 46089.0 262144
layer3.1.conv1.weight, mask/weight parameters,46089,37559 density 0.18598673166322313,0.15156492122933884
before tensor 589824 mask 107625.0 589824
layer3.1.conv2.weight, mask/weight parameters,107625,72723 density 0.2041925642601826,0.137974409762539
before tensor 262144 mask 75683.0 262144
layer3.1.conv3.weight, mask/weight parameters,75683,55545 density 0.30540983341942146,0.22414530604338842
before tensor 262144 mask 48589.0 262144
layer3.2.conv1.weight, mask/weight parameters,48589,38234 density 0.19607518724173553,0.1542888042355372
before tensor 589824 mask 95291.0 589824
layer3.2.conv2.weight, mask/weight parameters,95291,64948 density 0.18079176437553598,0.1232232163862517
before tensor 262144 mask 63662.0 262144
layer3.2.conv3.weight, mask/weight parameters,63662,46598 density 0.2569005036157025,0.18804074121900827
before tensor 262144 mask 44747.0 262144
layer3.3.conv1.weight, mask/weight parameters,44747,33921 density 0.1805712487086777,0.1368842006714876
before tensor 589824 mask 79305.0 589824
layer3.3.conv2.weight, mask/weight parameters,79305,48389 density 0.15046217243813037,0.09180649469905668
before tensor 262144 mask 53770.0 262144
layer3.3.conv3.weight, mask/weight parameters,53770,39079 density 0.21698250258264462,0.15769870222107438
before tensor 262144 mask 40515.0 262144
layer3.4.conv1.weight, mask/weight parameters,40515,31637 density 0.1634935111053719,0.12766738765495866
before tensor 589824 mask 77336.0 589824
layer3.4.conv2.weight, mask/weight parameters,77336,46963 density 0.14672646828920308,0.08910100251197171
before tensor 262144 mask 51380.0 262144
layer3.4.conv3.weight, mask/weight parameters,51380,38310 density 0.20733793904958678,0.15459549328512398
before tensor 262144 mask 40268.0 262144
layer3.5.conv1.weight, mask/weight parameters,40268,31801 density 0.16249677169421486,0.1283291903409091
before tensor 589824 mask 70646.0 589824
layer3.5.conv2.weight, mask/weight parameters,70646,45023 density 0.13403380157700218,0.08542031889139327
before tensor 262144 mask 46513.0 262144
layer3.5.conv3.weight, mask/weight parameters,46513,36438 density 0.18769773372933884,0.1470412577479339
before tensor 524288 mask 95299.0 524288
layer4.0.conv1.weight, mask/weight parameters,95299,59470 density 0.19268204904244307,0.12024052148033126
before tensor 2359296 mask 247718.0 2359296
layer4.0.conv2.weight, mask/weight parameters,247718,127501 density 0.11798336922110439,0.06072629990174323
before tensor 1048576 mask 155471.0 1048576
layer4.0.conv3.weight, mask/weight parameters,155471,84179 density 0.15717096111542442,0.08509943549430642
layer4.0.shortcut.0.weight, mask/weight parameters,249199,162678 density 0.11882734298706055,0.07757091522216797
before tensor 1048576 mask 149243.0 1048576
layer4.1.conv1.weight, mask/weight parameters,149243,93968 density 0.15087486251293997,0.09499547101449275
before tensor 2359296 mask 337488.0 2359296
layer4.1.conv2.weight, mask/weight parameters,337488,226404 density 0.16073911185982478,0.10783191663558933
before tensor 1048576 mask 187842.0 1048576
layer4.1.conv3.weight, mask/weight parameters,187842,135205 density 0.18989591420807453,0.13668336730072464
before tensor 1048576 mask 71127.0 1048576
layer4.2.conv1.weight, mask/weight parameters,71127,38310 density 0.07190472146739131,0.038728891692546584
before tensor 2359296 mask 159345.0 2359296
layer4.2.conv2.weight, mask/weight parameters,159345,33885 density 0.07589299109687983,0.016138780654038554
before tensor 1048576 mask 93343.0 1048576
layer4.2.conv3.weight, mask/weight parameters,93343,56506 density 0.09436363709886128,0.05712385157867495
classifier.weight, mask/weight parameters,118458,100479 density 0.578408203125,0.4906201171875
Total Model parameters after dst: 3541598 2365205
Total parameters under density level of 0.1: 0.16167384565717446 0.10797153943433935 after dst
Death rate: 0.14973765998627658


Training summary: Average loss: 2.3474, Accuracy: 18876/50000 (37.752%)


Evaluation: Average loss: 2.3139, Accuracy: 3913/10000 (39.130%)

Current learning rate: 0.1. Time taken for epoch: 90.01 seconds.

Train Epoch: 6 [0/50000 (0%)]	Loss: 2.154290 Accuracy: 43/100 (43.000%
Train Epoch: 6 [10000/50000 (20%)]	Loss: 2.098593 Accuracy: 4087/10100 (40.465%
Train Epoch: 6 [20000/50000 (40%)]	Loss: 2.247819 Accuracy: 8135/20100 (40.473%
Train Epoch: 6 [30000/50000 (60%)]	Loss: 2.060003 Accuracy: 12302/30100 (40.870%
Train Epoch: 6 [40000/50000 (80%)]	Loss: 2.067238 Accuracy: 16612/40100 (41.426%
current layer rate 0.0764981793354575
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 7142.0
Total filter_masks items: 18930395.0
7142.0 / 7552 channels
Total channels to prune: 167.7142503413752
Layer ('layer1', 0, 'conv1'): Pruned 1/62.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/62.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/62.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/62.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/62.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/62.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/121.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/121.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/242.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/242.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 11/483.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 11/483.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 11/483.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 11/483.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 11/483.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 11/483.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6994.0
Total filter_masks items: 18305021.0
After apply_mask:
Total filter_names items: 6994.0
Total filter_masks items: 18305021.0
Total pruned: 148/167.7142503413752 channels
===========done ===============

Training summary: Average loss: 2.1619, Accuracy: 20932/50000 (41.864%)


Evaluation: Average loss: 3.1834, Accuracy: 2562/10000 (25.620%)

Current learning rate: 0.1. Time taken for epoch: 88.69 seconds.

Train Epoch: 7 [0/50000 (0%)]	Loss: 1.886736 Accuracy: 41/100 (41.000%
Train Epoch: 7 [10000/50000 (20%)]	Loss: 2.092028 Accuracy: 4507/10100 (44.624%
Train Epoch: 7 [20000/50000 (40%)]	Loss: 1.923210 Accuracy: 8955/20100 (44.552%
Train Epoch: 7 [30000/50000 (60%)]	Loss: 1.714336 Accuracy: 13491/30100 (44.821%
Train Epoch: 7 [40000/50000 (80%)]	Loss: 2.065291 Accuracy: 18001/40100 (44.890%
current mest  death_rate 0.14953425315348498


dynamic sparse change prune
to kill 1021216.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1561,1561 density 0.9033564814814815,0.9033564814814815
before tensor 4096 mask 3116.0 4096
layer1.0.conv1.weight, mask/weight parameters,3116,3116 density 0.798155737704918,0.798155737704918
before tensor 36864 mask 9528.0 36864
layer1.0.conv2.weight, mask/weight parameters,9528,9528 density 0.28451133207919016,0.28451133207919016
before tensor 16384 mask 10072.0 16384
layer1.0.conv3.weight, mask/weight parameters,10072,10072 density 0.6449795081967213,0.6449795081967213
layer1.0.shortcut.0.weight, mask/weight parameters,10673,10673 density 0.65142822265625,0.65142822265625
before tensor 16384 mask 8897.0 16384
layer1.1.conv1.weight, mask/weight parameters,8897,8897 density 0.5697361680327869,0.5697361680327869
before tensor 36864 mask 7021.0 36864
layer1.1.conv2.weight, mask/weight parameters,7021,7021 density 0.20965093015617067,0.20965093015617067
before tensor 16384 mask 8859.0 16384
layer1.1.conv3.weight, mask/weight parameters,8859,8859 density 0.5673027663934426,0.5673027663934426
before tensor 16384 mask 7615.0 16384
layer1.2.conv1.weight, mask/weight parameters,7615,7615 density 0.487640881147541,0.487640881147541
before tensor 36864 mask 4094.0 36864
layer1.2.conv2.weight, mask/weight parameters,4094,4094 density 0.12224909671832541,0.12224909671832541
before tensor 16384 mask 7973.0 16384
layer1.2.conv3.weight, mask/weight parameters,7973,7973 density 0.5105660860655737,0.5105660860655737
before tensor 32768 mask 10460.0 32768
layer2.0.conv1.weight, mask/weight parameters,10460,10460 density 0.3433560924369748,0.3433560924369748
before tensor 147456 mask 14079.0 147456
layer2.0.conv2.weight, mask/weight parameters,14079,14079 density 0.11046771649836405,0.11046771649836405
before tensor 65536 mask 17566.0 65536
layer2.0.conv3.weight, mask/weight parameters,17566,17566 density 0.28830751050420167,0.28830751050420167
layer2.0.shortcut.0.weight, mask/weight parameters,35989,35989 density 0.27457427978515625,0.27457427978515625
before tensor 65536 mask 14213.0 65536
layer2.1.conv1.weight, mask/weight parameters,14213,14213 density 0.23327534138655462,0.23327534138655462
before tensor 147456 mask 15845.0 147456
layer2.1.conv2.weight, mask/weight parameters,15845,15845 density 0.12432423949972146,0.12432423949972146
before tensor 65536 mask 17959.0 65536
layer2.1.conv3.weight, mask/weight parameters,17959,17959 density 0.2947577468487395,0.2947577468487395
before tensor 65536 mask 14585.0 65536
layer2.2.conv1.weight, mask/weight parameters,14585,14585 density 0.23938090861344538,0.23938090861344538
before tensor 147456 mask 20343.0 147456
layer2.2.conv2.weight, mask/weight parameters,20343,20343 density 0.15961678789162723,0.15961678789162723
before tensor 65536 mask 17838.0 65536
layer2.2.conv3.weight, mask/weight parameters,17838,17838 density 0.29277179621848737,0.29277179621848737
before tensor 65536 mask 14429.0 65536
layer2.3.conv1.weight, mask/weight parameters,14429,14429 density 0.23682050945378152,0.23682050945378152
before tensor 147456 mask 20383.0 147456
layer2.3.conv2.weight, mask/weight parameters,20383,20383 density 0.15993063892223555,0.15993063892223555
before tensor 65536 mask 17445.0 65536
layer2.3.conv3.weight, mask/weight parameters,17445,17445 density 0.2863215598739496,0.2863215598739496
before tensor 131072 mask 28741.0 131072
layer3.0.conv1.weight, mask/weight parameters,28741,28741 density 0.23685555116033755,0.23685555116033755
before tensor 589824 mask 71570.0 589824
layer3.0.conv2.weight, mask/weight parameters,71570,71570 density 0.14157670996852753,0.14157670996852753
before tensor 262144 mask 53415.0 262144
layer3.0.conv3.weight, mask/weight parameters,53415,53415 density 0.22009740901898733,0.22009740901898733
layer3.0.shortcut.0.weight, mask/weight parameters,75333,75333 density 0.14368629455566406,0.14368629455566406
before tensor 262144 mask 33543.0 262144
layer3.1.conv1.weight, mask/weight parameters,33543,33543 density 0.13821449762658228,0.13821449762658228
before tensor 589824 mask 71923.0 589824
layer3.1.conv2.weight, mask/weight parameters,71923,71923 density 0.14227499945600677,0.14227499945600677
before tensor 262144 mask 55455.0 262144
layer3.1.conv3.weight, mask/weight parameters,55455,55455 density 0.22850326344936708,0.22850326344936708
before tensor 262144 mask 34892.0 262144
layer3.2.conv1.weight, mask/weight parameters,34892,34892 density 0.14377307489451477,0.14377307489451477
before tensor 589824 mask 64536.0 589824
layer3.2.conv2.weight, mask/weight parameters,64536,64536 density 0.12766235230583892,0.12766235230583892
before tensor 262144 mask 46487.0 262144
layer3.2.conv3.weight, mask/weight parameters,46487,46487 density 0.1915504680907173,0.1915504680907173
before tensor 262144 mask 31695.0 262144
layer3.3.conv1.weight, mask/weight parameters,31695,31695 density 0.13059978243670886,0.13059978243670886
before tensor 589824 mask 50521.0 589824
layer3.3.conv2.weight, mask/weight parameters,50521,50521 density 0.09993847931144305,0.09993847931144305
before tensor 262144 mask 38296.0 262144
layer3.3.conv3.weight, mask/weight parameters,38296,38296 density 0.15779931434599156,0.15779931434599156
before tensor 262144 mask 29256.0 262144
layer3.4.conv1.weight, mask/weight parameters,29256,29256 density 0.1205498417721519,0.1205498417721519
before tensor 589824 mask 49368.0 589824
layer3.4.conv2.weight, mask/weight parameters,49368,49368 density 0.09765766407330259,0.09765766407330259
before tensor 262144 mask 36243.0 262144
layer3.4.conv3.weight, mask/weight parameters,36243,36243 density 0.14933989319620253,0.14933989319620253
before tensor 262144 mask 28842.0 262144
layer3.5.conv1.weight, mask/weight parameters,28842,28842 density 0.11884394778481013,0.11884394778481013
before tensor 589824 mask 44835.0 589824
layer3.5.conv2.weight, mask/weight parameters,44835,44835 density 0.08869067753861858,0.08869067753861858
before tensor 262144 mask 32847.0 262144
layer3.5.conv3.weight, mask/weight parameters,32847,32847 density 0.13534661787974683,0.13534661787974683
before tensor 524288 mask 67166.0 524288
layer4.0.conv1.weight, mask/weight parameters,67166,67166 density 0.138965671345339,0.138965671345339
before tensor 2359296 mask 139408.0 2359296
layer4.0.conv2.weight, mask/weight parameters,139408,139408 density 0.06952823262791663,0.06952823262791663
before tensor 1048576 mask 99458.0 1048576
layer4.0.conv3.weight, mask/weight parameters,99458,99458 density 0.10288872153072035,0.10288872153072035
layer4.0.shortcut.0.weight, mask/weight parameters,164700,164700 density 0.07853507995605469,0.07853507995605469
before tensor 1048576 mask 102153.0 1048576
layer4.1.conv1.weight, mask/weight parameters,102153,102153 density 0.1056766833289195,0.1056766833289195
before tensor 2359296 mask 224411.0 2359296
layer4.1.conv2.weight, mask/weight parameters,224411,224411 density 0.11192255976890421,0.11192255976890421
before tensor 1048576 mask 130623.0 1048576
layer4.1.conv3.weight, mask/weight parameters,130623,130623 density 0.1351287324549788,0.1351287324549788
before tensor 1048576 mask 41334.0 1048576
layer4.2.conv1.weight, mask/weight parameters,41334,41334 density 0.04275978217690678,0.04275978217690678
before tensor 2359296 mask 51305.0 2359296
layer4.2.conv2.weight, mask/weight parameters,51305,51305 density 0.025587814006192346,0.025587814006192346
before tensor 1048576 mask 52749.0 1048576
layer4.2.conv3.weight, mask/weight parameters,52749,52749 density 0.05456853317002119,0.05456853317002119
classifier.weight, mask/weight parameters,103557,103557 density 0.5056494140625,0.5056494140625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.11114452728784573 0.11114452728784573 after dst
Death rate: 0.14953425315348498

dynamic sparse change grow
self.total_params*pruning_rate 3536788.940682328
self.total_nonzero 2365205.0
to grow 1171583.9406823278
len(all_scores) 21280445 18914579
increse 1171583.0 before_mask 3536787.0 after_mask 3536787.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1651,1561 density 0.9554398148148148,0.9033564814814815
before tensor 4096 mask 3300.0 4096
layer1.0.conv1.weight, mask/weight parameters,3300,3116 density 0.8452868852459017,0.798155737704918
before tensor 36864 mask 11918.0 36864
layer1.0.conv2.weight, mask/weight parameters,11918,9528 density 0.3558780495087939,0.28451133207919016
before tensor 16384 mask 10767.0 16384
layer1.0.conv3.weight, mask/weight parameters,10767,10072 density 0.6894851434426229,0.6449795081967213
layer1.0.shortcut.0.weight, mask/weight parameters,11765,10673 density 0.71807861328125,0.65142822265625
before tensor 16384 mask 9350.0 16384
layer1.1.conv1.weight, mask/weight parameters,9350,8897 density 0.5987448770491803,0.5697361680327869
before tensor 36864 mask 9330.0 36864
layer1.1.conv2.weight, mask/weight parameters,9330,7021 density 0.2785989429364866,0.20965093015617067
before tensor 16384 mask 9473.0 16384
layer1.1.conv3.weight, mask/weight parameters,9473,8859 density 0.6066214139344263,0.5673027663934426
before tensor 16384 mask 7798.0 16384
layer1.2.conv1.weight, mask/weight parameters,7798,7615 density 0.499359631147541,0.487640881147541
before tensor 36864 mask 5191.0 36864
layer1.2.conv2.weight, mask/weight parameters,5191,4094 density 0.1550061214130013,0.12224909671832541
before tensor 16384 mask 8165.0 16384
layer1.2.conv3.weight, mask/weight parameters,8165,7973 density 0.5228611680327869,0.5105660860655737
before tensor 32768 mask 12318.0 32768
layer2.0.conv1.weight, mask/weight parameters,12318,10460 density 0.40434611344537813,0.3433560924369748
before tensor 147456 mask 21627.0 147456
layer2.0.conv2.weight, mask/weight parameters,21627,14079 density 0.16969140597415436,0.11046771649836405
before tensor 65536 mask 20698.0 65536
layer2.0.conv3.weight, mask/weight parameters,20698,17566 density 0.3397124474789916,0.28830751050420167
layer2.0.shortcut.0.weight, mask/weight parameters,47206,35989 density 0.3601531982421875,0.27457427978515625
before tensor 65536 mask 16534.0 65536
layer2.1.conv1.weight, mask/weight parameters,16534,14213 density 0.27136948529411764,0.23327534138655462
before tensor 147456 mask 22293.0 147456
layer2.1.conv2.weight, mask/weight parameters,22293,15845 density 0.17491702563378292,0.12432423949972146
before tensor 65536 mask 21543.0 65536
layer2.1.conv3.weight, mask/weight parameters,21543,17959 density 0.35358127626050423,0.2947577468487395
before tensor 65536 mask 17709.0 65536
layer2.2.conv1.weight, mask/weight parameters,17709,14585 density 0.2906545430672269,0.23938090861344538
before tensor 147456 mask 29975.0 147456
layer2.2.conv2.weight, mask/weight parameters,29975,20343 density 0.23519211606211113,0.15961678789162723
before tensor 65536 mask 22121.0 65536
layer2.2.conv3.weight, mask/weight parameters,22121,17838 density 0.3630678834033613,0.29277179621848737
before tensor 65536 mask 18297.0 65536
layer2.3.conv1.weight, mask/weight parameters,18297,14429 density 0.3003052783613445,0.23682050945378152
before tensor 147456 mask 31036.0 147456
layer2.3.conv2.weight, mask/weight parameters,31036,20383 density 0.24351701464899686,0.15993063892223555
before tensor 65536 mask 21917.0 65536
layer2.3.conv3.weight, mask/weight parameters,21917,17445 density 0.3597196691176471,0.2863215598739496
before tensor 131072 mask 41876.0 131072
layer3.0.conv1.weight, mask/weight parameters,41876,28741 density 0.345101529535865,0.23685555116033755
before tensor 589824 mask 117125.0 589824
layer3.0.conv2.weight, mask/weight parameters,117125,71570 density 0.23169166068274116,0.14157670996852753
before tensor 262144 mask 75862.0 262144
layer3.0.conv3.weight, mask/weight parameters,75862,53415 density 0.31259065137130804,0.22009740901898733
layer3.0.shortcut.0.weight, mask/weight parameters,111989,75333 density 0.21360206604003906,0.14368629455566406
before tensor 262144 mask 45583.0 262144
layer3.1.conv1.weight, mask/weight parameters,45583,33543 density 0.18782552083333334,0.13821449762658228
before tensor 589824 mask 108769.0 589824
layer3.1.conv2.weight, mask/weight parameters,108769,71923 density 0.21516217921708494,0.14227499945600677
before tensor 262144 mask 76394.0 262144
layer3.1.conv3.weight, mask/weight parameters,76394,55455 density 0.31478276635021096,0.22850326344936708
before tensor 262144 mask 52475.0 262144
layer3.2.conv1.weight, mask/weight parameters,52475,34892 density 0.21622412315400844,0.14377307489451477
before tensor 589824 mask 101916.0 589824
layer3.2.conv2.weight, mask/weight parameters,101916,64536 density 0.20160586800548344,0.12766235230583892
before tensor 262144 mask 68586.0 262144
layer3.2.conv3.weight, mask/weight parameters,68586,46487 density 0.2826097705696203,0.1915504680907173
before tensor 262144 mask 44809.0 262144
layer3.3.conv1.weight, mask/weight parameters,44809,31695 density 0.1846362407700422,0.13059978243670886
before tensor 589824 mask 80498.0 589824
layer3.3.conv2.weight, mask/weight parameters,80498,50521 density 0.1592376973459065,0.09993847931144305
before tensor 262144 mask 57935.0 262144
layer3.3.conv3.weight, mask/weight parameters,57935,38296 density 0.23872214530590719,0.15779931434599156
before tensor 262144 mask 46858.0 262144
layer3.4.conv1.weight, mask/weight parameters,46858,29256 density 0.19307917985232068,0.1205498417721519
before tensor 589824 mask 82967.0 589824
layer3.4.conv2.weight, mask/weight parameters,82967,49368 density 0.16412176744388463,0.09765766407330259
before tensor 262144 mask 57317.0 262144
layer3.4.conv3.weight, mask/weight parameters,57317,36243 density 0.23617566587552744,0.14933989319620253
before tensor 262144 mask 48851.0 262144
layer3.5.conv1.weight, mask/weight parameters,48851,28842 density 0.20129136998945146,0.11884394778481013
before tensor 589824 mask 82241.0 589824
layer3.5.conv2.weight, mask/weight parameters,82241,44835 density 0.1626856253251596,0.08869067753861858
before tensor 262144 mask 55074.0 262144
layer3.5.conv3.weight, mask/weight parameters,55074,32847 density 0.22693334651898733,0.13534661787974683
before tensor 524288 mask 115853.0 524288
layer4.0.conv1.weight, mask/weight parameters,115853,67166 density 0.23969850701800846,0.138965671345339
before tensor 2359296 mask 255886.0 2359296
layer4.0.conv2.weight, mask/weight parameters,255886,139408 density 0.12762037569025503,0.06952823262791663
before tensor 1048576 mask 147562.0 1048576
layer4.0.conv3.weight, mask/weight parameters,147562,99458 density 0.1526520292637712,0.10288872153072035
layer4.0.shortcut.0.weight, mask/weight parameters,235790,164700 density 0.11243343353271484,0.07853507995605469
before tensor 1048576 mask 147866.0 1048576
layer4.1.conv1.weight, mask/weight parameters,147866,102153 density 0.15296651549258475,0.1056766833289195
before tensor 2359296 mask 338453.0 2359296
layer4.1.conv2.weight, mask/weight parameters,338453,224411 density 0.16879977417089598,0.11192255976890421
before tensor 1048576 mask 180197.0 1048576
layer4.1.conv3.weight, mask/weight parameters,180197,130623 density 0.186412746623411,0.1351287324549788
before tensor 1048576 mask 64427.0 1048576
layer4.2.conv1.weight, mask/weight parameters,64427,41334 density 0.06664935613082627,0.04275978217690678
before tensor 2359296 mask 91380.0 2359296
layer4.2.conv2.weight, mask/weight parameters,91380,51305 density 0.04557478693861917,0.025587814006192346
before tensor 1048576 mask 89546.0 1048576
layer4.2.conv3.weight, mask/weight parameters,89546,52749 density 0.09263481528072035,0.05456853317002119
classifier.weight, mask/weight parameters,120720,103557 density 0.589453125,0.5056494140625
Total Model parameters after dst: 3536787 2365205
Total parameters under density level of 0.1: 0.16619892112218518 0.11114452728784573 after dst
Death rate: 0.14953425315348498


Training summary: Average loss: 2.0094, Accuracy: 22652/50000 (45.304%)


Evaluation: Average loss: 2.2641, Accuracy: 4080/10000 (40.800%)

Current learning rate: 0.1. Time taken for epoch: 88.92 seconds.

Train Epoch: 8 [0/50000 (0%)]	Loss: 1.912444 Accuracy: 50/100 (50.000%
Train Epoch: 8 [10000/50000 (20%)]	Loss: 2.389539 Accuracy: 4623/10100 (45.772%
Train Epoch: 8 [20000/50000 (40%)]	Loss: 1.968492 Accuracy: 9302/20100 (46.279%
Train Epoch: 8 [30000/50000 (60%)]	Loss: 1.954929 Accuracy: 14037/30100 (46.635%
Train Epoch: 8 [40000/50000 (80%)]	Loss: 1.751129 Accuracy: 18927/40100 (47.200%
current layer rate 0.09682271279016841
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6994.0
Total filter_masks items: 18305021.0
6994.0 / 7552 channels
Total channels to prune: 173.2051269913518
Layer ('layer1', 0, 'conv1'): Pruned 1/61.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/61.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/61.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/61.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/61.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/61.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/119.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/119.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/237.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/237.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 11/472.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 11/472.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 11/472.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 11/472.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 11/472.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 11/472.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6846.0
Total filter_masks items: 17689223.0
After apply_mask:
Total filter_names items: 6846.0
Total filter_masks items: 17689223.0
Total pruned: 148/173.2051269913518 channels
===========done ===============

Training summary: Average loss: 1.9232, Accuracy: 23634/50000 (47.268%)


Evaluation: Average loss: 2.7397, Accuracy: 3197/10000 (31.970%)

Current learning rate: 0.1. Time taken for epoch: 88.70 seconds.

Train Epoch: 9 [0/50000 (0%)]	Loss: 1.884101 Accuracy: 49/100 (49.000%
Train Epoch: 9 [10000/50000 (20%)]	Loss: 1.954111 Accuracy: 4999/10100 (49.495%
Train Epoch: 9 [20000/50000 (40%)]	Loss: 1.978007 Accuracy: 9883/20100 (49.169%
Train Epoch: 9 [30000/50000 (60%)]	Loss: 2.116184 Accuracy: 14808/30100 (49.196%
Train Epoch: 9 [40000/50000 (80%)]	Loss: 1.648448 Accuracy: 19782/40100 (49.332%
current mest  death_rate 0.14927354543565144


dynamic sparse change prune
to kill 1013486.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1541,1541 density 0.8917824074074074,0.8917824074074074
before tensor 4096 mask 2741.0 4096
layer1.0.conv1.weight, mask/weight parameters,2741,2741 density 0.7138020833333333,0.7138020833333333
before tensor 36864 mask 8860.0 36864
layer1.0.conv2.weight, mask/weight parameters,8860,8860 density 0.2734567901234568,0.2734567901234568
before tensor 16384 mask 8571.0 16384
layer1.0.conv3.weight, mask/weight parameters,8571,8571 density 0.5580078125,0.5580078125
layer1.0.shortcut.0.weight, mask/weight parameters,9547,9547 density 0.58270263671875,0.58270263671875
before tensor 16384 mask 6929.0 16384
layer1.1.conv1.weight, mask/weight parameters,6929,6929 density 0.45110677083333334,0.45110677083333334
before tensor 36864 mask 6978.0 36864
layer1.1.conv2.weight, mask/weight parameters,6978,6978 density 0.21537037037037038,0.21537037037037038
before tensor 16384 mask 7431.0 16384
layer1.1.conv3.weight, mask/weight parameters,7431,7431 density 0.4837890625,0.4837890625
before tensor 16384 mask 5325.0 16384
layer1.2.conv1.weight, mask/weight parameters,5325,5325 density 0.3466796875,0.3466796875
before tensor 36864 mask 3598.0 36864
layer1.2.conv2.weight, mask/weight parameters,3598,3598 density 0.11104938271604939,0.11104938271604939
before tensor 16384 mask 5896.0 16384
layer1.2.conv3.weight, mask/weight parameters,5896,5896 density 0.38385416666666666,0.38385416666666666
before tensor 32768 mask 8510.0 32768
layer2.0.conv1.weight, mask/weight parameters,8510,8510 density 0.2841212606837607,0.2841212606837607
before tensor 147456 mask 14656.0 147456
layer2.0.conv2.weight, mask/weight parameters,14656,14656 density 0.11896007337602779,0.11896007337602779
before tensor 65536 mask 15791.0 65536
layer2.0.conv3.weight, mask/weight parameters,15791,15791 density 0.26360510149572647,0.26360510149572647
layer2.0.shortcut.0.weight, mask/weight parameters,35270,35270 density 0.2690887451171875,0.2690887451171875
before tensor 65536 mask 11391.0 65536
layer2.1.conv1.weight, mask/weight parameters,11391,11391 density 0.1901542467948718,0.1901542467948718
before tensor 147456 mask 14630.0 147456
layer2.1.conv2.weight, mask/weight parameters,14630,14630 density 0.11874903612795351,0.11874903612795351
before tensor 65536 mask 15607.0 65536
layer2.1.conv3.weight, mask/weight parameters,15607,15607 density 0.2605335202991453,0.2605335202991453
before tensor 65536 mask 12862.0 65536
layer2.2.conv1.weight, mask/weight parameters,12862,12862 density 0.214710202991453,0.214710202991453
before tensor 147456 mask 20454.0 147456
layer2.2.conv2.weight, mask/weight parameters,20454,20454 density 0.16602137969659336,0.16602137969659336
before tensor 65536 mask 16113.0 65536
layer2.2.conv3.weight, mask/weight parameters,16113,16113 density 0.2689803685897436,0.2689803685897436
before tensor 65536 mask 12940.0 65536
layer2.3.conv1.weight, mask/weight parameters,12940,12940 density 0.21601228632478633,0.21601228632478633
before tensor 147456 mask 20882.0 147456
layer2.3.conv2.weight, mask/weight parameters,20882,20882 density 0.16949537747258545,0.16949537747258545
before tensor 65536 mask 15947.0 65536
layer2.3.conv3.weight, mask/weight parameters,15947,15947 density 0.26620926816239315,0.26620926816239315
before tensor 131072 mask 29992.0 131072
layer3.0.conv1.weight, mask/weight parameters,29992,29992 density 0.2524919181034483,0.2524919181034483
before tensor 589824 mask 76526.0 589824
layer3.0.conv2.weight, mask/weight parameters,76526,76526 density 0.1579757894041485,0.1579757894041485
before tensor 262144 mask 55139.0 262144
layer3.0.conv3.weight, mask/weight parameters,55139,55139 density 0.2320977572737069,0.2320977572737069
layer3.0.shortcut.0.weight, mask/weight parameters,79322,79322 density 0.15129470825195312,0.15129470825195312
before tensor 262144 mask 31899.0 262144
layer3.1.conv1.weight, mask/weight parameters,31899,31899 density 0.1342731344288793,0.1342731344288793
before tensor 589824 mask 70991.0 589824
layer3.1.conv2.weight, mask/weight parameters,70991,70991 density 0.1465496597965385,0.1465496597965385
before tensor 262144 mask 55106.0 262144
layer3.1.conv3.weight, mask/weight parameters,55106,55106 density 0.23195884967672414,0.23195884967672414
before tensor 262144 mask 35388.0 262144
layer3.2.conv1.weight, mask/weight parameters,35388,35388 density 0.14895945581896552,0.14895945581896552
before tensor 589824 mask 66448.0 589824
layer3.2.conv2.weight, mask/weight parameters,66448,66448 density 0.13717135685031048,0.13717135685031048
before tensor 262144 mask 48327.0 262144
layer3.2.conv3.weight, mask/weight parameters,48327,48327 density 0.20342386179956898,0.20342386179956898
before tensor 262144 mask 30749.0 262144
layer3.3.conv1.weight, mask/weight parameters,30749,30749 density 0.12943241514008622,0.12943241514008622
before tensor 589824 mask 51411.0 589824
layer3.3.conv2.weight, mask/weight parameters,51411,51411 density 0.10612985533095522,0.10612985533095522
before tensor 262144 mask 40420.0 262144
layer3.3.conv3.weight, mask/weight parameters,40420,40420 density 0.17014075969827586,0.17014075969827586
before tensor 262144 mask 31717.0 262144
layer3.4.conv1.weight, mask/weight parameters,31717,31717 density 0.13350703798491378,0.13350703798491378
before tensor 589824 mask 51542.0 589824
layer3.4.conv2.weight, mask/weight parameters,51542,51542 density 0.10640028405337561,0.10640028405337561
before tensor 262144 mask 38632.0 262144
layer3.4.conv3.weight, mask/weight parameters,38632,38632 density 0.16261449353448276,0.16261449353448276
before tensor 262144 mask 32372.0 262144
layer3.5.conv1.weight, mask/weight parameters,32372,32372 density 0.13626414331896552,0.13626414331896552
before tensor 589824 mask 49478.0 589824
layer3.5.conv2.weight, mask/weight parameters,49478,49478 density 0.10213948341920993,0.10213948341920993
before tensor 262144 mask 35744.0 262144
layer3.5.conv3.weight, mask/weight parameters,35744,35744 density 0.15045797413793102,0.15045797413793102
before tensor 524288 mask 79946.0 524288
layer4.0.conv1.weight, mask/weight parameters,79946,79946 density 0.16935415536876355,0.16935415536876355
before tensor 2359296 mask 153567.0 2359296
layer4.0.conv2.weight, mask/weight parameters,153567,153567 density 0.08028853619171752,0.08028853619171752
before tensor 1048576 mask 96552.0 1048576
layer4.0.conv3.weight, mask/weight parameters,96552,96552 density 0.10226579446854664,0.10226579446854664
layer4.0.shortcut.0.weight, mask/weight parameters,157707,157707 density 0.07520055770874023,0.07520055770874023
before tensor 1048576 mask 102960.0 1048576
layer4.1.conv1.weight, mask/weight parameters,102960,102960 density 0.10905300976138829,0.10905300976138829
before tensor 2359296 mask 221327.0 2359296
layer4.1.conv2.weight, mask/weight parameters,221327,221327 density 0.11571510057306755,0.11571510057306755
before tensor 1048576 mask 123163.0 1048576
layer4.1.conv3.weight, mask/weight parameters,123163,123163 density 0.13045159130965292,0.13045159130965292
before tensor 1048576 mask 38670.0 1048576
layer4.2.conv1.weight, mask/weight parameters,38670,38670 density 0.04095842936550976,0.04095842936550976
before tensor 2359296 mask 43472.0 2359296
layer4.2.conv2.weight, mask/weight parameters,43472,43472 density 0.022728211434268716,0.022728211434268716
before tensor 1048576 mask 48727.0 1048576
layer4.2.conv3.weight, mask/weight parameters,48727,48727 density 0.05161058670010846,0.05161058670010846
classifier.weight, mask/weight parameters,105441,105441 density 0.5148486328125,0.5148486328125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.11445658858822993 0.11445658858822993 after dst
Death rate: 0.14927354543565144

dynamic sparse change grow
self.total_params*pruning_rate 3530622.673397482
self.total_nonzero 2365205.0
to grow 1165417.673397482
len(all_scores) 20664647 18287180
increse 1165417.0 before_mask 3530621.0 after_mask 3530621.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1615,1541 density 0.9346064814814815,0.8917824074074074
before tensor 4096 mask 2850.0 4096
layer1.0.conv1.weight, mask/weight parameters,2850,2741 density 0.7421875,0.7138020833333333
before tensor 36864 mask 10518.0 36864
layer1.0.conv2.weight, mask/weight parameters,10518,8860 density 0.32462962962962966,0.2734567901234568
before tensor 16384 mask 9503.0 16384
layer1.0.conv3.weight, mask/weight parameters,9503,8571 density 0.6186848958333333,0.5580078125
layer1.0.shortcut.0.weight, mask/weight parameters,10366,9547 density 0.6326904296875,0.58270263671875
before tensor 16384 mask 7308.0 16384
layer1.1.conv1.weight, mask/weight parameters,7308,6929 density 0.47578125,0.45110677083333334
before tensor 36864 mask 8407.0 36864
layer1.1.conv2.weight, mask/weight parameters,8407,6978 density 0.2594753086419753,0.21537037037037038
before tensor 16384 mask 8029.0 16384
layer1.1.conv3.weight, mask/weight parameters,8029,7431 density 0.5227213541666667,0.4837890625
before tensor 16384 mask 5531.0 16384
layer1.2.conv1.weight, mask/weight parameters,5531,5325 density 0.36009114583333335,0.3466796875
before tensor 36864 mask 4582.0 36864
layer1.2.conv2.weight, mask/weight parameters,4582,3598 density 0.14141975308641974,0.11104938271604939
before tensor 16384 mask 6103.0 16384
layer1.2.conv3.weight, mask/weight parameters,6103,5896 density 0.3973307291666667,0.38385416666666666
before tensor 32768 mask 9348.0 32768
layer2.0.conv1.weight, mask/weight parameters,9348,8510 density 0.312099358974359,0.2841212606837607
before tensor 147456 mask 19871.0 147456
layer2.0.conv2.weight, mask/weight parameters,19871,14656 density 0.1612892752493892,0.11896007337602779
before tensor 65536 mask 18341.0 65536
layer2.0.conv3.weight, mask/weight parameters,18341,15791 density 0.30617321047008544,0.26360510149572647
layer2.0.shortcut.0.weight, mask/weight parameters,44803,35270 density 0.34181976318359375,0.2690887451171875
before tensor 65536 mask 13050.0 65536
layer2.1.conv1.weight, mask/weight parameters,13050,11391 density 0.21784855769230768,0.1901542467948718
before tensor 147456 mask 19768.0 147456
layer2.1.conv2.weight, mask/weight parameters,19768,14630 density 0.1604532430743257,0.11874903612795351
before tensor 65536 mask 17989.0 65536
layer2.1.conv3.weight, mask/weight parameters,17989,15607 density 0.3002971420940171,0.2605335202991453
before tensor 65536 mask 16790.0 65536
layer2.2.conv1.weight, mask/weight parameters,16790,12862 density 0.2802817841880342,0.214710202991453
before tensor 147456 mask 29103.0 147456
layer2.2.conv2.weight, mask/weight parameters,29103,20454 density 0.23622373195022767,0.16602137969659336
before tensor 65536 mask 19996.0 65536
layer2.2.conv3.weight, mask/weight parameters,19996,16113 density 0.33380074786324787,0.2689803685897436
before tensor 65536 mask 16466.0 65536
layer2.3.conv1.weight, mask/weight parameters,16466,12940 density 0.2748731303418803,0.21601228632478633
before tensor 147456 mask 30044.0 147456
layer2.3.conv2.weight, mask/weight parameters,30044,20882 density 0.24386165696707007,0.16949537747258545
before tensor 65536 mask 20071.0 65536
layer2.3.conv3.weight, mask/weight parameters,20071,15947 density 0.33505275106837606,0.26620926816239315
before tensor 131072 mask 40599.0 131072
layer3.0.conv1.weight, mask/weight parameters,40599,29992 density 0.3417884563577586,0.2524919181034483
before tensor 589824 mask 117600.0 589824
layer3.0.conv2.weight, mask/weight parameters,117600,76526 density 0.24276654776060247,0.1579757894041485
before tensor 262144 mask 78933.0 262144
layer3.0.conv3.weight, mask/weight parameters,78933,55139 density 0.3322543440193966,0.2320977572737069
layer3.0.shortcut.0.weight, mask/weight parameters,115429,79322 density 0.22016334533691406,0.15129470825195312
before tensor 262144 mask 48054.0 262144
layer3.1.conv1.weight, mask/weight parameters,48054,31899 density 0.2022747171336207,0.1342731344288793
before tensor 589824 mask 109494.0 589824
layer3.1.conv2.weight, mask/weight parameters,109494,70991 density 0.22603299643281807,0.1465496597965385
before tensor 262144 mask 74438.0 262144
layer3.1.conv3.weight, mask/weight parameters,74438,55106 density 0.3133334455818966,0.23195884967672414
before tensor 262144 mask 48918.0 262144
layer3.2.conv1.weight, mask/weight parameters,48918,35388 density 0.20591157058189655,0.14895945581896552
before tensor 589824 mask 102030.0 589824
layer3.2.conv2.weight, mask/weight parameters,102030,66448 density 0.2106247522790329,0.13717135685031048
before tensor 262144 mask 68822.0 262144
layer3.2.conv3.weight, mask/weight parameters,68822,48327 density 0.2896938981681034,0.20342386179956898
before tensor 262144 mask 48198.0 262144
layer3.3.conv1.weight, mask/weight parameters,48198,30749 density 0.202880859375,0.12943241514008622
before tensor 589824 mask 86541.0 589824
layer3.3.conv2.weight, mask/weight parameters,86541,51411 density 0.17865016845025763,0.10612985533095522
before tensor 262144 mask 59476.0 262144
layer3.3.conv3.weight, mask/weight parameters,59476,40420 density 0.25035358297413796,0.17014075969827586
before tensor 262144 mask 49688.0 262144
layer3.4.conv1.weight, mask/weight parameters,49688,31717 density 0.2091527478448276,0.13350703798491378
before tensor 589824 mask 83357.0 589824
layer3.4.conv2.weight, mask/weight parameters,83357,51542 density 0.17207730545646716,0.10640028405337561
before tensor 262144 mask 55632.0 262144
layer3.4.conv3.weight, mask/weight parameters,55632,38632 density 0.2341729525862069,0.16261449353448276
before tensor 262144 mask 47787.0 262144
layer3.5.conv1.weight, mask/weight parameters,47787,32372 density 0.20115082839439655,0.13626414331896552
before tensor 589824 mask 80294.0 589824
layer3.5.conv2.weight, mask/weight parameters,80294,49478 density 0.16575422777117188,0.10213948341920993
before tensor 262144 mask 54193.0 262144
layer3.5.conv3.weight, mask/weight parameters,54193,35744 density 0.22811573949353448,0.15045797413793102
before tensor 524288 mask 129010.0 524288
layer4.0.conv1.weight, mask/weight parameters,129010,79946 density 0.27328921502169196,0.16935415536876355
before tensor 2359296 mask 287675.0 2359296
layer4.0.conv2.weight, mask/weight parameters,287675,153567 density 0.15040343725508956,0.08028853619171752
before tensor 1048576 mask 151981.0 1048576
layer4.0.conv3.weight, mask/weight parameters,151981,96552 density 0.1609749949159436,0.10226579446854664
layer4.0.shortcut.0.weight, mask/weight parameters,236897,157707 density 0.1129612922668457,0.07520055770874023
before tensor 1048576 mask 149359.0 1048576
layer4.1.conv1.weight, mask/weight parameters,149359,102960 density 0.15819782910791758,0.10905300976138829
before tensor 2359296 mask 350626.0 2359296
layer4.1.conv2.weight, mask/weight parameters,350626,221327 density 0.18331574030069708,0.11571510057306755
before tensor 1048576 mask 176728.0 1048576
layer4.1.conv3.weight, mask/weight parameters,176728,123163 density 0.18718648318872017,0.13045159130965292
before tensor 1048576 mask 52333.0 1048576
layer4.2.conv1.weight, mask/weight parameters,52333,38670 density 0.05542998406995662,0.04095842936550976
before tensor 2359296 mask 85216.0 2359296
layer4.2.conv2.weight, mask/weight parameters,85216,43472 density 0.04455298273791505,0.022728211434268716
before tensor 1048576 mask 71093.0 1048576
layer4.2.conv3.weight, mask/weight parameters,71093,48727 density 0.07530017116323211,0.05161058670010846
classifier.weight, mask/weight parameters,119768,105441 density 0.5848046875,0.5148486328125
Total Model parameters after dst: 3530621 2365205
Total parameters under density level of 0.1: 0.17085319676643884 0.11445658858822993 after dst
Death rate: 0.14927354543565144


Training summary: Average loss: 1.8405, Accuracy: 24691/50000 (49.382%)


Evaluation: Average loss: 2.0632, Accuracy: 4492/10000 (44.920%)

Current learning rate: 0.1. Time taken for epoch: 88.90 seconds.

Train Epoch: 10 [0/50000 (0%)]	Loss: 1.999576 Accuracy: 46/100 (46.000%
Train Epoch: 10 [10000/50000 (20%)]	Loss: 1.734852 Accuracy: 5084/10100 (50.337%
Train Epoch: 10 [20000/50000 (40%)]	Loss: 1.867728 Accuracy: 9971/20100 (49.607%
Train Epoch: 10 [30000/50000 (60%)]	Loss: 1.773593 Accuracy: 15084/30100 (50.113%
Train Epoch: 10 [40000/50000 (80%)]	Loss: 1.881540 Accuracy: 20131/40100 (50.202%
current layer rate 0.11648634501593086
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6846.0
Total filter_masks items: 17689223.0
6846.0 / 7552 channels
Total channels to prune: 173.7048775603098
Layer ('layer1', 0, 'conv1'): Pruned 1/60.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/60.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/60.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/60.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/60.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/60.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/117.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/117.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/232.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/232.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 11/461.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 11/461.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 11/461.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 11/461.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 11/461.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 11/461.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6698.0
Total filter_masks items: 17083001.0
After apply_mask:
Total filter_names items: 6698.0
Total filter_masks items: 17083001.0
Total pruned: 148/173.7048775603098 channels
===========done ===============

Training summary: Average loss: 1.7912, Accuracy: 25171/50000 (50.342%)


Evaluation: Average loss: 2.7910, Accuracy: 3268/10000 (32.680%)

Current learning rate: 0.1. Time taken for epoch: 88.68 seconds.

Train Epoch: 11 [0/50000 (0%)]	Loss: 1.631521 Accuracy: 55/100 (55.000%
Train Epoch: 11 [10000/50000 (20%)]	Loss: 2.063361 Accuracy: 5143/10100 (50.921%
Train Epoch: 11 [20000/50000 (40%)]	Loss: 1.746280 Accuracy: 10313/20100 (51.308%
Train Epoch: 11 [30000/50000 (60%)]	Loss: 1.939320 Accuracy: 15439/30100 (51.292%
Train Epoch: 11 [40000/50000 (80%)]	Loss: 1.618102 Accuracy: 20629/40100 (51.444%
current mest  death_rate 0.14895614572772894


dynamic sparse change prune
to kill 1010683.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1474,1474 density 0.8530092592592593,0.8530092592592593
before tensor 4096 mask 2247.0 4096
layer1.0.conv1.weight, mask/weight parameters,2247,2247 density 0.5950741525423728,0.5950741525423728
before tensor 36864 mask 8070.0 36864
layer1.0.conv2.weight, mask/weight parameters,8070,8070 density 0.25758881547448054,0.25758881547448054
before tensor 16384 mask 7428.0 16384
layer1.0.conv3.weight, mask/weight parameters,7428,7428 density 0.4917902542372881,0.4917902542372881
layer1.0.shortcut.0.weight, mask/weight parameters,8363,8363 density 0.51043701171875,0.51043701171875
before tensor 16384 mask 5148.0 16384
layer1.1.conv1.weight, mask/weight parameters,5148,5148 density 0.3408368644067797,0.3408368644067797
before tensor 36864 mask 6152.0 36864
layer1.1.conv2.weight, mask/weight parameters,6152,6152 density 0.19636758275080596,0.19636758275080596
before tensor 16384 mask 6115.0 16384
layer1.1.conv3.weight, mask/weight parameters,6115,6115 density 0.4048596398305085,0.4048596398305085
before tensor 16384 mask 3572.0 16384
layer1.2.conv1.weight, mask/weight parameters,3572,3572 density 0.2364936440677966,0.2364936440677966
before tensor 36864 mask 3146.0 36864
layer1.2.conv2.weight, mask/weight parameters,3146,3146 density 0.10041814293466117,0.10041814293466117
before tensor 16384 mask 4358.0 16384
layer1.2.conv3.weight, mask/weight parameters,4358,4358 density 0.2885328389830508,0.2885328389830508
before tensor 32768 mask 6488.0 32768
layer2.0.conv1.weight, mask/weight parameters,6488,6488 density 0.2203804347826087,0.2203804347826087
before tensor 147456 mask 13735.0 147456
layer2.0.conv2.weight, mask/weight parameters,13735,13735 density 0.1153959252257929,0.1153959252257929
before tensor 65536 mask 13826.0 65536
layer2.0.conv3.weight, mask/weight parameters,13826,13826 density 0.23481657608695652,0.23481657608695652
layer2.0.shortcut.0.weight, mask/weight parameters,33849,33849 density 0.25824737548828125,0.25824737548828125
before tensor 65536 mask 9221.0 65536
layer2.1.conv1.weight, mask/weight parameters,9221,9221 density 0.15660665760869566,0.15660665760869566
before tensor 147456 mask 12999.0 147456
layer2.1.conv2.weight, mask/weight parameters,12999,12999 density 0.10921235034656585,0.10921235034656585
before tensor 65536 mask 13037.0 65536
layer2.1.conv3.weight, mask/weight parameters,13037,13037 density 0.2214164402173913,0.2214164402173913
before tensor 65536 mask 12060.0 65536
layer2.2.conv1.weight, mask/weight parameters,12060,12060 density 0.20482336956521738,0.20482336956521738
before tensor 147456 mask 20185.0 147456
layer2.2.conv2.weight, mask/weight parameters,20185,20185 density 0.16958622138206259,0.16958622138206259
before tensor 65536 mask 14550.0 65536
layer2.2.conv3.weight, mask/weight parameters,14550,14550 density 0.24711277173913043,0.24711277173913043
before tensor 65536 mask 11626.0 65536
layer2.3.conv1.weight, mask/weight parameters,11626,11626 density 0.1974524456521739,0.1974524456521739
before tensor 147456 mask 20768.0 147456
layer2.3.conv2.weight, mask/weight parameters,20768,20768 density 0.17448435202688511,0.17448435202688511
before tensor 65536 mask 14583.0 65536
layer2.3.conv3.weight, mask/weight parameters,14583,14583 density 0.24767323369565217,0.24767323369565217
before tensor 131072 mask 29404.0 131072
layer3.0.conv1.weight, mask/weight parameters,29404,29404 density 0.252994218061674,0.252994218061674
before tensor 589824 mask 77715.0 589824
layer3.0.conv2.weight, mask/weight parameters,77715,77715 density 0.16757553998719169,0.16757553998719169
before tensor 262144 mask 57394.0 262144
layer3.0.conv3.weight, mask/weight parameters,57394,57394 density 0.24691113711453744,0.24691113711453744
layer3.0.shortcut.0.weight, mask/weight parameters,81314,81314 density 0.15509414672851562,0.15509414672851562
before tensor 262144 mask 32733.0 262144
layer3.1.conv1.weight, mask/weight parameters,32733,32733 density 0.14081859168502203,0.14081859168502203
before tensor 589824 mask 71426.0 589824
layer3.1.conv2.weight, mask/weight parameters,71426,71426 density 0.1540146756626797,0.1540146756626797
before tensor 262144 mask 54085.0 262144
layer3.1.conv3.weight, mask/weight parameters,54085,54085 density 0.2326756952092511,0.2326756952092511
before tensor 262144 mask 33802.0 262144
layer3.2.conv1.weight, mask/weight parameters,33802,33802 density 0.14541746971365638,0.14541746971365638
before tensor 589824 mask 66156.0 589824
layer3.2.conv2.weight, mask/weight parameters,66156,66156 density 0.14265106380226023,0.14265106380226023
before tensor 262144 mask 48547.0 262144
layer3.2.conv3.weight, mask/weight parameters,48547,48547 density 0.20885101183920704,0.20885101183920704
before tensor 262144 mask 31198.0 262144
layer3.3.conv1.weight, mask/weight parameters,31198,31198 density 0.13421496420704845,0.13421496420704845
before tensor 589824 mask 52798.0 589824
layer3.3.conv2.weight, mask/weight parameters,52798,52798 density 0.11384743434657076,0.11384743434657076
before tensor 262144 mask 40339.0 262144
layer3.3.conv3.weight, mask/weight parameters,40339,40339 density 0.17353988849118943,0.17353988849118943
before tensor 262144 mask 33423.0 262144
layer3.4.conv1.weight, mask/weight parameters,33423,33423 density 0.14378699752202642,0.14378699752202642
before tensor 589824 mask 53504.0 589824
layer3.4.conv2.weight, mask/weight parameters,53504,53504 density 0.11536977020491158,0.11536977020491158
before tensor 262144 mask 38180.0 262144
layer3.4.conv3.weight, mask/weight parameters,38180,38180 density 0.16425178964757708,0.16425178964757708
before tensor 262144 mask 32496.0 262144
layer3.5.conv1.weight, mask/weight parameters,32496,32496 density 0.1397990088105727,0.1397990088105727
before tensor 589824 mask 50377.0 589824
layer3.5.conv2.weight, mask/weight parameters,50377,50377 density 0.1086270729966513,0.1086270729966513
before tensor 262144 mask 36141.0 262144
layer3.5.conv3.weight, mask/weight parameters,36141,36141 density 0.15547993529735682,0.15547993529735682
before tensor 524288 mask 88829.0 524288
layer4.0.conv1.weight, mask/weight parameters,88829,88829 density 0.1927712673611111,0.1927712673611111
before tensor 2359296 mask 170700.0 2359296
layer4.0.conv2.weight, mask/weight parameters,170700,170700 density 0.09366255144032921,0.09366255144032921
before tensor 1048576 mask 99876.0 1048576
layer4.0.conv3.weight, mask/weight parameters,99876,99876 density 0.10837239583333333,0.10837239583333333
layer4.0.shortcut.0.weight, mask/weight parameters,154658,154658 density 0.0737466812133789,0.0737466812133789
before tensor 1048576 mask 104698.0 1048576
layer4.1.conv1.weight, mask/weight parameters,104698,104698 density 0.11360460069444445,0.11360460069444445
before tensor 2359296 mask 227856.0 2359296
layer4.1.conv2.weight, mask/weight parameters,227856,227856 density 0.1250238683127572,0.1250238683127572
before tensor 1048576 mask 120250.0 1048576
layer4.1.conv3.weight, mask/weight parameters,120250,120250 density 0.13047960069444445,0.13047960069444445
before tensor 1048576 mask 34439.0 1048576
layer4.2.conv1.weight, mask/weight parameters,34439,34439 density 0.037368706597222225,0.037368706597222225
before tensor 2359296 mask 41256.0 2359296
layer4.2.conv2.weight, mask/weight parameters,41256,41256 density 0.022637037037037035,0.022637037037037035
before tensor 1048576 mask 43275.0 1048576
layer4.2.conv3.weight, mask/weight parameters,43275,43275 density 0.046956380208333336,0.046956380208333336
classifier.weight, mask/weight parameters,105336,105336 density 0.5143359375,0.5143359375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.11791578850283609 0.11791578850283609 after dst
Death rate: 0.14895614572772894

dynamic sparse change grow
self.total_params*pruning_rate 3523115.5253489083
self.total_nonzero 2365205.0
to grow 1157910.5253489083
len(all_scores) 20058425 17674670
increse 1157910.0 before_mask 3523114.0 after_mask 3523114.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1600,1474 density 0.9259259259259259,0.8530092592592593
before tensor 4096 mask 2454.0 4096
layer1.0.conv1.weight, mask/weight parameters,2454,2247 density 0.6498940677966102,0.5950741525423728
before tensor 36864 mask 10706.0 36864
layer1.0.conv2.weight, mask/weight parameters,10706,8070 density 0.3417281113345463,0.25758881547448054
before tensor 16384 mask 8512.0 16384
layer1.0.conv3.weight, mask/weight parameters,8512,7428 density 0.5635593220338984,0.4917902542372881
layer1.0.shortcut.0.weight, mask/weight parameters,9539,8363 density 0.58221435546875,0.51043701171875
before tensor 16384 mask 5874.0 16384
layer1.1.conv1.weight, mask/weight parameters,5874,5148 density 0.3889036016949153,0.3408368644067797
before tensor 36864 mask 7858.0 36864
layer1.1.conv2.weight, mask/weight parameters,7858,6152 density 0.25082192218072713,0.19636758275080596
before tensor 16384 mask 6806.0 16384
layer1.1.conv3.weight, mask/weight parameters,6806,6115 density 0.4506091101694915,0.4048596398305085
before tensor 16384 mask 4023.0 16384
layer1.2.conv1.weight, mask/weight parameters,4023,3572 density 0.2663532838983051,0.2364936440677966
before tensor 36864 mask 4656.0 36864
layer1.2.conv2.weight, mask/weight parameters,4656,3146 density 0.14861629799865939,0.10041814293466117
before tensor 16384 mask 4880.0 16384
layer1.2.conv3.weight, mask/weight parameters,4880,4358 density 0.3230932203389831,0.2885328389830508
before tensor 32768 mask 9300.0 32768
layer2.0.conv1.weight, mask/weight parameters,9300,6488 density 0.31589673913043476,0.2203804347826087
before tensor 147456 mask 21386.0 147456
layer2.0.conv2.weight, mask/weight parameters,21386,13735 density 0.17967653854232304,0.1153959252257929
before tensor 65536 mask 16355.0 65536
layer2.0.conv3.weight, mask/weight parameters,16355,13826 density 0.2777683423913043,0.23481657608695652
layer2.0.shortcut.0.weight, mask/weight parameters,43025,33849 density 0.32825469970703125,0.25824737548828125
before tensor 65536 mask 11166.0 65536
layer2.1.conv1.weight, mask/weight parameters,11166,9221 density 0.1896399456521739,0.15660665760869566
before tensor 147456 mask 18800.0 147456
layer2.1.conv2.weight, mask/weight parameters,18800,12999 density 0.1579500105019954,0.10921235034656585
before tensor 65536 mask 15561.0 65536
layer2.1.conv3.weight, mask/weight parameters,15561,13037 density 0.2642832880434783,0.2214164402173913
before tensor 65536 mask 14867.0 65536
layer2.2.conv1.weight, mask/weight parameters,14867,12060 density 0.2524966032608696,0.20482336956521738
before tensor 147456 mask 28360.0 147456
layer2.2.conv2.weight, mask/weight parameters,28360,20185 density 0.2382692711615207,0.16958622138206259
before tensor 65536 mask 17990.0 65536
layer2.2.conv3.weight, mask/weight parameters,17990,14550 density 0.3055366847826087,0.24711277173913043
before tensor 65536 mask 16201.0 65536
layer2.3.conv1.weight, mask/weight parameters,16201,11626 density 0.2751528532608696,0.1974524456521739
before tensor 147456 mask 31878.0 147456
layer2.3.conv2.weight, mask/weight parameters,31878,20768 density 0.2678260869565217,0.17448435202688511
before tensor 65536 mask 17924.0 65536
layer2.3.conv3.weight, mask/weight parameters,17924,14583 density 0.30441576086956523,0.24767323369565217
before tensor 131072 mask 40069.0 131072
layer3.0.conv1.weight, mask/weight parameters,40069,29404 density 0.3447566767621145,0.252994218061674
before tensor 589824 mask 117197.0 589824
layer3.0.conv2.weight, mask/weight parameters,117197,77715 density 0.25270990876766264,0.16757553998719169
before tensor 262144 mask 79444.0 262144
layer3.0.conv3.weight, mask/weight parameters,79444,57394 density 0.34177106277533037,0.24691113711453744
layer3.0.shortcut.0.weight, mask/weight parameters,111553,81314 density 0.2127704620361328,0.15509414672851562
before tensor 262144 mask 43007.0 262144
layer3.1.conv1.weight, mask/weight parameters,43007,32733 density 0.18501772439427314,0.14081859168502203
before tensor 589824 mask 100887.0 589824
layer3.1.conv2.weight, mask/weight parameters,100887,71426 density 0.21754093164366992,0.1540146756626797
before tensor 262144 mask 70972.0 262144
layer3.1.conv3.weight, mask/weight parameters,70972,54085 density 0.3053242015418502,0.2326756952092511
before tensor 262144 mask 45628.0 262144
layer3.2.conv1.weight, mask/weight parameters,45628,33802 density 0.19629336453744495,0.14541746971365638
before tensor 589824 mask 94057.0 589824
layer3.2.conv2.weight, mask/weight parameters,94057,66156 density 0.2028135181699194,0.14265106380226023
before tensor 262144 mask 66475.0 262144
layer3.2.conv3.weight, mask/weight parameters,66475,48547 density 0.2859779391519824,0.20885101183920704
before tensor 262144 mask 43591.0 262144
layer3.3.conv1.weight, mask/weight parameters,43591,31198 density 0.18753011426211455,0.13421496420704845
before tensor 589824 mask 82726.0 589824
layer3.3.conv2.weight, mask/weight parameters,82726,52798 density 0.1783806745284748,0.11384743434657076
before tensor 262144 mask 57036.0 262144
layer3.3.conv3.weight, mask/weight parameters,57036,40339 density 0.2453710077092511,0.17353988849118943
before tensor 262144 mask 46333.0 262144
layer3.4.conv1.weight, mask/weight parameters,46333,33423 density 0.19932630093612336,0.14378699752202642
before tensor 589824 mask 81258.0 589824
layer3.4.conv2.weight, mask/weight parameters,81258,53504 density 0.1752152509590069,0.11536977020491158
before tensor 262144 mask 53907.0 262144
layer3.4.conv3.weight, mask/weight parameters,53907,38180 density 0.23190993254405287,0.16425178964757708
before tensor 262144 mask 47818.0 262144
layer3.5.conv1.weight, mask/weight parameters,47818,32496 density 0.20571482654185022,0.1397990088105727
before tensor 589824 mask 77561.0 589824
layer3.5.conv2.weight, mask/weight parameters,77561,50377 density 0.16724347239202952,0.1086270729966513
before tensor 262144 mask 49752.0 262144
layer3.5.conv3.weight, mask/weight parameters,49752,36141 density 0.21403496696035243,0.15547993529735682
before tensor 524288 mask 135075.0 524288
layer4.0.conv1.weight, mask/weight parameters,135075,88829 density 0.2931315104166667,0.1927712673611111
before tensor 2359296 mask 309947.0 2359296
layer4.0.conv2.weight, mask/weight parameters,309947,170700 density 0.17006694101508915,0.09366255144032921
before tensor 1048576 mask 154827.0 1048576
layer4.0.conv3.weight, mask/weight parameters,154827,99876 density 0.167998046875,0.10837239583333333
layer4.0.shortcut.0.weight, mask/weight parameters,235115,154658 density 0.11211156845092773,0.0737466812133789
before tensor 1048576 mask 153697.0 1048576
layer4.1.conv1.weight, mask/weight parameters,153697,104698 density 0.16677191840277777,0.11360460069444445
before tensor 2359296 mask 363878.0 2359296
layer4.1.conv2.weight, mask/weight parameters,363878,227856 density 0.19965871056241427,0.1250238683127572
before tensor 1048576 mask 175739.0 1048576
layer4.1.conv3.weight, mask/weight parameters,175739,120250 density 0.19068901909722222,0.13047960069444445
before tensor 1048576 mask 60027.0 1048576
layer4.2.conv1.weight, mask/weight parameters,60027,34439 density 0.06513346354166667,0.037368706597222225
before tensor 2359296 mask 102346.0 2359296
layer4.2.conv2.weight, mask/weight parameters,102346,41256 density 0.05615692729766804,0.022637037037037035
before tensor 1048576 mask 74063.0 1048576
layer4.2.conv3.weight, mask/weight parameters,74063,43275 density 0.08036349826388889,0.046956380208333336
classifier.weight, mask/weight parameters,119408,105336 density 0.583046875,0.5143359375
Total Model parameters after dst: 3523114 2365205
Total parameters under density level of 0.1: 0.17564260404293958 0.11791578850283609 after dst
Death rate: 0.14895614572772894


Training summary: Average loss: 1.7414, Accuracy: 25768/50000 (51.536%)


Evaluation: Average loss: 1.9260, Accuracy: 4837/10000 (48.370%)

Current learning rate: 0.1. Time taken for epoch: 88.91 seconds.

Train Epoch: 12 [0/50000 (0%)]	Loss: 1.573713 Accuracy: 54/100 (54.000%
Train Epoch: 12 [10000/50000 (20%)]	Loss: 1.701679 Accuracy: 5358/10100 (53.050%
Train Epoch: 12 [20000/50000 (40%)]	Loss: 1.521876 Accuracy: 10608/20100 (52.776%
Train Epoch: 12 [30000/50000 (60%)]	Loss: 1.885951 Accuracy: 15888/30100 (52.784%
Train Epoch: 12 [40000/50000 (80%)]	Loss: 1.682610 Accuracy: 21124/40100 (52.678%
current layer rate 0.13549999999999995
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6698.0
Total filter_masks items: 17083001.0
6698.0 / 7552 channels
Total channels to prune: 169.29599999999937
Layer ('layer1', 0, 'conv1'): Pruned 1/59.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/59.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/59.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/59.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/59.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/59.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/115.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/115.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/227.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/227.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 11/450.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 11/450.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 11/450.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 11/450.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 11/450.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 11/450.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6550.0
Total filter_masks items: 16486355.0
After apply_mask:
Total filter_names items: 6550.0
Total filter_masks items: 16486355.0
Total pruned: 148/169.29599999999937 channels
===========done ===============

Training summary: Average loss: 1.6989, Accuracy: 26294/50000 (52.588%)


Evaluation: Average loss: 2.1441, Accuracy: 4297/10000 (42.970%)

Current learning rate: 0.1. Time taken for epoch: 88.70 seconds.

Train Epoch: 13 [0/50000 (0%)]	Loss: 1.609840 Accuracy: 57/100 (57.000%
Train Epoch: 13 [10000/50000 (20%)]	Loss: 1.473754 Accuracy: 5424/10100 (53.703%
Train Epoch: 13 [20000/50000 (40%)]	Loss: 2.012919 Accuracy: 10793/20100 (53.697%
Train Epoch: 13 [30000/50000 (60%)]	Loss: 1.643577 Accuracy: 16159/30100 (53.684%
Train Epoch: 13 [40000/50000 (80%)]	Loss: 1.628790 Accuracy: 21560/40100 (53.766%
current mest  death_rate 0.1485827953314434


dynamic sparse change prune
to kill 1003366.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1462,1462 density 0.8460648148148148,0.8460648148148148
before tensor 4096 mask 1849.0 4096
layer1.0.conv1.weight, mask/weight parameters,1849,1849 density 0.49811422413793105,0.49811422413793105
before tensor 36864 mask 7816.0 36864
layer1.0.conv2.weight, mask/weight parameters,7816,7816 density 0.25815827718324746,0.25815827718324746
before tensor 16384 mask 6630.0 16384
layer1.0.conv3.weight, mask/weight parameters,6630,6630 density 0.4465247844827586,0.4465247844827586
layer1.0.shortcut.0.weight, mask/weight parameters,7863,7863 density 0.47991943359375,0.47991943359375
before tensor 16384 mask 3988.0 16384
layer1.1.conv1.weight, mask/weight parameters,3988,3988 density 0.2685883620689655,0.2685883620689655
before tensor 36864 mask 5523.0 36864
layer1.1.conv2.weight, mask/weight parameters,5523,5523 density 0.18242172017439556,0.18242172017439556
before tensor 16384 mask 5107.0 16384
layer1.1.conv3.weight, mask/weight parameters,5107,5107 density 0.3439520474137931,0.3439520474137931
before tensor 16384 mask 2718.0 16384
layer1.2.conv1.weight, mask/weight parameters,2718,2718 density 0.1830549568965517,0.1830549568965517
before tensor 36864 mask 2887.0 36864
layer1.2.conv2.weight, mask/weight parameters,2887,2887 density 0.09535605760338221,0.09535605760338221
before tensor 16384 mask 3470.0 16384
layer1.2.conv3.weight, mask/weight parameters,3470,3470 density 0.23370150862068967,0.23370150862068967
before tensor 32768 mask 6180.0 32768
layer2.0.conv1.weight, mask/weight parameters,6180,6180 density 0.21363384955752213,0.21363384955752213
before tensor 147456 mask 14462.0 147456
layer2.0.conv2.weight, mask/weight parameters,14462,14462 density 0.12584297038835374,0.12584297038835374
before tensor 65536 mask 12303.0 65536
layer2.0.conv3.weight, mask/weight parameters,12303,12303 density 0.21264864491150443,0.21264864491150443
layer2.0.shortcut.0.weight, mask/weight parameters,32335,32335 density 0.24669647216796875,0.24669647216796875
before tensor 65536 mask 7856.0 65536
layer2.1.conv1.weight, mask/weight parameters,7856,7856 density 0.1357853982300885,0.1357853982300885
before tensor 147456 mask 11867.0 147456
layer2.1.conv2.weight, mask/weight parameters,11867,11867 density 0.10326224101774262,0.10326224101774262
before tensor 65536 mask 11182.0 65536
layer2.1.conv3.weight, mask/weight parameters,11182,11182 density 0.19327295353982302,0.19327295353982302
before tensor 65536 mask 10940.0 65536
layer2.2.conv1.weight, mask/weight parameters,10940,10940 density 0.18909015486725664,0.18909015486725664
before tensor 147456 mask 19704.0 147456
layer2.2.conv2.weight, mask/weight parameters,19704,19704 density 0.17145691387996972,0.17145691387996972
before tensor 65536 mask 13078.0 65536
layer2.2.conv3.weight, mask/weight parameters,13078,13078 density 0.22604397123893805,0.22604397123893805
before tensor 65536 mask 11123.0 65536
layer2.3.conv1.weight, mask/weight parameters,11123,11123 density 0.1922531803097345,0.1922531803097345
before tensor 147456 mask 21776.0 147456
layer2.3.conv2.weight, mask/weight parameters,21776,21776 density 0.18948669085719755,0.18948669085719755
before tensor 65536 mask 13053.0 65536
layer2.3.conv3.weight, mask/weight parameters,13053,13053 density 0.2256118639380531,0.2256118639380531
before tensor 131072 mask 29108.0 131072
layer3.0.conv1.weight, mask/weight parameters,29108,29108 density 0.25608811936936937,0.25608811936936937
before tensor 589824 mask 78781.0 589824
layer3.0.conv2.weight, mask/weight parameters,78781,78781 density 0.17761229698166636,0.17761229698166636
before tensor 262144 mask 58373.0 262144
layer3.0.conv3.weight, mask/weight parameters,58373,58373 density 0.25677875140765766,0.25677875140765766
layer3.0.shortcut.0.weight, mask/weight parameters,80106,80106 density 0.15279006958007812,0.15279006958007812
before tensor 262144 mask 30567.0 262144
layer3.1.conv1.weight, mask/weight parameters,30567,30567 density 0.13446209881756757,0.13446209881756757
before tensor 589824 mask 67439.0 589824
layer3.1.conv2.weight, mask/weight parameters,67439,67439 density 0.1520416813209606,0.1520416813209606
before tensor 262144 mask 51502.0 262144
layer3.1.conv3.weight, mask/weight parameters,51502,51502 density 0.22655370213963963,0.22655370213963963
before tensor 262144 mask 32263.0 262144
layer3.2.conv1.weight, mask/weight parameters,32263,32263 density 0.14192268440315314,0.14192268440315314
before tensor 589824 mask 64002.0 589824
layer3.2.conv2.weight, mask/weight parameters,64002,64002 density 0.1442929415902389,0.1442929415902389
before tensor 262144 mask 47801.0 262144
layer3.2.conv3.weight, mask/weight parameters,47801,47801 density 0.2102732615427928,0.2102732615427928
before tensor 262144 mask 29813.0 262144
layer3.3.conv1.weight, mask/weight parameters,29813,29813 density 0.13114530546171171,0.13114530546171171
before tensor 589824 mask 52832.0 589824
layer3.3.conv2.weight, mask/weight parameters,52832,52832 density 0.11911010109208307,0.11911010109208307
before tensor 262144 mask 39635.0 262144
layer3.3.conv3.weight, mask/weight parameters,39635,39635 density 0.17435159769144143,0.17435159769144143
before tensor 262144 mask 32344.0 262144
layer3.4.conv1.weight, mask/weight parameters,32344,32344 density 0.14227899774774774,0.14227899774774774
before tensor 589824 mask 52629.0 589824
layer3.4.conv2.weight, mask/weight parameters,52629,52629 density 0.11865243622000379,0.11865243622000379
before tensor 262144 mask 37111.0 262144
layer3.4.conv3.weight, mask/weight parameters,37111,37111 density 0.16324869791666666,0.16324869791666666
before tensor 262144 mask 33423.0 262144
layer3.5.conv1.weight, mask/weight parameters,33423,33423 density 0.14702544341216217,0.14702544341216217
before tensor 589824 mask 50974.0 589824
layer3.5.conv2.weight, mask/weight parameters,50974,50974 density 0.11492122753384014,0.11492122753384014
before tensor 262144 mask 34296.0 262144
layer3.5.conv3.weight, mask/weight parameters,34296,34296 density 0.15086570945945946,0.15086570945945946
before tensor 524288 mask 95999.0 524288
layer4.0.conv1.weight, mask/weight parameters,95999,95999 density 0.2135513062357631,0.2135513062357631
before tensor 2359296 mask 187698.0 2359296
layer4.0.conv2.weight, mask/weight parameters,187698,187698 density 0.10821515731722715,0.10821515731722715
before tensor 1048576 mask 102371.0 1048576
layer4.0.conv3.weight, mask/weight parameters,102371,102371 density 0.11386296091970387,0.11386296091970387
layer4.0.shortcut.0.weight, mask/weight parameters,153380,153380 density 0.07313728332519531,0.07313728332519531
before tensor 1048576 mask 107631.0 1048576
layer4.1.conv1.weight, mask/weight parameters,107631,107631 density 0.11971343785592255,0.11971343785592255
before tensor 2359296 mask 236580.0 2359296
layer4.1.conv2.weight, mask/weight parameters,236580,236580 density 0.13639752111428785,0.13639752111428785
before tensor 1048576 mask 119273.0 1048576
layer4.1.conv3.weight, mask/weight parameters,119273,119273 density 0.13266234517369022,0.13266234517369022
before tensor 1048576 mask 34847.0 1048576
layer4.2.conv1.weight, mask/weight parameters,34847,34847 density 0.03875885357346241,0.03875885357346241
before tensor 2359296 mask 42822.0 2359296
layer4.2.conv2.weight, mask/weight parameters,42822,42822 density 0.02468853939114056,0.02468853939114056
before tensor 1048576 mask 41173.0 1048576
layer4.2.conv3.weight, mask/weight parameters,41173,41173 density 0.04579499750854214,0.04579499750854214
classifier.weight, mask/weight parameters,105260,105260 density 0.51396484375,0.51396484375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.12153077064537625 0.12153077064537625 after dst
Death rate: 0.1485827953314434

dynamic sparse change grow
self.total_params*pruning_rate 3514285.0298287496
self.total_nonzero 2365205.0
to grow 1149080.0298287496
len(all_scores) 19461779 17054574
increse 1149080.0 before_mask 3514284.0 after_mask 3514284.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1556,1462 density 0.9004629629629629,0.8460648148148148
before tensor 4096 mask 2032.0 4096
layer1.0.conv1.weight, mask/weight parameters,2032,1849 density 0.5474137931034483,0.49811422413793105
before tensor 36864 mask 9581.0 36864
layer1.0.conv2.weight, mask/weight parameters,9581,7816 density 0.3164552781080724,0.25815827718324746
before tensor 16384 mask 7647.0 16384
layer1.0.conv3.weight, mask/weight parameters,7647,6630 density 0.5150188577586207,0.4465247844827586
layer1.0.shortcut.0.weight, mask/weight parameters,8782,7863 density 0.5360107421875,0.47991943359375
before tensor 16384 mask 4738.0 16384
layer1.1.conv1.weight, mask/weight parameters,4738,3988 density 0.3191002155172414,0.2685883620689655
before tensor 36864 mask 6867.0 36864
layer1.1.conv2.weight, mask/weight parameters,6867,5523 density 0.22681331747919145,0.18242172017439556
before tensor 16384 mask 5740.0 16384
layer1.1.conv3.weight, mask/weight parameters,5740,5107 density 0.38658405172413796,0.3439520474137931
before tensor 16384 mask 4015.0 16384
layer1.2.conv1.weight, mask/weight parameters,4015,2718 density 0.2704067887931034,0.1830549568965517
before tensor 36864 mask 5286.0 36864
layer1.2.conv2.weight, mask/weight parameters,5286,2887 density 0.17459373761395164,0.09535605760338221
before tensor 16384 mask 4440.0 16384
layer1.2.conv3.weight, mask/weight parameters,4440,3470 density 0.2990301724137931,0.23370150862068967
before tensor 32768 mask 8373.0 32768
layer2.0.conv1.weight, mask/weight parameters,8373,6180 density 0.28944275442477874,0.21363384955752213
before tensor 147456 mask 19606.0 147456
layer2.0.conv2.weight, mask/weight parameters,19606,14462 density 0.1706041541580738,0.12584297038835374
before tensor 65536 mask 14668.0 65536
layer2.0.conv3.weight, mask/weight parameters,14668,12303 density 0.25352599557522126,0.21264864491150443
layer2.0.shortcut.0.weight, mask/weight parameters,41857,32335 density 0.31934356689453125,0.24669647216796875
before tensor 65536 mask 11067.0 65536
layer2.1.conv1.weight, mask/weight parameters,11067,7856 density 0.1912852599557522,0.1357853982300885
before tensor 147456 mask 18959.0 147456
layer2.1.conv2.weight, mask/weight parameters,18959,11867 density 0.16497419966759774,0.10326224101774262
before tensor 65536 mask 13429.0 65536
layer2.1.conv3.weight, mask/weight parameters,13429,11182 density 0.23211075774336284,0.19327295353982302
before tensor 65536 mask 14761.0 65536
layer2.2.conv1.weight, mask/weight parameters,14761,10940 density 0.2551334347345133,0.18909015486725664
before tensor 147456 mask 29285.0 147456
layer2.2.conv2.weight, mask/weight parameters,29285,19704 density 0.25482722914001793,0.17145691387996972
before tensor 65536 mask 17067.0 65536
layer2.2.conv3.weight, mask/weight parameters,17067,13078 density 0.2949910121681416,0.22604397123893805
before tensor 65536 mask 14339.0 65536
layer2.3.conv1.weight, mask/weight parameters,14339,11123 density 0.24783946349557523,0.1922531803097345
before tensor 147456 mask 29448.0 147456
layer2.3.conv2.weight, mask/weight parameters,29448,21776 density 0.256245594799906,0.18948669085719755
before tensor 65536 mask 16606.0 65536
layer2.3.conv3.weight, mask/weight parameters,16606,13053 density 0.287022953539823,0.2256118639380531
before tensor 131072 mask 38499.0 131072
layer3.0.conv1.weight, mask/weight parameters,38499,29108 density 0.3387088260135135,0.25608811936936937
before tensor 589824 mask 118140.0 589824
layer3.0.conv2.weight, mask/weight parameters,118140,78781 density 0.26634742850959064,0.17761229698166636
before tensor 262144 mask 81433.0 262144
layer3.0.conv3.weight, mask/weight parameters,81433,58373 density 0.35821808136261263,0.25677875140765766
layer3.0.shortcut.0.weight, mask/weight parameters,113755,80106 density 0.21697044372558594,0.15279006958007812
before tensor 262144 mask 43684.0 262144
layer3.1.conv1.weight, mask/weight parameters,43684,30567 density 0.192162865990991,0.13446209881756757
before tensor 589824 mask 106672.0 589824
layer3.1.conv2.weight, mask/weight parameters,106672,67439 density 0.2404927449972495,0.1520416813209606
before tensor 262144 mask 71473.0 262144
layer3.1.conv3.weight, mask/weight parameters,71473,51502 density 0.314404736768018,0.22655370213963963
before tensor 262144 mask 47963.0 262144
layer3.2.conv1.weight, mask/weight parameters,47963,32263 density 0.21098588823198197,0.14192268440315314
before tensor 589824 mask 104374.0 589824
layer3.2.conv2.weight, mask/weight parameters,104374,64002 density 0.2353118884650416,0.1442929415902389
before tensor 262144 mask 67671.0 262144
layer3.2.conv3.weight, mask/weight parameters,67671,47801 density 0.29768000422297297,0.2102732615427928
before tensor 262144 mask 43363.0 262144
layer3.3.conv1.weight, mask/weight parameters,43363,29813 density 0.19075080940315314,0.13114530546171171
before tensor 589824 mask 79553.0 589824
layer3.3.conv2.weight, mask/weight parameters,79553,52832 density 0.17935277619962306,0.11911010109208307
before tensor 262144 mask 54800.0 262144
layer3.3.conv3.weight, mask/weight parameters,54800,39635 density 0.24106137387387389,0.17435159769144143
before tensor 262144 mask 48542.0 262144
layer3.4.conv1.weight, mask/weight parameters,48542,32344 density 0.21353286880630631,0.14227899774774774
before tensor 589824 mask 80372.0 589824
layer3.4.conv2.weight, mask/weight parameters,80372,52629 density 0.18119921723525328,0.11865243622000379
before tensor 262144 mask 53207.0 262144
layer3.4.conv3.weight, mask/weight parameters,53207,37111 density 0.23405387809684686,0.16324869791666666
before tensor 262144 mask 51347.0 262144
layer3.5.conv1.weight, mask/weight parameters,51347,33423 density 0.22587186796171171,0.14702544341216217
before tensor 589824 mask 81281.0 589824
layer3.5.conv2.weight, mask/weight parameters,81281,50974 density 0.1832485638791945,0.11492122753384014
before tensor 262144 mask 52281.0 262144
layer3.5.conv3.weight, mask/weight parameters,52281,34296 density 0.22998046875,0.15086570945945946
before tensor 524288 mask 139417.0 524288
layer4.0.conv1.weight, mask/weight parameters,139417,95999 density 0.3101353395501139,0.2135513062357631
before tensor 2359296 mask 308905.0 2359296
layer4.0.conv2.weight, mask/weight parameters,308905,187698 density 0.17809568120639566,0.10821515731722715
before tensor 1048576 mask 157638.0 1048576
layer4.0.conv3.weight, mask/weight parameters,157638,102371 density 0.1753341222949886,0.11386296091970387
layer4.0.shortcut.0.weight, mask/weight parameters,229487,153380 density 0.10942792892456055,0.07313728332519531
before tensor 1048576 mask 154457.0 1048576
layer4.1.conv1.weight, mask/weight parameters,154457,107631 density 0.17179602968394078,0.11971343785592255
before tensor 2359296 mask 361535.0 2359296
layer4.1.conv2.weight, mask/weight parameters,361535,236580 density 0.20843891197926306,0.13639752111428785
before tensor 1048576 mask 174087.0 1048576
layer4.1.conv3.weight, mask/weight parameters,174087,119273 density 0.19362965368735763,0.13266234517369022
before tensor 1048576 mask 56699.0 1048576
layer4.2.conv1.weight, mask/weight parameters,56699,34847 density 0.06306391479214123,0.03875885357346241
before tensor 2359296 mask 96242.0 2359296
layer4.2.conv2.weight, mask/weight parameters,96242,42822 density 0.05548723572187544,0.02468853939114056
before tensor 1048576 mask 66376.0 1048576
layer4.2.conv3.weight, mask/weight parameters,66376,41173 density 0.07382723519362187,0.04579499750854214
classifier.weight, mask/weight parameters,120882,105260 density 0.590244140625,0.51396484375
Total Model parameters after dst: 3514284 2365205
Total parameters under density level of 0.1: 0.18057362587459244 0.12153077064537625 after dst
Death rate: 0.1485827953314434


Training summary: Average loss: 1.6522, Accuracy: 26926/50000 (53.852%)


Evaluation: Average loss: 1.9081, Accuracy: 4793/10000 (47.930%)

Current learning rate: 0.1. Time taken for epoch: 88.89 seconds.

Train Epoch: 14 [0/50000 (0%)]	Loss: 1.648003 Accuracy: 58/100 (58.000%
Train Epoch: 14 [10000/50000 (20%)]	Loss: 1.625375 Accuracy: 5493/10100 (54.386%
Train Epoch: 14 [20000/50000 (40%)]	Loss: 1.661986 Accuracy: 10921/20100 (54.333%
Train Epoch: 14 [30000/50000 (60%)]	Loss: 1.655941 Accuracy: 16323/30100 (54.229%
Train Epoch: 14 [40000/50000 (80%)]	Loss: 1.538537 Accuracy: 21756/40100 (54.254%
current layer rate 0.15387460172963136
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6550.0
Total filter_masks items: 16486355.0
6550.0 / 7552 channels
Total channels to prune: 160.0609922621752
Layer ('layer1', 0, 'conv1'): Pruned 1/58.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/58.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/58.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/58.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/58.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/58.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/113.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/113.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/222.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/222.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 10/439.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 10/439.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 10/439.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 10/439.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 10/439.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 10/439.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6408.0
Total filter_masks items: 15933688.0
After apply_mask:
Total filter_names items: 6408.0
Total filter_masks items: 15933688.0
Total pruned: 142/160.0609922621752 channels
===========done ===============

Training summary: Average loss: 1.6302, Accuracy: 27211/50000 (54.422%)


Evaluation: Average loss: 2.8146, Accuracy: 3198/10000 (31.980%)

Current learning rate: 0.1. Time taken for epoch: 88.68 seconds.

Train Epoch: 15 [0/50000 (0%)]	Loss: 1.459243 Accuracy: 56/100 (56.000%
Train Epoch: 15 [10000/50000 (20%)]	Loss: 1.493964 Accuracy: 5586/10100 (55.307%
Train Epoch: 15 [20000/50000 (40%)]	Loss: 1.656292 Accuracy: 11163/20100 (55.537%
Train Epoch: 15 [30000/50000 (60%)]	Loss: 1.786414 Accuracy: 16685/30100 (55.432%
Train Epoch: 15 [40000/50000 (80%)]	Loss: 1.767719 Accuracy: 22062/40100 (55.017%
current mest  death_rate 0.14815436622394432


dynamic sparse change prune
to kill 996474.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1409,1409 density 0.8153935185185185,0.8153935185185185
before tensor 4096 mask 1500.0 4096
layer1.0.conv1.weight, mask/weight parameters,1500,1500 density 0.41118421052631576,0.41118421052631576
before tensor 36864 mask 7012.0 36864
layer1.0.conv2.weight, mask/weight parameters,7012,7012 density 0.23980028042816592,0.23980028042816592
before tensor 16384 mask 5894.0 16384
layer1.0.conv3.weight, mask/weight parameters,5894,5894 density 0.40391995614035087,0.40391995614035087
layer1.0.shortcut.0.weight, mask/weight parameters,7406,7406 density 0.4520263671875,0.4520263671875
before tensor 16384 mask 3350.0 16384
layer1.1.conv1.weight, mask/weight parameters,3350,3350 density 0.22957785087719298,0.22957785087719298
before tensor 36864 mask 4911.0 36864
layer1.1.conv2.weight, mask/weight parameters,4911,4911 density 0.16794911254745049,0.16794911254745049
before tensor 16384 mask 4404.0 16384
layer1.1.conv3.weight, mask/weight parameters,4404,4404 density 0.30180921052631576,0.30180921052631576
before tensor 16384 mask 2494.0 16384
layer1.2.conv1.weight, mask/weight parameters,2494,2494 density 0.1709155701754386,0.1709155701754386
before tensor 36864 mask 3036.0 36864
layer1.2.conv2.weight, mask/weight parameters,3036,3036 density 0.10382681850825895,0.10382681850825895
before tensor 16384 mask 2973.0 16384
layer1.2.conv3.weight, mask/weight parameters,2973,2973 density 0.20374177631578946,0.20374177631578946
before tensor 32768 mask 5532.0 32768
layer2.0.conv1.weight, mask/weight parameters,5532,5532 density 0.19467905405405406,0.19467905405405406
before tensor 147456 mask 14009.0 147456
layer2.0.conv2.weight, mask/weight parameters,14009,14009 density 0.12633354074795516,0.12633354074795516
before tensor 65536 mask 10979.0 65536
layer2.0.conv3.weight, mask/weight parameters,10979,10979 density 0.1931834177927928,0.1931834177927928
layer2.0.shortcut.0.weight, mask/weight parameters,31760,31760 density 0.2423095703125,0.2423095703125
before tensor 65536 mask 7315.0 65536
layer2.1.conv1.weight, mask/weight parameters,7315,7315 density 0.12871269707207209,0.12871269707207209
before tensor 147456 mask 11371.0 147456
layer2.1.conv2.weight, mask/weight parameters,11371,11371 density 0.10254398542686831,0.10254398542686831
before tensor 65536 mask 9570.0 65536
layer2.1.conv3.weight, mask/weight parameters,9570,9570 density 0.16839104729729729,0.16839104729729729
before tensor 65536 mask 10799.0 65536
layer2.2.conv1.weight, mask/weight parameters,10799,10799 density 0.19001618806306306,0.19001618806306306
before tensor 147456 mask 20355.0 147456
layer2.2.conv2.weight, mask/weight parameters,20355,20355 density 0.18356194031869708,0.18356194031869708
before tensor 65536 mask 12353.0 65536
layer2.2.conv3.weight, mask/weight parameters,12353,12353 density 0.21735993806306306,0.21735993806306306
before tensor 65536 mask 10267.0 65536
layer2.3.conv1.weight, mask/weight parameters,10267,10267 density 0.18065526463963963,0.18065526463963963
before tensor 147456 mask 20793.0 147456
layer2.3.conv2.weight, mask/weight parameters,20793,20793 density 0.1875118361604848,0.1875118361604848
before tensor 65536 mask 11933.0 65536
layer2.3.conv3.weight, mask/weight parameters,11933,11933 density 0.20996973536036037,0.20996973536036037
before tensor 131072 mask 28213.0 131072
layer3.0.conv1.weight, mask/weight parameters,28213,28213 density 0.2539332517281106,0.2539332517281106
before tensor 589824 mask 79261.0 589824
layer3.0.conv2.weight, mask/weight parameters,79261,79261 density 0.18702409857456684,0.18702409857456684
before tensor 262144 mask 59652.0 262144
layer3.0.conv3.weight, mask/weight parameters,59652,59652 density 0.268451180875576,0.268451180875576
layer3.0.shortcut.0.weight, mask/weight parameters,80727,80727 density 0.1539745330810547,0.1539745330810547
before tensor 262144 mask 30481.0 262144
layer3.1.conv1.weight, mask/weight parameters,30481,30481 density 0.13717327908986174,0.13717327908986174
before tensor 589824 mask 69590.0 589824
layer3.1.conv2.weight, mask/weight parameters,69590,69590 density 0.16420442613396383,0.16420442613396383
before tensor 262144 mask 51249.0 262144
layer3.1.conv3.weight, mask/weight parameters,51249,51249 density 0.23063526065668202,0.23063526065668202
before tensor 262144 mask 32701.0 262144
layer3.2.conv1.weight, mask/weight parameters,32701,32701 density 0.14716391849078342,0.14716391849078342
before tensor 589824 mask 67570.0 589824
layer3.2.conv2.weight, mask/weight parameters,67570,67570 density 0.1594380381358232,0.1594380381358232
before tensor 262144 mask 47805.0 262144
layer3.2.conv3.weight, mask/weight parameters,47805,47805 density 0.21513626872119815,0.21513626872119815
before tensor 262144 mask 29290.0 262144
layer3.3.conv1.weight, mask/weight parameters,29290,29290 density 0.13181343605990783,0.13181343605990783
before tensor 589824 mask 51043.0 589824
layer3.3.conv2.weight, mask/weight parameters,51043,51043 density 0.12044096167776858,0.12044096167776858
before tensor 262144 mask 38233.0 262144
layer3.3.conv3.weight, mask/weight parameters,38233,38233 density 0.17205951180875576,0.17205951180875576
before tensor 262144 mask 33400.0 262144
layer3.4.conv1.weight, mask/weight parameters,33400,33400 density 0.1503096198156682,0.1503096198156682
before tensor 589824 mask 52666.0 589824
layer3.4.conv2.weight, mask/weight parameters,52666,52666 density 0.12427058926241326,0.12427058926241326
before tensor 262144 mask 36575.0 262144
layer3.4.conv3.weight, mask/weight parameters,36575,36575 density 0.16459803427419356,0.16459803427419356
before tensor 262144 mask 34580.0 262144
layer3.5.conv1.weight, mask/weight parameters,34580,34580 density 0.15561995967741934,0.15561995967741934
before tensor 589824 mask 50936.0 589824
layer3.5.conv2.weight, mask/weight parameters,50936,50936 density 0.12018848468974826,0.12018848468974826
before tensor 262144 mask 35021.0 262144
layer3.5.conv3.weight, mask/weight parameters,35021,35021 density 0.15760458669354838,0.15760458669354838
before tensor 524288 mask 100111.0 524288
layer4.0.conv1.weight, mask/weight parameters,100111,100111 density 0.2278896233974359,0.2278896233974359
before tensor 2359296 mask 193908.0 2359296
layer4.0.conv2.weight, mask/weight parameters,193908,193908 density 0.11706811706811707,0.11706811706811707
before tensor 1048576 mask 104102.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104102,104102 density 0.11848730696386946,0.11848730696386946
layer4.0.shortcut.0.weight, mask/weight parameters,149961,149961 density 0.07150697708129883,0.07150697708129883
before tensor 1048576 mask 108219.0 1048576
layer4.1.conv1.weight, mask/weight parameters,108219,108219 density 0.12317321350524475,0.12317321350524475
before tensor 2359296 mask 240890.0 2359296
layer4.1.conv2.weight, mask/weight parameters,240890,240890 density 0.1454325696749939,0.1454325696749939
before tensor 1048576 mask 117769.0 1048576
layer4.1.conv3.weight, mask/weight parameters,117769,117769 density 0.13404287769522144,0.13404287769522144
before tensor 1048576 mask 33917.0 1048576
layer4.2.conv1.weight, mask/weight parameters,33917,33917 density 0.038603811553030304,0.038603811553030304
before tensor 2359296 mask 41682.0 2359296
layer4.2.conv2.weight, mask/weight parameters,41682,41682 density 0.02516468250733985,0.02516468250733985
before tensor 1048576 mask 38065.0 1048576
layer4.2.conv3.weight, mask/weight parameters,38065,38065 density 0.04332500182109557,0.04332500182109557
classifier.weight, mask/weight parameters,106163,106163 density 0.5183740234375,0.5183740234375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.12508281721531925 0.12508281721531925 after dst
Death rate: 0.14815436622394432

dynamic sparse change grow
self.total_params*pruning_rate 3504151.81086845
self.total_nonzero 2365205.0
to grow 1138946.81086845
len(all_scores) 18909112 16488488
increse 1138946.0 before_mask 3504150.0 after_mask 3504150.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1503,1409 density 0.8697916666666666,0.8153935185185185
before tensor 4096 mask 1729.0 4096
layer1.0.conv1.weight, mask/weight parameters,1729,1500 density 0.4739583333333333,0.41118421052631576
before tensor 36864 mask 8526.0 36864
layer1.0.conv2.weight, mask/weight parameters,8526,7012 density 0.2915768954550118,0.23980028042816592
before tensor 16384 mask 6773.0 16384
layer1.0.conv3.weight, mask/weight parameters,6773,5894 density 0.4641584429824561,0.40391995614035087
layer1.0.shortcut.0.weight, mask/weight parameters,8464,7406 density 0.5166015625,0.4520263671875
before tensor 16384 mask 4252.0 16384
layer1.1.conv1.weight, mask/weight parameters,4252,3350 density 0.29139254385964913,0.22957785087719298
before tensor 36864 mask 6775.0 36864
layer1.1.conv2.weight, mask/weight parameters,6775,4911 density 0.23169522246161212,0.16794911254745049
before tensor 16384 mask 5103.0 16384
layer1.1.conv3.weight, mask/weight parameters,5103,4404 density 0.3497121710526316,0.30180921052631576
before tensor 16384 mask 3009.0 16384
layer1.2.conv1.weight, mask/weight parameters,3009,2494 density 0.20620888157894737,0.1709155701754386
before tensor 36864 mask 4078.0 36864
layer1.2.conv2.weight, mask/weight parameters,4078,3036 density 0.139461714715639,0.10382681850825895
before tensor 16384 mask 3580.0 16384
layer1.2.conv3.weight, mask/weight parameters,3580,2973 density 0.24533991228070176,0.20374177631578946
before tensor 32768 mask 7611.0 32768
layer2.0.conv1.weight, mask/weight parameters,7611,5532 density 0.2678420608108108,0.19467905405405406
before tensor 147456 mask 18827.0 147456
layer2.0.conv2.weight, mask/weight parameters,18827,14009 density 0.16978239500762024,0.12633354074795516
before tensor 65536 mask 13562.0 65536
layer2.0.conv3.weight, mask/weight parameters,13562,10979 density 0.23863316441441443,0.1931834177927928
layer2.0.shortcut.0.weight, mask/weight parameters,40369,31760 density 0.30799102783203125,0.2423095703125
before tensor 65536 mask 8847.0 65536
layer2.1.conv1.weight, mask/weight parameters,8847,7315 density 0.15566934121621623,0.12871269707207209
before tensor 147456 mask 17065.0 147456
layer2.1.conv2.weight, mask/weight parameters,17065,11371 density 0.15389263137010883,0.10254398542686831
before tensor 65536 mask 12618.0 65536
layer2.1.conv3.weight, mask/weight parameters,12618,9570 density 0.22202280405405406,0.16839104729729729
before tensor 65536 mask 13847.0 65536
layer2.2.conv1.weight, mask/weight parameters,13847,10799 density 0.24364794481981983,0.19001618806306306
before tensor 147456 mask 27964.0 147456
layer2.2.conv2.weight, mask/weight parameters,27964,20355 density 0.2521801080359639,0.18356194031869708
before tensor 65536 mask 16537.0 65536
layer2.2.conv3.weight, mask/weight parameters,16537,12353 density 0.29098043355855857,0.21735993806306306
before tensor 65536 mask 14229.0 65536
layer2.3.conv1.weight, mask/weight parameters,14229,10267 density 0.25036951013513514,0.18065526463963963
before tensor 147456 mask 28695.0 147456
layer2.3.conv2.weight, mask/weight parameters,28695,20793 density 0.25877228579931283,0.1875118361604848
before tensor 65536 mask 16110.0 65536
layer2.3.conv3.weight, mask/weight parameters,16110,11933 density 0.2834670608108108,0.20996973536036037
before tensor 131072 mask 38999.0 131072
layer3.0.conv1.weight, mask/weight parameters,38999,28213 density 0.35101346486175117,0.2539332517281106
before tensor 589824 mask 116145.0 589824
layer3.0.conv2.weight, mask/weight parameters,116145,79261 density 0.2740555119029922,0.18702409857456684
before tensor 262144 mask 81140.0 262144
layer3.0.conv3.weight, mask/weight parameters,81140,59652 density 0.3651533698156682,0.268451180875576
layer3.0.shortcut.0.weight, mask/weight parameters,117503,80727 density 0.2241191864013672,0.1539745330810547
before tensor 262144 mask 43835.0 262144
layer3.1.conv1.weight, mask/weight parameters,43835,30481 density 0.19727012528801843,0.13717327908986174
before tensor 589824 mask 105661.0 589824
layer3.1.conv2.weight, mask/weight parameters,105661,69590 density 0.2493174862730385,0.16420442613396383
before tensor 262144 mask 69307.0 262144
layer3.1.conv3.weight, mask/weight parameters,69307,51249 density 0.3119014616935484,0.23063526065668202
before tensor 262144 mask 46862.0 262144
layer3.2.conv1.weight, mask/weight parameters,46862,32701 density 0.21089249711981567,0.14716391849078342
before tensor 589824 mask 101495.0 589824
layer3.2.conv2.weight, mask/weight parameters,101495,67570 density 0.23948740092637819,0.1594380381358232
before tensor 262144 mask 67561.0 262144
layer3.2.conv3.weight, mask/weight parameters,67561,47805 density 0.30404395881336405,0.21513626872119815
before tensor 262144 mask 46423.0 262144
layer3.3.conv1.weight, mask/weight parameters,46423,29290 density 0.2089168706797235,0.13181343605990783
before tensor 589824 mask 85371.0 589824
layer3.3.conv2.weight, mask/weight parameters,85371,51043 density 0.20144124246993284,0.12044096167776858
before tensor 262144 mask 56286.0 262144
layer3.3.conv3.weight, mask/weight parameters,56286,38233 density 0.25330321140552997,0.17205951180875576
before tensor 262144 mask 50789.0 262144
layer3.4.conv1.weight, mask/weight parameters,50789,33400 density 0.22856512816820276,0.1503096198156682
before tensor 589824 mask 85460.0 589824
layer3.4.conv2.weight, mask/weight parameters,85460,52666 density 0.20165124669361328,0.12427058926241326
before tensor 262144 mask 53386.0 262144
layer3.4.conv3.weight, mask/weight parameters,53386,36575 density 0.24025237615207373,0.16459803427419356
before tensor 262144 mask 51448.0 262144
layer3.5.conv1.weight, mask/weight parameters,51448,34580 density 0.23153081797235023,0.15561995967741934
before tensor 589824 mask 79830.0 589824
layer3.5.conv2.weight, mask/weight parameters,79830,50936 density 0.1883667098473104,0.12018848468974826
before tensor 262144 mask 51531.0 262144
layer3.5.conv3.weight, mask/weight parameters,51531,35021 density 0.23190434187788017,0.15760458669354838
before tensor 524288 mask 143264.0 524288
layer4.0.conv1.weight, mask/weight parameters,143264,100111 density 0.3261217948717949,0.2278896233974359
before tensor 2359296 mask 312611.0 2359296
layer4.0.conv2.weight, mask/weight parameters,312611,193908 density 0.18873270388421903,0.11706811706811707
before tensor 1048576 mask 155513.0 1048576
layer4.0.conv3.weight, mask/weight parameters,155513,104102 density 0.17700252221736595,0.11848730696386946
layer4.0.shortcut.0.weight, mask/weight parameters,225330,149961 density 0.10744571685791016,0.07150697708129883
before tensor 1048576 mask 153004.0 1048576
layer4.1.conv1.weight, mask/weight parameters,153004,108219 density 0.17414681672494173,0.12317321350524475
before tensor 2359296 mask 363069.0 2359296
layer4.1.conv2.weight, mask/weight parameters,363069,240890 density 0.2191957226922262,0.1454325696749939
before tensor 1048576 mask 168953.0 1048576
layer4.1.conv3.weight, mask/weight parameters,168953,117769 density 0.19229972501456877,0.13404287769522144
before tensor 1048576 mask 56074.0 1048576
layer4.2.conv1.weight, mask/weight parameters,56074,33917 density 0.06382257065850816,0.038603811553030304
before tensor 2359296 mask 101848.0 2359296
layer4.2.conv2.weight, mask/weight parameters,101848,41682 density 0.06148871416936685,0.02516468250733985
before tensor 1048576 mask 65699.0 1048576
layer4.2.conv3.weight, mask/weight parameters,65699,38065 density 0.07477759870337995,0.04332500182109557
classifier.weight, mask/weight parameters,119680,106163 density 0.584375,0.5183740234375
Total Model parameters after dst: 3504150 2365205
Total parameters under density level of 0.1: 0.18531541830203344 0.12508281721531925 after dst
Death rate: 0.14815436622394432


Training summary: Average loss: 1.5971, Accuracy: 27523/50000 (55.046%)


Evaluation: Average loss: 1.8373, Accuracy: 5036/10000 (50.360%)

Current learning rate: 0.1. Time taken for epoch: 88.85 seconds.

Train Epoch: 16 [0/50000 (0%)]	Loss: 1.426879 Accuracy: 61/100 (61.000%
Train Epoch: 16 [10000/50000 (20%)]	Loss: 1.699191 Accuracy: 5731/10100 (56.743%
Train Epoch: 16 [20000/50000 (40%)]	Loss: 1.781859 Accuracy: 11243/20100 (55.935%
Train Epoch: 16 [30000/50000 (60%)]	Loss: 1.637423 Accuracy: 16766/30100 (55.701%
Train Epoch: 16 [40000/50000 (80%)]	Loss: 1.730043 Accuracy: 22318/40100 (55.656%
current layer rate 0.17162107419208006
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6408.0
Total filter_masks items: 15933688.0
6408.0 / 7552 channels
Total channels to prune: 152.08235229858838
Layer ('layer1', 0, 'conv1'): Pruned 1/57.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/57.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/57.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/57.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/57.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/57.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/111.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/111.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 5/217.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 5/217.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 10/429.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 10/429.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 10/429.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 10/429.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 10/429.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 10/429.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6266.0
Total filter_masks items: 15389463.0
After apply_mask:
Total filter_names items: 6266.0
Total filter_masks items: 15389463.0
Total pruned: 142/152.08235229858838 channels
===========done ===============

Training summary: Average loss: 1.5745, Accuracy: 27834/50000 (55.668%)


Evaluation: Average loss: 1.9909, Accuracy: 4653/10000 (46.530%)

Current learning rate: 0.1. Time taken for epoch: 88.67 seconds.

Train Epoch: 17 [0/50000 (0%)]	Loss: 1.637112 Accuracy: 52/100 (52.000%
Train Epoch: 17 [10000/50000 (20%)]	Loss: 1.528628 Accuracy: 5749/10100 (56.921%
Train Epoch: 17 [20000/50000 (40%)]	Loss: 1.768647 Accuracy: 11335/20100 (56.393%
Train Epoch: 17 [30000/50000 (60%)]	Loss: 1.627827 Accuracy: 16992/30100 (56.452%
Train Epoch: 17 [40000/50000 (80%)]	Loss: 1.670037 Accuracy: 22540/40100 (56.209%
current mest  death_rate 0.14767185902126345


dynamic sparse change prune
to kill 988880.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1337,1337 density 0.7737268518518519,0.7737268518518519
before tensor 4096 mask 1322.0 4096
layer1.0.conv1.weight, mask/weight parameters,1322,1322 density 0.36886160714285715,0.36886160714285715
before tensor 36864 mask 6374.0 36864
layer1.0.conv2.weight, mask/weight parameters,6374,6374 density 0.2258361678004535,0.2258361678004535
before tensor 16384 mask 5386.0 16384
layer1.0.conv3.weight, mask/weight parameters,5386,5386 density 0.37569754464285715,0.37569754464285715
layer1.0.shortcut.0.weight, mask/weight parameters,7074,7074 density 0.4317626953125,0.4317626953125
before tensor 16384 mask 3033.0 16384
layer1.1.conv1.weight, mask/weight parameters,3033,3033 density 0.21156529017857142,0.21156529017857142
before tensor 36864 mask 4698.0 36864
layer1.1.conv2.weight, mask/weight parameters,4698,4698 density 0.16645408163265307,0.16645408163265307
before tensor 16384 mask 3821.0 16384
layer1.1.conv3.weight, mask/weight parameters,3821,3821 density 0.2665318080357143,0.2665318080357143
before tensor 16384 mask 2096.0 16384
layer1.2.conv1.weight, mask/weight parameters,2096,2096 density 0.14620535714285715,0.14620535714285715
before tensor 36864 mask 2650.0 36864
layer1.2.conv2.weight, mask/weight parameters,2650,2650 density 0.09389172335600907,0.09389172335600907
before tensor 16384 mask 2441.0 16384
layer1.2.conv3.weight, mask/weight parameters,2441,2441 density 0.17027064732142858,0.17027064732142858
before tensor 32768 mask 5226.0 32768
layer2.0.conv1.weight, mask/weight parameters,5226,5226 density 0.18728497706422018,0.18728497706422018
before tensor 147456 mask 13687.0 147456
layer2.0.conv2.weight, mask/weight parameters,13687,13687 density 0.1280008229759934,0.1280008229759934
before tensor 65536 mask 10185.0 65536
layer2.0.conv3.weight, mask/weight parameters,10185,10185 density 0.18250071674311927,0.18250071674311927
layer2.0.shortcut.0.weight, mask/weight parameters,30553,30553 density 0.23310089111328125,0.23310089111328125
before tensor 65536 mask 6462.0 65536
layer2.1.conv1.weight, mask/weight parameters,6462,6462 density 0.11578985091743119,0.11578985091743119
before tensor 147456 mask 10824.0 147456
layer2.1.conv2.weight, mask/weight parameters,10824,10824 density 0.10122604719019163,0.10122604719019163
before tensor 65536 mask 8518.0 65536
layer2.1.conv3.weight, mask/weight parameters,8518,8518 density 0.1526304472477064,0.1526304472477064
before tensor 65536 mask 10226.0 65536
layer2.2.conv1.weight, mask/weight parameters,10226,10226 density 0.18323537844036697,0.18323537844036697
before tensor 147456 mask 19728.0 147456
layer2.2.conv2.weight, mask/weight parameters,19728,19728 density 0.18449625452402996,0.18449625452402996
before tensor 65536 mask 11858.0 65536
layer2.2.conv3.weight, mask/weight parameters,11858,11858 density 0.21247849770642202,0.21247849770642202
before tensor 65536 mask 10082.0 65536
layer2.3.conv1.weight, mask/weight parameters,10082,10082 density 0.18065510321100917,0.18065510321100917
before tensor 147456 mask 20734.0 147456
layer2.3.conv2.weight, mask/weight parameters,20734,20734 density 0.19390436644876508,0.19390436644876508
before tensor 65536 mask 11664.0 65536
layer2.3.conv3.weight, mask/weight parameters,11664,11664 density 0.20900229357798164,0.20900229357798164
before tensor 131072 mask 28439.0 131072
layer3.0.conv1.weight, mask/weight parameters,28439,28439 density 0.2620043484669811,0.2620043484669811
before tensor 589824 mask 79582.0 589824
layer3.0.conv2.weight, mask/weight parameters,79582,79582 density 0.19674360191448123,0.19674360191448123
before tensor 262144 mask 59996.0 262144
layer3.0.conv3.weight, mask/weight parameters,59996,59996 density 0.2763671875,0.2763671875
layer3.0.shortcut.0.weight, mask/weight parameters,82515,82515 density 0.15738487243652344,0.15738487243652344
before tensor 262144 mask 30394.0 262144
layer3.1.conv1.weight, mask/weight parameters,30394,30394 density 0.14000773879716982,0.14000773879716982
before tensor 589824 mask 69144.0 589824
layer3.1.conv2.weight, mask/weight parameters,69144,69144 density 0.17093864957873503,0.17093864957873503
before tensor 262144 mask 49997.0 262144
layer3.1.conv3.weight, mask/weight parameters,49997,49997 density 0.23030752505896226,0.23030752505896226
before tensor 262144 mask 31867.0 262144
layer3.2.conv1.weight, mask/weight parameters,31867,31867 density 0.1467930056014151,0.1467930056014151
before tensor 589824 mask 65605.0 589824
layer3.2.conv2.weight, mask/weight parameters,65605,65605 density 0.16218949013092837,0.16218949013092837
before tensor 262144 mask 47582.0 262144
layer3.2.conv3.weight, mask/weight parameters,47582,47582 density 0.2191830041273585,0.2191830041273585
before tensor 262144 mask 30502.0 262144
layer3.3.conv1.weight, mask/weight parameters,30502,30502 density 0.14050523290094338,0.14050523290094338
before tensor 589824 mask 52418.0 589824
layer3.3.conv2.weight, mask/weight parameters,52418,52418 density 0.1295884260907401,0.1295884260907401
before tensor 262144 mask 38608.0 262144
layer3.3.conv3.weight, mask/weight parameters,38608,38608 density 0.17784492924528303,0.17784492924528303
before tensor 262144 mask 34078.0 262144
layer3.4.conv1.weight, mask/weight parameters,34078,34078 density 0.1569778154481132,0.1569778154481132
before tensor 589824 mask 54026.0 589824
layer3.4.conv2.weight, mask/weight parameters,54026,54026 density 0.13356374352280367,0.13356374352280367
before tensor 262144 mask 36749.0 262144
layer3.4.conv3.weight, mask/weight parameters,36749,36749 density 0.16928158166273585,0.16928158166273585
before tensor 262144 mask 35491.0 262144
layer3.5.conv1.weight, mask/weight parameters,35491,35491 density 0.16348669663915094,0.16348669663915094
before tensor 589824 mask 52318.0 589824
layer3.5.conv2.weight, mask/weight parameters,52318,52318 density 0.1293412048574028,0.1293412048574028
before tensor 262144 mask 35405.0 262144
layer3.5.conv3.weight, mask/weight parameters,35405,35405 density 0.1630905439268868,0.1630905439268868
before tensor 524288 mask 103820.0 524288
layer4.0.conv1.weight, mask/weight parameters,103820,103820 density 0.24197307577565633,0.24197307577565633
before tensor 2359296 mask 201056.0 2359296
layer4.0.conv2.weight, mask/weight parameters,201056,201056 density 0.1272466866533886,0.1272466866533886
before tensor 1048576 mask 104778.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104778,104778 density 0.12210294227326969,0.12210294227326969
layer4.0.shortcut.0.weight, mask/weight parameters,147138,147138 density 0.0701608657836914,0.0701608657836914
before tensor 1048576 mask 108483.0 1048576
layer4.1.conv1.weight, mask/weight parameters,108483,108483 density 0.12642056048627684,0.12642056048627684
before tensor 2359296 mask 242223.0 2359296
layer4.1.conv2.weight, mask/weight parameters,242223,242223 density 0.1533009419328135,0.1533009419328135
before tensor 1048576 mask 115081.0 1048576
layer4.1.conv3.weight, mask/weight parameters,115081,115081 density 0.13410953348747018,0.13410953348747018
before tensor 1048576 mask 33545.0 1048576
layer4.2.conv1.weight, mask/weight parameters,33545,33545 density 0.039091633726133654,0.039091633726133654
before tensor 2359296 mask 42165.0 2359296
layer4.2.conv2.weight, mask/weight parameters,42165,42165 density 0.02668588126064445,0.02668588126064445
before tensor 1048576 mask 36897.0 1048576
layer4.2.conv3.weight, mask/weight parameters,36897,36897 density 0.042997883726133654,0.042997883726133654
classifier.weight, mask/weight parameters,105324,105324 density 0.51427734375,0.51427734375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.12878952100277014 0.12878952100277014 after dst
Death rate: 0.14767185902126345

dynamic sparse change grow
self.total_params*pruning_rate 3492739.535070412
self.total_nonzero 2365205.0
to grow 1127534.5350704119
len(all_scores) 18364887 15932326
increse 1127534.0 before_mask 3492738.0 after_mask 3492738.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1488,1337 density 0.8611111111111112,0.7737268518518519
before tensor 4096 mask 1682.0 4096
layer1.0.conv1.weight, mask/weight parameters,1682,1322 density 0.4693080357142857,0.36886160714285715
before tensor 36864 mask 8763.0 36864
layer1.0.conv2.weight, mask/weight parameters,8763,6374 density 0.31048044217687076,0.2258361678004535
before tensor 16384 mask 6624.0 16384
layer1.0.conv3.weight, mask/weight parameters,6624,5386 density 0.46205357142857145,0.37569754464285715
layer1.0.shortcut.0.weight, mask/weight parameters,8572,7074 density 0.523193359375,0.4317626953125
before tensor 16384 mask 4051.0 16384
layer1.1.conv1.weight, mask/weight parameters,4051,3033 density 0.28257533482142855,0.21156529017857142
before tensor 36864 mask 5871.0 36864
layer1.1.conv2.weight, mask/weight parameters,5871,4698 density 0.20801445578231292,0.16645408163265307
before tensor 16384 mask 4535.0 16384
layer1.1.conv3.weight, mask/weight parameters,4535,3821 density 0.3163364955357143,0.2665318080357143
before tensor 16384 mask 2893.0 16384
layer1.2.conv1.weight, mask/weight parameters,2893,2096 density 0.20179966517857142,0.14620535714285715
before tensor 36864 mask 3560.0 36864
layer1.2.conv2.weight, mask/weight parameters,3560,2650 density 0.12613378684807255,0.09389172335600907
before tensor 16384 mask 3103.0 16384
layer1.2.conv3.weight, mask/weight parameters,3103,2441 density 0.21644810267857142,0.17027064732142858
before tensor 32768 mask 7035.0 32768
layer2.0.conv1.weight, mask/weight parameters,7035,5226 density 0.25211439220183485,0.18728497706422018
before tensor 147456 mask 17051.0 147456
layer2.0.conv2.weight, mask/weight parameters,17051,13687 density 0.1594609507243124,0.1280008229759934
before tensor 65536 mask 12654.0 65536
layer2.0.conv3.weight, mask/weight parameters,12654,10185 density 0.22674168577981652,0.18250071674311927
layer2.0.shortcut.0.weight, mask/weight parameters,40267,30553 density 0.30721282958984375,0.23310089111328125
before tensor 65536 mask 9215.0 65536
layer2.1.conv1.weight, mask/weight parameters,9215,6462 density 0.16511969610091742,0.11578985091743119
before tensor 147456 mask 16557.0 147456
layer2.1.conv2.weight, mask/weight parameters,16557,10824 density 0.1548410627612715,0.10122604719019163
before tensor 65536 mask 12663.0 65536
layer2.1.conv3.weight, mask/weight parameters,12663,8518 density 0.22690295298165136,0.1526304472477064
before tensor 65536 mask 15042.0 65536
layer2.2.conv1.weight, mask/weight parameters,15042,10226 density 0.26953125,0.18323537844036697
before tensor 147456 mask 30329.0 147456
layer2.2.conv2.weight, mask/weight parameters,30329,19728 density 0.28363680573090555,0.18449625452402996
before tensor 65536 mask 17494.0 65536
layer2.2.conv3.weight, mask/weight parameters,17494,11858 density 0.3134676032110092,0.21247849770642202
before tensor 65536 mask 13775.0 65536
layer2.3.conv1.weight, mask/weight parameters,13775,10082 density 0.2468284116972477,0.18065510321100917
before tensor 147456 mask 26746.0 147456
layer2.3.conv2.weight, mask/weight parameters,26746,20734 density 0.2501285899989713,0.19390436644876508
before tensor 65536 mask 15203.0 65536
layer2.3.conv3.weight, mask/weight parameters,15203,11664 density 0.27241614105504586,0.20900229357798164
before tensor 131072 mask 39922.0 131072
layer3.0.conv1.weight, mask/weight parameters,39922,28439 density 0.3677955483490566,0.2620043484669811
before tensor 589824 mask 114895.0 589824
layer3.0.conv2.weight, mask/weight parameters,114895,79582 density 0.28404483604287806,0.19674360191448123
before tensor 262144 mask 81819.0 262144
layer3.0.conv3.weight, mask/weight parameters,81819,59996 density 0.3768932414504717,0.2763671875
layer3.0.shortcut.0.weight, mask/weight parameters,118109,82515 density 0.22527503967285156,0.15738487243652344
before tensor 262144 mask 43869.0 262144
layer3.1.conv1.weight, mask/weight parameters,43869,30394 density 0.20207934109669812,0.14000773879716982
before tensor 589824 mask 105687.0 589824
layer3.1.conv2.weight, mask/weight parameters,105687,69144 density 0.26128070487718047,0.17093864957873503
before tensor 262144 mask 69198.0 262144
layer3.1.conv3.weight, mask/weight parameters,69198,49997 density 0.3187555277122642,0.23030752505896226
before tensor 262144 mask 43132.0 262144
layer3.2.conv1.weight, mask/weight parameters,43132,31867 density 0.1986844044811321,0.1467930056014151
before tensor 589824 mask 95432.0 589824
layer3.2.conv2.weight, mask/weight parameters,95432,65605 density 0.23592816739844152,0.16218949013092837
before tensor 262144 mask 66226.0 262144
layer3.2.conv3.weight, mask/weight parameters,66226,47582 density 0.305065227004717,0.2191830041273585
before tensor 262144 mask 46519.0 262144
layer3.3.conv1.weight, mask/weight parameters,46519,30502 density 0.21428637234669812,0.14050523290094338
before tensor 589824 mask 82887.0 589824
layer3.3.conv2.weight, mask/weight parameters,82887,52418 density 0.20491426367627863,0.1295884260907401
before tensor 262144 mask 55151.0 262144
layer3.3.conv3.weight, mask/weight parameters,55151,38608 density 0.2540490492334906,0.17784492924528303
before tensor 262144 mask 47195.0 262144
layer3.4.conv1.weight, mask/weight parameters,47195,34078 density 0.21740031692216982,0.1569778154481132
before tensor 589824 mask 80376.0 589824
layer3.4.conv2.weight, mask/weight parameters,80376,54026 density 0.19870653850717931,0.13356374352280367
before tensor 262144 mask 53539.0 262144
layer3.4.conv3.weight, mask/weight parameters,53539,36749 density 0.24662348909198112,0.16928158166273585
before tensor 262144 mask 53161.0 262144
layer3.5.conv1.weight, mask/weight parameters,53161,35491 density 0.2448822597287736,0.16348669663915094
before tensor 589824 mask 78284.0 589824
layer3.5.conv2.weight, mask/weight parameters,78284,52318 density 0.1935346703057632,0.1293412048574028
before tensor 262144 mask 50965.0 262144
layer3.5.conv3.weight, mask/weight parameters,50965,35405 density 0.23476654628537735,0.1630905439268868
before tensor 524288 mask 148872.0 524288
layer4.0.conv1.weight, mask/weight parameters,148872,103820 density 0.3469756861575179,0.24197307577565633
before tensor 2359296 mask 336868.0 2359296
layer4.0.conv2.weight, mask/weight parameters,336868,201056 density 0.21320098300748902,0.1272466866533886
before tensor 1048576 mask 162550.0 1048576
layer4.0.conv3.weight, mask/weight parameters,162550,104778 density 0.1894274873210024,0.12210294227326969
layer4.0.shortcut.0.weight, mask/weight parameters,228742,147138 density 0.10907268524169922,0.0701608657836914
before tensor 1048576 mask 151505.0 1048576
layer4.1.conv1.weight, mask/weight parameters,151505,108483 density 0.17655620711515513,0.12642056048627684
before tensor 2359296 mask 359780.0 2359296
layer4.1.conv2.weight, mask/weight parameters,359780,242223 density 0.22770179912141966,0.1533009419328135
before tensor 1048576 mask 169615.0 1048576
layer4.1.conv3.weight, mask/weight parameters,169615,115081 density 0.19766067832637232,0.13410953348747018
before tensor 1048576 mask 56511.0 1048576
layer4.2.conv1.weight, mask/weight parameters,56511,33545 density 0.06585503990155131,0.039091633726133654
before tensor 2359296 mask 85984.0 2359296
layer4.2.conv2.weight, mask/weight parameters,85984,42165 density 0.054418565500183855,0.02668588126064445
before tensor 1048576 mask 61887.0 1048576
layer4.2.conv3.weight, mask/weight parameters,61887,36897 density 0.07211995636933174,0.042997883726133654
classifier.weight, mask/weight parameters,118885,105324 density 0.5804931640625,0.51427734375
Total Model parameters after dst: 3492738 2365205
Total parameters under density level of 0.1: 0.190185651564314 0.12878952100277014 after dst
Death rate: 0.14767185902126345


Training summary: Average loss: 1.5513, Accuracy: 28066/50000 (56.132%)


Evaluation: Average loss: 1.8747, Accuracy: 5016/10000 (50.160%)

Current learning rate: 0.1. Time taken for epoch: 88.87 seconds.

Train Epoch: 18 [0/50000 (0%)]	Loss: 1.451702 Accuracy: 57/100 (57.000%
Train Epoch: 18 [10000/50000 (20%)]	Loss: 1.217772 Accuracy: 5795/10100 (57.376%
Train Epoch: 18 [20000/50000 (40%)]	Loss: 1.572244 Accuracy: 11401/20100 (56.721%
Train Epoch: 18 [30000/50000 (60%)]	Loss: 1.624154 Accuracy: 17062/30100 (56.684%
Train Epoch: 18 [40000/50000 (80%)]	Loss: 1.724872 Accuracy: 22796/40100 (56.848%
current layer rate 0.18875034137460178
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6266.0
Total filter_masks items: 15389463.0
6266.0 / 7552 channels
Total channels to prune: 139.44257806099267
Layer ('layer1', 0, 'conv1'): Pruned 1/56.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/56.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/56.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/56.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/56.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/56.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/109.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/109.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/212.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/212.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 9/419.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 9/419.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 9/419.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 9/419.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 9/419.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 9/419.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6142.0
Total filter_masks items: 14921243.0
After apply_mask:
Total filter_names items: 6142.0
Total filter_masks items: 14921243.0
Total pruned: 124/139.44257806099267 channels
===========done ===============

Training summary: Average loss: 1.5355, Accuracy: 28434/50000 (56.868%)


Evaluation: Average loss: 1.8121, Accuracy: 4971/10000 (49.710%)

Current learning rate: 0.1. Time taken for epoch: 88.64 seconds.

Train Epoch: 19 [0/50000 (0%)]	Loss: 1.337724 Accuracy: 59/100 (59.000%
Train Epoch: 19 [10000/50000 (20%)]	Loss: 1.536899 Accuracy: 5848/10100 (57.901%
Train Epoch: 19 [20000/50000 (40%)]	Loss: 1.596382 Accuracy: 11656/20100 (57.990%
Train Epoch: 19 [30000/50000 (60%)]	Loss: 1.655302 Accuracy: 17346/30100 (57.628%
Train Epoch: 19 [40000/50000 (80%)]	Loss: 1.385675 Accuracy: 23119/40100 (57.653%
current mest  death_rate 0.14713640064133


dynamic sparse change prune
to kill 996283.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1352,1352 density 0.7824074074074074,0.7824074074074074
before tensor 4096 mask 1328.0 4096
layer1.0.conv1.weight, mask/weight parameters,1328,1328 density 0.37727272727272726,0.37727272727272726
before tensor 36864 mask 6593.0 36864
layer1.0.conv2.weight, mask/weight parameters,6593,6593 density 0.24216712580348945,0.24216712580348945
before tensor 16384 mask 5142.0 16384
layer1.0.conv3.weight, mask/weight parameters,5142,5142 density 0.3651988636363636,0.3651988636363636
layer1.0.shortcut.0.weight, mask/weight parameters,7037,7037 density 0.42950439453125,0.42950439453125
before tensor 16384 mask 2826.0 16384
layer1.1.conv1.weight, mask/weight parameters,2826,2826 density 0.20071022727272728,0.20071022727272728
before tensor 36864 mask 4252.0 36864
layer1.1.conv2.weight, mask/weight parameters,4252,4252 density 0.1561799816345271,0.1561799816345271
before tensor 16384 mask 3474.0 16384
layer1.1.conv3.weight, mask/weight parameters,3474,3474 density 0.24673295454545455,0.24673295454545455
before tensor 16384 mask 1992.0 16384
layer1.2.conv1.weight, mask/weight parameters,1992,1992 density 0.14147727272727273,0.14147727272727273
before tensor 36864 mask 2452.0 36864
layer1.2.conv2.weight, mask/weight parameters,2452,2452 density 0.09006427915518825,0.09006427915518825
before tensor 16384 mask 2203.0 16384
layer1.2.conv3.weight, mask/weight parameters,2203,2203 density 0.15646306818181818,0.15646306818181818
before tensor 32768 mask 4950.0 32768
layer2.0.conv1.weight, mask/weight parameters,4950,4950 density 0.18070969626168223,0.18070969626168223
before tensor 147456 mask 12797.0 147456
layer2.0.conv2.weight, mask/weight parameters,12797,12797 density 0.1241932822856921,0.1241932822856921
before tensor 65536 mask 9691.0 65536
layer2.0.conv3.weight, mask/weight parameters,9691,9691 density 0.17689471378504673,0.17689471378504673
layer2.0.shortcut.0.weight, mask/weight parameters,30032,30032 density 0.2291259765625,0.2291259765625
before tensor 65536 mask 6380.0 65536
layer2.1.conv1.weight, mask/weight parameters,6380,6380 density 0.11645735981308411,0.11645735981308411
before tensor 147456 mask 10026.0 147456
layer2.1.conv2.weight, mask/weight parameters,10026,10026 density 0.09730107432963578,0.09730107432963578
before tensor 65536 mask 8173.0 65536
layer2.1.conv3.weight, mask/weight parameters,8173,8173 density 0.14918589369158877,0.14918589369158877
before tensor 65536 mask 10557.0 65536
layer2.2.conv1.weight, mask/weight parameters,10557,10557 density 0.1927022488317757,0.1927022488317757
before tensor 147456 mask 21073.0 147456
layer2.2.conv2.weight, mask/weight parameters,21073,21073 density 0.2045108257877932,0.2045108257877932
before tensor 65536 mask 12295.0 65536
layer2.2.conv3.weight, mask/weight parameters,12295,12295 density 0.22442683995327103,0.22442683995327103
before tensor 65536 mask 9744.0 65536
layer2.3.conv1.weight, mask/weight parameters,9744,9744 density 0.1778621495327103,0.1778621495327103
before tensor 147456 mask 19717.0 147456
layer2.3.conv2.weight, mask/weight parameters,19717,19717 density 0.19135101561514348,0.19135101561514348
before tensor 65536 mask 11070.0 65536
layer2.3.conv3.weight, mask/weight parameters,11070,11070 density 0.20206629672897197,0.20206629672897197
before tensor 131072 mask 28608.0 131072
layer3.0.conv1.weight, mask/weight parameters,28608,28608 density 0.2686298076923077,0.2686298076923077
before tensor 589824 mask 79788.0 589824
layer3.0.conv2.weight, mask/weight parameters,79788,79788 density 0.20491247534516766,0.20491247534516766
before tensor 262144 mask 60522.0 262144
layer3.0.conv3.weight, mask/weight parameters,60522,60522 density 0.28415151742788464,0.28415151742788464
layer3.0.shortcut.0.weight, mask/weight parameters,82999,82999 density 0.1583080291748047,0.1583080291748047
before tensor 262144 mask 30448.0 262144
layer3.1.conv1.weight, mask/weight parameters,30448,30448 density 0.14295372596153846,0.14295372596153846
before tensor 589824 mask 69565.0 589824
layer3.1.conv2.weight, mask/weight parameters,69565,69565 density 0.17865764710716633,0.17865764710716633
before tensor 262144 mask 49899.0 262144
layer3.1.conv3.weight, mask/weight parameters,49899,49899 density 0.23427640474759615,0.23427640474759615
before tensor 262144 mask 30592.0 262144
layer3.2.conv1.weight, mask/weight parameters,30592,30592 density 0.14362980769230768,0.14362980769230768
before tensor 589824 mask 64689.0 589824
layer3.2.conv2.weight, mask/weight parameters,64689,64689 density 0.16613504684418146,0.16613504684418146
before tensor 262144 mask 46967.0 262144
layer3.2.conv3.weight, mask/weight parameters,46967,46967 density 0.22051062950721154,0.22051062950721154
before tensor 262144 mask 31003.0 262144
layer3.3.conv1.weight, mask/weight parameters,31003,31003 density 0.14555945763221154,0.14555945763221154
before tensor 589824 mask 53297.0 589824
layer3.3.conv2.weight, mask/weight parameters,53297,53297 density 0.13687797912557528,0.13687797912557528
before tensor 262144 mask 38174.0 262144
layer3.3.conv3.weight, mask/weight parameters,38174,38174 density 0.1792273888221154,0.1792273888221154
before tensor 262144 mask 32360.0 262144
layer3.4.conv1.weight, mask/weight parameters,32360,32360 density 0.15193058894230768,0.15193058894230768
before tensor 589824 mask 52140.0 589824
layer3.4.conv2.weight, mask/weight parameters,52140,52140 density 0.13390655818540434,0.13390655818540434
before tensor 262144 mask 36371.0 262144
layer3.4.conv3.weight, mask/weight parameters,36371,36371 density 0.17076228215144232,0.17076228215144232
before tensor 262144 mask 36823.0 262144
layer3.5.conv1.weight, mask/weight parameters,36823,36823 density 0.1728844275841346,0.1728844275841346
before tensor 589824 mask 52778.0 589824
layer3.5.conv2.weight, mask/weight parameters,52778,52778 density 0.13554507725180803,0.13554507725180803
before tensor 262144 mask 35198.0 262144
layer3.5.conv3.weight, mask/weight parameters,35198,35198 density 0.1652550330528846,0.1652550330528846
before tensor 524288 mask 108037.0 524288
layer4.0.conv1.weight, mask/weight parameters,108037,108037 density 0.2573289824695122,0.2573289824695122
before tensor 2359296 mask 211159.0 2359296
layer4.0.conv2.weight, mask/weight parameters,211159,211159 density 0.13957234450393285,0.13957234450393285
before tensor 1048576 mask 107442.0 1048576
layer4.0.conv3.weight, mask/weight parameters,107442,107442 density 0.12795588795731708,0.12795588795731708
layer4.0.shortcut.0.weight, mask/weight parameters,146403,146403 density 0.06981039047241211,0.06981039047241211
before tensor 1048576 mask 107762.0 1048576
layer4.1.conv1.weight, mask/weight parameters,107762,107762 density 0.12833698551829267,0.12833698551829267
before tensor 2359296 mask 240288.0 2359296
layer4.1.conv2.weight, mask/weight parameters,240288,240288 density 0.15882609557802896,0.15882609557802896
before tensor 1048576 mask 113003.0 1048576
layer4.1.conv3.weight, mask/weight parameters,113003,113003 density 0.13457864900914634,0.13457864900914634
before tensor 1048576 mask 33757.0 1048576
layer4.2.conv1.weight, mask/weight parameters,33757,33757 density 0.04020221989329268,0.04020221989329268
before tensor 2359296 mask 40459.0 2359296
layer4.2.conv2.weight, mask/weight parameters,40459,40459 density 0.02674267962191817,0.02674267962191817
before tensor 1048576 mask 34923.0 1048576
layer4.2.conv3.weight, mask/weight parameters,34923,34923 density 0.04159084413109756,0.04159084413109756
classifier.weight, mask/weight parameters,104595,104595 density 0.5107177734375,0.5107177734375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.13215896568897437 0.13215896568897437 after dst
Death rate: 0.14713640064133

dynamic sparse change grow
self.total_params*pruning_rate 3480074.8563335575
self.total_nonzero 2365205.0
to grow 1114869.8563335575
len(all_scores) 17896667 15442617
increse 1114870.0 before_mask 3480073.0 after_mask 3480073.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1459,1352 density 0.8443287037037037,0.7824074074074074
before tensor 4096 mask 1420.0 4096
layer1.0.conv1.weight, mask/weight parameters,1420,1328 density 0.4034090909090909,0.37727272727272726
before tensor 36864 mask 7758.0 36864
layer1.0.conv2.weight, mask/weight parameters,7758,6593 density 0.2849586776859504,0.24216712580348945
before tensor 16384 mask 6211.0 16384
layer1.0.conv3.weight, mask/weight parameters,6211,5142 density 0.44112215909090907,0.3651988636363636
layer1.0.shortcut.0.weight, mask/weight parameters,7903,7037 density 0.48236083984375,0.42950439453125
before tensor 16384 mask 3687.0 16384
layer1.1.conv1.weight, mask/weight parameters,3687,2826 density 0.26186079545454544,0.20071022727272728
before tensor 36864 mask 5582.0 36864
layer1.1.conv2.weight, mask/weight parameters,5582,4252 density 0.2050321395775941,0.1561799816345271
before tensor 16384 mask 4339.0 16384
layer1.1.conv3.weight, mask/weight parameters,4339,3474 density 0.30816761363636364,0.24673295454545455
before tensor 16384 mask 2522.0 16384
layer1.2.conv1.weight, mask/weight parameters,2522,1992 density 0.17911931818181817,0.14147727272727273
before tensor 36864 mask 3612.0 36864
layer1.2.conv2.weight, mask/weight parameters,3612,2452 density 0.13267217630853995,0.09006427915518825
before tensor 16384 mask 2949.0 16384
layer1.2.conv3.weight, mask/weight parameters,2949,2203 density 0.20944602272727272,0.15646306818181818
before tensor 32768 mask 8484.0 32768
layer2.0.conv1.weight, mask/weight parameters,8484,4950 density 0.3097254672897196,0.18070969626168223
before tensor 147456 mask 19661.0 147456
layer2.0.conv2.weight, mask/weight parameters,19661,12797 density 0.19080754262866237,0.1241932822856921
before tensor 65536 mask 12717.0 65536
layer2.0.conv3.weight, mask/weight parameters,12717,9691 density 0.23212981892523366,0.17689471378504673
layer2.0.shortcut.0.weight, mask/weight parameters,41331,30032 density 0.31533050537109375,0.2291259765625
before tensor 65536 mask 8607.0 65536
layer2.1.conv1.weight, mask/weight parameters,8607,6380 density 0.15710791471962618,0.11645735981308411
before tensor 147456 mask 18222.0 147456
layer2.1.conv2.weight, mask/weight parameters,18222,10026 density 0.17684222785104958,0.09730107432963578
before tensor 65536 mask 12100.0 65536
layer2.1.conv3.weight, mask/weight parameters,12100,8173 density 0.22086740654205608,0.14918589369158877
before tensor 65536 mask 14065.0 65536
layer2.2.conv1.weight, mask/weight parameters,14065,10557 density 0.2567355432242991,0.1927022488317757
before tensor 147456 mask 29657.0 147456
layer2.2.conv2.weight, mask/weight parameters,29657,21073 density 0.2878174707155404,0.2045108257877932
before tensor 65536 mask 17516.0 65536
layer2.2.conv3.weight, mask/weight parameters,17516,12295 density 0.3197283878504673,0.22442683995327103
before tensor 65536 mask 13996.0 65536
layer2.3.conv1.weight, mask/weight parameters,13996,9744 density 0.2554760514018692,0.1778621495327103
before tensor 147456 mask 29155.0 147456
layer2.3.conv2.weight, mask/weight parameters,29155,19717 density 0.2829456235867276,0.19135101561514348
before tensor 65536 mask 15645.0 65536
layer2.3.conv3.weight, mask/weight parameters,15645,11070 density 0.28557608060747663,0.20206629672897197
before tensor 131072 mask 40671.0 131072
layer3.0.conv1.weight, mask/weight parameters,40671,28608 density 0.3819016676682692,0.2686298076923077
before tensor 589824 mask 120186.0 589824
layer3.0.conv2.weight, mask/weight parameters,120186,79788 density 0.30866309171597633,0.20491247534516766
before tensor 262144 mask 82079.0 262144
layer3.0.conv3.weight, mask/weight parameters,82079,60522 density 0.3853618915264423,0.28415151742788464
layer3.0.shortcut.0.weight, mask/weight parameters,121558,82999 density 0.23185348510742188,0.1583080291748047
before tensor 262144 mask 44186.0 262144
layer3.1.conv1.weight, mask/weight parameters,44186,30448 density 0.20745380108173078,0.14295372596153846
before tensor 589824 mask 103903.0 589824
layer3.1.conv2.weight, mask/weight parameters,103903,69565 density 0.26684490055884286,0.17865764710716633
before tensor 262144 mask 70417.0 262144
layer3.1.conv3.weight, mask/weight parameters,70417,49899 density 0.3306086613581731,0.23427640474759615
before tensor 262144 mask 47395.0 262144
layer3.2.conv1.weight, mask/weight parameters,47395,30592 density 0.22252009465144232,0.14362980769230768
before tensor 589824 mask 103465.0 589824
layer3.2.conv2.weight, mask/weight parameters,103465,64689 density 0.2657200238330046,0.16613504684418146
before tensor 262144 mask 65808.0 262144
layer3.2.conv3.weight, mask/weight parameters,65808,46967 density 0.30896935096153844,0.22051062950721154
before tensor 262144 mask 45839.0 262144
layer3.3.conv1.weight, mask/weight parameters,45839,31003 density 0.21521465594951922,0.14555945763221154
before tensor 589824 mask 79046.0 589824
layer3.3.conv2.weight, mask/weight parameters,79046,53297 density 0.20300686226166995,0.13687797912557528
before tensor 262144 mask 53621.0 262144
layer3.3.conv3.weight, mask/weight parameters,53621,38174 density 0.2517512394831731,0.1792273888221154
before tensor 262144 mask 48691.0 262144
layer3.4.conv1.weight, mask/weight parameters,48691,32360 density 0.2286048302283654,0.15193058894230768
before tensor 589824 mask 82912.0 589824
layer3.4.conv2.weight, mask/weight parameters,82912,52140 density 0.21293556870479946,0.13390655818540434
before tensor 262144 mask 53298.0 262144
layer3.4.conv3.weight, mask/weight parameters,53298,36371 density 0.25023475060096156,0.17076228215144232
before tensor 262144 mask 53580.0 262144
layer3.5.conv1.weight, mask/weight parameters,53580,36823 density 0.25155874399038464,0.1728844275841346
before tensor 589824 mask 82695.0 589824
layer3.5.conv2.weight, mask/weight parameters,82695,52778 density 0.21237826676528598,0.13554507725180803
before tensor 262144 mask 52479.0 262144
layer3.5.conv3.weight, mask/weight parameters,52479,35198 density 0.24638953575721154,0.1652550330528846
before tensor 524288 mask 149816.0 524288
layer4.0.conv1.weight, mask/weight parameters,149816,108037 density 0.35684070121951217,0.2573289824695122
before tensor 2359296 mask 326938.0 2359296
layer4.0.conv2.weight, mask/weight parameters,326938,211159 density 0.21610020490448806,0.13957234450393285
before tensor 1048576 mask 160275.0 1048576
layer4.0.conv3.weight, mask/weight parameters,160275,107442 density 0.1908762862042683,0.12795588795731708
layer4.0.shortcut.0.weight, mask/weight parameters,222632,146403 density 0.10615921020507812,0.06981039047241211
before tensor 1048576 mask 149948.0 1048576
layer4.1.conv1.weight, mask/weight parameters,149948,107762 density 0.17857755335365855,0.12833698551829267
before tensor 2359296 mask 348922.0 2359296
layer4.1.conv2.weight, mask/weight parameters,348922,240288 density 0.23063123801969726,0.15882609557802896
before tensor 1048576 mask 162637.0 1048576
layer4.1.conv3.weight, mask/weight parameters,162637,113003 density 0.19368926257621952,0.13457864900914634
before tensor 1048576 mask 54078.0 1048576
layer4.2.conv1.weight, mask/weight parameters,54078,33757 density 0.06440310594512196,0.04020221989329268
before tensor 2359296 mask 89194.0 2359296
layer4.2.conv2.weight, mask/weight parameters,89194,40459 density 0.0589556480930663,0.02674267962191817
before tensor 1048576 mask 58222.0 1048576
layer4.2.conv3.weight, mask/weight parameters,58222,34923 density 0.0693383193597561,0.04159084413109756
classifier.weight, mask/weight parameters,116984,104595 density 0.5712109375,0.5107177734375
Total Model parameters after dst: 3480073 2365205
Total parameters under density level of 0.1: 0.19445369352852127 0.13215896568897437 after dst
Death rate: 0.14713640064133


Training summary: Average loss: 1.5066, Accuracy: 28693/50000 (57.386%)


Evaluation: Average loss: 1.9231, Accuracy: 5143/10000 (51.430%)

Current learning rate: 0.1. Time taken for epoch: 88.86 seconds.

Train Epoch: 20 [0/50000 (0%)]	Loss: 1.160732 Accuracy: 70/100 (70.000%
Train Epoch: 20 [10000/50000 (20%)]	Loss: 1.708287 Accuracy: 5889/10100 (58.307%
Train Epoch: 20 [20000/50000 (40%)]	Loss: 1.477171 Accuracy: 11634/20100 (57.881%
Train Epoch: 20 [30000/50000 (60%)]	Loss: 1.579269 Accuracy: 17406/30100 (57.827%
Train Epoch: 20 [40000/50000 (80%)]	Loss: 1.560148 Accuracy: 23205/40100 (57.868%
current layer rate 0.20527332726445152
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6142.0
Total filter_masks items: 14921243.0
6142.0 / 7552 channels
Total channels to prune: 140.22416750113825
Layer ('layer1', 0, 'conv1'): Pruned 1/55.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/55.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/55.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/55.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/55.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/55.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/107.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/107.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/208.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/208.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 9/410.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 9/410.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 9/410.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 9/410.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 9/410.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 9/410.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 6018.0
Total filter_masks items: 14459467.0
After apply_mask:
Total filter_names items: 6018.0
Total filter_masks items: 14459467.0
Total pruned: 124/140.22416750113825 channels
===========done ===============

Training summary: Average loss: 1.4932, Accuracy: 28859/50000 (57.718%)


Evaluation: Average loss: 2.1066, Accuracy: 4500/10000 (45.000%)

Current learning rate: 0.1. Time taken for epoch: 88.65 seconds.

Train Epoch: 21 [0/50000 (0%)]	Loss: 1.392097 Accuracy: 61/100 (61.000%
Train Epoch: 21 [10000/50000 (20%)]	Loss: 1.368155 Accuracy: 5963/10100 (59.040%
Train Epoch: 21 [20000/50000 (40%)]	Loss: 1.716378 Accuracy: 11809/20100 (58.751%
Train Epoch: 21 [30000/50000 (60%)]	Loss: 1.224274 Accuracy: 17556/30100 (58.326%
Train Epoch: 21 [40000/50000 (80%)]	Loss: 1.661905 Accuracy: 23386/40100 (58.319%
current mest  death_rate 0.14654924167200092


dynamic sparse change prune
to kill 989190.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1335,1335 density 0.7725694444444444,0.7725694444444444
before tensor 4096 mask 1164.0 4096
layer1.0.conv1.weight, mask/weight parameters,1164,1164 density 0.3368055555555556,0.3368055555555556
before tensor 36864 mask 5867.0 36864
layer1.0.conv2.weight, mask/weight parameters,5867,5867 density 0.2235558603871361,0.2235558603871361
before tensor 16384 mask 4878.0 16384
layer1.0.conv3.weight, mask/weight parameters,4878,4878 density 0.3528645833333333,0.3528645833333333
layer1.0.shortcut.0.weight, mask/weight parameters,6685,6685 density 0.40802001953125,0.40802001953125
before tensor 16384 mask 2607.0 16384
layer1.1.conv1.weight, mask/weight parameters,2607,2607 density 0.18858506944444445,0.18858506944444445
before tensor 36864 mask 3975.0 36864
layer1.1.conv2.weight, mask/weight parameters,3975,3975 density 0.15146319158664837,0.15146319158664837
before tensor 16384 mask 3195.0 16384
layer1.1.conv3.weight, mask/weight parameters,3195,3195 density 0.23111979166666666,0.23111979166666666
before tensor 16384 mask 1781.0 16384
layer1.2.conv1.weight, mask/weight parameters,1781,1781 density 0.12883391203703703,0.12883391203703703
before tensor 36864 mask 2346.0 36864
layer1.2.conv2.weight, mask/weight parameters,2346,2346 density 0.08939186099679927,0.08939186099679927
before tensor 16384 mask 2039.0 16384
layer1.2.conv3.weight, mask/weight parameters,2039,2039 density 0.14749710648148148,0.14749710648148148
before tensor 32768 mask 5158.0 32768
layer2.0.conv1.weight, mask/weight parameters,5158,5158 density 0.19188988095238096,0.19188988095238096
before tensor 147456 mask 13493.0 147456
layer2.0.conv2.weight, mask/weight parameters,13493,13493 density 0.1359838750314941,0.1359838750314941
before tensor 65536 mask 9381.0 65536
layer2.0.conv3.weight, mask/weight parameters,9381,9381 density 0.17449776785714285,0.17449776785714285
layer2.0.shortcut.0.weight, mask/weight parameters,29871,29871 density 0.22789764404296875,0.22789764404296875
before tensor 65536 mask 5712.0 65536
layer2.1.conv1.weight, mask/weight parameters,5712,5712 density 0.10625,0.10625
before tensor 147456 mask 10169.0 147456
layer2.1.conv2.weight, mask/weight parameters,10169,10169 density 0.10248425296044343,0.10248425296044343
before tensor 65536 mask 7635.0 65536
layer2.1.conv3.weight, mask/weight parameters,7635,7635 density 0.14202008928571427,0.14202008928571427
before tensor 65536 mask 10358.0 65536
layer2.2.conv1.weight, mask/weight parameters,10358,10358 density 0.19267113095238095,0.19267113095238095
before tensor 147456 mask 21574.0 147456
layer2.2.conv2.weight, mask/weight parameters,21574,21574 density 0.21742504409171076,0.21742504409171076
before tensor 65536 mask 12507.0 65536
layer2.2.conv3.weight, mask/weight parameters,12507,12507 density 0.23264508928571428,0.23264508928571428
before tensor 65536 mask 9683.0 65536
layer2.3.conv1.weight, mask/weight parameters,9683,9683 density 0.18011532738095237,0.18011532738095237
before tensor 147456 mask 20636.0 147456
layer2.3.conv2.weight, mask/weight parameters,20636,20636 density 0.20797178130511465,0.20797178130511465
before tensor 65536 mask 11273.0 65536
layer2.3.conv3.weight, mask/weight parameters,11273,11273 density 0.20969122023809525,0.20969122023809525
before tensor 131072 mask 29056.0 131072
layer3.0.conv1.weight, mask/weight parameters,29056,29056 density 0.27818627450980393,0.27818627450980393
before tensor 589824 mask 82446.0 589824
layer3.0.conv2.weight, mask/weight parameters,82446,82446 density 0.22012367038318595,0.22012367038318595
before tensor 262144 mask 60664.0 262144
layer3.0.conv3.weight, mask/weight parameters,60664,60664 density 0.2904028799019608,0.2904028799019608
layer3.0.shortcut.0.weight, mask/weight parameters,84372,84372 density 0.16092681884765625,0.16092681884765625
before tensor 262144 mask 30826.0 262144
layer3.1.conv1.weight, mask/weight parameters,30826,30826 density 0.14756625306372548,0.14756625306372548
before tensor 589824 mask 69510.0 589824
layer3.1.conv2.weight, mask/weight parameters,69510,69510 density 0.18558567217736768,0.18558567217736768
before tensor 262144 mask 50024.0 262144
layer3.1.conv3.weight, mask/weight parameters,50024,50024 density 0.23946844362745098,0.23946844362745098
before tensor 262144 mask 31878.0 262144
layer3.2.conv1.weight, mask/weight parameters,31878,31878 density 0.15260225183823528,0.15260225183823528
before tensor 589824 mask 66874.0 589824
layer3.2.conv2.weight, mask/weight parameters,66874,66874 density 0.17854778076808064,0.17854778076808064
before tensor 262144 mask 46871.0 262144
layer3.2.conv3.weight, mask/weight parameters,46871,46871 density 0.22437480851715685,0.22437480851715685
before tensor 262144 mask 30685.0 262144
layer3.3.conv1.weight, mask/weight parameters,30685,30685 density 0.14689127604166666,0.14689127604166666
before tensor 589824 mask 51977.0 589824
layer3.3.conv2.weight, mask/weight parameters,51977,51977 density 0.13877408261779658,0.13877408261779658
before tensor 262144 mask 37828.0 262144
layer3.3.conv3.weight, mask/weight parameters,37828,37828 density 0.18108532475490197,0.18108532475490197
before tensor 262144 mask 33411.0 262144
layer3.4.conv1.weight, mask/weight parameters,33411,33411 density 0.1599408318014706,0.1599408318014706
before tensor 589824 mask 53802.0 589824
layer3.4.conv2.weight, mask/weight parameters,53802,53802 density 0.1436466743560169,0.1436466743560169
before tensor 262144 mask 36703.0 262144
layer3.4.conv3.weight, mask/weight parameters,36703,36703 density 0.17569986979166666,0.17569986979166666
before tensor 262144 mask 37306.0 262144
layer3.5.conv1.weight, mask/weight parameters,37306,37306 density 0.1785864736519608,0.1785864736519608
before tensor 589824 mask 54928.0 589824
layer3.5.conv2.weight, mask/weight parameters,54928,54928 density 0.14665299671066684,0.14665299671066684
before tensor 262144 mask 35946.0 262144
layer3.5.conv3.weight, mask/weight parameters,35946,35946 density 0.17207605698529413,0.17207605698529413
before tensor 524288 mask 110108.0 524288
layer4.0.conv1.weight, mask/weight parameters,110108,110108 density 0.26814798940149626,0.26814798940149626
before tensor 2359296 mask 212237.0 2359296
layer4.0.conv2.weight, mask/weight parameters,212237,212237 density 0.146652625847407,0.146652625847407
before tensor 1048576 mask 107249.0 1048576
layer4.0.conv3.weight, mask/weight parameters,107249,107249 density 0.1305927076839152,0.1305927076839152
layer4.0.shortcut.0.weight, mask/weight parameters,143404,143404 density 0.06838035583496094,0.06838035583496094
before tensor 1048576 mask 106787.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106787,106787 density 0.13003014923628428,0.13003014923628428
before tensor 2359296 mask 236184.0 2359296
layer4.1.conv2.weight, mask/weight parameters,236184,236184 density 0.16319964842673035,0.16319964842673035
before tensor 1048576 mask 109945.0 1048576
layer4.1.conv3.weight, mask/weight parameters,109945,109945 density 0.1338755162874065,0.1338755162874065
before tensor 1048576 mask 33096.0 1048576
layer4.2.conv1.weight, mask/weight parameters,33096,33096 density 0.040299641521197006,0.040299641521197006
before tensor 2359296 mask 40403.0 2359296
layer4.2.conv2.weight, mask/weight parameters,40403,40403 density 0.027917875027034796,0.027917875027034796
before tensor 1048576 mask 33694.0 1048576
layer4.2.conv3.weight, mask/weight parameters,33694,33694 density 0.041027801589775564,0.041027801589775564
classifier.weight, mask/weight parameters,103669,103669 density 0.5061962890625,0.5061962890625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.13565929376902902 0.13565929376902902 after dst
Death rate: 0.14654924167200092

dynamic sparse change grow
self.total_params*pruning_rate 3466187.3536018995
self.total_nonzero 2365205.0
to grow 1100982.3536018995
len(all_scores) 17434891 14949614
increse 1100982.0 before_mask 3466186.0 after_mask 3466186.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1410,1335 density 0.8159722222222222,0.7725694444444444
before tensor 4096 mask 1347.0 4096
layer1.0.conv1.weight, mask/weight parameters,1347,1164 density 0.3897569444444444,0.3368055555555556
before tensor 36864 mask 7355.0 36864
layer1.0.conv2.weight, mask/weight parameters,7355,5867 density 0.2802545343697607,0.2235558603871361
before tensor 16384 mask 6097.0 16384
layer1.0.conv3.weight, mask/weight parameters,6097,4878 density 0.4410445601851852,0.3528645833333333
layer1.0.shortcut.0.weight, mask/weight parameters,7944,6685 density 0.48486328125,0.40802001953125
before tensor 16384 mask 3423.0 16384
layer1.1.conv1.weight, mask/weight parameters,3423,2607 density 0.2476128472222222,0.18858506944444445
before tensor 36864 mask 5528.0 36864
layer1.1.conv2.weight, mask/weight parameters,5528,3975 density 0.2106386221612559,0.15146319158664837
before tensor 16384 mask 4132.0 16384
layer1.1.conv3.weight, mask/weight parameters,4132,3195 density 0.29890046296296297,0.23111979166666666
before tensor 16384 mask 2764.0 16384
layer1.2.conv1.weight, mask/weight parameters,2764,1781 density 0.19994212962962962,0.12883391203703703
before tensor 36864 mask 3349.0 36864
layer1.2.conv2.weight, mask/weight parameters,3349,2346 density 0.12761012040847433,0.08939186099679927
before tensor 16384 mask 2678.0 16384
layer1.2.conv3.weight, mask/weight parameters,2678,2039 density 0.19372106481481483,0.14749710648148148
before tensor 32768 mask 6856.0 32768
layer2.0.conv1.weight, mask/weight parameters,6856,5158 density 0.2550595238095238,0.19188988095238096
before tensor 147456 mask 17841.0 147456
layer2.0.conv2.weight, mask/weight parameters,17841,13493 density 0.17980347694633408,0.1359838750314941
before tensor 65536 mask 12179.0 65536
layer2.0.conv3.weight, mask/weight parameters,12179,9381 density 0.2265438988095238,0.17449776785714285
layer2.0.shortcut.0.weight, mask/weight parameters,40914,29871 density 0.3121490478515625,0.22789764404296875
before tensor 65536 mask 7981.0 65536
layer2.1.conv1.weight, mask/weight parameters,7981,5712 density 0.1484561011904762,0.10625
before tensor 147456 mask 15908.0 147456
layer2.1.conv2.weight, mask/weight parameters,15908,10169 density 0.16032249937011842,0.10248425296044343
before tensor 65536 mask 9777.0 65536
layer2.1.conv3.weight, mask/weight parameters,9777,7635 density 0.18186383928571428,0.14202008928571427
before tensor 65536 mask 14094.0 65536
layer2.2.conv1.weight, mask/weight parameters,14094,10358 density 0.26216517857142857,0.19267113095238095
before tensor 147456 mask 29710.0 147456
layer2.2.conv2.weight, mask/weight parameters,29710,21574 density 0.2994205089443185,0.21742504409171076
before tensor 65536 mask 17823.0 65536
layer2.2.conv3.weight, mask/weight parameters,17823,12507 density 0.33152901785714284,0.23264508928571428
before tensor 65536 mask 14949.0 65536
layer2.3.conv1.weight, mask/weight parameters,14949,9683 density 0.2780691964285714,0.18011532738095237
before tensor 147456 mask 30061.0 147456
layer2.3.conv2.weight, mask/weight parameters,30061,20636 density 0.30295792391030485,0.20797178130511465
before tensor 65536 mask 15276.0 65536
layer2.3.conv3.weight, mask/weight parameters,15276,11273 density 0.28415178571428573,0.20969122023809525
before tensor 131072 mask 39570.0 131072
layer3.0.conv1.weight, mask/weight parameters,39570,29056 density 0.3788488051470588,0.27818627450980393
before tensor 589824 mask 120140.0 589824
layer3.0.conv2.weight, mask/weight parameters,120140,82446 density 0.32076338160536544,0.22012367038318595
before tensor 262144 mask 83546.0 262144
layer3.0.conv3.weight, mask/weight parameters,83546,60664 density 0.39994064031862747,0.2904028799019608
layer3.0.shortcut.0.weight, mask/weight parameters,121359,84372 density 0.2314739227294922,0.16092681884765625
before tensor 262144 mask 41715.0 262144
layer3.1.conv1.weight, mask/weight parameters,41715,30826 density 0.19969267003676472,0.14756625306372548
before tensor 589824 mask 103046.0 589824
layer3.1.conv2.weight, mask/weight parameters,103046,69510 density 0.27512388397624843,0.18558567217736768
before tensor 262144 mask 69772.0 262144
layer3.1.conv3.weight, mask/weight parameters,69772,50024 density 0.3340035232843137,0.23946844362745098
before tensor 262144 mask 47758.0 262144
layer3.2.conv1.weight, mask/weight parameters,47758,31878 density 0.22862094056372548,0.15260225183823528
before tensor 589824 mask 98950.0 589824
layer3.2.conv2.weight, mask/weight parameters,98950,66874 density 0.2641879191763852,0.17854778076808064
before tensor 262144 mask 66690.0 262144
layer3.2.conv3.weight, mask/weight parameters,66690,46871 density 0.31924977022058826,0.22437480851715685
before tensor 262144 mask 45090.0 262144
layer3.3.conv1.weight, mask/weight parameters,45090,30685 density 0.2158490349264706,0.14689127604166666
before tensor 589824 mask 78136.0 589824
layer3.3.conv2.weight, mask/weight parameters,78136,51977 density 0.2086163441411423,0.13877408261779658
before tensor 262144 mask 55445.0 262144
layer3.3.conv3.weight, mask/weight parameters,55445,37828 density 0.26541915594362747,0.18108532475490197
before tensor 262144 mask 48415.0 262144
layer3.4.conv1.weight, mask/weight parameters,48415,33411 density 0.23176604626225492,0.1599408318014706
before tensor 589824 mask 79695.0 589824
layer3.4.conv2.weight, mask/weight parameters,79695,53802 density 0.21277873894655902,0.1436466743560169
before tensor 262144 mask 53438.0 262144
layer3.4.conv3.weight, mask/weight parameters,53438,36703 density 0.2558115042892157,0.17569986979166666
before tensor 262144 mask 57707.0 262144
layer3.5.conv1.weight, mask/weight parameters,57707,37306 density 0.2762475107230392,0.1785864736519608
before tensor 589824 mask 83331.0 589824
layer3.5.conv2.weight, mask/weight parameters,83331,54928 density 0.22248654363706266,0.14665299671066684
before tensor 262144 mask 52543.0 262144
layer3.5.conv3.weight, mask/weight parameters,52543,35946 density 0.2515270756740196,0.17207605698529413
before tensor 524288 mask 157960.0 524288
layer4.0.conv1.weight, mask/weight parameters,157960,110108 density 0.3846828241895262,0.26814798940149626
before tensor 2359296 mask 337223.0 2359296
layer4.0.conv2.weight, mask/weight parameters,337223,212237 density 0.23301610202811066,0.146652625847407
before tensor 1048576 mask 160748.0 1048576
layer4.0.conv3.weight, mask/weight parameters,160748,107249 density 0.19573624532418954,0.1305927076839152
layer4.0.shortcut.0.weight, mask/weight parameters,222665,143404 density 0.10617494583129883,0.06838035583496094
before tensor 1048576 mask 150245.0 1048576
layer4.1.conv1.weight, mask/weight parameters,150245,106787 density 0.18294717308291772,0.13003014923628428
before tensor 2359296 mask 336641.0 2359296
layer4.1.conv2.weight, mask/weight parameters,336641,236184 density 0.23261394864183405,0.16319964842673035
before tensor 1048576 mask 157557.0 1048576
layer4.1.conv3.weight, mask/weight parameters,157557,109945 density 0.19185069552680797,0.1338755162874065
before tensor 1048576 mask 56222.0 1048576
layer4.2.conv1.weight, mask/weight parameters,56222,33096 density 0.0684592230361596,0.040299641521197006
before tensor 2359296 mask 91314.0 2359296
layer4.2.conv2.weight, mask/weight parameters,91314,40403 density 0.06309662253344196,0.027917875027034796
before tensor 1048576 mask 55370.0 1048576
layer4.2.conv3.weight, mask/weight parameters,55370,33694 density 0.0674217775872818,0.041027801589775564
classifier.weight, mask/weight parameters,114499,103669 density 0.5590771484375,0.5061962890625
Total Model parameters after dst: 3466186 2365205
Total parameters under density level of 0.1: 0.19880743733929854 0.13565929376902902 after dst
Death rate: 0.14654924167200092


Training summary: Average loss: 1.4736, Accuracy: 29153/50000 (58.306%)


Evaluation: Average loss: 1.7039, Accuracy: 5354/10000 (53.540%)

Current learning rate: 0.1. Time taken for epoch: 88.83 seconds.

Train Epoch: 22 [0/50000 (0%)]	Loss: 1.344144 Accuracy: 61/100 (61.000%
Train Epoch: 22 [10000/50000 (20%)]	Loss: 1.673872 Accuracy: 5926/10100 (58.673%
Train Epoch: 22 [20000/50000 (40%)]	Loss: 1.582404 Accuracy: 11765/20100 (58.532%
Train Epoch: 22 [30000/50000 (60%)]	Loss: 1.249892 Accuracy: 17601/30100 (58.475%
Train Epoch: 22 [40000/50000 (80%)]	Loss: 1.385653 Accuracy: 23474/40100 (58.539%
current layer rate 0.22120095584888488
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 6018.0
Total filter_masks items: 14459467.0
6018.0 / 7552 channels
Total channels to prune: 136.5096185707789
Layer ('layer1', 0, 'conv1'): Pruned 1/54.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/54.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/54.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/54.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/54.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/54.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/105.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/105.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/204.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/204.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 9/401.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 9/401.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 9/401.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 9/401.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 9/401.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 9/401.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5894.0
Total filter_masks items: 14004135.0
After apply_mask:
Total filter_names items: 5894.0
Total filter_masks items: 14004135.0
Total pruned: 124/136.5096185707789 channels
===========done ===============

Training summary: Average loss: 1.4645, Accuracy: 29197/50000 (58.394%)


Evaluation: Average loss: 1.9580, Accuracy: 4746/10000 (47.460%)

Current learning rate: 0.1. Time taken for epoch: 88.65 seconds.

Train Epoch: 23 [0/50000 (0%)]	Loss: 1.355558 Accuracy: 60/100 (60.000%
Train Epoch: 23 [10000/50000 (20%)]	Loss: 1.663363 Accuracy: 5932/10100 (58.733%
Train Epoch: 23 [20000/50000 (40%)]	Loss: 1.468458 Accuracy: 11801/20100 (58.711%
Train Epoch: 23 [30000/50000 (60%)]	Loss: 1.413938 Accuracy: 17690/30100 (58.771%
Train Epoch: 23 [40000/50000 (80%)]	Loss: 1.682523 Accuracy: 23676/40100 (59.042%
current mest  death_rate 0.1459117534502555


dynamic sparse change prune
to kill 971104.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1305,1305 density 0.7552083333333334,0.7552083333333334
before tensor 4096 mask 1089.0 4096
layer1.0.conv1.weight, mask/weight parameters,1089,1089 density 0.32104952830188677,0.32104952830188677
before tensor 36864 mask 5494.0 36864
layer1.0.conv2.weight, mask/weight parameters,5494,5494 density 0.2173173529528104,0.2173173529528104
before tensor 16384 mask 4725.0 16384
layer1.0.conv3.weight, mask/weight parameters,4725,4725 density 0.3482458726415094,0.3482458726415094
layer1.0.shortcut.0.weight, mask/weight parameters,6547,6547 density 0.39959716796875,0.39959716796875
before tensor 16384 mask 2422.0 16384
layer1.1.conv1.weight, mask/weight parameters,2422,2422 density 0.17850825471698112,0.17850825471698112
before tensor 36864 mask 3894.0 36864
layer1.1.conv2.weight, mask/weight parameters,3894,3894 density 0.15402871721846445,0.15402871721846445
before tensor 16384 mask 3033.0 16384
layer1.1.conv3.weight, mask/weight parameters,3033,3033 density 0.22354068396226415,0.22354068396226415
before tensor 16384 mask 1899.0 16384
layer1.2.conv1.weight, mask/weight parameters,1899,1899 density 0.13996167452830188,0.13996167452830188
before tensor 36864 mask 2374.0 36864
layer1.2.conv2.weight, mask/weight parameters,2374,2374 density 0.09390451327083581,0.09390451327083581
before tensor 16384 mask 1882.0 16384
layer1.2.conv3.weight, mask/weight parameters,1882,1882 density 0.13870872641509435,0.13870872641509435
before tensor 32768 mask 4915.0 32768
layer2.0.conv1.weight, mask/weight parameters,4915,4915 density 0.18640018203883496,0.18640018203883496
before tensor 147456 mask 13369.0 147456
layer2.0.conv2.weight, mask/weight parameters,13369,13369 density 0.14001738565787958,0.14001738565787958
before tensor 65536 mask 9139.0 65536
layer2.0.conv3.weight, mask/weight parameters,9139,9139 density 0.17329717839805825,0.17329717839805825
layer2.0.shortcut.0.weight, mask/weight parameters,29856,29856 density 0.227783203125,0.227783203125
before tensor 65536 mask 5371.0 65536
layer2.1.conv1.weight, mask/weight parameters,5371,5371 density 0.10184693567961164,0.10184693567961164
before tensor 147456 mask 9728.0 147456
layer2.1.conv2.weight, mask/weight parameters,9728,9728 density 0.10188414448947958,0.10188414448947958
before tensor 65536 mask 6833.0 65536
layer2.1.conv3.weight, mask/weight parameters,6833,6833 density 0.1295699332524272,0.1295699332524272
before tensor 65536 mask 10118.0 65536
layer2.2.conv1.weight, mask/weight parameters,10118,10118 density 0.19186134708737865,0.19186134708737865
before tensor 147456 mask 21625.0 147456
layer2.2.conv2.weight, mask/weight parameters,21625,21625 density 0.22648485038908264,0.22648485038908264
before tensor 65536 mask 12778.0 65536
layer2.2.conv3.weight, mask/weight parameters,12778,12778 density 0.24230127427184467,0.24230127427184467
before tensor 65536 mask 10213.0 65536
layer2.3.conv1.weight, mask/weight parameters,10213,10213 density 0.19366277305825244,0.19366277305825244
before tensor 147456 mask 21164.0 147456
layer2.3.conv2.weight, mask/weight parameters,21164,21164 density 0.22165666467674197,0.22165666467674197
before tensor 65536 mask 11005.0 65536
layer2.3.conv3.weight, mask/weight parameters,11005,11005 density 0.20868097694174756,0.20868097694174756
before tensor 131072 mask 28827.0 131072
layer3.0.conv1.weight, mask/weight parameters,28827,28827 density 0.281513671875,0.281513671875
before tensor 589824 mask 83340.0 589824
layer3.0.conv2.weight, mask/weight parameters,83340,83340 density 0.2315,0.2315
before tensor 262144 mask 62129.0 262144
layer3.0.conv3.weight, mask/weight parameters,62129,62129 density 0.3033642578125,0.3033642578125
layer3.0.shortcut.0.weight, mask/weight parameters,85332,85332 density 0.16275787353515625,0.16275787353515625
before tensor 262144 mask 29393.0 262144
layer3.1.conv1.weight, mask/weight parameters,29393,29393 density 0.1435205078125,0.1435205078125
before tensor 589824 mask 68338.0 589824
layer3.1.conv2.weight, mask/weight parameters,68338,68338 density 0.1898277777777778,0.1898277777777778
before tensor 262144 mask 49759.0 262144
layer3.1.conv3.weight, mask/weight parameters,49759,49759 density 0.2429638671875,0.2429638671875
before tensor 262144 mask 32028.0 262144
layer3.2.conv1.weight, mask/weight parameters,32028,32028 density 0.15638671875,0.15638671875
before tensor 589824 mask 66220.0 589824
layer3.2.conv2.weight, mask/weight parameters,66220,66220 density 0.18394444444444444,0.18394444444444444
before tensor 262144 mask 47055.0 262144
layer3.2.conv3.weight, mask/weight parameters,47055,47055 density 0.2297607421875,0.2297607421875
before tensor 262144 mask 30299.0 262144
layer3.3.conv1.weight, mask/weight parameters,30299,30299 density 0.1479443359375,0.1479443359375
before tensor 589824 mask 51398.0 589824
layer3.3.conv2.weight, mask/weight parameters,51398,51398 density 0.14277222222222222,0.14277222222222222
before tensor 262144 mask 38158.0 262144
layer3.3.conv3.weight, mask/weight parameters,38158,38158 density 0.186318359375,0.186318359375
before tensor 262144 mask 33454.0 262144
layer3.4.conv1.weight, mask/weight parameters,33454,33454 density 0.163349609375,0.163349609375
before tensor 589824 mask 53285.0 589824
layer3.4.conv2.weight, mask/weight parameters,53285,53285 density 0.1480138888888889,0.1480138888888889
before tensor 262144 mask 37055.0 262144
layer3.4.conv3.weight, mask/weight parameters,37055,37055 density 0.1809326171875,0.1809326171875
before tensor 262144 mask 39029.0 262144
layer3.5.conv1.weight, mask/weight parameters,39029,39029 density 0.1905712890625,0.1905712890625
before tensor 589824 mask 54829.0 589824
layer3.5.conv2.weight, mask/weight parameters,54829,54829 density 0.1523027777777778,0.1523027777777778
before tensor 262144 mask 35891.0 262144
layer3.5.conv3.weight, mask/weight parameters,35891,35891 density 0.1752490234375,0.1752490234375
before tensor 524288 mask 115482.0 524288
layer4.0.conv1.weight, mask/weight parameters,115482,115482 density 0.28769232302295916,0.28769232302295916
before tensor 2359296 mask 220985.0 2359296
layer4.0.conv2.weight, mask/weight parameters,220985,220985 density 0.15978946850849182,0.15978946850849182
before tensor 1048576 mask 108419.0 1048576
layer4.0.conv3.weight, mask/weight parameters,108419,108419 density 0.13504837970344388,0.13504837970344388
layer4.0.shortcut.0.weight, mask/weight parameters,142435,142435 density 0.06791830062866211,0.06791830062866211
before tensor 1048576 mask 106056.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106056,106056 density 0.13210499043367346,0.13210499043367346
before tensor 2359296 mask 228173.0 2359296
layer4.1.conv2.weight, mask/weight parameters,228173,228173 density 0.1649869556666204,0.1649869556666204
before tensor 1048576 mask 106882.0 1048576
layer4.1.conv3.weight, mask/weight parameters,106882,106882 density 0.13313386878188777,0.13313386878188777
before tensor 1048576 mask 33464.0 1048576
layer4.2.conv1.weight, mask/weight parameters,33464,33464 density 0.04168327487244898,0.04168327487244898
before tensor 2359296 mask 41947.0 2359296
layer4.2.conv2.weight, mask/weight parameters,41947,41947 density 0.030330967420982,0.030330967420982
before tensor 1048576 mask 32532.0 1048576
layer4.2.conv3.weight, mask/weight parameters,32532,32532 density 0.04052236128826531,0.04052236128826531
classifier.weight, mask/weight parameters,102233,102233 density 0.4991845703125,0.4991845703125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.13929719847258695 0.13929719847258695 after dst
Death rate: 0.1459117534502555

dynamic sparse change grow
self.total_params*pruning_rate 3451109.4617815535
self.total_nonzero 2365205.0
to grow 1085904.4617815535
len(all_scores) 16979559 14468561
increse 1085904.0 before_mask 3451108.0 after_mask 3451108.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1416,1305 density 0.8194444444444444,0.7552083333333334
before tensor 4096 mask 1273.0 4096
layer1.0.conv1.weight, mask/weight parameters,1273,1089 density 0.3752948113207547,0.32104952830188677
before tensor 36864 mask 6954.0 36864
layer1.0.conv2.weight, mask/weight parameters,6954,5494 density 0.27506823306040107,0.2173173529528104
before tensor 16384 mask 5740.0 16384
layer1.0.conv3.weight, mask/weight parameters,5740,4725 density 0.4230542452830189,0.3482458726415094
layer1.0.shortcut.0.weight, mask/weight parameters,7710,6547 density 0.4705810546875,0.39959716796875
before tensor 16384 mask 3244.0 16384
layer1.1.conv1.weight, mask/weight parameters,3244,2422 density 0.23909198113207547,0.17850825471698112
before tensor 36864 mask 4639.0 36864
layer1.1.conv2.weight, mask/weight parameters,4639,3894 density 0.1834974882322693,0.15402871721846445
before tensor 16384 mask 3837.0 16384
layer1.1.conv3.weight, mask/weight parameters,3837,3033 density 0.28279775943396224,0.22354068396226415
before tensor 16384 mask 3119.0 16384
layer1.2.conv1.weight, mask/weight parameters,3119,1899 density 0.22987912735849056,0.13996167452830188
before tensor 36864 mask 3916.0 36864
layer1.2.conv2.weight, mask/weight parameters,3916,2374 density 0.15489893595981172,0.09390451327083581
before tensor 16384 mask 2736.0 16384
layer1.2.conv3.weight, mask/weight parameters,2736,1882 density 0.2016509433962264,0.13870872641509435
before tensor 32768 mask 7054.0 32768
layer2.0.conv1.weight, mask/weight parameters,7054,4915 density 0.26752123786407767,0.18640018203883496
before tensor 147456 mask 18834.0 147456
layer2.0.conv2.weight, mask/weight parameters,18834,13369 density 0.197253903918057,0.14001738565787958
before tensor 65536 mask 11900.0 65536
layer2.0.conv3.weight, mask/weight parameters,11900,9139 density 0.2256523058252427,0.17329717839805825
layer2.0.shortcut.0.weight, mask/weight parameters,40178,29856 density 0.3065338134765625,0.227783203125
before tensor 65536 mask 8158.0 65536
layer2.1.conv1.weight, mask/weight parameters,8158,5371 density 0.1546950849514563,0.10184693567961164
before tensor 147456 mask 12170.0 147456
layer2.1.conv2.weight, mask/weight parameters,12170,9728 density 0.12745991349064212,0.10188414448947958
before tensor 65536 mask 8928.0 65536
layer2.1.conv3.weight, mask/weight parameters,8928,6833 density 0.16929611650485438,0.1295699332524272
before tensor 65536 mask 14675.0 65536
layer2.2.conv1.weight, mask/weight parameters,14675,10118 density 0.27827290655339804,0.19186134708737865
before tensor 147456 mask 30686.0 147456
layer2.2.conv2.weight, mask/weight parameters,30686,21625 density 0.32138331186309316,0.22648485038908264
before tensor 65536 mask 17741.0 65536
layer2.2.conv3.weight, mask/weight parameters,17741,12778 density 0.3364115594660194,0.24230127427184467
before tensor 65536 mask 14198.0 65536
layer2.3.conv1.weight, mask/weight parameters,14198,10213 density 0.2692278519417476,0.19366277305825244
before tensor 147456 mask 28270.0 147456
layer2.3.conv2.weight, mask/weight parameters,28270,21164 density 0.2960798483467915,0.22165666467674197
before tensor 65536 mask 14894.0 65536
layer2.3.conv3.weight, mask/weight parameters,14894,11005 density 0.28242566747572817,0.20868097694174756
before tensor 131072 mask 38340.0 131072
layer3.0.conv1.weight, mask/weight parameters,38340,28827 density 0.3744140625,0.281513671875
before tensor 589824 mask 115747.0 589824
layer3.0.conv2.weight, mask/weight parameters,115747,83340 density 0.32151944444444447,0.2315
before tensor 262144 mask 81182.0 262144
layer3.0.conv3.weight, mask/weight parameters,81182,62129 density 0.396396484375,0.3033642578125
layer3.0.shortcut.0.weight, mask/weight parameters,118597,85332 density 0.22620582580566406,0.16275787353515625
before tensor 262144 mask 42728.0 262144
layer3.1.conv1.weight, mask/weight parameters,42728,29393 density 0.2086328125,0.1435205078125
before tensor 589824 mask 106854.0 589824
layer3.1.conv2.weight, mask/weight parameters,106854,68338 density 0.2968166666666667,0.1898277777777778
before tensor 262144 mask 68413.0 262144
layer3.1.conv3.weight, mask/weight parameters,68413,49759 density 0.3340478515625,0.2429638671875
before tensor 262144 mask 42574.0 262144
layer3.2.conv1.weight, mask/weight parameters,42574,32028 density 0.207880859375,0.15638671875
before tensor 589824 mask 94838.0 589824
layer3.2.conv2.weight, mask/weight parameters,94838,66220 density 0.2634388888888889,0.18394444444444444
before tensor 262144 mask 63646.0 262144
layer3.2.conv3.weight, mask/weight parameters,63646,47055 density 0.310771484375,0.2297607421875
before tensor 262144 mask 44160.0 262144
layer3.3.conv1.weight, mask/weight parameters,44160,30299 density 0.215625,0.1479443359375
before tensor 589824 mask 76892.0 589824
layer3.3.conv2.weight, mask/weight parameters,76892,51398 density 0.21358888888888888,0.14277222222222222
before tensor 262144 mask 54415.0 262144
layer3.3.conv3.weight, mask/weight parameters,54415,38158 density 0.2656982421875,0.186318359375
before tensor 262144 mask 49199.0 262144
layer3.4.conv1.weight, mask/weight parameters,49199,33454 density 0.2402294921875,0.163349609375
before tensor 589824 mask 79434.0 589824
layer3.4.conv2.weight, mask/weight parameters,79434,53285 density 0.22065,0.1480138888888889
before tensor 262144 mask 52612.0 262144
layer3.4.conv3.weight, mask/weight parameters,52612,37055 density 0.25689453125,0.1809326171875
before tensor 262144 mask 53711.0 262144
layer3.5.conv1.weight, mask/weight parameters,53711,39029 density 0.2622607421875,0.1905712890625
before tensor 589824 mask 76047.0 589824
layer3.5.conv2.weight, mask/weight parameters,76047,54829 density 0.21124166666666666,0.1523027777777778
before tensor 262144 mask 49124.0 262144
layer3.5.conv3.weight, mask/weight parameters,49124,35891 density 0.23986328125,0.1752490234375
before tensor 524288 mask 154646.0 524288
layer4.0.conv1.weight, mask/weight parameters,154646,115482 density 0.3852588887117347,0.28769232302295916
before tensor 2359296 mask 335647.0 2359296
layer4.0.conv2.weight, mask/weight parameters,335647,220985 density 0.24269907793049192,0.15978946850849182
before tensor 1048576 mask 164818.0 1048576
layer4.0.conv3.weight, mask/weight parameters,164818,108419 density 0.20529984454719388,0.13504837970344388
layer4.0.shortcut.0.weight, mask/weight parameters,228788,142435 density 0.10909461975097656,0.06791830062866211
before tensor 1048576 mask 150732.0 1048576
layer4.1.conv1.weight, mask/weight parameters,150732,106056 density 0.18775410554846939,0.13210499043367346
before tensor 2359296 mask 340791.0 2359296
layer4.1.conv2.weight, mask/weight parameters,340791,228173 density 0.24641859294738302,0.1649869556666204
before tensor 1048576 mask 162840.0 1048576
layer4.1.conv3.weight, mask/weight parameters,162840,106882 density 0.20283601721938777,0.13313386878188777
before tensor 1048576 mask 59792.0 1048576
layer4.2.conv1.weight, mask/weight parameters,59792,33464 density 0.07447783801020408,0.04168327487244898
before tensor 2359296 mask 93297.0 2359296
layer4.2.conv2.weight, mask/weight parameters,93297,41947 density 0.06746104053866445,0.030330967420982
before tensor 1048576 mask 62921.0 1048576
layer4.2.conv3.weight, mask/weight parameters,62921,32532 density 0.07837536870216837,0.04052236128826531
classifier.weight, mask/weight parameters,116053,102233 density 0.5666650390625,0.4991845703125
Total Model parameters after dst: 3451108 2365205
Total parameters under density level of 0.1: 0.20325074402697973 0.13929719847258695 after dst
Death rate: 0.1459117534502555


Training summary: Average loss: 1.4478, Accuracy: 29479/50000 (58.958%)


Evaluation: Average loss: 1.7778, Accuracy: 5169/10000 (51.690%)

Current learning rate: 0.1. Time taken for epoch: 88.83 seconds.

Train Epoch: 24 [0/50000 (0%)]	Loss: 1.524230 Accuracy: 60/100 (60.000%
Train Epoch: 24 [10000/50000 (20%)]	Loss: 1.295462 Accuracy: 6065/10100 (60.050%
Train Epoch: 24 [20000/50000 (40%)]	Loss: 1.354483 Accuracy: 11898/20100 (59.194%
Train Epoch: 24 [30000/50000 (60%)]	Loss: 1.222767 Accuracy: 17693/30100 (58.781%
Train Epoch: 24 [40000/50000 (80%)]	Loss: 1.629637 Accuracy: 23693/40100 (59.085%
current layer rate 0.23654415111515703
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5894.0
Total filter_masks items: 14004135.0
5894.0 / 7552 channels
Total channels to prune: 128.3814292216657
Layer ('layer1', 0, 'conv1'): Pruned 1/53.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/53.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/53.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/53.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/53.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/53.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/103.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/103.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/200.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/200.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 8/392.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 8/392.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 8/392.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 8/392.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 8/392.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 8/392.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5776.0
Total filter_masks items: 13587220.0
After apply_mask:
Total filter_names items: 5776.0
Total filter_masks items: 13587220.0
Total pruned: 118/128.3814292216657 channels
===========done ===============

Training summary: Average loss: 1.4434, Accuracy: 29408/50000 (58.816%)


Evaluation: Average loss: 2.1010, Accuracy: 4446/10000 (44.460%)

Current learning rate: 0.1. Time taken for epoch: 88.64 seconds.

Train Epoch: 25 [0/50000 (0%)]	Loss: 1.432151 Accuracy: 61/100 (61.000%
Train Epoch: 25 [10000/50000 (20%)]	Loss: 1.246789 Accuracy: 6115/10100 (60.545%
Train Epoch: 25 [20000/50000 (40%)]	Loss: 1.482194 Accuracy: 12046/20100 (59.930%
Train Epoch: 25 [30000/50000 (60%)]	Loss: 1.540800 Accuracy: 17894/30100 (59.449%
Train Epoch: 25 [40000/50000 (80%)]	Loss: 2.050509 Accuracy: 23786/40100 (59.317%
current mest  death_rate 0.1452254248593737


dynamic sparse change prune
to kill 963291.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1310,1310 density 0.7581018518518519,0.7581018518518519
before tensor 4096 mask 1024.0 4096
layer1.0.conv1.weight, mask/weight parameters,1024,1024 density 0.3076923076923077,0.3076923076923077
before tensor 36864 mask 5200.0 36864
layer1.0.conv2.weight, mask/weight parameters,5200,5200 density 0.21367521367521367,0.21367521367521367
before tensor 16384 mask 4549.0 16384
layer1.0.conv3.weight, mask/weight parameters,4549,4549 density 0.3417217548076923,0.3417217548076923
layer1.0.shortcut.0.weight, mask/weight parameters,6456,6456 density 0.39404296875,0.39404296875
before tensor 16384 mask 2350.0 16384
layer1.1.conv1.weight, mask/weight parameters,2350,2350 density 0.17653245192307693,0.17653245192307693
before tensor 36864 mask 3452.0 36864
layer1.1.conv2.weight, mask/weight parameters,3452,3452 density 0.1418474687705457,0.1418474687705457
before tensor 16384 mask 2888.0 16384
layer1.1.conv3.weight, mask/weight parameters,2888,2888 density 0.2169471153846154,0.2169471153846154
before tensor 16384 mask 2016.0 16384
layer1.2.conv1.weight, mask/weight parameters,2016,2016 density 0.15144230769230768,0.15144230769230768
before tensor 36864 mask 2412.0 36864
layer1.2.conv2.weight, mask/weight parameters,2412,2412 density 0.09911242603550297,0.09911242603550297
before tensor 16384 mask 1915.0 16384
layer1.2.conv3.weight, mask/weight parameters,1915,1915 density 0.14385516826923078,0.14385516826923078
before tensor 32768 mask 4839.0 32768
layer2.0.conv1.weight, mask/weight parameters,4839,4839 density 0.18715191831683167,0.18715191831683167
before tensor 147456 mask 13810.0 147456
layer2.0.conv2.weight, mask/weight parameters,13810,13810 density 0.15042098269232865,0.15042098269232865
before tensor 65536 mask 8893.0 65536
layer2.0.conv3.weight, mask/weight parameters,8893,8893 density 0.17197168935643564,0.17197168935643564
layer2.0.shortcut.0.weight, mask/weight parameters,29540,29540 density 0.225372314453125,0.225372314453125
before tensor 65536 mask 5293.0 65536
layer2.1.conv1.weight, mask/weight parameters,5293,5293 density 0.10235535272277228,0.10235535272277228
before tensor 147456 mask 8099.0 147456
layer2.1.conv2.weight, mask/weight parameters,8099,8099 density 0.08821575226829613,0.08821575226829613
before tensor 65536 mask 6028.0 65536
layer2.1.conv3.weight, mask/weight parameters,6028,6028 density 0.11656868811881188,0.11656868811881188
before tensor 65536 mask 10446.0 65536
layer2.2.conv1.weight, mask/weight parameters,10446,10446 density 0.20200340346534654,0.20200340346534654
before tensor 147456 mask 21681.0 147456
layer2.2.conv2.weight, mask/weight parameters,21681,21681 density 0.23615331830212724,0.23615331830212724
before tensor 65536 mask 12528.0 65536
layer2.2.conv3.weight, mask/weight parameters,12528,12528 density 0.2422648514851485,0.2422648514851485
before tensor 65536 mask 10177.0 65536
layer2.3.conv1.weight, mask/weight parameters,10177,10177 density 0.19680151608910892,0.19680151608910892
before tensor 147456 mask 20604.0 147456
layer2.3.conv2.weight, mask/weight parameters,20604,20604 density 0.22442244224422442,0.22442244224422442
before tensor 65536 mask 10722.0 65536
layer2.3.conv3.weight, mask/weight parameters,10722,10722 density 0.20734065594059406,0.20734065594059406
before tensor 131072 mask 28302.0 131072
layer3.0.conv1.weight, mask/weight parameters,28302,28302 density 0.28202726403061223,0.28202726403061223
before tensor 589824 mask 82171.0 589824
layer3.0.conv2.weight, mask/weight parameters,82171,82171 density 0.237664283400435,0.237664283400435
before tensor 262144 mask 61201.0 262144
layer3.0.conv3.weight, mask/weight parameters,61201,61201 density 0.304931640625,0.304931640625
layer3.0.shortcut.0.weight, mask/weight parameters,84374,84374 density 0.16093063354492188,0.16093063354492188
before tensor 262144 mask 29462.0 262144
layer3.1.conv1.weight, mask/weight parameters,29462,29462 density 0.14679328762755103,0.14679328762755103
before tensor 589824 mask 69884.0 589824
layer3.1.conv2.weight, mask/weight parameters,69884,69884 density 0.20212642880281365,0.20212642880281365
before tensor 262144 mask 49301.0 262144
layer3.1.conv3.weight, mask/weight parameters,49301,49301 density 0.24564034598214285,0.24564034598214285
before tensor 262144 mask 29721.0 262144
layer3.2.conv1.weight, mask/weight parameters,29721,29721 density 0.14808374521683673,0.14808374521683673
before tensor 589824 mask 64151.0 589824
layer3.2.conv2.weight, mask/weight parameters,64151,64151 density 0.18554479614975242,0.18554479614975242
before tensor 262144 mask 45819.0 262144
layer3.2.conv3.weight, mask/weight parameters,45819,45819 density 0.22829141422193877,0.22829141422193877
before tensor 262144 mask 30196.0 262144
layer3.3.conv1.weight, mask/weight parameters,30196,30196 density 0.1504504145408163,0.1504504145408163
before tensor 589824 mask 51459.0 589824
layer3.3.conv2.weight, mask/weight parameters,51459,51459 density 0.14883555463001527,0.14883555463001527
before tensor 262144 mask 38070.0 262144
layer3.3.conv3.weight, mask/weight parameters,38070,38070 density 0.18968231823979592,0.18968231823979592
before tensor 262144 mask 33519.0 262144
layer3.4.conv1.weight, mask/weight parameters,33519,33519 density 0.16700713488520408,0.16700713488520408
before tensor 589824 mask 52688.0 589824
layer3.4.conv2.weight, mask/weight parameters,52688,52688 density 0.15239020778379378,0.15239020778379378
before tensor 262144 mask 36722.0 262144
layer3.4.conv3.weight, mask/weight parameters,36722,36722 density 0.18296595982142858,0.18296595982142858
before tensor 262144 mask 37746.0 262144
layer3.5.conv1.weight, mask/weight parameters,37746,37746 density 0.1880680006377551,0.1880680006377551
before tensor 589824 mask 52612.0 589824
layer3.5.conv2.weight, mask/weight parameters,52612,52612 density 0.15217039196631033,0.15217039196631033
before tensor 262144 mask 34868.0 262144
layer3.5.conv3.weight, mask/weight parameters,34868,34868 density 0.17372847576530612,0.17372847576530612
before tensor 524288 mask 116008.0 524288
layer4.0.conv1.weight, mask/weight parameters,116008,116008 density 0.2950236002604167,0.2950236002604167
before tensor 2359296 mask 224352.0 2359296
layer4.0.conv2.weight, mask/weight parameters,224352,224352 density 0.16905381944444445,0.16905381944444445
before tensor 1048576 mask 110761.0 1048576
layer4.0.conv3.weight, mask/weight parameters,110761,110761 density 0.14083989461263022,0.14083989461263022
layer4.0.shortcut.0.weight, mask/weight parameters,144092,144092 density 0.06870841979980469,0.06870841979980469
before tensor 1048576 mask 107006.0 1048576
layer4.1.conv1.weight, mask/weight parameters,107006,107006 density 0.1360651652018229,0.1360651652018229
before tensor 2359296 mask 232134.0 2359296
layer4.1.conv2.weight, mask/weight parameters,232134,232134 density 0.17491771556712962,0.17491771556712962
before tensor 1048576 mask 108531.0 1048576
layer4.1.conv3.weight, mask/weight parameters,108531,108531 density 0.13800430297851562,0.13800430297851562
before tensor 1048576 mask 34734.0 1048576
layer4.2.conv1.weight, mask/weight parameters,34734,34734 density 0.04416656494140625,0.04416656494140625
before tensor 2359296 mask 43103.0 2359296
layer4.2.conv2.weight, mask/weight parameters,43103,43103 density 0.03247899184992284,0.03247899184992284
before tensor 1048576 mask 33420.0 1048576
layer4.2.conv3.weight, mask/weight parameters,33420,33420 density 0.0424957275390625,0.0424957275390625
classifier.weight, mask/weight parameters,102566,102566 density 0.500810546875,0.500810546875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.14280358860578057 0.14280358860578057 after dst
Death rate: 0.1452254248593737

dynamic sparse change grow
self.total_params*pruning_rate 3434876.3959875023
self.total_nonzero 2365205.0
to grow 1069671.3959875023
len(all_scores) 16562644 14016258
increse 1069671.0 before_mask 3434875.0 after_mask 3434875.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1433,1310 density 0.8292824074074074,0.7581018518518519
before tensor 4096 mask 1189.0 4096
layer1.0.conv1.weight, mask/weight parameters,1189,1024 density 0.35727163461538464,0.3076923076923077
before tensor 36864 mask 6615.0 36864
layer1.0.conv2.weight, mask/weight parameters,6615,5200 density 0.2718195266272189,0.21367521367521367
before tensor 16384 mask 5641.0 16384
layer1.0.conv3.weight, mask/weight parameters,5641,4549 density 0.4237530048076923,0.3417217548076923
layer1.0.shortcut.0.weight, mask/weight parameters,7439,6456 density 0.45404052734375,0.39404296875
before tensor 16384 mask 3595.0 16384
layer1.1.conv1.weight, mask/weight parameters,3595,2350 density 0.27005709134615385,0.17653245192307693
before tensor 36864 mask 5661.0 36864
layer1.1.conv2.weight, mask/weight parameters,5661,3452 density 0.23261834319526628,0.1418474687705457
before tensor 16384 mask 3519.0 16384
layer1.1.conv3.weight, mask/weight parameters,3519,2888 density 0.2643479567307692,0.2169471153846154
before tensor 16384 mask 3643.0 16384
layer1.2.conv1.weight, mask/weight parameters,3643,2016 density 0.2736628605769231,0.15144230769230768
before tensor 36864 mask 3711.0 36864
layer1.2.conv2.weight, mask/weight parameters,3711,2412 density 0.15249013806706113,0.09911242603550297
before tensor 16384 mask 2701.0 16384
layer1.2.conv3.weight, mask/weight parameters,2701,1915 density 0.20289963942307693,0.14385516826923078
before tensor 32768 mask 8132.0 32768
layer2.0.conv1.weight, mask/weight parameters,8132,4839 density 0.3145111386138614,0.18715191831683167
before tensor 147456 mask 19108.0 147456
layer2.0.conv2.weight, mask/weight parameters,19108,13810 density 0.20812774346741605,0.15042098269232865
before tensor 65536 mask 11768.0 65536
layer2.0.conv3.weight, mask/weight parameters,11768,8893 density 0.2275680693069307,0.17197168935643564
layer2.0.shortcut.0.weight, mask/weight parameters,38594,29540 density 0.2944488525390625,0.225372314453125
before tensor 65536 mask 7206.0 65536
layer2.1.conv1.weight, mask/weight parameters,7206,5293 density 0.1393487004950495,0.10235535272277228
before tensor 147456 mask 10828.0 147456
layer2.1.conv2.weight, mask/weight parameters,10828,8099 density 0.11794050692197933,0.08821575226829613
before tensor 65536 mask 7982.0 65536
layer2.1.conv3.weight, mask/weight parameters,7982,6028 density 0.15435488861386137,0.11656868811881188
before tensor 65536 mask 13159.0 65536
layer2.2.conv1.weight, mask/weight parameters,13159,10446 density 0.25446704826732675,0.20200340346534654
before tensor 147456 mask 28202.0 147456
layer2.2.conv2.weight, mask/weight parameters,28202,21681 density 0.30718121317082203,0.23615331830212724
before tensor 65536 mask 16396.0 65536
layer2.2.conv3.weight, mask/weight parameters,16396,12528 density 0.3170637376237624,0.2422648514851485
before tensor 65536 mask 13703.0 65536
layer2.3.conv1.weight, mask/weight parameters,13703,10177 density 0.2649868502475248,0.19680151608910892
before tensor 147456 mask 28059.0 147456
layer2.3.conv2.weight, mask/weight parameters,28059,20604 density 0.3056236316700977,0.22442244224422442
before tensor 65536 mask 14067.0 65536
layer2.3.conv3.weight, mask/weight parameters,14067,10722 density 0.2720258353960396,0.20734065594059406
before tensor 131072 mask 38213.0 131072
layer3.0.conv1.weight, mask/weight parameters,38213,28302 density 0.3807896205357143,0.28202726403061223
before tensor 589824 mask 117891.0 589824
layer3.0.conv2.weight, mask/weight parameters,117891,82171 density 0.3409777176176593,0.237664283400435
before tensor 262144 mask 83211.0 262144
layer3.0.conv3.weight, mask/weight parameters,83211,61201 density 0.41459562340561223,0.304931640625
layer3.0.shortcut.0.weight, mask/weight parameters,118557,84374 density 0.22612953186035156,0.16093063354492188
before tensor 262144 mask 43605.0 262144
layer3.1.conv1.weight, mask/weight parameters,43605,29462 density 0.21726024394132654,0.14679328762755103
before tensor 589824 mask 100672.0 589824
layer3.1.conv2.weight, mask/weight parameters,100672,69884 density 0.29117497339071685,0.20212642880281365
before tensor 262144 mask 66302.0 262144
layer3.1.conv3.weight, mask/weight parameters,66302,49301 density 0.33034717793367346,0.24564034598214285
before tensor 262144 mask 44543.0 262144
layer3.2.conv1.weight, mask/weight parameters,44543,29721 density 0.22193379304846939,0.14808374521683673
before tensor 589824 mask 90750.0 589824
layer3.2.conv2.weight, mask/weight parameters,90750,64151 density 0.26247743995557404,0.18554479614975242
before tensor 262144 mask 62955.0 262144
layer3.2.conv3.weight, mask/weight parameters,62955,45819 density 0.3136708785076531,0.22829141422193877
before tensor 262144 mask 44818.0 262144
layer3.3.conv1.weight, mask/weight parameters,44818,30196 density 0.2233039700255102,0.1504504145408163
before tensor 589824 mask 79628.0 589824
layer3.3.conv2.weight, mask/weight parameters,79628,51459 density 0.23030913045490306,0.14883555463001527
before tensor 262144 mask 54811.0 262144
layer3.3.conv3.weight, mask/weight parameters,54811,38070 density 0.27309371014030615,0.18968231823979592
before tensor 262144 mask 54005.0 262144
layer3.4.conv1.weight, mask/weight parameters,54005,33519 density 0.26907784598214285,0.16700713488520408
before tensor 589824 mask 87545.0 589824
layer3.4.conv2.weight, mask/weight parameters,87545,52688 density 0.25320757554722567,0.15239020778379378
before tensor 262144 mask 54414.0 262144
layer3.4.conv3.weight, mask/weight parameters,54414,36722 density 0.2711156728316326,0.18296595982142858
before tensor 262144 mask 52696.0 262144
layer3.5.conv1.weight, mask/weight parameters,52696,37746 density 0.26255580357142855,0.1880680006377551
before tensor 589824 mask 78662.0 589824
layer3.5.conv2.weight, mask/weight parameters,78662,52612 density 0.2275151557221528,0.15217039196631033
before tensor 262144 mask 48734.0 262144
layer3.5.conv3.weight, mask/weight parameters,48734,34868 density 0.24281529017857142,0.17372847576530612
before tensor 524288 mask 159140.0 524288
layer4.0.conv1.weight, mask/weight parameters,159140,116008 density 0.4047139485677083,0.2950236002604167
before tensor 2359296 mask 346830.0 2359296
layer4.0.conv2.weight, mask/weight parameters,346830,224352 density 0.26134349681712965,0.16905381944444445
before tensor 1048576 mask 161246.0 1048576
layer4.0.conv3.weight, mask/weight parameters,161246,110761 density 0.2050348917643229,0.14083989461263022
layer4.0.shortcut.0.weight, mask/weight parameters,218869,144092 density 0.10436487197875977,0.06870841979980469
before tensor 1048576 mask 149640.0 1048576
layer4.1.conv1.weight, mask/weight parameters,149640,107006 density 0.190277099609375,0.1360651652018229
before tensor 2359296 mask 334231.0 2359296
layer4.1.conv2.weight, mask/weight parameters,334231,232134 density 0.2518498926986883,0.17491771556712962
before tensor 1048576 mask 156331.0 1048576
layer4.1.conv3.weight, mask/weight parameters,156331,108531 density 0.19878514607747397,0.13800430297851562
before tensor 1048576 mask 58242.0 1048576
layer4.2.conv1.weight, mask/weight parameters,58242,34734 density 0.07405853271484375,0.04416656494140625
before tensor 2359296 mask 92869.0 2359296
layer4.2.conv2.weight, mask/weight parameters,92869,43103 density 0.06997869044174383,0.03247899184992284
before tensor 1048576 mask 57552.0 1048576
layer4.2.conv3.weight, mask/weight parameters,57552,33420 density 0.07318115234375,0.0424957275390625
classifier.weight, mask/weight parameters,115562,102566 density 0.564267578125,0.500810546875
Total Model parameters after dst: 3434875 2365205
Total parameters under density level of 0.1: 0.20738687615334847 0.14280358860578057 after dst
Death rate: 0.1452254248593737


Training summary: Average loss: 1.4243, Accuracy: 29712/50000 (59.424%)


Evaluation: Average loss: 1.7244, Accuracy: 5461/10000 (54.610%)

Current learning rate: 0.1. Time taken for epoch: 88.82 seconds.

Train Epoch: 26 [0/50000 (0%)]	Loss: 1.393959 Accuracy: 59/100 (59.000%
Train Epoch: 26 [10000/50000 (20%)]	Loss: 1.550893 Accuracy: 6127/10100 (60.663%
Train Epoch: 26 [20000/50000 (40%)]	Loss: 1.868718 Accuracy: 12027/20100 (59.836%
Train Epoch: 26 [30000/50000 (60%)]	Loss: 1.357809 Accuracy: 18019/30100 (59.864%
Train Epoch: 26 [40000/50000 (80%)]	Loss: 1.254667 Accuracy: 24027/40100 (59.918%
current layer rate 0.25131383705052346
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5776.0
Total filter_masks items: 13587220.0
5776.0 / 7552 channels
Total channels to prune: 121.92209740555336
Layer ('layer1', 0, 'conv1'): Pruned 1/52.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/52.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/52.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/52.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/52.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/52.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/101.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/101.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/196.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/196.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 8/384.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 8/384.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 8/384.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 8/384.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 8/384.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 8/384.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5658.0
Total filter_masks items: 13175831.0
After apply_mask:
Total filter_names items: 5658.0
Total filter_masks items: 13175831.0
Total pruned: 118/121.92209740555336 channels
===========done ===============

Training summary: Average loss: 1.4122, Accuracy: 30010/50000 (60.020%)


Evaluation: Average loss: 2.0842, Accuracy: 4531/10000 (45.310%)

Current learning rate: 0.1. Time taken for epoch: 88.58 seconds.

Train Epoch: 27 [0/50000 (0%)]	Loss: 1.213323 Accuracy: 64/100 (64.000%
Train Epoch: 27 [10000/50000 (20%)]	Loss: 1.626343 Accuracy: 6076/10100 (60.158%
Train Epoch: 27 [20000/50000 (40%)]	Loss: 1.250619 Accuracy: 11993/20100 (59.667%
Train Epoch: 27 [30000/50000 (60%)]	Loss: 1.421738 Accuracy: 17983/30100 (59.744%
Train Epoch: 27 [40000/50000 (80%)]	Loss: 1.419684 Accuracy: 23965/40100 (59.763%
current mest  death_rate 0.14449185885158072


dynamic sparse change prune
to kill 947060.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1322,1322 density 0.7650462962962963,0.7650462962962963
before tensor 4096 mask 942.0 4096
layer1.0.conv1.weight, mask/weight parameters,942,942 density 0.28860294117647056,0.28860294117647056
before tensor 36864 mask 4944.0 36864
layer1.0.conv2.weight, mask/weight parameters,4944,4944 density 0.21120082019736,0.21120082019736
before tensor 16384 mask 4457.0 16384
layer1.0.conv3.weight, mask/weight parameters,4457,4457 density 0.34137561274509803,0.34137561274509803
layer1.0.shortcut.0.weight, mask/weight parameters,6280,6280 density 0.38330078125,0.38330078125
before tensor 16384 mask 2371.0 16384
layer1.1.conv1.weight, mask/weight parameters,2371,2371 density 0.18160232843137256,0.18160232843137256
before tensor 36864 mask 3913.0 36864
layer1.1.conv2.weight, mask/weight parameters,3913,3913 density 0.16715793071041052,0.16715793071041052
before tensor 16384 mask 2671.0 16384
layer1.1.conv3.weight, mask/weight parameters,2671,2671 density 0.20458026960784315,0.20458026960784315
before tensor 16384 mask 2336.0 16384
layer1.2.conv1.weight, mask/weight parameters,2336,2336 density 0.17892156862745098,0.17892156862745098
before tensor 36864 mask 2390.0 36864
layer1.2.conv2.weight, mask/weight parameters,2390,2390 density 0.10209748387372378,0.10209748387372378
before tensor 16384 mask 1878.0 16384
layer1.2.conv3.weight, mask/weight parameters,1878,1878 density 0.14384191176470587,0.14384191176470587
before tensor 32768 mask 5192.0 32768
layer2.0.conv1.weight, mask/weight parameters,5192,5192 density 0.2048611111111111,0.2048611111111111
before tensor 147456 mask 13898.0 147456
layer2.0.conv2.weight, mask/weight parameters,13898,13898 density 0.1575576188370801,0.1575576188370801
before tensor 65536 mask 8843.0 65536
layer2.0.conv3.weight, mask/weight parameters,8843,8843 density 0.17445943813131312,0.17445943813131312
layer2.0.shortcut.0.weight, mask/weight parameters,28772,28772 density 0.219512939453125,0.219512939453125
before tensor 65536 mask 4981.0 65536
layer2.1.conv1.weight, mask/weight parameters,4981,4981 density 0.0982678345959596,0.0982678345959596
before tensor 147456 mask 7384.0 147456
layer2.1.conv2.weight, mask/weight parameters,7384,7384 density 0.08371027899647428,0.08371027899647428
before tensor 65536 mask 5530.0 65536
layer2.1.conv3.weight, mask/weight parameters,5530,5530 density 0.10909880050505051,0.10909880050505051
before tensor 65536 mask 9895.0 65536
layer2.2.conv1.weight, mask/weight parameters,9895,9895 density 0.19521385732323232,0.19521385732323232
before tensor 147456 mask 20584.0 147456
layer2.2.conv2.weight, mask/weight parameters,20584,20584 density 0.2333548730855128,0.2333548730855128
before tensor 65536 mask 11999.0 65536
layer2.2.conv3.weight, mask/weight parameters,11999,11999 density 0.23672269570707072,0.23672269570707072
before tensor 65536 mask 9904.0 65536
layer2.3.conv1.weight, mask/weight parameters,9904,9904 density 0.19539141414141414,0.19539141414141414
before tensor 147456 mask 20139.0 147456
layer2.3.conv2.weight, mask/weight parameters,20139,20139 density 0.22831003639084446,0.22831003639084446
before tensor 65536 mask 10388.0 65536
layer2.3.conv3.weight, mask/weight parameters,10388,10388 density 0.20494002525252525,0.20494002525252525
before tensor 131072 mask 28177.0 131072
layer3.0.conv1.weight, mask/weight parameters,28177,28177 density 0.2866312662760417,0.2866312662760417
before tensor 589824 mask 82571.0 589824
layer3.0.conv2.weight, mask/weight parameters,82571,82571 density 0.24887574749228394,0.24887574749228394
before tensor 262144 mask 62332.0 262144
layer3.0.conv3.weight, mask/weight parameters,62332,62332 density 0.3170369466145833,0.3170369466145833
layer3.0.shortcut.0.weight, mask/weight parameters,84470,84470 density 0.16111373901367188,0.16111373901367188
before tensor 262144 mask 29921.0 262144
layer3.1.conv1.weight, mask/weight parameters,29921,29921 density 0.15218607584635416,0.15218607584635416
before tensor 589824 mask 67785.0 589824
layer3.1.conv2.weight, mask/weight parameters,67785,67785 density 0.20430953414351852,0.20430953414351852
before tensor 262144 mask 48219.0 262144
layer3.1.conv3.weight, mask/weight parameters,48219,48219 density 0.2452545166015625,0.2452545166015625
before tensor 262144 mask 30551.0 262144
layer3.2.conv1.weight, mask/weight parameters,30551,30551 density 0.15539042154947916,0.15539042154947916
before tensor 589824 mask 62146.0 589824
layer3.2.conv2.weight, mask/weight parameters,62146,62146 density 0.18731312692901234,0.18731312692901234
before tensor 262144 mask 45610.0 262144
layer3.2.conv3.weight, mask/weight parameters,45610,45610 density 0.23198445638020834,0.23198445638020834
before tensor 262144 mask 30335.0 262144
layer3.3.conv1.weight, mask/weight parameters,30335,30335 density 0.15429178873697916,0.15429178873697916
before tensor 589824 mask 52623.0 589824
layer3.3.conv2.weight, mask/weight parameters,52623,52623 density 0.15861002604166666,0.15861002604166666
before tensor 262144 mask 38410.0 262144
layer3.3.conv3.weight, mask/weight parameters,38410,38410 density 0.19536336263020834,0.19536336263020834
before tensor 262144 mask 35364.0 262144
layer3.4.conv1.weight, mask/weight parameters,35364,35364 density 0.17987060546875,0.17987060546875
before tensor 589824 mask 55481.0 589824
layer3.4.conv2.weight, mask/weight parameters,55481,55481 density 0.1672242717978395,0.1672242717978395
before tensor 262144 mask 37369.0 262144
layer3.4.conv3.weight, mask/weight parameters,37369,37369 density 0.19006856282552084,0.19006856282552084
before tensor 262144 mask 37438.0 262144
layer3.5.conv1.weight, mask/weight parameters,37438,37438 density 0.19041951497395834,0.19041951497395834
before tensor 589824 mask 53062.0 589824
layer3.5.conv2.weight, mask/weight parameters,53062,53062 density 0.15993320794753085,0.15993320794753085
before tensor 262144 mask 34156.0 262144
layer3.5.conv3.weight, mask/weight parameters,34156,34156 density 0.17372639973958334,0.17372639973958334
before tensor 524288 mask 118787.0 524288
layer4.0.conv1.weight, mask/weight parameters,118787,118787 density 0.30851843001994683,0.30851843001994683
before tensor 2359296 mask 229874.0 2359296
layer4.0.conv2.weight, mask/weight parameters,229874,229874 density 0.18066401337960866,0.18066401337960866
before tensor 1048576 mask 109876.0 1048576
layer4.0.conv3.weight, mask/weight parameters,109876,109876 density 0.14268720910904256,0.14268720910904256
layer4.0.shortcut.0.weight, mask/weight parameters,141535,141535 density 0.0674891471862793,0.0674891471862793
before tensor 1048576 mask 106792.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106792,106792 density 0.13868226396276595,0.13868226396276595
before tensor 2359296 mask 230945.0 2359296
layer4.1.conv2.weight, mask/weight parameters,230945,230945 density 0.1815057404054122,0.1815057404054122
before tensor 1048576 mask 106038.0 1048576
layer4.1.conv3.weight, mask/weight parameters,106038,106038 density 0.13770310422207446,0.13770310422207446
before tensor 1048576 mask 35508.0 1048576
layer4.2.conv1.weight, mask/weight parameters,35508,35508 density 0.04611141123670213,0.04611141123670213
before tensor 2359296 mask 44139.0 2359296
layer4.2.conv2.weight, mask/weight parameters,44139,44139 density 0.03468999924551079,0.03468999924551079
before tensor 1048576 mask 32524.0 1048576
layer4.2.conv3.weight, mask/weight parameters,32524,32524 density 0.042236328125,0.042236328125
classifier.weight, mask/weight parameters,102154,102154 density 0.498798828125,0.498798828125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.14644094220541995 0.14644094220541995 after dst
Death rate: 0.14449185885158072

dynamic sparse change grow
self.total_params*pruning_rate 3417526.0692970706
self.total_nonzero 2365205.0
to grow 1052321.0692970706
len(all_scores) 16151255 13556639
increse 1052321.0 before_mask 3417525.0 after_mask 3417525.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1436,1322 density 0.8310185185185185,0.7650462962962963
before tensor 4096 mask 1125.0 4096
layer1.0.conv1.weight, mask/weight parameters,1125,942 density 0.3446691176470588,0.28860294117647056
before tensor 36864 mask 6131.0 36864
layer1.0.conv2.weight, mask/weight parameters,6131,4944 density 0.26190781323422613,0.21120082019736
before tensor 16384 mask 5507.0 16384
layer1.0.conv3.weight, mask/weight parameters,5507,4457 density 0.4217984068627451,0.34137561274509803
layer1.0.shortcut.0.weight, mask/weight parameters,7881,6280 density 0.48101806640625,0.38330078125
before tensor 16384 mask 3604.0 16384
layer1.1.conv1.weight, mask/weight parameters,3604,2371 density 0.2760416666666667,0.18160232843137256
before tensor 36864 mask 4816.0 36864
layer1.1.conv2.weight, mask/weight parameters,4816,3913 density 0.20573283779742835,0.16715793071041052
before tensor 16384 mask 3511.0 16384
layer1.1.conv3.weight, mask/weight parameters,3511,2671 density 0.2689185049019608,0.20458026960784315
before tensor 16384 mask 3404.0 16384
layer1.2.conv1.weight, mask/weight parameters,3404,2336 density 0.2607230392156863,0.17892156862745098
before tensor 36864 mask 3304.0 36864
layer1.2.conv2.weight, mask/weight parameters,3304,2390 density 0.14114229569823572,0.10209748387372378
before tensor 16384 mask 2472.0 16384
layer1.2.conv3.weight, mask/weight parameters,2472,1878 density 0.18933823529411764,0.14384191176470587
before tensor 32768 mask 8056.0 32768
layer2.0.conv1.weight, mask/weight parameters,8056,5192 density 0.3178661616161616,0.2048611111111111
before tensor 147456 mask 18964.0 147456
layer2.0.conv2.weight, mask/weight parameters,18964,13898 density 0.21498940017458537,0.1575576188370801
before tensor 65536 mask 11593.0 65536
layer2.0.conv3.weight, mask/weight parameters,11593,8843 density 0.22871291035353536,0.17445943813131312
layer2.0.shortcut.0.weight, mask/weight parameters,40697,28772 density 0.31049346923828125,0.219512939453125
before tensor 65536 mask 7234.0 65536
layer2.1.conv1.weight, mask/weight parameters,7234,4981 density 0.14271622474747475,0.0982678345959596
before tensor 147456 mask 11748.0 147456
layer2.1.conv2.weight, mask/weight parameters,11748,7384 density 0.1331836887392443,0.08371027899647428
before tensor 65536 mask 9053.0 65536
layer2.1.conv3.weight, mask/weight parameters,9053,5530 density 0.17860243055555555,0.10909880050505051
before tensor 65536 mask 13614.0 65536
layer2.2.conv1.weight, mask/weight parameters,13614,9895 density 0.2685842803030303,0.19521385732323232
before tensor 147456 mask 28023.0 147456
layer2.2.conv2.weight, mask/weight parameters,28023,20584 density 0.3176886712240248,0.2333548730855128
before tensor 65536 mask 16590.0 65536
layer2.2.conv3.weight, mask/weight parameters,16590,11999 density 0.3272964015151515,0.23672269570707072
before tensor 65536 mask 13499.0 65536
layer2.3.conv1.weight, mask/weight parameters,13499,9904 density 0.26631549873737376,0.19539141414141414
before tensor 147456 mask 26775.0 147456
layer2.3.conv2.weight, mask/weight parameters,26775,20139 density 0.30354045505560656,0.22831003639084446
before tensor 65536 mask 14769.0 65536
layer2.3.conv3.weight, mask/weight parameters,14769,10388 density 0.29137073863636365,0.20494002525252525
before tensor 131072 mask 39321.0 131072
layer3.0.conv1.weight, mask/weight parameters,39321,28177 density 0.399993896484375,0.2866312662760417
before tensor 589824 mask 114357.0 589824
layer3.0.conv2.weight, mask/weight parameters,114357,82571 density 0.34468135127314814,0.24887574749228394
before tensor 262144 mask 83081.0 262144
layer3.0.conv3.weight, mask/weight parameters,83081,62332 density 0.4225718180338542,0.3170369466145833
layer3.0.shortcut.0.weight, mask/weight parameters,124903,84470 density 0.2382335662841797,0.16111373901367188
before tensor 262144 mask 41737.0 262144
layer3.1.conv1.weight, mask/weight parameters,41737,29921 density 0.21228535970052084,0.15218607584635416
before tensor 589824 mask 104040.0 589824
layer3.1.conv2.weight, mask/weight parameters,104040,67785 density 0.3135850694444444,0.20430953414351852
before tensor 262144 mask 67144.0 262144
layer3.1.conv3.weight, mask/weight parameters,67144,48219 density 0.3415120442708333,0.2452545166015625
before tensor 262144 mask 44705.0 262144
layer3.2.conv1.weight, mask/weight parameters,44705,30551 density 0.22738138834635416,0.15539042154947916
before tensor 589824 mask 95690.0 589824
layer3.2.conv2.weight, mask/weight parameters,95690,62146 density 0.28841748649691357,0.18731312692901234
before tensor 262144 mask 65512.0 262144
layer3.2.conv3.weight, mask/weight parameters,65512,45610 density 0.3332112630208333,0.23198445638020834
before tensor 262144 mask 43149.0 262144
layer3.3.conv1.weight, mask/weight parameters,43149,30335 density 0.2194671630859375,0.15429178873697916
before tensor 589824 mask 73041.0 589824
layer3.3.conv2.weight, mask/weight parameters,73041,52623 density 0.2201515480324074,0.15861002604166666
before tensor 262144 mask 54184.0 262144
layer3.3.conv3.weight, mask/weight parameters,54184,38410 density 0.2755940755208333,0.19536336263020834
before tensor 262144 mask 46969.0 262144
layer3.4.conv1.weight, mask/weight parameters,46969,35364 density 0.23889668782552084,0.17987060546875
before tensor 589824 mask 76850.0 589824
layer3.4.conv2.weight, mask/weight parameters,76850,55481 density 0.23163218557098766,0.1672242717978395
before tensor 262144 mask 52157.0 262144
layer3.4.conv3.weight, mask/weight parameters,52157,37369 density 0.2652842203776042,0.19006856282552084
before tensor 262144 mask 52839.0 262144
layer3.5.conv1.weight, mask/weight parameters,52839,37438 density 0.2687530517578125,0.19041951497395834
before tensor 589824 mask 72094.0 589824
layer3.5.conv2.weight, mask/weight parameters,72094,53062 density 0.2172972125771605,0.15993320794753085
before tensor 262144 mask 48747.0 262144
layer3.5.conv3.weight, mask/weight parameters,48747,34156 density 0.2479400634765625,0.17372639973958334
before tensor 524288 mask 161318.0 524288
layer4.0.conv1.weight, mask/weight parameters,161318,118787 density 0.4189816738696808,0.30851843001994683
before tensor 2359296 mask 341705.0 2359296
layer4.0.conv2.weight, mask/weight parameters,341705,229874 density 0.26855493310195666,0.18066401337960866
before tensor 1048576 mask 165538.0 1048576
layer4.0.conv3.weight, mask/weight parameters,165538,109876 density 0.21497101479388298,0.14268720910904256
layer4.0.shortcut.0.weight, mask/weight parameters,237216,141535 density 0.1131134033203125,0.0674891471862793
before tensor 1048576 mask 153464.0 1048576
layer4.1.conv1.weight, mask/weight parameters,153464,106792 density 0.1992914727393617,0.13868226396276595
before tensor 2359296 mask 331094.0 2359296
layer4.1.conv2.weight, mask/weight parameters,331094,230945 density 0.26021546954378555,0.1815057404054122
before tensor 1048576 mask 156244.0 1048576
layer4.1.conv3.weight, mask/weight parameters,156244,106038 density 0.20290163730053193,0.13770310422207446
before tensor 1048576 mask 56287.0 1048576
layer4.2.conv1.weight, mask/weight parameters,56287,35508 density 0.07309544340093085,0.04611141123670213
before tensor 2359296 mask 81620.0 2359296
layer4.2.conv2.weight, mask/weight parameters,81620,44139 density 0.06414730144358936,0.03468999924551079
before tensor 1048576 mask 52989.0 1048576
layer4.2.conv3.weight, mask/weight parameters,52989,32524 density 0.06881259350066489,0.042236328125
classifier.weight, mask/weight parameters,115724,102154 density 0.56505859375,0.498798828125
Total Model parameters after dst: 3417525 2365205
Total parameters under density level of 0.1: 0.2115950122761358 0.14644094220541995 after dst
Death rate: 0.14449185885158072


Training summary: Average loss: 1.4109, Accuracy: 29955/50000 (59.910%)


Evaluation: Average loss: 1.6969, Accuracy: 5408/10000 (54.080%)

Current learning rate: 0.1. Time taken for epoch: 88.78 seconds.

Train Epoch: 28 [0/50000 (0%)]	Loss: 1.253812 Accuracy: 61/100 (61.000%
Train Epoch: 28 [10000/50000 (20%)]	Loss: 1.209847 Accuracy: 6200/10100 (61.386%
Train Epoch: 28 [20000/50000 (40%)]	Loss: 1.407354 Accuracy: 12190/20100 (60.647%
Train Epoch: 28 [30000/50000 (60%)]	Loss: 1.717509 Accuracy: 18179/30100 (60.395%
Train Epoch: 28 [40000/50000 (80%)]	Loss: 1.408792 Accuracy: 24184/40100 (60.309%
current layer rate 0.2655209376422394
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5658.0
Total filter_masks items: 13175831.0
5658.0 / 7552 channels
Total channels to prune: 111.21412107419201
Layer ('layer1', 0, 'conv1'): Pruned 1/51.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/51.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/51.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/51.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/51.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/51.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/99.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/99.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/192.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/192.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 7/376.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 7/376.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 7/376.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 7/376.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 7/376.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 7/376.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5566.0
Total filter_masks items: 12844125.0
After apply_mask:
Total filter_names items: 5566.0
Total filter_masks items: 12844125.0
Total pruned: 92/111.21412107419201 channels
===========done ===============

Training summary: Average loss: 1.3980, Accuracy: 30083/50000 (60.166%)


Evaluation: Average loss: 1.9623, Accuracy: 4890/10000 (48.900%)

Current learning rate: 0.1. Time taken for epoch: 88.60 seconds.

Train Epoch: 29 [0/50000 (0%)]	Loss: 1.448145 Accuracy: 59/100 (59.000%
Train Epoch: 29 [10000/50000 (20%)]	Loss: 1.331767 Accuracy: 6243/10100 (61.812%
Train Epoch: 29 [20000/50000 (40%)]	Loss: 1.557197 Accuracy: 12229/20100 (60.841%
Train Epoch: 29 [30000/50000 (60%)]	Loss: 1.319366 Accuracy: 18189/30100 (60.429%
Train Epoch: 29 [40000/50000 (80%)]	Loss: 1.153658 Accuracy: 24263/40100 (60.506%
current mest  death_rate 0.14371276870427754


dynamic sparse change prune
to kill 954191.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1336,1336 density 0.7731481481481481,0.7731481481481481
before tensor 4096 mask 899.0 4096
layer1.0.conv1.weight, mask/weight parameters,899,899 density 0.2809375,0.2809375
before tensor 36864 mask 4623.0 36864
layer1.0.conv2.weight, mask/weight parameters,4623,4623 density 0.20546666666666666,0.20546666666666666
before tensor 16384 mask 4316.0 16384
layer1.0.conv3.weight, mask/weight parameters,4316,4316 density 0.3371875,0.3371875
layer1.0.shortcut.0.weight, mask/weight parameters,6384,6384 density 0.3896484375,0.3896484375
before tensor 16384 mask 2409.0 16384
layer1.1.conv1.weight, mask/weight parameters,2409,2409 density 0.188203125,0.188203125
before tensor 36864 mask 3591.0 36864
layer1.1.conv2.weight, mask/weight parameters,3591,3591 density 0.1596,0.1596
before tensor 16384 mask 2612.0 16384
layer1.1.conv3.weight, mask/weight parameters,2612,2612 density 0.2040625,0.2040625
before tensor 16384 mask 2261.0 16384
layer1.2.conv1.weight, mask/weight parameters,2261,2261 density 0.176640625,0.176640625
before tensor 36864 mask 2388.0 36864
layer1.2.conv2.weight, mask/weight parameters,2388,2388 density 0.10613333333333333,0.10613333333333333
before tensor 16384 mask 1828.0 16384
layer1.2.conv3.weight, mask/weight parameters,1828,1828 density 0.1428125,0.1428125
before tensor 32768 mask 5386.0 32768
layer2.0.conv1.weight, mask/weight parameters,5386,5386 density 0.2146843112244898,0.2146843112244898
before tensor 147456 mask 13926.0 147456
layer2.0.conv2.weight, mask/weight parameters,13926,13926 density 0.16111342496182146,0.16111342496182146
before tensor 65536 mask 8610.0 65536
layer2.0.conv3.weight, mask/weight parameters,8610,8610 density 0.17159598214285715,0.17159598214285715
layer2.0.shortcut.0.weight, mask/weight parameters,29253,29253 density 0.22318267822265625,0.22318267822265625
before tensor 65536 mask 4926.0 65536
layer2.1.conv1.weight, mask/weight parameters,4926,4926 density 0.09817442602040816,0.09817442602040816
before tensor 147456 mask 7811.0 147456
layer2.1.conv2.weight, mask/weight parameters,7811,7811 density 0.09036743949280393,0.09036743949280393
before tensor 65536 mask 5675.0 65536
layer2.1.conv3.weight, mask/weight parameters,5675,5675 density 0.11310188137755102,0.11310188137755102
before tensor 65536 mask 10136.0 65536
layer2.2.conv1.weight, mask/weight parameters,10136,10136 density 0.20200892857142858,0.20200892857142858
before tensor 147456 mask 20916.0 147456
layer2.2.conv2.weight, mask/weight parameters,20916,20916 density 0.24198250728862974,0.24198250728862974
before tensor 65536 mask 11956.0 65536
layer2.2.conv3.weight, mask/weight parameters,11956,11956 density 0.23828125,0.23828125
before tensor 65536 mask 9880.0 65536
layer2.3.conv1.weight, mask/weight parameters,9880,9880 density 0.19690688775510204,0.19690688775510204
before tensor 147456 mask 20227.0 147456
layer2.3.conv2.weight, mask/weight parameters,20227,20227 density 0.23401129159146652,0.23401129159146652
before tensor 65536 mask 10740.0 65536
layer2.3.conv3.weight, mask/weight parameters,10740,10740 density 0.21404655612244897,0.21404655612244897
before tensor 131072 mask 28861.0 131072
layer3.0.conv1.weight, mask/weight parameters,28861,28861 density 0.2982494212962963,0.2982494212962963
before tensor 589824 mask 81476.0 589824
layer3.0.conv2.weight, mask/weight parameters,81476,81476 density 0.2534332434391223,0.2534332434391223
before tensor 262144 mask 62460.0 262144
layer3.0.conv3.weight, mask/weight parameters,62460,62460 density 0.32273065476190477,0.32273065476190477
layer3.0.shortcut.0.weight, mask/weight parameters,86040,86040 density 0.1641082763671875,0.1641082763671875
before tensor 262144 mask 29354.0 262144
layer3.1.conv1.weight, mask/weight parameters,29354,29354 density 0.15167204034391535,0.15167204034391535
before tensor 589824 mask 68974.0 589824
layer3.1.conv2.weight, mask/weight parameters,68974,68974 density 0.2145454432344497,0.2145454432344497
before tensor 262144 mask 48443.0 262144
layer3.1.conv3.weight, mask/weight parameters,48443,48443 density 0.25030485284391535,0.25030485284391535
before tensor 262144 mask 30515.0 262144
layer3.2.conv1.weight, mask/weight parameters,30515,30515 density 0.15767092427248677,0.15767092427248677
before tensor 589824 mask 65036.0 589824
layer3.2.conv2.weight, mask/weight parameters,65036,65036 density 0.202296190538401,0.202296190538401
before tensor 262144 mask 46632.0 262144
layer3.2.conv3.weight, mask/weight parameters,46632,46632 density 0.24094742063492064,0.24094742063492064
before tensor 262144 mask 29931.0 262144
layer3.3.conv1.weight, mask/weight parameters,29931,29931 density 0.15465339781746032,0.15465339781746032
before tensor 589824 mask 50573.0 589824
layer3.3.conv2.weight, mask/weight parameters,50573,50573 density 0.1573086481963613,0.1573086481963613
before tensor 262144 mask 38238.0 262144
layer3.3.conv3.weight, mask/weight parameters,38238,38238 density 0.19757564484126985,0.19757564484126985
before tensor 262144 mask 32886.0 262144
layer3.4.conv1.weight, mask/weight parameters,32886,32886 density 0.169921875,0.169921875
before tensor 589824 mask 52461.0 589824
layer3.4.conv2.weight, mask/weight parameters,52461,52461 density 0.16318132191148063,0.16318132191148063
before tensor 262144 mask 36372.0 262144
layer3.4.conv3.weight, mask/weight parameters,36372,36372 density 0.1879340277777778,0.1879340277777778
before tensor 262144 mask 37533.0 262144
layer3.5.conv1.weight, mask/weight parameters,37533,37533 density 0.19393291170634921,0.19393291170634921
before tensor 589824 mask 51176.0 589824
layer3.5.conv2.weight, mask/weight parameters,51176,51176 density 0.1591842955746542,0.1591842955746542
before tensor 262144 mask 34607.0 262144
layer3.5.conv3.weight, mask/weight parameters,34607,34607 density 0.17881427744708994,0.17881427744708994
before tensor 524288 mask 120258.0 524288
layer4.0.conv1.weight, mask/weight parameters,120258,120258 density 0.3182641006097561,0.3182641006097561
before tensor 2359296 mask 230422.0 2359296
layer4.0.conv2.weight, mask/weight parameters,230422,230422 density 0.18803067283909816,0.18803067283909816
before tensor 1048576 mask 111714.0 1048576
layer4.0.conv3.weight, mask/weight parameters,111714,111714 density 0.14782615599593496,0.14782615599593496
layer4.0.shortcut.0.weight, mask/weight parameters,146305,146305 density 0.0697636604309082,0.0697636604309082
before tensor 1048576 mask 107920.0 1048576
layer4.1.conv1.weight, mask/weight parameters,107920,107920 density 0.14280572493224933,0.14280572493224933
before tensor 2359296 mask 229104.0 2359296
layer4.1.conv2.weight, mask/weight parameters,229104,229104 density 0.18695514868427818,0.18695514868427818
before tensor 1048576 mask 104848.0 1048576
layer4.1.conv3.weight, mask/weight parameters,104848,104848 density 0.13874068428184283,0.13874068428184283
before tensor 1048576 mask 35231.0 1048576
layer4.2.conv1.weight, mask/weight parameters,35231,35231 density 0.04661961170392954,0.04661961170392954
before tensor 2359296 mask 42502.0 2359296
layer4.2.conv2.weight, mask/weight parameters,42502,42502 density 0.034682797896934105,0.034682797896934105
before tensor 1048576 mask 31413.0 1048576
layer4.2.conv3.weight, mask/weight parameters,31413,31413 density 0.0415674225101626,0.0415674225101626
classifier.weight, mask/weight parameters,101831,101831 density 0.4972216796875,0.4972216796875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.14951153158664637 0.14951153158664637 after dst
Death rate: 0.14371276870427754

dynamic sparse change grow
self.total_params*pruning_rate 3399099.004202171
self.total_nonzero 2365205.0
to grow 1033894.0042021712
len(all_scores) 15819549 13188635
increse 1033894.0 before_mask 3399098.0 after_mask 3399098.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1434,1336 density 0.8298611111111112,0.7731481481481481
before tensor 4096 mask 1096.0 4096
layer1.0.conv1.weight, mask/weight parameters,1096,899 density 0.3425,0.2809375
before tensor 36864 mask 6005.0 36864
layer1.0.conv2.weight, mask/weight parameters,6005,4623 density 0.2668888888888889,0.20546666666666666
before tensor 16384 mask 5098.0 16384
layer1.0.conv3.weight, mask/weight parameters,5098,4316 density 0.39828125,0.3371875
layer1.0.shortcut.0.weight, mask/weight parameters,7571,6384 density 0.46209716796875,0.3896484375
before tensor 16384 mask 3280.0 16384
layer1.1.conv1.weight, mask/weight parameters,3280,2409 density 0.25625,0.188203125
before tensor 36864 mask 4936.0 36864
layer1.1.conv2.weight, mask/weight parameters,4936,3591 density 0.21937777777777778,0.1596
before tensor 16384 mask 3385.0 16384
layer1.1.conv3.weight, mask/weight parameters,3385,2612 density 0.264453125,0.2040625
before tensor 16384 mask 3118.0 16384
layer1.2.conv1.weight, mask/weight parameters,3118,2261 density 0.24359375,0.176640625
before tensor 36864 mask 3508.0 36864
layer1.2.conv2.weight, mask/weight parameters,3508,2388 density 0.1559111111111111,0.10613333333333333
before tensor 16384 mask 2378.0 16384
layer1.2.conv3.weight, mask/weight parameters,2378,1828 density 0.18578125,0.1428125
before tensor 32768 mask 7395.0 32768
layer2.0.conv1.weight, mask/weight parameters,7395,5386 density 0.2947624362244898,0.2146843112244898
before tensor 147456 mask 18073.0 147456
layer2.0.conv2.weight, mask/weight parameters,18073,13926 density 0.20909111944097367,0.16111342496182146
before tensor 65536 mask 11424.0 65536
layer2.0.conv3.weight, mask/weight parameters,11424,8610 density 0.22767857142857142,0.17159598214285715
layer2.0.shortcut.0.weight, mask/weight parameters,38051,29253 density 0.29030609130859375,0.22318267822265625
before tensor 65536 mask 7332.0 65536
layer2.1.conv1.weight, mask/weight parameters,7332,4926 density 0.14612563775510204,0.09817442602040816
before tensor 147456 mask 10583.0 147456
layer2.1.conv2.weight, mask/weight parameters,10583,7811 density 0.12243741033828498,0.09036743949280393
before tensor 65536 mask 7290.0 65536
layer2.1.conv3.weight, mask/weight parameters,7290,5675 density 0.14528858418367346,0.11310188137755102
before tensor 65536 mask 14030.0 65536
layer2.2.conv1.weight, mask/weight parameters,14030,10136 density 0.2796157525510204,0.20200892857142858
before tensor 147456 mask 29174.0 147456
layer2.2.conv2.weight, mask/weight parameters,29174,20916 density 0.33752140311907075,0.24198250728862974
before tensor 65536 mask 16189.0 65536
layer2.2.conv3.weight, mask/weight parameters,16189,11956 density 0.32264429209183676,0.23828125
before tensor 65536 mask 13447.0 65536
layer2.3.conv1.weight, mask/weight parameters,13447,9880 density 0.2679966517857143,0.19690688775510204
before tensor 147456 mask 27411.0 147456
layer2.3.conv2.weight, mask/weight parameters,27411,20227 density 0.3171248091073164,0.23401129159146652
before tensor 65536 mask 14655.0 65536
layer2.3.conv3.weight, mask/weight parameters,14655,10740 density 0.2920719068877551,0.21404655612244897
before tensor 131072 mask 38728.0 131072
layer3.0.conv1.weight, mask/weight parameters,38728,28861 density 0.4002149470899471,0.2982494212962963
before tensor 589824 mask 116546.0 589824
layer3.0.conv2.weight, mask/weight parameters,116546,81476 density 0.36251940190799686,0.2534332434391223
before tensor 262144 mask 83143.0 262144
layer3.0.conv3.weight, mask/weight parameters,83143,62460 density 0.42959966104497355,0.32273065476190477
layer3.0.shortcut.0.weight, mask/weight parameters,121866,86040 density 0.23244094848632812,0.1641082763671875
before tensor 262144 mask 40564.0 262144
layer3.1.conv1.weight, mask/weight parameters,40564,29354 density 0.2095940806878307,0.15167204034391535
before tensor 589824 mask 100789.0 589824
layer3.1.conv2.weight, mask/weight parameters,100789,68974 density 0.3135068384921413,0.2145454432344497
before tensor 262144 mask 66994.0 262144
layer3.1.conv3.weight, mask/weight parameters,66994,48443 density 0.34615782076719576,0.25030485284391535
before tensor 262144 mask 45837.0 262144
layer3.2.conv1.weight, mask/weight parameters,45837,30515 density 0.23683965773809523,0.15767092427248677
before tensor 589824 mask 89849.0 589824
layer3.2.conv2.weight, mask/weight parameters,89849,65036 density 0.27947768041830356,0.202296190538401
before tensor 262144 mask 62542.0 262144
layer3.2.conv3.weight, mask/weight parameters,62542,46632 density 0.32315434854497355,0.24094742063492064
before tensor 262144 mask 45679.0 262144
layer3.3.conv1.weight, mask/weight parameters,45679,29931 density 0.23602327215608465,0.15465339781746032
before tensor 589824 mask 76487.0 589824
layer3.3.conv2.weight, mask/weight parameters,76487,50573 density 0.23791482756797278,0.1573086481963613
before tensor 262144 mask 54089.0 262144
layer3.3.conv3.weight, mask/weight parameters,54089,38238 density 0.2794777199074074,0.19757564484126985
before tensor 262144 mask 50427.0 262144
layer3.4.conv1.weight, mask/weight parameters,50427,32886 density 0.2605561755952381,0.169921875
before tensor 589824 mask 77678.0 589824
layer3.4.conv2.weight, mask/weight parameters,77678,52461 density 0.24161946442957613,0.16318132191148063
before tensor 262144 mask 51816.0 262144
layer3.4.conv3.weight, mask/weight parameters,51816,36372 density 0.26773313492063494,0.1879340277777778
before tensor 262144 mask 56996.0 262144
layer3.5.conv1.weight, mask/weight parameters,56996,37533 density 0.2944981812169312,0.19393291170634921
before tensor 589824 mask 78109.0 589824
layer3.5.conv2.weight, mask/weight parameters,78109,51176 density 0.24296010127873738,0.1591842955746542
before tensor 262144 mask 49618.0 262144
layer3.5.conv3.weight, mask/weight parameters,49618,34607 density 0.2563760747354497,0.17881427744708994
before tensor 524288 mask 159459.0 524288
layer4.0.conv1.weight, mask/weight parameters,159459,120258 density 0.4220099720528455,0.3182641006097561
before tensor 2359296 mask 340426.0 2359296
layer4.0.conv2.weight, mask/weight parameters,340426,230422 density 0.27779695442241986,0.18803067283909816
before tensor 1048576 mask 164199.0 1048576
layer4.0.conv3.weight, mask/weight parameters,164199,111714 density 0.21727721671747968,0.14782615599593496
layer4.0.shortcut.0.weight, mask/weight parameters,222197,146305 density 0.10595178604125977,0.0697636604309082
before tensor 1048576 mask 151727.0 1048576
layer4.1.conv1.weight, mask/weight parameters,151727,107920 density 0.2007735751185637,0.14280572493224933
before tensor 2359296 mask 327640.0 2359296
layer4.1.conv2.weight, mask/weight parameters,327640,229104 density 0.2673632276822618,0.18695514868427818
before tensor 1048576 mask 151708.0 1048576
layer4.1.conv3.weight, mask/weight parameters,151708,104848 density 0.20074843326558264,0.13874068428184283
before tensor 1048576 mask 61205.0 1048576
layer4.2.conv1.weight, mask/weight parameters,61205,35231 density 0.08098984798441734,0.04661961170392954
before tensor 2359296 mask 87239.0 2359296
layer4.2.conv2.weight, mask/weight parameters,87239,42502 density 0.07118941710344535,0.034682797896934105
before tensor 1048576 mask 55061.0 1048576
layer4.2.conv3.weight, mask/weight parameters,55061,31413 density 0.07285976668360433,0.0415674225101626
classifier.weight, mask/weight parameters,113617,101831 density 0.5547705078125,0.4972216796875
Total Model parameters after dst: 3399098 2365205
Total parameters under density level of 0.1: 0.21486693457569492 0.14951153158664637 after dst
Death rate: 0.14371276870427754


Training summary: Average loss: 1.3841, Accuracy: 30178/50000 (60.356%)


Evaluation: Average loss: 1.6014, Accuracy: 5664/10000 (56.640%)

Current learning rate: 0.1. Time taken for epoch: 88.75 seconds.

Train Epoch: 30 [0/50000 (0%)]	Loss: 1.315417 Accuracy: 63/100 (63.000%
Train Epoch: 30 [10000/50000 (20%)]	Loss: 1.463282 Accuracy: 6239/10100 (61.772%
Train Epoch: 30 [20000/50000 (40%)]	Loss: 1.320192 Accuracy: 12303/20100 (61.209%
Train Epoch: 30 [30000/50000 (60%)]	Loss: 1.404398 Accuracy: 18329/30100 (60.894%
Train Epoch: 30 [40000/50000 (80%)]	Loss: 1.134570 Accuracy: 24305/40100 (60.611%
current layer rate 0.27917637687756036
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5566.0
Total filter_masks items: 12844125.0
5566.0 / 7552 channels
Total channels to prune: 122.33999817933545
Layer ('layer1', 0, 'conv1'): Pruned 1/50.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/50.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/50.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/50.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/50.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/50.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/98.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/98.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/189.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/189.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 8/369.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 8/369.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 8/369.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 8/369.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 8/369.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 8/369.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5448.0
Total filter_masks items: 12442780.0
After apply_mask:
Total filter_names items: 5448.0
Total filter_masks items: 12442780.0
Total pruned: 118/122.33999817933545 channels
===========done ===============

Training summary: Average loss: 1.3792, Accuracy: 30337/50000 (60.674%)


Evaluation: Average loss: 1.9001, Accuracy: 4989/10000 (49.890%)

Current learning rate: 0.1. Time taken for epoch: 88.59 seconds.

Train Epoch: 31 [0/50000 (0%)]	Loss: 1.065464 Accuracy: 70/100 (70.000%
Train Epoch: 31 [10000/50000 (20%)]	Loss: 1.441419 Accuracy: 6240/10100 (61.782%
Train Epoch: 31 [20000/50000 (40%)]	Loss: 1.394883 Accuracy: 12298/20100 (61.184%
Train Epoch: 31 [30000/50000 (60%)]	Loss: 1.428255 Accuracy: 18415/30100 (61.179%
Train Epoch: 31 [40000/50000 (80%)]	Loss: 1.286352 Accuracy: 24470/40100 (61.022%
current mest  death_rate 0.14288997401860276


dynamic sparse change prune
to kill 913781.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1322,1322 density 0.7650462962962963,0.7650462962962963
before tensor 4096 mask 866.0 4096
layer1.0.conv1.weight, mask/weight parameters,866,866 density 0.27614795918367346,0.27614795918367346
before tensor 36864 mask 4534.0 36864
layer1.0.conv2.weight, mask/weight parameters,4534,4534 density 0.2098199824147346,0.2098199824147346
before tensor 16384 mask 4000.0 16384
layer1.0.conv3.weight, mask/weight parameters,4000,4000 density 0.31887755102040816,0.31887755102040816
layer1.0.shortcut.0.weight, mask/weight parameters,6279,6279 density 0.38323974609375,0.38323974609375
before tensor 16384 mask 2442.0 16384
layer1.1.conv1.weight, mask/weight parameters,2442,2442 density 0.1946747448979592,0.1946747448979592
before tensor 36864 mask 3715.0 36864
layer1.1.conv2.weight, mask/weight parameters,3715,3715 density 0.17191910777916608,0.17191910777916608
before tensor 16384 mask 2509.0 16384
layer1.1.conv3.weight, mask/weight parameters,2509,2509 density 0.20001594387755103,0.20001594387755103
before tensor 16384 mask 2128.0 16384
layer1.2.conv1.weight, mask/weight parameters,2128,2128 density 0.16964285714285715,0.16964285714285715
before tensor 36864 mask 2390.0 36864
layer1.2.conv2.weight, mask/weight parameters,2390,2390 density 0.11060206395483363,0.11060206395483363
before tensor 16384 mask 1718.0 16384
layer1.2.conv3.weight, mask/weight parameters,1718,1718 density 0.1369579081632653,0.1369579081632653
before tensor 32768 mask 5212.0 32768
layer2.0.conv1.weight, mask/weight parameters,5212,5212 density 0.21207682291666666,0.21207682291666666
before tensor 147456 mask 13490.0 147456
layer2.0.conv2.weight, mask/weight parameters,13490,13490 density 0.16263985339506173,0.16263985339506173
before tensor 65536 mask 8671.0 65536
layer2.0.conv3.weight, mask/weight parameters,8671,8671 density 0.17641194661458334,0.17641194661458334
layer2.0.shortcut.0.weight, mask/weight parameters,28382,28382 density 0.2165374755859375,0.2165374755859375
before tensor 65536 mask 4843.0 65536
layer2.1.conv1.weight, mask/weight parameters,4843,4843 density 0.09853108723958333,0.09853108723958333
before tensor 147456 mask 7047.0 147456
layer2.1.conv2.weight, mask/weight parameters,7047,7047 density 0.0849609375,0.0849609375
before tensor 65536 mask 5063.0 65536
layer2.1.conv3.weight, mask/weight parameters,5063,5063 density 0.10300699869791667,0.10300699869791667
before tensor 65536 mask 10133.0 65536
layer2.2.conv1.weight, mask/weight parameters,10133,10133 density 0.20615641276041666,0.20615641276041666
before tensor 147456 mask 20807.0 147456
layer2.2.conv2.weight, mask/weight parameters,20807,20807 density 0.2508559992283951,0.2508559992283951
before tensor 65536 mask 11818.0 65536
layer2.2.conv3.weight, mask/weight parameters,11818,11818 density 0.24043782552083334,0.24043782552083334
before tensor 65536 mask 9725.0 65536
layer2.3.conv1.weight, mask/weight parameters,9725,9725 density 0.19785563151041666,0.19785563151041666
before tensor 147456 mask 20267.0 147456
layer2.3.conv2.weight, mask/weight parameters,20267,20267 density 0.2443455825617284,0.2443455825617284
before tensor 65536 mask 10686.0 65536
layer2.3.conv3.weight, mask/weight parameters,10686,10686 density 0.2174072265625,0.2174072265625
before tensor 131072 mask 28803.0 131072
layer3.0.conv1.weight, mask/weight parameters,28803,28803 density 0.30408572635135134,0.30408572635135134
before tensor 589824 mask 82641.0 589824
layer3.0.conv2.weight, mask/weight parameters,82641,82641 density 0.2682931580228878,0.2682931580228878
before tensor 262144 mask 62394.0 262144
layer3.0.conv3.weight, mask/weight parameters,62394,62394 density 0.3293602195945946,0.3293602195945946
layer3.0.shortcut.0.weight, mask/weight parameters,86559,86559 density 0.1650981903076172,0.1650981903076172
before tensor 262144 mask 28612.0 262144
layer3.1.conv1.weight, mask/weight parameters,28612,28612 density 0.1510346283783784,0.1510346283783784
before tensor 589824 mask 68567.0 589824
layer3.1.conv2.weight, mask/weight parameters,68567,68567 density 0.22260206152098044,0.22260206152098044
before tensor 262144 mask 48328.0 262144
layer3.1.conv3.weight, mask/weight parameters,48328,48328 density 0.2551097972972973,0.2551097972972973
before tensor 262144 mask 31435.0 262144
layer3.2.conv1.weight, mask/weight parameters,31435,31435 density 0.16593644425675674,0.16593644425675674
before tensor 589824 mask 62705.0 589824
layer3.2.conv2.weight, mask/weight parameters,62705,62705 density 0.20357113870627383,0.20357113870627383
before tensor 262144 mask 45725.0 262144
layer3.2.conv3.weight, mask/weight parameters,45725,45725 density 0.24136929898648649,0.24136929898648649
before tensor 262144 mask 30736.0 262144
layer3.3.conv1.weight, mask/weight parameters,30736,30736 density 0.16224662162162162,0.16224662162162162
before tensor 589824 mask 51441.0 589824
layer3.3.conv2.weight, mask/weight parameters,51441,51441 density 0.1670026783540297,0.1670026783540297
before tensor 262144 mask 38618.0 262144
layer3.3.conv3.weight, mask/weight parameters,38618,38618 density 0.20385346283783784,0.20385346283783784
before tensor 262144 mask 33997.0 262144
layer3.4.conv1.weight, mask/weight parameters,33997,33997 density 0.1794605152027027,0.1794605152027027
before tensor 589824 mask 51764.0 589824
layer3.4.conv2.weight, mask/weight parameters,51764,51764 density 0.16805129453778103,0.16805129453778103
before tensor 262144 mask 36204.0 262144
layer3.4.conv3.weight, mask/weight parameters,36204,36204 density 0.1911106418918919,0.1911106418918919
before tensor 262144 mask 39744.0 262144
layer3.5.conv1.weight, mask/weight parameters,39744,39744 density 0.2097972972972973,0.2097972972972973
before tensor 589824 mask 53336.0 589824
layer3.5.conv2.weight, mask/weight parameters,53336,53336 density 0.17315477639801963,0.17315477639801963
before tensor 262144 mask 34577.0 262144
layer3.5.conv3.weight, mask/weight parameters,34577,34577 density 0.1825221706081081,0.1825221706081081
before tensor 524288 mask 121347.0 524288
layer4.0.conv1.weight, mask/weight parameters,121347,121347 density 0.3282629631232687,0.3282629631232687
before tensor 2359296 mask 232876.0 2359296
layer4.0.conv2.weight, mask/weight parameters,232876,232876 density 0.19854905280891882,0.19854905280891882
before tensor 1048576 mask 112479.0 1048576
layer4.0.conv3.weight, mask/weight parameters,112479,112479 density 0.15213680531509696,0.15213680531509696
layer4.0.shortcut.0.weight, mask/weight parameters,143897,143897 density 0.06861543655395508,0.06861543655395508
before tensor 1048576 mask 107761.0 1048576
layer4.1.conv1.weight, mask/weight parameters,107761,107761 density 0.14575533457409973,0.14575533457409973
before tensor 2359296 mask 226257.0 2359296
layer4.1.conv2.weight, mask/weight parameters,226257,226257 density 0.1929057225364037,0.1929057225364037
before tensor 1048576 mask 102984.0 1048576
layer4.1.conv3.weight, mask/weight parameters,102984,102984 density 0.13929406163434904,0.13929406163434904
before tensor 1048576 mask 37210.0 1048576
layer4.2.conv1.weight, mask/weight parameters,37210,37210 density 0.05032948840027701,0.05032948840027701
before tensor 2359296 mask 43517.0 2359296
layer4.2.conv2.weight, mask/weight parameters,43517,43517 density 0.037102402699658706,0.037102402699658706
before tensor 1048576 mask 31596.0 1048576
layer4.2.conv3.weight, mask/weight parameters,31596,31596 density 0.04273610630193906,0.04273610630193906
classifier.weight, mask/weight parameters,101048,101048 density 0.4933984375,0.4933984375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.15340340548094966 0.15340340548094966 after dst
Death rate: 0.14288997401860276

dynamic sparse change grow
self.total_params*pruning_rate 3379638.237967161
self.total_nonzero 2365205.0
to grow 1014433.237967161
len(all_scores) 15418204 12733791
increse 1014433.0 before_mask 3379637.0 after_mask 3379637.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1438,1322 density 0.8321759259259259,0.7650462962962963
before tensor 4096 mask 1082.0 4096
layer1.0.conv1.weight, mask/weight parameters,1082,866 density 0.3450255102040816,0.27614795918367346
before tensor 36864 mask 5876.0 36864
layer1.0.conv2.weight, mask/weight parameters,5876,4534 density 0.2719237354805868,0.2098199824147346
before tensor 16384 mask 5182.0 16384
layer1.0.conv3.weight, mask/weight parameters,5182,4000 density 0.41310586734693877,0.31887755102040816
layer1.0.shortcut.0.weight, mask/weight parameters,7994,6279 density 0.4879150390625,0.38323974609375
before tensor 16384 mask 3203.0 16384
layer1.1.conv1.weight, mask/weight parameters,3203,2442 density 0.25534119897959184,0.1946747448979592
before tensor 36864 mask 4550.0 36864
layer1.1.conv2.weight, mask/weight parameters,4550,3715 density 0.2105604146420473,0.17191910777916608
before tensor 16384 mask 3456.0 16384
layer1.1.conv3.weight, mask/weight parameters,3456,2509 density 0.2755102040816326,0.20001594387755103
before tensor 16384 mask 3495.0 16384
layer1.2.conv1.weight, mask/weight parameters,3495,2128 density 0.2786192602040816,0.16964285714285715
before tensor 36864 mask 3172.0 36864
layer1.2.conv2.weight, mask/weight parameters,3172,2390 density 0.14679068906474155,0.11060206395483363
before tensor 16384 mask 2249.0 16384
layer1.2.conv3.weight, mask/weight parameters,2249,1718 density 0.1792889030612245,0.1369579081632653
before tensor 32768 mask 7163.0 32768
layer2.0.conv1.weight, mask/weight parameters,7163,5212 density 0.2914632161458333,0.21207682291666666
before tensor 147456 mask 18144.0 147456
layer2.0.conv2.weight, mask/weight parameters,18144,13490 density 0.21875,0.16263985339506173
before tensor 65536 mask 11469.0 65536
layer2.0.conv3.weight, mask/weight parameters,11469,8671 density 0.23333740234375,0.17641194661458334
layer2.0.shortcut.0.weight, mask/weight parameters,42592,28382 density 0.324951171875,0.2165374755859375
before tensor 65536 mask 8277.0 65536
layer2.1.conv1.weight, mask/weight parameters,8277,4843 density 0.16839599609375,0.09853108723958333
before tensor 147456 mask 12810.0 147456
layer2.1.conv2.weight, mask/weight parameters,12810,7047 density 0.15444155092592593,0.0849609375
before tensor 65536 mask 7902.0 65536
layer2.1.conv3.weight, mask/weight parameters,7902,5063 density 0.1607666015625,0.10300699869791667
before tensor 65536 mask 13736.0 65536
layer2.2.conv1.weight, mask/weight parameters,13736,10133 density 0.2794596354166667,0.20615641276041666
before tensor 147456 mask 30094.0 147456
layer2.2.conv2.weight, mask/weight parameters,30094,20807 density 0.36282310956790126,0.2508559992283951
before tensor 65536 mask 17389.0 65536
layer2.2.conv3.weight, mask/weight parameters,17389,11818 density 0.3537801106770833,0.24043782552083334
before tensor 65536 mask 13553.0 65536
layer2.3.conv1.weight, mask/weight parameters,13553,9725 density 0.2757364908854167,0.19785563151041666
before tensor 147456 mask 27953.0 147456
layer2.3.conv2.weight, mask/weight parameters,27953,20267 density 0.33701051311728397,0.2443455825617284
before tensor 65536 mask 15096.0 65536
layer2.3.conv3.weight, mask/weight parameters,15096,10686 density 0.30712890625,0.2174072265625
before tensor 131072 mask 39637.0 131072
layer3.0.conv1.weight, mask/weight parameters,39637,28803 density 0.4184649493243243,0.30408572635135134
before tensor 589824 mask 113711.0 589824
layer3.0.conv2.weight, mask/weight parameters,113711,82641 density 0.3691615940264589,0.2682931580228878
before tensor 262144 mask 81837.0 262144
layer3.0.conv3.weight, mask/weight parameters,81837,62394 density 0.4319942989864865,0.3293602195945946
layer3.0.shortcut.0.weight, mask/weight parameters,124541,86559 density 0.23754310607910156,0.1650981903076172
before tensor 262144 mask 42693.0 262144
layer3.1.conv1.weight, mask/weight parameters,42693,28612 density 0.22536423141891893,0.1510346283783784
before tensor 589824 mask 100062.0 589824
layer3.1.conv2.weight, mask/weight parameters,100062,68567 density 0.32485025566106646,0.22260206152098044
before tensor 262144 mask 66704.0 262144
layer3.1.conv3.weight, mask/weight parameters,66704,48328 density 0.3521114864864865,0.2551097972972973
before tensor 262144 mask 44881.0 262144
layer3.2.conv1.weight, mask/weight parameters,44881,31435 density 0.2369140625,0.16593644425675674
before tensor 589824 mask 88961.0 589824
layer3.2.conv2.weight, mask/weight parameters,88961,62705 density 0.28881097313529747,0.20357113870627383
before tensor 262144 mask 62835.0 262144
layer3.2.conv3.weight, mask/weight parameters,62835,45725 density 0.33168813344594594,0.24136929898648649
before tensor 262144 mask 42929.0 262144
layer3.3.conv1.weight, mask/weight parameters,42929,30736 density 0.22661000844594595,0.16224662162162162
before tensor 589824 mask 72081.0 589824
layer3.3.conv2.weight, mask/weight parameters,72081,51441 density 0.23401022644265887,0.1670026783540297
before tensor 262144 mask 54674.0 262144
layer3.3.conv3.weight, mask/weight parameters,54674,38618 density 0.2886085304054054,0.20385346283783784
before tensor 262144 mask 48119.0 262144
layer3.4.conv1.weight, mask/weight parameters,48119,33997 density 0.2540065456081081,0.1794605152027027
before tensor 589824 mask 75500.0 589824
layer3.4.conv2.weight, mask/weight parameters,75500,51764 density 0.24510997483970456,0.16805129453778103
before tensor 262144 mask 50469.0 262144
layer3.4.conv3.weight, mask/weight parameters,50469,36204 density 0.2664115287162162,0.1911106418918919
before tensor 262144 mask 53063.0 262144
layer3.5.conv1.weight, mask/weight parameters,53063,39744 density 0.2801045185810811,0.2097972972972973
before tensor 589824 mask 71362.0 589824
layer3.5.conv2.weight, mask/weight parameters,71362,53336 density 0.23167600032464897,0.17315477639801963
before tensor 262144 mask 47397.0 262144
layer3.5.conv3.weight, mask/weight parameters,47397,34577 density 0.2501953125,0.1825221706081081
before tensor 524288 mask 163197.0 524288
layer4.0.conv1.weight, mask/weight parameters,163197,121347 density 0.44147387898199447,0.3282629631232687
before tensor 2359296 mask 342116.0 2359296
layer4.0.conv2.weight, mask/weight parameters,342116,232876 density 0.29168659608880293,0.19854905280891882
before tensor 1048576 mask 162145.0 1048576
layer4.0.conv3.weight, mask/weight parameters,162145,112479 density 0.2193140257098338,0.15213680531509696
layer4.0.shortcut.0.weight, mask/weight parameters,227312,143897 density 0.10839080810546875,0.06861543655395508
before tensor 1048576 mask 148249.0 1048576
layer4.1.conv1.weight, mask/weight parameters,148249,107761 density 0.20051857903393353,0.14575533457409973
before tensor 2359296 mask 322360.0 2359296
layer4.1.conv2.weight, mask/weight parameters,322360,226257 density 0.2748427174267983,0.1929057225364037
before tensor 1048576 mask 149875.0 1048576
layer4.1.conv3.weight, mask/weight parameters,149875,102984 density 0.20271787352839335,0.13929406163434904
before tensor 1048576 mask 63250.0 1048576
layer4.2.conv1.weight, mask/weight parameters,63250,37210 density 0.0855506622229917,0.05032948840027701
before tensor 2359296 mask 84888.0 2359296
layer4.2.conv2.weight, mask/weight parameters,84888,43517 density 0.07237513524297695,0.037102402699658706
before tensor 1048576 mask 52480.0 1048576
layer4.2.conv3.weight, mask/weight parameters,52480,31596 density 0.07098337950138504,0.04273610630193906
classifier.weight, mask/weight parameters,114434,101048 density 0.558759765625,0.4933984375
Total Model parameters after dst: 3379637 2365205
Total parameters under density level of 0.1: 0.2191978391257503 0.15340340548094966 after dst
Death rate: 0.14288997401860276


Training summary: Average loss: 1.3677, Accuracy: 30508/50000 (61.016%)


Evaluation: Average loss: 1.5667, Accuracy: 5699/10000 (56.990%)

Current learning rate: 0.1. Time taken for epoch: 88.77 seconds.

Train Epoch: 32 [0/50000 (0%)]	Loss: 1.229071 Accuracy: 65/100 (65.000%
Train Epoch: 32 [10000/50000 (20%)]	Loss: 1.510753 Accuracy: 6203/10100 (61.416%
Train Epoch: 32 [20000/50000 (40%)]	Loss: 1.223008 Accuracy: 12251/20100 (60.950%
Train Epoch: 32 [30000/50000 (60%)]	Loss: 1.386943 Accuracy: 18318/30100 (60.857%
Train Epoch: 32 [40000/50000 (80%)]	Loss: 1.651432 Accuracy: 24428/40100 (60.918%
current layer rate 0.2922910787437415
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5448.0
Total filter_masks items: 12442780.0
5448.0 / 7552 channels
Total channels to prune: 103.38222667273567
Layer ('layer2', 0, 'conv1'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/96.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/96.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/185.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/185.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/361.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/361.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/361.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/361.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/361.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/361.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5368.0
Total filter_masks items: 12153706.0
After apply_mask:
Total filter_names items: 5368.0
Total filter_masks items: 12153706.0
Total pruned: 80/103.38222667273567 channels
===========done ===============

Training summary: Average loss: 1.3732, Accuracy: 30458/50000 (60.916%)


Evaluation: Average loss: 1.7380, Accuracy: 5283/10000 (52.830%)

Current learning rate: 0.1. Time taken for epoch: 88.57 seconds.

Train Epoch: 33 [0/50000 (0%)]	Loss: 1.047332 Accuracy: 73/100 (73.000%
Train Epoch: 33 [10000/50000 (20%)]	Loss: 1.553322 Accuracy: 6271/10100 (62.089%
Train Epoch: 33 [20000/50000 (40%)]	Loss: 1.395935 Accuracy: 12399/20100 (61.687%
Train Epoch: 33 [30000/50000 (60%)]	Loss: 1.298963 Accuracy: 18498/30100 (61.455%
Train Epoch: 33 [40000/50000 (80%)]	Loss: 1.072813 Accuracy: 24577/40100 (61.289%
current mest  death_rate 0.14202539646966958


dynamic sparse change prune
to kill 920862.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1320,1320 density 0.7638888888888888,0.7638888888888888
before tensor 4096 mask 883.0 4096
layer1.0.conv1.weight, mask/weight parameters,883,883 density 0.2815688775510204,0.2815688775510204
before tensor 36864 mask 4805.0 36864
layer1.0.conv2.weight, mask/weight parameters,4805,4805 density 0.22236105326484334,0.22236105326484334
before tensor 16384 mask 4102.0 16384
layer1.0.conv3.weight, mask/weight parameters,4102,4102 density 0.32700892857142855,0.32700892857142855
layer1.0.shortcut.0.weight, mask/weight parameters,6286,6286 density 0.3836669921875,0.3836669921875
before tensor 16384 mask 2339.0 16384
layer1.1.conv1.weight, mask/weight parameters,2339,2339 density 0.1864636479591837,0.1864636479591837
before tensor 36864 mask 3688.0 36864
layer1.1.conv2.weight, mask/weight parameters,3688,3688 density 0.17066962839557592,0.17066962839557592
before tensor 16384 mask 2476.0 16384
layer1.1.conv3.weight, mask/weight parameters,2476,2476 density 0.19738520408163265,0.19738520408163265
before tensor 16384 mask 2392.0 16384
layer1.2.conv1.weight, mask/weight parameters,2392,2392 density 0.19068877551020408,0.19068877551020408
before tensor 36864 mask 2441.0 36864
layer1.2.conv2.weight, mask/weight parameters,2441,2441 density 0.11296219167939285,0.11296219167939285
before tensor 16384 mask 1699.0 16384
layer1.2.conv3.weight, mask/weight parameters,1699,1699 density 0.13544323979591838,0.13544323979591838
before tensor 32768 mask 5166.0 32768
layer2.0.conv1.weight, mask/weight parameters,5166,5166 density 0.21241776315789473,0.21241776315789473
before tensor 147456 mask 13672.0 147456
layer2.0.conv2.weight, mask/weight parameters,13672,13672 density 0.16832256078793476,0.16832256078793476
before tensor 65536 mask 8670.0 65536
layer2.0.conv3.weight, mask/weight parameters,8670,8670 density 0.17824835526315788,0.17824835526315788
layer2.0.shortcut.0.weight, mask/weight parameters,29788,29788 density 0.227264404296875,0.227264404296875
before tensor 65536 mask 5084.0 65536
layer2.1.conv1.weight, mask/weight parameters,5084,5084 density 0.10452302631578947,0.10452302631578947
before tensor 147456 mask 7819.0 147456
layer2.1.conv2.weight, mask/weight parameters,7819,7819 density 0.09626346568174823,0.09626346568174823
before tensor 65536 mask 5153.0 65536
layer2.1.conv3.weight, mask/weight parameters,5153,5153 density 0.10594161184210527,0.10594161184210527
before tensor 65536 mask 10191.0 65536
layer2.2.conv1.weight, mask/weight parameters,10191,10191 density 0.2095189144736842,0.2095189144736842
before tensor 147456 mask 22176.0 147456
layer2.2.conv2.weight, mask/weight parameters,22176,22176 density 0.2730193905817174,0.2730193905817174
before tensor 65536 mask 12607.0 65536
layer2.2.conv3.weight, mask/weight parameters,12607,12607 density 0.25918996710526315,0.25918996710526315
before tensor 65536 mask 9936.0 65536
layer2.3.conv1.weight, mask/weight parameters,9936,9936 density 0.2042763157894737,0.2042763157894737
before tensor 147456 mask 20561.0 147456
layer2.3.conv2.weight, mask/weight parameters,20561,20561 density 0.2531363496460449,0.2531363496460449
before tensor 65536 mask 10844.0 65536
layer2.3.conv3.weight, mask/weight parameters,10844,10844 density 0.22294407894736842,0.22294407894736842
before tensor 131072 mask 29606.0 131072
layer3.0.conv1.weight, mask/weight parameters,29606,29606 density 0.3177154876373626,0.3177154876373626
before tensor 589824 mask 82940.0 589824
layer3.0.conv2.weight, mask/weight parameters,82940,82940 density 0.2782138496424211,0.2782138496424211
before tensor 262144 mask 62024.0 262144
layer3.0.conv3.weight, mask/weight parameters,62024,62024 density 0.33280391483516486,0.33280391483516486
layer3.0.shortcut.0.weight, mask/weight parameters,87620,87620 density 0.16712188720703125,0.16712188720703125
before tensor 262144 mask 29823.0 262144
layer3.1.conv1.weight, mask/weight parameters,29823,29823 density 0.16002210679945056,0.16002210679945056
before tensor 589824 mask 68526.0 589824
layer3.1.conv2.weight, mask/weight parameters,68526,68526 density 0.22986354305035625,0.22986354305035625
before tensor 262144 mask 48464.0 262144
layer3.1.conv3.weight, mask/weight parameters,48464,48464 density 0.26004464285714285,0.26004464285714285
before tensor 262144 mask 30811.0 262144
layer3.2.conv1.weight, mask/weight parameters,30811,30811 density 0.16532344608516483,0.16532344608516483
before tensor 589824 mask 61587.0 589824
layer3.2.conv2.weight, mask/weight parameters,61587,61587 density 0.20658736867528077,0.20658736867528077
before tensor 262144 mask 45824.0 262144
layer3.2.conv3.weight, mask/weight parameters,45824,45824 density 0.24587912087912087,0.24587912087912087
before tensor 262144 mask 29791.0 262144
layer3.3.conv1.weight, mask/weight parameters,29791,29791 density 0.15985040350274726,0.15985040350274726
before tensor 589824 mask 49733.0 589824
layer3.3.conv2.weight, mask/weight parameters,49733,49733 density 0.16682432341773,0.16682432341773
before tensor 262144 mask 38906.0 262144
layer3.3.conv3.weight, mask/weight parameters,38906,38906 density 0.20875901442307693,0.20875901442307693
before tensor 262144 mask 33696.0 262144
layer3.4.conv1.weight, mask/weight parameters,33696,33696 density 0.18080357142857142,0.18080357142857142
before tensor 589824 mask 51405.0 589824
layer3.4.conv2.weight, mask/weight parameters,51405,51405 density 0.17243287847683453,0.17243287847683453
before tensor 262144 mask 35385.0 262144
layer3.4.conv3.weight, mask/weight parameters,35385,35385 density 0.18986628605769232,0.18986628605769232
before tensor 262144 mask 37675.0 262144
layer3.5.conv1.weight, mask/weight parameters,37675,37675 density 0.20215380322802198,0.20215380322802198
before tensor 589824 mask 49909.0 589824
layer3.5.conv2.weight, mask/weight parameters,49909,49909 density 0.16741469763447786,0.16741469763447786
before tensor 262144 mask 33670.0 262144
layer3.5.conv3.weight, mask/weight parameters,33670,33670 density 0.1806640625,0.1806640625
before tensor 524288 mask 124044.0 524288
layer4.0.conv1.weight, mask/weight parameters,124044,124044 density 0.3412301936619718,0.3412301936619718
before tensor 2359296 mask 234878.0 2359296
layer4.0.conv2.weight, mask/weight parameters,234878,234878 density 0.2070823690184928,0.2070823690184928
before tensor 1048576 mask 111582.0 1048576
layer4.0.conv3.weight, mask/weight parameters,111582,111582 density 0.15347436179577464,0.15347436179577464
layer4.0.shortcut.0.weight, mask/weight parameters,144678,144678 density 0.06898784637451172,0.06898784637451172
before tensor 1048576 mask 106865.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106865,106865 density 0.14698641065140844,0.14698641065140844
before tensor 2359296 mask 225442.0 2359296
layer4.1.conv2.weight, mask/weight parameters,225442,225442 density 0.19876303202627343,0.19876303202627343
before tensor 1048576 mask 101734.0 1048576
layer4.1.conv3.weight, mask/weight parameters,101734,101734 density 0.13992902728873238,0.13992902728873238
before tensor 1048576 mask 38314.0 1048576
layer4.2.conv1.weight, mask/weight parameters,38314,38314 density 0.05269861355633803,0.05269861355633803
before tensor 2359296 mask 43857.0 2359296
layer4.2.conv2.weight, mask/weight parameters,43857,43857 density 0.038666931164451496,0.038666931164451496
before tensor 1048576 mask 30853.0 1048576
layer4.2.conv3.weight, mask/weight parameters,30853,30853 density 0.04243645466549296,0.04243645466549296
classifier.weight, mask/weight parameters,101465,101465 density 0.4954345703125,0.4954345703125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.15633450171953048 0.15633450171953048 after dst
Death rate: 0.14202539646966958

dynamic sparse change grow
self.total_params*pruning_rate 3359189.2221133118
self.total_nonzero 2365205.0
to grow 993984.2221133118
len(all_scores) 15129130 12378923
increse 993984.0 before_mask 3359188.0 after_mask 3359188.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1404,1320 density 0.8125,0.7638888888888888
before tensor 4096 mask 1074.0 4096
layer1.0.conv1.weight, mask/weight parameters,1074,883 density 0.3424744897959184,0.2815688775510204
before tensor 36864 mask 5816.0 36864
layer1.0.conv2.weight, mask/weight parameters,5816,4805 density 0.2691471146281642,0.22236105326484334
before tensor 16384 mask 5183.0 16384
layer1.0.conv3.weight, mask/weight parameters,5183,4102 density 0.41318558673469385,0.32700892857142855
layer1.0.shortcut.0.weight, mask/weight parameters,7520,6286 density 0.458984375,0.3836669921875
before tensor 16384 mask 2903.0 16384
layer1.1.conv1.weight, mask/weight parameters,2903,2339 density 0.23142538265306123,0.1864636479591837
before tensor 36864 mask 4383.0 36864
layer1.1.conv2.weight, mask/weight parameters,4383,3688 density 0.20283215326947104,0.17066962839557592
before tensor 16384 mask 3012.0 16384
layer1.1.conv3.weight, mask/weight parameters,3012,2476 density 0.24011479591836735,0.19738520408163265
before tensor 16384 mask 3154.0 16384
layer1.2.conv1.weight, mask/weight parameters,3154,2392 density 0.25143494897959184,0.19068877551020408
before tensor 36864 mask 3028.0 36864
layer1.2.conv2.weight, mask/weight parameters,3028,2441 density 0.1401267990189273,0.11296219167939285
before tensor 16384 mask 2330.0 16384
layer1.2.conv3.weight, mask/weight parameters,2330,1699 density 0.18574617346938777,0.13544323979591838
before tensor 32768 mask 7204.0 32768
layer2.0.conv1.weight, mask/weight parameters,7204,5166 density 0.2962171052631579,0.21241776315789473
before tensor 147456 mask 17321.0 147456
layer2.0.conv2.weight, mask/weight parameters,17321,13672 density 0.21324715297014465,0.16832256078793476
before tensor 65536 mask 11648.0 65536
layer2.0.conv3.weight, mask/weight parameters,11648,8670 density 0.2394736842105263,0.17824835526315788
layer2.0.shortcut.0.weight, mask/weight parameters,40132,29788 density 0.306182861328125,0.227264404296875
before tensor 65536 mask 6707.0 65536
layer2.1.conv1.weight, mask/weight parameters,6707,5084 density 0.137890625,0.10452302631578947
before tensor 147456 mask 9877.0 147456
layer2.1.conv2.weight, mask/weight parameters,9877,7819 density 0.12160049245921822,0.09626346568174823
before tensor 65536 mask 6971.0 65536
layer2.1.conv3.weight, mask/weight parameters,6971,5153 density 0.14331825657894737,0.10594161184210527
before tensor 65536 mask 13586.0 65536
layer2.2.conv1.weight, mask/weight parameters,13586,10191 density 0.2793174342105263,0.2095189144736842
before tensor 147456 mask 28884.0 147456
layer2.2.conv2.weight, mask/weight parameters,28884,22176 density 0.35560480147737766,0.2730193905817174
before tensor 65536 mask 17716.0 65536
layer2.2.conv3.weight, mask/weight parameters,17716,12607 density 0.36422697368421053,0.25918996710526315
before tensor 65536 mask 14248.0 65536
layer2.3.conv1.weight, mask/weight parameters,14248,9936 density 0.29292763157894736,0.2042763157894737
before tensor 147456 mask 29447.0 147456
layer2.3.conv2.weight, mask/weight parameters,29447,20561 density 0.3625361649738381,0.2531363496460449
before tensor 65536 mask 14588.0 65536
layer2.3.conv3.weight, mask/weight parameters,14588,10844 density 0.29991776315789476,0.22294407894736842
before tensor 131072 mask 40195.0 131072
layer3.0.conv1.weight, mask/weight parameters,40195,29606 density 0.4313508756868132,0.3177154876373626
before tensor 589824 mask 118284.0 589824
layer3.0.conv2.weight, mask/weight parameters,118284,82940 density 0.3967717264420561,0.2782138496424211
before tensor 262144 mask 82379.0 262144
layer3.0.conv3.weight, mask/weight parameters,82379,62024 density 0.4420233087225275,0.33280391483516486
layer3.0.shortcut.0.weight, mask/weight parameters,124992,87620 density 0.2384033203125,0.16712188720703125
before tensor 262144 mask 43836.0 262144
layer3.1.conv1.weight, mask/weight parameters,43836,29823 density 0.23521205357142858,0.16002210679945056
before tensor 589824 mask 102579.0 589824
layer3.1.conv2.weight, mask/weight parameters,102579,68526 density 0.3440908907941875,0.22986354305035625
before tensor 262144 mask 65441.0 262144
layer3.1.conv3.weight, mask/weight parameters,65441,48464 density 0.35113860748626374,0.26004464285714285
before tensor 262144 mask 42862.0 262144
layer3.2.conv1.weight, mask/weight parameters,42862,30811 density 0.22998583447802198,0.16532344608516483
before tensor 589824 mask 88888.0 589824
layer3.2.conv2.weight, mask/weight parameters,88888,61587 density 0.2981658146493311,0.20658736867528077
before tensor 262144 mask 64627.0 262144
layer3.2.conv3.weight, mask/weight parameters,64627,45824 density 0.34677090487637363,0.24587912087912087
before tensor 262144 mask 42169.0 262144
layer3.3.conv1.weight, mask/weight parameters,42169,29791 density 0.2262673849587912,0.15985040350274726
before tensor 589824 mask 70351.0 589824
layer3.3.conv2.weight, mask/weight parameters,70351,49733 density 0.2359853211501563,0.16682432341773
before tensor 262144 mask 53921.0 262144
layer3.3.conv3.weight, mask/weight parameters,53921,38906 density 0.2893254206730769,0.20875901442307693
before tensor 262144 mask 47866.0 262144
layer3.4.conv1.weight, mask/weight parameters,47866,33696 density 0.2568359375,0.18080357142857142
before tensor 589824 mask 73032.0 589824
layer3.4.conv2.weight, mask/weight parameters,73032,51405 density 0.24497846475868454,0.17243287847683453
before tensor 262144 mask 50107.0 262144
layer3.4.conv3.weight, mask/weight parameters,50107,35385 density 0.26886053399725274,0.18986628605769232
before tensor 262144 mask 51725.0 262144
layer3.5.conv1.weight, mask/weight parameters,51725,37675 density 0.2775422819368132,0.20215380322802198
before tensor 589824 mask 70297.0 589824
layer3.5.conv2.weight, mask/weight parameters,70297,49909 density 0.23580418360638142,0.16741469763447786
before tensor 262144 mask 46194.0 262144
layer3.5.conv3.weight, mask/weight parameters,46194,33670 density 0.24786444024725274,0.1806640625
before tensor 524288 mask 164570.0 524288
layer4.0.conv1.weight, mask/weight parameters,164570,124044 density 0.4527123679577465,0.3412301936619718
before tensor 2359296 mask 340117.0 2359296
layer4.0.conv2.weight, mask/weight parameters,340117,234878 density 0.2998673102779431,0.2070823690184928
before tensor 1048576 mask 163386.0 1048576
layer4.0.conv3.weight, mask/weight parameters,163386,111582 density 0.22472766285211268,0.15347436179577464
layer4.0.shortcut.0.weight, mask/weight parameters,231891,144678 density 0.11057424545288086,0.06898784637451172
before tensor 1048576 mask 150792.0 1048576
layer4.1.conv1.weight, mask/weight parameters,150792,106865 density 0.20740536971830986,0.14698641065140844
before tensor 2359296 mask 314465.0 2359296
layer4.1.conv2.weight, mask/weight parameters,314465,225442 density 0.2772509863563226,0.19876303202627343
before tensor 1048576 mask 145575.0 1048576
layer4.1.conv3.weight, mask/weight parameters,145575,101734 density 0.20022969850352113,0.13992902728873238
before tensor 1048576 mask 64425.0 1048576
layer4.2.conv1.weight, mask/weight parameters,64425,38314 density 0.08861273107394366,0.05269861355633803
before tensor 2359296 mask 80678.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80678,43857 density 0.07113050761533206,0.038666931164451496
before tensor 1048576 mask 52095.0 1048576
layer4.2.conv3.weight, mask/weight parameters,52095,30853 density 0.07165355413732394,0.04243645466549296
classifier.weight, mask/weight parameters,113313,101465 density 0.5532861328125,0.4954345703125
Total Model parameters after dst: 3359188 2365205
Total parameters under density level of 0.1: 0.22203444613140347 0.15633450171953048 after dst
Death rate: 0.14202539646966958


Training summary: Average loss: 1.3604, Accuracy: 30517/50000 (61.034%)


Evaluation: Average loss: 1.6633, Accuracy: 5444/10000 (54.440%)

Current learning rate: 0.1. Time taken for epoch: 88.78 seconds.

Train Epoch: 34 [0/50000 (0%)]	Loss: 1.292638 Accuracy: 61/100 (61.000%
Train Epoch: 34 [10000/50000 (20%)]	Loss: 1.418347 Accuracy: 6344/10100 (62.812%
Train Epoch: 34 [20000/50000 (40%)]	Loss: 1.136897 Accuracy: 12571/20100 (62.542%
Train Epoch: 34 [30000/50000 (60%)]	Loss: 1.199673 Accuracy: 18691/30100 (62.096%
Train Epoch: 34 [40000/50000 (80%)]	Loss: 1.161010 Accuracy: 24743/40100 (61.703%
current layer rate 0.30487596722803817
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5368.0
Total filter_masks items: 12153706.0
5368.0 / 7552 channels
Total channels to prune: 118.42330450614372
Layer ('layer1', 0, 'conv1'): Pruned 1/49.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/49.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/49.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/49.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/49.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/49.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 2/95.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 2/95.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 4/182.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 4/182.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 7/355.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 7/355.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 7/355.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 7/355.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 7/355.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 7/355.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5256.0
Total filter_masks items: 11791948.0
After apply_mask:
Total filter_names items: 5256.0
Total filter_masks items: 11791948.0
Total pruned: 112/118.42330450614372 channels
===========done ===============

Training summary: Average loss: 1.3467, Accuracy: 30739/50000 (61.478%)


Evaluation: Average loss: 1.8935, Accuracy: 4931/10000 (49.310%)

Current learning rate: 0.1. Time taken for epoch: 88.58 seconds.

Train Epoch: 35 [0/50000 (0%)]	Loss: 1.365439 Accuracy: 60/100 (60.000%
Train Epoch: 35 [10000/50000 (20%)]	Loss: 1.287122 Accuracy: 6318/10100 (62.554%
Train Epoch: 35 [20000/50000 (40%)]	Loss: 1.467735 Accuracy: 12540/20100 (62.388%
Train Epoch: 35 [30000/50000 (60%)]	Loss: 1.288372 Accuracy: 18572/30100 (61.701%
Train Epoch: 35 [40000/50000 (80%)]	Loss: 1.286103 Accuracy: 24743/40100 (61.703%
current mest  death_rate 0.1411210553184042


dynamic sparse change prune
to kill 879161.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1290,1290 density 0.7465277777777778,0.7465277777777778
before tensor 4096 mask 860.0 4096
layer1.0.conv1.weight, mask/weight parameters,860,860 density 0.2799479166666667,0.2799479166666667
before tensor 36864 mask 4544.0 36864
layer1.0.conv2.weight, mask/weight parameters,4544,4544 density 0.2191358024691358,0.2191358024691358
before tensor 16384 mask 3973.0 16384
layer1.0.conv3.weight, mask/weight parameters,3973,3973 density 0.3233235677083333,0.3233235677083333
layer1.0.shortcut.0.weight, mask/weight parameters,6129,6129 density 0.37408447265625,0.37408447265625
before tensor 16384 mask 2140.0 16384
layer1.1.conv1.weight, mask/weight parameters,2140,2140 density 0.17415364583333334,0.17415364583333334
before tensor 36864 mask 3296.0 36864
layer1.1.conv2.weight, mask/weight parameters,3296,3296 density 0.15895061728395063,0.15895061728395063
before tensor 16384 mask 2173.0 16384
layer1.1.conv3.weight, mask/weight parameters,2173,2173 density 0.17683919270833334,0.17683919270833334
before tensor 16384 mask 2226.0 16384
layer1.2.conv1.weight, mask/weight parameters,2226,2226 density 0.18115234375,0.18115234375
before tensor 36864 mask 2251.0 36864
layer1.2.conv2.weight, mask/weight parameters,2251,2251 density 0.10855516975308642,0.10855516975308642
before tensor 16384 mask 1631.0 16384
layer1.2.conv3.weight, mask/weight parameters,1631,1631 density 0.13273111979166666,0.13273111979166666
before tensor 32768 mask 5203.0 32768
layer2.0.conv1.weight, mask/weight parameters,5203,5203 density 0.21853998655913978,0.21853998655913978
before tensor 147456 mask 13650.0 147456
layer2.0.conv2.weight, mask/weight parameters,13650,13650 density 0.1753574594365437,0.1753574594365437
before tensor 65536 mask 8746.0 65536
layer2.0.conv3.weight, mask/weight parameters,8746,8746 density 0.1836777553763441,0.1836777553763441
layer2.0.shortcut.0.weight, mask/weight parameters,29361,29361 density 0.22400665283203125,0.22400665283203125
before tensor 65536 mask 4573.0 65536
layer2.1.conv1.weight, mask/weight parameters,4573,4573 density 0.09603914650537634,0.09603914650537634
before tensor 147456 mask 6737.0 147456
layer2.1.conv2.weight, mask/weight parameters,6737,6737 density 0.08654822008966997,0.08654822008966997
before tensor 65536 mask 4608.0 65536
layer2.1.conv3.weight, mask/weight parameters,4608,4608 density 0.0967741935483871,0.0967741935483871
before tensor 65536 mask 10208.0 65536
layer2.2.conv1.weight, mask/weight parameters,10208,10208 density 0.21438172043010753,0.21438172043010753
before tensor 147456 mask 21492.0 147456
layer2.2.conv2.weight, mask/weight parameters,21492,21492 density 0.2761012833853625,0.2761012833853625
before tensor 65536 mask 12759.0 65536
layer2.2.conv3.weight, mask/weight parameters,12759,12759 density 0.2679561491935484,0.2679561491935484
before tensor 65536 mask 10081.0 65536
layer2.3.conv1.weight, mask/weight parameters,10081,10081 density 0.21171454973118278,0.21171454973118278
before tensor 147456 mask 20897.0 147456
layer2.3.conv2.weight, mask/weight parameters,20897,20897 density 0.26845749669197466,0.26845749669197466
before tensor 65536 mask 10521.0 65536
layer2.3.conv3.weight, mask/weight parameters,10521,10521 density 0.22095514112903225,0.22095514112903225
before tensor 131072 mask 29587.0 131072
layer3.0.conv1.weight, mask/weight parameters,29587,29587 density 0.32464668188202245,0.32464668188202245
before tensor 589824 mask 83738.0 589824
layer3.0.conv2.weight, mask/weight parameters,83738,83738 density 0.2936568053977472,0.2936568053977472
before tensor 262144 mask 62575.0 262144
layer3.0.conv3.weight, mask/weight parameters,62575,62575 density 0.3433056091994382,0.3433056091994382
layer3.0.shortcut.0.weight, mask/weight parameters,89301,89301 density 0.17032814025878906,0.17032814025878906
before tensor 262144 mask 30051.0 262144
layer3.1.conv1.weight, mask/weight parameters,30051,30051 density 0.16486898700842698,0.16486898700842698
before tensor 589824 mask 68868.0 589824
layer3.1.conv2.weight, mask/weight parameters,68868,68868 density 0.24150991036485292,0.24150991036485292
before tensor 262144 mask 47568.0 262144
layer3.1.conv3.weight, mask/weight parameters,47568,47568 density 0.26097261235955055,0.26097261235955055
before tensor 262144 mask 30221.0 262144
layer3.2.conv1.weight, mask/weight parameters,30221,30221 density 0.16580165905898878,0.16580165905898878
before tensor 589824 mask 61995.0 589824
layer3.2.conv2.weight, mask/weight parameters,61995,61995 density 0.21740731389134368,0.21740731389134368
before tensor 262144 mask 46502.0 262144
layer3.2.conv3.weight, mask/weight parameters,46502,46502 density 0.2551242099719101,0.2551242099719101
before tensor 262144 mask 29668.0 262144
layer3.3.conv1.weight, mask/weight parameters,29668,29668 density 0.16276773174157302,0.16276773174157302
before tensor 589824 mask 49391.0 589824
layer3.3.conv2.weight, mask/weight parameters,49391,49391 density 0.17320694637321327,0.17320694637321327
before tensor 262144 mask 38671.0 262144
layer3.3.conv3.weight, mask/weight parameters,38671,38671 density 0.2121609462780899,0.2121609462780899
before tensor 262144 mask 33602.0 262144
layer3.4.conv1.weight, mask/weight parameters,33602,33602 density 0.184350860252809,0.184350860252809
before tensor 589824 mask 50772.0 589824
layer3.4.conv2.weight, mask/weight parameters,50772,50772 density 0.17804990952320834,0.17804990952320834
before tensor 262144 mask 35358.0 262144
layer3.4.conv3.weight, mask/weight parameters,35358,35358 density 0.19398481390449437,0.19398481390449437
before tensor 262144 mask 37401.0 262144
layer3.5.conv1.weight, mask/weight parameters,37401,37401 density 0.20519333742977527,0.20519333742977527
before tensor 589824 mask 50690.0 589824
layer3.5.conv2.weight, mask/weight parameters,50690,50690 density 0.17776234762726367,0.17776234762726367
before tensor 262144 mask 33392.0 262144
layer3.5.conv3.weight, mask/weight parameters,33392,33392 density 0.18319873595505617,0.18319873595505617
before tensor 524288 mask 126167.0 524288
layer4.0.conv1.weight, mask/weight parameters,126167,126167 density 0.3540516118893678,0.3540516118893678
before tensor 2359296 mask 237488.0 2359296
layer4.0.conv2.weight, mask/weight parameters,237488,237488 density 0.21789169272324246,0.21789169272324246
before tensor 1048576 mask 112361.0 1048576
layer4.0.conv3.weight, mask/weight parameters,112361,112361 density 0.1576545101472701,0.1576545101472701
layer4.0.shortcut.0.weight, mask/weight parameters,147454,147454 density 0.0703115463256836,0.0703115463256836
before tensor 1048576 mask 107773.0 1048576
layer4.1.conv1.weight, mask/weight parameters,107773,107773 density 0.15121705504669541,0.15121705504669541
before tensor 2359296 mask 222025.0 2359296
layer4.1.conv2.weight, mask/weight parameters,222025,222025 density 0.20370462118876706,0.20370462118876706
before tensor 1048576 mask 99420.0 1048576
layer4.1.conv3.weight, mask/weight parameters,99420,99420 density 0.13949690193965517,0.13949690193965517
before tensor 1048576 mask 39044.0 1048576
layer4.2.conv1.weight, mask/weight parameters,39044,39044 density 0.054782911278735635,0.054782911278735635
before tensor 2359296 mask 42901.0 2359296
layer4.2.conv2.weight, mask/weight parameters,42901,42901 density 0.039361026702485286,0.039361026702485286
before tensor 1048576 mask 30953.0 1048576
layer4.2.conv3.weight, mask/weight parameters,30953,30953 density 0.043430372216235635,0.043430372216235635
classifier.weight, mask/weight parameters,100919,100919 density 0.4927685546875,0.4927685546875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.16016424587936162 0.16016424587936162 after dst
Death rate: 0.1411210553184042

dynamic sparse change grow
self.total_params*pruning_rate 3337799.716264666
self.total_nonzero 2365205.0
to grow 972594.716264666
len(all_scores) 14767372 11971225
increse 972594.0 before_mask 3337798.0 after_mask 3337798.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1406,1290 density 0.8136574074074074,0.7465277777777778
before tensor 4096 mask 1013.0 4096
layer1.0.conv1.weight, mask/weight parameters,1013,860 density 0.3297526041666667,0.2799479166666667
before tensor 36864 mask 5864.0 36864
layer1.0.conv2.weight, mask/weight parameters,5864,4544 density 0.2827932098765432,0.2191358024691358
before tensor 16384 mask 5072.0 16384
layer1.0.conv3.weight, mask/weight parameters,5072,3973 density 0.4127604166666667,0.3233235677083333
layer1.0.shortcut.0.weight, mask/weight parameters,7257,6129 density 0.44293212890625,0.37408447265625
before tensor 16384 mask 3128.0 16384
layer1.1.conv1.weight, mask/weight parameters,3128,2140 density 0.2545572916666667,0.17415364583333334
before tensor 36864 mask 4540.0 36864
layer1.1.conv2.weight, mask/weight parameters,4540,3296 density 0.2189429012345679,0.15895061728395063
before tensor 16384 mask 2908.0 16384
layer1.1.conv3.weight, mask/weight parameters,2908,2173 density 0.23665364583333334,0.17683919270833334
before tensor 16384 mask 2891.0 16384
layer1.2.conv1.weight, mask/weight parameters,2891,2226 density 0.23527018229166666,0.18115234375
before tensor 36864 mask 2761.0 36864
layer1.2.conv2.weight, mask/weight parameters,2761,2251 density 0.13315007716049382,0.10855516975308642
before tensor 16384 mask 2022.0 16384
layer1.2.conv3.weight, mask/weight parameters,2022,1631 density 0.16455078125,0.13273111979166666
before tensor 32768 mask 7955.0 32768
layer2.0.conv1.weight, mask/weight parameters,7955,5203 density 0.33413138440860213,0.21853998655913978
before tensor 147456 mask 17070.0 147456
layer2.0.conv2.weight, mask/weight parameters,17070,13650 density 0.2192931745481173,0.1753574594365437
before tensor 65536 mask 11030.0 65536
layer2.0.conv3.weight, mask/weight parameters,11030,8746 density 0.23164482526881722,0.1836777553763441
layer2.0.shortcut.0.weight, mask/weight parameters,39163,29361 density 0.29878997802734375,0.22400665283203125
before tensor 65536 mask 6621.0 65536
layer2.1.conv1.weight, mask/weight parameters,6621,4573 density 0.13904989919354838,0.09603914650537634
before tensor 147456 mask 9687.0 147456
layer2.1.conv2.weight, mask/weight parameters,9687,6737 density 0.12444598604848345,0.08654822008966997
before tensor 65536 mask 6500.0 65536
layer2.1.conv3.weight, mask/weight parameters,6500,4608 density 0.13650873655913978,0.0967741935483871
before tensor 65536 mask 13119.0 65536
layer2.2.conv1.weight, mask/weight parameters,13119,10208 density 0.2755166330645161,0.21438172043010753
before tensor 147456 mask 29478.0 147456
layer2.2.conv2.weight, mask/weight parameters,29478,21492 density 0.3786950321809843,0.2761012833853625
before tensor 65536 mask 16692.0 65536
layer2.2.conv3.weight, mask/weight parameters,16692,12759 density 0.35055443548387094,0.2679561491935484
before tensor 65536 mask 12723.0 65536
layer2.3.conv1.weight, mask/weight parameters,12723,10081 density 0.2672001008064516,0.21171454973118278
before tensor 147456 mask 25776.0 147456
layer2.3.conv2.weight, mask/weight parameters,25776,20897 density 0.3311365475777547,0.26845749669197466
before tensor 65536 mask 13575.0 65536
layer2.3.conv3.weight, mask/weight parameters,13575,10521 density 0.28509324596774194,0.22095514112903225
before tensor 131072 mask 39228.0 131072
layer3.0.conv1.weight, mask/weight parameters,39228,29587 density 0.43043363764044945,0.32464668188202245
before tensor 589824 mask 111188.0 589824
layer3.0.conv2.weight, mask/weight parameters,111188,83738 density 0.38991990349142225,0.2936568053977472
before tensor 262144 mask 80562.0 262144
layer3.0.conv3.weight, mask/weight parameters,80562,62575 density 0.4419877984550562,0.3433056091994382
layer3.0.shortcut.0.weight, mask/weight parameters,124738,89301 density 0.23791885375976562,0.17032814025878906
before tensor 262144 mask 40018.0 262144
layer3.1.conv1.weight, mask/weight parameters,40018,30051 density 0.2195510007022472,0.16486898700842698
before tensor 589824 mask 95863.0 589824
layer3.1.conv2.weight, mask/weight parameters,95863,68868 density 0.336177390621274,0.24150991036485292
before tensor 262144 mask 64348.0 262144
layer3.1.conv3.weight, mask/weight parameters,64348,47568 density 0.3530328300561798,0.26097261235955055
before tensor 262144 mask 40419.0 262144
layer3.2.conv1.weight, mask/weight parameters,40419,30221 density 0.22175100948033707,0.16580165905898878
before tensor 589824 mask 84337.0 589824
layer3.2.conv2.weight, mask/weight parameters,84337,61995 density 0.29575740997909916,0.21740731389134368
before tensor 262144 mask 62991.0 262144
layer3.2.conv3.weight, mask/weight parameters,62991,46502 density 0.3455879125702247,0.2551242099719101
before tensor 262144 mask 43448.0 262144
layer3.3.conv1.weight, mask/weight parameters,43448,29668 density 0.2383690308988764,0.16276773174157302
before tensor 589824 mask 70734.0 589824
layer3.3.conv2.weight, mask/weight parameters,70734,49391 density 0.2480536969237891,0.17320694637321327
before tensor 262144 mask 53030.0 262144
layer3.3.conv3.weight, mask/weight parameters,53030,38671 density 0.29093881671348315,0.2121609462780899
before tensor 262144 mask 47929.0 262144
layer3.4.conv1.weight, mask/weight parameters,47929,33602 density 0.26295316889044945,0.184350860252809
before tensor 589824 mask 72699.0 589824
layer3.4.conv2.weight, mask/weight parameters,72699,50772 density 0.2549446618692926,0.17804990952320834
before tensor 262144 mask 49979.0 262144
layer3.4.conv3.weight, mask/weight parameters,49979,35358 density 0.27420009655898875,0.19398481390449437
before tensor 262144 mask 51803.0 262144
layer3.5.conv1.weight, mask/weight parameters,51803,37401 density 0.2842071190308989,0.20519333742977527
before tensor 589824 mask 71809.0 589824
layer3.5.conv2.weight, mask/weight parameters,71809,50690 density 0.251823563242576,0.17776234762726367
before tensor 262144 mask 48140.0 262144
layer3.5.conv3.weight, mask/weight parameters,48140,33392 density 0.264110779494382,0.18319873595505617
before tensor 524288 mask 164846.0 524288
layer4.0.conv1.weight, mask/weight parameters,164846,126167 density 0.46259316630747127,0.3540516118893678
before tensor 2359296 mask 343828.0 2359296
layer4.0.conv2.weight, mask/weight parameters,343828,237488 density 0.31545705435915505,0.21789169272324246
before tensor 1048576 mask 163396.0 1048576
layer4.0.conv3.weight, mask/weight parameters,163396,112361 density 0.2292620779454023,0.1576545101472701
layer4.0.shortcut.0.weight, mask/weight parameters,229181,147454 density 0.10928201675415039,0.0703115463256836
before tensor 1048576 mask 148025.0 1048576
layer4.1.conv1.weight, mask/weight parameters,148025,107773 density 0.20769491963002873,0.15121705504669541
before tensor 2359296 mask 309702.0 2359296
layer4.1.conv2.weight, mask/weight parameters,309702,222025 density 0.28414695908750603,0.20370462118876706
before tensor 1048576 mask 144758.0 1048576
layer4.1.conv3.weight, mask/weight parameters,144758,99420 density 0.2031109689295977,0.13949690193965517
before tensor 1048576 mask 72264.0 1048576
layer4.2.conv1.weight, mask/weight parameters,72264,39044 density 0.10139412715517242,0.054782911278735635
before tensor 2359296 mask 93649.0 2359296
layer4.2.conv2.weight, mask/weight parameters,93649,42901 density 0.0859215586970244,0.039361026702485286
before tensor 1048576 mask 51901.0 1048576
layer4.2.conv3.weight, mask/weight parameters,51901,30953 density 0.07282265849497127,0.043430372216235635
classifier.weight, mask/weight parameters,114734,100919 density 0.560224609375,0.4927685546875
Total Model parameters after dst: 3337798 2365205
Total parameters under density level of 0.1: 0.2260251857947372 0.16016424587936162 after dst
Death rate: 0.1411210553184042


Training summary: Average loss: 1.3440, Accuracy: 30760/50000 (61.520%)


Evaluation: Average loss: 1.6563, Accuracy: 5584/10000 (55.840%)

Current learning rate: 0.1. Time taken for epoch: 88.79 seconds.

Train Epoch: 36 [0/50000 (0%)]	Loss: 1.400584 Accuracy: 59/100 (59.000%
Train Epoch: 36 [10000/50000 (20%)]	Loss: 1.708684 Accuracy: 6350/10100 (62.871%
Train Epoch: 36 [20000/50000 (40%)]	Loss: 1.516148 Accuracy: 12426/20100 (61.821%
Train Epoch: 36 [30000/50000 (60%)]	Loss: 1.309604 Accuracy: 18482/30100 (61.402%
Train Epoch: 36 [40000/50000 (80%)]	Loss: 1.689726 Accuracy: 24616/40100 (61.387%
current layer rate 0.316941966317706
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5256.0
Total filter_masks items: 11791948.0
5256.0 / 7552 channels
Total channels to prune: 97.54572963131523
Layer ('layer2', 0, 'conv1'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/93.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/93.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/178.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/178.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/348.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/348.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/348.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/348.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/348.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/348.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5176.0
Total filter_masks items: 11509570.0
After apply_mask:
Total filter_names items: 5176.0
Total filter_masks items: 11509570.0
Total pruned: 80/97.54572963131523 channels
===========done ===============

Training summary: Average loss: 1.3482, Accuracy: 30663/50000 (61.326%)


Evaluation: Average loss: 1.6905, Accuracy: 5465/10000 (54.650%)

Current learning rate: 0.1. Time taken for epoch: 88.58 seconds.

Train Epoch: 37 [0/50000 (0%)]	Loss: 1.246254 Accuracy: 61/100 (61.000%
Train Epoch: 37 [10000/50000 (20%)]	Loss: 1.362602 Accuracy: 6352/10100 (62.891%
Train Epoch: 37 [20000/50000 (40%)]	Loss: 1.297150 Accuracy: 12499/20100 (62.184%
Train Epoch: 37 [30000/50000 (60%)]	Loss: 1.394515 Accuracy: 18698/30100 (62.120%
Train Epoch: 37 [40000/50000 (80%)]	Loss: 1.221601 Accuracy: 24778/40100 (61.791%
current mest  death_rate 0.14017906269546812


dynamic sparse change prune
to kill 882966.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1289,1289 density 0.7459490740740741,0.7459490740740741
before tensor 4096 mask 830.0 4096
layer1.0.conv1.weight, mask/weight parameters,830,830 density 0.2701822916666667,0.2701822916666667
before tensor 36864 mask 4603.0 36864
layer1.0.conv2.weight, mask/weight parameters,4603,4603 density 0.22198109567901234,0.22198109567901234
before tensor 16384 mask 3979.0 16384
layer1.0.conv3.weight, mask/weight parameters,3979,3979 density 0.3238118489583333,0.3238118489583333
layer1.0.shortcut.0.weight, mask/weight parameters,6001,6001 density 0.36627197265625,0.36627197265625
before tensor 16384 mask 2253.0 16384
layer1.1.conv1.weight, mask/weight parameters,2253,2253 density 0.183349609375,0.183349609375
before tensor 36864 mask 3630.0 36864
layer1.1.conv2.weight, mask/weight parameters,3630,3630 density 0.17505787037037038,0.17505787037037038
before tensor 16384 mask 2206.0 16384
layer1.1.conv3.weight, mask/weight parameters,2206,2206 density 0.17952473958333334,0.17952473958333334
before tensor 16384 mask 2170.0 16384
layer1.2.conv1.weight, mask/weight parameters,2170,2170 density 0.17659505208333334,0.17659505208333334
before tensor 36864 mask 2224.0 36864
layer1.2.conv2.weight, mask/weight parameters,2224,2224 density 0.10725308641975309,0.10725308641975309
before tensor 16384 mask 1552.0 16384
layer1.2.conv3.weight, mask/weight parameters,1552,1552 density 0.12630208333333334,0.12630208333333334
before tensor 32768 mask 5367.0 32768
layer2.0.conv1.weight, mask/weight parameters,5367,5367 density 0.2278787364130435,0.2278787364130435
before tensor 147456 mask 13421.0 147456
layer2.0.conv2.weight, mask/weight parameters,13421,13421 density 0.176184099978996,0.176184099978996
before tensor 65536 mask 8411.0 65536
layer2.0.conv3.weight, mask/weight parameters,8411,8411 density 0.1785623301630435,0.1785623301630435
layer2.0.shortcut.0.weight, mask/weight parameters,28713,28713 density 0.21906280517578125,0.21906280517578125
before tensor 65536 mask 4634.0 65536
layer2.1.conv1.weight, mask/weight parameters,4634,4634 density 0.09837805706521739,0.09837805706521739
before tensor 147456 mask 6947.0 147456
layer2.1.conv2.weight, mask/weight parameters,6947,6947 density 0.09119670237345096,0.09119670237345096
before tensor 65536 mask 4508.0 65536
layer2.1.conv3.weight, mask/weight parameters,4508,4508 density 0.095703125,0.095703125
before tensor 65536 mask 10060.0 65536
layer2.2.conv1.weight, mask/weight parameters,10060,10060 density 0.21356997282608695,0.21356997282608695
before tensor 147456 mask 21975.0 147456
layer2.2.conv2.weight, mask/weight parameters,21975,21975 density 0.28847668557025835,0.28847668557025835
before tensor 65536 mask 12441.0 65536
layer2.2.conv3.weight, mask/weight parameters,12441,12441 density 0.26411769701086957,0.26411769701086957
before tensor 65536 mask 9672.0 65536
layer2.3.conv1.weight, mask/weight parameters,9672,9672 density 0.20533288043478262,0.20533288043478262
before tensor 147456 mask 20110.0 147456
layer2.3.conv2.weight, mask/weight parameters,20110,20110 density 0.2639939088426801,0.2639939088426801
before tensor 65536 mask 10222.0 65536
layer2.3.conv3.weight, mask/weight parameters,10222,10222 density 0.21700917119565216,0.21700917119565216
before tensor 131072 mask 29418.0 131072
layer3.0.conv1.weight, mask/weight parameters,29418,29418 density 0.32832589285714286,0.32832589285714286
before tensor 589824 mask 81312.0 589824
layer3.0.conv2.weight, mask/weight parameters,81312,81312 density 0.29500952380952383,0.29500952380952383
before tensor 262144 mask 62254.0 262144
layer3.0.conv3.weight, mask/weight parameters,62254,62254 density 0.3473995535714286,0.3473995535714286
layer3.0.shortcut.0.weight, mask/weight parameters,89311,89311 density 0.1703472137451172,0.1703472137451172
before tensor 262144 mask 28806.0 262144
layer3.1.conv1.weight, mask/weight parameters,28806,28806 density 0.16074776785714287,0.16074776785714287
before tensor 589824 mask 67304.0 589824
layer3.1.conv2.weight, mask/weight parameters,67304,67304 density 0.24418684807256236,0.24418684807256236
before tensor 262144 mask 47417.0 262144
layer3.1.conv3.weight, mask/weight parameters,47417,47417 density 0.26460379464285716,0.26460379464285716
before tensor 262144 mask 29372.0 262144
layer3.2.conv1.weight, mask/weight parameters,29372,29372 density 0.16390625,0.16390625
before tensor 589824 mask 60637.0 589824
layer3.2.conv2.weight, mask/weight parameters,60637,60637 density 0.2199981859410431,0.2199981859410431
before tensor 262144 mask 46015.0 262144
layer3.2.conv3.weight, mask/weight parameters,46015,46015 density 0.2567801339285714,0.2567801339285714
before tensor 262144 mask 29962.0 262144
layer3.3.conv1.weight, mask/weight parameters,29962,29962 density 0.1671986607142857,0.1671986607142857
before tensor 589824 mask 49326.0 589824
layer3.3.conv2.weight, mask/weight parameters,49326,49326 density 0.17896054421768706,0.17896054421768706
before tensor 262144 mask 38306.0 262144
layer3.3.conv3.weight, mask/weight parameters,38306,38306 density 0.21376116071428572,0.21376116071428572
before tensor 262144 mask 33601.0 262144
layer3.4.conv1.weight, mask/weight parameters,33601,33601 density 0.18750558035714285,0.18750558035714285
before tensor 589824 mask 50781.0 589824
layer3.4.conv2.weight, mask/weight parameters,50781,50781 density 0.18423945578231293,0.18423945578231293
before tensor 262144 mask 35723.0 262144
layer3.4.conv3.weight, mask/weight parameters,35723,35723 density 0.1993470982142857,0.1993470982142857
before tensor 262144 mask 37505.0 262144
layer3.5.conv1.weight, mask/weight parameters,37505,37505 density 0.20929129464285715,0.20929129464285715
before tensor 589824 mask 51800.0 589824
layer3.5.conv2.weight, mask/weight parameters,51800,51800 density 0.18793650793650793,0.18793650793650793
before tensor 262144 mask 34752.0 262144
layer3.5.conv3.weight, mask/weight parameters,34752,34752 density 0.19392857142857142,0.19392857142857142
before tensor 524288 mask 127227.0 524288
layer4.0.conv1.weight, mask/weight parameters,127227,127227 density 0.3632898163377193,0.3632898163377193
before tensor 2359296 mask 240695.0 2359296
layer4.0.conv2.weight, mask/weight parameters,240695,240695 density 0.22865060094464013,0.22865060094464013
before tensor 1048576 mask 112661.0 1048576
layer4.0.conv3.weight, mask/weight parameters,112661,112661 density 0.16084869563230994,0.16084869563230994
layer4.0.shortcut.0.weight, mask/weight parameters,147583,147583 density 0.0703730583190918,0.0703730583190918
before tensor 1048576 mask 107233.0 1048576
layer4.1.conv1.weight, mask/weight parameters,107233,107233 density 0.15309901544225146,0.15309901544225146
before tensor 2359296 mask 220003.0 2359296
layer4.1.conv2.weight, mask/weight parameters,220003,220003 density 0.20899403045191492,0.20899403045191492
before tensor 1048576 mask 99184.0 1048576
layer4.1.conv3.weight, mask/weight parameters,99184,99184 density 0.14160727339181287,0.14160727339181287
before tensor 1048576 mask 41716.0 1048576
layer4.2.conv1.weight, mask/weight parameters,41716,41716 density 0.05955889071637427,0.05955889071637427
before tensor 2359296 mask 45770.0 2359296
layer4.2.conv2.weight, mask/weight parameters,45770,45770 density 0.04347966515813033,0.04347966515813033
before tensor 1048576 mask 30938.0 1048576
layer4.2.conv3.weight, mask/weight parameters,30938,30938 density 0.04417089272660819,0.04417089272660819
classifier.weight, mask/weight parameters,101375,101375 density 0.4949951171875,0.4949951171875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.16328657091608045 0.16328657091608045 after dst
Death rate: 0.14017906269546812

dynamic sparse change grow
self.total_params*pruning_rate 3315519.676603218
self.total_nonzero 2365205.0
to grow 950314.6766032181
len(all_scores) 14484994 11651042
increse 950314.0 before_mask 3315518.0 after_mask 3315518.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1398,1289 density 0.8090277777777778,0.7459490740740741
before tensor 4096 mask 1055.0 4096
layer1.0.conv1.weight, mask/weight parameters,1055,830 density 0.3434244791666667,0.2701822916666667
before tensor 36864 mask 5441.0 36864
layer1.0.conv2.weight, mask/weight parameters,5441,4603 density 0.26239390432098764,0.22198109567901234
before tensor 16384 mask 5117.0 16384
layer1.0.conv3.weight, mask/weight parameters,5117,3979 density 0.4164225260416667,0.3238118489583333
layer1.0.shortcut.0.weight, mask/weight parameters,7663,6001 density 0.46771240234375,0.36627197265625
before tensor 16384 mask 3185.0 16384
layer1.1.conv1.weight, mask/weight parameters,3185,2253 density 0.2591959635416667,0.183349609375
before tensor 36864 mask 4430.0 36864
layer1.1.conv2.weight, mask/weight parameters,4430,3630 density 0.21363811728395063,0.17505787037037038
before tensor 16384 mask 3048.0 16384
layer1.1.conv3.weight, mask/weight parameters,3048,2206 density 0.248046875,0.17952473958333334
before tensor 16384 mask 3326.0 16384
layer1.2.conv1.weight, mask/weight parameters,3326,2170 density 0.2706705729166667,0.17659505208333334
before tensor 36864 mask 2870.0 36864
layer1.2.conv2.weight, mask/weight parameters,2870,2224 density 0.13840663580246915,0.10725308641975309
before tensor 16384 mask 2191.0 16384
layer1.2.conv3.weight, mask/weight parameters,2191,1552 density 0.17830403645833334,0.12630208333333334
before tensor 32768 mask 7113.0 32768
layer2.0.conv1.weight, mask/weight parameters,7113,5367 density 0.3020125679347826,0.2278787364130435
before tensor 147456 mask 17689.0 147456
layer2.0.conv2.weight, mask/weight parameters,17689,13421 density 0.23221224532661205,0.176184099978996
before tensor 65536 mask 10679.0 65536
layer2.0.conv3.weight, mask/weight parameters,10679,8411 density 0.2267111073369565,0.1785623301630435
layer2.0.shortcut.0.weight, mask/weight parameters,40396,28713 density 0.308197021484375,0.21906280517578125
before tensor 65536 mask 6133.0 65536
layer2.1.conv1.weight, mask/weight parameters,6133,4634 density 0.13020125679347827,0.09837805706521739
before tensor 147456 mask 8911.0 147456
layer2.1.conv2.weight, mask/weight parameters,8911,6947 density 0.11697910102919555,0.09119670237345096
before tensor 65536 mask 6701.0 65536
layer2.1.conv3.weight, mask/weight parameters,6701,4508 density 0.14225968070652173,0.095703125
before tensor 65536 mask 13581.0 65536
layer2.2.conv1.weight, mask/weight parameters,13581,10060 density 0.2883194633152174,0.21356997282608695
before tensor 147456 mask 28667.0 147456
layer2.2.conv2.weight, mask/weight parameters,28667,21975 density 0.3763258769166142,0.28847668557025835
before tensor 65536 mask 16826.0 65536
layer2.2.conv3.weight, mask/weight parameters,16826,12441 density 0.35720957880434784,0.26411769701086957
before tensor 65536 mask 14122.0 65536
layer2.3.conv1.weight, mask/weight parameters,14122,9672 density 0.2998046875,0.20533288043478262
before tensor 147456 mask 26881.0 147456
layer2.3.conv2.weight, mask/weight parameters,26881,20110 density 0.3528801722327242,0.2639939088426801
before tensor 65536 mask 14131.0 65536
layer2.3.conv3.weight, mask/weight parameters,14131,10222 density 0.299995754076087,0.21700917119565216
before tensor 131072 mask 40403.0 131072
layer3.0.conv1.weight, mask/weight parameters,40403,29418 density 0.4509263392857143,0.32832589285714286
before tensor 589824 mask 116161.0 589824
layer3.0.conv2.weight, mask/weight parameters,116161,81312 density 0.42144580498866213,0.29500952380952383
before tensor 262144 mask 81432.0 262144
layer3.0.conv3.weight, mask/weight parameters,81432,62254 density 0.45441964285714287,0.3473995535714286
layer3.0.shortcut.0.weight, mask/weight parameters,126478,89311 density 0.24123764038085938,0.1703472137451172
before tensor 262144 mask 41798.0 262144
layer3.1.conv1.weight, mask/weight parameters,41798,28806 density 0.23324776785714285,0.16074776785714287
before tensor 589824 mask 94852.0 589824
layer3.1.conv2.weight, mask/weight parameters,94852,67304 density 0.3441342403628118,0.24418684807256236
before tensor 262144 mask 63644.0 262144
layer3.1.conv3.weight, mask/weight parameters,63644,47417 density 0.35515625,0.26460379464285716
before tensor 262144 mask 41988.0 262144
layer3.2.conv1.weight, mask/weight parameters,41988,29372 density 0.2343080357142857,0.16390625
before tensor 589824 mask 84827.0 589824
layer3.2.conv2.weight, mask/weight parameters,84827,60637 density 0.307762358276644,0.2199981859410431
before tensor 262144 mask 61206.0 262144
layer3.2.conv3.weight, mask/weight parameters,61206,46015 density 0.3415513392857143,0.2567801339285714
before tensor 262144 mask 39406.0 262144
layer3.3.conv1.weight, mask/weight parameters,39406,29962 density 0.21989955357142857,0.1671986607142857
before tensor 589824 mask 69201.0 589824
layer3.3.conv2.weight, mask/weight parameters,69201,49326 density 0.251069387755102,0.17896054421768706
before tensor 262144 mask 53356.0 262144
layer3.3.conv3.weight, mask/weight parameters,53356,38306 density 0.2977455357142857,0.21376116071428572
before tensor 262144 mask 44832.0 262144
layer3.4.conv1.weight, mask/weight parameters,44832,33601 density 0.2501785714285714,0.18750558035714285
before tensor 589824 mask 69345.0 589824
layer3.4.conv2.weight, mask/weight parameters,69345,50781 density 0.2515918367346939,0.18423945578231293
before tensor 262144 mask 48579.0 262144
layer3.4.conv3.weight, mask/weight parameters,48579,35723 density 0.27108816964285715,0.1993470982142857
before tensor 262144 mask 53850.0 262144
layer3.5.conv1.weight, mask/weight parameters,53850,37505 density 0.30050223214285715,0.20929129464285715
before tensor 589824 mask 75126.0 589824
layer3.5.conv2.weight, mask/weight parameters,75126,51800 density 0.2725659863945578,0.18793650793650793
before tensor 262144 mask 49108.0 262144
layer3.5.conv3.weight, mask/weight parameters,49108,34752 density 0.2740401785714286,0.19392857142857142
before tensor 524288 mask 166073.0 524288
layer4.0.conv1.weight, mask/weight parameters,166073,127227 density 0.47421246801900585,0.3632898163377193
before tensor 2359296 mask 342965.0 2359296
layer4.0.conv2.weight, mask/weight parameters,342965,240695 density 0.32580300111335303,0.22865060094464013
before tensor 1048576 mask 162998.0 1048576
layer4.0.conv3.weight, mask/weight parameters,162998,112661 density 0.23271598592836257,0.16084869563230994
layer4.0.shortcut.0.weight, mask/weight parameters,232640,147583 density 0.110931396484375,0.0703730583190918
before tensor 1048576 mask 149440.0 1048576
layer4.1.conv1.weight, mask/weight parameters,149440,107233 density 0.21335891812865498,0.15309901544225146
before tensor 2359296 mask 302722.0 2359296
layer4.1.conv2.weight, mask/weight parameters,302722,220003 density 0.2875737643871429,0.20899403045191492
before tensor 1048576 mask 140124.0 1048576
layer4.1.conv3.weight, mask/weight parameters,140124,99184 density 0.20005825109649122,0.14160727339181287
before tensor 1048576 mask 67175.0 1048576
layer4.2.conv1.weight, mask/weight parameters,67175,41716 density 0.09590728938230994,0.05955889071637427
before tensor 2359296 mask 80127.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80127,45770 density 0.07611743784412298,0.04347966515813033
before tensor 1048576 mask 49742.0 1048576
layer4.2.conv3.weight, mask/weight parameters,49742,30938 density 0.0710177951388889,0.04417089272660819
classifier.weight, mask/weight parameters,114366,101375 density 0.558427734375,0.4949951171875
Total Model parameters after dst: 3315518 2365205
Total parameters under density level of 0.1: 0.22889329467447483 0.16328657091608045 after dst
Death rate: 0.14017906269546812


Training summary: Average loss: 1.3333, Accuracy: 30926/50000 (61.852%)


Evaluation: Average loss: 1.6645, Accuracy: 5489/10000 (54.890%)

Current learning rate: 0.1. Time taken for epoch: 88.76 seconds.

Train Epoch: 38 [0/50000 (0%)]	Loss: 1.460666 Accuracy: 60/100 (60.000%
Train Epoch: 38 [10000/50000 (20%)]	Loss: 1.415812 Accuracy: 6314/10100 (62.515%
Train Epoch: 38 [20000/50000 (40%)]	Loss: 1.404934 Accuracy: 12528/20100 (62.328%
Train Epoch: 38 [30000/50000 (60%)]	Loss: 1.558166 Accuracy: 18599/30100 (61.791%
Train Epoch: 38 [40000/50000 (80%)]	Loss: 1.305398 Accuracy: 24818/40100 (61.890%
current layer rate 0.3285
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5176.0
Total filter_masks items: 11509570.0
5176.0 / 7552 channels
Total channels to prune: 104.83200000000033
Layer ('layer2', 0, 'conv1'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/92.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/92.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/175.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/175.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/342.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/342.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/342.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/342.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/342.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/342.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5096.0
Total filter_masks items: 11230180.0
After apply_mask:
Total filter_names items: 5096.0
Total filter_masks items: 11230180.0
Total pruned: 80/104.83200000000033 channels
===========done ===============

Training summary: Average loss: 1.3374, Accuracy: 30983/50000 (61.966%)


Evaluation: Average loss: 1.7267, Accuracy: 5308/10000 (53.080%)

Current learning rate: 0.1. Time taken for epoch: 88.57 seconds.

Train Epoch: 39 [0/50000 (0%)]	Loss: 1.266714 Accuracy: 66/100 (66.000%
Train Epoch: 39 [10000/50000 (20%)]	Loss: 1.375515 Accuracy: 6420/10100 (63.564%
Train Epoch: 39 [20000/50000 (40%)]	Loss: 1.333674 Accuracy: 12664/20100 (63.005%
Train Epoch: 39 [30000/50000 (60%)]	Loss: 1.325232 Accuracy: 18766/30100 (62.346%
Train Epoch: 39 [40000/50000 (80%)]	Loss: 1.160380 Accuracy: 24931/40100 (62.172%
current mest  death_rate 0.1392016186682789


dynamic sparse change prune
to kill 856451.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1303,1303 density 0.7540509259259259,0.7540509259259259
before tensor 4096 mask 870.0 4096
layer1.0.conv1.weight, mask/weight parameters,870,870 density 0.283203125,0.283203125
before tensor 36864 mask 4416.0 36864
layer1.0.conv2.weight, mask/weight parameters,4416,4416 density 0.21296296296296297,0.21296296296296297
before tensor 16384 mask 4047.0 16384
layer1.0.conv3.weight, mask/weight parameters,4047,4047 density 0.329345703125,0.329345703125
layer1.0.shortcut.0.weight, mask/weight parameters,6171,6171 density 0.37664794921875,0.37664794921875
before tensor 16384 mask 2385.0 16384
layer1.1.conv1.weight, mask/weight parameters,2385,2385 density 0.194091796875,0.194091796875
before tensor 36864 mask 3679.0 36864
layer1.1.conv2.weight, mask/weight parameters,3679,3679 density 0.17742091049382716,0.17742091049382716
before tensor 16384 mask 2304.0 16384
layer1.1.conv3.weight, mask/weight parameters,2304,2304 density 0.1875,0.1875
before tensor 16384 mask 2376.0 16384
layer1.2.conv1.weight, mask/weight parameters,2376,2376 density 0.193359375,0.193359375
before tensor 36864 mask 2300.0 36864
layer1.2.conv2.weight, mask/weight parameters,2300,2300 density 0.11091820987654322,0.11091820987654322
before tensor 16384 mask 1614.0 16384
layer1.2.conv3.weight, mask/weight parameters,1614,1614 density 0.13134765625,0.13134765625
before tensor 32768 mask 5154.0 32768
layer2.0.conv1.weight, mask/weight parameters,5154,5154 density 0.2212396978021978,0.2212396978021978
before tensor 147456 mask 13695.0 147456
layer2.0.conv2.weight, mask/weight parameters,13695,13695 density 0.18375397496276616,0.18375397496276616
before tensor 65536 mask 8204.0 65536
layer2.0.conv3.weight, mask/weight parameters,8204,8204 density 0.17608173076923078,0.17608173076923078
layer2.0.shortcut.0.weight, mask/weight parameters,28986,28986 density 0.2211456298828125,0.2211456298828125
before tensor 65536 mask 4285.0 65536
layer2.1.conv1.weight, mask/weight parameters,4285,4285 density 0.0919685782967033,0.0919685782967033
before tensor 147456 mask 6556.0 147456
layer2.1.conv2.weight, mask/weight parameters,6556,6556 density 0.08796575829542863,0.08796575829542863
before tensor 65536 mask 4430.0 65536
layer2.1.conv3.weight, mask/weight parameters,4430,4430 density 0.09508070054945054,0.09508070054945054
before tensor 65536 mask 10328.0 65536
layer2.2.conv1.weight, mask/weight parameters,10328,10328 density 0.22166895604395603,0.22166895604395603
before tensor 147456 mask 21680.0 147456
layer2.2.conv2.weight, mask/weight parameters,21680,21680 density 0.2908934777066645,0.2908934777066645
before tensor 65536 mask 12549.0 65536
layer2.2.conv3.weight, mask/weight parameters,12549,12549 density 0.26933808379120877,0.26933808379120877
before tensor 65536 mask 10402.0 65536
layer2.3.conv1.weight, mask/weight parameters,10402,10402 density 0.22325721153846154,0.22325721153846154
before tensor 147456 mask 21008.0 147456
layer2.3.conv2.weight, mask/weight parameters,21008,21008 density 0.2818768533054247,0.2818768533054247
before tensor 65536 mask 10535.0 65536
layer2.3.conv3.weight, mask/weight parameters,10535,10535 density 0.22611177884615385,0.22611177884615385
before tensor 131072 mask 29876.0 131072
layer3.0.conv1.weight, mask/weight parameters,29876,29876 density 0.33925327034883723,0.33925327034883723
before tensor 589824 mask 84257.0 589824
layer3.0.conv2.weight, mask/weight parameters,84257,84257 density 0.3164510846703924,0.3164510846703924
before tensor 262144 mask 62748.0 262144
layer3.0.conv3.weight, mask/weight parameters,62748,62748 density 0.35626362645348836,0.35626362645348836
layer3.0.shortcut.0.weight, mask/weight parameters,90808,90808 density 0.1732025146484375,0.1732025146484375
before tensor 262144 mask 29356.0 262144
layer3.1.conv1.weight, mask/weight parameters,29356,29356 density 0.16667423691860464,0.16667423691860464
before tensor 589824 mask 66252.0 589824
layer3.1.conv2.weight, mask/weight parameters,66252,66252 density 0.24882819542094825,0.24882819542094825
before tensor 262144 mask 47041.0 262144
layer3.1.conv3.weight, mask/weight parameters,47041,47041 density 0.2670841660610465,0.2670841660610465
before tensor 262144 mask 29572.0 262144
layer3.2.conv1.weight, mask/weight parameters,29572,29572 density 0.16790061773255813,0.16790061773255813
before tensor 589824 mask 59779.0 589824
layer3.2.conv2.weight, mask/weight parameters,59779,59779 density 0.22451700618953188,0.22451700618953188
before tensor 262144 mask 45424.0 262144
layer3.2.conv3.weight, mask/weight parameters,45424,45424 density 0.2579033430232558,0.2579033430232558
before tensor 262144 mask 28392.0 262144
layer3.3.conv1.weight, mask/weight parameters,28392,28392 density 0.16120094476744187,0.16120094476744187
before tensor 589824 mask 48351.0 589824
layer3.3.conv2.weight, mask/weight parameters,48351,48351 density 0.1815959076978547,0.1815959076978547
before tensor 262144 mask 38271.0 262144
layer3.3.conv3.weight, mask/weight parameters,38271,38271 density 0.2172908339389535,0.2172908339389535
before tensor 262144 mask 32192.0 262144
layer3.4.conv1.weight, mask/weight parameters,32192,32192 density 0.18277616279069767,0.18277616279069767
before tensor 589824 mask 49041.0 589824
layer3.4.conv2.weight, mask/weight parameters,49041,49041 density 0.1841873985938345,0.1841873985938345
before tensor 262144 mask 34759.0 262144
layer3.4.conv3.weight, mask/weight parameters,34759,34759 density 0.19735079033430233,0.19735079033430233
before tensor 262144 mask 38841.0 262144
layer3.5.conv1.weight, mask/weight parameters,38841,38841 density 0.22052711664244187,0.22052711664244187
before tensor 589824 mask 52844.0 589824
layer3.5.conv2.weight, mask/weight parameters,52844,52844 density 0.19847064479298118,0.19847064479298118
before tensor 262144 mask 34972.0 262144
layer3.5.conv3.weight, mask/weight parameters,34972,34972 density 0.19856013808139536,0.19856013808139536
before tensor 524288 mask 127814.0 524288
layer4.0.conv1.weight, mask/weight parameters,127814,127814 density 0.37148321242559523,0.37148321242559523
before tensor 2359296 mask 240935.0 2359296
layer4.0.conv2.weight, mask/weight parameters,240935,240935 density 0.23712581097253715,0.23712581097253715
before tensor 1048576 mask 113275.0 1048576
layer4.0.conv3.weight, mask/weight parameters,113275,113275 density 0.16461326962425596,0.16461326962425596
layer4.0.shortcut.0.weight, mask/weight parameters,149212,149212 density 0.07114982604980469,0.07114982604980469
before tensor 1048576 mask 108260.0 1048576
layer4.1.conv1.weight, mask/weight parameters,108260,108260 density 0.15732538132440477,0.15732538132440477
before tensor 2359296 mask 217537.0 2359296
layer4.1.conv2.weight, mask/weight parameters,217537,217537 density 0.21409773400100782,0.21409773400100782
before tensor 1048576 mask 96809.0 1048576
layer4.1.conv3.weight, mask/weight parameters,96809,96809 density 0.14068458193824404,0.14068458193824404
before tensor 1048576 mask 42219.0 1048576
layer4.2.conv1.weight, mask/weight parameters,42219,42219 density 0.06135341099330357,0.06135341099330357
before tensor 2359296 mask 44925.0 2359296
layer4.2.conv2.weight, mask/weight parameters,44925,44925 density 0.044214734504913075,0.044214734504913075
before tensor 1048576 mask 30547.0 1048576
layer4.2.conv3.weight, mask/weight parameters,30547,30547 density 0.044391450427827384,0.044391450427827384
classifier.weight, mask/weight parameters,101619,101619 density 0.4961865234375,0.4961865234375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.16649802430083227 0.16649802430083227 after dst
Death rate: 0.1392016186682789

dynamic sparse change grow
self.total_params*pruning_rate 3292401.13919393
self.total_nonzero 2365205.0
to grow 927196.1391939302
len(all_scores) 14205604 11338212
increse 927196.0 before_mask 3292399.0 after_mask 3292399.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1402,1303 density 0.8113425925925926,0.7540509259259259
before tensor 4096 mask 1063.0 4096
layer1.0.conv1.weight, mask/weight parameters,1063,870 density 0.3460286458333333,0.283203125
before tensor 36864 mask 5325.0 36864
layer1.0.conv2.weight, mask/weight parameters,5325,4416 density 0.25679976851851855,0.21296296296296297
before tensor 16384 mask 5078.0 16384
layer1.0.conv3.weight, mask/weight parameters,5078,4047 density 0.4132486979166667,0.329345703125
layer1.0.shortcut.0.weight, mask/weight parameters,7514,6171 density 0.4586181640625,0.37664794921875
before tensor 16384 mask 3396.0 16384
layer1.1.conv1.weight, mask/weight parameters,3396,2385 density 0.2763671875,0.194091796875
before tensor 36864 mask 4448.0 36864
layer1.1.conv2.weight, mask/weight parameters,4448,3679 density 0.21450617283950618,0.17742091049382716
before tensor 16384 mask 2964.0 16384
layer1.1.conv3.weight, mask/weight parameters,2964,2304 density 0.2412109375,0.1875
before tensor 16384 mask 3253.0 16384
layer1.2.conv1.weight, mask/weight parameters,3253,2376 density 0.2647298177083333,0.193359375
before tensor 36864 mask 3275.0 36864
layer1.2.conv2.weight, mask/weight parameters,3275,2300 density 0.15793788580246915,0.11091820987654322
before tensor 16384 mask 2145.0 16384
layer1.2.conv3.weight, mask/weight parameters,2145,1614 density 0.174560546875,0.13134765625
before tensor 32768 mask 7764.0 32768
layer2.0.conv1.weight, mask/weight parameters,7764,5154 density 0.3332760989010989,0.2212396978021978
before tensor 147456 mask 17400.0 147456
layer2.0.conv2.weight, mask/weight parameters,17400,13695 density 0.2334661675321016,0.18375397496276616
before tensor 65536 mask 10701.0 65536
layer2.0.conv3.weight, mask/weight parameters,10701,8204 density 0.22967462225274726,0.17608173076923078
layer2.0.shortcut.0.weight, mask/weight parameters,39597,28986 density 0.30210113525390625,0.2211456298828125
before tensor 65536 mask 6400.0 65536
layer2.1.conv1.weight, mask/weight parameters,6400,4285 density 0.13736263736263737,0.0919685782967033
before tensor 147456 mask 8698.0 147456
layer2.1.conv2.weight, mask/weight parameters,8698,6556 density 0.11670624857438044,0.08796575829542863
before tensor 65536 mask 6062.0 65536
layer2.1.conv3.weight, mask/weight parameters,6062,4430 density 0.13010817307692307,0.09508070054945054
before tensor 65536 mask 13936.0 65536
layer2.2.conv1.weight, mask/weight parameters,13936,10328 density 0.29910714285714285,0.22166895604395603
before tensor 147456 mask 29386.0 147456
layer2.2.conv2.weight, mask/weight parameters,29386,21680 density 0.39428947121254815,0.2908934777066645
before tensor 65536 mask 17130.0 65536
layer2.2.conv3.weight, mask/weight parameters,17130,12549 density 0.3676596840659341,0.26933808379120877
before tensor 65536 mask 13768.0 65536
layer2.3.conv1.weight, mask/weight parameters,13768,10402 density 0.29550137362637363,0.22325721153846154
before tensor 147456 mask 26503.0 147456
layer2.3.conv2.weight, mask/weight parameters,26503,21008 density 0.3556065424197292,0.2818768533054247
before tensor 65536 mask 13690.0 65536
layer2.3.conv3.weight, mask/weight parameters,13690,10535 density 0.2938272664835165,0.22611177884615385
before tensor 131072 mask 38984.0 131072
layer3.0.conv1.weight, mask/weight parameters,38984,29876 density 0.4426780523255814,0.33925327034883723
before tensor 589824 mask 110920.0 589824
layer3.0.conv2.weight, mask/weight parameters,110920,84257 density 0.4165915509885223,0.3164510846703924
before tensor 262144 mask 80261.0 262144
layer3.0.conv3.weight, mask/weight parameters,80261,62748 density 0.45569699309593026,0.35626362645348836
layer3.0.shortcut.0.weight, mask/weight parameters,128536,90808 density 0.2451629638671875,0.1732025146484375
before tensor 262144 mask 42722.0 262144
layer3.1.conv1.weight, mask/weight parameters,42722,29356 density 0.24256222747093023,0.16667423691860464
before tensor 589824 mask 97515.0 589824
layer3.1.conv2.weight, mask/weight parameters,97515,66252 density 0.3662452677122769,0.24882819542094825
before tensor 262144 mask 65107.0 262144
layer3.1.conv3.weight, mask/weight parameters,65107,47041 density 0.36965729469476744,0.2670841660610465
before tensor 262144 mask 42480.0 262144
layer3.2.conv1.weight, mask/weight parameters,42480,29572 density 0.24118822674418605,0.16790061773255813
before tensor 589824 mask 82524.0 589824
layer3.2.conv2.weight, mask/weight parameters,82524,59779 density 0.30994231115918514,0.22451700618953188
before tensor 262144 mask 62103.0 262144
layer3.2.conv3.weight, mask/weight parameters,62103,45424 density 0.35260151707848836,0.2579033430232558
before tensor 262144 mask 44607.0 262144
layer3.3.conv1.weight, mask/weight parameters,44607,28392 density 0.2532646711482558,0.16120094476744187
before tensor 589824 mask 71376.0 589824
layer3.3.conv2.weight, mask/weight parameters,71376,48351 density 0.2680728321615288,0.1815959076978547
before tensor 262144 mask 53014.0 262144
layer3.3.conv3.weight, mask/weight parameters,53014,38271 density 0.30099700218023256,0.2172908339389535
before tensor 262144 mask 50437.0 262144
layer3.4.conv1.weight, mask/weight parameters,50437,32192 density 0.286365597747093,0.18277616279069767
before tensor 589824 mask 74678.0 589824
layer3.4.conv2.weight, mask/weight parameters,74678,49041 density 0.2804744306231597,0.1841873985938345
before tensor 262144 mask 50059.0 262144
layer3.4.conv3.weight, mask/weight parameters,50059,34759 density 0.2842194313226744,0.19735079033430233
before tensor 262144 mask 52220.0 262144
layer3.5.conv1.weight, mask/weight parameters,52220,38841 density 0.29648891715116277,0.22052711664244187
before tensor 589824 mask 70840.0 589824
layer3.5.conv2.weight, mask/weight parameters,70840,52844 density 0.2660597319872604,0.19847064479298118
before tensor 262144 mask 46375.0 262144
layer3.5.conv3.weight, mask/weight parameters,46375,34972 density 0.26330282521802323,0.19856013808139536
before tensor 524288 mask 164962.0 524288
layer4.0.conv1.weight, mask/weight parameters,164962,127814 density 0.4794514973958333,0.37148321242559523
before tensor 2359296 mask 332028.0 2359296
layer4.0.conv2.weight, mask/weight parameters,332028,240935 density 0.3267786281179138,0.23712581097253715
before tensor 1048576 mask 159105.0 1048576
layer4.0.conv3.weight, mask/weight parameters,159105,113275 density 0.23121425083705358,0.16461326962425596
layer4.0.shortcut.0.weight, mask/weight parameters,226496,149212 density 0.108001708984375,0.07114982604980469
before tensor 1048576 mask 144116.0 1048576
layer4.1.conv1.weight, mask/weight parameters,144116,108260 density 0.20943196614583334,0.15732538132440477
before tensor 2359296 mask 294140.0 2359296
layer4.1.conv2.weight, mask/weight parameters,294140,217537 density 0.28948963844797176,0.21409773400100782
before tensor 1048576 mask 142006.0 1048576
layer4.1.conv3.weight, mask/weight parameters,142006,96809 density 0.2063656761532738,0.14068458193824404
before tensor 1048576 mask 65865.0 1048576
layer4.2.conv1.weight, mask/weight parameters,65865,42219 density 0.09571620396205358,0.06135341099330357
before tensor 2359296 mask 80087.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80087,44925 density 0.07882082231040564,0.044214734504913075
before tensor 1048576 mask 52026.0 1048576
layer4.2.conv3.weight, mask/weight parameters,52026,30547 density 0.07560511997767858,0.044391450427827384
classifier.weight, mask/weight parameters,115912,101619 density 0.5659765625,0.4961865234375
Total Model parameters after dst: 3292399 2365205
Total parameters under density level of 0.1: 0.23176761790628544 0.16649802430083227 after dst
Death rate: 0.1392016186682789


Training summary: Average loss: 1.3286, Accuracy: 30993/50000 (61.986%)


Evaluation: Average loss: 1.6324, Accuracy: 5604/10000 (56.040%)

Current learning rate: 0.1. Time taken for epoch: 88.77 seconds.

Train Epoch: 40 [0/50000 (0%)]	Loss: 1.140641 Accuracy: 71/100 (71.000%
Train Epoch: 40 [10000/50000 (20%)]	Loss: 1.266768 Accuracy: 6301/10100 (62.386%
Train Epoch: 40 [20000/50000 (40%)]	Loss: 1.121913 Accuracy: 12591/20100 (62.642%
Train Epoch: 40 [30000/50000 (60%)]	Loss: 1.102088 Accuracy: 18765/30100 (62.342%
Train Epoch: 40 [40000/50000 (80%)]	Loss: 1.209767 Accuracy: 24979/40100 (62.292%
current layer rate 0.3395609922621757
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5096.0
Total filter_masks items: 11230180.0
5096.0 / 7552 channels
Total channels to prune: 108.36461356395012
Layer ('layer1', 0, 'conv1'): Pruned 1/48.0 channels based on HE
Layer ('layer1', 0, 'conv2'): Pruned 1/48.0 channels based on HE
Layer ('layer1', 1, 'conv1'): Pruned 1/48.0 channels based on HE
Layer ('layer1', 1, 'conv2'): Pruned 1/48.0 channels based on HE
Layer ('layer1', 2, 'conv1'): Pruned 1/48.0 channels based on HE
Layer ('layer1', 2, 'conv2'): Pruned 1/48.0 channels based on HE
Layer ('layer2', 0, 'conv1'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/91.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/91.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/172.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/172.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 7/336.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 7/336.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 7/336.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 7/336.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 7/336.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 7/336.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 5004.0
Total filter_masks items: 10920812.0
After apply_mask:
Total filter_names items: 5004.0
Total filter_masks items: 10920812.0
Total pruned: 92/108.36461356395012 channels
===========done ===============

Training summary: Average loss: 1.3160, Accuracy: 31137/50000 (62.274%)


Evaluation: Average loss: 1.6234, Accuracy: 5549/10000 (55.490%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 41 [0/50000 (0%)]	Loss: 1.073237 Accuracy: 67/100 (67.000%
Train Epoch: 41 [10000/50000 (20%)]	Loss: 1.384635 Accuracy: 6314/10100 (62.515%
Train Epoch: 41 [20000/50000 (40%)]	Loss: 1.164362 Accuracy: 12544/20100 (62.408%
Train Epoch: 41 [30000/50000 (60%)]	Loss: 1.404429 Accuracy: 18784/30100 (62.405%
Train Epoch: 41 [40000/50000 (80%)]	Loss: 1.427871 Accuracy: 24860/40100 (61.995%
current mest  death_rate 0.13819100610265317


dynamic sparse change prune
to kill 831647.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1291,1291 density 0.7471064814814815,0.7471064814814815
before tensor 4096 mask 810.0 4096
layer1.0.conv1.weight, mask/weight parameters,810,810 density 0.269281914893617,0.269281914893617
before tensor 36864 mask 4128.0 36864
layer1.0.conv2.weight, mask/weight parameters,4128,4128 density 0.20763543081333938,0.20763543081333938
before tensor 16384 mask 3966.0 16384
layer1.0.conv3.weight, mask/weight parameters,3966,3966 density 0.32962101063829785,0.32962101063829785
layer1.0.shortcut.0.weight, mask/weight parameters,6118,6118 density 0.3734130859375,0.3734130859375
before tensor 16384 mask 2334.0 16384
layer1.1.conv1.weight, mask/weight parameters,2334,2334 density 0.19398271276595744,0.19398271276595744
before tensor 36864 mask 3400.0 36864
layer1.1.conv2.weight, mask/weight parameters,3400,3400 density 0.17101755444897138,0.17101755444897138
before tensor 16384 mask 2184.0 16384
layer1.1.conv3.weight, mask/weight parameters,2184,2184 density 0.1815159574468085,0.1815159574468085
before tensor 16384 mask 2333.0 16384
layer1.2.conv1.weight, mask/weight parameters,2333,2333 density 0.19389960106382978,0.19389960106382978
before tensor 36864 mask 2493.0 36864
layer1.2.conv2.weight, mask/weight parameters,2493,2493 density 0.12539610683567226,0.12539610683567226
before tensor 16384 mask 1613.0 16384
layer1.2.conv3.weight, mask/weight parameters,1613,1613 density 0.1340591755319149,0.1340591755319149
before tensor 32768 mask 5413.0 32768
layer2.0.conv1.weight, mask/weight parameters,5413,5413 density 0.23493923611111112,0.23493923611111112
before tensor 147456 mask 13687.0 147456
layer2.0.conv2.weight, mask/weight parameters,13687,13687 density 0.18775034293552811,0.18775034293552811
before tensor 65536 mask 8292.0 65536
layer2.0.conv3.weight, mask/weight parameters,8292,8292 density 0.17994791666666668,0.17994791666666668
layer2.0.shortcut.0.weight, mask/weight parameters,29139,29139 density 0.22231292724609375,0.22231292724609375
before tensor 65536 mask 4394.0 65536
layer2.1.conv1.weight, mask/weight parameters,4394,4394 density 0.09535590277777778,0.09535590277777778
before tensor 147456 mask 6293.0 147456
layer2.1.conv2.weight, mask/weight parameters,6293,6293 density 0.08632373113854595,0.08632373113854595
before tensor 65536 mask 4329.0 65536
layer2.1.conv3.weight, mask/weight parameters,4329,4329 density 0.0939453125,0.0939453125
before tensor 65536 mask 10521.0 65536
layer2.2.conv1.weight, mask/weight parameters,10521,10521 density 0.2283203125,0.2283203125
before tensor 147456 mask 22162.0 147456
layer2.2.conv2.weight, mask/weight parameters,22162,22162 density 0.3040054869684499,0.3040054869684499
before tensor 65536 mask 12697.0 65536
layer2.2.conv3.weight, mask/weight parameters,12697,12697 density 0.27554253472222223,0.27554253472222223
before tensor 65536 mask 10316.0 65536
layer2.3.conv1.weight, mask/weight parameters,10316,10316 density 0.22387152777777777,0.22387152777777777
before tensor 147456 mask 20821.0 147456
layer2.3.conv2.weight, mask/weight parameters,20821,20821 density 0.28561042524005487,0.28561042524005487
before tensor 65536 mask 10407.0 65536
layer2.3.conv3.weight, mask/weight parameters,10407,10407 density 0.22584635416666668,0.22584635416666668
before tensor 131072 mask 29683.0 131072
layer3.0.conv1.weight, mask/weight parameters,29683,29683 density 0.34304502588757396,0.34304502588757396
before tensor 589824 mask 82440.0 589824
layer3.0.conv2.weight, mask/weight parameters,82440,82440 density 0.32071706172753056,0.32071706172753056
before tensor 262144 mask 62608.0 262144
layer3.0.conv3.weight, mask/weight parameters,62608,62608 density 0.36177884615384615,0.36177884615384615
layer3.0.shortcut.0.weight, mask/weight parameters,93128,93128 density 0.1776275634765625,0.1776275634765625
before tensor 262144 mask 30273.0 262144
layer3.1.conv1.weight, mask/weight parameters,30273,30273 density 0.17493181397928995,0.17493181397928995
before tensor 589824 mask 68148.0 589824
layer3.1.conv2.weight, mask/weight parameters,68148,68148 density 0.2651167676201814,0.2651167676201814
before tensor 262144 mask 48056.0 262144
layer3.1.conv3.weight, mask/weight parameters,48056,48056 density 0.27769045857988167,0.27769045857988167
before tensor 262144 mask 30103.0 262144
layer3.2.conv1.weight, mask/weight parameters,30103,30103 density 0.17394947300295857,0.17394947300295857
before tensor 589824 mask 59749.0 589824
layer3.2.conv2.weight, mask/weight parameters,59749,59749 density 0.23244206357542727,0.23244206357542727
before tensor 262144 mask 46228.0 262144
layer3.2.conv3.weight, mask/weight parameters,46228,46228 density 0.26712740384615385,0.26712740384615385
before tensor 262144 mask 30808.0 262144
layer3.3.conv1.weight, mask/weight parameters,30808,30808 density 0.17802329881656806,0.17802329881656806
before tensor 589824 mask 49819.0 589824
layer3.3.conv2.weight, mask/weight parameters,49819,49819 density 0.19381129667884334,0.19381129667884334
before tensor 262144 mask 38865.0 262144
layer3.3.conv3.weight, mask/weight parameters,38865,38865 density 0.2245804826183432,0.2245804826183432
before tensor 262144 mask 35023.0 262144
layer3.4.conv1.weight, mask/weight parameters,35023,35023 density 0.20237957655325445,0.20237957655325445
before tensor 589824 mask 51408.0 589824
layer3.4.conv2.weight, mask/weight parameters,51408,51408 density 0.1999929974440671,0.1999929974440671
before tensor 262144 mask 36062.0 262144
layer3.4.conv3.weight, mask/weight parameters,36062,36062 density 0.20838341346153846,0.20838341346153846
before tensor 262144 mask 38034.0 262144
layer3.5.conv1.weight, mask/weight parameters,38034,38034 density 0.21977856878698224,0.21977856878698224
before tensor 589824 mask 50793.0 589824
layer3.5.conv2.weight, mask/weight parameters,50793,50793 density 0.19760045750032096,0.19760045750032096
before tensor 262144 mask 34022.0 262144
layer3.5.conv3.weight, mask/weight parameters,34022,34022 density 0.19659532174556213,0.19659532174556213
before tensor 524288 mask 127948.0 524288
layer4.0.conv1.weight, mask/weight parameters,127948,127948 density 0.3797848594224924,0.3797848594224924
before tensor 2359296 mask 236988.0 2359296
layer4.0.conv2.weight, mask/weight parameters,236988,236988 density 0.24327195794569526,0.24327195794569526
before tensor 1048576 mask 112118.0 1048576
layer4.0.conv3.weight, mask/weight parameters,112118,112118 density 0.16639853248480244,0.16639853248480244
layer4.0.shortcut.0.weight, mask/weight parameters,147006,147006 density 0.0700979232788086,0.0700979232788086
before tensor 1048576 mask 106193.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106193,106193 density 0.15760501757218845,0.15760501757218845
before tensor 2359296 mask 213397.0 2359296
layer4.1.conv2.weight, mask/weight parameters,213397,213397 density 0.21905542056871036,0.21905542056871036
before tensor 1048576 mask 97575.0 1048576
layer4.1.conv3.weight, mask/weight parameters,97575,97575 density 0.14481472026975684,0.14481472026975684
before tensor 1048576 mask 41950.0 1048576
layer4.2.conv1.weight, mask/weight parameters,41950,41950 density 0.062259569718844984,0.062259569718844984
before tensor 2359296 mask 44340.0 2359296
layer4.2.conv2.weight, mask/weight parameters,44340,44340 density 0.04551571647219322,0.04551571647219322
before tensor 1048576 mask 30696.0 1048576
layer4.2.conv3.weight, mask/weight parameters,30696,30696 density 0.0455570858662614,0.0455570858662614
classifier.weight, mask/weight parameters,102603,102603 density 0.5009912109375,0.5009912109375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.1702047230631374 0.1702047230631374 after dst
Death rate: 0.13819100610265317

dynamic sparse change grow
self.total_params*pruning_rate 3268498.098452148
self.total_nonzero 2365205.0
to grow 903293.098452148
len(all_scores) 13896236 10964158
increse 903293.0 before_mask 3268497.0 after_mask 3268497.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1366,1291 density 0.7905092592592593,0.7471064814814815
before tensor 4096 mask 941.0 4096
layer1.0.conv1.weight, mask/weight parameters,941,810 density 0.31283244680851063,0.269281914893617
before tensor 36864 mask 5252.0 36864
layer1.0.conv2.weight, mask/weight parameters,5252,4128 density 0.2641718223429405,0.20763543081333938
before tensor 16384 mask 5229.0 16384
layer1.0.conv3.weight, mask/weight parameters,5229,3966 density 0.4345910904255319,0.32962101063829785
layer1.0.shortcut.0.weight, mask/weight parameters,7216,6118 density 0.4404296875,0.3734130859375
before tensor 16384 mask 3105.0 16384
layer1.1.conv1.weight, mask/weight parameters,3105,2334 density 0.258061835106383,0.19398271276595744
before tensor 36864 mask 4321.0 36864
layer1.1.conv2.weight, mask/weight parameters,4321,3400 density 0.21734319199235452,0.17101755444897138
before tensor 16384 mask 2947.0 16384
layer1.1.conv3.weight, mask/weight parameters,2947,2184 density 0.24493018617021275,0.1815159574468085
before tensor 16384 mask 3419.0 16384
layer1.2.conv1.weight, mask/weight parameters,3419,2333 density 0.2841589095744681,0.19389960106382978
before tensor 36864 mask 3476.0 36864
layer1.2.conv2.weight, mask/weight parameters,3476,2493 density 0.1748402997837131,0.12539610683567226
before tensor 16384 mask 2223.0 16384
layer1.2.conv3.weight, mask/weight parameters,2223,1613 density 0.18475731382978725,0.1340591755319149
before tensor 32768 mask 7727.0 32768
layer2.0.conv1.weight, mask/weight parameters,7727,5413 density 0.3353732638888889,0.23493923611111112
before tensor 147456 mask 17423.0 147456
layer2.0.conv2.weight, mask/weight parameters,17423,13687 density 0.2389986282578875,0.18775034293552811
before tensor 65536 mask 10683.0 65536
layer2.0.conv3.weight, mask/weight parameters,10683,8292 density 0.2318359375,0.17994791666666668
layer2.0.shortcut.0.weight, mask/weight parameters,40302,29139 density 0.3074798583984375,0.22231292724609375
before tensor 65536 mask 6834.0 65536
layer2.1.conv1.weight, mask/weight parameters,6834,4394 density 0.14830729166666667,0.09535590277777778
before tensor 147456 mask 8885.0 147456
layer2.1.conv2.weight, mask/weight parameters,8885,6293 density 0.12187928669410152,0.08632373113854595
before tensor 65536 mask 6187.0 65536
layer2.1.conv3.weight, mask/weight parameters,6187,4329 density 0.13426649305555555,0.0939453125
before tensor 65536 mask 14005.0 65536
layer2.2.conv1.weight, mask/weight parameters,14005,10521 density 0.3039279513888889,0.2283203125
before tensor 147456 mask 30151.0 147456
layer2.2.conv2.weight, mask/weight parameters,30151,22162 density 0.4135939643347051,0.3040054869684499
before tensor 65536 mask 17675.0 65536
layer2.2.conv3.weight, mask/weight parameters,17675,12697 density 0.3835720486111111,0.27554253472222223
before tensor 65536 mask 16426.0 65536
layer2.3.conv1.weight, mask/weight parameters,16426,10316 density 0.3564670138888889,0.22387152777777777
before tensor 147456 mask 29392.0 147456
layer2.3.conv2.weight, mask/weight parameters,29392,20821 density 0.40318244170096024,0.28561042524005487
before tensor 65536 mask 14625.0 65536
layer2.3.conv3.weight, mask/weight parameters,14625,10407 density 0.3173828125,0.22584635416666668
before tensor 131072 mask 40163.0 131072
layer3.0.conv1.weight, mask/weight parameters,40163,29683 density 0.4641618897928994,0.34304502588757396
before tensor 589824 mask 110894.0 589824
layer3.0.conv2.weight, mask/weight parameters,110894,82440 density 0.43141190979151833,0.32071706172753056
before tensor 262144 mask 80406.0 262144
layer3.0.conv3.weight, mask/weight parameters,80406,62608 density 0.4646241678994083,0.36177884615384615
layer3.0.shortcut.0.weight, mask/weight parameters,132676,93128 density 0.25305938720703125,0.1776275634765625
before tensor 262144 mask 41954.0 262144
layer3.1.conv1.weight, mask/weight parameters,41954,30273 density 0.24243019600591717,0.17493181397928995
before tensor 589824 mask 99514.0 589824
layer3.1.conv2.weight, mask/weight parameters,99514,68148 density 0.38714019506008585,0.2651167676201814
before tensor 262144 mask 64715.0 262144
layer3.1.conv3.weight, mask/weight parameters,64715,48056 density 0.37395409578402367,0.27769045857988167
before tensor 262144 mask 42076.0 262144
layer3.2.conv1.weight, mask/weight parameters,42076,30103 density 0.2431351701183432,0.17394947300295857
before tensor 589824 mask 79869.0 589824
layer3.2.conv2.weight, mask/weight parameters,79869,59749 density 0.3107150776700162,0.23244206357542727
before tensor 262144 mask 61836.0 262144
layer3.2.conv3.weight, mask/weight parameters,61836,46228 density 0.3573178624260355,0.26712740384615385
before tensor 262144 mask 42080.0 262144
layer3.3.conv1.weight, mask/weight parameters,42080,30808 density 0.24315828402366865,0.17802329881656806
before tensor 589824 mask 68615.0 589824
layer3.3.conv2.weight, mask/weight parameters,68615,49819 density 0.2669335418538878,0.19381129667884334
before tensor 262144 mask 53219.0 262144
layer3.3.conv3.weight, mask/weight parameters,53219,38865 density 0.3075247318786982,0.2245804826183432
before tensor 262144 mask 46379.0 262144
layer3.4.conv1.weight, mask/weight parameters,46379,35023 density 0.2679999537721893,0.20237957655325445
before tensor 589824 mask 66877.0 589824
layer3.4.conv2.weight, mask/weight parameters,66877,51408 density 0.2601721850697727,0.1999929974440671
before tensor 262144 mask 47881.0 262144
layer3.4.conv3.weight, mask/weight parameters,47881,36062 density 0.2766792252218935,0.20838341346153846
before tensor 262144 mask 51316.0 262144
layer3.5.conv1.weight, mask/weight parameters,51316,38034 density 0.29652829142011833,0.21977856878698224
before tensor 589824 mask 68542.0 589824
layer3.5.conv2.weight, mask/weight parameters,68542,50793 density 0.26664954930771956,0.19760045750032096
before tensor 262144 mask 46870.0 262144
layer3.5.conv3.weight, mask/weight parameters,46870,34022 density 0.27083718565088755,0.19659532174556213
before tensor 524288 mask 165289.0 524288
layer4.0.conv1.weight, mask/weight parameters,165289,127948 density 0.4906232190349544,0.3797848594224924
before tensor 2359296 mask 329075.0 2359296
layer4.0.conv2.weight, mask/weight parameters,329075,236988 density 0.33780073067404115,0.24327195794569526
before tensor 1048576 mask 159094.0 1048576
layer4.0.conv3.weight, mask/weight parameters,159094,112118 density 0.23611737746960487,0.16639853248480244
layer4.0.shortcut.0.weight, mask/weight parameters,224715,147006 density 0.10715246200561523,0.0700979232788086
before tensor 1048576 mask 148440.0 1048576
layer4.1.conv1.weight, mask/weight parameters,148440,106193 density 0.22030537613981763,0.15760501757218845
before tensor 2359296 mask 289950.0 2359296
layer4.1.conv2.weight, mask/weight parameters,289950,213397 density 0.29763829479279263,0.21905542056871036
before tensor 1048576 mask 135399.0 1048576
layer4.1.conv3.weight, mask/weight parameters,135399,97575 density 0.2009507385068389,0.14481472026975684
before tensor 1048576 mask 69150.0 1048576
layer4.2.conv1.weight, mask/weight parameters,69150,41950 density 0.10262811075227964,0.062259569718844984
before tensor 2359296 mask 80238.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80238,44340 density 0.08236558543743437,0.04551571647219322
before tensor 1048576 mask 47223.0 1048576
layer4.2.conv3.weight, mask/weight parameters,47223,30696 density 0.07008542695668693,0.0455570858662614
classifier.weight, mask/weight parameters,114232,102603 density 0.5577734375,0.5009912109375
Total Model parameters after dst: 3268497 2365205
Total parameters under density level of 0.1: 0.23520736118759064 0.1702047230631374 after dst
Death rate: 0.13819100610265317


Training summary: Average loss: 1.3242, Accuracy: 30984/50000 (61.968%)


Evaluation: Average loss: 1.7078, Accuracy: 5459/10000 (54.590%)

Current learning rate: 0.1. Time taken for epoch: 88.76 seconds.

Train Epoch: 42 [0/50000 (0%)]	Loss: 1.458586 Accuracy: 59/100 (59.000%
Train Epoch: 42 [10000/50000 (20%)]	Loss: 1.322069 Accuracy: 6259/10100 (61.970%
Train Epoch: 42 [20000/50000 (40%)]	Loss: 1.338786 Accuracy: 12561/20100 (62.493%
Train Epoch: 42 [30000/50000 (60%)]	Loss: 1.041018 Accuracy: 18747/30100 (62.282%
Train Epoch: 42 [40000/50000 (80%)]	Loss: 1.144187 Accuracy: 24827/40100 (61.913%
current layer rate 0.35013586709148836
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 5004.0
Total filter_masks items: 10920812.0
5004.0 / 7552 channels
Total channels to prune: 96.22606827492018
Layer ('layer2', 0, 'conv1'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/90.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/90.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/169.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/169.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/329.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/329.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/329.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/329.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/329.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/329.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4924.0
Total filter_masks items: 10647722.0
After apply_mask:
Total filter_names items: 4924.0
Total filter_masks items: 10647722.0
Total pruned: 80/96.22606827492018 channels
===========done ===============

Training summary: Average loss: 1.3206, Accuracy: 31036/50000 (62.072%)


Evaluation: Average loss: 1.6491, Accuracy: 5551/10000 (55.510%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 43 [0/50000 (0%)]	Loss: 1.214463 Accuracy: 65/100 (65.000%
Train Epoch: 43 [10000/50000 (20%)]	Loss: 1.256642 Accuracy: 6406/10100 (63.426%
Train Epoch: 43 [20000/50000 (40%)]	Loss: 1.170853 Accuracy: 12666/20100 (63.015%
Train Epoch: 43 [30000/50000 (60%)]	Loss: 1.453647 Accuracy: 18848/30100 (62.618%
Train Epoch: 43 [40000/50000 (80%)]	Loss: 1.593390 Accuracy: 25033/40100 (62.426%
current mest  death_rate 0.1371495853310652


dynamic sparse change prune
to kill 812015.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1242,1242 density 0.71875,0.71875
before tensor 4096 mask 817.0 4096
layer1.0.conv1.weight, mask/weight parameters,817,817 density 0.2716090425531915,0.2716090425531915
before tensor 36864 mask 4258.0 36864
layer1.0.conv2.weight, mask/weight parameters,4258,4258 density 0.21417433730697652,0.21417433730697652
before tensor 16384 mask 4060.0 16384
layer1.0.conv3.weight, mask/weight parameters,4060,4060 density 0.33743351063829785,0.33743351063829785
layer1.0.shortcut.0.weight, mask/weight parameters,6021,6021 density 0.36749267578125,0.36749267578125
before tensor 16384 mask 2306.0 16384
layer1.1.conv1.weight, mask/weight parameters,2306,2306 density 0.19165558510638298,0.19165558510638298
before tensor 36864 mask 3542.0 36864
layer1.1.conv2.weight, mask/weight parameters,3542,3542 density 0.17816005231125195,0.17816005231125195
before tensor 16384 mask 2246.0 16384
layer1.1.conv3.weight, mask/weight parameters,2246,2246 density 0.18666888297872342,0.18666888297872342
before tensor 16384 mask 2575.0 16384
layer1.2.conv1.weight, mask/weight parameters,2575,2575 density 0.21401263297872342,0.21401263297872342
before tensor 36864 mask 2679.0 36864
layer1.2.conv2.weight, mask/weight parameters,2679,2679 density 0.1347517730496454,0.1347517730496454
before tensor 16384 mask 1690.0 16384
layer1.2.conv3.weight, mask/weight parameters,1690,1690 density 0.14045877659574468,0.14045877659574468
before tensor 32768 mask 5448.0 32768
layer2.0.conv1.weight, mask/weight parameters,5448,5448 density 0.23911516853932585,0.23911516853932585
before tensor 147456 mask 13706.0 147456
layer2.0.conv2.weight, mask/weight parameters,13706,13706 density 0.19225967540574282,0.19225967540574282
before tensor 65536 mask 8168.0 65536
layer2.0.conv3.weight, mask/weight parameters,8168,8168 density 0.17924859550561797,0.17924859550561797
layer2.0.shortcut.0.weight, mask/weight parameters,29557,29557 density 0.22550201416015625,0.22550201416015625
before tensor 65536 mask 4497.0 65536
layer2.1.conv1.weight, mask/weight parameters,4497,4497 density 0.09868767556179775,0.09868767556179775
before tensor 147456 mask 6141.0 147456
layer2.1.conv2.weight, mask/weight parameters,6141,6141 density 0.08614232209737828,0.08614232209737828
before tensor 65536 mask 4177.0 65536
layer2.1.conv3.weight, mask/weight parameters,4177,4177 density 0.09166520365168539,0.09166520365168539
before tensor 65536 mask 10693.0 65536
layer2.2.conv1.weight, mask/weight parameters,10693,10693 density 0.23466028792134833,0.23466028792134833
before tensor 147456 mask 22778.0 147456
layer2.2.conv2.weight, mask/weight parameters,22778,22778 density 0.3195163349184306,0.3195163349184306
before tensor 65536 mask 13084.0 65536
layer2.2.conv3.weight, mask/weight parameters,13084,13084 density 0.2871313202247191,0.2871313202247191
before tensor 65536 mask 11594.0 65536
layer2.3.conv1.weight, mask/weight parameters,11594,11594 density 0.25443293539325845,0.25443293539325845
before tensor 147456 mask 22247.0 147456
layer2.3.conv2.weight, mask/weight parameters,22247,22247 density 0.3120677804429856,0.3120677804429856
before tensor 65536 mask 11020.0 65536
layer2.3.conv3.weight, mask/weight parameters,11020,11020 density 0.24183637640449437,0.24183637640449437
before tensor 131072 mask 30263.0 131072
layer3.0.conv1.weight, mask/weight parameters,30263,30263 density 0.3560688064759036,0.3560688064759036
before tensor 589824 mask 82501.0 589824
layer3.0.conv2.weight, mask/weight parameters,82501,82501 density 0.33265995709746615,0.33265995709746615
before tensor 262144 mask 62521.0 262144
layer3.0.conv3.weight, mask/weight parameters,62521,62521 density 0.36780520519578314,0.36780520519578314
layer3.0.shortcut.0.weight, mask/weight parameters,95320,95320 density 0.1818084716796875,0.1818084716796875
before tensor 262144 mask 29942.0 262144
layer3.1.conv1.weight, mask/weight parameters,29942,29942 density 0.17614599021084337,0.17614599021084337
before tensor 589824 mask 68642.0 589824
layer3.1.conv2.weight, mask/weight parameters,68642,68642 density 0.2767777939065499,0.2767777939065499
before tensor 262144 mask 47758.0 262144
layer3.1.conv3.weight, mask/weight parameters,47758,47758 density 0.2809558546686747,0.2809558546686747
before tensor 262144 mask 30000.0 262144
layer3.2.conv1.weight, mask/weight parameters,30000,30000 density 0.1764871987951807,0.1764871987951807
before tensor 589824 mask 58061.0 589824
layer3.2.conv2.weight, mask/weight parameters,58061,58061 density 0.23411315946516992,0.23411315946516992
before tensor 262144 mask 46482.0 262144
layer3.2.conv3.weight, mask/weight parameters,46482,46482 density 0.273449265813253,0.273449265813253
before tensor 262144 mask 30096.0 262144
layer3.3.conv1.weight, mask/weight parameters,30096,30096 density 0.1770519578313253,0.1770519578313253
before tensor 589824 mask 49372.0 589824
layer3.3.conv2.weight, mask/weight parameters,49372,49372 density 0.19907743423493168,0.19907743423493168
before tensor 262144 mask 38775.0 262144
layer3.3.conv3.weight, mask/weight parameters,38775,38775 density 0.2281097044427711,0.2281097044427711
before tensor 262144 mask 33504.0 262144
layer3.4.conv1.weight, mask/weight parameters,33504,33504 density 0.19710090361445784,0.19710090361445784
before tensor 589824 mask 48499.0 589824
layer3.4.conv2.weight, mask/weight parameters,48499,48499 density 0.19555732972048837,0.19555732972048837
before tensor 262144 mask 35031.0 262144
layer3.4.conv3.weight, mask/weight parameters,35031,35031 density 0.20608410203313254,0.20608410203313254
before tensor 262144 mask 37861.0 262144
layer3.5.conv1.weight, mask/weight parameters,37861,37861 density 0.22273272778614459,0.22273272778614459
before tensor 589824 mask 50032.0 589824
layer3.5.conv2.weight, mask/weight parameters,50032,50032 density 0.2017386816341672,0.2017386816341672
before tensor 262144 mask 34320.0 262144
layer3.5.conv3.weight, mask/weight parameters,34320,34320 density 0.20190135542168675,0.20190135542168675
before tensor 524288 mask 129292.0 524288
layer4.0.conv1.weight, mask/weight parameters,129292,129292 density 0.39090315402476783,0.39090315402476783
before tensor 2359296 mask 236221.0 2359296
layer4.0.conv2.weight, mask/weight parameters,236221,236221 density 0.2515770090557542,0.2515770090557542
before tensor 1048576 mask 111999.0 1048576
layer4.0.conv3.weight, mask/weight parameters,111999,111999 density 0.16930963380417957,0.16930963380417957
layer4.0.shortcut.0.weight, mask/weight parameters,146984,146984 density 0.07008743286132812,0.07008743286132812
before tensor 1048576 mask 108000.0 1048576
layer4.1.conv1.weight, mask/weight parameters,108000,108000 density 0.16326431888544893,0.16326431888544893
before tensor 2359296 mask 211853.0 2359296
layer4.1.conv2.weight, mask/weight parameters,211853,211853 density 0.22562491945884866,0.22562491945884866
before tensor 1048576 mask 95277.0 1048576
layer4.1.conv3.weight, mask/weight parameters,95277,95277 density 0.14403087509674922,0.14403087509674922
before tensor 1048576 mask 43312.0 1048576
layer4.2.conv1.weight, mask/weight parameters,43312,43312 density 0.0654750386996904,0.0654750386996904
before tensor 2359296 mask 46282.0 2359296
layer4.2.conv2.weight, mask/weight parameters,46282,46282 density 0.04929065211441157,0.04929065211441157
before tensor 1048576 mask 30317.0 1048576
layer4.2.conv3.weight, mask/weight parameters,30317,30317 density 0.0458304107004644,0.0458304107004644
classifier.weight, mask/weight parameters,102142,102142 density 0.498740234375,0.498740234375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.17361665213013205 0.17361665213013205 after dst
Death rate: 0.1371495853310652

dynamic sparse change grow
self.total_params*pruning_rate 3243866.3810370844
self.total_nonzero 2365205.0
to grow 878661.3810370844
len(all_scores) 13623146 10666451
increse 878661.0 before_mask 3243865.0 after_mask 3243865.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1322,1242 density 0.7650462962962963,0.71875
before tensor 4096 mask 916.0 4096
layer1.0.conv1.weight, mask/weight parameters,916,817 density 0.3045212765957447,0.2716090425531915
before tensor 36864 mask 5119.0 36864
layer1.0.conv2.weight, mask/weight parameters,5119,4258 density 0.2574820180071425,0.21417433730697652
before tensor 16384 mask 4975.0 16384
layer1.0.conv3.weight, mask/weight parameters,4975,4060 density 0.4134807180851064,0.33743351063829785
layer1.0.shortcut.0.weight, mask/weight parameters,7099,6021 density 0.43328857421875,0.36749267578125
before tensor 16384 mask 3282.0 16384
layer1.1.conv1.weight, mask/weight parameters,3282,2306 density 0.27277260638297873,0.19165558510638298
before tensor 36864 mask 4296.0 36864
layer1.1.conv2.weight, mask/weight parameters,4296,3542 density 0.21608570997434737,0.17816005231125195
before tensor 16384 mask 2787.0 16384
layer1.1.conv3.weight, mask/weight parameters,2787,2246 density 0.23163231382978725,0.18666888297872342
before tensor 16384 mask 3003.0 16384
layer1.2.conv1.weight, mask/weight parameters,3003,2575 density 0.2495844414893617,0.21401263297872342
before tensor 36864 mask 3219.0 36864
layer1.2.conv2.weight, mask/weight parameters,3219,2679 density 0.16191338463859967,0.1347517730496454
before tensor 16384 mask 2276.0 16384
layer1.2.conv3.weight, mask/weight parameters,2276,1690 density 0.1891622340425532,0.14045877659574468
before tensor 32768 mask 7782.0 32768
layer2.0.conv1.weight, mask/weight parameters,7782,5448 density 0.3415554775280899,0.23911516853932585
before tensor 147456 mask 17536.0 147456
layer2.0.conv2.weight, mask/weight parameters,17536,13706 density 0.24598465401394323,0.19225967540574282
before tensor 65536 mask 10538.0 65536
layer2.0.conv3.weight, mask/weight parameters,10538,8168 density 0.23125877808988765,0.17924859550561797
layer2.0.shortcut.0.weight, mask/weight parameters,40989,29557 density 0.31272125244140625,0.22550201416015625
before tensor 65536 mask 6166.0 65536
layer2.1.conv1.weight, mask/weight parameters,6166,4497 density 0.13531425561797752,0.09868767556179775
before tensor 147456 mask 7967.0 147456
layer2.1.conv2.weight, mask/weight parameters,7967,6141 density 0.11175637195079184,0.08614232209737828
before tensor 65536 mask 5539.0 65536
layer2.1.conv3.weight, mask/weight parameters,5539,4177 density 0.12155459971910113,0.09166520365168539
before tensor 65536 mask 13502.0 65536
layer2.2.conv1.weight, mask/weight parameters,13502,10693 density 0.29630442415730335,0.23466028792134833
before tensor 147456 mask 28413.0 147456
layer2.2.conv2.weight, mask/weight parameters,28413,22778 density 0.3985607877793208,0.3195163349184306
before tensor 65536 mask 16596.0 65536
layer2.2.conv3.weight, mask/weight parameters,16596,13084 density 0.36420294943820225,0.2871313202247191
before tensor 65536 mask 15152.0 65536
layer2.3.conv1.weight, mask/weight parameters,15152,11594 density 0.3325140449438202,0.25443293539325845
before tensor 147456 mask 27662.0 147456
layer2.3.conv2.weight, mask/weight parameters,27662,22247 density 0.38802620320105485,0.3120677804429856
before tensor 65536 mask 13821.0 65536
layer2.3.conv3.weight, mask/weight parameters,13821,11020 density 0.30330495084269665,0.24183637640449437
before tensor 131072 mask 39622.0 131072
layer3.0.conv1.weight, mask/weight parameters,39622,30263 density 0.4661850527108434,0.3560688064759036
before tensor 589824 mask 107201.0 589824
layer3.0.conv2.weight, mask/weight parameters,107201,82501 density 0.43225512491734003,0.33265995709746615
before tensor 262144 mask 79500.0 262144
layer3.0.conv3.weight, mask/weight parameters,79500,62521 density 0.46769107680722893,0.36780520519578314
layer3.0.shortcut.0.weight, mask/weight parameters,130514,95320 density 0.24893569946289062,0.1818084716796875
before tensor 262144 mask 38686.0 262144
layer3.1.conv1.weight, mask/weight parameters,38686,29942 density 0.22758612575301204,0.17614599021084337
before tensor 589824 mask 91023.0 589824
layer3.1.conv2.weight, mask/weight parameters,91023,68642 density 0.3670223060918372,0.2767777939065499
before tensor 262144 mask 63206.0 262144
layer3.1.conv3.weight, mask/weight parameters,63206,47758 density 0.37183499623493976,0.2809558546686747
before tensor 262144 mask 41912.0 262144
layer3.2.conv1.weight, mask/weight parameters,41912,30000 density 0.24656438253012047,0.1764871987951807
before tensor 589824 mask 81996.0 589824
layer3.2.conv2.weight, mask/weight parameters,81996,58061 density 0.3306236996177481,0.23411315946516992
before tensor 262144 mask 61779.0 262144
layer3.2.conv3.weight, mask/weight parameters,61779,46482 density 0.3634400884789157,0.273449265813253
before tensor 262144 mask 42275.0 262144
layer3.3.conv1.weight, mask/weight parameters,42275,30096 density 0.24869987763554216,0.1770519578313253
before tensor 589824 mask 67610.0 589824
layer3.3.conv2.weight, mask/weight parameters,67610,49372 density 0.27261657070047257,0.19907743423493168
before tensor 262144 mask 52179.0 262144
layer3.3.conv3.weight, mask/weight parameters,52179,38775 density 0.3069641848644578,0.2281097044427711
before tensor 262144 mask 47261.0 262144
layer3.4.conv1.weight, mask/weight parameters,47261,33504 density 0.2780320500753012,0.19710090361445784
before tensor 589824 mask 68131.0 589824
layer3.4.conv2.weight, mask/weight parameters,68131,48499 density 0.27471734326865693,0.19555732972048837
before tensor 262144 mask 47453.0 262144
layer3.4.conv3.weight, mask/weight parameters,47453,35031 density 0.27916156814759036,0.20608410203313254
before tensor 262144 mask 52549.0 262144
layer3.5.conv1.weight, mask/weight parameters,52549,37861 density 0.3091408603162651,0.22273272778614459
before tensor 589824 mask 70098.0 589824
layer3.5.conv2.weight, mask/weight parameters,70098,50032 density 0.28264866695698454,0.2017386816341672
before tensor 262144 mask 47577.0 262144
layer3.5.conv3.weight, mask/weight parameters,47577,34320 density 0.2798910485692771,0.20190135542168675
before tensor 524288 mask 165965.0 524288
layer4.0.conv1.weight, mask/weight parameters,165965,129292 density 0.5017807904411765,0.39090315402476783
before tensor 2359296 mask 327931.0 2359296
layer4.0.conv2.weight, mask/weight parameters,327931,236221 density 0.34924879734089065,0.2515770090557542
before tensor 1048576 mask 159649.0 1048576
layer4.0.conv3.weight, mask/weight parameters,159649,111999 density 0.24134245597910217,0.16930963380417957
layer4.0.shortcut.0.weight, mask/weight parameters,228101,146984 density 0.10876703262329102,0.07008743286132812
before tensor 1048576 mask 148279.0 1048576
layer4.1.conv1.weight, mask/weight parameters,148279,108000 density 0.22415435129643962,0.16326431888544893
before tensor 2359296 mask 288017.0 2359296
layer4.1.conv2.weight, mask/weight parameters,288017,211853 density 0.3067401095466159,0.22562491945884866
before tensor 1048576 mask 135248.0 1048576
layer4.1.conv3.weight, mask/weight parameters,135248,95277 density 0.20445530185758515,0.14403087509674922
before tensor 1048576 mask 68448.0 1048576
layer4.2.conv1.weight, mask/weight parameters,68448,43312 density 0.10347329721362229,0.0654750386996904
before tensor 2359296 mask 80290.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80290,46282 density 0.08550940880398654,0.04929065211441157
before tensor 1048576 mask 48014.0 1048576
layer4.2.conv3.weight, mask/weight parameters,48014,30317 density 0.07258308339783281,0.0458304107004644
classifier.weight, mask/weight parameters,113394,102142 density 0.553681640625,0.498740234375
Total Model parameters after dst: 3243865 2365205
Total parameters under density level of 0.1: 0.23811423587473848 0.17361665213013205 after dst
Death rate: 0.1371495853310652


Training summary: Average loss: 1.3050, Accuracy: 31261/50000 (62.522%)


Evaluation: Average loss: 1.5468, Accuracy: 5732/10000 (57.320%)

Current learning rate: 0.1. Time taken for epoch: 88.78 seconds.

Train Epoch: 44 [0/50000 (0%)]	Loss: 1.054397 Accuracy: 72/100 (72.000%
Train Epoch: 44 [10000/50000 (20%)]	Loss: 1.219874 Accuracy: 6383/10100 (63.198%
Train Epoch: 44 [20000/50000 (40%)]	Loss: 1.578774 Accuracy: 12651/20100 (62.940%
Train Epoch: 44 [30000/50000 (60%)]	Loss: 1.463799 Accuracy: 18841/30100 (62.595%
Train Epoch: 44 [40000/50000 (80%)]	Loss: 1.392167 Accuracy: 25058/40100 (62.489%
current layer rate 0.36023554847519346
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4924.0
Total filter_masks items: 10647722.0
4924.0 / 7552 channels
Total channels to prune: 92.49886208466069
Layer ('layer2', 0, 'conv1'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/89.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/89.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/166.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/166.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/323.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/323.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/323.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/323.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/323.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/323.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4844.0
Total filter_masks items: 10377620.0
After apply_mask:
Total filter_names items: 4844.0
Total filter_masks items: 10377620.0
Total pruned: 80/92.49886208466069 channels
===========done ===============

Training summary: Average loss: 1.3195, Accuracy: 31099/50000 (62.198%)


Evaluation: Average loss: 1.6100, Accuracy: 5585/10000 (55.850%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 45 [0/50000 (0%)]	Loss: 1.284640 Accuracy: 62/100 (62.000%
Train Epoch: 45 [10000/50000 (20%)]	Loss: 1.115443 Accuracy: 6404/10100 (63.406%
Train Epoch: 45 [20000/50000 (40%)]	Loss: 1.217780 Accuracy: 12732/20100 (63.343%
Train Epoch: 45 [30000/50000 (60%)]	Loss: 1.115340 Accuracy: 18983/30100 (63.066%
Train Epoch: 45 [40000/50000 (80%)]	Loss: 1.443071 Accuracy: 25177/40100 (62.786%
current mest  death_rate 0.13607978863998121


dynamic sparse change prune
to kill 791005.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1227,1227 density 0.7100694444444444,0.7100694444444444
before tensor 4096 mask 781.0 4096
layer1.0.conv1.weight, mask/weight parameters,781,781 density 0.2596409574468085,0.2596409574468085
before tensor 36864 mask 4206.0 36864
layer1.0.conv2.weight, mask/weight parameters,4206,4206 density 0.21155877470952164,0.21155877470952164
before tensor 16384 mask 3961.0 16384
layer1.0.conv3.weight, mask/weight parameters,3961,3961 density 0.32920545212765956,0.32920545212765956
layer1.0.shortcut.0.weight, mask/weight parameters,5929,5929 density 0.36187744140625,0.36187744140625
before tensor 16384 mask 2295.0 16384
layer1.1.conv1.weight, mask/weight parameters,2295,2295 density 0.19074135638297873,0.19074135638297873
before tensor 36864 mask 3604.0 36864
layer1.1.conv2.weight, mask/weight parameters,3604,3604 density 0.18127860771590967,0.18127860771590967
before tensor 16384 mask 2169.0 16384
layer1.1.conv3.weight, mask/weight parameters,2169,2169 density 0.1802692819148936,0.1802692819148936
before tensor 16384 mask 2363.0 16384
layer1.2.conv1.weight, mask/weight parameters,2363,2363 density 0.1963929521276596,0.1963929521276596
before tensor 36864 mask 2633.0 36864
layer1.2.conv2.weight, mask/weight parameters,2633,2633 density 0.13243800613651224,0.13243800613651224
before tensor 16384 mask 1773.0 16384
layer1.2.conv3.weight, mask/weight parameters,1773,1773 density 0.1473570478723404,0.1473570478723404
before tensor 32768 mask 5539.0 32768
layer2.0.conv1.weight, mask/weight parameters,5539,5539 density 0.24587180397727273,0.24587180397727273
before tensor 147456 mask 13733.0 147456
layer2.0.conv2.weight, mask/weight parameters,13733,13733 density 0.19704143709825528,0.19704143709825528
before tensor 65536 mask 8177.0 65536
layer2.0.conv3.weight, mask/weight parameters,8177,8177 density 0.1814852627840909,0.1814852627840909
layer2.0.shortcut.0.weight, mask/weight parameters,29969,29969 density 0.22864532470703125,0.22864532470703125
before tensor 65536 mask 4429.0 65536
layer2.1.conv1.weight, mask/weight parameters,4429,4429 density 0.09829989346590909,0.09829989346590909
before tensor 147456 mask 5875.0 147456
layer2.1.conv2.weight, mask/weight parameters,5875,5875 density 0.08429465105601469,0.08429465105601469
before tensor 65536 mask 4014.0 65536
layer2.1.conv3.weight, mask/weight parameters,4014,4014 density 0.08908913352272728,0.08908913352272728
before tensor 65536 mask 10490.0 65536
layer2.2.conv1.weight, mask/weight parameters,10490,10490 density 0.2328213778409091,0.2328213778409091
before tensor 147456 mask 22114.0 147456
layer2.2.conv2.weight, mask/weight parameters,22114,22114 density 0.3172922405876951,0.3172922405876951
before tensor 65536 mask 12694.0 65536
layer2.2.conv3.weight, mask/weight parameters,12694,12694 density 0.28173828125,0.28173828125
before tensor 65536 mask 11134.0 65536
layer2.3.conv1.weight, mask/weight parameters,11134,11134 density 0.24711470170454544,0.24711470170454544
before tensor 147456 mask 21857.0 147456
layer2.3.conv2.weight, mask/weight parameters,21857,21857 density 0.31360479797979796,0.31360479797979796
before tensor 65536 mask 10830.0 65536
layer2.3.conv3.weight, mask/weight parameters,10830,10830 density 0.24036754261363635,0.24036754261363635
before tensor 131072 mask 30276.0 131072
layer3.0.conv1.weight, mask/weight parameters,30276,30276 density 0.362777990797546,0.362777990797546
before tensor 589824 mask 80723.0 589824
layer3.0.conv2.weight, mask/weight parameters,80723,80723 density 0.337582228244278,0.337582228244278
before tensor 262144 mask 62370.0 262144
layer3.0.conv3.weight, mask/weight parameters,62370,62370 density 0.3736699578220859,0.3736699578220859
layer3.0.shortcut.0.weight, mask/weight parameters,95047,95047 density 0.1812877655029297,0.1812877655029297
before tensor 262144 mask 28683.0 262144
layer3.1.conv1.weight, mask/weight parameters,28683,28683 density 0.17184504409509202,0.17184504409509202
before tensor 589824 mask 65864.0 589824
layer3.1.conv2.weight, mask/weight parameters,65864,65864 density 0.2754421401717122,0.2754421401717122
before tensor 262144 mask 47318.0 262144
layer3.1.conv3.weight, mask/weight parameters,47318,47318 density 0.28349070168711654,0.28349070168711654
before tensor 262144 mask 29908.0 262144
layer3.2.conv1.weight, mask/weight parameters,29908,29908 density 0.17918424079754602,0.17918424079754602
before tensor 589824 mask 59011.0 589824
layer3.2.conv2.weight, mask/weight parameters,59011,59011 density 0.24678300943873605,0.24678300943873605
before tensor 262144 mask 46354.0 262144
layer3.2.conv3.weight, mask/weight parameters,46354,46354 density 0.2777152032208589,0.2777152032208589
before tensor 262144 mask 30258.0 262144
layer3.3.conv1.weight, mask/weight parameters,30258,30258 density 0.1812811541411043,0.1812811541411043
before tensor 589824 mask 48724.0 589824
layer3.3.conv2.weight, mask/weight parameters,48724,48724 density 0.20376294846542128,0.20376294846542128
before tensor 262144 mask 38336.0 262144
layer3.3.conv3.weight, mask/weight parameters,38336,38336 density 0.22967791411042945,0.22967791411042945
before tensor 262144 mask 33862.0 262144
layer3.4.conv1.weight, mask/weight parameters,33862,33862 density 0.202873370398773,0.202873370398773
before tensor 589824 mask 48467.0 589824
layer3.4.conv2.weight, mask/weight parameters,48467,48467 density 0.2026881787881449,0.2026881787881449
before tensor 262144 mask 34362.0 262144
layer3.4.conv3.weight, mask/weight parameters,34362,34362 density 0.20586896088957055,0.20586896088957055
before tensor 262144 mask 38829.0 262144
layer3.5.conv1.weight, mask/weight parameters,38829,38829 density 0.23263156633435583,0.23263156633435583
before tensor 589824 mask 51167.0 589824
layer3.5.conv2.weight, mask/weight parameters,51167,51167 density 0.21397953337431677,0.21397953337431677
before tensor 262144 mask 34863.0 262144
layer3.5.conv3.weight, mask/weight parameters,34863,34863 density 0.20887054256134968,0.20887054256134968
before tensor 524288 mask 130713.0 524288
layer4.0.conv1.weight, mask/weight parameters,130713,130713 density 0.40267953962933756,0.40267953962933756
before tensor 2359296 mask 237434.0 2359296
layer4.0.conv2.weight, mask/weight parameters,237434,237434 density 0.2625317751749501,0.2625317751749501
before tensor 1048576 mask 113107.0 1048576
layer4.0.conv3.weight, mask/weight parameters,113107,113107 density 0.17422090644716087,0.17422090644716087
layer4.0.shortcut.0.weight, mask/weight parameters,149525,149525 density 0.07129907608032227,0.07129907608032227
before tensor 1048576 mask 108854.0 1048576
layer4.1.conv1.weight, mask/weight parameters,108854,108854 density 0.16766992803627762,0.16766992803627762
before tensor 2359296 mask 210777.0 2359296
layer4.1.conv2.weight, mask/weight parameters,210777,210777 density 0.23305701784938318,0.23305701784938318
before tensor 1048576 mask 94866.0 1048576
layer4.1.conv3.weight, mask/weight parameters,94866,94866 density 0.14612394026025236,0.14612394026025236
before tensor 1048576 mask 44632.0 1048576
layer4.2.conv1.weight, mask/weight parameters,44632,44632 density 0.068747535488959,0.068747535488959
before tensor 2359296 mask 46650.0 2359296
layer4.2.conv2.weight, mask/weight parameters,46650,46650 density 0.05158110174579639,0.05158110174579639
before tensor 1048576 mask 30499.0 1048576
layer4.2.conv3.weight, mask/weight parameters,30499,30499 density 0.046978201399842275,0.046978201399842275
classifier.weight, mask/weight parameters,101930,101930 density 0.497705078125,0.497705078125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.1771285259001618 0.1771285259001618 after dst
Death rate: 0.13607978863998121

dynamic sparse change grow
self.total_params*pruning_rate 3218563.515466072
self.total_nonzero 2365205.0
to grow 853358.5154660721
len(all_scores) 13353044 10376121
increse 853358.0 before_mask 3218562.0 after_mask 3218562.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1342,1227 density 0.7766203703703703,0.7100694444444444
before tensor 4096 mask 924.0 4096
layer1.0.conv1.weight, mask/weight parameters,924,781 density 0.3071808510638298,0.2596409574468085
before tensor 36864 mask 4958.0 36864
layer1.0.conv2.weight, mask/weight parameters,4958,4206 density 0.24938383381117651,0.21155877470952164
before tensor 16384 mask 5080.0 16384
layer1.0.conv3.weight, mask/weight parameters,5080,3961 density 0.42220744680851063,0.32920545212765956
layer1.0.shortcut.0.weight, mask/weight parameters,7120,5929 density 0.4345703125,0.36187744140625
before tensor 16384 mask 3159.0 16384
layer1.1.conv1.weight, mask/weight parameters,3159,2295 density 0.2625498670212766,0.19074135638297873
before tensor 36864 mask 4292.0 36864
layer1.1.conv2.weight, mask/weight parameters,4292,3604 density 0.21588451285146623,0.18127860771590967
before tensor 16384 mask 2911.0 16384
layer1.1.conv3.weight, mask/weight parameters,2911,2169 density 0.24193816489361702,0.1802692819148936
before tensor 16384 mask 3351.0 16384
layer1.2.conv1.weight, mask/weight parameters,3351,2363 density 0.2785073138297872,0.1963929521276596
before tensor 36864 mask 3583.0 36864
layer1.2.conv2.weight, mask/weight parameters,3583,2633 density 0.18022232282078365,0.13243800613651224
before tensor 16384 mask 2327.0 16384
layer1.2.conv3.weight, mask/weight parameters,2327,1773 density 0.19340093085106383,0.1473570478723404
before tensor 32768 mask 7480.0 32768
layer2.0.conv1.weight, mask/weight parameters,7480,5539 density 0.33203125,0.24587180397727273
before tensor 147456 mask 17295.0 147456
layer2.0.conv2.weight, mask/weight parameters,17295,13733 density 0.2481491046831956,0.19704143709825528
before tensor 65536 mask 10292.0 65536
layer2.0.conv3.weight, mask/weight parameters,10292,8177 density 0.2284268465909091,0.1814852627840909
layer2.0.shortcut.0.weight, mask/weight parameters,40759,29969 density 0.31096649169921875,0.22864532470703125
before tensor 65536 mask 7500.0 65536
layer2.1.conv1.weight, mask/weight parameters,7500,4429 density 0.16645951704545456,0.09829989346590909
before tensor 147456 mask 7946.0 147456
layer2.1.conv2.weight, mask/weight parameters,7946,5875 density 0.11400941230486684,0.08429465105601469
before tensor 65536 mask 5016.0 65536
layer2.1.conv3.weight, mask/weight parameters,5016,4014 density 0.111328125,0.08908913352272728
before tensor 65536 mask 13856.0 65536
layer2.2.conv1.weight, mask/weight parameters,13856,10490 density 0.3075284090909091,0.2328213778409091
before tensor 147456 mask 28129.0 147456
layer2.2.conv2.weight, mask/weight parameters,28129,22114 density 0.40359561524334253,0.3172922405876951
before tensor 65536 mask 16320.0 65536
layer2.2.conv3.weight, mask/weight parameters,16320,12694 density 0.3622159090909091,0.28173828125
before tensor 65536 mask 13715.0 65536
layer2.3.conv1.weight, mask/weight parameters,13715,11134 density 0.30439897017045453,0.24711470170454544
before tensor 147456 mask 26934.0 147456
layer2.3.conv2.weight, mask/weight parameters,26934,21857 density 0.3864497245179063,0.31360479797979796
before tensor 65536 mask 14308.0 65536
layer2.3.conv3.weight, mask/weight parameters,14308,10830 density 0.3175603693181818,0.24036754261363635
before tensor 131072 mask 39567.0 131072
layer3.0.conv1.weight, mask/weight parameters,39567,30276 density 0.474106115797546,0.362777990797546
before tensor 589824 mask 105974.0 589824
layer3.0.conv2.weight, mask/weight parameters,105974,80723 density 0.4431814855240652,0.337582228244278
before tensor 262144 mask 78757.0 262144
layer3.0.conv3.weight, mask/weight parameters,78757,62370 density 0.4718474405674847,0.3736699578220859
layer3.0.shortcut.0.weight, mask/weight parameters,127899,95047 density 0.24394798278808594,0.1812877655029297
before tensor 262144 mask 41671.0 262144
layer3.1.conv1.weight, mask/weight parameters,41671,28683 density 0.24965850268404907,0.17184504409509202
before tensor 589824 mask 90065.0 589824
layer3.1.conv2.weight, mask/weight parameters,90065,65864 density 0.37665031511243263,0.2754421401717122
before tensor 262144 mask 62933.0 262144
layer3.1.conv3.weight, mask/weight parameters,62933,47318 density 0.3770429927147239,0.28349070168711654
before tensor 262144 mask 40467.0 262144
layer3.2.conv1.weight, mask/weight parameters,40467,29908 density 0.2424451207822086,0.17918424079754602
before tensor 589824 mask 77407.0 589824
layer3.2.conv2.weight, mask/weight parameters,77407,59011 density 0.3237147720191869,0.24678300943873605
before tensor 262144 mask 60564.0 262144
layer3.2.conv3.weight, mask/weight parameters,60564,46354 density 0.36284988496932513,0.2777152032208589
before tensor 262144 mask 40665.0 262144
layer3.3.conv1.weight, mask/weight parameters,40665,30258 density 0.24363137461656442,0.1812811541411043
before tensor 589824 mask 65178.0 589824
layer3.3.conv2.weight, mask/weight parameters,65178,48724 density 0.27257329971018857,0.20376294846542128
before tensor 262144 mask 50023.0 262144
layer3.3.conv3.weight, mask/weight parameters,50023,38336 density 0.2996968462423313,0.22967791411042945
before tensor 262144 mask 47735.0 262144
layer3.4.conv1.weight, mask/weight parameters,47735,33862 density 0.28598902415644173,0.202873370398773
before tensor 589824 mask 67386.0 589824
layer3.4.conv2.weight, mask/weight parameters,67386,48467 density 0.2818071185717691,0.2026881787881449
before tensor 262144 mask 47583.0 262144
layer3.4.conv3.weight, mask/weight parameters,47583,34362 density 0.2850783646472393,0.20586896088957055
before tensor 262144 mask 51702.0 262144
layer3.5.conv1.weight, mask/weight parameters,51702,38829 density 0.3097560391104294,0.23263156633435583
before tensor 589824 mask 67472.0 589824
layer3.5.conv2.weight, mask/weight parameters,67472,51167 density 0.28216676912525457,0.21397953337431677
before tensor 262144 mask 46633.0 262144
layer3.5.conv3.weight, mask/weight parameters,46633,34863 density 0.2793867427147239,0.20887054256134968
before tensor 524288 mask 163482.0 524288
layer4.0.conv1.weight, mask/weight parameters,163482,130713 density 0.5036289925078864,0.40267953962933756
before tensor 2359296 mask 319710.0 2359296
layer4.0.conv2.weight, mask/weight parameters,319710,237434 density 0.3535046953729596,0.2625317751749501
before tensor 1048576 mask 159711.0 1048576
layer4.0.conv3.weight, mask/weight parameters,159711,113107 density 0.24600595179416404,0.17422090644716087
layer4.0.shortcut.0.weight, mask/weight parameters,224894,149525 density 0.1072378158569336,0.07129907608032227
before tensor 1048576 mask 144830.0 1048576
layer4.1.conv1.weight, mask/weight parameters,144830,108854 density 0.2230844587933754,0.16766992803627762
before tensor 2359296 mask 283174.0 2359296
layer4.1.conv2.weight, mask/weight parameters,283174,210777 density 0.3131066860828327,0.23305701784938318
before tensor 1048576 mask 138821.0 1048576
layer4.1.conv3.weight, mask/weight parameters,138821,94866 density 0.21382867951498422,0.14612394026025236
before tensor 1048576 mask 73557.0 1048576
layer4.2.conv1.weight, mask/weight parameters,73557,44632 density 0.1133012741522082,0.068747535488959
before tensor 2359296 mask 87615.0 2359296
layer4.2.conv2.weight, mask/weight parameters,87615,46650 density 0.09687627501517579,0.05158110174579639
before tensor 1048576 mask 49884.0 1048576
layer4.2.conv3.weight, mask/weight parameters,49884,30499 density 0.07683729298107256,0.046978201399842275
classifier.weight, mask/weight parameters,114606,101930 density 0.559599609375,0.497705078125
Total Model parameters after dst: 3218562 2365205
Total parameters under density level of 0.1: 0.2410358267373342 0.1771285259001618 after dst
Death rate: 0.13607978863998121


Training summary: Average loss: 1.3000, Accuracy: 31369/50000 (62.738%)


Evaluation: Average loss: 1.6399, Accuracy: 5614/10000 (56.140%)

Current learning rate: 0.1. Time taken for epoch: 88.76 seconds.

Train Epoch: 46 [0/50000 (0%)]	Loss: 1.418989 Accuracy: 56/100 (56.000%
Train Epoch: 46 [10000/50000 (20%)]	Loss: 1.433931 Accuracy: 6372/10100 (63.089%
Train Epoch: 46 [20000/50000 (40%)]	Loss: 1.048980 Accuracy: 12592/20100 (62.647%
Train Epoch: 46 [30000/50000 (60%)]	Loss: 1.098907 Accuracy: 18819/30100 (62.522%
Train Epoch: 46 [40000/50000 (80%)]	Loss: 1.112565 Accuracy: 25147/40100 (62.711%
current layer rate 0.36987096040054623
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4844.0
Total filter_masks items: 10377620.0
4844.0 / 7552 channels
Total channels to prune: 85.26549294492543
Layer ('layer2', 0, 'conv1'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/88.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/88.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/163.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/163.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 5/317.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 5/317.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 5/317.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 5/317.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 5/317.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 5/317.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4782.0
Total filter_masks items: 10167701.0
After apply_mask:
Total filter_names items: 4782.0
Total filter_masks items: 10167701.0
Total pruned: 62/85.26549294492543 channels
===========done ===============

Training summary: Average loss: 1.3013, Accuracy: 31345/50000 (62.690%)


Evaluation: Average loss: 1.7576, Accuracy: 5288/10000 (52.880%)

Current learning rate: 0.1. Time taken for epoch: 88.57 seconds.

Train Epoch: 47 [0/50000 (0%)]	Loss: 1.347490 Accuracy: 64/100 (64.000%
Train Epoch: 47 [10000/50000 (20%)]	Loss: 1.166702 Accuracy: 6420/10100 (63.564%
Train Epoch: 47 [20000/50000 (40%)]	Loss: 1.157045 Accuracy: 12666/20100 (63.015%
Train Epoch: 47 [30000/50000 (60%)]	Loss: 1.297349 Accuracy: 18864/30100 (62.671%
Train Epoch: 47 [40000/50000 (80%)]	Loss: 1.124234 Accuracy: 25172/40100 (62.773%
current mest  death_rate 0.13498411458914245


dynamic sparse change prune
to kill 776669.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1237,1237 density 0.7158564814814815,0.7158564814814815
before tensor 4096 mask 783.0 4096
layer1.0.conv1.weight, mask/weight parameters,783,783 density 0.2603058510638298,0.2603058510638298
before tensor 36864 mask 4120.0 36864
layer1.0.conv2.weight, mask/weight parameters,4120,4120 density 0.20723303656757708,0.20723303656757708
before tensor 16384 mask 4074.0 16384
layer1.0.conv3.weight, mask/weight parameters,4074,4074 density 0.3385970744680851,0.3385970744680851
layer1.0.shortcut.0.weight, mask/weight parameters,5893,5893 density 0.35968017578125,0.35968017578125
before tensor 16384 mask 2372.0 16384
layer1.1.conv1.weight, mask/weight parameters,2372,2372 density 0.1971409574468085,0.1971409574468085
before tensor 36864 mask 3634.0 36864
layer1.1.conv2.weight, mask/weight parameters,3634,3634 density 0.18278758613751822,0.18278758613751822
before tensor 16384 mask 2170.0 16384
layer1.1.conv3.weight, mask/weight parameters,2170,2170 density 0.18035239361702127,0.18035239361702127
before tensor 16384 mask 2474.0 16384
layer1.2.conv1.weight, mask/weight parameters,2474,2474 density 0.20561835106382978,0.20561835106382978
before tensor 36864 mask 2756.0 36864
layer1.2.conv2.weight, mask/weight parameters,2756,2756 density 0.1386248176651074,0.1386248176651074
before tensor 16384 mask 1771.0 16384
layer1.2.conv3.weight, mask/weight parameters,1771,1771 density 0.1471908244680851,0.1471908244680851
before tensor 32768 mask 5424.0 32768
layer2.0.conv1.weight, mask/weight parameters,5424,5424 density 0.2435344827586207,0.2435344827586207
before tensor 147456 mask 13510.0 147456
layer2.0.conv2.weight, mask/weight parameters,13510,13510 density 0.19832357129225936,0.19832357129225936
before tensor 65536 mask 8023.0 65536
layer2.0.conv3.weight, mask/weight parameters,8023,8023 density 0.1801140445402299,0.1801140445402299
layer2.0.shortcut.0.weight, mask/weight parameters,30239,30239 density 0.23070526123046875,0.23070526123046875
before tensor 65536 mask 4715.0 65536
layer2.1.conv1.weight, mask/weight parameters,4715,4715 density 0.10585039511494253,0.10585039511494253
before tensor 147456 mask 5589.0 147456
layer2.1.conv2.weight, mask/weight parameters,5589,5589 density 0.08204518430439953,0.08204518430439953
before tensor 65536 mask 3735.0 65536
layer2.1.conv3.weight, mask/weight parameters,3735,3735 density 0.08384967672413793,0.08384967672413793
before tensor 65536 mask 10577.0 65536
layer2.2.conv1.weight, mask/weight parameters,10577,10577 density 0.2374506106321839,0.2374506106321839
before tensor 147456 mask 21895.0 147456
layer2.2.conv2.weight, mask/weight parameters,21895,21895 density 0.3214133673903789,0.3214133673903789
before tensor 65536 mask 12441.0 65536
layer2.2.conv3.weight, mask/weight parameters,12441,12441 density 0.279296875,0.279296875
before tensor 65536 mask 10471.0 65536
layer2.3.conv1.weight, mask/weight parameters,10471,10471 density 0.23507094109195403,0.23507094109195403
before tensor 147456 mask 21385.0 147456
layer2.3.conv2.weight, mask/weight parameters,21385,21385 density 0.31392668927349865,0.31392668927349865
before tensor 65536 mask 10946.0 65536
layer2.3.conv3.weight, mask/weight parameters,10946,10946 density 0.24573455459770116,0.24573455459770116
before tensor 131072 mask 30233.0 131072
layer3.0.conv1.weight, mask/weight parameters,30233,30233 density 0.3667629076086957,0.3667629076086957
before tensor 589824 mask 80769.0 589824
layer3.0.conv2.weight, mask/weight parameters,80769,80769 density 0.34621863868420716,0.34621863868420716
before tensor 262144 mask 62113.0 262144
layer3.0.conv3.weight, mask/weight parameters,62113,62113 density 0.37675296001552794,0.37675296001552794
layer3.0.shortcut.0.weight, mask/weight parameters,94636,94636 density 0.18050384521484375,0.18050384521484375
before tensor 262144 mask 29906.0 262144
layer3.1.conv1.weight, mask/weight parameters,29906,29906 density 0.1813980007763975,0.1813980007763975
before tensor 589824 mask 65793.0 589824
layer3.1.conv2.weight, mask/weight parameters,65793,65793 density 0.2820235844810514,0.2820235844810514
before tensor 262144 mask 47617.0 262144
layer3.1.conv3.weight, mask/weight parameters,47617,47617 density 0.2888259413819876,0.2888259413819876
before tensor 262144 mask 29748.0 262144
layer3.2.conv1.weight, mask/weight parameters,29748,29748 density 0.1804396350931677,0.1804396350931677
before tensor 589824 mask 57574.0 589824
layer3.2.conv2.weight, mask/weight parameters,57574,57574 density 0.24679260488064161,0.24679260488064161
before tensor 262144 mask 46272.0 262144
layer3.2.conv3.weight, mask/weight parameters,46272,46272 density 0.28066770186335405,0.28066770186335405
before tensor 262144 mask 29879.0 262144
layer3.3.conv1.weight, mask/weight parameters,29879,29879 density 0.18123422942546583,0.18123422942546583
before tensor 589824 mask 47894.0 589824
layer3.3.conv2.weight, mask/weight parameters,47894,47894 density 0.20529900681129415,0.20529900681129415
before tensor 262144 mask 37713.0 262144
layer3.3.conv3.weight, mask/weight parameters,37713,37713 density 0.22875218361801242,0.22875218361801242
before tensor 262144 mask 34793.0 262144
layer3.4.conv1.weight, mask/weight parameters,34793,34793 density 0.21104061529503104,0.21104061529503104
before tensor 589824 mask 49027.0 589824
layer3.4.conv2.weight, mask/weight parameters,49027,49027 density 0.2101556438580473,0.2101556438580473
before tensor 262144 mask 34791.0 262144
layer3.4.conv3.weight, mask/weight parameters,34791,34791 density 0.21102848408385094,0.21102848408385094
before tensor 262144 mask 38791.0 262144
layer3.5.conv1.weight, mask/weight parameters,38791,38791 density 0.2352909064440994,0.2352909064440994
before tensor 589824 mask 50602.0 589824
layer3.5.conv2.weight, mask/weight parameters,50602,50602 density 0.21690692660176863,0.21690692660176863
before tensor 262144 mask 34804.0 262144
layer3.5.conv3.weight, mask/weight parameters,34804,34804 density 0.21110733695652173,0.21110733695652173
before tensor 524288 mask 129728.0 524288
layer4.0.conv1.weight, mask/weight parameters,129728,129728 density 0.40604967948717946,0.40604967948717946
before tensor 2359296 mask 235201.0 2359296
layer4.0.conv2.weight, mask/weight parameters,235201,235201 density 0.268464871429615,0.268464871429615
before tensor 1048576 mask 113931.0 1048576
layer4.0.conv3.weight, mask/weight parameters,113931,113931 density 0.17830247145432693,0.17830247145432693
layer4.0.shortcut.0.weight, mask/weight parameters,150729,150729 density 0.07187318801879883,0.07187318801879883
before tensor 1048576 mask 107361.0 1048576
layer4.1.conv1.weight, mask/weight parameters,107361,107361 density 0.16802039513221154,0.16802039513221154
before tensor 2359296 mask 209275.0 2359296
layer4.1.conv2.weight, mask/weight parameters,209275,209275 density 0.2388722240485061,0.2388722240485061
before tensor 1048576 mask 96922.0 1048576
layer4.1.conv3.weight, mask/weight parameters,96922,96922 density 0.15168331830929488,0.15168331830929488
before tensor 1048576 mask 46272.0 1048576
layer4.2.conv1.weight, mask/weight parameters,46272,46272 density 0.07241586538461539,0.07241586538461539
before tensor 2359296 mask 48915.0 2359296
layer4.2.conv2.weight, mask/weight parameters,48915,48915 density 0.05583292241946088,0.05583292241946088
before tensor 1048576 mask 31073.0 1048576
layer4.2.conv3.weight, mask/weight parameters,31073,31073 density 0.048629369491185896,0.048629369491185896
classifier.weight, mask/weight parameters,102609,102609 density 0.5010205078125,0.5010205078125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.17995758238622855 0.17995758238622855 after dst
Death rate: 0.13498411458914245

dynamic sparse change grow
self.total_params*pruning_rate 3192648.597754064
self.total_nonzero 2365205.0
to grow 827443.597754064
len(all_scores) 13143125 10121022
increse 827443.0 before_mask 3192646.0 after_mask 3192646.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1302,1237 density 0.7534722222222222,0.7158564814814815
before tensor 4096 mask 967.0 4096
layer1.0.conv1.weight, mask/weight parameters,967,783 density 0.3214760638297872,0.2603058510638298
before tensor 36864 mask 4785.0 36864
layer1.0.conv2.weight, mask/weight parameters,4785,4120 density 0.24068205824656708,0.20723303656757708
before tensor 16384 mask 5109.0 16384
layer1.0.conv3.weight, mask/weight parameters,5109,4074 density 0.4246176861702128,0.3385970744680851
layer1.0.shortcut.0.weight, mask/weight parameters,6937,5893 density 0.42340087890625,0.35968017578125
before tensor 16384 mask 3214.0 16384
layer1.1.conv1.weight, mask/weight parameters,3214,2372 density 0.26712101063829785,0.1971409574468085
before tensor 36864 mask 4511.0 36864
layer1.1.conv2.weight, mask/weight parameters,4511,3634 density 0.2269000553292088,0.18278758613751822
before tensor 16384 mask 2833.0 16384
layer1.1.conv3.weight, mask/weight parameters,2833,2170 density 0.2354554521276596,0.18035239361702127
before tensor 16384 mask 3310.0 16384
layer1.2.conv1.weight, mask/weight parameters,3310,2474 density 0.27509973404255317,0.20561835106382978
before tensor 36864 mask 3496.0 36864
layer1.2.conv2.weight, mask/weight parameters,3496,2756 density 0.1758462853981188,0.1386248176651074
before tensor 16384 mask 2295.0 16384
layer1.2.conv3.weight, mask/weight parameters,2295,1771 density 0.19074135638297873,0.1471908244680851
before tensor 32768 mask 7338.0 32768
layer2.0.conv1.weight, mask/weight parameters,7338,5424 density 0.32947198275862066,0.2435344827586207
before tensor 147456 mask 16861.0 147456
layer2.0.conv2.weight, mask/weight parameters,16861,13510 density 0.2475154504484667,0.19832357129225936
before tensor 65536 mask 9914.0 65536
layer2.0.conv3.weight, mask/weight parameters,9914,8023 density 0.22256645114942528,0.1801140445402299
layer2.0.shortcut.0.weight, mask/weight parameters,40561,30239 density 0.30945587158203125,0.23070526123046875
before tensor 65536 mask 6364.0 65536
layer2.1.conv1.weight, mask/weight parameters,6364,4715 density 0.14286997126436782,0.10585039511494253
before tensor 147456 mask 6722.0 147456
layer2.1.conv2.weight, mask/weight parameters,6722,5589 density 0.09867735353268449,0.08204518430439953
before tensor 65536 mask 5433.0 65536
layer2.1.conv3.weight, mask/weight parameters,5433,3735 density 0.12196928879310345,0.08384967672413793
before tensor 65536 mask 13311.0 65536
layer2.2.conv1.weight, mask/weight parameters,13311,10577 density 0.298828125,0.2374506106321839
before tensor 147456 mask 27109.0 147456
layer2.2.conv2.weight, mask/weight parameters,27109,21895 density 0.3979536413147194,0.3214133673903789
before tensor 65536 mask 16052.0 65536
layer2.2.conv3.weight, mask/weight parameters,16052,12441 density 0.3603627873563218,0.279296875
before tensor 65536 mask 13243.0 65536
layer2.3.conv1.weight, mask/weight parameters,13243,10471 density 0.2973015445402299,0.23507094109195403
before tensor 147456 mask 26561.0 147456
layer2.3.conv2.weight, mask/weight parameters,26561,21385 density 0.3899091322793265,0.31392668927349865
before tensor 65536 mask 13771.0 65536
layer2.3.conv3.weight, mask/weight parameters,13771,10946 density 0.30915499281609193,0.24573455459770116
before tensor 131072 mask 38449.0 131072
layer3.0.conv1.weight, mask/weight parameters,38449,30233 density 0.4664329386645963,0.3667629076086957
before tensor 589824 mask 105392.0 589824
layer3.0.conv2.weight, mask/weight parameters,105392,80769 density 0.45176583550874666,0.34621863868420716
before tensor 262144 mask 77368.0 262144
layer3.0.conv3.weight, mask/weight parameters,77368,62113 density 0.46928377329192544,0.37675296001552794
layer3.0.shortcut.0.weight, mask/weight parameters,128876,94636 density 0.24581146240234375,0.18050384521484375
before tensor 262144 mask 38328.0 262144
layer3.1.conv1.weight, mask/weight parameters,38328,29906 density 0.2324825310559006,0.1813980007763975
before tensor 589824 mask 88080.0 589824
layer3.1.conv2.weight, mask/weight parameters,88080,65793 density 0.37755745020125253,0.2820235844810514
before tensor 262144 mask 61573.0 262144
layer3.1.conv3.weight, mask/weight parameters,61573,47617 density 0.3734775329968944,0.2888259413819876
before tensor 262144 mask 40313.0 262144
layer3.2.conv1.weight, mask/weight parameters,40313,29748 density 0.24452275815217392,0.1804396350931677
before tensor 589824 mask 77057.0 589824
layer3.2.conv2.weight, mask/weight parameters,77057,57574 density 0.3303070440526557,0.24679260488064161
before tensor 262144 mask 61069.0 262144
layer3.2.conv3.weight, mask/weight parameters,61069,46272 density 0.3704204677795031,0.28066770186335405
before tensor 262144 mask 40328.0 262144
layer3.3.conv1.weight, mask/weight parameters,40328,29879 density 0.24461374223602483,0.18123422942546583
before tensor 589824 mask 64522.0 589824
layer3.3.conv2.weight, mask/weight parameters,64522,47894 density 0.27657540647008644,0.20529900681129415
before tensor 262144 mask 50223.0 262144
layer3.3.conv3.weight, mask/weight parameters,50223,37713 density 0.30463290954968947,0.22875218361801242
before tensor 262144 mask 48426.0 262144
layer3.4.conv1.weight, mask/weight parameters,48426,34793 density 0.29373301630434784,0.21104061529503104
before tensor 589824 mask 66583.0 589824
layer3.4.conv2.weight, mask/weight parameters,66583,49027 density 0.2854099421747275,0.2101556438580473
before tensor 262144 mask 47207.0 262144
layer3.4.conv3.weight, mask/weight parameters,47207,34791 density 0.2863390430900621,0.21102848408385094
before tensor 262144 mask 52427.0 262144
layer3.5.conv1.weight, mask/weight parameters,52427,38791 density 0.3180015042701863,0.2352909064440994
before tensor 589824 mask 68778.0 589824
layer3.5.conv2.weight, mask/weight parameters,68778,50602 density 0.2948188727286756,0.21690692660176863
before tensor 262144 mask 46885.0 262144
layer3.5.conv3.weight, mask/weight parameters,46885,34804 density 0.2843859180900621,0.21110733695652173
before tensor 524288 mask 162097.0 524288
layer4.0.conv1.weight, mask/weight parameters,162097,129728 density 0.5073649088541666,0.40604967948717946
before tensor 2359296 mask 318501.0 2359296
layer4.0.conv2.weight, mask/weight parameters,318501,235201 density 0.3635457758053912,0.268464871429615
before tensor 1048576 mask 158607.0 1048576
layer4.0.conv3.weight, mask/weight parameters,158607,113931 density 0.24822059044471154,0.17830247145432693
layer4.0.shortcut.0.weight, mask/weight parameters,233761,150729 density 0.1114659309387207,0.07187318801879883
before tensor 1048576 mask 145145.0 1048576
layer4.1.conv1.weight, mask/weight parameters,145145,107361 density 0.22715250651041666,0.16802039513221154
before tensor 2359296 mask 281743.0 2359296
layer4.1.conv2.weight, mask/weight parameters,281743,209275 density 0.32158918657316093,0.2388722240485061
before tensor 1048576 mask 135224.0 1048576
layer4.1.conv3.weight, mask/weight parameters,135224,96922 density 0.2116261017628205,0.15168331830929488
before tensor 1048576 mask 69519.0 1048576
layer4.2.conv1.weight, mask/weight parameters,69519,46272 density 0.10879751352163461,0.07241586538461539
before tensor 2359296 mask 80061.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80061,48915 density 0.09138382095112864,0.05583292241946088
before tensor 1048576 mask 48685.0 1048576
layer4.2.conv3.weight, mask/weight parameters,48685,31073 density 0.07619222005208333,0.048629369491185896
classifier.weight, mask/weight parameters,115420,102609 density 0.56357421875,0.5010205078125
Total Model parameters after dst: 3192646 2365205
Total parameters under density level of 0.1: 0.24291376670312426 0.17995758238622855 after dst
Death rate: 0.13498411458914245


Training summary: Average loss: 1.3044, Accuracy: 31297/50000 (62.594%)


Evaluation: Average loss: 1.7180, Accuracy: 5483/10000 (54.830%)

Current learning rate: 0.1. Time taken for epoch: 88.76 seconds.

Train Epoch: 48 [0/50000 (0%)]	Loss: 1.247580 Accuracy: 60/100 (60.000%
Train Epoch: 48 [10000/50000 (20%)]	Loss: 1.019906 Accuracy: 6508/10100 (64.436%
Train Epoch: 48 [20000/50000 (40%)]	Loss: 1.255987 Accuracy: 12736/20100 (63.363%
Train Epoch: 48 [30000/50000 (60%)]	Loss: 1.429386 Accuracy: 18895/30100 (62.774%
Train Epoch: 48 [40000/50000 (80%)]	Loss: 1.289505 Accuracy: 25100/40100 (62.594%
current layer rate 0.379053026854802
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4782.0
Total filter_masks items: 10167701.0
4782.0 / 7552 channels
Total channels to prune: 92.60845880746456
Layer ('layer2', 0, 'conv1'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/87.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/87.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 3/161.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 3/161.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 6/312.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 6/312.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 6/312.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 6/312.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 6/312.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 6/312.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4702.0
Total filter_masks items: 9902927.0
After apply_mask:
Total filter_names items: 4702.0
Total filter_masks items: 9902927.0
Total pruned: 80/92.60845880746456 channels
===========done ===============

Training summary: Average loss: 1.2990, Accuracy: 31276/50000 (62.552%)


Evaluation: Average loss: 1.6102, Accuracy: 5543/10000 (55.430%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 49 [0/50000 (0%)]	Loss: 1.625069 Accuracy: 59/100 (59.000%
Train Epoch: 49 [10000/50000 (20%)]	Loss: 1.244194 Accuracy: 6316/10100 (62.535%
Train Epoch: 49 [20000/50000 (40%)]	Loss: 1.047517 Accuracy: 12558/20100 (62.478%
Train Epoch: 49 [30000/50000 (60%)]	Loss: 1.390344 Accuracy: 18817/30100 (62.515%
Train Epoch: 49 [40000/50000 (80%)]	Loss: 1.119734 Accuracy: 25100/40100 (62.594%
current mest  death_rate 0.1338651221760631


dynamic sparse change prune
to kill 734877.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1210,1210 density 0.7002314814814815,0.7002314814814815
before tensor 4096 mask 779.0 4096
layer1.0.conv1.weight, mask/weight parameters,779,779 density 0.2589760638297872,0.2589760638297872
before tensor 36864 mask 4027.0 36864
layer1.0.conv2.weight, mask/weight parameters,4027,4027 density 0.20255520346059053,0.20255520346059053
before tensor 16384 mask 4100.0 16384
layer1.0.conv3.weight, mask/weight parameters,4100,4100 density 0.34075797872340424,0.34075797872340424
layer1.0.shortcut.0.weight, mask/weight parameters,5867,5867 density 0.35809326171875,0.35809326171875
before tensor 16384 mask 2418.0 16384
layer1.1.conv1.weight, mask/weight parameters,2418,2418 density 0.20096409574468085,0.20096409574468085
before tensor 36864 mask 3741.0 36864
layer1.1.conv2.weight, mask/weight parameters,3741,3741 density 0.1881696091745888,0.1881696091745888
before tensor 16384 mask 2202.0 16384
layer1.1.conv3.weight, mask/weight parameters,2202,2202 density 0.1830119680851064,0.1830119680851064
before tensor 16384 mask 2582.0 16384
layer1.2.conv1.weight, mask/weight parameters,2582,2582 density 0.21459441489361702,0.21459441489361702
before tensor 36864 mask 2842.0 36864
layer1.2.conv2.weight, mask/weight parameters,2842,2842 density 0.14295055580705196,0.14295055580705196
before tensor 16384 mask 1783.0 16384
layer1.2.conv3.weight, mask/weight parameters,1783,1783 density 0.14818816489361702,0.14818816489361702
before tensor 32768 mask 5279.0 32768
layer2.0.conv1.weight, mask/weight parameters,5279,5279 density 0.23978015988372092,0.23978015988372092
before tensor 147456 mask 13413.0 147456
layer2.0.conv2.weight, mask/weight parameters,13413,13413 density 0.2015053181900126,0.2015053181900126
before tensor 65536 mask 7898.0 65536
layer2.0.conv3.weight, mask/weight parameters,7898,7898 density 0.17936954941860464,0.17936954941860464
layer2.0.shortcut.0.weight, mask/weight parameters,30366,30366 density 0.2316741943359375,0.2316741943359375
before tensor 65536 mask 4440.0 65536
layer2.1.conv1.weight, mask/weight parameters,4440,4440 density 0.10083575581395349,0.10083575581395349
before tensor 147456 mask 5123.0 147456
layer2.1.conv2.weight, mask/weight parameters,5123,5123 density 0.07696352382669311,0.07696352382669311
before tensor 65536 mask 3789.0 65536
layer2.1.conv3.weight, mask/weight parameters,3789,3789 density 0.08605105377906977,0.08605105377906977
before tensor 65536 mask 10443.0 65536
layer2.2.conv1.weight, mask/weight parameters,10443,10443 density 0.23716842296511628,0.23716842296511628
before tensor 147456 mask 21514.0 147456
layer2.2.conv2.weight, mask/weight parameters,21514,21514 density 0.323207739919476,0.323207739919476
before tensor 65536 mask 12523.0 65536
layer2.2.conv3.weight, mask/weight parameters,12523,12523 density 0.28440679505813954,0.28440679505813954
before tensor 65536 mask 10415.0 65536
layer2.3.conv1.weight, mask/weight parameters,10415,10415 density 0.2365325218023256,0.2365325218023256
before tensor 147456 mask 21367.0 147456
layer2.3.conv2.weight, mask/weight parameters,21367,21367 density 0.3209993389820323,0.3209993389820323
before tensor 65536 mask 10740.0 65536
layer2.3.conv3.weight, mask/weight parameters,10740,10740 density 0.24391351744186046,0.24391351744186046
before tensor 131072 mask 30228.0 131072
layer3.0.conv1.weight, mask/weight parameters,30228,30228 density 0.37366495253164556,0.37366495253164556
before tensor 589824 mask 80691.0 589824
layer3.0.conv2.weight, mask/weight parameters,80691,80691 density 0.3591438337873204,0.3591438337873204
before tensor 262144 mask 61497.0 262144
layer3.0.conv3.weight, mask/weight parameters,61497,61497 density 0.38009913963607594,0.38009913963607594
layer3.0.shortcut.0.weight, mask/weight parameters,95935,95935 density 0.1829814910888672,0.1829814910888672
before tensor 262144 mask 28811.0 262144
layer3.1.conv1.weight, mask/weight parameters,28811,28811 density 0.17807431764240506,0.17807431764240506
before tensor 589824 mask 64665.0 589824
layer3.1.conv2.weight, mask/weight parameters,64665,64665 density 0.28781445281204937,0.28781445281204937
before tensor 262144 mask 46822.0 262144
layer3.1.conv3.weight, mask/weight parameters,46822,46822 density 0.2893962618670886,0.2893962618670886
before tensor 262144 mask 29589.0 262144
layer3.2.conv1.weight, mask/weight parameters,29589,29589 density 0.18288296083860758,0.18288296083860758
before tensor 589824 mask 56707.0 589824
layer3.2.conv2.weight, mask/weight parameters,56707,56707 density 0.2523945592764692,0.2523945592764692
before tensor 262144 mask 46393.0 262144
layer3.2.conv3.weight, mask/weight parameters,46393,46393 density 0.2867447092563291,0.2867447092563291
before tensor 262144 mask 29827.0 262144
layer3.3.conv1.weight, mask/weight parameters,29827,29827 density 0.18435398536392406,0.18435398536392406
before tensor 589824 mask 47184.0 589824
layer3.3.conv2.weight, mask/weight parameters,47184,47184 density 0.2100090797414944,0.2100090797414944
before tensor 262144 mask 37879.0 262144
layer3.3.conv3.weight, mask/weight parameters,37879,37879 density 0.2341215882120253,0.2341215882120253
before tensor 262144 mask 35534.0 262144
layer3.4.conv1.weight, mask/weight parameters,35534,35534 density 0.21962767009493672,0.21962767009493672
before tensor 589824 mask 48383.0 589824
layer3.4.conv2.weight, mask/weight parameters,48383,48383 density 0.21534565329630223,0.21534565329630223
before tensor 262144 mask 34635.0 262144
layer3.4.conv3.weight, mask/weight parameters,34635,34635 density 0.21407115308544303,0.21407115308544303
before tensor 262144 mask 39413.0 262144
layer3.5.conv1.weight, mask/weight parameters,39413,39413 density 0.24360289754746836,0.24360289754746836
before tensor 589824 mask 51567.0 589824
layer3.5.conv2.weight, mask/weight parameters,51567,51567 density 0.22951717139347327,0.22951717139347327
before tensor 262144 mask 35339.0 262144
layer3.5.conv3.weight, mask/weight parameters,35339,35339 density 0.21842241890822786,0.21842241890822786
before tensor 524288 mask 129607.0 524288
layer4.0.conv1.weight, mask/weight parameters,129607,129607 density 0.4136252808415033,0.4136252808415033
before tensor 2359296 mask 235394.0 2359296
layer4.0.conv2.weight, mask/weight parameters,235394,235394 density 0.27932514085275845,0.27932514085275845
before tensor 1048576 mask 114139.0 1048576
layer4.0.conv3.weight, mask/weight parameters,114139,114139 density 0.18213050194035948,0.18213050194035948
layer4.0.shortcut.0.weight, mask/weight parameters,156133,156133 density 0.07445001602172852,0.07445001602172852
before tensor 1048576 mask 108259.0 1048576
layer4.1.conv1.weight, mask/weight parameters,108259,108259 density 0.17274784262663398,0.17274784262663398
before tensor 2359296 mask 207634.0 2359296
layer4.1.conv2.weight, mask/weight parameters,207634,207634 density 0.2463843441031702,0.2463843441031702
before tensor 1048576 mask 95581.0 1048576
layer4.1.conv3.weight, mask/weight parameters,95581,95581 density 0.152517680249183,0.152517680249183
before tensor 1048576 mask 46512.0 1048576
layer4.2.conv1.weight, mask/weight parameters,46512,46512 density 0.07421875,0.07421875
before tensor 2359296 mask 47503.0 2359296
layer4.2.conv2.weight, mask/weight parameters,47503,47503 density 0.0563683958211704,0.0563683958211704
before tensor 1048576 mask 30944.0 1048576
layer4.2.conv3.weight, mask/weight parameters,30944,30944 density 0.04937704248366013,0.04937704248366013
classifier.weight, mask/weight parameters,103539,103539 density 0.5055615234375,0.5055615234375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.18365744185726884 0.18365744185726884 after dst
Death rate: 0.1338651221760631

dynamic sparse change grow
self.total_params*pruning_rate 3166182.1533921543
self.total_nonzero 2365205.0
to grow 800977.1533921543
len(all_scores) 12878351 9824209
increse 800977.0 before_mask 3166181.0 after_mask 3166181.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1327,1210 density 0.7679398148148148,0.7002314814814815
before tensor 4096 mask 890.0 4096
layer1.0.conv1.weight, mask/weight parameters,890,779 density 0.2958776595744681,0.2589760638297872
before tensor 36864 mask 4985.0 36864
layer1.0.conv2.weight, mask/weight parameters,4985,4027 density 0.2507419143906242,0.20255520346059053
before tensor 16384 mask 5110.0 16384
layer1.0.conv3.weight, mask/weight parameters,5110,4100 density 0.42470079787234044,0.34075797872340424
layer1.0.shortcut.0.weight, mask/weight parameters,6886,5867 density 0.4202880859375,0.35809326171875
before tensor 16384 mask 3333.0 16384
layer1.1.conv1.weight, mask/weight parameters,3333,2418 density 0.27701130319148937,0.20096409574468085
before tensor 36864 mask 4607.0 36864
layer1.1.conv2.weight, mask/weight parameters,4607,3741 density 0.23172878627835622,0.1881696091745888
before tensor 16384 mask 3060.0 16384
layer1.1.conv3.weight, mask/weight parameters,3060,2202 density 0.2543218085106383,0.1830119680851064
before tensor 16384 mask 3645.0 16384
layer1.2.conv1.weight, mask/weight parameters,3645,2582 density 0.3029421542553192,0.21459441489361702
before tensor 36864 mask 3595.0 36864
layer1.2.conv2.weight, mask/weight parameters,3595,2842 density 0.1808259141894271,0.14295055580705196
before tensor 16384 mask 2373.0 16384
layer1.2.conv3.weight, mask/weight parameters,2373,1783 density 0.19722406914893617,0.14818816489361702
before tensor 32768 mask 6752.0 32768
layer2.0.conv1.weight, mask/weight parameters,6752,5279 density 0.3066860465116279,0.23978015988372092
before tensor 147456 mask 16582.0 147456
layer2.0.conv2.weight, mask/weight parameters,16582,13413 density 0.24911363499789677,0.2015053181900126
before tensor 65536 mask 10194.0 65536
layer2.0.conv3.weight, mask/weight parameters,10194,7898 density 0.23151344476744187,0.17936954941860464
layer2.0.shortcut.0.weight, mask/weight parameters,39888,30366 density 0.3043212890625,0.2316741943359375
before tensor 65536 mask 5634.0 65536
layer2.1.conv1.weight, mask/weight parameters,5634,4440 density 0.12795239825581395,0.10083575581395349
before tensor 147456 mask 7312.0 147456
layer2.1.conv2.weight, mask/weight parameters,7312,5123 density 0.10984916771828616,0.07696352382669311
before tensor 65536 mask 5071.0 65536
layer2.1.conv3.weight, mask/weight parameters,5071,3789 density 0.11516624273255814,0.08605105377906977
before tensor 65536 mask 13177.0 65536
layer2.2.conv1.weight, mask/weight parameters,13177,10443 density 0.29925962936046513,0.23716842296511628
before tensor 147456 mask 27107.0 147456
layer2.2.conv2.weight, mask/weight parameters,27107,21514 density 0.40723213749173726,0.323207739919476
before tensor 65536 mask 16356.0 65536
layer2.2.conv3.weight, mask/weight parameters,16356,12523 density 0.37145712209302323,0.28440679505813954
before tensor 65536 mask 13806.0 65536
layer2.3.conv1.weight, mask/weight parameters,13806,10415 density 0.31354469476744184,0.2365325218023256
before tensor 147456 mask 25725.0 147456
layer2.3.conv2.weight, mask/weight parameters,25725,21367 density 0.38647016405264106,0.3209993389820323
before tensor 65536 mask 13347.0 65536
layer2.3.conv3.weight, mask/weight parameters,13347,10740 density 0.30312045784883723,0.24391351744186046
before tensor 131072 mask 37602.0 131072
layer3.0.conv1.weight, mask/weight parameters,37602,30228 density 0.46481902689873417,0.37366495253164556
before tensor 589824 mask 103262.0 589824
layer3.0.conv2.weight, mask/weight parameters,103262,80691 density 0.4596040520571846,0.3591438337873204
before tensor 262144 mask 76524.0 262144
layer3.0.conv3.weight, mask/weight parameters,76524,61497 density 0.4729776503164557,0.38009913963607594
layer3.0.shortcut.0.weight, mask/weight parameters,128184,95935 density 0.2444915771484375,0.1829814910888672
before tensor 262144 mask 39730.0 262144
layer3.1.conv1.weight, mask/weight parameters,39730,28811 density 0.2455622033227848,0.17807431764240506
before tensor 589824 mask 85916.0 589824
layer3.1.conv2.weight, mask/weight parameters,85916,64665 density 0.3823995442325838,0.28781445281204937
before tensor 262144 mask 59420.0 262144
layer3.1.conv3.weight, mask/weight parameters,59420,46822 density 0.36726166930379744,0.2893962618670886
before tensor 262144 mask 38054.0 262144
layer3.2.conv1.weight, mask/weight parameters,38054,29589 density 0.23520322389240506,0.18288296083860758
before tensor 589824 mask 77850.0 589824
layer3.2.conv2.weight, mask/weight parameters,77850,56707 density 0.3464989585002404,0.2523945592764692
before tensor 262144 mask 59843.0 262144
layer3.2.conv3.weight, mask/weight parameters,59843,46393 density 0.3698761372626582,0.2867447092563291
before tensor 262144 mask 38473.0 262144
layer3.3.conv1.weight, mask/weight parameters,38473,29827 density 0.23779296875,0.18435398536392406
before tensor 589824 mask 60919.0 589824
layer3.3.conv2.weight, mask/weight parameters,60919,47184 density 0.27114155495023945,0.2100090797414944
before tensor 262144 mask 49797.0 262144
layer3.3.conv3.weight, mask/weight parameters,49797,37879 density 0.3077840684335443,0.2341215882120253
before tensor 262144 mask 46768.0 262144
layer3.4.conv1.weight, mask/weight parameters,46768,35534 density 0.2890625,0.21962767009493672
before tensor 589824 mask 66769.0 589824
layer3.4.conv2.weight, mask/weight parameters,66769,48383 density 0.297179048941587,0.21534565329630223
before tensor 262144 mask 47293.0 262144
layer3.4.conv3.weight, mask/weight parameters,47293,34635 density 0.2923074070411392,0.21407115308544303
before tensor 262144 mask 52117.0 262144
layer3.5.conv1.weight, mask/weight parameters,52117,39413 density 0.3221234671677215,0.24360289754746836
before tensor 589824 mask 67213.0 589824
layer3.5.conv2.weight, mask/weight parameters,67213,51567 density 0.29915522797272515,0.22951717139347327
before tensor 262144 mask 45027.0 262144
layer3.5.conv3.weight, mask/weight parameters,45027,35339 density 0.2783017701740506,0.21842241890822786
before tensor 524288 mask 160374.0 524288
layer4.0.conv1.weight, mask/weight parameters,160374,129607 density 0.5118144914215687,0.4136252808415033
before tensor 2359296 mask 313121.0 2359296
layer4.0.conv2.weight, mask/weight parameters,313121,235394 density 0.37155818512348054,0.27932514085275845
before tensor 1048576 mask 158211.0 1048576
layer4.0.conv3.weight, mask/weight parameters,158211,114139 density 0.2524557674632353,0.18213050194035948
layer4.0.shortcut.0.weight, mask/weight parameters,237483,156133 density 0.11324071884155273,0.07445001602172852
before tensor 1048576 mask 147571.0 1048576
layer4.1.conv1.weight, mask/weight parameters,147571,108259 density 0.2354776220383987,0.17274784262663398
before tensor 2359296 mask 274500.0 2359296
layer4.1.conv2.weight, mask/weight parameters,274500,207634 density 0.3257294203084284,0.2463843441031702
before tensor 1048576 mask 134933.0 1048576
layer4.1.conv3.weight, mask/weight parameters,134933,95581 density 0.2153112872753268,0.152517680249183
before tensor 1048576 mask 75187.0 1048576
layer4.2.conv1.weight, mask/weight parameters,75187,46512 density 0.11997517105800654,0.07421875
before tensor 2359296 mask 79707.0 2359296
layer4.2.conv2.weight, mask/weight parameters,79707,47503 density 0.09458256795819271,0.0563683958211704
before tensor 1048576 mask 49097.0 1048576
layer4.2.conv3.weight, mask/weight parameters,49097,30944 density 0.07834360957924837,0.04937704248366013
classifier.weight, mask/weight parameters,114474,103539 density 0.558955078125,0.5055615234375
Total Model parameters after dst: 3166181 2365205
Total parameters under density level of 0.1: 0.2458529822645772 0.18365744185726884 after dst
Death rate: 0.1338651221760631


Training summary: Average loss: 1.3074, Accuracy: 31202/50000 (62.404%)


Evaluation: Average loss: 1.5856, Accuracy: 5725/10000 (57.250%)

Current learning rate: 0.1. Time taken for epoch: 88.75 seconds.

Train Epoch: 50 [0/50000 (0%)]	Loss: 1.381698 Accuracy: 61/100 (61.000%
Train Epoch: 50 [10000/50000 (20%)]	Loss: 1.479166 Accuracy: 6438/10100 (63.743%
Train Epoch: 50 [20000/50000 (40%)]	Loss: 1.052069 Accuracy: 12710/20100 (63.234%
Train Epoch: 50 [30000/50000 (60%)]	Loss: 1.102787 Accuracy: 18907/30100 (62.814%
Train Epoch: 50 [40000/50000 (80%)]	Loss: 1.266453 Accuracy: 25211/40100 (62.870%
current layer rate 0.38779267182521615
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4702.0
Total filter_masks items: 9902927.0
4702.0 / 7552 channels
Total channels to prune: 78.61025762403278
Layer ('layer2', 0, 'conv1'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/86.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/86.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/158.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/158.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 5/306.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 5/306.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 5/306.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 5/306.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 5/306.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 5/306.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4640.0
Total filter_masks items: 9697202.0
After apply_mask:
Total filter_names items: 4640.0
Total filter_masks items: 9697202.0
Total pruned: 62/78.61025762403278 channels
===========done ===============

Training summary: Average loss: 1.2967, Accuracy: 31342/50000 (62.684%)


Evaluation: Average loss: 1.4758, Accuracy: 5860/10000 (58.600%)

Current learning rate: 0.1. Time taken for epoch: 88.55 seconds.

Train Epoch: 51 [0/50000 (0%)]	Loss: 1.090211 Accuracy: 71/100 (71.000%
Train Epoch: 51 [10000/50000 (20%)]	Loss: 1.467174 Accuracy: 6422/10100 (63.584%
Train Epoch: 51 [20000/50000 (40%)]	Loss: 1.274881 Accuracy: 12765/20100 (63.507%
Train Epoch: 51 [30000/50000 (60%)]	Loss: 1.321021 Accuracy: 19043/30100 (63.266%
Train Epoch: 51 [40000/50000 (80%)]	Loss: 1.273711 Accuracy: 25244/40100 (62.953%
current mest  death_rate 0.13272542485937322


dynamic sparse change prune
to kill 732118.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1220,1220 density 0.7060185185185185,0.7060185185185185
before tensor 4096 mask 774.0 4096
layer1.0.conv1.weight, mask/weight parameters,774,774 density 0.25731382978723405,0.25731382978723405
before tensor 36864 mask 4161.0 36864
layer1.0.conv2.weight, mask/weight parameters,4161,4161 density 0.2092953070771088,0.2092953070771088
before tensor 16384 mask 4055.0 16384
layer1.0.conv3.weight, mask/weight parameters,4055,4055 density 0.33701795212765956,0.33701795212765956
layer1.0.shortcut.0.weight, mask/weight parameters,5800,5800 density 0.35400390625,0.35400390625
before tensor 16384 mask 2382.0 16384
layer1.1.conv1.weight, mask/weight parameters,2382,2382 density 0.1979720744680851,0.1979720744680851
before tensor 36864 mask 3853.0 36864
layer1.1.conv2.weight, mask/weight parameters,3853,3853 density 0.1938031286152608,0.1938031286152608
before tensor 16384 mask 2317.0 16384
layer1.1.conv3.weight, mask/weight parameters,2317,2317 density 0.19256981382978725,0.19256981382978725
before tensor 16384 mask 2684.0 16384
layer1.2.conv1.weight, mask/weight parameters,2684,2684 density 0.2230718085106383,0.2230718085106383
before tensor 36864 mask 2976.0 36864
layer1.2.conv2.weight, mask/weight parameters,2976,2976 density 0.14969065942357024,0.14969065942357024
before tensor 16384 mask 1824.0 16384
layer1.2.conv3.weight, mask/weight parameters,1824,1824 density 0.15159574468085107,0.15159574468085107
before tensor 32768 mask 5099.0 32768
layer2.0.conv1.weight, mask/weight parameters,5099,5099 density 0.23432904411764705,0.23432904411764705
before tensor 147456 mask 13455.0 147456
layer2.0.conv2.weight, mask/weight parameters,13455,13455 density 0.2069204152249135,0.2069204152249135
before tensor 65536 mask 7981.0 65536
layer2.0.conv3.weight, mask/weight parameters,7981,7981 density 0.18338694852941176,0.18338694852941176
layer2.0.shortcut.0.weight, mask/weight parameters,30263,30263 density 0.23088836669921875,0.23088836669921875
before tensor 65536 mask 4145.0 65536
layer2.1.conv1.weight, mask/weight parameters,4145,4145 density 0.09524356617647059,0.09524356617647059
before tensor 147456 mask 5286.0 147456
layer2.1.conv2.weight, mask/weight parameters,5286,5286 density 0.08129181084198385,0.08129181084198385
before tensor 65536 mask 3749.0 65536
layer2.1.conv3.weight, mask/weight parameters,3749,3749 density 0.08614430147058824,0.08614430147058824
before tensor 65536 mask 10359.0 65536
layer2.2.conv1.weight, mask/weight parameters,10359,10359 density 0.23802849264705883,0.23802849264705883
before tensor 147456 mask 21350.0 147456
layer2.2.conv2.weight, mask/weight parameters,21350,21350 density 0.32833525567089583,0.32833525567089583
before tensor 65536 mask 12506.0 65536
layer2.2.conv3.weight, mask/weight parameters,12506,12506 density 0.28736213235294117,0.28736213235294117
before tensor 65536 mask 10722.0 65536
layer2.3.conv1.weight, mask/weight parameters,10722,10722 density 0.24636948529411765,0.24636948529411765
before tensor 147456 mask 20877.0 147456
layer2.3.conv2.weight, mask/weight parameters,20877,20877 density 0.32106113033448674,0.32106113033448674
before tensor 65536 mask 10569.0 65536
layer2.3.conv3.weight, mask/weight parameters,10569,10569 density 0.24285386029411765,0.24285386029411765
before tensor 131072 mask 29904.0 131072
layer3.0.conv1.weight, mask/weight parameters,29904,29904 density 0.37439903846153844,0.37439903846153844
before tensor 589824 mask 80417.0 589824
layer3.0.conv2.weight, mask/weight parameters,80417,80417 density 0.36716067645554823,0.36716067645554823
before tensor 262144 mask 61372.0 262144
layer3.0.conv3.weight, mask/weight parameters,61372,61372 density 0.384189703525641,0.384189703525641
layer3.0.shortcut.0.weight, mask/weight parameters,95965,95965 density 0.18303871154785156,0.18303871154785156
before tensor 262144 mask 29209.0 262144
layer3.1.conv1.weight, mask/weight parameters,29209,29209 density 0.1828488080929487,0.1828488080929487
before tensor 589824 mask 63984.0 589824
layer3.1.conv2.weight, mask/weight parameters,63984,63984 density 0.292132369055446,0.292132369055446
before tensor 262144 mask 45921.0 262144
layer3.1.conv3.weight, mask/weight parameters,45921,45921 density 0.28746619591346156,0.28746619591346156
before tensor 262144 mask 28632.0 262144
layer3.2.conv1.weight, mask/weight parameters,28632,28632 density 0.17923677884615385,0.17923677884615385
before tensor 589824 mask 57649.0 589824
layer3.2.conv2.weight, mask/weight parameters,57649,57649 density 0.2632085981444956,0.2632085981444956
before tensor 262144 mask 46202.0 262144
layer3.2.conv3.weight, mask/weight parameters,46202,46202 density 0.2892252604166667,0.2892252604166667
before tensor 262144 mask 29066.0 262144
layer3.3.conv1.weight, mask/weight parameters,29066,29066 density 0.18195362580128205,0.18195362580128205
before tensor 589824 mask 46279.0 589824
layer3.3.conv2.weight, mask/weight parameters,46279,46279 density 0.21129647892468406,0.21129647892468406
before tensor 262144 mask 37978.0 262144
layer3.3.conv3.weight, mask/weight parameters,37978,37978 density 0.23774288862179488,0.23774288862179488
before tensor 262144 mask 34797.0 262144
layer3.4.conv1.weight, mask/weight parameters,34797,34797 density 0.21782977764423078,0.21782977764423078
before tensor 589824 mask 49096.0 589824
layer3.4.conv2.weight, mask/weight parameters,49096,49096 density 0.2241580831324421,0.2241580831324421
before tensor 262144 mask 35444.0 262144
layer3.4.conv3.weight, mask/weight parameters,35444,35444 density 0.2218800080128205,0.2218800080128205
before tensor 262144 mask 39313.0 262144
layer3.5.conv1.weight, mask/weight parameters,39313,39313 density 0.24610001001602563,0.24610001001602563
before tensor 589824 mask 50299.0 589824
layer3.5.conv2.weight, mask/weight parameters,50299,50299 density 0.22965063189422164,0.22965063189422164
before tensor 262144 mask 34142.0 262144
layer3.5.conv3.weight, mask/weight parameters,34142,34142 density 0.2137294671474359,0.2137294671474359
before tensor 524288 mask 129045.0 524288
layer4.0.conv1.weight, mask/weight parameters,129045,129045 density 0.41867278343023256,0.41867278343023256
before tensor 2359296 mask 234500.0 2359296
layer4.0.conv2.weight, mask/weight parameters,234500,234500 density 0.2875857391811962,0.2875857391811962
before tensor 1048576 mask 114177.0 1048576
layer4.0.conv3.weight, mask/weight parameters,114177,114177 density 0.18521756904069767,0.18521756904069767
layer4.0.shortcut.0.weight, mask/weight parameters,158210,158210 density 0.0754404067993164,0.0754404067993164
before tensor 1048576 mask 109746.0 1048576
layer4.1.conv1.weight, mask/weight parameters,109746,109746 density 0.17802961482558138,0.17802961482558138
before tensor 2359296 mask 206882.0 2359296
layer4.1.conv2.weight, mask/weight parameters,206882,206882 density 0.2537156200140052,0.2537156200140052
before tensor 1048576 mask 95845.0 1048576
layer4.1.conv3.weight, mask/weight parameters,95845,95845 density 0.15547945649916944,0.15547945649916944
before tensor 1048576 mask 48641.0 1048576
layer4.2.conv1.weight, mask/weight parameters,48641,48641 density 0.07890527668189369,0.07890527668189369
before tensor 2359296 mask 49105.0 2359296
layer4.2.conv2.weight, mask/weight parameters,49105,49105 density 0.06022131224943556,0.06022131224943556
before tensor 1048576 mask 31572.0 1048576
layer4.2.conv3.weight, mask/weight parameters,31572,31572 density 0.05121599875415282,0.05121599875415282
classifier.weight, mask/weight parameters,103406,103406 density 0.504912109375,0.504912109375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.18663890183455267 0.18663890183455267 after dst
Death rate: 0.13272542485937322

dynamic sparse change grow
self.total_params*pruning_rate 3139225.9959874908
self.total_nonzero 2365205.0
to grow 774020.9959874908
len(all_scores) 12672626 9587447
increse 774020.0 before_mask 3139224.0 after_mask 3139224.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1312,1220 density 0.7592592592592593,0.7060185185185185
before tensor 4096 mask 839.0 4096
layer1.0.conv1.weight, mask/weight parameters,839,774 density 0.2789228723404255,0.25731382978723405
before tensor 36864 mask 4808.0 36864
layer1.0.conv2.weight, mask/weight parameters,4808,4161 density 0.24183894170313364,0.2092953070771088
before tensor 16384 mask 5109.0 16384
layer1.0.conv3.weight, mask/weight parameters,5109,4055 density 0.4246176861702128,0.33701795212765956
layer1.0.shortcut.0.weight, mask/weight parameters,6871,5800 density 0.41937255859375,0.35400390625
before tensor 16384 mask 3170.0 16384
layer1.1.conv1.weight, mask/weight parameters,3170,2382 density 0.2634640957446808,0.1979720744680851
before tensor 36864 mask 4442.0 36864
layer1.1.conv2.weight, mask/weight parameters,4442,3853 density 0.22342940495950908,0.1938031286152608
before tensor 16384 mask 3084.0 16384
layer1.1.conv3.weight, mask/weight parameters,3084,2317 density 0.25631648936170215,0.19256981382978725
before tensor 16384 mask 3318.0 16384
layer1.2.conv1.weight, mask/weight parameters,3318,2684 density 0.2757646276595745,0.2230718085106383
before tensor 36864 mask 3579.0 36864
layer1.2.conv2.weight, mask/weight parameters,3579,2976 density 0.18002112569790252,0.14969065942357024
before tensor 16384 mask 2347.0 16384
layer1.2.conv3.weight, mask/weight parameters,2347,1824 density 0.19506316489361702,0.15159574468085107
before tensor 32768 mask 7121.0 32768
layer2.0.conv1.weight, mask/weight parameters,7121,5099 density 0.32725183823529413,0.23432904411764705
before tensor 147456 mask 16392.0 147456
layer2.0.conv2.weight, mask/weight parameters,16392,13455 density 0.25208765859284893,0.2069204152249135
before tensor 65536 mask 9916.0 65536
layer2.0.conv3.weight, mask/weight parameters,9916,7981 density 0.22784926470588235,0.18338694852941176
layer2.0.shortcut.0.weight, mask/weight parameters,41605,30263 density 0.31742095947265625,0.23088836669921875
before tensor 65536 mask 6834.0 65536
layer2.1.conv1.weight, mask/weight parameters,6834,4145 density 0.15703125,0.09524356617647059
before tensor 147456 mask 6991.0 147456
layer2.1.conv2.weight, mask/weight parameters,6991,5286 density 0.1075124951941561,0.08129181084198385
before tensor 65536 mask 5397.0 65536
layer2.1.conv3.weight, mask/weight parameters,5397,3749 density 0.12401194852941176,0.08614430147058824
before tensor 65536 mask 13758.0 65536
layer2.2.conv1.weight, mask/weight parameters,13758,10359 density 0.3161305147058823,0.23802849264705883
before tensor 147456 mask 28100.0 147456
layer2.2.conv2.weight, mask/weight parameters,28100,21350 density 0.43214148404459823,0.32833525567089583
before tensor 65536 mask 16714.0 65536
layer2.2.conv3.weight, mask/weight parameters,16714,12506 density 0.3840533088235294,0.28736213235294117
before tensor 65536 mask 14107.0 65536
layer2.3.conv1.weight, mask/weight parameters,14107,10722 density 0.3241498161764706,0.24636948529411765
before tensor 147456 mask 26429.0 147456
layer2.3.conv2.weight, mask/weight parameters,26429,20877 density 0.40644367550941946,0.32106113033448674
before tensor 65536 mask 14021.0 65536
layer2.3.conv3.weight, mask/weight parameters,14021,10569 density 0.3221737132352941,0.24285386029411765
before tensor 131072 mask 40109.0 131072
layer3.0.conv1.weight, mask/weight parameters,40109,29904 density 0.5021659655448718,0.37439903846153844
before tensor 589824 mask 104437.0 589824
layer3.0.conv2.weight, mask/weight parameters,104437,80417 density 0.4768290233033823,0.36716067645554823
before tensor 262144 mask 77009.0 262144
layer3.0.conv3.weight, mask/weight parameters,77009,61372 density 0.48207757411858976,0.384189703525641
layer3.0.shortcut.0.weight, mask/weight parameters,134450,95965 density 0.2564430236816406,0.18303871154785156
before tensor 262144 mask 40808.0 262144
layer3.1.conv1.weight, mask/weight parameters,40808,29209 density 0.255458733974359,0.1828488080929487
before tensor 589824 mask 85688.0 589824
layer3.1.conv2.weight, mask/weight parameters,85688,63984 density 0.3912265322521733,0.292132369055446
before tensor 262144 mask 57418.0 262144
layer3.1.conv3.weight, mask/weight parameters,57418,45921 density 0.3594376001602564,0.28746619591346156
before tensor 262144 mask 39490.0 262144
layer3.2.conv1.weight, mask/weight parameters,39490,28632 density 0.2472080328525641,0.17923677884615385
before tensor 589824 mask 77541.0 589824
layer3.2.conv2.weight, mask/weight parameters,77541,57649 density 0.3540296953758492,0.2632085981444956
before tensor 262144 mask 59055.0 262144
layer3.2.conv3.weight, mask/weight parameters,59055,46202 density 0.3696852463942308,0.2892252604166667
before tensor 262144 mask 42966.0 262144
layer3.3.conv1.weight, mask/weight parameters,42966,29066 density 0.2689678485576923,0.18195362580128205
before tensor 589824 mask 64242.0 589824
layer3.3.conv2.weight, mask/weight parameters,64242,46279 density 0.293310322156476,0.21129647892468406
before tensor 262144 mask 50356.0 262144
layer3.3.conv3.weight, mask/weight parameters,50356,37978 density 0.31522936698717946,0.23774288862179488
before tensor 262144 mask 46024.0 262144
layer3.4.conv1.weight, mask/weight parameters,46024,34797 density 0.2881109775641026,0.21782977764423078
before tensor 589824 mask 63814.0 589824
layer3.4.conv2.weight, mask/weight parameters,63814,49096 density 0.29135619840748045,0.2241580831324421
before tensor 262144 mask 45851.0 262144
layer3.4.conv3.weight, mask/weight parameters,45851,35444 density 0.2870279947916667,0.2218800080128205
before tensor 262144 mask 50330.0 262144
layer3.5.conv1.weight, mask/weight parameters,50330,39313 density 0.31506660657051283,0.24610001001602563
before tensor 589824 mask 64383.0 589824
layer3.5.conv2.weight, mask/weight parameters,64383,50299 density 0.293954087223318,0.22965063189422164
before tensor 262144 mask 43819.0 262144
layer3.5.conv3.weight, mask/weight parameters,43819,34142 density 0.2743076422275641,0.2137294671474359
before tensor 524288 mask 158812.0 524288
layer4.0.conv1.weight, mask/weight parameters,158812,129045 density 0.5152486503322259,0.41867278343023256
before tensor 2359296 mask 307598.0 2359296
layer4.0.conv2.weight, mask/weight parameters,307598,234500 density 0.3772315488300963,0.2875857391811962
before tensor 1048576 mask 152754.0 1048576
layer4.0.conv3.weight, mask/weight parameters,152754,114177 density 0.2477970566860465,0.18521756904069767
layer4.0.shortcut.0.weight, mask/weight parameters,235361,158210 density 0.1122288703918457,0.0754404067993164
before tensor 1048576 mask 146079.0 1048576
layer4.1.conv1.weight, mask/weight parameters,146079,109746 density 0.23696889275332225,0.17802961482558138
before tensor 2359296 mask 270286.0 2359296
layer4.1.conv2.weight, mask/weight parameters,270286,206882 density 0.331472917272191,0.2537156200140052
before tensor 1048576 mask 131338.0 1048576
layer4.1.conv3.weight, mask/weight parameters,131338,95845 density 0.21305608907807308,0.15547945649916944
before tensor 1048576 mask 69836.0 1048576
layer4.2.conv1.weight, mask/weight parameters,69836,48641 density 0.11328773878737541,0.07890527668189369
before tensor 2359296 mask 73337.0 2359296
layer4.2.conv2.weight, mask/weight parameters,73337,49105 density 0.0899389140909654,0.06022131224943556
before tensor 1048576 mask 45906.0 1048576
layer4.2.conv3.weight, mask/weight parameters,45906,31572 density 0.07446856831395349,0.05121599875415282
classifier.weight, mask/weight parameters,113863,103406 density 0.5559716796875,0.504912109375
Total Model parameters after dst: 3139224 2365205
Total parameters under density level of 0.1: 0.24771692938780013 0.18663890183455267 after dst
Death rate: 0.13272542485937322


Training summary: Average loss: 1.2881, Accuracy: 31535/50000 (63.070%)


Evaluation: Average loss: 1.5949, Accuracy: 5733/10000 (57.330%)

Current learning rate: 0.1. Time taken for epoch: 88.75 seconds.

Train Epoch: 52 [0/50000 (0%)]	Loss: 1.027706 Accuracy: 71/100 (71.000%
Train Epoch: 52 [10000/50000 (20%)]	Loss: 1.219049 Accuracy: 6424/10100 (63.604%
Train Epoch: 52 [20000/50000 (40%)]	Loss: 1.334560 Accuracy: 12693/20100 (63.149%
Train Epoch: 52 [30000/50000 (60%)]	Loss: 1.284388 Accuracy: 19061/30100 (63.326%
Train Epoch: 52 [40000/50000 (80%)]	Loss: 1.015150 Accuracy: 25342/40100 (63.197%
current layer rate 0.39610081929904417
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4640.0
Total filter_masks items: 9697202.0
4640.0 / 7552 channels
Total channels to prune: 79.35338734638117
Layer ('layer2', 0, 'conv1'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/85.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/85.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/156.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/156.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 5/301.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 5/301.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 5/301.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 5/301.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 5/301.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 5/301.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4578.0
Total filter_masks items: 9493331.0
After apply_mask:
Total filter_names items: 4578.0
Total filter_masks items: 9493331.0
Total pruned: 62/79.35338734638117 channels
===========done ===============

Training summary: Average loss: 1.2894, Accuracy: 31496/50000 (62.992%)


Evaluation: Average loss: 1.5936, Accuracy: 5610/10000 (56.100%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 53 [0/50000 (0%)]	Loss: 1.326563 Accuracy: 59/100 (59.000%
Train Epoch: 53 [10000/50000 (20%)]	Loss: 1.201870 Accuracy: 6552/10100 (64.871%
Train Epoch: 53 [20000/50000 (40%)]	Loss: 1.326903 Accuracy: 12809/20100 (63.726%
Train Epoch: 53 [30000/50000 (60%)]	Loss: 1.484885 Accuracy: 19103/30100 (63.465%
Train Epoch: 53 [40000/50000 (80%)]	Loss: 1.243448 Accuracy: 25425/40100 (63.404%
current mest  death_rate 0.13156768445496475


dynamic sparse change prune
to kill 708395.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1203,1203 density 0.6961805555555556,0.6961805555555556
before tensor 4096 mask 717.0 4096
layer1.0.conv1.weight, mask/weight parameters,717,717 density 0.23836436170212766,0.23836436170212766
before tensor 36864 mask 4100.0 36864
layer1.0.conv2.weight, mask/weight parameters,4100,4100 density 0.20622705095317137,0.20622705095317137
before tensor 16384 mask 4071.0 16384
layer1.0.conv3.weight, mask/weight parameters,4071,4071 density 0.33834773936170215,0.33834773936170215
layer1.0.shortcut.0.weight, mask/weight parameters,5697,5697 density 0.34771728515625,0.34771728515625
before tensor 16384 mask 2357.0 16384
layer1.1.conv1.weight, mask/weight parameters,2357,2357 density 0.1958942819148936,0.1958942819148936
before tensor 36864 mask 3791.0 36864
layer1.1.conv2.weight, mask/weight parameters,3791,3791 density 0.1906845732106031,0.1906845732106031
before tensor 16384 mask 2307.0 16384
layer1.1.conv3.weight, mask/weight parameters,2307,2307 density 0.19173869680851063,0.19173869680851063
before tensor 16384 mask 2566.0 16384
layer1.2.conv1.weight, mask/weight parameters,2566,2566 density 0.21326462765957446,0.21326462765957446
before tensor 36864 mask 2972.0 36864
layer1.2.conv2.weight, mask/weight parameters,2972,2972 density 0.1494894623006891,0.1494894623006891
before tensor 16384 mask 1766.0 16384
layer1.2.conv3.weight, mask/weight parameters,1766,1766 density 0.1467752659574468,0.1467752659574468
before tensor 32768 mask 5307.0 32768
layer2.0.conv1.weight, mask/weight parameters,5307,5307 density 0.24679129464285715,0.24679129464285715
before tensor 147456 mask 13690.0 147456
layer2.0.conv2.weight, mask/weight parameters,13690,13690 density 0.21557697152935248,0.21557697152935248
before tensor 65536 mask 7869.0 65536
layer2.0.conv3.weight, mask/weight parameters,7869,7869 density 0.18296595982142858,0.18296595982142858
layer2.0.shortcut.0.weight, mask/weight parameters,31155,31155 density 0.23769378662109375,0.23769378662109375
before tensor 65536 mask 4532.0 65536
layer2.1.conv1.weight, mask/weight parameters,4532,4532 density 0.10537574404761904,0.10537574404761904
before tensor 147456 mask 5092.0 147456
layer2.1.conv2.weight, mask/weight parameters,5092,5092 density 0.08018392542202066,0.08018392542202066
before tensor 65536 mask 3723.0 65536
layer2.1.conv3.weight, mask/weight parameters,3723,3723 density 0.08656529017857142,0.08656529017857142
before tensor 65536 mask 10652.0 65536
layer2.2.conv1.weight, mask/weight parameters,10652,10652 density 0.2476748511904762,0.2476748511904762
before tensor 147456 mask 22262.0 147456
layer2.2.conv2.weight, mask/weight parameters,22262,22262 density 0.35056059460821365,0.35056059460821365
before tensor 65536 mask 12871.0 65536
layer2.2.conv3.weight, mask/weight parameters,12871,12871 density 0.29926990327380953,0.29926990327380953
before tensor 65536 mask 10920.0 65536
layer2.3.conv1.weight, mask/weight parameters,10920,10920 density 0.25390625,0.25390625
before tensor 147456 mask 21475.0 147456
layer2.3.conv2.weight, mask/weight parameters,21475,21475 density 0.3381676744771983,0.3381676744771983
before tensor 65536 mask 10954.0 65536
layer2.3.conv3.weight, mask/weight parameters,10954,10954 density 0.2546968005952381,0.2546968005952381
before tensor 131072 mask 31285.0 131072
layer3.0.conv1.weight, mask/weight parameters,31285,31285 density 0.396776075487013,0.396776075487013
before tensor 589824 mask 81356.0 589824
layer3.0.conv2.weight, mask/weight parameters,81356,81356 density 0.38115852401566686,0.38115852401566686
before tensor 262144 mask 62061.0 262144
layer3.0.conv3.weight, mask/weight parameters,62061,62061 density 0.39354834618506496,0.39354834618506496
layer3.0.shortcut.0.weight, mask/weight parameters,99409,99409 density 0.1896076202392578,0.1896076202392578
before tensor 262144 mask 30152.0 262144
layer3.1.conv1.weight, mask/weight parameters,30152,30152 density 0.19120332792207792,0.19120332792207792
before tensor 589824 mask 64377.0 589824
layer3.1.conv2.weight, mask/weight parameters,64377,64377 density 0.30161072693540225,0.30161072693540225
before tensor 262144 mask 45057.0 262144
layer3.1.conv3.weight, mask/weight parameters,45057,45057 density 0.2857206270292208,0.2857206270292208
before tensor 262144 mask 29306.0 262144
layer3.2.conv1.weight, mask/weight parameters,29306,29306 density 0.185838575487013,0.185838575487013
before tensor 589824 mask 58511.0 589824
layer3.2.conv2.weight, mask/weight parameters,58511,58511 density 0.27412810854369296,0.27412810854369296
before tensor 262144 mask 46073.0 262144
layer3.2.conv3.weight, mask/weight parameters,46073,46073 density 0.2921634030032468,0.2921634030032468
before tensor 262144 mask 31544.0 262144
layer3.3.conv1.weight, mask/weight parameters,31544,31544 density 0.20003043831168832,0.20003043831168832
before tensor 589824 mask 48604.0 589824
layer3.3.conv2.weight, mask/weight parameters,48604,48604 density 0.2277131238170199,0.2277131238170199
before tensor 262144 mask 38571.0 262144
layer3.3.conv3.weight, mask/weight parameters,38571,38571 density 0.2445908583603896,0.2445908583603896
before tensor 262144 mask 34436.0 262144
layer3.4.conv1.weight, mask/weight parameters,34436,34436 density 0.2183695211038961,0.2183695211038961
before tensor 589824 mask 47705.0 589824
layer3.4.conv2.weight, mask/weight parameters,47705,47705 density 0.22350124622851897,0.22350124622851897
before tensor 262144 mask 34517.0 262144
layer3.4.conv3.weight, mask/weight parameters,34517,34517 density 0.21888316761363635,0.21888316761363635
before tensor 262144 mask 38736.0 262144
layer3.5.conv1.weight, mask/weight parameters,38736,38736 density 0.24563717532467533,0.24563717532467533
before tensor 589824 mask 49459.0 589824
layer3.5.conv2.weight, mask/weight parameters,49459,49459 density 0.23171885834223496,0.23171885834223496
before tensor 262144 mask 33653.0 262144
layer3.5.conv3.weight, mask/weight parameters,33653,33653 density 0.21340427150974026,0.21340427150974026
before tensor 524288 mask 128154.0 524288
layer4.0.conv1.weight, mask/weight parameters,128154,128154 density 0.4228053737331081,0.4228053737331081
before tensor 2359296 mask 232148.0 2359296
layer4.0.conv2.weight, mask/weight parameters,232148,232148 density 0.29440081973865756,0.29440081973865756
before tensor 1048576 mask 111942.0 1048576
layer4.0.conv3.weight, mask/weight parameters,111942,111942 density 0.18465939083614866,0.18465939083614866
layer4.0.shortcut.0.weight, mask/weight parameters,158474,158474 density 0.07556629180908203,0.07556629180908203
before tensor 1048576 mask 109105.0 1048576
layer4.1.conv1.weight, mask/weight parameters,109105,109105 density 0.17997947899070946,0.17997947899070946
before tensor 2359296 mask 203718.0 2359296
layer4.1.conv2.weight, mask/weight parameters,203718,203718 density 0.2583470294618943,0.2583470294618943
before tensor 1048576 mask 93523.0 1048576
layer4.1.conv3.weight, mask/weight parameters,93523,93523 density 0.15427543021537163,0.15427543021537163
before tensor 1048576 mask 48673.0 1048576
layer4.2.conv1.weight, mask/weight parameters,48673,48673 density 0.08029092324746621,0.08029092324746621
before tensor 2359296 mask 48621.0 2359296
layer4.2.conv2.weight, mask/weight parameters,48621,48621 density 0.061659209885561235,0.061659209885561235
before tensor 1048576 mask 31053.0 1048576
layer4.2.conv3.weight, mask/weight parameters,31053,31053 density 0.05122499208192568,0.05122499208192568
classifier.weight, mask/weight parameters,102933,102933 density 0.5026025390625,0.5026025390625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.18969055050002986 0.18969055050002986 after dst
Death rate: 0.13156768445496475

dynamic sparse change grow
self.total_params*pruning_rate 3111843.082894729
self.total_nonzero 2365205.0
to grow 746638.082894729
len(all_scores) 12468755 9356368
increse 746638.0 before_mask 3111842.0 after_mask 3111842.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1297,1203 density 0.7505787037037037,0.6961805555555556
before tensor 4096 mask 864.0 4096
layer1.0.conv1.weight, mask/weight parameters,864,717 density 0.2872340425531915,0.23836436170212766
before tensor 36864 mask 4890.0 36864
layer1.0.conv2.weight, mask/weight parameters,4890,4100 density 0.24596348272219706,0.20622705095317137
before tensor 16384 mask 4876.0 16384
layer1.0.conv3.weight, mask/weight parameters,4876,4071 density 0.4052526595744681,0.33834773936170215
layer1.0.shortcut.0.weight, mask/weight parameters,6968,5697 density 0.42529296875,0.34771728515625
before tensor 16384 mask 3095.0 16384
layer1.1.conv1.weight, mask/weight parameters,3095,2357 density 0.2572307180851064,0.1958942819148936
before tensor 36864 mask 4609.0 36864
layer1.1.conv2.weight, mask/weight parameters,4609,3791 density 0.2318293848397968,0.1906845732106031
before tensor 16384 mask 2791.0 16384
layer1.1.conv3.weight, mask/weight parameters,2791,2307 density 0.23196476063829788,0.19173869680851063
before tensor 16384 mask 3442.0 16384
layer1.2.conv1.weight, mask/weight parameters,3442,2566 density 0.28607047872340424,0.21326462765957446
before tensor 36864 mask 3531.0 36864
layer1.2.conv2.weight, mask/weight parameters,3531,2972 density 0.1776067602233288,0.1494894623006891
before tensor 16384 mask 2367.0 16384
layer1.2.conv3.weight, mask/weight parameters,2367,1766 density 0.19672539893617022,0.1467752659574468
before tensor 32768 mask 7547.0 32768
layer2.0.conv1.weight, mask/weight parameters,7547,5307 density 0.35095796130952384,0.24679129464285715
before tensor 147456 mask 17209.0 147456
layer2.0.conv2.weight, mask/weight parameters,17209,13690 density 0.27099080372889894,0.21557697152935248
before tensor 65536 mask 9538.0 65536
layer2.0.conv3.weight, mask/weight parameters,9538,7869 density 0.22177269345238096,0.18296595982142858
layer2.0.shortcut.0.weight, mask/weight parameters,40320,31155 density 0.3076171875,0.23769378662109375
before tensor 65536 mask 5573.0 65536
layer2.1.conv1.weight, mask/weight parameters,5573,4532 density 0.12958054315476192,0.10537574404761904
before tensor 147456 mask 6026.0 147456
layer2.1.conv2.weight, mask/weight parameters,6026,5092 density 0.09489166036785085,0.08018392542202066
before tensor 65536 mask 4803.0 65536
layer2.1.conv3.weight, mask/weight parameters,4803,3723 density 0.11167689732142858,0.08656529017857142
before tensor 65536 mask 13733.0 65536
layer2.2.conv1.weight, mask/weight parameters,13733,10652 density 0.31931268601190477,0.2476748511904762
before tensor 147456 mask 28760.0 147456
layer2.2.conv2.weight, mask/weight parameters,28760,22262 density 0.4528848576467624,0.35056059460821365
before tensor 65536 mask 16725.0 65536
layer2.2.conv3.weight, mask/weight parameters,16725,12871 density 0.38888113839285715,0.29926990327380953
before tensor 65536 mask 14353.0 65536
layer2.3.conv1.weight, mask/weight parameters,14353,10920 density 0.3337286086309524,0.25390625
before tensor 147456 mask 26713.0 147456
layer2.3.conv2.weight, mask/weight parameters,26713,21475 density 0.4206506676744772,0.3381676744771983
before tensor 65536 mask 14067.0 65536
layer2.3.conv3.weight, mask/weight parameters,14067,10954 density 0.3270786830357143,0.2546968005952381
before tensor 131072 mask 39791.0 131072
layer3.0.conv1.weight, mask/weight parameters,39791,31285 density 0.5046545251623377,0.396776075487013
before tensor 589824 mask 102237.0 589824
layer3.0.conv2.weight, mask/weight parameters,102237,81356 density 0.4789874627536965,0.38115852401566686
before tensor 262144 mask 76022.0 262144
layer3.0.conv3.weight, mask/weight parameters,76022,62061 density 0.4820794439935065,0.39354834618506496
layer3.0.shortcut.0.weight, mask/weight parameters,128685,99409 density 0.24544715881347656,0.1896076202392578
before tensor 262144 mask 37329.0 262144
layer3.1.conv1.weight, mask/weight parameters,37329,30152 density 0.23671494521103897,0.19120332792207792
before tensor 589824 mask 80274.0 589824
layer3.1.conv2.weight, mask/weight parameters,80274,64377 density 0.3760892786866813,0.30161072693540225
before tensor 262144 mask 57029.0 262144
layer3.1.conv3.weight, mask/weight parameters,57029,45057 density 0.3616388494318182,0.2857206270292208
before tensor 262144 mask 39837.0 262144
layer3.2.conv1.weight, mask/weight parameters,39837,29306 density 0.2526189630681818,0.185838575487013
before tensor 589824 mask 78236.0 589824
layer3.2.conv2.weight, mask/weight parameters,78236,58511 density 0.36654110680084706,0.27412810854369296
before tensor 262144 mask 60497.0 262144
layer3.2.conv3.weight, mask/weight parameters,60497,46073 density 0.38363052962662336,0.2921634030032468
before tensor 262144 mask 40428.0 262144
layer3.3.conv1.weight, mask/weight parameters,40428,31544 density 0.2563666801948052,0.20003043831168832
before tensor 589824 mask 61266.0 589824
layer3.3.conv2.weight, mask/weight parameters,61266,48604 density 0.28703547534716367,0.2277131238170199
before tensor 262144 mask 50521.0 262144
layer3.3.conv3.weight, mask/weight parameters,50521,38571 density 0.3203695718344156,0.2445908583603896
before tensor 262144 mask 42914.0 262144
layer3.4.conv1.weight, mask/weight parameters,42914,34436 density 0.27213118912337664,0.2183695211038961
before tensor 589824 mask 60648.0 589824
layer3.4.conv2.weight, mask/weight parameters,60648,47705 density 0.2841401023219205,0.22350124622851897
before tensor 262144 mask 46409.0 262144
layer3.4.conv3.weight, mask/weight parameters,46409,34517 density 0.29429408482142855,0.21888316761363635
before tensor 262144 mask 47957.0 262144
layer3.5.conv1.weight, mask/weight parameters,47957,38736 density 0.3041104403409091,0.24563717532467533
before tensor 589824 mask 61567.0 589824
layer3.5.conv2.weight, mask/weight parameters,61567,49459 density 0.28844568130282416,0.23171885834223496
before tensor 262144 mask 44502.0 262144
layer3.5.conv3.weight, mask/weight parameters,44502,33653 density 0.2822011972402597,0.21340427150974026
before tensor 524288 mask 157700.0 524288
layer4.0.conv1.weight, mask/weight parameters,157700,128154 density 0.5202834670608109,0.4228053737331081
before tensor 2359296 mask 303937.0 2359296
layer4.0.conv2.weight, mask/weight parameters,303937,232148 density 0.3854407617076536,0.29440081973865756
before tensor 1048576 mask 159885.0 1048576
layer4.0.conv3.weight, mask/weight parameters,159885,111942 density 0.2637461069467905,0.18465939083614866
layer4.0.shortcut.0.weight, mask/weight parameters,234664,158474 density 0.11189651489257812,0.07556629180908203
before tensor 1048576 mask 142887.0 1048576
layer4.1.conv1.weight, mask/weight parameters,142887,109105 density 0.23570622624577703,0.17997947899070946
before tensor 2359296 mask 263695.0 2359296
layer4.1.conv2.weight, mask/weight parameters,263695,203718 density 0.33440746489732975,0.2583470294618943
before tensor 1048576 mask 129724.0 1048576
layer4.1.conv3.weight, mask/weight parameters,129724,93523 density 0.21399255701013514,0.15427543021537163
before tensor 1048576 mask 76076.0 1048576
layer4.2.conv1.weight, mask/weight parameters,76076,48673 density 0.12549487964527026,0.08029092324746621
before tensor 2359296 mask 80248.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80248,48621 density 0.10176730784838893,0.061659209885561235
before tensor 1048576 mask 48231.0 1048576
layer4.2.conv3.weight, mask/weight parameters,48231,31053 density 0.07956180057010136,0.05122499208192568
classifier.weight, mask/weight parameters,114549,102933 density 0.5593212890625,0.5026025390625
Total Model parameters after dst: 3111842 2365205
Total parameters under density level of 0.1: 0.24957118814187945 0.18969055050002986 after dst
Death rate: 0.13156768445496475


Training summary: Average loss: 1.2855, Accuracy: 31556/50000 (63.112%)


Evaluation: Average loss: 1.5701, Accuracy: 5819/10000 (58.190%)

Current learning rate: 0.1. Time taken for epoch: 88.75 seconds.

Train Epoch: 54 [0/50000 (0%)]	Loss: 1.190252 Accuracy: 65/100 (65.000%
Train Epoch: 54 [10000/50000 (20%)]	Loss: 1.133207 Accuracy: 6555/10100 (64.901%
Train Epoch: 54 [20000/50000 (40%)]	Loss: 1.427499 Accuracy: 12825/20100 (63.806%
Train Epoch: 54 [30000/50000 (60%)]	Loss: 1.442189 Accuracy: 19014/30100 (63.169%
Train Epoch: 54 [40000/50000 (80%)]	Loss: 1.531988 Accuracy: 25230/40100 (62.918%
current layer rate 0.4039883932635412
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4578.0
Total filter_masks items: 9493331.0
4578.0 / 7552 channels
Total channels to prune: 76.92034592626351
Layer ('layer2', 0, 'conv1'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/84.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/84.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/154.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/154.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 4/296.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 4/296.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 4/296.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 4/296.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 4/296.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 4/296.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4522.0
Total filter_masks items: 9318319.0
After apply_mask:
Total filter_names items: 4522.0
Total filter_masks items: 9318319.0
Total pruned: 56/76.92034592626351 channels
===========done ===============

Training summary: Average loss: 1.2817, Accuracy: 31446/50000 (62.892%)


Evaluation: Average loss: 1.6036, Accuracy: 5670/10000 (56.700%)

Current learning rate: 0.1. Time taken for epoch: 88.57 seconds.

Train Epoch: 55 [0/50000 (0%)]	Loss: 1.301776 Accuracy: 63/100 (63.000%
Train Epoch: 55 [10000/50000 (20%)]	Loss: 1.266476 Accuracy: 6550/10100 (64.851%
Train Epoch: 55 [20000/50000 (40%)]	Loss: 1.320777 Accuracy: 12862/20100 (63.990%
Train Epoch: 55 [30000/50000 (60%)]	Loss: 1.441349 Accuracy: 19220/30100 (63.854%
Train Epoch: 55 [40000/50000 (80%)]	Loss: 1.173407 Accuracy: 25408/40100 (63.362%
current mest  death_rate 0.1303946049191954


dynamic sparse change prune
to kill 684675.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1191,1191 density 0.6892361111111112,0.6892361111111112
before tensor 4096 mask 732.0 4096
layer1.0.conv1.weight, mask/weight parameters,732,732 density 0.24335106382978725,0.24335106382978725
before tensor 36864 mask 4148.0 36864
layer1.0.conv2.weight, mask/weight parameters,4148,4148 density 0.20864141642774509,0.20864141642774509
before tensor 16384 mask 4040.0 16384
layer1.0.conv3.weight, mask/weight parameters,4040,4040 density 0.3357712765957447,0.3357712765957447
layer1.0.shortcut.0.weight, mask/weight parameters,5782,5782 density 0.3529052734375,0.3529052734375
before tensor 16384 mask 2431.0 16384
layer1.1.conv1.weight, mask/weight parameters,2431,2431 density 0.2020445478723404,0.2020445478723404
before tensor 36864 mask 3967.0 36864
layer1.1.conv2.weight, mask/weight parameters,3967,3967 density 0.19953724661737338,0.19953724661737338
before tensor 16384 mask 2194.0 16384
layer1.1.conv3.weight, mask/weight parameters,2194,2194 density 0.1823470744680851,0.1823470744680851
before tensor 16384 mask 2696.0 16384
layer1.2.conv1.weight, mask/weight parameters,2696,2696 density 0.22406914893617022,0.22406914893617022
before tensor 36864 mask 2911.0 36864
layer1.2.conv2.weight, mask/weight parameters,2911,2911 density 0.14642120617675167,0.14642120617675167
before tensor 16384 mask 1824.0 16384
layer1.2.conv3.weight, mask/weight parameters,1824,1824 density 0.15159574468085107,0.15159574468085107
before tensor 32768 mask 5536.0 32768
layer2.0.conv1.weight, mask/weight parameters,5536,5536 density 0.2605421686746988,0.2605421686746988
before tensor 147456 mask 13925.0 147456
layer2.0.conv2.weight, mask/weight parameters,13925,13925 density 0.2245931517233593,0.2245931517233593
before tensor 65536 mask 7640.0 65536
layer2.0.conv3.weight, mask/weight parameters,7640,7640 density 0.17978162650602408,0.17978162650602408
layer2.0.shortcut.0.weight, mask/weight parameters,30699,30699 density 0.23421478271484375,0.23421478271484375
before tensor 65536 mask 4051.0 65536
layer2.1.conv1.weight, mask/weight parameters,4051,4051 density 0.09532661897590361,0.09532661897590361
before tensor 147456 mask 4670.0 147456
layer2.1.conv2.weight, mask/weight parameters,4670,4670 density 0.07532136578442283,0.07532136578442283
before tensor 65536 mask 3516.0 65536
layer2.1.conv3.weight, mask/weight parameters,3516,3516 density 0.08273719879518072,0.08273719879518072
before tensor 65536 mask 10926.0 65536
layer2.2.conv1.weight, mask/weight parameters,10926,10926 density 0.2571065512048193,0.2571065512048193
before tensor 147456 mask 22553.0 147456
layer2.2.conv2.weight, mask/weight parameters,22553,22553 density 0.3637521975452009,0.3637521975452009
before tensor 65536 mask 13000.0 65536
layer2.2.conv3.weight, mask/weight parameters,13000,13000 density 0.30591114457831325,0.30591114457831325
before tensor 65536 mask 11202.0 65536
layer2.3.conv1.weight, mask/weight parameters,11202,11202 density 0.26360128012048195,0.26360128012048195
before tensor 147456 mask 21875.0 147456
layer2.3.conv2.weight, mask/weight parameters,21875,21875 density 0.3528168900501605,0.3528168900501605
before tensor 65536 mask 11040.0 65536
layer2.3.conv3.weight, mask/weight parameters,11040,11040 density 0.25978915662650603,0.25978915662650603
before tensor 131072 mask 31337.0 131072
layer3.0.conv1.weight, mask/weight parameters,31337,31337 density 0.4026649876644737,0.4026649876644737
before tensor 589824 mask 80115.0 589824
layer3.0.conv2.weight, mask/weight parameters,80115,80115 density 0.3852868190212373,0.3852868190212373
before tensor 262144 mask 61713.0 262144
layer3.0.conv3.weight, mask/weight parameters,61713,61713 density 0.3964907997532895,0.3964907997532895
layer3.0.shortcut.0.weight, mask/weight parameters,98001,98001 density 0.1869220733642578,0.1869220733642578
before tensor 262144 mask 28512.0 262144
layer3.1.conv1.weight, mask/weight parameters,28512,28512 density 0.18318256578947367,0.18318256578947367
before tensor 589824 mask 61682.0 589824
layer3.1.conv2.weight, mask/weight parameters,61682,61682 density 0.296639350569406,0.296639350569406
before tensor 262144 mask 44900.0 262144
layer3.1.conv3.weight, mask/weight parameters,44900,44900 density 0.2884714226973684,0.2884714226973684
before tensor 262144 mask 29942.0 262144
layer3.2.conv1.weight, mask/weight parameters,29942,29942 density 0.19236996299342105,0.19236996299342105
before tensor 589824 mask 59023.0 589824
layer3.2.conv2.weight, mask/weight parameters,59023,59023 density 0.2838517620806402,0.2838517620806402
before tensor 262144 mask 47029.0 262144
layer3.2.conv3.weight, mask/weight parameters,47029,47029 density 0.3021497224506579,0.3021497224506579
before tensor 262144 mask 30499.0 262144
layer3.3.conv1.weight, mask/weight parameters,30499,30499 density 0.19594855057565788,0.19594855057565788
before tensor 589824 mask 47077.0 589824
layer3.3.conv2.weight, mask/weight parameters,47077,47077 density 0.22640139273622653,0.22640139273622653
before tensor 262144 mask 39100.0 262144
layer3.3.conv3.weight, mask/weight parameters,39100,39100 density 0.2512078536184211,0.2512078536184211
before tensor 262144 mask 33093.0 262144
layer3.4.conv1.weight, mask/weight parameters,33093,33093 density 0.21261436060855263,0.21261436060855263
before tensor 589824 mask 46333.0 589824
layer3.4.conv2.weight, mask/weight parameters,46333,46333 density 0.22282336872883965,0.22282336872883965
before tensor 262144 mask 35122.0 262144
layer3.4.conv3.weight, mask/weight parameters,35122,35122 density 0.22565018503289475,0.22565018503289475
before tensor 262144 mask 37671.0 262144
layer3.5.conv1.weight, mask/weight parameters,37671,37671 density 0.24202688116776316,0.24202688116776316
before tensor 589824 mask 48176.0 589824
layer3.5.conv2.weight, mask/weight parameters,48176,48176 density 0.2316866728224069,0.2316866728224069
before tensor 262144 mask 34224.0 262144
layer3.5.conv3.weight, mask/weight parameters,34224,34224 density 0.21988075657894737,0.21988075657894737
before tensor 524288 mask 128902.0 524288
layer4.0.conv1.weight, mask/weight parameters,128902,128902 density 0.4310988334760274,0.4310988334760274
before tensor 2359296 mask 232759.0 2359296
layer4.0.conv2.weight, mask/weight parameters,232759,232759 density 0.30331806050749566,0.30331806050749566
before tensor 1048576 mask 115441.0 1048576
layer4.0.conv3.weight, mask/weight parameters,115441,115441 density 0.19303998555222604,0.19303998555222604
layer4.0.shortcut.0.weight, mask/weight parameters,159005,159005 density 0.07581949234008789,0.07581949234008789
before tensor 1048576 mask 109110.0 1048576
layer4.1.conv1.weight, mask/weight parameters,109110,109110 density 0.1824533122859589,0.1824533122859589
before tensor 2359296 mask 202192.0 2359296
layer4.1.conv2.weight, mask/weight parameters,202192,202192 density 0.26348491482662995,0.26348491482662995
before tensor 1048576 mask 93616.0 1048576
layer4.1.conv3.weight, mask/weight parameters,93616,93616 density 0.1565443065068493,0.1565443065068493
before tensor 1048576 mask 51261.0 1048576
layer4.2.conv1.weight, mask/weight parameters,51261,51261 density 0.08571844231592465,0.08571844231592465
before tensor 2359296 mask 51411.0 2359296
layer4.2.conv2.weight, mask/weight parameters,51411,51411 density 0.06699584037030087,0.06699584037030087
before tensor 1048576 mask 31839.0 1048576
layer4.2.conv3.weight, mask/weight parameters,31839,31839 density 0.053241050406678085,0.053241050406678085
classifier.weight, mask/weight parameters,103571,103571 density 0.5057177734375,0.5057177734375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.19239095855509586 0.19239095855509586 after dst
Death rate: 0.1303946049191954

dynamic sparse change grow
self.total_params*pruning_rate 3084097.3681761674
self.total_nonzero 2365205.0
to grow 718892.3681761674
len(all_scores) 12293743 9155679
increse 718892.0 before_mask 3084096.0 after_mask 3084096.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1268,1191 density 0.7337962962962963,0.6892361111111112
before tensor 4096 mask 830.0 4096
layer1.0.conv1.weight, mask/weight parameters,830,732 density 0.2759308510638298,0.24335106382978725
before tensor 36864 mask 4767.0 36864
layer1.0.conv2.weight, mask/weight parameters,4767,4148 density 0.23977667119360194,0.20864141642774509
before tensor 16384 mask 5048.0 16384
layer1.0.conv3.weight, mask/weight parameters,5048,4040 density 0.4195478723404255,0.3357712765957447
layer1.0.shortcut.0.weight, mask/weight parameters,6657,5782 density 0.40631103515625,0.3529052734375
before tensor 16384 mask 3039.0 16384
layer1.1.conv1.weight, mask/weight parameters,3039,2431 density 0.25257646276595747,0.2020445478723404
before tensor 36864 mask 4515.0 36864
layer1.1.conv2.weight, mask/weight parameters,4515,3967 density 0.22710125245208992,0.19953724661737338
before tensor 16384 mask 2976.0 16384
layer1.1.conv3.weight, mask/weight parameters,2976,2194 density 0.2473404255319149,0.1823470744680851
before tensor 16384 mask 3278.0 16384
layer1.2.conv1.weight, mask/weight parameters,3278,2696 density 0.2724401595744681,0.22406914893617022
before tensor 36864 mask 3531.0 36864
layer1.2.conv2.weight, mask/weight parameters,3531,2911 density 0.1776067602233288,0.14642120617675167
before tensor 16384 mask 2244.0 16384
layer1.2.conv3.weight, mask/weight parameters,2244,1824 density 0.18650265957446807,0.15159574468085107
before tensor 32768 mask 7095.0 32768
layer2.0.conv1.weight, mask/weight parameters,7095,5536 density 0.33391378012048195,0.2605421686746988
before tensor 147456 mask 17151.0 147456
layer2.0.conv2.weight, mask/weight parameters,17151,13925 density 0.2766245705714424,0.2245931517233593
before tensor 65536 mask 9851.0 65536
layer2.0.conv3.weight, mask/weight parameters,9851,7640 density 0.23181005271084337,0.17978162650602408
layer2.0.shortcut.0.weight, mask/weight parameters,38592,30699 density 0.29443359375,0.23421478271484375
before tensor 65536 mask 5976.0 65536
layer2.1.conv1.weight, mask/weight parameters,5976,4051 density 0.140625,0.09532661897590361
before tensor 147456 mask 6014.0 147456
layer2.1.conv2.weight, mask/weight parameters,6014,4670 density 0.0969984355091047,0.07532136578442283
before tensor 65536 mask 4298.0 65536
layer2.1.conv3.weight, mask/weight parameters,4298,3516 density 0.10113893072289157,0.08273719879518072
before tensor 65536 mask 13199.0 65536
layer2.2.conv1.weight, mask/weight parameters,13199,10926 density 0.31059393825301207,0.2571065512048193
before tensor 147456 mask 27596.0 147456
layer2.2.conv2.weight, mask/weight parameters,27596,22553 density 0.4450895953291076,0.3637521975452009
before tensor 65536 mask 16929.0 65536
layer2.2.conv3.weight, mask/weight parameters,16929,13000 density 0.39836690512048195,0.30591114457831325
before tensor 65536 mask 14581.0 65536
layer2.3.conv1.weight, mask/weight parameters,14581,11202 density 0.34311464608433734,0.26360128012048195
before tensor 147456 mask 26702.0 147456
layer2.3.conv2.weight, mask/weight parameters,26702,21875 density 0.43067047305688616,0.3528168900501605
before tensor 65536 mask 13698.0 65536
layer2.3.conv3.weight, mask/weight parameters,13698,11040 density 0.32233621987951805,0.25978915662650603
before tensor 131072 mask 39763.0 131072
layer3.0.conv1.weight, mask/weight parameters,39763,31337 density 0.5109349300986842,0.4026649876644737
before tensor 589824 mask 104403.0 589824
layer3.0.conv2.weight, mask/weight parameters,104403,80115 density 0.5020919898430286,0.3852868190212373
before tensor 262144 mask 75688.0 262144
layer3.0.conv3.weight, mask/weight parameters,75688,61713 density 0.48627672697368424,0.3964907997532895
layer3.0.shortcut.0.weight, mask/weight parameters,132248,98001 density 0.2522430419921875,0.1869220733642578
before tensor 262144 mask 39501.0 262144
layer3.1.conv1.weight, mask/weight parameters,39501,28512 density 0.2537841796875,0.18318256578947367
before tensor 589824 mask 84126.0 589824
layer3.1.conv2.weight, mask/weight parameters,84126,61682 density 0.4045764081255771,0.296639350569406
before tensor 262144 mask 57541.0 262144
layer3.1.conv3.weight, mask/weight parameters,57541,44900 density 0.36968672902960525,0.2884714226973684
before tensor 262144 mask 40637.0 262144
layer3.2.conv1.weight, mask/weight parameters,40637,29942 density 0.2610826994243421,0.19236996299342105
before tensor 589824 mask 75293.0 589824
layer3.2.conv2.weight, mask/weight parameters,75293,59023 density 0.36209699138196366,0.2838517620806402
before tensor 262144 mask 59608.0 262144
layer3.2.conv3.weight, mask/weight parameters,59608,47029 density 0.38296669407894735,0.3021497224506579
before tensor 262144 mask 41226.0 262144
layer3.3.conv1.weight, mask/weight parameters,41226,30499 density 0.2648668791118421,0.19594855057565788
before tensor 589824 mask 62575.0 589824
layer3.3.conv2.weight, mask/weight parameters,62575,47077 density 0.3009339412126808,0.22640139273622653
before tensor 262144 mask 50809.0 262144
layer3.3.conv3.weight, mask/weight parameters,50809,39100 density 0.3264352898848684,0.2512078536184211
before tensor 262144 mask 44589.0 262144
layer3.4.conv1.weight, mask/weight parameters,44589,33093 density 0.2864733244243421,0.21261436060855263
before tensor 589824 mask 61910.0 589824
layer3.4.conv2.weight, mask/weight parameters,61910,46333 density 0.29773584179747614,0.22282336872883965
before tensor 262144 mask 46759.0 262144
layer3.4.conv3.weight, mask/weight parameters,46759,35122 density 0.3004150390625,0.22565018503289475
before tensor 262144 mask 50936.0 262144
layer3.5.conv1.weight, mask/weight parameters,50936,37671 density 0.3272512335526316,0.24202688116776316
before tensor 589824 mask 64618.0 589824
layer3.5.conv2.weight, mask/weight parameters,64618,48176 density 0.310759079716836,0.2316866728224069
before tensor 262144 mask 45401.0 262144
layer3.5.conv3.weight, mask/weight parameters,45401,34224 density 0.29169022409539475,0.21988075657894737
before tensor 524288 mask 159499.0 524288
layer4.0.conv1.weight, mask/weight parameters,159499,128902 density 0.5334271992722602,0.4310988334760274
before tensor 2359296 mask 301186.0 2359296
layer4.0.conv2.weight, mask/weight parameters,301186,232759 density 0.39248816746940224,0.30331806050749566
before tensor 1048576 mask 151973.0 1048576
layer4.0.conv3.weight, mask/weight parameters,151973,115441 density 0.2541286520761986,0.19303998555222604
layer4.0.shortcut.0.weight, mask/weight parameters,225654,159005 density 0.10760021209716797,0.07581949234008789
before tensor 1048576 mask 137178.0 1048576
layer4.1.conv1.weight, mask/weight parameters,137178,109110 density 0.2293885113441781,0.1824533122859589
before tensor 2359296 mask 254577.0 2359296
layer4.1.conv2.weight, mask/weight parameters,254577,202192 density 0.3317500156377056,0.26348491482662995
before tensor 1048576 mask 124464.0 1048576
layer4.1.conv3.weight, mask/weight parameters,124464,93616 density 0.20812821061643835,0.1565443065068493
before tensor 1048576 mask 72741.0 1048576
layer4.2.conv1.weight, mask/weight parameters,72741,51261 density 0.12163721372003425,0.08571844231592465
before tensor 2359296 mask 78029.0 2359296
layer4.2.conv2.weight, mask/weight parameters,78029,51411 density 0.10168287775484247,0.06699584037030087
before tensor 1048576 mask 46525.0 1048576
layer4.2.conv3.weight, mask/weight parameters,46525,31839 density 0.07779892176797945,0.053241050406678085
classifier.weight, mask/weight parameters,114804,103571 density 0.56056640625,0.5057177734375
Total Model parameters after dst: 3084096 2365205
Total parameters under density level of 0.1: 0.250867128099229 0.19239095855509586 after dst
Death rate: 0.1303946049191954


Training summary: Average loss: 1.2787, Accuracy: 31624/50000 (63.248%)


Evaluation: Average loss: 1.5486, Accuracy: 5744/10000 (57.440%)

Current learning rate: 0.1. Time taken for epoch: 88.77 seconds.

Train Epoch: 56 [0/50000 (0%)]	Loss: 1.077849 Accuracy: 68/100 (68.000%
Train Epoch: 56 [10000/50000 (20%)]	Loss: 1.289935 Accuracy: 6500/10100 (64.356%
Train Epoch: 56 [20000/50000 (40%)]	Loss: 1.527641 Accuracy: 12845/20100 (63.905%
Train Epoch: 56 [30000/50000 (60%)]	Loss: 1.085157 Accuracy: 19266/30100 (64.007%
Train Epoch: 56 [40000/50000 (80%)]	Loss: 1.422763 Accuracy: 25617/40100 (63.883%
current layer rate 0.41146631770596265
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4522.0
Total filter_masks items: 9318319.0
4522.0 / 7552 channels
Total channels to prune: 77.39363131542996
Layer ('layer2', 0, 'conv1'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/83.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/83.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/152.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/152.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 4/292.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 4/292.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 4/292.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 4/292.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 4/292.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 4/292.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4466.0
Total filter_masks items: 9144675.0
After apply_mask:
Total filter_names items: 4466.0
Total filter_masks items: 9144675.0
Total pruned: 56/77.39363131542996 channels
===========done ===============

Training summary: Average loss: 1.2684, Accuracy: 31829/50000 (63.658%)


Evaluation: Average loss: 1.6154, Accuracy: 5676/10000 (56.760%)

Current learning rate: 0.1. Time taken for epoch: 88.55 seconds.

Train Epoch: 57 [0/50000 (0%)]	Loss: 1.071528 Accuracy: 67/100 (67.000%
Train Epoch: 57 [10000/50000 (20%)]	Loss: 1.269506 Accuracy: 6538/10100 (64.733%
Train Epoch: 57 [20000/50000 (40%)]	Loss: 1.261115 Accuracy: 12829/20100 (63.826%
Train Epoch: 57 [30000/50000 (60%)]	Loss: 1.446501 Accuracy: 19082/30100 (63.395%
Train Epoch: 57 [40000/50000 (80%)]	Loss: 1.048944 Accuracy: 25387/40100 (63.309%
current mest  death_rate 0.1292089260336761


dynamic sparse change prune
to kill 655023.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1186,1186 density 0.6863425925925926,0.6863425925925926
before tensor 4096 mask 712.0 4096
layer1.0.conv1.weight, mask/weight parameters,712,712 density 0.23670212765957446,0.23670212765957446
before tensor 36864 mask 4068.0 36864
layer1.0.conv2.weight, mask/weight parameters,4068,4068 density 0.20461747397012223,0.20461747397012223
before tensor 16384 mask 4186.0 16384
layer1.0.conv3.weight, mask/weight parameters,4186,4186 density 0.347905585106383,0.347905585106383
layer1.0.shortcut.0.weight, mask/weight parameters,5635,5635 density 0.34393310546875,0.34393310546875
before tensor 16384 mask 2344.0 16384
layer1.1.conv1.weight, mask/weight parameters,2344,2344 density 0.19481382978723405,0.19481382978723405
before tensor 36864 mask 3924.0 36864
layer1.1.conv2.weight, mask/weight parameters,3924,3924 density 0.19737437754640108,0.19737437754640108
before tensor 16384 mask 2300.0 16384
layer1.1.conv3.weight, mask/weight parameters,2300,2300 density 0.19115691489361702,0.19115691489361702
before tensor 16384 mask 2653.0 16384
layer1.2.conv1.weight, mask/weight parameters,2653,2653 density 0.22049534574468085,0.22049534574468085
before tensor 36864 mask 2956.0 36864
layer1.2.conv2.weight, mask/weight parameters,2956,2956 density 0.14868467380916453,0.14868467380916453
before tensor 16384 mask 1775.0 16384
layer1.2.conv3.weight, mask/weight parameters,1775,1775 density 0.14752327127659576,0.14752327127659576
before tensor 32768 mask 5344.0 32768
layer2.0.conv1.weight, mask/weight parameters,5344,5344 density 0.2545731707317073,0.2545731707317073
before tensor 147456 mask 14023.0 147456
layer2.0.conv2.weight, mask/weight parameters,14023,14023 density 0.2317238416286602,0.2317238416286602
before tensor 65536 mask 7906.0 65536
layer2.0.conv3.weight, mask/weight parameters,7906,7906 density 0.18830983231707318,0.18830983231707318
layer2.0.shortcut.0.weight, mask/weight parameters,30220,30220 density 0.230560302734375,0.230560302734375
before tensor 65536 mask 4245.0 65536
layer2.1.conv1.weight, mask/weight parameters,4245,4245 density 0.10110994664634146,0.10110994664634146
before tensor 147456 mask 4715.0 147456
layer2.1.conv2.weight, mask/weight parameters,4715,4715 density 0.07791327913279132,0.07791327913279132
before tensor 65536 mask 3349.0 65536
layer2.1.conv3.weight, mask/weight parameters,3349,3349 density 0.07976848323170732,0.07976848323170732
before tensor 65536 mask 10597.0 65536
layer2.2.conv1.weight, mask/weight parameters,10597,10597 density 0.2524056783536585,0.2524056783536585
before tensor 147456 mask 21731.0 147456
layer2.2.conv2.weight, mask/weight parameters,21731,21731 density 0.3590951153413973,0.3590951153413973
before tensor 65536 mask 13215.0 65536
layer2.2.conv3.weight, mask/weight parameters,13215,13215 density 0.3147627667682927,0.3147627667682927
before tensor 65536 mask 11410.0 65536
layer2.3.conv1.weight, mask/weight parameters,11410,11410 density 0.2717701981707317,0.2717701981707317
before tensor 147456 mask 21729.0 147456
layer2.3.conv2.weight, mask/weight parameters,21729,21729 density 0.3590620662304184,0.3590620662304184
before tensor 65536 mask 10953.0 65536
layer2.3.conv3.weight, mask/weight parameters,10953,10953 density 0.26088509908536583,0.26088509908536583
before tensor 131072 mask 31798.0 131072
layer3.0.conv1.weight, mask/weight parameters,31798,31798 density 0.41403645833333336,0.41403645833333336
before tensor 589824 mask 82288.0 589824
layer3.0.conv2.weight, mask/weight parameters,82288,82288 density 0.4063604938271605,0.4063604938271605
before tensor 262144 mask 61577.0 262144
layer3.0.conv3.weight, mask/weight parameters,61577,61577 density 0.4008919270833333,0.4008919270833333
layer3.0.shortcut.0.weight, mask/weight parameters,100717,100717 density 0.19210243225097656,0.19210243225097656
before tensor 262144 mask 29550.0 262144
layer3.1.conv1.weight, mask/weight parameters,29550,29550 density 0.1923828125,0.1923828125
before tensor 589824 mask 63798.0 589824
layer3.1.conv2.weight, mask/weight parameters,63798,63798 density 0.31505185185185186,0.31505185185185186
before tensor 262144 mask 45211.0 262144
layer3.1.conv3.weight, mask/weight parameters,45211,45211 density 0.2943424479166667,0.2943424479166667
before tensor 262144 mask 30447.0 262144
layer3.2.conv1.weight, mask/weight parameters,30447,30447 density 0.19822265625,0.19822265625
before tensor 589824 mask 57425.0 589824
layer3.2.conv2.weight, mask/weight parameters,57425,57425 density 0.28358024691358025,0.28358024691358025
before tensor 262144 mask 46899.0 262144
layer3.2.conv3.weight, mask/weight parameters,46899,46899 density 0.30533203125,0.30533203125
before tensor 262144 mask 30819.0 262144
layer3.3.conv1.weight, mask/weight parameters,30819,30819 density 0.20064453125,0.20064453125
before tensor 589824 mask 47168.0 589824
layer3.3.conv2.weight, mask/weight parameters,47168,47168 density 0.23292839506172838,0.23292839506172838
before tensor 262144 mask 39378.0 262144
layer3.3.conv3.weight, mask/weight parameters,39378,39378 density 0.2563671875,0.2563671875
before tensor 262144 mask 33775.0 262144
layer3.4.conv1.weight, mask/weight parameters,33775,33775 density 0.21988932291666666,0.21988932291666666
before tensor 589824 mask 47215.0 589824
layer3.4.conv2.weight, mask/weight parameters,47215,47215 density 0.2331604938271605,0.2331604938271605
before tensor 262144 mask 35397.0 262144
layer3.4.conv3.weight, mask/weight parameters,35397,35397 density 0.23044921875,0.23044921875
before tensor 262144 mask 39386.0 262144
layer3.5.conv1.weight, mask/weight parameters,39386,39386 density 0.2564192708333333,0.2564192708333333
before tensor 589824 mask 49702.0 589824
layer3.5.conv2.weight, mask/weight parameters,49702,49702 density 0.24544197530864198,0.24544197530864198
before tensor 262144 mask 35003.0 262144
layer3.5.conv3.weight, mask/weight parameters,35003,35003 density 0.22788411458333332,0.22788411458333332
before tensor 524288 mask 130982.0 524288
layer4.0.conv1.weight, mask/weight parameters,130982,130982 density 0.4441392686631944,0.4441392686631944
before tensor 2359296 mask 231781.0 2359296
layer4.0.conv2.weight, mask/weight parameters,231781,231781 density 0.3104919517318244,0.3104919517318244
before tensor 1048576 mask 113109.0 1048576
layer4.0.conv3.weight, mask/weight parameters,113109,113109 density 0.19176737467447916,0.19176737467447916
layer4.0.shortcut.0.weight, mask/weight parameters,157507,157507 density 0.07510519027709961,0.07510519027709961
before tensor 1048576 mask 106628.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106628,106628 density 0.1807793511284722,0.1807793511284722
before tensor 2359296 mask 197544.0 2359296
layer4.1.conv2.weight, mask/weight parameters,197544,197544 density 0.2646283436213992,0.2646283436213992
before tensor 1048576 mask 90841.0 1048576
layer4.1.conv3.weight, mask/weight parameters,90841,90841 density 0.1540137396918403,0.1540137396918403
before tensor 1048576 mask 50709.0 1048576
layer4.2.conv1.weight, mask/weight parameters,50709,50709 density 0.08597310384114583,0.08597310384114583
before tensor 2359296 mask 51792.0 2359296
layer4.2.conv2.weight, mask/weight parameters,51792,51792 density 0.06938014403292181,0.06938014403292181
before tensor 1048576 mask 31539.0 1048576
layer4.2.conv3.weight, mask/weight parameters,31539,31539 density 0.053471883138020836,0.053471883138020836
classifier.weight, mask/weight parameters,104044,104044 density 0.50802734375,0.50802734375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.19514733336749146 0.19514733336749146 after dst
Death rate: 0.1292089260336761

dynamic sparse change grow
self.total_params*pruning_rate 3056053.65323414
self.total_nonzero 2365205.0
to grow 690848.65323414
len(all_scores) 12120099 8945730
increse 690848.0 before_mask 3056052.0 after_mask 3056052.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1304,1186 density 0.7546296296296297,0.6863425925925926
before tensor 4096 mask 831.0 4096
layer1.0.conv1.weight, mask/weight parameters,831,712 density 0.27626329787234044,0.23670212765957446
before tensor 36864 mask 4786.0 36864
layer1.0.conv2.weight, mask/weight parameters,4786,4068 density 0.24073235752728736,0.20461747397012223
before tensor 16384 mask 4820.0 16384
layer1.0.conv3.weight, mask/weight parameters,4820,4186 density 0.4005984042553192,0.347905585106383
layer1.0.shortcut.0.weight, mask/weight parameters,6700,5635 density 0.408935546875,0.34393310546875
before tensor 16384 mask 3059.0 16384
layer1.1.conv1.weight, mask/weight parameters,3059,2344 density 0.25423869680851063,0.19481382978723405
before tensor 36864 mask 4667.0 36864
layer1.1.conv2.weight, mask/weight parameters,4667,3924 density 0.23474674312157337,0.19737437754640108
before tensor 16384 mask 3052.0 16384
layer1.1.conv3.weight, mask/weight parameters,3052,2300 density 0.253656914893617,0.19115691489361702
before tensor 16384 mask 3322.0 16384
layer1.2.conv1.weight, mask/weight parameters,3322,2653 density 0.2760970744680851,0.22049534574468085
before tensor 36864 mask 3692.0 36864
layer1.2.conv2.weight, mask/weight parameters,3692,2956 density 0.1857049444192948,0.14868467380916453
before tensor 16384 mask 2207.0 16384
layer1.2.conv3.weight, mask/weight parameters,2207,1775 density 0.18342752659574468,0.14752327127659576
before tensor 32768 mask 7244.0 32768
layer2.0.conv1.weight, mask/weight parameters,7244,5344 density 0.34508384146341464,0.2545731707317073
before tensor 147456 mask 16230.0 147456
layer2.0.conv2.weight, mask/weight parameters,16230,14023 density 0.26819353559389253,0.2317238416286602
before tensor 65536 mask 9554.0 65536
layer2.0.conv3.weight, mask/weight parameters,9554,7906 density 0.22756288109756098,0.18830983231707318
layer2.0.shortcut.0.weight, mask/weight parameters,41280,30220 density 0.31494140625,0.230560302734375
before tensor 65536 mask 5345.0 65536
layer2.1.conv1.weight, mask/weight parameters,5345,4245 density 0.12731040396341464,0.10110994664634146
before tensor 147456 mask 5969.0 147456
layer2.1.conv2.weight, mask/weight parameters,5969,4715 density 0.09863507171657082,0.07791327913279132
before tensor 65536 mask 5293.0 65536
layer2.1.conv3.weight, mask/weight parameters,5293,3349 density 0.1260718368902439,0.07976848323170732
before tensor 65536 mask 13002.0 65536
layer2.2.conv1.weight, mask/weight parameters,13002,10597 density 0.3096894054878049,0.2524056783536585
before tensor 147456 mask 27058.0 147456
layer2.2.conv2.weight, mask/weight parameters,27058,21731 density 0.44712142243373654,0.3590951153413973
before tensor 65536 mask 16476.0 65536
layer2.2.conv3.weight, mask/weight parameters,16476,13215 density 0.39243521341463417,0.3147627667682927
before tensor 65536 mask 14135.0 65536
layer2.3.conv1.weight, mask/weight parameters,14135,11410 density 0.33667587652439024,0.2717701981707317
before tensor 147456 mask 26160.0 147456
layer2.3.conv2.weight, mask/weight parameters,26160,21729 density 0.43228237160420385,0.3590620662304184
before tensor 65536 mask 14087.0 65536
layer2.3.conv3.weight, mask/weight parameters,14087,10953 density 0.3355325838414634,0.26088509908536583
before tensor 131072 mask 40079.0 131072
layer3.0.conv1.weight, mask/weight parameters,40079,31798 density 0.5218619791666667,0.41403645833333336
before tensor 589824 mask 101227.0 589824
layer3.0.conv2.weight, mask/weight parameters,101227,82288 density 0.4998864197530864,0.4063604938271605
before tensor 262144 mask 74343.0 262144
layer3.0.conv3.weight, mask/weight parameters,74343,61577 density 0.48400390625,0.4008919270833333
layer3.0.shortcut.0.weight, mask/weight parameters,131544,100717 density 0.2509002685546875,0.19210243225097656
before tensor 262144 mask 36464.0 262144
layer3.1.conv1.weight, mask/weight parameters,36464,29550 density 0.23739583333333333,0.1923828125
before tensor 589824 mask 82481.0 589824
layer3.1.conv2.weight, mask/weight parameters,82481,63798 density 0.40731358024691355,0.31505185185185186
before tensor 262144 mask 56791.0 262144
layer3.1.conv3.weight, mask/weight parameters,56791,45211 density 0.3697330729166667,0.2943424479166667
before tensor 262144 mask 38282.0 262144
layer3.2.conv1.weight, mask/weight parameters,38282,30447 density 0.24923177083333334,0.19822265625
before tensor 589824 mask 72129.0 589824
layer3.2.conv2.weight, mask/weight parameters,72129,57425 density 0.3561925925925926,0.28358024691358025
before tensor 262144 mask 57939.0 262144
layer3.2.conv3.weight, mask/weight parameters,57939,46899 density 0.37720703125,0.30533203125
before tensor 262144 mask 40063.0 262144
layer3.3.conv1.weight, mask/weight parameters,40063,30819 density 0.26082682291666665,0.20064453125
before tensor 589824 mask 62251.0 589824
layer3.3.conv2.weight, mask/weight parameters,62251,47168 density 0.3074123456790123,0.23292839506172838
before tensor 262144 mask 50342.0 262144
layer3.3.conv3.weight, mask/weight parameters,50342,39378 density 0.32774739583333334,0.2563671875
before tensor 262144 mask 42476.0 262144
layer3.4.conv1.weight, mask/weight parameters,42476,33775 density 0.27653645833333335,0.21988932291666666
before tensor 589824 mask 59858.0 589824
layer3.4.conv2.weight, mask/weight parameters,59858,47215 density 0.29559506172839506,0.2331604938271605
before tensor 262144 mask 44683.0 262144
layer3.4.conv3.weight, mask/weight parameters,44683,35397 density 0.29090494791666666,0.23044921875
before tensor 262144 mask 50888.0 262144
layer3.5.conv1.weight, mask/weight parameters,50888,39386 density 0.33130208333333333,0.2564192708333333
before tensor 589824 mask 63255.0 589824
layer3.5.conv2.weight, mask/weight parameters,63255,49702 density 0.31237037037037035,0.24544197530864198
before tensor 262144 mask 44911.0 262144
layer3.5.conv3.weight, mask/weight parameters,44911,35003 density 0.2923893229166667,0.22788411458333332
before tensor 524288 mask 158327.0 524288
layer4.0.conv1.weight, mask/weight parameters,158327,130982 density 0.5368618435329862,0.4441392686631944
before tensor 2359296 mask 296591.0 2359296
layer4.0.conv2.weight, mask/weight parameters,296591,231781 density 0.3973109032064472,0.3104919517318244
before tensor 1048576 mask 152431.0 1048576
layer4.0.conv3.weight, mask/weight parameters,152431,113109 density 0.2584347195095486,0.19176737467447916
layer4.0.shortcut.0.weight, mask/weight parameters,227409,157507 density 0.10843706130981445,0.07510519027709961
before tensor 1048576 mask 136345.0 1048576
layer4.1.conv1.weight, mask/weight parameters,136345,106628 density 0.2311621771918403,0.1807793511284722
before tensor 2359296 mask 251004.0 2359296
layer4.1.conv2.weight, mask/weight parameters,251004,197544 density 0.3362429269547325,0.2646283436213992
before tensor 1048576 mask 125714.0 1048576
layer4.1.conv3.weight, mask/weight parameters,125714,90841 density 0.2131381564670139,0.1540137396918403
before tensor 1048576 mask 73693.0 1048576
layer4.2.conv1.weight, mask/weight parameters,73693,50709 density 0.12494066026475695,0.08597310384114583
before tensor 2359296 mask 80189.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80189,51792 density 0.10742053540809328,0.06938014403292181
before tensor 1048576 mask 48445.0 1048576
layer4.2.conv3.weight, mask/weight parameters,48445,31539 density 0.0821346706814236,0.053471883138020836
classifier.weight, mask/weight parameters,115625,104044 density 0.5645751953125,0.50802734375
Total Model parameters after dst: 3056052 2365205
Total parameters under density level of 0.1: 0.2521474453302733 0.19514733336749146 after dst
Death rate: 0.1292089260336761


Training summary: Average loss: 1.2802, Accuracy: 31578/50000 (63.156%)


Evaluation: Average loss: 1.7255, Accuracy: 5434/10000 (54.340%)

Current learning rate: 0.1. Time taken for epoch: 88.75 seconds.

Train Epoch: 58 [0/50000 (0%)]	Loss: 1.293846 Accuracy: 66/100 (66.000%
Train Epoch: 58 [10000/50000 (20%)]	Loss: 1.094158 Accuracy: 6525/10100 (64.604%
Train Epoch: 58 [20000/50000 (40%)]	Loss: 1.219065 Accuracy: 12815/20100 (63.756%
Train Epoch: 58 [30000/50000 (60%)]	Loss: 1.320147 Accuracy: 19259/30100 (63.983%
Train Epoch: 58 [40000/50000 (80%)]	Loss: 1.426521 Accuracy: 25592/40100 (63.820%
current layer rate 0.41854551661356393
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4466.0
Total filter_masks items: 9144675.0
4466.0 / 7552 channels
Total channels to prune: 74.85574146563431
Layer ('layer2', 0, 'conv1'): Pruned 1/82.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/82.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/82.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/82.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/82.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/82.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/82.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/82.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/150.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/150.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/150.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/150.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/150.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/150.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/150.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/150.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/150.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/150.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/150.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/150.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 4/288.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 4/288.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 4/288.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 4/288.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 4/288.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 4/288.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4410.0
Total filter_masks items: 8972399.0
After apply_mask:
Total filter_names items: 4410.0
Total filter_masks items: 8972399.0
Total pruned: 56/74.85574146563431 channels
===========done ===============

Training summary: Average loss: 1.2648, Accuracy: 31804/50000 (63.608%)


Evaluation: Average loss: 1.5764, Accuracy: 5692/10000 (56.920%)

Current learning rate: 0.1. Time taken for epoch: 88.58 seconds.

Train Epoch: 59 [0/50000 (0%)]	Loss: 1.209761 Accuracy: 65/100 (65.000%
Train Epoch: 59 [10000/50000 (20%)]	Loss: 1.565922 Accuracy: 6485/10100 (64.208%
Train Epoch: 59 [20000/50000 (40%)]	Loss: 1.494653 Accuracy: 12816/20100 (63.761%
Train Epoch: 59 [30000/50000 (60%)]	Loss: 1.472480 Accuracy: 19121/30100 (63.525%
Train Epoch: 59 [40000/50000 (80%)]	Loss: 1.458484 Accuracy: 25447/40100 (63.459%
current mest  death_rate 0.12801341700638347


dynamic sparse change prune
to kill 631317.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1196,1196 density 0.6921296296296297,0.6921296296296297
before tensor 4096 mask 728.0 4096
layer1.0.conv1.weight, mask/weight parameters,728,728 density 0.24202127659574468,0.24202127659574468
before tensor 36864 mask 4063.0 36864
layer1.0.conv2.weight, mask/weight parameters,4063,4063 density 0.2043659775665208,0.2043659775665208
before tensor 16384 mask 4000.0 16384
layer1.0.conv3.weight, mask/weight parameters,4000,4000 density 0.3324468085106383,0.3324468085106383
layer1.0.shortcut.0.weight, mask/weight parameters,5673,5673 density 0.34625244140625,0.34625244140625
before tensor 16384 mask 2398.0 16384
layer1.1.conv1.weight, mask/weight parameters,2398,2398 density 0.19930186170212766,0.19930186170212766
before tensor 36864 mask 4009.0 36864
layer1.1.conv2.weight, mask/weight parameters,4009,4009 density 0.20164981640762536,0.20164981640762536
before tensor 16384 mask 2309.0 16384
layer1.1.conv3.weight, mask/weight parameters,2309,2309 density 0.19190492021276595,0.19190492021276595
before tensor 16384 mask 2615.0 16384
layer1.2.conv1.weight, mask/weight parameters,2615,2615 density 0.21733710106382978,0.21733710106382978
before tensor 36864 mask 3111.0 36864
layer1.2.conv2.weight, mask/weight parameters,3111,3111 density 0.1564810623208088,0.1564810623208088
before tensor 16384 mask 1807.0 16384
layer1.2.conv3.weight, mask/weight parameters,1807,1807 density 0.15018284574468085,0.15018284574468085
before tensor 32768 mask 5444.0 32768
layer2.0.conv1.weight, mask/weight parameters,5444,5444 density 0.26253858024691357,0.26253858024691357
before tensor 147456 mask 13501.0 147456
layer2.0.conv2.weight, mask/weight parameters,13501,13501 density 0.2286406205016173,0.2286406205016173
before tensor 65536 mask 7767.0 65536
layer2.0.conv3.weight, mask/weight parameters,7767,7767 density 0.1872829861111111,0.1872829861111111
layer2.0.shortcut.0.weight, mask/weight parameters,31194,31194 density 0.2379913330078125,0.2379913330078125
before tensor 65536 mask 3871.0 65536
layer2.1.conv1.weight, mask/weight parameters,3871,3871 density 0.09334008487654322,0.09334008487654322
before tensor 147456 mask 4464.0 147456
layer2.1.conv2.weight, mask/weight parameters,4464,4464 density 0.0755982319768328,0.0755982319768328
before tensor 65536 mask 3615.0 65536
layer2.1.conv3.weight, mask/weight parameters,3615,3615 density 0.08716724537037036,0.08716724537037036
before tensor 65536 mask 10521.0 65536
layer2.2.conv1.weight, mask/weight parameters,10521,10521 density 0.2536892361111111,0.2536892361111111
before tensor 147456 mask 21744.0 147456
layer2.2.conv2.weight, mask/weight parameters,21744,21744 density 0.3682365493065082,0.3682365493065082
before tensor 65536 mask 13067.0 65536
layer2.2.conv3.weight, mask/weight parameters,13067,13067 density 0.3150800540123457,0.3150800540123457
before tensor 65536 mask 11167.0 65536
layer2.3.conv1.weight, mask/weight parameters,11167,11167 density 0.26926601080246915,0.26926601080246915
before tensor 147456 mask 21491.0 147456
layer2.3.conv2.weight, mask/weight parameters,21491,21491 density 0.3639519720909753,0.3639519720909753
before tensor 65536 mask 11203.0 65536
layer2.3.conv3.weight, mask/weight parameters,11203,11203 density 0.27013406635802467,0.27013406635802467
before tensor 131072 mask 31865.0 131072
layer3.0.conv1.weight, mask/weight parameters,31865,31865 density 0.42051573057432434,0.42051573057432434
before tensor 589824 mask 80300.0 589824
layer3.0.conv2.weight, mask/weight parameters,80300,80300 density 0.40733300868436,0.40733300868436
before tensor 262144 mask 61052.0 262144
layer3.0.conv3.weight, mask/weight parameters,61052,61052 density 0.4028452280405405,0.4028452280405405
layer3.0.shortcut.0.weight, mask/weight parameters,101333,101333 density 0.19327735900878906,0.19327735900878906
before tensor 262144 mask 28564.0 262144
layer3.1.conv1.weight, mask/weight parameters,28564,28564 density 0.1884765625,0.1884765625
before tensor 589824 mask 63299.0 589824
layer3.1.conv2.weight, mask/weight parameters,63299,63299 density 0.32109305251197146,0.32109305251197146
before tensor 262144 mask 44966.0 262144
layer3.1.conv3.weight, mask/weight parameters,44966,44966 density 0.29670344172297297,0.29670344172297297
before tensor 262144 mask 29613.0 262144
layer3.2.conv1.weight, mask/weight parameters,29613,29613 density 0.19539827913851351,0.19539827913851351
before tensor 589824 mask 56581.0 589824
layer3.2.conv2.weight, mask/weight parameters,56581,56581 density 0.28701505559613666,0.28701505559613666
before tensor 262144 mask 46331.0 262144
layer3.2.conv3.weight, mask/weight parameters,46331,46331 density 0.3057102512668919,0.3057102512668919
before tensor 262144 mask 30498.0 262144
layer3.3.conv1.weight, mask/weight parameters,30498,30498 density 0.20123785895270271,0.20123785895270271
before tensor 589824 mask 47084.0 589824
layer3.3.conv2.weight, mask/weight parameters,47084,47084 density 0.23884019154289424,0.23884019154289424
before tensor 262144 mask 39101.0 262144
layer3.3.conv3.weight, mask/weight parameters,39101,39101 density 0.25800385346283783,0.25800385346283783
before tensor 262144 mask 32864.0 262144
layer3.4.conv1.weight, mask/weight parameters,32864,32864 density 0.21684966216216217,0.21684966216216217
before tensor 589824 mask 46220.0 589824
layer3.4.conv2.weight, mask/weight parameters,46220,46220 density 0.23445743040337635,0.23445743040337635
before tensor 262144 mask 34916.0 262144
layer3.4.conv3.weight, mask/weight parameters,34916,34916 density 0.23038956925675674,0.23038956925675674
before tensor 262144 mask 39574.0 262144
layer3.5.conv1.weight, mask/weight parameters,39574,39574 density 0.26112489442567566,0.26112489442567566
before tensor 589824 mask 49169.0 589824
layer3.5.conv2.weight, mask/weight parameters,49169,49169 density 0.24941664637610583,0.24941664637610583
before tensor 262144 mask 34701.0 262144
layer3.5.conv3.weight, mask/weight parameters,34701,34701 density 0.22897091427364866,0.22897091427364866
before tensor 524288 mask 130913.0 524288
layer4.0.conv1.weight, mask/weight parameters,130913,130913 density 0.45015748789612675,0.45015748789612675
before tensor 2359296 mask 231665.0 2359296
layer4.0.conv2.weight, mask/weight parameters,231665,231665 density 0.3191399964733629,0.3191399964733629
before tensor 1048576 mask 114315.0 1048576
layer4.0.conv3.weight, mask/weight parameters,114315,114315 density 0.19654179962588028,0.19654179962588028
layer4.0.shortcut.0.weight, mask/weight parameters,159235,159235 density 0.07592916488647461,0.07592916488647461
before tensor 1048576 mask 106581.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106581,106581 density 0.18324473206426056,0.18324473206426056
before tensor 2359296 mask 196884.0 2359296
layer4.1.conv2.weight, mask/weight parameters,196884,196884 density 0.27122594723269194,0.27122594723269194
before tensor 1048576 mask 92795.0 1048576
layer4.1.conv3.weight, mask/weight parameters,92795,92795 density 0.15954245983714788,0.15954245983714788
before tensor 1048576 mask 52438.0 1048576
layer4.2.conv1.weight, mask/weight parameters,52438,52438 density 0.09015666263204225,0.09015666263204225
before tensor 2359296 mask 53954.0 2359296
layer4.2.conv2.weight, mask/weight parameters,53954,53954 density 0.07432663272278428,0.07432663272278428
before tensor 1048576 mask 32843.0 1048576
layer4.2.conv3.weight, mask/weight parameters,32843,32843 density 0.05646697568221831,0.05646697568221831
classifier.weight, mask/weight parameters,104593,104593 density 0.5107080078125,0.5107080078125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.1979611683233004 0.1979611683233004 after dst
Death rate: 0.12801341700638347

dynamic sparse change grow
self.total_params*pruning_rate 3027777.435464326
self.total_nonzero 2365205.0
to grow 662572.4354643258
len(all_scores) 11947823 8752954
increse 662572.0 before_mask 3027776.0 after_mask 3027776.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1253,1196 density 0.7251157407407407,0.6921296296296297
before tensor 4096 mask 789.0 4096
layer1.0.conv1.weight, mask/weight parameters,789,728 density 0.2623005319148936,0.24202127659574468
before tensor 36864 mask 4686.0 36864
layer1.0.conv2.weight, mask/weight parameters,4686,4063 density 0.2357024294552588,0.2043659775665208
before tensor 16384 mask 4893.0 16384
layer1.0.conv3.weight, mask/weight parameters,4893,4000 density 0.4066655585106383,0.3324468085106383
layer1.0.shortcut.0.weight, mask/weight parameters,6541,5673 density 0.39923095703125,0.34625244140625
before tensor 16384 mask 2739.0 16384
layer1.1.conv1.weight, mask/weight parameters,2739,2398 density 0.2276429521276596,0.19930186170212766
before tensor 36864 mask 4327.0 36864
layer1.1.conv2.weight, mask/weight parameters,4327,4009 density 0.21764498767667623,0.20164981640762536
before tensor 16384 mask 2890.0 16384
layer1.1.conv3.weight, mask/weight parameters,2890,2309 density 0.24019281914893617,0.19190492021276595
before tensor 16384 mask 3225.0 16384
layer1.2.conv1.weight, mask/weight parameters,3225,2615 density 0.26803523936170215,0.21733710106382978
before tensor 36864 mask 3517.0 36864
layer1.2.conv2.weight, mask/weight parameters,3517,3111 density 0.1769025702932448,0.1564810623208088
before tensor 16384 mask 2323.0 16384
layer1.2.conv3.weight, mask/weight parameters,2323,1807 density 0.1930684840425532,0.15018284574468085
before tensor 32768 mask 6687.0 32768
layer2.0.conv1.weight, mask/weight parameters,6687,5444 density 0.3224826388888889,0.26253858024691357
before tensor 147456 mask 15386.0 147456
layer2.0.conv2.weight, mask/weight parameters,15386,13501 density 0.2605632610205084,0.2286406205016173
before tensor 65536 mask 9929.0 65536
layer2.0.conv3.weight, mask/weight parameters,9929,7767 density 0.23941454475308643,0.1872829861111111
layer2.0.shortcut.0.weight, mask/weight parameters,39824,31194 density 0.3038330078125,0.2379913330078125
before tensor 65536 mask 5406.0 65536
layer2.1.conv1.weight, mask/weight parameters,5406,3871 density 0.13035300925925927,0.09334008487654322
before tensor 147456 mask 5119.0 147456
layer2.1.conv2.weight, mask/weight parameters,5119,4464 density 0.08669071449135464,0.0755982319768328
before tensor 65536 mask 4221.0 65536
layer2.1.conv3.weight, mask/weight parameters,4221,3615 density 0.1017795138888889,0.08716724537037036
before tensor 65536 mask 12975.0 65536
layer2.2.conv1.weight, mask/weight parameters,12975,10521 density 0.3128616898148148,0.2536892361111111
before tensor 147456 mask 26322.0 147456
layer2.2.conv2.weight, mask/weight parameters,26322,21744 density 0.445765381293502,0.3682365493065082
before tensor 65536 mask 16115.0 65536
layer2.2.conv3.weight, mask/weight parameters,16115,13067 density 0.38857542438271603,0.3150800540123457
before tensor 65536 mask 13352.0 65536
layer2.3.conv1.weight, mask/weight parameters,13352,11167 density 0.32195216049382713,0.26926601080246915
before tensor 147456 mask 24903.0 147456
layer2.3.conv2.weight, mask/weight parameters,24903,21491 density 0.42173449169333943,0.3639519720909753
before tensor 65536 mask 13470.0 65536
layer2.3.conv3.weight, mask/weight parameters,13470,11203 density 0.3247974537037037,0.27013406635802467
before tensor 131072 mask 37991.0 131072
layer3.0.conv1.weight, mask/weight parameters,37991,31865 density 0.5013592694256757,0.42051573057432434
before tensor 589824 mask 97111.0 589824
layer3.0.conv2.weight, mask/weight parameters,97111,80300 density 0.49260916321727133,0.40733300868436
before tensor 262144 mask 73398.0 262144
layer3.0.conv3.weight, mask/weight parameters,73398,61052 density 0.4843090160472973,0.4028452280405405
layer3.0.shortcut.0.weight, mask/weight parameters,128878,101333 density 0.24581527709960938,0.19327735900878906
before tensor 262144 mask 37115.0 262144
layer3.1.conv1.weight, mask/weight parameters,37115,28564 density 0.24489944045608109,0.1884765625
before tensor 589824 mask 80512.0 589824
layer3.1.conv2.weight, mask/weight parameters,80512,63299 density 0.4084084084084084,0.32109305251197146
before tensor 262144 mask 56144.0 262144
layer3.1.conv3.weight, mask/weight parameters,56144,44966 density 0.37046030405405406,0.29670344172297297
before tensor 262144 mask 38983.0 262144
layer3.2.conv1.weight, mask/weight parameters,38983,29613 density 0.25722524282094594,0.19539827913851351
before tensor 589824 mask 73655.0 589824
layer3.2.conv2.weight, mask/weight parameters,73655,56581 density 0.3736253145036929,0.28701505559613666
before tensor 262144 mask 58696.0 262144
layer3.2.conv3.weight, mask/weight parameters,58696,46331 density 0.38729940878378377,0.3057102512668919
before tensor 262144 mask 39597.0 262144
layer3.3.conv1.weight, mask/weight parameters,39597,30498 density 0.2612766575168919,0.20123785895270271
before tensor 589824 mask 60586.0 589824
layer3.3.conv2.weight, mask/weight parameters,60586,47084 density 0.30733097962827693,0.23884019154289424
before tensor 262144 mask 50096.0 262144
layer3.3.conv3.weight, mask/weight parameters,50096,39101 density 0.3305532094594595,0.25800385346283783
before tensor 262144 mask 47172.0 262144
layer3.4.conv1.weight, mask/weight parameters,47172,32864 density 0.3112595016891892,0.21684966216216217
before tensor 589824 mask 64036.0 589824
layer3.4.conv2.weight, mask/weight parameters,64036,46220 density 0.32483158834510184,0.23445743040337635
before tensor 262144 mask 45367.0 262144
layer3.4.conv3.weight, mask/weight parameters,45367,34916 density 0.29934939822635137,0.23038956925675674
before tensor 262144 mask 49441.0 262144
layer3.5.conv1.weight, mask/weight parameters,49441,39574 density 0.32623126055743246,0.26112489442567566
before tensor 589824 mask 60408.0 589824
layer3.5.conv2.weight, mask/weight parameters,60408,49169 density 0.3064280496712929,0.24941664637610583
before tensor 262144 mask 43697.0 262144
layer3.5.conv3.weight, mask/weight parameters,43697,34701 density 0.288330078125,0.22897091427364866
before tensor 524288 mask 157029.0 524288
layer4.0.conv1.weight, mask/weight parameters,157029,130913 density 0.5399599746919014,0.45015748789612675
before tensor 2359296 mask 291017.0 2359296
layer4.0.conv2.weight, mask/weight parameters,291017,231665 density 0.40090287420926185,0.3191399964733629
before tensor 1048576 mask 152840.0 1048576
layer4.0.conv3.weight, mask/weight parameters,152840,114315 density 0.2627778389084507,0.19654179962588028
layer4.0.shortcut.0.weight, mask/weight parameters,227037,159235 density 0.10825967788696289,0.07592916488647461
before tensor 1048576 mask 137184.0 1048576
layer4.1.conv1.weight, mask/weight parameters,137184,106581 density 0.2358604753521127,0.18324473206426056
before tensor 2359296 mask 248857.0 2359296
layer4.1.conv2.weight, mask/weight parameters,248857,196884 density 0.3428235689567767,0.27122594723269194
before tensor 1048576 mask 124802.0 1048576
layer4.1.conv3.weight, mask/weight parameters,124802,92795 density 0.2145721005721831,0.15954245983714788
before tensor 1048576 mask 71390.0 1048576
layer4.2.conv1.weight, mask/weight parameters,71390,52438 density 0.12274083956866197,0.09015666263204225
before tensor 2359296 mask 80600.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80600,53954 density 0.11103396592386872,0.07432663272278428
before tensor 1048576 mask 47013.0 1048576
layer4.2.conv3.weight, mask/weight parameters,47013,32843 density 0.08082945917693662,0.05646697568221831
classifier.weight, mask/weight parameters,116232,104593 density 0.5675390625,0.5107080078125
Total Model parameters after dst: 3027776 2365205
Total parameters under density level of 0.1: 0.25341654291329896 0.1979611683233004 after dst
Death rate: 0.12801341700638347


Training summary: Average loss: 1.2776, Accuracy: 31620/50000 (63.240%)


Evaluation: Average loss: 1.4909, Accuracy: 5906/10000 (59.060%)

Current learning rate: 0.1. Time taken for epoch: 88.77 seconds.

Train Epoch: 60 [0/50000 (0%)]	Loss: 1.187219 Accuracy: 58/100 (58.000%
Train Epoch: 60 [10000/50000 (20%)]	Loss: 1.119633 Accuracy: 6505/10100 (64.406%
Train Epoch: 60 [20000/50000 (40%)]	Loss: 1.334211 Accuracy: 12820/20100 (63.781%
Train Epoch: 60 [30000/50000 (60%)]	Loss: 1.086069 Accuracy: 19268/30100 (64.013%
Train Epoch: 60 [40000/50000 (80%)]	Loss: 1.298294 Accuracy: 25577/40100 (63.783%
current layer rate 0.42523691397360036
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4410.0
Total filter_masks items: 8972399.0
4410.0 / 7552 channels
Total channels to prune: 69.38917432862945
Layer ('layer2', 0, 'conv1'): Pruned 1/81.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/81.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/81.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/81.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/81.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/81.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/81.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/81.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/148.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/148.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/148.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/148.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/148.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/148.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/148.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/148.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/148.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/148.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/148.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/148.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 4/284.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 4/284.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 4/284.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 4/284.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 4/284.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 4/284.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4354.0
Total filter_masks items: 8801491.0
After apply_mask:
Total filter_names items: 4354.0
Total filter_masks items: 8801491.0
Total pruned: 56/69.38917432862945 channels
===========done ===============

Training summary: Average loss: 1.2619, Accuracy: 31784/50000 (63.568%)


Evaluation: Average loss: 1.6291, Accuracy: 5630/10000 (56.300%)

Current learning rate: 0.1. Time taken for epoch: 88.54 seconds.

Train Epoch: 61 [0/50000 (0%)]	Loss: 0.887392 Accuracy: 78/100 (78.000%
Train Epoch: 61 [10000/50000 (20%)]	Loss: 1.036356 Accuracy: 6512/10100 (64.475%
Train Epoch: 61 [20000/50000 (40%)]	Loss: 0.976411 Accuracy: 12926/20100 (64.308%
Train Epoch: 61 [30000/50000 (60%)]	Loss: 1.344144 Accuracy: 19245/30100 (63.937%
Train Epoch: 61 [40000/50000 (80%)]	Loss: 1.375167 Accuracy: 25496/40100 (63.581%
current mest  death_rate 0.12681087000404442


dynamic sparse change prune
to kill 600419.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1185,1185 density 0.6857638888888888,0.6857638888888888
before tensor 4096 mask 697.0 4096
layer1.0.conv1.weight, mask/weight parameters,697,697 density 0.2317154255319149,0.2317154255319149
before tensor 36864 mask 4047.0 36864
layer1.0.conv2.weight, mask/weight parameters,4047,4047 density 0.20356118907499623,0.20356118907499623
before tensor 16384 mask 4072.0 16384
layer1.0.conv3.weight, mask/weight parameters,4072,4072 density 0.3384308510638298,0.3384308510638298
layer1.0.shortcut.0.weight, mask/weight parameters,5566,5566 density 0.3397216796875,0.3397216796875
before tensor 16384 mask 2240.0 16384
layer1.1.conv1.weight, mask/weight parameters,2240,2240 density 0.18617021276595744,0.18617021276595744
before tensor 36864 mask 3872.0 36864
layer1.1.conv2.weight, mask/weight parameters,3872,3872 density 0.19475881494894623,0.19475881494894623
before tensor 16384 mask 2270.0 16384
layer1.1.conv3.weight, mask/weight parameters,2270,2270 density 0.18866356382978725,0.18866356382978725
before tensor 16384 mask 2595.0 16384
layer1.2.conv1.weight, mask/weight parameters,2595,2595 density 0.21567486702127658,0.21567486702127658
before tensor 36864 mask 2976.0 36864
layer1.2.conv2.weight, mask/weight parameters,2976,2976 density 0.14969065942357024,0.14969065942357024
before tensor 16384 mask 1848.0 16384
layer1.2.conv3.weight, mask/weight parameters,1848,1848 density 0.1535904255319149,0.1535904255319149
before tensor 32768 mask 5247.0 32768
layer2.0.conv1.weight, mask/weight parameters,5247,5247 density 0.256201171875,0.256201171875
before tensor 147456 mask 13002.0 147456
layer2.0.conv2.weight, mask/weight parameters,13002,13002 density 0.22572916666666668,0.22572916666666668
before tensor 65536 mask 7950.0 65536
layer2.0.conv3.weight, mask/weight parameters,7950,7950 density 0.194091796875,0.194091796875
layer2.0.shortcut.0.weight, mask/weight parameters,31186,31186 density 0.2379302978515625,0.2379302978515625
before tensor 65536 mask 4055.0 65536
layer2.1.conv1.weight, mask/weight parameters,4055,4055 density 0.0989990234375,0.0989990234375
before tensor 147456 mask 4113.0 147456
layer2.1.conv2.weight, mask/weight parameters,4113,4113 density 0.07140625,0.07140625
before tensor 65536 mask 3290.0 65536
layer2.1.conv3.weight, mask/weight parameters,3290,3290 density 0.080322265625,0.080322265625
before tensor 65536 mask 10526.0 65536
layer2.2.conv1.weight, mask/weight parameters,10526,10526 density 0.256982421875,0.256982421875
before tensor 147456 mask 21381.0 147456
layer2.2.conv2.weight, mask/weight parameters,21381,21381 density 0.3711979166666667,0.3711979166666667
before tensor 65536 mask 12918.0 65536
layer2.2.conv3.weight, mask/weight parameters,12918,12918 density 0.315380859375,0.315380859375
before tensor 65536 mask 10801.0 65536
layer2.3.conv1.weight, mask/weight parameters,10801,10801 density 0.2636962890625,0.2636962890625
before tensor 147456 mask 20619.0 147456
layer2.3.conv2.weight, mask/weight parameters,20619,20619 density 0.35796875,0.35796875
before tensor 65536 mask 10852.0 65536
layer2.3.conv3.weight, mask/weight parameters,10852,10852 density 0.26494140625,0.26494140625
before tensor 131072 mask 30950.0 131072
layer3.0.conv1.weight, mask/weight parameters,30950,30950 density 0.4140357448630137,0.4140357448630137
before tensor 589824 mask 78156.0 589824
layer3.0.conv2.weight, mask/weight parameters,78156,78156 density 0.40739350722462,0.40739350722462
before tensor 262144 mask 60647.0 262144
layer3.0.conv3.weight, mask/weight parameters,60647,60647 density 0.4056546982020548,0.4056546982020548
layer3.0.shortcut.0.weight, mask/weight parameters,101122,101122 density 0.19287490844726562,0.19287490844726562
before tensor 262144 mask 28789.0 262144
layer3.1.conv1.weight, mask/weight parameters,28789,28789 density 0.19256340967465754,0.19256340967465754
before tensor 589824 mask 62279.0 589824
layer3.1.conv2.weight, mask/weight parameters,62279,62279 density 0.32463355643126707,0.32463355643126707
before tensor 262144 mask 45122.0 262144
layer3.1.conv3.weight, mask/weight parameters,45122,45122 density 0.3018113227739726,0.3018113227739726
before tensor 262144 mask 29903.0 262144
layer3.2.conv1.weight, mask/weight parameters,29903,29903 density 0.20001471532534246,0.20001471532534246
before tensor 589824 mask 57194.0 589824
layer3.2.conv2.weight, mask/weight parameters,57194,57194 density 0.29812764537853675,0.29812764537853675
before tensor 262144 mask 46729.0 262144
layer3.2.conv3.weight, mask/weight parameters,46729,46729 density 0.3125601990582192,0.3125601990582192
before tensor 262144 mask 30791.0 262144
layer3.3.conv1.weight, mask/weight parameters,30791,30791 density 0.20595435573630136,0.20595435573630136
before tensor 589824 mask 47499.0 589824
layer3.3.conv2.weight, mask/weight parameters,47499,47499 density 0.2475917933320823,0.2475917933320823
before tensor 262144 mask 39166.0 262144
layer3.3.conv3.weight, mask/weight parameters,39166,39166 density 0.2619729238013699,0.2619729238013699
before tensor 262144 mask 35722.0 262144
layer3.4.conv1.weight, mask/weight parameters,35722,35722 density 0.2389367508561644,0.2389367508561644
before tensor 589824 mask 48344.0 589824
layer3.4.conv2.weight, mask/weight parameters,48344,48344 density 0.2519964137528409,0.2519964137528409
before tensor 262144 mask 34835.0 262144
layer3.4.conv3.weight, mask/weight parameters,34835,34835 density 0.23300379922945205,0.23300379922945205
before tensor 262144 mask 39014.0 262144
layer3.5.conv1.weight, mask/weight parameters,39014,39014 density 0.2609562285958904,0.2609562285958904
before tensor 589824 mask 48023.0 589824
layer3.5.conv2.weight, mask/weight parameters,48023,48023 density 0.2503231792498071,0.2503231792498071
before tensor 262144 mask 34737.0 262144
layer3.5.conv3.weight, mask/weight parameters,34737,34737 density 0.23234829837328766,0.23234829837328766
before tensor 524288 mask 130711.0 524288
layer4.0.conv1.weight, mask/weight parameters,130711,130711 density 0.4558837890625,0.4558837890625
before tensor 2359296 mask 229463.0 2359296
layer4.0.conv2.weight, mask/weight parameters,229463,229463 density 0.32520266439909296,0.32520266439909296
before tensor 1048576 mask 115514.0 1048576
layer4.0.conv3.weight, mask/weight parameters,115514,115514 density 0.2014404296875,0.2014404296875
layer4.0.shortcut.0.weight, mask/weight parameters,161948,161948 density 0.07722282409667969,0.07722282409667969
before tensor 1048576 mask 106771.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106771,106771 density 0.18619384765625,0.18619384765625
before tensor 2359296 mask 195775.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195775,195775 density 0.27745890022675734,0.27745890022675734
before tensor 1048576 mask 92680.0 1048576
layer4.1.conv3.weight, mask/weight parameters,92680,92680 density 0.16162109375,0.16162109375
before tensor 1048576 mask 52799.0 1048576
layer4.2.conv1.weight, mask/weight parameters,52799,52799 density 0.09207414899553572,0.09207414899553572
before tensor 2359296 mask 54732.0 2359296
layer4.2.conv2.weight, mask/weight parameters,54732,54732 density 0.07756802721088435,0.07756802721088435
before tensor 1048576 mask 32884.0 1048576
layer4.2.conv3.weight, mask/weight parameters,32884,32884 density 0.05734514508928571,0.05734514508928571
classifier.weight, mask/weight parameters,105598,105598 density 0.515615234375,0.515615234375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.20083400449098937 0.20083400449098937 after dst
Death rate: 0.12681087000404442

dynamic sparse change grow
self.total_params*pruning_rate 2999334.7552834987
self.total_nonzero 2365205.0
to grow 634129.7552834987
len(all_scores) 11776915 8534499
increse 634129.0 before_mask 2999333.0 after_mask 2999333.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1256,1185 density 0.7268518518518519,0.6857638888888888
before tensor 4096 mask 766.0 4096
layer1.0.conv1.weight, mask/weight parameters,766,697 density 0.2546542553191489,0.2317154255319149
before tensor 36864 mask 4738.0 36864
layer1.0.conv2.weight, mask/weight parameters,4738,4047 density 0.23831799205271365,0.20356118907499623
before tensor 16384 mask 4869.0 16384
layer1.0.conv3.weight, mask/weight parameters,4869,4072 density 0.4046708776595745,0.3384308510638298
layer1.0.shortcut.0.weight, mask/weight parameters,6360,5566 density 0.38818359375,0.3397216796875
before tensor 16384 mask 2929.0 16384
layer1.1.conv1.weight, mask/weight parameters,2929,2240 density 0.2434341755319149,0.18617021276595744
before tensor 36864 mask 4332.0 36864
layer1.1.conv2.weight, mask/weight parameters,4332,3872 density 0.21789648408027765,0.19475881494894623
before tensor 16384 mask 2886.0 16384
layer1.1.conv3.weight, mask/weight parameters,2886,2270 density 0.23986037234042554,0.18866356382978725
before tensor 16384 mask 3375.0 16384
layer1.2.conv1.weight, mask/weight parameters,3375,2595 density 0.2805019946808511,0.21567486702127658
before tensor 36864 mask 3515.0 36864
layer1.2.conv2.weight, mask/weight parameters,3515,2976 density 0.17680197173180423,0.14969065942357024
before tensor 16384 mask 2399.0 16384
layer1.2.conv3.weight, mask/weight parameters,2399,1848 density 0.19938497340425532,0.1535904255319149
before tensor 32768 mask 7425.0 32768
layer2.0.conv1.weight, mask/weight parameters,7425,5247 density 0.362548828125,0.256201171875
before tensor 147456 mask 16075.0 147456
layer2.0.conv2.weight, mask/weight parameters,16075,13002 density 0.2790798611111111,0.22572916666666668
before tensor 65536 mask 9784.0 65536
layer2.0.conv3.weight, mask/weight parameters,9784,7950 density 0.2388671875,0.194091796875
layer2.0.shortcut.0.weight, mask/weight parameters,40307,31186 density 0.30751800537109375,0.2379302978515625
before tensor 65536 mask 5090.0 65536
layer2.1.conv1.weight, mask/weight parameters,5090,4055 density 0.124267578125,0.0989990234375
before tensor 147456 mask 4993.0 147456
layer2.1.conv2.weight, mask/weight parameters,4993,4113 density 0.08668402777777778,0.07140625
before tensor 65536 mask 4404.0 65536
layer2.1.conv3.weight, mask/weight parameters,4404,3290 density 0.10751953125,0.080322265625
before tensor 65536 mask 13233.0 65536
layer2.2.conv1.weight, mask/weight parameters,13233,10526 density 0.3230712890625,0.256982421875
before tensor 147456 mask 25990.0 147456
layer2.2.conv2.weight, mask/weight parameters,25990,21381 density 0.45121527777777776,0.3711979166666667
before tensor 65536 mask 16028.0 65536
layer2.2.conv3.weight, mask/weight parameters,16028,12918 density 0.39130859375,0.315380859375
before tensor 65536 mask 13357.0 65536
layer2.3.conv1.weight, mask/weight parameters,13357,10801 density 0.3260986328125,0.2636962890625
before tensor 147456 mask 24315.0 147456
layer2.3.conv2.weight, mask/weight parameters,24315,20619 density 0.42213541666666665,0.35796875
before tensor 65536 mask 13068.0 65536
layer2.3.conv3.weight, mask/weight parameters,13068,10852 density 0.31904296875,0.26494140625
before tensor 131072 mask 39071.0 131072
layer3.0.conv1.weight, mask/weight parameters,39071,30950 density 0.5226749785958904,0.4140357448630137
before tensor 589824 mask 101108.0 589824
layer3.0.conv2.weight, mask/weight parameters,101108,78156 density 0.5270323804758033,0.40739350722462
before tensor 262144 mask 74170.0 262144
layer3.0.conv3.weight, mask/weight parameters,74170,60647 density 0.4961071275684932,0.4056546982020548
layer3.0.shortcut.0.weight, mask/weight parameters,132883,101122 density 0.25345420837402344,0.19287490844726562
before tensor 262144 mask 36276.0 262144
layer3.1.conv1.weight, mask/weight parameters,36276,28789 density 0.2426423373287671,0.19256340967465754
before tensor 589824 mask 79744.0 589824
layer3.1.conv2.weight, mask/weight parameters,79744,62279 density 0.41567106607451887,0.32463355643126707
before tensor 262144 mask 57449.0 262144
layer3.1.conv3.weight, mask/weight parameters,57449,45122 density 0.3842639661815068,0.3018113227739726
before tensor 262144 mask 39531.0 262144
layer3.2.conv1.weight, mask/weight parameters,39531,29903 density 0.2644143300513699,0.20001471532534246
before tensor 589824 mask 73493.0 589824
layer3.2.conv2.weight, mask/weight parameters,73493,57194 density 0.3830873000979963,0.29812764537853675
before tensor 262144 mask 57915.0 262144
layer3.2.conv3.weight, mask/weight parameters,57915,46729 density 0.387380939640411,0.3125601990582192
before tensor 262144 mask 40371.0 262144
layer3.3.conv1.weight, mask/weight parameters,40371,30791 density 0.2700329088184932,0.20595435573630136
before tensor 589824 mask 59914.0 589824
layer3.3.conv2.weight, mask/weight parameters,59914,47499 density 0.3123058318216885,0.2475917933320823
before tensor 262144 mask 48814.0 262144
layer3.3.conv3.weight, mask/weight parameters,48814,39166 density 0.3265063142123288,0.2619729238013699
before tensor 262144 mask 44596.0 262144
layer3.4.conv1.weight, mask/weight parameters,44596,35722 density 0.298293022260274,0.2389367508561644
before tensor 589824 mask 59457.0 589824
layer3.4.conv2.weight, mask/weight parameters,59457,48344 density 0.30992368799649717,0.2519964137528409
before tensor 262144 mask 44123.0 262144
layer3.4.conv3.weight, mask/weight parameters,44123,34835 density 0.2951292273116438,0.23300379922945205
before tensor 262144 mask 51508.0 262144
layer3.5.conv1.weight, mask/weight parameters,51508,39014 density 0.3445258989726027,0.2609562285958904
before tensor 589824 mask 63262.0 589824
layer3.5.conv2.weight, mask/weight parameters,63262,48023 density 0.32975751131127373,0.2503231792498071
before tensor 262144 mask 44357.0 262144
layer3.5.conv3.weight, mask/weight parameters,44357,34737 density 0.2966944028253425,0.23234829837328766
before tensor 524288 mask 157944.0 524288
layer4.0.conv1.weight, mask/weight parameters,157944,130711 density 0.5508649553571429,0.4558837890625
before tensor 2359296 mask 289580.0 2359296
layer4.0.conv2.weight, mask/weight parameters,289580,229463 density 0.41040249433106574,0.32520266439909296
before tensor 1048576 mask 150074.0 1048576
layer4.0.conv3.weight, mask/weight parameters,150074,115514 density 0.26170828683035713,0.2014404296875
layer4.0.shortcut.0.weight, mask/weight parameters,222545,161948 density 0.10611772537231445,0.07722282409667969
before tensor 1048576 mask 140331.0 1048576
layer4.1.conv1.weight, mask/weight parameters,140331,106771 density 0.2447178431919643,0.18619384765625
before tensor 2359296 mask 239867.0 2359296
layer4.1.conv2.weight, mask/weight parameters,239867,195775 density 0.33994756235827667,0.27745890022675734
before tensor 1048576 mask 116240.0 1048576
layer4.1.conv3.weight, mask/weight parameters,116240,92680 density 0.20270647321428573,0.16162109375
before tensor 1048576 mask 71514.0 1048576
layer4.2.conv1.weight, mask/weight parameters,71514,52799 density 0.12471051897321428,0.09207414899553572
before tensor 2359296 mask 73701.0 2359296
layer4.2.conv2.weight, mask/weight parameters,73701,54732 density 0.1044515306122449,0.07756802721088435
before tensor 1048576 mask 43760.0 1048576
layer4.2.conv3.weight, mask/weight parameters,43760,32884 density 0.07631138392857142,0.05734514508928571
classifier.weight, mask/weight parameters,114241,105598 density 0.5578173828125,0.515615234375
Total Model parameters after dst: 2999333 2365205
Total parameters under density level of 0.1: 0.25467900549507233 0.20083400449098937 after dst
Death rate: 0.12681087000404442


Training summary: Average loss: 1.2639, Accuracy: 31729/50000 (63.458%)


Evaluation: Average loss: 1.5301, Accuracy: 5901/10000 (59.010%)

Current learning rate: 0.1. Time taken for epoch: 88.76 seconds.

Train Epoch: 62 [0/50000 (0%)]	Loss: 1.028087 Accuracy: 73/100 (73.000%
Train Epoch: 62 [10000/50000 (20%)]	Loss: 1.304417 Accuracy: 6548/10100 (64.832%
Train Epoch: 62 [20000/50000 (40%)]	Loss: 1.360152 Accuracy: 12896/20100 (64.159%
Train Epoch: 62 [30000/50000 (60%)]	Loss: 1.491878 Accuracy: 19133/30100 (63.565%
Train Epoch: 62 [40000/50000 (80%)]	Loss: 1.123434 Accuracy: 25455/40100 (63.479%
current layer rate 0.4315514337733273
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4354.0
Total filter_masks items: 8801491.0
4354.0 / 7552 channels
Total channels to prune: 61.076427856167356
Layer ('layer2', 0, 'conv1'): Pruned 1/80.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/80.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/80.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/80.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/80.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/80.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/80.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/80.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/146.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/146.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/146.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/146.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/146.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/146.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/146.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/146.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/146.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/146.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/146.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/146.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 3/280.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 3/280.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 3/280.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 3/280.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 3/280.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 3/280.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4304.0
Total filter_masks items: 8658146.0
After apply_mask:
Total filter_names items: 4304.0
Total filter_masks items: 8658146.0
Total pruned: 50/61.076427856167356 channels
===========done ===============

Training summary: Average loss: 1.2666, Accuracy: 31761/50000 (63.522%)


Evaluation: Average loss: 1.6899, Accuracy: 5438/10000 (54.380%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 63 [0/50000 (0%)]	Loss: 1.230333 Accuracy: 62/100 (62.000%
Train Epoch: 63 [10000/50000 (20%)]	Loss: 1.097488 Accuracy: 6621/10100 (65.554%
Train Epoch: 63 [20000/50000 (40%)]	Loss: 1.130033 Accuracy: 12962/20100 (64.488%
Train Epoch: 63 [30000/50000 (60%)]	Loss: 1.193987 Accuracy: 19221/30100 (63.857%
Train Epoch: 63 [40000/50000 (80%)]	Loss: 1.179080 Accuracy: 25588/40100 (63.810%
current mest  death_rate 0.12560409363090355


dynamic sparse change prune
to kill 580334.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1192,1192 density 0.6898148148148148,0.6898148148148148
before tensor 4096 mask 671.0 4096
layer1.0.conv1.weight, mask/weight parameters,671,671 density 0.2230718085106383,0.2230718085106383
before tensor 36864 mask 4011.0 36864
layer1.0.conv2.weight, mask/weight parameters,4011,4011 density 0.20175041496906596,0.20175041496906596
before tensor 16384 mask 4039.0 16384
layer1.0.conv3.weight, mask/weight parameters,4039,4039 density 0.335688164893617,0.335688164893617
layer1.0.shortcut.0.weight, mask/weight parameters,5452,5452 density 0.332763671875,0.332763671875
before tensor 16384 mask 2391.0 16384
layer1.1.conv1.weight, mask/weight parameters,2391,2391 density 0.19872007978723405,0.19872007978723405
before tensor 36864 mask 3915.0 36864
layer1.1.conv2.weight, mask/weight parameters,3915,3915 density 0.19692168401991852,0.19692168401991852
before tensor 16384 mask 2249.0 16384
layer1.1.conv3.weight, mask/weight parameters,2249,2249 density 0.1869182180851064,0.1869182180851064
before tensor 16384 mask 2682.0 16384
layer1.2.conv1.weight, mask/weight parameters,2682,2682 density 0.22290558510638298,0.22290558510638298
before tensor 36864 mask 3024.0 36864
layer1.2.conv2.weight, mask/weight parameters,3024,3024 density 0.15210502489814395,0.15210502489814395
before tensor 16384 mask 1954.0 16384
layer1.2.conv3.weight, mask/weight parameters,1954,1954 density 0.1624002659574468,0.1624002659574468
before tensor 32768 mask 5509.0 32768
layer2.0.conv1.weight, mask/weight parameters,5509,5509 density 0.27239912974683544,0.27239912974683544
before tensor 147456 mask 13449.0 147456
layer2.0.conv2.weight, mask/weight parameters,13449,13449 density 0.23943812423222774,0.23943812423222774
before tensor 65536 mask 7820.0 65536
layer2.0.conv3.weight, mask/weight parameters,7820,7820 density 0.19333465189873417,0.19333465189873417
layer2.0.shortcut.0.weight, mask/weight parameters,31185,31185 density 0.23792266845703125,0.23792266845703125
before tensor 65536 mask 3799.0 65536
layer2.1.conv1.weight, mask/weight parameters,3799,3799 density 0.09392306170886076,0.09392306170886076
before tensor 147456 mask 3808.0 147456
layer2.1.conv2.weight, mask/weight parameters,3808,3808 density 0.06779540315832577,0.06779540315832577
before tensor 65536 mask 3227.0 65536
layer2.1.conv3.weight, mask/weight parameters,3227,3227 density 0.07978144778481013,0.07978144778481013
before tensor 65536 mask 10942.0 65536
layer2.2.conv1.weight, mask/weight parameters,10942,10942 density 0.2705201740506329,0.2705201740506329
before tensor 147456 mask 21691.0 147456
layer2.2.conv2.weight, mask/weight parameters,21691,21691 density 0.38617386814791077,0.38617386814791077
before tensor 65536 mask 12882.0 65536
layer2.2.conv3.weight, mask/weight parameters,12882,12882 density 0.3184829905063291,0.3184829905063291
before tensor 65536 mask 10688.0 65536
layer2.3.conv1.weight, mask/weight parameters,10688,10688 density 0.26424050632911394,0.26424050632911394
before tensor 147456 mask 20317.0 147456
layer2.3.conv2.weight, mask/weight parameters,20317,20317 density 0.3617119763570653,0.3617119763570653
before tensor 65536 mask 10583.0 65536
layer2.3.conv3.weight, mask/weight parameters,10583,10583 density 0.26164458069620256,0.26164458069620256
before tensor 131072 mask 31567.0 131072
layer3.0.conv1.weight, mask/weight parameters,31567,31567 density 0.4281548394097222,0.4281548394097222
before tensor 589824 mask 80593.0 589824
layer3.0.conv2.weight, mask/weight parameters,80593,80593 density 0.4318469221536351,0.4318469221536351
before tensor 262144 mask 61179.0 262144
layer3.0.conv3.weight, mask/weight parameters,61179,61179 density 0.4148966471354167,0.4148966471354167
layer3.0.shortcut.0.weight, mask/weight parameters,103633,103633 density 0.1976642608642578,0.1976642608642578
before tensor 262144 mask 28447.0 262144
layer3.1.conv1.weight, mask/weight parameters,28447,28447 density 0.19291856553819445,0.19291856553819445
before tensor 589824 mask 62233.0 589824
layer3.1.conv2.weight, mask/weight parameters,62233,62233 density 0.3334672925240055,0.3334672925240055
before tensor 262144 mask 45959.0 262144
layer3.1.conv3.weight, mask/weight parameters,45959,45959 density 0.3116794162326389,0.3116794162326389
before tensor 262144 mask 30471.0 262144
layer3.2.conv1.weight, mask/weight parameters,30471,30471 density 0.20664469401041666,0.20664469401041666
before tensor 589824 mask 57674.0 589824
layer3.2.conv2.weight, mask/weight parameters,57674,57674 density 0.30903849451303156,0.30903849451303156
before tensor 262144 mask 46500.0 262144
layer3.2.conv3.weight, mask/weight parameters,46500,46500 density 0.3153483072916667,0.3153483072916667
before tensor 262144 mask 31239.0 262144
layer3.3.conv1.weight, mask/weight parameters,31239,31239 density 0.21185302734375,0.21185302734375
before tensor 589824 mask 46863.0 589824
layer3.3.conv2.weight, mask/weight parameters,46863,46863 density 0.2511091820987654,0.2511091820987654
before tensor 262144 mask 38717.0 262144
layer3.3.conv3.weight, mask/weight parameters,38717,38717 density 0.2625664605034722,0.2625664605034722
before tensor 262144 mask 34768.0 262144
layer3.4.conv1.weight, mask/weight parameters,34768,34768 density 0.2357855902777778,0.2357855902777778
before tensor 589824 mask 46901.0 589824
layer3.4.conv2.weight, mask/weight parameters,46901,46901 density 0.2513128000685871,0.2513128000685871
before tensor 262144 mask 34575.0 262144
layer3.4.conv3.weight, mask/weight parameters,34575,34575 density 0.23447672526041666,0.23447672526041666
before tensor 262144 mask 40344.0 262144
layer3.5.conv1.weight, mask/weight parameters,40344,40344 density 0.2736002604166667,0.2736002604166667
before tensor 589824 mask 49343.0 589824
layer3.5.conv2.weight, mask/weight parameters,49343,49343 density 0.26439793381344306,0.26439793381344306
before tensor 262144 mask 34879.0 262144
layer3.5.conv3.weight, mask/weight parameters,34879,34879 density 0.2365383572048611,0.2365383572048611
before tensor 524288 mask 131976.0 524288
layer4.0.conv1.weight, mask/weight parameters,131976,131976 density 0.4652809115523466,0.4652809115523466
before tensor 2359296 mask 230368.0 2359296
layer4.0.conv2.weight, mask/weight parameters,230368,230368 density 0.3335954390705528,0.3335954390705528
before tensor 1048576 mask 114515.0 1048576
layer4.0.conv3.weight, mask/weight parameters,114515,114515 density 0.20186110954422382,0.20186110954422382
layer4.0.shortcut.0.weight, mask/weight parameters,160850,160850 density 0.07669925689697266,0.07669925689697266
before tensor 1048576 mask 109745.0 1048576
layer4.1.conv1.weight, mask/weight parameters,109745,109745 density 0.19345280065433212,0.19345280065433212
before tensor 2359296 mask 191543.0 2359296
layer4.1.conv2.weight, mask/weight parameters,191543,191543 density 0.2773730343879831,0.2773730343879831
before tensor 1048576 mask 88789.0 1048576
layer4.1.conv3.weight, mask/weight parameters,88789,88789 density 0.15651264948104693,0.15651264948104693
before tensor 1048576 mask 53589.0 1048576
layer4.2.conv1.weight, mask/weight parameters,53589,53589 density 0.09446391301895307,0.09446391301895307
before tensor 2359296 mask 53474.0 2359296
layer4.2.conv2.weight, mask/weight parameters,53474,53474 density 0.0774355922213968,0.0774355922213968
before tensor 1048576 mask 32170.0 1048576
layer4.2.conv3.weight, mask/weight parameters,32170,32170 density 0.05670760943140794,0.05670760943140794
classifier.weight, mask/weight parameters,104821,104821 density 0.5118212890625,0.5118212890625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.20330861463849875 0.20330861463849875 after dst
Death rate: 0.12560409363090355

dynamic sparse change grow
self.total_params*pruning_rate 2970792.041889127
self.total_nonzero 2365205.0
to grow 605587.0418891269
len(all_scores) 11633570 8365810
increse 605587.0 before_mask 2970791.0 after_mask 2970791.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1248,1192 density 0.7222222222222222,0.6898148148148148
before tensor 4096 mask 737.0 4096
layer1.0.conv1.weight, mask/weight parameters,737,671 density 0.2450132978723404,0.2230718085106383
before tensor 36864 mask 4460.0 36864
layer1.0.conv2.weight, mask/weight parameters,4460,4011 density 0.22433479201247422,0.20175041496906596
before tensor 16384 mask 4705.0 16384
layer1.0.conv3.weight, mask/weight parameters,4705,4039 density 0.3910405585106383,0.335688164893617
layer1.0.shortcut.0.weight, mask/weight parameters,6166,5452 density 0.3763427734375,0.332763671875
before tensor 16384 mask 3040.0 16384
layer1.1.conv1.weight, mask/weight parameters,3040,2391 density 0.2526595744680851,0.19872007978723405
before tensor 36864 mask 4679.0 36864
layer1.1.conv2.weight, mask/weight parameters,4679,3915 density 0.23535033449021678,0.19692168401991852
before tensor 16384 mask 2986.0 16384
layer1.1.conv3.weight, mask/weight parameters,2986,2249 density 0.2481715425531915,0.1869182180851064
before tensor 16384 mask 3459.0 16384
layer1.2.conv1.weight, mask/weight parameters,3459,2682 density 0.2874833776595745,0.22290558510638298
before tensor 36864 mask 3552.0 36864
layer1.2.conv2.weight, mask/weight parameters,3552,3024 density 0.1786630451184548,0.15210502489814395
before tensor 16384 mask 2322.0 16384
layer1.2.conv3.weight, mask/weight parameters,2322,1954 density 0.19298537234042554,0.1624002659574468
before tensor 32768 mask 7204.0 32768
layer2.0.conv1.weight, mask/weight parameters,7204,5509 density 0.35621044303797467,0.27239912974683544
before tensor 147456 mask 15823.0 147456
layer2.0.conv2.weight, mask/weight parameters,15823,13449 density 0.28170343071801174,0.23943812423222774
before tensor 65536 mask 9187.0 65536
layer2.0.conv3.weight, mask/weight parameters,9187,7820 density 0.22713113132911392,0.19333465189873417
layer2.0.shortcut.0.weight, mask/weight parameters,37756,31185 density 0.288055419921875,0.23792266845703125
before tensor 65536 mask 5013.0 65536
layer2.1.conv1.weight, mask/weight parameters,5013,3799 density 0.12393690664556962,0.09392306170886076
before tensor 147456 mask 4657.0 147456
layer2.1.conv2.weight, mask/weight parameters,4657,3808 density 0.08291050223432854,0.06779540315832577
before tensor 65536 mask 4125.0 65536
layer2.1.conv3.weight, mask/weight parameters,4125,3227 density 0.10198279272151899,0.07978144778481013
before tensor 65536 mask 13057.0 65536
layer2.2.conv1.weight, mask/weight parameters,13057,10942 density 0.3228095332278481,0.2705201740506329
before tensor 147456 mask 25923.0 147456
layer2.2.conv2.weight, mask/weight parameters,25923,21691 density 0.46151791913689044,0.38617386814791077
before tensor 65536 mask 15716.0 65536
layer2.2.conv3.weight, mask/weight parameters,15716,12882 density 0.3885482594936709,0.3184829905063291
before tensor 65536 mask 12493.0 65536
layer2.3.conv1.weight, mask/weight parameters,12493,10688 density 0.30886570411392406,0.26424050632911394
before tensor 147456 mask 23106.0 147456
layer2.3.conv2.weight, mask/weight parameters,23106,20317 density 0.4113656999412487,0.3617119763570653
before tensor 65536 mask 12694.0 65536
layer2.3.conv3.weight, mask/weight parameters,12694,10583 density 0.31383504746835444,0.26164458069620256
before tensor 131072 mask 36957.0 131072
layer3.0.conv1.weight, mask/weight parameters,36957,31567 density 0.5012613932291666,0.4281548394097222
before tensor 589824 mask 94217.0 589824
layer3.0.conv2.weight, mask/weight parameters,94217,80593 density 0.504849322702332,0.4318469221536351
before tensor 262144 mask 71128.0 262144
layer3.0.conv3.weight, mask/weight parameters,71128,61179 density 0.4823676215277778,0.4148966471354167
layer3.0.shortcut.0.weight, mask/weight parameters,128025,103633 density 0.2441883087158203,0.1976642608642578
before tensor 262144 mask 34334.0 262144
layer3.1.conv1.weight, mask/weight parameters,34334,28447 density 0.2328423394097222,0.19291856553819445
before tensor 589824 mask 74932.0 589824
layer3.1.conv2.weight, mask/weight parameters,74932,62233 density 0.40151320301783266,0.3334672925240055
before tensor 262144 mask 54966.0 262144
layer3.1.conv3.weight, mask/weight parameters,54966,45959 density 0.3727620442708333,0.3116794162326389
before tensor 262144 mask 35800.0 262144
layer3.2.conv1.weight, mask/weight parameters,35800,30471 density 0.24278428819444445,0.20664469401041666
before tensor 589824 mask 67386.0 589824
layer3.2.conv2.weight, mask/weight parameters,67386,57674 density 0.3610789609053498,0.30903849451303156
before tensor 262144 mask 56426.0 262144
layer3.2.conv3.weight, mask/weight parameters,56426,46500 density 0.3826633029513889,0.3153483072916667
before tensor 262144 mask 37549.0 262144
layer3.3.conv1.weight, mask/weight parameters,37549,31239 density 0.2546454535590278,0.21185302734375
before tensor 589824 mask 56123.0 589824
layer3.3.conv2.weight, mask/weight parameters,56123,46863 density 0.30072766632373116,0.2511091820987654
before tensor 262144 mask 47966.0 262144
layer3.3.conv3.weight, mask/weight parameters,47966,38717 density 0.3252902560763889,0.2625664605034722
before tensor 262144 mask 41467.0 262144
layer3.4.conv1.weight, mask/weight parameters,41467,34768 density 0.2812160915798611,0.2357855902777778
before tensor 589824 mask 58571.0 589824
layer3.4.conv2.weight, mask/weight parameters,58571,46901 density 0.31384495027434844,0.2513128000685871
before tensor 262144 mask 43872.0 262144
layer3.4.conv3.weight, mask/weight parameters,43872,34575 density 0.2975260416666667,0.23447672526041666
before tensor 262144 mask 47941.0 262144
layer3.5.conv1.weight, mask/weight parameters,47941,40344 density 0.3251207139756944,0.2736002604166667
before tensor 589824 mask 58606.0 589824
layer3.5.conv2.weight, mask/weight parameters,58606,49343 density 0.31403249314128945,0.26439793381344306
before tensor 262144 mask 43024.0 262144
layer3.5.conv3.weight, mask/weight parameters,43024,34879 density 0.2917751736111111,0.2365383572048611
before tensor 524288 mask 155598.0 524288
layer4.0.conv1.weight, mask/weight parameters,155598,131976 density 0.5485601872743683,0.4652809115523466
before tensor 2359296 mask 288187.0 2359296
layer4.0.conv2.weight, mask/weight parameters,288187,230368 density 0.41732301708321207,0.3335954390705528
before tensor 1048576 mask 152250.0 1048576
layer4.0.conv3.weight, mask/weight parameters,152250,114515 density 0.26837841268050544,0.20186110954422382
layer4.0.shortcut.0.weight, mask/weight parameters,232228,160850 density 0.11073493957519531,0.07669925689697266
before tensor 1048576 mask 141507.0 1048576
layer4.1.conv1.weight, mask/weight parameters,141507,109745 density 0.24944120882220217,0.19345280065433212
before tensor 2359296 mask 240668.0 2359296
layer4.1.conv2.weight, mask/weight parameters,240668,191543 density 0.34851084842613467,0.2773730343879831
before tensor 1048576 mask 117378.0 1048576
layer4.1.conv3.weight, mask/weight parameters,117378,88789 density 0.2069078576263538,0.15651264948104693
before tensor 1048576 mask 81493.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81493,53589 density 0.14365163865072203,0.09446391301895307
before tensor 2359296 mask 83599.0 2359296
layer4.2.conv2.weight, mask/weight parameters,83599,53474 density 0.12105954434148468,0.0774355922213968
before tensor 1048576 mask 49130.0 1048576
layer4.2.conv3.weight, mask/weight parameters,49130,32170 density 0.08660381881768953,0.05670760943140794
classifier.weight, mask/weight parameters,115355,104821 density 0.5632568359375,0.5118212890625
Total Model parameters after dst: 2970791 2365205
Total parameters under density level of 0.1: 0.2553636587908957 0.20330861463849875 after dst
Death rate: 0.12560409363090355


Training summary: Average loss: 1.2637, Accuracy: 31879/50000 (63.758%)


Evaluation: Average loss: 1.6033, Accuracy: 5706/10000 (57.060%)

Current learning rate: 0.1. Time taken for epoch: 88.75 seconds.

Train Epoch: 64 [0/50000 (0%)]	Loss: 0.950815 Accuracy: 66/100 (66.000%
Train Epoch: 64 [10000/50000 (20%)]	Loss: 1.205033 Accuracy: 6645/10100 (65.792%
Train Epoch: 64 [20000/50000 (40%)]	Loss: 1.208369 Accuracy: 12993/20100 (64.642%
Train Epoch: 64 [30000/50000 (60%)]	Loss: 1.060691 Accuracy: 19330/30100 (64.219%
Train Epoch: 64 [40000/50000 (80%)]	Loss: 1.429542 Accuracy: 25699/40100 (64.087%
current layer rate 0.4375
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4304.0
Total filter_masks items: 8658146.0
4304.0 / 7552 channels
Total channels to prune: 56.0
Layer ('layer2', 0, 'conv1'): Pruned 1/79.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/79.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/79.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/79.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/79.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/79.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/79.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/79.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 1/144.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/144.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/144.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/144.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/144.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/144.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/144.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/144.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/144.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/144.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/144.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/144.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 3/277.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 3/277.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 3/277.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 3/277.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 3/277.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 3/277.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4266.0
Total filter_masks items: 8542957.0
After apply_mask:
Total filter_names items: 4266.0
Total filter_masks items: 8542957.0
Total pruned: 38/56.0 channels
===========done ===============

Training summary: Average loss: 1.2548, Accuracy: 32063/50000 (64.126%)


Evaluation: Average loss: 1.5836, Accuracy: 5678/10000 (56.780%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 65 [0/50000 (0%)]	Loss: 1.136641 Accuracy: 67/100 (67.000%
Train Epoch: 65 [10000/50000 (20%)]	Loss: 1.100945 Accuracy: 6547/10100 (64.822%
Train Epoch: 65 [20000/50000 (40%)]	Loss: 1.323800 Accuracy: 12925/20100 (64.303%
Train Epoch: 65 [30000/50000 (60%)]	Loss: 1.235561 Accuracy: 19237/30100 (63.910%
Train Epoch: 65 [40000/50000 (80%)]	Loss: 1.390652 Accuracy: 25533/40100 (63.673%
current mest  death_rate 0.12439590636909673


dynamic sparse change prune
to kill 564003.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1166,1166 density 0.6747685185185185,0.6747685185185185
before tensor 4096 mask 643.0 4096
layer1.0.conv1.weight, mask/weight parameters,643,643 density 0.2137632978723404,0.2137632978723404
before tensor 36864 mask 3887.0 36864
layer1.0.conv2.weight, mask/weight parameters,3887,3887 density 0.19551330415975052,0.19551330415975052
before tensor 16384 mask 3953.0 16384
layer1.0.conv3.weight, mask/weight parameters,3953,3953 density 0.3285405585106383,0.3285405585106383
layer1.0.shortcut.0.weight, mask/weight parameters,5343,5343 density 0.32611083984375,0.32611083984375
before tensor 16384 mask 2458.0 16384
layer1.1.conv1.weight, mask/weight parameters,2458,2458 density 0.20428856382978725,0.20428856382978725
before tensor 36864 mask 4117.0 36864
layer1.1.conv2.weight, mask/weight parameters,4117,4117 density 0.20708213872541623,0.20708213872541623
before tensor 16384 mask 2344.0 16384
layer1.1.conv3.weight, mask/weight parameters,2344,2344 density 0.19481382978723405,0.19481382978723405
before tensor 16384 mask 2827.0 16384
layer1.2.conv1.weight, mask/weight parameters,2827,2827 density 0.2349567819148936,0.2349567819148936
before tensor 36864 mask 3083.0 36864
layer1.2.conv2.weight, mask/weight parameters,3083,3083 density 0.15507268246064082,0.15507268246064082
before tensor 16384 mask 1909.0 16384
layer1.2.conv3.weight, mask/weight parameters,1909,1909 density 0.15866023936170212,0.15866023936170212
before tensor 32768 mask 5645.0 32768
layer2.0.conv1.weight, mask/weight parameters,5645,5645 density 0.28270232371794873,0.28270232371794873
before tensor 147456 mask 13378.0 147456
layer2.0.conv2.weight, mask/weight parameters,13378,13378 density 0.24432025714076996,0.24432025714076996
before tensor 65536 mask 7558.0 65536
layer2.0.conv3.weight, mask/weight parameters,7558,7558 density 0.1892528044871795,0.1892528044871795
layer2.0.shortcut.0.weight, mask/weight parameters,30399,30399 density 0.23192596435546875,0.23192596435546875
before tensor 65536 mask 3689.0 65536
layer2.1.conv1.weight, mask/weight parameters,3689,3689 density 0.09237279647435898,0.09237279647435898
before tensor 147456 mask 3819.0 147456
layer2.1.conv2.weight, mask/weight parameters,3819,3819 density 0.06974578128424282,0.06974578128424282
before tensor 65536 mask 3429.0 65536
layer2.1.conv3.weight, mask/weight parameters,3429,3429 density 0.0858623798076923,0.0858623798076923
before tensor 65536 mask 10608.0 65536
layer2.2.conv1.weight, mask/weight parameters,10608,10608 density 0.265625,0.265625
before tensor 147456 mask 21143.0 147456
layer2.2.conv2.weight, mask/weight parameters,21143,21143 density 0.38613120023376435,0.38613120023376435
before tensor 65536 mask 12871.0 65536
layer2.2.conv3.weight, mask/weight parameters,12871,12871 density 0.3222906650641026,0.3222906650641026
before tensor 65536 mask 10377.0 65536
layer2.3.conv1.weight, mask/weight parameters,10377,10377 density 0.2598407451923077,0.2598407451923077
before tensor 147456 mask 19506.0 147456
layer2.3.conv2.weight, mask/weight parameters,19506,19506 density 0.3562349331580101,0.3562349331580101
before tensor 65536 mask 10413.0 65536
layer2.3.conv3.weight, mask/weight parameters,10413,10413 density 0.2607421875,0.2607421875
before tensor 131072 mask 30622.0 131072
layer3.0.conv1.weight, mask/weight parameters,30622,30622 density 0.4182419143356643,0.4182419143356643
before tensor 589824 mask 77880.0 589824
layer3.0.conv2.weight, mask/weight parameters,77880,77880 density 0.42316657701273086,0.42316657701273086
before tensor 262144 mask 59793.0 262144
layer3.0.conv3.weight, mask/weight parameters,59793,59793 density 0.4083328780594406,0.4083328780594406
layer3.0.shortcut.0.weight, mask/weight parameters,101908,101908 density 0.19437408447265625,0.19437408447265625
before tensor 262144 mask 27678.0 262144
layer3.1.conv1.weight, mask/weight parameters,27678,27678 density 0.18901606206293706,0.18901606206293706
before tensor 589824 mask 60600.0 589824
layer3.1.conv2.weight, mask/weight parameters,60600,60600 density 0.329274455148581,0.329274455148581
before tensor 262144 mask 45077.0 262144
layer3.1.conv3.weight, mask/weight parameters,45077,45077 density 0.30783571896853146,0.30783571896853146
before tensor 262144 mask 28684.0 262144
layer3.2.conv1.weight, mask/weight parameters,28684,28684 density 0.1958861451048951,0.1958861451048951
before tensor 589824 mask 55032.0 589824
layer3.2.conv2.weight, mask/weight parameters,55032,55032 density 0.299020326992355,0.299020326992355
before tensor 262144 mask 46324.0 262144
layer3.2.conv3.weight, mask/weight parameters,46324,46324 density 0.31635161713286714,0.31635161713286714
before tensor 262144 mask 29973.0 262144
layer3.3.conv1.weight, mask/weight parameters,29973,29973 density 0.20468886582167833,0.20468886582167833
before tensor 589824 mask 45323.0 589824
layer3.3.conv2.weight, mask/weight parameters,45323,45323 density 0.24626577773430922,0.24626577773430922
before tensor 262144 mask 38459.0 262144
layer3.3.conv3.weight, mask/weight parameters,38459,38459 density 0.26264067963286714,0.26264067963286714
before tensor 262144 mask 33471.0 262144
layer3.4.conv1.weight, mask/weight parameters,33471,33471 density 0.22857708697552448,0.22857708697552448
before tensor 589824 mask 47261.0 589824
layer3.4.conv2.weight, mask/weight parameters,47261,47261 density 0.25679604001282325,0.25679604001282325
before tensor 262144 mask 35110.0 262144
layer3.4.conv3.weight, mask/weight parameters,35110,35110 density 0.23976999562937062,0.23976999562937062
before tensor 262144 mask 38939.0 262144
layer3.5.conv1.weight, mask/weight parameters,38939,38939 density 0.26591865166083917,0.26591865166083917
before tensor 589824 mask 48089.0 589824
layer3.5.conv2.weight, mask/weight parameters,48089,48089 density 0.2612950375188137,0.2612950375188137
before tensor 262144 mask 34717.0 262144
layer3.5.conv3.weight, mask/weight parameters,34717,34717 density 0.23708615603146854,0.23708615603146854
before tensor 524288 mask 131261.0 524288
layer4.0.conv1.weight, mask/weight parameters,131261,131261 density 0.46782689895072993,0.46782689895072993
before tensor 2359296 mask 230595.0 2359296
layer4.0.conv2.weight, mask/weight parameters,230595,230595 density 0.34127639547480776,0.34127639547480776
before tensor 1048576 mask 116530.0 1048576
layer4.0.conv3.weight, mask/weight parameters,116530,116530 density 0.20766209511861314,0.20766209511861314
layer4.0.shortcut.0.weight, mask/weight parameters,167418,167418 density 0.07983112335205078,0.07983112335205078
before tensor 1048576 mask 111130.0 1048576
layer4.1.conv1.weight, mask/weight parameters,111130,111130 density 0.19803903398722628,0.19803903398722628
before tensor 2359296 mask 192503.0 2359296
layer4.1.conv2.weight, mask/weight parameters,192503,192503 density 0.2849009300205421,0.2849009300205421
before tensor 1048576 mask 89236.0 1048576
layer4.1.conv3.weight, mask/weight parameters,89236,89236 density 0.15902286724452555,0.15902286724452555
before tensor 1048576 mask 58176.0 1048576
layer4.2.conv1.weight, mask/weight parameters,58176,58176 density 0.10367244525547445,0.10367244525547445
before tensor 2359296 mask 58375.0 2359296
layer4.2.conv2.weight, mask/weight parameters,58375,58375 density 0.08639393562671308,0.08639393562671308
before tensor 1048576 mask 34646.0 1048576
layer4.2.conv3.weight, mask/weight parameters,34646,34646 density 0.061740847399635035,0.061740847399635035
classifier.weight, mask/weight parameters,105830,105830 density 0.516748046875,0.516748046875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.20534179239252462 0.20534179239252462 after dst
Death rate: 0.12439590636909673

dynamic sparse change grow
self.total_params*pruning_rate 2942215.9581108796
self.total_nonzero 2365205.0
to grow 577010.9581108796
len(all_scores) 11518381 8224152
increse 577010.0 before_mask 2942214.0 after_mask 2942214.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1242,1166 density 0.71875,0.6747685185185185
before tensor 4096 mask 770.0 4096
layer1.0.conv1.weight, mask/weight parameters,770,643 density 0.2559840425531915,0.2137632978723404
before tensor 36864 mask 4561.0 36864
layer1.0.conv2.weight, mask/weight parameters,4561,3887 density 0.22941501936522307,0.19551330415975052
before tensor 16384 mask 4665.0 16384
layer1.0.conv3.weight, mask/weight parameters,4665,3953 density 0.3877160904255319,0.3285405585106383
layer1.0.shortcut.0.weight, mask/weight parameters,6388,5343 density 0.389892578125,0.32611083984375
before tensor 16384 mask 3376.0 16384
layer1.1.conv1.weight, mask/weight parameters,3376,2458 density 0.28058510638297873,0.20428856382978725
before tensor 36864 mask 4707.0 36864
layer1.1.conv2.weight, mask/weight parameters,4707,4117 density 0.23675871435038479,0.20708213872541623
before tensor 16384 mask 2943.0 16384
layer1.1.conv3.weight, mask/weight parameters,2943,2344 density 0.24459773936170212,0.19481382978723405
before tensor 16384 mask 3564.0 16384
layer1.2.conv1.weight, mask/weight parameters,3564,2827 density 0.29621010638297873,0.2349567819148936
before tensor 36864 mask 3719.0 36864
layer1.2.conv2.weight, mask/weight parameters,3719,3083 density 0.18706302499874253,0.15507268246064082
before tensor 16384 mask 2447.0 16384
layer1.2.conv3.weight, mask/weight parameters,2447,1909 density 0.20337433510638298,0.15866023936170212
before tensor 32768 mask 7269.0 32768
layer2.0.conv1.weight, mask/weight parameters,7269,5645 density 0.3640324519230769,0.28270232371794873
before tensor 147456 mask 15507.0 147456
layer2.0.conv2.weight, mask/weight parameters,15507,13378 density 0.28320184089414857,0.24432025714076996
before tensor 65536 mask 8883.0 65536
layer2.0.conv3.weight, mask/weight parameters,8883,7558 density 0.22243088942307693,0.1892528044871795
layer2.0.shortcut.0.weight, mask/weight parameters,38700,30399 density 0.295257568359375,0.23192596435546875
before tensor 65536 mask 5469.0 65536
layer2.1.conv1.weight, mask/weight parameters,5469,3689 density 0.13694411057692307,0.09237279647435898
before tensor 147456 mask 4907.0 147456
layer2.1.conv2.weight, mask/weight parameters,4907,3819 density 0.08961574987216013,0.06974578128424282
before tensor 65536 mask 5163.0 65536
layer2.1.conv3.weight, mask/weight parameters,5163,3429 density 0.12928185096153846,0.0858623798076923
before tensor 65536 mask 12709.0 65536
layer2.2.conv1.weight, mask/weight parameters,12709,10608 density 0.31823417467948717,0.265625
before tensor 147456 mask 25623.0 147456
layer2.2.conv2.weight, mask/weight parameters,25623,21143 density 0.46794871794871795,0.38613120023376435
before tensor 65536 mask 16408.0 65536
layer2.2.conv3.weight, mask/weight parameters,16408,12871 density 0.4108573717948718,0.3222906650641026
before tensor 65536 mask 13135.0 65536
layer2.3.conv1.weight, mask/weight parameters,13135,10377 density 0.32890124198717946,0.2598407451923077
before tensor 147456 mask 23567.0 147456
layer2.3.conv2.weight, mask/weight parameters,23567,19506 density 0.43040032142596246,0.3562349331580101
before tensor 65536 mask 12736.0 65536
layer2.3.conv3.weight, mask/weight parameters,12736,10413 density 0.3189102564102564,0.2607421875
before tensor 131072 mask 37774.0 131072
layer3.0.conv1.weight, mask/weight parameters,37774,30622 density 0.5159254807692307,0.4182419143356643
before tensor 589824 mask 93333.0 589824
layer3.0.conv2.weight, mask/weight parameters,93333,77880 density 0.507131563075619,0.42316657701273086
before tensor 262144 mask 70034.0 262144
layer3.0.conv3.weight, mask/weight parameters,70034,59793 density 0.4782697770979021,0.4083328780594406
layer3.0.shortcut.0.weight, mask/weight parameters,129341,101908 density 0.24669837951660156,0.19437408447265625
before tensor 262144 mask 35356.0 262144
layer3.1.conv1.weight, mask/weight parameters,35356,27678 density 0.2414499562937063,0.18901606206293706
before tensor 589824 mask 76108.0 589824
layer3.1.conv2.weight, mask/weight parameters,76108,60600 density 0.4135382876641618,0.329274455148581
before tensor 262144 mask 55874.0 262144
layer3.1.conv3.weight, mask/weight parameters,55874,45077 density 0.3815696022727273,0.30783571896853146
before tensor 262144 mask 37332.0 262144
layer3.2.conv1.weight, mask/weight parameters,37332,28684 density 0.2549442744755245,0.1958861451048951
before tensor 589824 mask 67586.0 589824
layer3.2.conv2.weight, mask/weight parameters,67586,55032 density 0.3672333882124092,0.299020326992355
before tensor 262144 mask 56701.0 262144
layer3.2.conv3.weight, mask/weight parameters,56701,46324 density 0.3872172749125874,0.31635161713286714
before tensor 262144 mask 40492.0 262144
layer3.3.conv1.weight, mask/weight parameters,40492,29973 density 0.276524256993007,0.20468886582167833
before tensor 589824 mask 55880.0 589824
layer3.3.conv2.weight, mask/weight parameters,55880,45323 density 0.30362799593568823,0.24626577773430922
before tensor 262144 mask 46780.0 262144
layer3.3.conv3.weight, mask/weight parameters,46780,38459 density 0.3194656905594406,0.26264067963286714
before tensor 262144 mask 40811.0 262144
layer3.4.conv1.weight, mask/weight parameters,40811,33471 density 0.27870274256993005,0.22857708697552448
before tensor 589824 mask 56552.0 589824
layer3.4.conv2.weight, mask/weight parameters,56552,47261 density 0.3072793562304052,0.25679604001282325
before tensor 262144 mask 43496.0 262144
layer3.4.conv3.weight, mask/weight parameters,43496,35110 density 0.2970388986013986,0.23976999562937062
before tensor 262144 mask 49356.0 262144
layer3.5.conv1.weight, mask/weight parameters,49356,38939 density 0.3370574737762238,0.26591865166083917
before tensor 589824 mask 58897.0 589824
layer3.5.conv2.weight, mask/weight parameters,58897,48089 density 0.3200210822588445,0.2612950375188137
before tensor 262144 mask 42656.0 262144
layer3.5.conv3.weight, mask/weight parameters,42656,34717 density 0.29130244755244755,0.23708615603146854
before tensor 524288 mask 153591.0 524288
layer4.0.conv1.weight, mask/weight parameters,153591,131261 density 0.5474131786040146,0.46782689895072993
before tensor 2359296 mask 278568.0 2359296
layer4.0.conv2.weight, mask/weight parameters,278568,230595 density 0.41227556076509136,0.34127639547480776
before tensor 1048576 mask 146756.0 1048576
layer4.0.conv3.weight, mask/weight parameters,146756,116530 density 0.2615262887773723,0.20766209511861314
layer4.0.shortcut.0.weight, mask/weight parameters,226332,167418 density 0.10792350769042969,0.07983112335205078
before tensor 1048576 mask 136381.0 1048576
layer4.1.conv1.weight, mask/weight parameters,136381,111130 density 0.24303753706660583,0.19803903398722628
before tensor 2359296 mask 234071.0 2359296
layer4.1.conv2.weight, mask/weight parameters,234071,192503 density 0.346420812095595,0.2849009300205421
before tensor 1048576 mask 116639.0 1048576
layer4.1.conv3.weight, mask/weight parameters,116639,89236 density 0.20785633838959855,0.15902286724452555
before tensor 1048576 mask 79918.0 1048576
layer4.2.conv1.weight, mask/weight parameters,79918,58176 density 0.1424177406478102,0.10367244525547445
before tensor 2359296 mask 83630.0 2359296
layer4.2.conv2.weight, mask/weight parameters,83630,58375 density 0.12377087514281825,0.08639393562671308
before tensor 1048576 mask 48296.0 1048576
layer4.2.conv3.weight, mask/weight parameters,48296,34646 density 0.08606580748175183,0.061740847399635035
classifier.weight, mask/weight parameters,115215,105830 density 0.5625732421875,0.516748046875
Total Model parameters after dst: 2942214 2365205
Total parameters under density level of 0.1: 0.25543641940651207 0.20534179239252462 after dst
Death rate: 0.12439590636909673


Training summary: Average loss: 1.2646, Accuracy: 31767/50000 (63.534%)


Evaluation: Average loss: 1.7818, Accuracy: 5445/10000 (54.450%)

Current learning rate: 0.1. Time taken for epoch: 88.74 seconds.

Train Epoch: 66 [0/50000 (0%)]	Loss: 1.598312 Accuracy: 55/100 (55.000%
Train Epoch: 66 [10000/50000 (20%)]	Loss: 1.264328 Accuracy: 6573/10100 (65.079%
Train Epoch: 66 [20000/50000 (40%)]	Loss: 1.364807 Accuracy: 12922/20100 (64.289%
Train Epoch: 66 [30000/50000 (60%)]	Loss: 1.133644 Accuracy: 19323/30100 (64.196%
Train Epoch: 66 [40000/50000 (80%)]	Loss: 1.117599 Accuracy: 25662/40100 (63.995%
current layer rate 0.4430935366408739
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4266.0
Total filter_masks items: 8542957.0
4266.0 / 7552 channels
Total channels to prune: 60.24238871188027
Layer ('layer2', 0, 'conv1'): Pruned 1/78.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/78.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/78.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/78.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/78.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/78.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/78.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/78.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 2/143.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 2/143.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 2/143.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 2/143.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 2/143.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 2/143.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 2/143.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 2/143.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 2/143.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 2/143.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 2/143.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 2/143.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 3/274.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 3/274.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 3/274.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 3/274.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 3/274.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 3/274.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4216.0
Total filter_masks items: 8401376.0
After apply_mask:
Total filter_names items: 4216.0
Total filter_masks items: 8401376.0
Total pruned: 50/60.24238871188027 channels
===========done ===============

Training summary: Average loss: 1.2562, Accuracy: 31910/50000 (63.820%)


Evaluation: Average loss: 1.6616, Accuracy: 5509/10000 (55.090%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 67 [0/50000 (0%)]	Loss: 1.228270 Accuracy: 65/100 (65.000%
Train Epoch: 67 [10000/50000 (20%)]	Loss: 1.549053 Accuracy: 6582/10100 (65.168%
Train Epoch: 67 [20000/50000 (40%)]	Loss: 1.354727 Accuracy: 12954/20100 (64.448%
Train Epoch: 67 [30000/50000 (60%)]	Loss: 1.239711 Accuracy: 19341/30100 (64.256%
Train Epoch: 67 [40000/50000 (80%)]	Loss: 1.406413 Accuracy: 25745/40100 (64.202%
current mest  death_rate 0.1231891299959558


dynamic sparse change prune
to kill 523316.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1169,1169 density 0.6765046296296297,0.6765046296296297
before tensor 4096 mask 671.0 4096
layer1.0.conv1.weight, mask/weight parameters,671,671 density 0.2230718085106383,0.2230718085106383
before tensor 36864 mask 3903.0 36864
layer1.0.conv2.weight, mask/weight parameters,3903,3903 density 0.1963180926512751,0.1963180926512751
before tensor 16384 mask 3901.0 16384
layer1.0.conv3.weight, mask/weight parameters,3901,3901 density 0.32421875,0.32421875
layer1.0.shortcut.0.weight, mask/weight parameters,5494,5494 density 0.3353271484375,0.3353271484375
before tensor 16384 mask 2679.0 16384
layer1.1.conv1.weight, mask/weight parameters,2679,2679 density 0.22265625,0.22265625
before tensor 36864 mask 4188.0 36864
layer1.1.conv2.weight, mask/weight parameters,4188,4188 density 0.2106533876565565,0.2106533876565565
before tensor 16384 mask 2404.0 16384
layer1.1.conv3.weight, mask/weight parameters,2404,2404 density 0.1998005319148936,0.1998005319148936
before tensor 16384 mask 2867.0 16384
layer1.2.conv1.weight, mask/weight parameters,2867,2867 density 0.23828125,0.23828125
before tensor 36864 mask 3217.0 36864
layer1.2.conv2.weight, mask/weight parameters,3217,3217 density 0.1618127860771591,0.1618127860771591
before tensor 16384 mask 2000.0 16384
layer1.2.conv3.weight, mask/weight parameters,2000,2000 density 0.16622340425531915,0.16622340425531915
before tensor 32768 mask 5655.0 32768
layer2.0.conv1.weight, mask/weight parameters,5655,5655 density 0.28688108766233766,0.28688108766233766
before tensor 147456 mask 13119.0 147456
layer2.0.conv2.weight, mask/weight parameters,13119,13119 density 0.24585371338618092,0.24585371338618092
before tensor 65536 mask 7391.0 65536
layer2.0.conv3.weight, mask/weight parameters,7391,7391 density 0.18747463474025974,0.18747463474025974
layer2.0.shortcut.0.weight, mask/weight parameters,30884,30884 density 0.235626220703125,0.235626220703125
before tensor 65536 mask 4049.0 65536
layer2.1.conv1.weight, mask/weight parameters,4049,4049 density 0.1027039366883117,0.1027039366883117
before tensor 147456 mask 3997.0 147456
layer2.1.conv2.weight, mask/weight parameters,3997,3997 density 0.07490489308671126,0.07490489308671126
before tensor 65536 mask 4112.0 65536
layer2.1.conv3.weight, mask/weight parameters,4112,4112 density 0.10430194805194805,0.10430194805194805
before tensor 65536 mask 10551.0 65536
layer2.2.conv1.weight, mask/weight parameters,10551,10551 density 0.2676288555194805,0.2676288555194805
before tensor 147456 mask 21259.0 147456
layer2.2.conv2.weight, mask/weight parameters,21259,21259 density 0.39839958021776206,0.39839958021776206
before tensor 65536 mask 13457.0 65536
layer2.2.conv3.weight, mask/weight parameters,13457,13457 density 0.3413403003246753,0.3413403003246753
before tensor 65536 mask 10707.0 65536
layer2.3.conv1.weight, mask/weight parameters,10707,10707 density 0.271585836038961,0.271585836038961
before tensor 147456 mask 19747.0 147456
layer2.3.conv2.weight, mask/weight parameters,19747,19747 density 0.37006427915518825,0.37006427915518825
before tensor 65536 mask 10339.0 65536
layer2.3.conv3.weight, mask/weight parameters,10339,10339 density 0.26225142045454547,0.26225142045454547
before tensor 131072 mask 31274.0 131072
layer3.0.conv1.weight, mask/weight parameters,31274,31274 density 0.4332058953900709,0.4332058953900709
before tensor 589824 mask 77066.0 589824
layer3.0.conv2.weight, mask/weight parameters,77066,77066 density 0.4307071519988375,0.4307071519988375
before tensor 262144 mask 59101.0 262144
layer3.0.conv3.weight, mask/weight parameters,59101,59101 density 0.40933205895390073,0.40933205895390073
layer3.0.shortcut.0.weight, mask/weight parameters,103562,103562 density 0.19752883911132812,0.19752883911132812
before tensor 262144 mask 28110.0 262144
layer3.1.conv1.weight, mask/weight parameters,28110,28110 density 0.19468916223404256,0.19468916223404256
before tensor 589824 mask 60361.0 589824
layer3.1.conv2.weight, mask/weight parameters,60361,60361 density 0.33734609817301836,0.33734609817301836
before tensor 262144 mask 45502.0 262144
layer3.1.conv3.weight, mask/weight parameters,45502,45502 density 0.3151457225177305,0.3151457225177305
before tensor 262144 mask 29576.0 262144
layer3.2.conv1.weight, mask/weight parameters,29576,29576 density 0.20484264184397163,0.20484264184397163
before tensor 589824 mask 54318.0 589824
layer3.2.conv2.weight, mask/weight parameters,54318,54318 density 0.303572925573831,0.303572925573831
before tensor 262144 mask 46350.0 262144
layer3.2.conv3.weight, mask/weight parameters,46350,46350 density 0.3210189494680851,0.3210189494680851
before tensor 262144 mask 31813.0 262144
layer3.3.conv1.weight, mask/weight parameters,31813,31813 density 0.22033604831560283,0.22033604831560283
before tensor 589824 mask 44856.0 589824
layer3.3.conv2.weight, mask/weight parameters,44856,44856 density 0.25069161510990395,0.25069161510990395
before tensor 262144 mask 37925.0 262144
layer3.3.conv3.weight, mask/weight parameters,37925,37925 density 0.2626676085992908,0.2626676085992908
before tensor 262144 mask 32785.0 262144
layer3.4.conv1.weight, mask/weight parameters,32785,32785 density 0.22706809618794327,0.22706809618794327
before tensor 589824 mask 45442.0 589824
layer3.4.conv2.weight, mask/weight parameters,45442,45442 density 0.25396665716569145,0.25396665716569145
before tensor 262144 mask 34982.0 262144
layer3.4.conv3.weight, mask/weight parameters,34982,34982 density 0.24228446365248227,0.24228446365248227
before tensor 262144 mask 39695.0 262144
layer3.5.conv1.weight, mask/weight parameters,39695,39695 density 0.2749265846631206,0.2749265846631206
before tensor 589824 mask 47534.0 589824
layer3.5.conv2.weight, mask/weight parameters,47534,47534 density 0.2656584455286734,0.2656584455286734
before tensor 262144 mask 34640.0 262144
layer3.5.conv3.weight, mask/weight parameters,34640,34640 density 0.23991578014184398,0.23991578014184398
before tensor 524288 mask 131287.0 524288
layer4.0.conv1.weight, mask/weight parameters,131287,131287 density 0.4730994868542435,0.4730994868542435
before tensor 2359296 mask 226451.0 2359296
layer4.0.conv2.weight, mask/weight parameters,226451,226451 density 0.34260456995713867,0.34260456995713867
before tensor 1048576 mask 115026.0 1048576
layer4.0.conv3.weight, mask/weight parameters,115026,115026 density 0.2072510666512915,0.2072510666512915
layer4.0.shortcut.0.weight, mask/weight parameters,167987,167987 density 0.08010244369506836,0.08010244369506836
before tensor 1048576 mask 109809.0 1048576
layer4.1.conv1.weight, mask/weight parameters,109809,109809 density 0.19785120214483395,0.19785120214483395
before tensor 2359296 mask 190107.0 2359296
layer4.1.conv2.weight, mask/weight parameters,190107,190107 density 0.28761863264389104,0.28761863264389104
before tensor 1048576 mask 90270.0 1048576
layer4.1.conv3.weight, mask/weight parameters,90270,90270 density 0.16264630419741696,0.16264630419741696
before tensor 1048576 mask 59468.0 1048576
layer4.2.conv1.weight, mask/weight parameters,59468,59468 density 0.10714800507380073,0.10714800507380073
before tensor 2359296 mask 60449.0 2359296
layer4.2.conv2.weight, mask/weight parameters,60449,60449 density 0.09145512119327835,0.09145512119327835
before tensor 1048576 mask 35438.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35438,35438 density 0.06385133187269372,0.06385133187269372
classifier.weight, mask/weight parameters,106261,106261 density 0.5188525390625,0.5188525390625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.20789721186977006 0.20789721186977006 after dst
Death rate: 0.1231891299959558

dynamic sparse change grow
self.total_params*pruning_rate 2913673.2447165065
self.total_nonzero 2365205.0
to grow 548468.2447165065
len(all_scores) 11376800 8063651
increse 548468.0 before_mask 2913672.0 after_mask 2913672.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1231,1169 density 0.7123842592592593,0.6765046296296297
before tensor 4096 mask 743.0 4096
layer1.0.conv1.weight, mask/weight parameters,743,671 density 0.24700797872340424,0.2230718085106383
before tensor 36864 mask 4420.0 36864
layer1.0.conv2.weight, mask/weight parameters,4420,3903 density 0.2223228207836628,0.1963180926512751
before tensor 16384 mask 4670.0 16384
layer1.0.conv3.weight, mask/weight parameters,4670,3901 density 0.3881316489361702,0.32421875
layer1.0.shortcut.0.weight, mask/weight parameters,6331,5494 density 0.38641357421875,0.3353271484375
before tensor 16384 mask 2982.0 16384
layer1.1.conv1.weight, mask/weight parameters,2982,2679 density 0.24783909574468085,0.22265625
before tensor 36864 mask 4859.0 36864
layer1.1.conv2.weight, mask/weight parameters,4859,4188 density 0.2444042050198682,0.2106533876565565
before tensor 16384 mask 3101.0 16384
layer1.1.conv3.weight, mask/weight parameters,3101,2404 density 0.25772938829787234,0.1998005319148936
before tensor 16384 mask 3623.0 16384
layer1.2.conv1.weight, mask/weight parameters,3623,2867 density 0.30111369680851063,0.23828125
before tensor 36864 mask 3710.0 36864
layer1.2.conv2.weight, mask/weight parameters,3710,3217 density 0.18661033147225994,0.1618127860771591
before tensor 16384 mask 2435.0 16384
layer1.2.conv3.weight, mask/weight parameters,2435,2000 density 0.20237699468085107,0.16622340425531915
before tensor 32768 mask 6906.0 32768
layer2.0.conv1.weight, mask/weight parameters,6906,5655 density 0.3503449675324675,0.28688108766233766
before tensor 147456 mask 14770.0 147456
layer2.0.conv2.weight, mask/weight parameters,14770,13119 density 0.27679391315754953,0.24585371338618092
before tensor 65536 mask 8572.0 65536
layer2.0.conv3.weight, mask/weight parameters,8572,7391 density 0.2174310064935065,0.18747463474025974
layer2.0.shortcut.0.weight, mask/weight parameters,39215,30884 density 0.29918670654296875,0.235626220703125
before tensor 65536 mask 4985.0 65536
layer2.1.conv1.weight, mask/weight parameters,4985,4049 density 0.12644581980519481,0.1027039366883117
before tensor 147456 mask 5134.0 147456
layer2.1.conv2.weight, mask/weight parameters,5134,3997 density 0.09621258971908322,0.07490489308671126
before tensor 65536 mask 5035.0 65536
layer2.1.conv3.weight, mask/weight parameters,5035,4112 density 0.1277140827922078,0.10430194805194805
before tensor 65536 mask 12292.0 65536
layer2.2.conv1.weight, mask/weight parameters,12292,10551 density 0.3117897727272727,0.2676288555194805
before tensor 147456 mask 24335.0 147456
layer2.2.conv2.weight, mask/weight parameters,24335,21259 density 0.4560446768238976,0.39839958021776206
before tensor 65536 mask 15664.0 65536
layer2.2.conv3.weight, mask/weight parameters,15664,13457 density 0.39732142857142855,0.3413403003246753
before tensor 65536 mask 12426.0 65536
layer2.3.conv1.weight, mask/weight parameters,12426,10707 density 0.3151887175324675,0.271585836038961
before tensor 147456 mask 22320.0 147456
layer2.3.conv2.weight, mask/weight parameters,22320,19747 density 0.4182830156856131,0.37006427915518825
before tensor 65536 mask 12507.0 65536
layer2.3.conv3.weight, mask/weight parameters,12507,10339 density 0.31724330357142855,0.26225142045454547
before tensor 131072 mask 36533.0 131072
layer3.0.conv1.weight, mask/weight parameters,36533,31274 density 0.5060533023049646,0.4332058953900709
before tensor 589824 mask 89020.0 589824
layer3.0.conv2.weight, mask/weight parameters,89020,77066 density 0.4975157744133148,0.4307071519988375
before tensor 262144 mask 68572.0 262144
layer3.0.conv3.weight, mask/weight parameters,68572,59101 density 0.47492796985815605,0.40933205895390073
layer3.0.shortcut.0.weight, mask/weight parameters,128718,103562 density 0.24551010131835938,0.19752883911132812
before tensor 262144 mask 33994.0 262144
layer3.1.conv1.weight, mask/weight parameters,33994,28110 density 0.23544160017730498,0.19468916223404256
before tensor 589824 mask 73118.0 589824
layer3.1.conv2.weight, mask/weight parameters,73118,60361 density 0.4086425341895389,0.33734609817301836
before tensor 262144 mask 54722.0 262144
layer3.1.conv3.weight, mask/weight parameters,54722,45502 density 0.3790032136524823,0.3151457225177305
before tensor 262144 mask 35935.0 262144
layer3.2.conv1.weight, mask/weight parameters,35935,29576 density 0.2488849179964539,0.20484264184397163
before tensor 589824 mask 64939.0 589824
layer3.2.conv2.weight, mask/weight parameters,64939,54318 density 0.362931665632737,0.303572925573831
before tensor 262144 mask 54752.0 262144
layer3.2.conv3.weight, mask/weight parameters,54752,46350 density 0.3792109929078014,0.3210189494680851
before tensor 262144 mask 37912.0 262144
layer3.3.conv1.weight, mask/weight parameters,37912,31813 density 0.2625775709219858,0.22033604831560283
before tensor 589824 mask 54566.0 589824
layer3.3.conv2.weight, mask/weight parameters,54566,44856 density 0.3049589501981233,0.25069161510990395
before tensor 262144 mask 46884.0 262144
layer3.3.conv3.weight, mask/weight parameters,46884,37925 density 0.32471742021276595,0.2626676085992908
before tensor 262144 mask 40622.0 262144
layer3.4.conv1.weight, mask/weight parameters,40622,32785 density 0.2813469636524823,0.22706809618794327
before tensor 589824 mask 56204.0 589824
layer3.4.conv2.weight, mask/weight parameters,56204,45442 density 0.31411341928921527,0.25396665716569145
before tensor 262144 mask 43076.0 262144
layer3.4.conv3.weight, mask/weight parameters,43076,34982 density 0.29834330673758863,0.24228446365248227
before tensor 262144 mask 48940.0 262144
layer3.5.conv1.weight, mask/weight parameters,48940,39695 density 0.338957225177305,0.2749265846631206
before tensor 589824 mask 59324.0 589824
layer3.5.conv2.weight, mask/weight parameters,59324,47534 density 0.33155050327224767,0.2656584455286734
before tensor 262144 mask 42667.0 262144
layer3.5.conv3.weight, mask/weight parameters,42667,34640 density 0.2955105828900709,0.23991578014184398
before tensor 524288 mask 152770.0 524288
layer4.0.conv1.weight, mask/weight parameters,152770,131287 density 0.5505145871771218,0.4730994868542435
before tensor 2359296 mask 277158.0 2359296
layer4.0.conv2.weight, mask/weight parameters,277158,226451 density 0.41932072457255937,0.34260456995713867
before tensor 1048576 mask 148117.0 1048576
layer4.0.conv3.weight, mask/weight parameters,148117,115026 density 0.266873630650369,0.2072510666512915
layer4.0.shortcut.0.weight, mask/weight parameters,225313,167987 density 0.1074376106262207,0.08010244369506836
before tensor 1048576 mask 139056.0 1048576
layer4.1.conv1.weight, mask/weight parameters,139056,109809 density 0.25054773985239853,0.19785120214483395
before tensor 2359296 mask 233473.0 2359296
layer4.1.conv2.weight, mask/weight parameters,233473,190107 density 0.3532283662320018,0.28761863264389104
before tensor 1048576 mask 117491.0 1048576
layer4.1.conv3.weight, mask/weight parameters,117491,90270 density 0.21169244407287824,0.16264630419741696
before tensor 1048576 mask 81925.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81925,59468 density 0.14761048489391143,0.10714800507380073
before tensor 2359296 mask 83306.0 2359296
layer4.2.conv2.weight, mask/weight parameters,83306,60449 density 0.1260361681107586,0.09145512119327835
before tensor 1048576 mask 47835.0 1048576
layer4.2.conv3.weight, mask/weight parameters,47835,35438 density 0.0861879468404059,0.06385133187269372
classifier.weight, mask/weight parameters,114464,106261 density 0.55890625,0.5188525390625
Total Model parameters after dst: 2913672 2365205
Total parameters under density level of 0.1: 0.25610646227410166 0.20789721186977006 after dst
Death rate: 0.1231891299959558


Training summary: Average loss: 1.2582, Accuracy: 31981/50000 (63.962%)


Evaluation: Average loss: 1.5571, Accuracy: 5770/10000 (57.700%)

Current learning rate: 0.1. Time taken for epoch: 88.73 seconds.

Train Epoch: 68 [0/50000 (0%)]	Loss: 1.033792 Accuracy: 70/100 (70.000%
Train Epoch: 68 [10000/50000 (20%)]	Loss: 1.483560 Accuracy: 6535/10100 (64.703%
Train Epoch: 68 [20000/50000 (40%)]	Loss: 1.061184 Accuracy: 12943/20100 (64.393%
Train Epoch: 68 [30000/50000 (60%)]	Loss: 1.204216 Accuracy: 19362/30100 (64.326%
Train Epoch: 68 [40000/50000 (80%)]	Loss: 1.258566 Accuracy: 25638/40100 (63.935%
current layer rate 0.44834296768320436
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4216.0
Total filter_masks items: 8401376.0
4216.0 / 7552 channels
Total channels to prune: 49.88609194355922
Layer ('layer3', 0, 'conv1'): Pruned 1/141.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/141.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/141.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/141.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/141.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/141.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/141.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/141.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/141.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/141.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/141.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/141.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 3/271.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 3/271.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 3/271.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 3/271.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 3/271.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 3/271.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4186.0
Total filter_masks items: 8296975.0
After apply_mask:
Total filter_names items: 4186.0
Total filter_masks items: 8296975.0
Total pruned: 30/49.88609194355922 channels
===========done ===============

Training summary: Average loss: 1.2542, Accuracy: 31964/50000 (63.928%)


Evaluation: Average loss: 1.5887, Accuracy: 5726/10000 (57.260%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 69 [0/50000 (0%)]	Loss: 0.916028 Accuracy: 75/100 (75.000%
Train Epoch: 69 [10000/50000 (20%)]	Loss: 1.343359 Accuracy: 6519/10100 (64.545%
Train Epoch: 69 [20000/50000 (40%)]	Loss: 1.131032 Accuracy: 13017/20100 (64.761%
Train Epoch: 69 [30000/50000 (60%)]	Loss: 1.135066 Accuracy: 19419/30100 (64.515%
Train Epoch: 69 [40000/50000 (80%)]	Loss: 1.508838 Accuracy: 25775/40100 (64.277%
current mest  death_rate 0.12198658299361671


dynamic sparse change prune
to kill 510822.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1165,1165 density 0.6741898148148148,0.6741898148148148
before tensor 4096 mask 672.0 4096
layer1.0.conv1.weight, mask/weight parameters,672,672 density 0.22340425531914893,0.22340425531914893
before tensor 36864 mask 3797.0 36864
layer1.0.conv2.weight, mask/weight parameters,3797,3797 density 0.1909863688949248,0.1909863688949248
before tensor 16384 mask 3930.0 16384
layer1.0.conv3.weight, mask/weight parameters,3930,3930 density 0.32662898936170215,0.32662898936170215
layer1.0.shortcut.0.weight, mask/weight parameters,5542,5542 density 0.3382568359375,0.3382568359375
before tensor 16384 mask 2514.0 16384
layer1.1.conv1.weight, mask/weight parameters,2514,2514 density 0.20894281914893617,0.20894281914893617
before tensor 36864 mask 4258.0 36864
layer1.1.conv2.weight, mask/weight parameters,4258,4258 density 0.21417433730697652,0.21417433730697652
before tensor 16384 mask 2407.0 16384
layer1.1.conv3.weight, mask/weight parameters,2407,2407 density 0.20004986702127658,0.20004986702127658
before tensor 16384 mask 3034.0 16384
layer1.2.conv1.weight, mask/weight parameters,3034,3034 density 0.2521609042553192,0.2521609042553192
before tensor 36864 mask 3226.0 36864
layer1.2.conv2.weight, mask/weight parameters,3226,3226 density 0.16226547960364165,0.16226547960364165
before tensor 16384 mask 1991.0 16384
layer1.2.conv3.weight, mask/weight parameters,1991,1991 density 0.16547539893617022,0.16547539893617022
before tensor 32768 mask 5576.0 32768
layer2.0.conv1.weight, mask/weight parameters,5576,5576 density 0.28287337662337664,0.28287337662337664
before tensor 147456 mask 13061.0 147456
layer2.0.conv2.weight, mask/weight parameters,13061,13061 density 0.2447667772343097,0.2447667772343097
before tensor 65536 mask 7247.0 65536
layer2.0.conv3.weight, mask/weight parameters,7247,7247 density 0.18382203733766234,0.18382203733766234
layer2.0.shortcut.0.weight, mask/weight parameters,31224,31224 density 0.23822021484375,0.23822021484375
before tensor 65536 mask 3967.0 65536
layer2.1.conv1.weight, mask/weight parameters,3967,3967 density 0.10062398538961038,0.10062398538961038
before tensor 147456 mask 4308.0 147456
layer2.1.conv2.weight, mask/weight parameters,4308,4308 density 0.08073311969415865,0.08073311969415865
before tensor 65536 mask 4125.0 65536
layer2.1.conv3.weight, mask/weight parameters,4125,4125 density 0.10463169642857142,0.10463169642857142
before tensor 65536 mask 10537.0 65536
layer2.2.conv1.weight, mask/weight parameters,10537,10537 density 0.26727374188311687,0.26727374188311687
before tensor 147456 mask 21032.0 147456
layer2.2.conv2.weight, mask/weight parameters,21032,21032 density 0.39414553700267985,0.39414553700267985
before tensor 65536 mask 13075.0 65536
layer2.2.conv3.weight, mask/weight parameters,13075,13075 density 0.3316507711038961,0.3316507711038961
before tensor 65536 mask 10630.0 65536
layer2.3.conv1.weight, mask/weight parameters,10630,10630 density 0.269632711038961,0.269632711038961
before tensor 147456 mask 19646.0 147456
layer2.3.conv2.weight, mask/weight parameters,19646,19646 density 0.36817151102865386,0.36817151102865386
before tensor 65536 mask 10512.0 65536
layer2.3.conv3.weight, mask/weight parameters,10512,10512 density 0.26663961038961037,0.26663961038961037
before tensor 131072 mask 30692.0 131072
layer3.0.conv1.weight, mask/weight parameters,30692,30692 density 0.42818080357142857,0.42818080357142857
before tensor 589824 mask 74933.0 589824
layer3.0.conv2.weight, mask/weight parameters,74933,74933 density 0.42479024943310656,0.42479024943310656
before tensor 262144 mask 58656.0 262144
layer3.0.conv3.weight, mask/weight parameters,58656,58656 density 0.40915178571428573,0.40915178571428573
layer3.0.shortcut.0.weight, mask/weight parameters,103968,103968 density 0.19830322265625,0.19830322265625
before tensor 262144 mask 27813.0 262144
layer3.1.conv1.weight, mask/weight parameters,27813,27813 density 0.19400809151785714,0.19400809151785714
before tensor 589824 mask 59955.0 589824
layer3.1.conv2.weight, mask/weight parameters,59955,59955 density 0.3398809523809524,0.3398809523809524
before tensor 262144 mask 45371.0 262144
layer3.1.conv3.weight, mask/weight parameters,45371,45371 density 0.3164829799107143,0.3164829799107143
before tensor 262144 mask 29366.0 262144
layer3.2.conv1.weight, mask/weight parameters,29366,29366 density 0.20484095982142858,0.20484095982142858
before tensor 589824 mask 54121.0 589824
layer3.2.conv2.weight, mask/weight parameters,54121,54121 density 0.30680839002267574,0.30680839002267574
before tensor 262144 mask 45745.0 262144
layer3.2.conv3.weight, mask/weight parameters,45745,45745 density 0.319091796875,0.319091796875
before tensor 262144 mask 30704.0 262144
layer3.3.conv1.weight, mask/weight parameters,30704,30704 density 0.21417410714285715,0.21417410714285715
before tensor 589824 mask 44639.0 589824
layer3.3.conv2.weight, mask/weight parameters,44639,44639 density 0.25305555555555553,0.25305555555555553
before tensor 262144 mask 38362.0 262144
layer3.3.conv3.weight, mask/weight parameters,38362,38362 density 0.26759207589285716,0.26759207589285716
before tensor 262144 mask 32956.0 262144
layer3.4.conv1.weight, mask/weight parameters,32956,32956 density 0.2298828125,0.2298828125
before tensor 589824 mask 46246.0 589824
layer3.4.conv2.weight, mask/weight parameters,46246,46246 density 0.2621655328798186,0.2621655328798186
before tensor 262144 mask 35308.0 262144
layer3.4.conv3.weight, mask/weight parameters,35308,35308 density 0.2462890625,0.2462890625
before tensor 262144 mask 39915.0 262144
layer3.5.conv1.weight, mask/weight parameters,39915,39915 density 0.27842494419642855,0.27842494419642855
before tensor 589824 mask 48665.0 589824
layer3.5.conv2.weight, mask/weight parameters,48665,48665 density 0.27587868480725625,0.27587868480725625
before tensor 262144 mask 34953.0 262144
layer3.5.conv3.weight, mask/weight parameters,34953,34953 density 0.24381277901785714,0.24381277901785714
before tensor 524288 mask 130384.0 524288
layer4.0.conv1.weight, mask/weight parameters,130384,130384 density 0.47510494402985076,0.47510494402985076
before tensor 2359296 mask 225677.0 2359296
layer4.0.conv2.weight, mask/weight parameters,225677,225677 density 0.3491203806836464,0.3491203806836464
before tensor 1048576 mask 115816.0 1048576
layer4.0.conv3.weight, mask/weight parameters,115816,115816 density 0.21101037779850745,0.21101037779850745
layer4.0.shortcut.0.weight, mask/weight parameters,168073,168073 density 0.08014345169067383,0.08014345169067383
before tensor 1048576 mask 111489.0 1048576
layer4.1.conv1.weight, mask/weight parameters,111489,111489 density 0.20312682194496268,0.20312682194496268
before tensor 2359296 mask 189757.0 2359296
layer4.1.conv2.weight, mask/weight parameters,189757,189757 density 0.29355244919680207,0.29355244919680207
before tensor 1048576 mask 90576.0 1048576
layer4.1.conv3.weight, mask/weight parameters,90576,90576 density 0.1650244869402985,0.1650244869402985
before tensor 1048576 mask 61306.0 1048576
layer4.2.conv1.weight, mask/weight parameters,61306,61306 density 0.11169615788246269,0.11169615788246269
before tensor 2359296 mask 60904.0 2359296
layer4.2.conv2.weight, mask/weight parameters,60904,60904 density 0.09421796490185887,0.09421796490185887
before tensor 1048576 mask 35315.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35315,35315 density 0.06434198635727612,0.06434198635727612
classifier.weight, mask/weight parameters,106064,106064 density 0.517890625,0.517890625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.2098226828202231 0.2098226828202231 after dst
Death rate: 0.12198658299361671

dynamic sparse change grow
self.total_params*pruning_rate 2885230.5645356784
self.total_nonzero 2365205.0
to grow 520025.56453567836
len(all_scores) 11272399 7947605
increse 520025.0 before_mask 2885229.0 after_mask 2885229.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1214,1165 density 0.7025462962962963,0.6741898148148148
before tensor 4096 mask 734.0 4096
layer1.0.conv1.weight, mask/weight parameters,734,672 density 0.2440159574468085,0.22340425531914893
before tensor 36864 mask 4209.0 36864
layer1.0.conv2.weight, mask/weight parameters,4209,3797 density 0.21170967255168252,0.1909863688949248
before tensor 16384 mask 4625.0 16384
layer1.0.conv3.weight, mask/weight parameters,4625,3930 density 0.3843916223404255,0.32662898936170215
layer1.0.shortcut.0.weight, mask/weight parameters,6323,5542 density 0.38592529296875,0.3382568359375
before tensor 16384 mask 3238.0 16384
layer1.1.conv1.weight, mask/weight parameters,3238,2514 density 0.2691156914893617,0.20894281914893617
before tensor 36864 mask 4718.0 36864
layer1.1.conv2.weight, mask/weight parameters,4718,4258 density 0.23731200643830794,0.21417433730697652
before tensor 16384 mask 2740.0 16384
layer1.1.conv3.weight, mask/weight parameters,2740,2407 density 0.22772606382978725,0.20004986702127658
before tensor 16384 mask 3574.0 16384
layer1.2.conv1.weight, mask/weight parameters,3574,3034 density 0.2970412234042553,0.2521609042553192
before tensor 36864 mask 3797.0 36864
layer1.2.conv2.weight, mask/weight parameters,3797,3226 density 0.1909863688949248,0.16226547960364165
before tensor 16384 mask 2328.0 16384
layer1.2.conv3.weight, mask/weight parameters,2328,1991 density 0.1934840425531915,0.16547539893617022
before tensor 32768 mask 6881.0 32768
layer2.0.conv1.weight, mask/weight parameters,6881,5576 density 0.34907670454545453,0.28287337662337664
before tensor 147456 mask 14486.0 147456
layer2.0.conv2.weight, mask/weight parameters,14486,13061 density 0.2714716740690767,0.2447667772343097
before tensor 65536 mask 8592.0 65536
layer2.0.conv3.weight, mask/weight parameters,8592,7247 density 0.21793831168831168,0.18382203733766234
layer2.0.shortcut.0.weight, mask/weight parameters,37839,31224 density 0.28868865966796875,0.23822021484375
before tensor 65536 mask 4848.0 65536
layer2.1.conv1.weight, mask/weight parameters,4848,3967 density 0.12297077922077922,0.10062398538961038
before tensor 147456 mask 4937.0 147456
layer2.1.conv2.weight, mask/weight parameters,4937,4308 density 0.0925207548584172,0.08073311969415865
before tensor 65536 mask 4638.0 65536
layer2.1.conv3.weight, mask/weight parameters,4638,4125 density 0.11764407467532467,0.10463169642857142
before tensor 65536 mask 12267.0 65536
layer2.2.conv1.weight, mask/weight parameters,12267,10537 density 0.3111556412337662,0.26727374188311687
before tensor 147456 mask 24579.0 147456
layer2.2.conv2.weight, mask/weight parameters,24579,21032 density 0.46061730477314894,0.39414553700267985
before tensor 65536 mask 15632.0 65536
layer2.2.conv3.weight, mask/weight parameters,15632,13075 density 0.3965097402597403,0.3316507711038961
before tensor 65536 mask 12701.0 65536
layer2.3.conv1.weight, mask/weight parameters,12701,10630 density 0.322164163961039,0.269632711038961
before tensor 147456 mask 22783.0 147456
layer2.3.conv2.weight, mask/weight parameters,22783,19646 density 0.4269597646221023,0.36817151102865386
before tensor 65536 mask 12473.0 65536
layer2.3.conv3.weight, mask/weight parameters,12473,10512 density 0.3163808847402597,0.26663961038961037
before tensor 131072 mask 36985.0 131072
layer3.0.conv1.weight, mask/weight parameters,36985,30692 density 0.5159737723214286,0.42818080357142857
before tensor 589824 mask 89726.0 589824
layer3.0.conv2.weight, mask/weight parameters,89726,74933 density 0.5086507936507937,0.42479024943310656
before tensor 262144 mask 68763.0 262144
layer3.0.conv3.weight, mask/weight parameters,68763,58656 density 0.47965262276785714,0.40915178571428573
layer3.0.shortcut.0.weight, mask/weight parameters,129674,103968 density 0.24733352661132812,0.19830322265625
before tensor 262144 mask 36421.0 262144
layer3.1.conv1.weight, mask/weight parameters,36421,27813 density 0.254052734375,0.19400809151785714
before tensor 589824 mask 76419.0 589824
layer3.1.conv2.weight, mask/weight parameters,76419,59955 density 0.4332142857142857,0.3398809523809524
before tensor 262144 mask 54376.0 262144
layer3.1.conv3.weight, mask/weight parameters,54376,45371 density 0.379296875,0.3164829799107143
before tensor 262144 mask 36333.0 262144
layer3.2.conv1.weight, mask/weight parameters,36333,29366 density 0.2534388950892857,0.20484095982142858
before tensor 589824 mask 65531.0 589824
layer3.2.conv2.weight, mask/weight parameters,65531,54121 density 0.3714909297052154,0.30680839002267574
before tensor 262144 mask 54947.0 262144
layer3.2.conv3.weight, mask/weight parameters,54947,45745 density 0.3832798549107143,0.319091796875
before tensor 262144 mask 38411.0 262144
layer3.3.conv1.weight, mask/weight parameters,38411,30704 density 0.26793387276785713,0.21417410714285715
before tensor 589824 mask 55182.0 589824
layer3.3.conv2.weight, mask/weight parameters,55182,44639 density 0.3128231292517007,0.25305555555555553
before tensor 262144 mask 46746.0 262144
layer3.3.conv3.weight, mask/weight parameters,46746,38362 density 0.32607421875,0.26759207589285716
before tensor 262144 mask 40201.0 262144
layer3.4.conv1.weight, mask/weight parameters,40201,32956 density 0.280419921875,0.2298828125
before tensor 589824 mask 55933.0 589824
layer3.4.conv2.weight, mask/weight parameters,55933,46246 density 0.31708049886621315,0.2621655328798186
before tensor 262144 mask 43833.0 262144
layer3.4.conv3.weight, mask/weight parameters,43833,35308 density 0.30575474330357144,0.2462890625
before tensor 262144 mask 47622.0 262144
layer3.5.conv1.weight, mask/weight parameters,47622,39915 density 0.33218470982142856,0.27842494419642855
before tensor 589824 mask 56622.0 589824
layer3.5.conv2.weight, mask/weight parameters,56622,48665 density 0.32098639455782313,0.27587868480725625
before tensor 262144 mask 41583.0 262144
layer3.5.conv3.weight, mask/weight parameters,41583,34953 density 0.2900599888392857,0.24381277901785714
before tensor 524288 mask 151280.0 524288
layer4.0.conv1.weight, mask/weight parameters,151280,130384 density 0.5512476679104478,0.47510494402985076
before tensor 2359296 mask 273535.0 2359296
layer4.0.conv2.weight, mask/weight parameters,273535,225677 density 0.4231562956362466,0.3491203806836464
before tensor 1048576 mask 143376.0 1048576
layer4.0.conv3.weight, mask/weight parameters,143376,115816 density 0.26122318097014924,0.21101037779850745
layer4.0.shortcut.0.weight, mask/weight parameters,223452,168073 density 0.10655021667480469,0.08014345169067383
before tensor 1048576 mask 132987.0 1048576
layer4.1.conv1.weight, mask/weight parameters,132987,111489 density 0.2422949947527985,0.20312682194496268
before tensor 2359296 mask 227088.0 2359296
layer4.1.conv2.weight, mask/weight parameters,227088,189757 density 0.35130318556471374,0.29355244919680207
before tensor 1048576 mask 112630.0 1048576
layer4.1.conv3.weight, mask/weight parameters,112630,90576 density 0.20520566114738806,0.1650244869402985
before tensor 1048576 mask 78171.0 1048576
layer4.2.conv1.weight, mask/weight parameters,78171,61306 density 0.14242325967817165,0.11169615788246269
before tensor 2359296 mask 83133.0 2359296
layer4.2.conv2.weight, mask/weight parameters,83133,60904 density 0.1286060369792827,0.09421796490185887
before tensor 1048576 mask 48574.0 1048576
layer4.2.conv3.weight, mask/weight parameters,48574,35315 density 0.08849915461753731,0.06434198635727612
classifier.weight, mask/weight parameters,115539,106064 density 0.5641552734375,0.517890625
Total Model parameters after dst: 2885229 2365205
Total parameters under density level of 0.1: 0.2559551875337273 0.2098226828202231 after dst
Death rate: 0.12198658299361671


Training summary: Average loss: 1.2452, Accuracy: 32112/50000 (64.224%)


Evaluation: Average loss: 1.6059, Accuracy: 5756/10000 (57.560%)

Current learning rate: 0.1. Time taken for epoch: 88.73 seconds.

Train Epoch: 70 [0/50000 (0%)]	Loss: 0.997978 Accuracy: 70/100 (70.000%
Train Epoch: 70 [10000/50000 (20%)]	Loss: 1.456096 Accuracy: 6627/10100 (65.614%
Train Epoch: 70 [20000/50000 (40%)]	Loss: 1.138315 Accuracy: 13031/20100 (64.831%
Train Epoch: 70 [30000/50000 (60%)]	Loss: 1.197406 Accuracy: 19487/30100 (64.741%
Train Epoch: 70 [40000/50000 (80%)]	Loss: 1.025919 Accuracy: 25819/40100 (64.387%
current layer rate 0.45325921711424666
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4186.0
Total filter_masks items: 8296975.0
4186.0 / 7552 channels
Total channels to prune: 57.01360764679066
Layer ('layer2', 0, 'conv1'): Pruned 1/77.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/77.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/77.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/77.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/77.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/77.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/77.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/77.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 1/140.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/140.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/140.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/140.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/140.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/140.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/140.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/140.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/140.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/140.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/140.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/140.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 3/268.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 3/268.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 3/268.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 3/268.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 3/268.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 3/268.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4148.0
Total filter_masks items: 8183820.0
After apply_mask:
Total filter_names items: 4148.0
Total filter_masks items: 8183820.0
Total pruned: 38/57.01360764679066 channels
===========done ===============

Training summary: Average loss: 1.2464, Accuracy: 32193/50000 (64.386%)


Evaluation: Average loss: 1.4890, Accuracy: 5861/10000 (58.610%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 71 [0/50000 (0%)]	Loss: 1.295453 Accuracy: 62/100 (62.000%
Train Epoch: 71 [10000/50000 (20%)]	Loss: 1.398546 Accuracy: 6585/10100 (65.198%
Train Epoch: 71 [20000/50000 (40%)]	Loss: 1.323880 Accuracy: 12919/20100 (64.274%
Train Epoch: 71 [30000/50000 (60%)]	Loss: 1.061451 Accuracy: 19316/30100 (64.173%
Train Epoch: 71 [40000/50000 (80%)]	Loss: 1.153304 Accuracy: 25626/40100 (63.905%
current mest  death_rate 0.12079107396632394


dynamic sparse change prune
to kill 476384.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1150,1150 density 0.6655092592592593,0.6655092592592593
before tensor 4096 mask 661.0 4096
layer1.0.conv1.weight, mask/weight parameters,661,661 density 0.21974734042553193,0.21974734042553193
before tensor 36864 mask 3697.0 36864
layer1.0.conv2.weight, mask/weight parameters,3697,3697 density 0.18595644082289622,0.18595644082289622
before tensor 16384 mask 3925.0 16384
layer1.0.conv3.weight, mask/weight parameters,3925,3925 density 0.32621343085106386,0.32621343085106386
layer1.0.shortcut.0.weight, mask/weight parameters,5630,5630 density 0.3436279296875,0.3436279296875
before tensor 16384 mask 2655.0 16384
layer1.1.conv1.weight, mask/weight parameters,2655,2655 density 0.22066156914893617,0.22066156914893617
before tensor 36864 mask 4229.0 36864
layer1.1.conv2.weight, mask/weight parameters,4229,4229 density 0.21271565816608823,0.21271565816608823
before tensor 16384 mask 2301.0 16384
layer1.1.conv3.weight, mask/weight parameters,2301,2301 density 0.19124002659574468,0.19124002659574468
before tensor 16384 mask 2982.0 16384
layer1.2.conv1.weight, mask/weight parameters,2982,2982 density 0.24783909574468085,0.24783909574468085
before tensor 36864 mask 3347.0 36864
layer1.2.conv2.weight, mask/weight parameters,3347,3347 density 0.16835169257079624,0.16835169257079624
before tensor 16384 mask 1900.0 16384
layer1.2.conv3.weight, mask/weight parameters,1900,1900 density 0.1579122340425532,0.1579122340425532
before tensor 32768 mask 5533.0 32768
layer2.0.conv1.weight, mask/weight parameters,5533,5533 density 0.28438527960526316,0.28438527960526316
before tensor 147456 mask 12515.0 147456
layer2.0.conv2.weight, mask/weight parameters,12515,12515 density 0.24074715297014465,0.24074715297014465
before tensor 65536 mask 7206.0 65536
layer2.0.conv3.weight, mask/weight parameters,7206,7206 density 0.18518708881578946,0.18518708881578946
layer2.0.shortcut.0.weight, mask/weight parameters,31108,31108 density 0.237335205078125,0.237335205078125
before tensor 65536 mask 3738.0 65536
layer2.1.conv1.weight, mask/weight parameters,3738,3738 density 0.09606291118421052,0.09606291118421052
before tensor 147456 mask 3910.0 147456
layer2.1.conv2.weight, mask/weight parameters,3910,3910 density 0.07521545090797169,0.07521545090797169
before tensor 65536 mask 3832.0 65536
layer2.1.conv3.weight, mask/weight parameters,3832,3832 density 0.09847861842105263,0.09847861842105263
before tensor 65536 mask 10365.0 65536
layer2.2.conv1.weight, mask/weight parameters,10365,10365 density 0.2663702713815789,0.2663702713815789
before tensor 147456 mask 20788.0 147456
layer2.2.conv2.weight, mask/weight parameters,20788,20788 density 0.39989227454601417,0.39989227454601417
before tensor 65536 mask 13089.0 65536
layer2.2.conv3.weight, mask/weight parameters,13089,13089 density 0.33637438322368424,0.33637438322368424
before tensor 65536 mask 10651.0 65536
layer2.3.conv1.weight, mask/weight parameters,10651,10651 density 0.27372018914473684,0.27372018914473684
before tensor 147456 mask 19591.0 147456
layer2.3.conv2.weight, mask/weight parameters,19591,19591 density 0.3768659587565405,0.3768659587565405
before tensor 65536 mask 10533.0 65536
layer2.3.conv3.weight, mask/weight parameters,10533,10533 density 0.27068770559210525,0.27068770559210525
before tensor 131072 mask 31286.0 131072
layer3.0.conv1.weight, mask/weight parameters,31286,31286 density 0.4396076888489209,0.4396076888489209
before tensor 589824 mask 75852.0 589824
layer3.0.conv2.weight, mask/weight parameters,75852,75852 density 0.4362093059365457,0.4362093059365457
before tensor 262144 mask 59140.0 262144
layer3.0.conv3.weight, mask/weight parameters,59140,59140 density 0.4154957284172662,0.4154957284172662
layer3.0.shortcut.0.weight, mask/weight parameters,105557,105557 density 0.20133399963378906,0.20133399963378906
before tensor 262144 mask 29485.0 262144
layer3.1.conv1.weight, mask/weight parameters,29485,29485 density 0.20715068570143885,0.20715068570143885
before tensor 589824 mask 62440.0 589824
layer3.1.conv2.weight, mask/weight parameters,62440,62440 density 0.35907964276061166,0.35907964276061166
before tensor 262144 mask 45480.0 262144
layer3.1.conv3.weight, mask/weight parameters,45480,45480 density 0.3195256294964029,0.3195256294964029
before tensor 262144 mask 29644.0 262144
layer3.2.conv1.weight, mask/weight parameters,29644,29644 density 0.2082677607913669,0.2082677607913669
before tensor 589824 mask 54414.0 589824
layer3.2.conv2.weight, mask/weight parameters,54414,54414 density 0.3129237617100564,0.3129237617100564
before tensor 262144 mask 46107.0 262144
layer3.2.conv3.weight, mask/weight parameters,46107,46107 density 0.3239306991906475,0.3239306991906475
before tensor 262144 mask 31357.0 262144
layer3.3.conv1.weight, mask/weight parameters,31357,31357 density 0.22030266411870503,0.22030266411870503
before tensor 589824 mask 45887.0 589824
layer3.3.conv2.weight, mask/weight parameters,45887,45887 density 0.2638867323407461,0.2638867323407461
before tensor 262144 mask 38665.0 262144
layer3.3.conv3.weight, mask/weight parameters,38665,38665 density 0.27164596447841727,0.27164596447841727
before tensor 262144 mask 33143.0 262144
layer3.4.conv1.weight, mask/weight parameters,33143,33143 density 0.23285043839928057,0.23285043839928057
before tensor 589824 mask 46580.0 589824
layer3.4.conv2.weight, mask/weight parameters,46580,46580 density 0.26787203330860493,0.26787203330860493
before tensor 262144 mask 35931.0 262144
layer3.4.conv3.weight, mask/weight parameters,35931,35931 density 0.2524378934352518,0.2524378934352518
before tensor 262144 mask 39696.0 262144
layer3.5.conv1.weight, mask/weight parameters,39696,39696 density 0.27888938848920863,0.27888938848920863
before tensor 589824 mask 47563.0 589824
layer3.5.conv2.weight, mask/weight parameters,47563,47563 density 0.27352506484021416,0.27352506484021416
before tensor 262144 mask 34650.0 262144
layer3.5.conv3.weight, mask/weight parameters,34650,34650 density 0.2434380620503597,0.2434380620503597
before tensor 524288 mask 130480.0 524288
layer4.0.conv1.weight, mask/weight parameters,130480,130480 density 0.4808372641509434,0.4808372641509434
before tensor 2359296 mask 224542.0 2359296
layer4.0.conv2.weight, mask/weight parameters,224542,224542 density 0.3552739211265377,0.3552739211265377
before tensor 1048576 mask 114279.0 1048576
layer4.0.conv3.weight, mask/weight parameters,114279,114279 density 0.2105671432783019,0.2105671432783019
layer4.0.shortcut.0.weight, mask/weight parameters,169653,169653 density 0.08089685440063477,0.08089685440063477
before tensor 1048576 mask 108226.0 1048576
layer4.1.conv1.weight, mask/weight parameters,108226,108226 density 0.1994140625,0.1994140625
before tensor 2359296 mask 185934.0 2359296
layer4.1.conv2.weight, mask/weight parameters,185934,185934 density 0.294187729915747,0.294187729915747
before tensor 1048576 mask 88297.0 1048576
layer4.1.conv3.weight, mask/weight parameters,88297,88297 density 0.16269346992924527,0.16269346992924527
before tensor 1048576 mask 60995.0 1048576
layer4.2.conv1.weight, mask/weight parameters,60995,60995 density 0.11238760318396226,0.11238760318396226
before tensor 2359296 mask 61681.0 2359296
layer4.2.conv2.weight, mask/weight parameters,61681,61681 density 0.09759265851825481,0.09759265851825481
before tensor 1048576 mask 35880.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35880,35880 density 0.06611143867924528,0.06611143867924528
classifier.weight, mask/weight parameters,107025,107025 density 0.5225830078125,0.5225830078125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.21195028982250053 0.21195028982250053 after dst
Death rate: 0.12079107396632394

dynamic sparse change grow
self.total_params*pruning_rate 2856954.3467658604
self.total_nonzero 2365205.0
to grow 491749.34676586045
len(all_scores) 11159244 7826227
increse 491749.0 before_mask 2856953.0 after_mask 2856953.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1209,1150 density 0.6996527777777778,0.6655092592592593
before tensor 4096 mask 730.0 4096
layer1.0.conv1.weight, mask/weight parameters,730,661 density 0.24268617021276595,0.21974734042553193
before tensor 36864 mask 4205.0 36864
layer1.0.conv2.weight, mask/weight parameters,4205,3697 density 0.21150847542880136,0.18595644082289622
before tensor 16384 mask 4412.0 16384
layer1.0.conv3.weight, mask/weight parameters,4412,3925 density 0.36668882978723405,0.32621343085106386
layer1.0.shortcut.0.weight, mask/weight parameters,6438,5630 density 0.3929443359375,0.3436279296875
before tensor 16384 mask 3115.0 16384
layer1.1.conv1.weight, mask/weight parameters,3115,2655 density 0.25889295212765956,0.22066156914893617
before tensor 36864 mask 4730.0 36864
layer1.1.conv2.weight, mask/weight parameters,4730,4229 density 0.23791559780695137,0.21271565816608823
before tensor 16384 mask 2760.0 16384
layer1.1.conv3.weight, mask/weight parameters,2760,2301 density 0.2293882978723404,0.19124002659574468
before tensor 16384 mask 3432.0 16384
layer1.2.conv1.weight, mask/weight parameters,3432,2982 density 0.28523936170212766,0.24783909574468085
before tensor 36864 mask 3804.0 36864
layer1.2.conv2.weight, mask/weight parameters,3804,3347 density 0.1913384638599668,0.16835169257079624
before tensor 16384 mask 2346.0 16384
layer1.2.conv3.weight, mask/weight parameters,2346,1900 density 0.19498005319148937,0.1579122340425532
before tensor 32768 mask 6522.0 32768
layer2.0.conv1.weight, mask/weight parameters,6522,5533 density 0.3352179276315789,0.28438527960526316
before tensor 147456 mask 14489.0 147456
layer2.0.conv2.weight, mask/weight parameters,14489,12515 density 0.2787203755001539,0.24074715297014465
before tensor 65536 mask 8627.0 65536
layer2.0.conv3.weight, mask/weight parameters,8627,7206 density 0.22170538651315788,0.18518708881578946
layer2.0.shortcut.0.weight, mask/weight parameters,38855,31108 density 0.29644012451171875,0.237335205078125
before tensor 65536 mask 4667.0 65536
layer2.1.conv1.weight, mask/weight parameters,4667,3738 density 0.11993729440789473,0.09606291118421052
before tensor 147456 mask 4388.0 147456
layer2.1.conv2.weight, mask/weight parameters,4388,3910 density 0.08441058787319175,0.07521545090797169
before tensor 65536 mask 4949.0 65536
layer2.1.conv3.weight, mask/weight parameters,4949,3832 density 0.12718441611842105,0.09847861842105263
before tensor 65536 mask 11885.0 65536
layer2.2.conv1.weight, mask/weight parameters,11885,10365 density 0.3054327713815789,0.2663702713815789
before tensor 147456 mask 24333.0 147456
layer2.2.conv2.weight, mask/weight parameters,24333,20788 density 0.4680863342566944,0.39989227454601417
before tensor 65536 mask 15853.0 65536
layer2.2.conv3.weight, mask/weight parameters,15853,13089 density 0.40740645559210525,0.33637438322368424
before tensor 65536 mask 12211.0 65536
layer2.3.conv1.weight, mask/weight parameters,12211,10651 density 0.31381064967105265,0.27372018914473684
before tensor 147456 mask 22467.0 147456
layer2.3.conv2.weight, mask/weight parameters,22467,19591 density 0.43219067405355494,0.3768659587565405
before tensor 65536 mask 12799.0 65536
layer2.3.conv3.weight, mask/weight parameters,12799,10533 density 0.32892166940789475,0.27068770559210525
before tensor 131072 mask 36874.0 131072
layer3.0.conv1.weight, mask/weight parameters,36874,31286 density 0.5181261241007195,0.4396076888489209
before tensor 589824 mask 90830.0 589824
layer3.0.conv2.weight, mask/weight parameters,90830,75852 density 0.5223447141567321,0.4362093059365457
before tensor 262144 mask 69602.0 262144
layer3.0.conv3.weight, mask/weight parameters,69602,59140 density 0.4889978642086331,0.4154957284172662
layer3.0.shortcut.0.weight, mask/weight parameters,129143,105557 density 0.2463207244873047,0.20133399963378906
before tensor 262144 mask 37164.0 262144
layer3.1.conv1.weight, mask/weight parameters,37164,29485 density 0.26110049460431656,0.20715068570143885
before tensor 589824 mask 76609.0 589824
layer3.1.conv2.weight, mask/weight parameters,76609,62440 density 0.44056265778743914,0.35907964276061166
before tensor 262144 mask 54425.0 262144
layer3.1.conv3.weight, mask/weight parameters,54425,45480 density 0.3823698853417266,0.3195256294964029
before tensor 262144 mask 36775.0 262144
layer3.2.conv1.weight, mask/weight parameters,36775,29644 density 0.25836752473021585,0.2082677607913669
before tensor 589824 mask 66410.0 589824
layer3.2.conv2.weight, mask/weight parameters,66410,54414 density 0.38191029909885044,0.3129237617100564
before tensor 262144 mask 55023.0 262144
layer3.2.conv3.weight, mask/weight parameters,55023,46107 density 0.3865712117805755,0.3239306991906475
before tensor 262144 mask 39444.0 262144
layer3.3.conv1.weight, mask/weight parameters,39444,31357 density 0.2771189298561151,0.22030266411870503
before tensor 589824 mask 56358.0 589824
layer3.3.conv2.weight, mask/weight parameters,56358,45887 density 0.32410330728223175,0.2638867323407461
before tensor 262144 mask 46390.0 262144
layer3.3.conv3.weight, mask/weight parameters,46390,38665 density 0.3259189523381295,0.27164596447841727
before tensor 262144 mask 41023.0 262144
layer3.4.conv1.weight, mask/weight parameters,41023,33143 density 0.28821239883093525,0.23285043839928057
before tensor 589824 mask 57216.0 589824
layer3.4.conv2.weight, mask/weight parameters,57216,46580 density 0.3290374894329141,0.26787203330860493
before tensor 262144 mask 44201.0 262144
layer3.4.conv3.weight, mask/weight parameters,44201,35931 density 0.3105398493705036,0.2524378934352518
before tensor 262144 mask 45604.0 262144
layer3.5.conv1.weight, mask/weight parameters,45604,39696 density 0.32039680755395683,0.27888938848920863
before tensor 589824 mask 55433.0 589824
layer3.5.conv2.weight, mask/weight parameters,55433,47563 density 0.3187838218633726,0.27352506484021416
before tensor 262144 mask 40835.0 262144
layer3.5.conv3.weight, mask/weight parameters,40835,34650 density 0.28689158048561153,0.2434380620503597
before tensor 524288 mask 151541.0 524288
layer4.0.conv1.weight, mask/weight parameters,151541,130480 density 0.5584500294811321,0.4808372641509434
before tensor 2359296 mask 270092.0 2359296
layer4.0.conv2.weight, mask/weight parameters,270092,224542 density 0.42734385506902417,0.3552739211265377
before tensor 1048576 mask 141595.0 1048576
layer4.0.conv3.weight, mask/weight parameters,141595,114279 density 0.26089880601415094,0.2105671432783019
layer4.0.shortcut.0.weight, mask/weight parameters,218038,169653 density 0.10396862030029297,0.08089685440063477
before tensor 1048576 mask 128297.0 1048576
layer4.1.conv1.weight, mask/weight parameters,128297,108226 density 0.23639630011792453,0.1994140625
before tensor 2359296 mask 222198.0 2359296
layer4.1.conv2.weight, mask/weight parameters,222198,185934 density 0.35156520707250505,0.294187729915747
before tensor 1048576 mask 108122.0 1048576
layer4.1.conv3.weight, mask/weight parameters,108122,88297 density 0.19922243514150945,0.16269346992924527
before tensor 1048576 mask 77076.0 1048576
layer4.2.conv1.weight, mask/weight parameters,77076,60995 density 0.14201798349056605,0.11238760318396226
before tensor 2359296 mask 79955.0 2359296
layer4.2.conv2.weight, mask/weight parameters,79955,61681 density 0.12650607175349077,0.09759265851825481
before tensor 1048576 mask 46496.0 1048576
layer4.2.conv3.weight, mask/weight parameters,46496,35880 density 0.08567216981132075,0.06611143867924528
classifier.weight, mask/weight parameters,114958,107025 density 0.561318359375,0.5225830078125
Total Model parameters after dst: 2856953 2365205
Total parameters under density level of 0.1: 0.256016715827703 0.21195028982250053 after dst
Death rate: 0.12079107396632394


Training summary: Average loss: 1.2547, Accuracy: 31932/50000 (63.864%)


Evaluation: Average loss: 1.5687, Accuracy: 5665/10000 (56.650%)

Current learning rate: 0.1. Time taken for epoch: 88.72 seconds.

Train Epoch: 72 [0/50000 (0%)]	Loss: 1.090242 Accuracy: 71/100 (71.000%
Train Epoch: 72 [10000/50000 (20%)]	Loss: 1.179407 Accuracy: 6510/10100 (64.455%
Train Epoch: 72 [20000/50000 (40%)]	Loss: 1.234818 Accuracy: 12910/20100 (64.229%
Train Epoch: 72 [30000/50000 (60%)]	Loss: 1.177668 Accuracy: 19311/30100 (64.156%
Train Epoch: 72 [40000/50000 (80%)]	Loss: 1.803724 Accuracy: 25669/40100 (64.012%
current layer rate 0.45785320892125625
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4148.0
Total filter_masks items: 8183820.0
4148.0 / 7552 channels
Total channels to prune: 53.70743377332701
Layer ('layer3', 0, 'conv1'): Pruned 1/139.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/139.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/139.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/139.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/139.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/139.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/139.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/139.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/139.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/139.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/139.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/139.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 3/265.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 3/265.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 3/265.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 3/265.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 3/265.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 3/265.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4118.0
Total filter_masks items: 8080607.0
After apply_mask:
Total filter_names items: 4118.0
Total filter_masks items: 8080607.0
Total pruned: 30/53.70743377332701 channels
===========done ===============

Training summary: Average loss: 1.2492, Accuracy: 31987/50000 (63.974%)


Evaluation: Average loss: 1.4984, Accuracy: 5809/10000 (58.090%)

Current learning rate: 0.1. Time taken for epoch: 88.55 seconds.

Train Epoch: 73 [0/50000 (0%)]	Loss: 1.332902 Accuracy: 61/100 (61.000%
Train Epoch: 73 [10000/50000 (20%)]	Loss: 1.328488 Accuracy: 6628/10100 (65.624%
Train Epoch: 73 [20000/50000 (40%)]	Loss: 1.230043 Accuracy: 12977/20100 (64.562%
Train Epoch: 73 [30000/50000 (60%)]	Loss: 1.245435 Accuracy: 19393/30100 (64.429%
Train Epoch: 73 [40000/50000 (80%)]	Loss: 1.073692 Accuracy: 25853/40100 (64.471%
current mest  death_rate 0.1196053950808047


dynamic sparse change prune
to kill 454963.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1140,1140 density 0.6597222222222222,0.6597222222222222
before tensor 4096 mask 654.0 4096
layer1.0.conv1.weight, mask/weight parameters,654,654 density 0.21742021276595744,0.21742021276595744
before tensor 36864 mask 3694.0 36864
layer1.0.conv2.weight, mask/weight parameters,3694,3694 density 0.18580554298073537,0.18580554298073537
before tensor 16384 mask 3838.0 16384
layer1.0.conv3.weight, mask/weight parameters,3838,3838 density 0.31898271276595747,0.31898271276595747
layer1.0.shortcut.0.weight, mask/weight parameters,5638,5638 density 0.3441162109375,0.3441162109375
before tensor 16384 mask 2603.0 16384
layer1.1.conv1.weight, mask/weight parameters,2603,2603 density 0.21633976063829788,0.21633976063829788
before tensor 36864 mask 4216.0 36864
layer1.1.conv2.weight, mask/weight parameters,4216,4216 density 0.2120617675167245,0.2120617675167245
before tensor 16384 mask 2348.0 16384
layer1.1.conv3.weight, mask/weight parameters,2348,2348 density 0.19514627659574468,0.19514627659574468
before tensor 16384 mask 2878.0 16384
layer1.2.conv1.weight, mask/weight parameters,2878,2878 density 0.23919547872340424,0.23919547872340424
before tensor 36864 mask 3365.0 36864
layer1.2.conv2.weight, mask/weight parameters,3365,3365 density 0.16925707962376138,0.16925707962376138
before tensor 16384 mask 1958.0 16384
layer1.2.conv3.weight, mask/weight parameters,1958,1958 density 0.16273271276595744,0.16273271276595744
before tensor 32768 mask 5445.0 32768
layer2.0.conv1.weight, mask/weight parameters,5445,5445 density 0.2798622532894737,0.2798622532894737
before tensor 147456 mask 12958.0 147456
layer2.0.conv2.weight, mask/weight parameters,12958,12958 density 0.24926900584795322,0.24926900584795322
before tensor 65536 mask 7340.0 65536
layer2.0.conv3.weight, mask/weight parameters,7340,7340 density 0.18863075657894737,0.18863075657894737
layer2.0.shortcut.0.weight, mask/weight parameters,31972,31972 density 0.243927001953125,0.243927001953125
before tensor 65536 mask 3805.0 65536
layer2.1.conv1.weight, mask/weight parameters,3805,3805 density 0.09778474506578948,0.09778474506578948
before tensor 147456 mask 3929.0 147456
layer2.1.conv2.weight, mask/weight parameters,3929,3929 density 0.07558094798399508,0.07558094798399508
before tensor 65536 mask 4311.0 65536
layer2.1.conv3.weight, mask/weight parameters,4311,4311 density 0.11078844572368421,0.11078844572368421
before tensor 65536 mask 10297.0 65536
layer2.2.conv1.weight, mask/weight parameters,10297,10297 density 0.2646227384868421,0.2646227384868421
before tensor 147456 mask 21267.0 147456
layer2.2.conv2.weight, mask/weight parameters,21267,21267 density 0.409106648199446,0.409106648199446
before tensor 65536 mask 13227.0 65536
layer2.2.conv3.weight, mask/weight parameters,13227,13227 density 0.3399208470394737,0.3399208470394737
before tensor 65536 mask 10538.0 65536
layer2.3.conv1.weight, mask/weight parameters,10538,10538 density 0.27081620065789475,0.27081620065789475
before tensor 147456 mask 20016.0 147456
layer2.3.conv2.weight, mask/weight parameters,20016,20016 density 0.3850415512465374,0.3850415512465374
before tensor 65536 mask 10931.0 65536
layer2.3.conv3.weight, mask/weight parameters,10931,10931 density 0.28091591282894735,0.28091591282894735
before tensor 131072 mask 31384.0 131072
layer3.0.conv1.weight, mask/weight parameters,31384,31384 density 0.4441802536231884,0.4441802536231884
before tensor 589824 mask 76815.0 589824
layer3.0.conv2.weight, mask/weight parameters,76815,76815 density 0.4481726528040328,0.4481726528040328
before tensor 262144 mask 59892.0 262144
layer3.0.conv3.weight, mask/weight parameters,59892,59892 density 0.423828125,0.423828125
layer3.0.shortcut.0.weight, mask/weight parameters,105787,105787 density 0.20177268981933594,0.20177268981933594
before tensor 262144 mask 30214.0 262144
layer3.1.conv1.weight, mask/weight parameters,30214,30214 density 0.21381057518115942,0.21381057518115942
before tensor 589824 mask 63087.0 589824
layer3.1.conv2.weight, mask/weight parameters,63087,63087 density 0.3680774347125954,0.3680774347125954
before tensor 262144 mask 45656.0 262144
layer3.1.conv3.weight, mask/weight parameters,45656,45656 density 0.3230865036231884,0.3230865036231884
before tensor 262144 mask 30198.0 262144
layer3.2.conv1.weight, mask/weight parameters,30198,30198 density 0.21369735054347827,0.21369735054347827
before tensor 589824 mask 55777.0 589824
layer3.2.conv2.weight, mask/weight parameters,55777,55777 density 0.32542766458960537,0.32542766458960537
before tensor 262144 mask 46492.0 262144
layer3.2.conv3.weight, mask/weight parameters,46492,46492 density 0.329002490942029,0.329002490942029
before tensor 262144 mask 32281.0 262144
layer3.3.conv1.weight, mask/weight parameters,32281,32281 density 0.2284377830615942,0.2284377830615942
before tensor 589824 mask 46774.0 589824
layer3.3.conv2.weight, mask/weight parameters,46774,46774 density 0.27290018436836333,0.27290018436836333
before tensor 262144 mask 38576.0 262144
layer3.3.conv3.weight, mask/weight parameters,38576,38576 density 0.2729846014492754,0.2729846014492754
before tensor 262144 mask 33834.0 262144
layer3.4.conv1.weight, mask/weight parameters,33834,33834 density 0.23942764945652173,0.23942764945652173
before tensor 589824 mask 47584.0 589824
layer3.4.conv2.weight, mask/weight parameters,47584,47584 density 0.27762608228896823,0.27762608228896823
before tensor 262144 mask 36484.0 262144
layer3.4.conv3.weight, mask/weight parameters,36484,36484 density 0.25818048007246375,0.25818048007246375
before tensor 262144 mask 38474.0 262144
layer3.5.conv1.weight, mask/weight parameters,38474,38474 density 0.272262794384058,0.272262794384058
before tensor 589824 mask 47092.0 589824
layer3.5.conv2.weight, mask/weight parameters,47092,47092 density 0.27475553688534154,0.27475553688534154
before tensor 262144 mask 34519.0 262144
layer3.5.conv3.weight, mask/weight parameters,34519,34519 density 0.24427507925724637,0.24427507925724637
before tensor 524288 mask 130641.0 524288
layer4.0.conv1.weight, mask/weight parameters,130641,130641 density 0.4869431357347328,0.4869431357347328
before tensor 2359296 mask 223065.0 2359296
layer4.0.conv2.weight, mask/weight parameters,223065,223065 density 0.36106578870695183,0.36106578870695183
before tensor 1048576 mask 113794.0 1048576
layer4.0.conv3.weight, mask/weight parameters,113794,113794 density 0.21207433802480916,0.21207433802480916
layer4.0.shortcut.0.weight, mask/weight parameters,167712,167712 density 0.0799713134765625,0.0799713134765625
before tensor 1048576 mask 106088.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106088,106088 density 0.19771290553435114,0.19771290553435114
before tensor 2359296 mask 183857.0 2359296
layer4.1.conv2.weight, mask/weight parameters,183857,183857 density 0.2976014736255981,0.2976014736255981
before tensor 1048576 mask 86081.0 1048576
layer4.1.conv3.weight, mask/weight parameters,86081,86081 density 0.16042648198950382,0.16042648198950382
before tensor 1048576 mask 61090.0 1048576
layer4.2.conv1.weight, mask/weight parameters,61090,61090 density 0.1138515326812977,0.1138515326812977
before tensor 2359296 mask 61395.0 2359296
layer4.2.conv2.weight, mask/weight parameters,61395,61395 density 0.09937746440572616,0.09937746440572616
before tensor 1048576 mask 35319.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35319,35319 density 0.06582292163645038,0.06582292163645038
classifier.weight, mask/weight parameters,106875,106875 density 0.5218505859375,0.5218505859375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.21392894068404836 0.21392894068404836 after dst
Death rate: 0.1196053950808047

dynamic sparse change grow
self.total_params*pruning_rate 2828910.6318238354
self.total_nonzero 2365205.0
to grow 463705.6318238354
len(all_scores) 11056031 7708700
increse 463705.0 before_mask 2828909.0 after_mask 2828909.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1187,1140 density 0.6869212962962963,0.6597222222222222
before tensor 4096 mask 763.0 4096
layer1.0.conv1.weight, mask/weight parameters,763,654 density 0.253656914893617,0.21742021276595744
before tensor 36864 mask 4448.0 36864
layer1.0.conv2.weight, mask/weight parameters,4448,3694 density 0.22373120064383079,0.18580554298073537
before tensor 16384 mask 4463.0 16384
layer1.0.conv3.weight, mask/weight parameters,4463,3838 density 0.3709275265957447,0.31898271276595747
layer1.0.shortcut.0.weight, mask/weight parameters,6401,5638 density 0.39068603515625,0.3441162109375
before tensor 16384 mask 3366.0 16384
layer1.1.conv1.weight, mask/weight parameters,3366,2603 density 0.27975398936170215,0.21633976063829788
before tensor 36864 mask 4911.0 36864
layer1.1.conv2.weight, mask/weight parameters,4911,4216 density 0.24701976761732308,0.2120617675167245
before tensor 16384 mask 3096.0 16384
layer1.1.conv3.weight, mask/weight parameters,3096,2348 density 0.25731382978723405,0.19514627659574468
before tensor 16384 mask 3254.0 16384
layer1.2.conv1.weight, mask/weight parameters,3254,2878 density 0.27044547872340424,0.23919547872340424
before tensor 36864 mask 3762.0 36864
layer1.2.conv2.weight, mask/weight parameters,3762,3365 density 0.1892258940697148,0.16925707962376138
before tensor 16384 mask 2355.0 16384
layer1.2.conv3.weight, mask/weight parameters,2355,1958 density 0.1957280585106383,0.16273271276595744
before tensor 32768 mask 6786.0 32768
layer2.0.conv1.weight, mask/weight parameters,6786,5445 density 0.34878700657894735,0.2798622532894737
before tensor 147456 mask 14628.0 147456
layer2.0.conv2.weight, mask/weight parameters,14628,12958 density 0.28139427516158816,0.24926900584795322
before tensor 65536 mask 8494.0 65536
layer2.0.conv3.weight, mask/weight parameters,8494,7340 density 0.21828741776315788,0.18863075657894737
layer2.0.shortcut.0.weight, mask/weight parameters,39840,31972 density 0.303955078125,0.243927001953125
before tensor 65536 mask 4526.0 65536
layer2.1.conv1.weight, mask/weight parameters,4526,3805 density 0.11631373355263158,0.09778474506578948
before tensor 147456 mask 4752.0 147456
layer2.1.conv2.weight, mask/weight parameters,4752,3929 density 0.09141274238227147,0.07558094798399508
before tensor 65536 mask 5129.0 65536
layer2.1.conv3.weight, mask/weight parameters,5129,4311 density 0.13181023848684212,0.11078844572368421
before tensor 65536 mask 12005.0 65536
layer2.2.conv1.weight, mask/weight parameters,12005,10297 density 0.3085166529605263,0.2646227384868421
before tensor 147456 mask 24034.0 147456
layer2.2.conv2.weight, mask/weight parameters,24034,21267 density 0.4623345644813789,0.409106648199446
before tensor 65536 mask 14959.0 65536
layer2.2.conv3.weight, mask/weight parameters,14959,13227 density 0.38443153782894735,0.3399208470394737
before tensor 65536 mask 12836.0 65536
layer2.3.conv1.weight, mask/weight parameters,12836,10538 density 0.32987253289473684,0.27081620065789475
before tensor 147456 mask 22875.0 147456
layer2.3.conv2.weight, mask/weight parameters,22875,20016 density 0.44003924284395196,0.3850415512465374
before tensor 65536 mask 12706.0 65536
layer2.3.conv3.weight, mask/weight parameters,12706,10931 density 0.3265316611842105,0.28091591282894735
before tensor 131072 mask 36063.0 131072
layer3.0.conv1.weight, mask/weight parameters,36063,31384 density 0.5104025135869565,0.4441802536231884
before tensor 589824 mask 87009.0 589824
layer3.0.conv2.weight, mask/weight parameters,87009,76815 density 0.5076489533011272,0.4481726528040328
before tensor 262144 mask 67463.0 262144
layer3.0.conv3.weight, mask/weight parameters,67463,59892 density 0.4774046082427536,0.423828125
layer3.0.shortcut.0.weight, mask/weight parameters,127646,105787 density 0.24346542358398438,0.20177268981933594
before tensor 262144 mask 35402.0 262144
layer3.1.conv1.weight, mask/weight parameters,35402,30214 density 0.2505236639492754,0.21381057518115942
before tensor 589824 mask 76222.0 589824
layer3.1.conv2.weight, mask/weight parameters,76222,63087 density 0.44471282877079976,0.3680774347125954
before tensor 262144 mask 54290.0 262144
layer3.1.conv3.weight, mask/weight parameters,54290,45656 density 0.38418534873188404,0.3230865036231884
before tensor 262144 mask 36354.0 262144
layer3.2.conv1.weight, mask/weight parameters,36354,30198 density 0.2572605298913043,0.21369735054347827
before tensor 589824 mask 64663.0 589824
layer3.2.conv2.weight, mask/weight parameters,64663,55777 density 0.37727251511120447,0.32542766458960537
before tensor 262144 mask 54252.0 262144
layer3.2.conv3.weight, mask/weight parameters,54252,46492 density 0.3839164402173913,0.329002490942029
before tensor 262144 mask 37883.0 262144
layer3.3.conv1.weight, mask/weight parameters,37883,32281 density 0.26808055932971014,0.2284377830615942
before tensor 589824 mask 54261.0 589824
layer3.3.conv2.weight, mask/weight parameters,54261,46774 density 0.3165826507036337,0.27290018436836333
before tensor 262144 mask 45614.0 262144
layer3.3.conv3.weight, mask/weight parameters,45614,38576 density 0.3227892889492754,0.2729846014492754
before tensor 262144 mask 40556.0 262144
layer3.4.conv1.weight, mask/weight parameters,40556,33834 density 0.28699615036231885,0.23942764945652173
before tensor 589824 mask 55345.0 589824
layer3.4.conv2.weight, mask/weight parameters,55345,47584 density 0.3229071856986161,0.27762608228896823
before tensor 262144 mask 43593.0 262144
layer3.4.conv3.weight, mask/weight parameters,43593,36484 density 0.3084876019021739,0.25818048007246375
before tensor 262144 mask 46099.0 262144
layer3.5.conv1.weight, mask/weight parameters,46099,38474 density 0.32622141077898553,0.272262794384058
before tensor 589824 mask 55600.0 589824
layer3.5.conv2.weight, mask/weight parameters,55600,47092 density 0.324394968377325,0.27475553688534154
before tensor 262144 mask 42233.0 262144
layer3.5.conv3.weight, mask/weight parameters,42233,34519 density 0.2988635076992754,0.24427507925724637
before tensor 524288 mask 150753.0 524288
layer4.0.conv1.weight, mask/weight parameters,150753,130641 density 0.5619073532919847,0.4869431357347328
before tensor 2359296 mask 263937.0 2359296
layer4.0.conv2.weight, mask/weight parameters,263937,223065 density 0.4272235495212012,0.36106578870695183
before tensor 1048576 mask 141383.0 1048576
layer4.0.conv3.weight, mask/weight parameters,141383,113794 density 0.2634910991173664,0.21207433802480916
layer4.0.shortcut.0.weight, mask/weight parameters,214099,167712 density 0.10209035873413086,0.0799713134765625
before tensor 1048576 mask 125194.0 1048576
layer4.1.conv1.weight, mask/weight parameters,125194,106088 density 0.23332016340648856,0.19771290553435114
before tensor 2359296 mask 215949.0 2359296
layer4.1.conv2.weight, mask/weight parameters,215949,183857 density 0.34954742342132356,0.2976014736255981
before tensor 1048576 mask 109690.0 1048576
layer4.1.conv3.weight, mask/weight parameters,109690,86081 density 0.2044258408874046,0.16042648198950382
before tensor 1048576 mask 81863.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81863,61090 density 0.15256552659828243,0.1138515326812977
before tensor 2359296 mask 80820.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80820,61395 density 0.13081988229124178,0.09937746440572616
before tensor 1048576 mask 47497.0 1048576
layer4.2.conv3.weight, mask/weight parameters,47497,35319 density 0.08851868141698473,0.06582292163645038
classifier.weight, mask/weight parameters,115600,106875 density 0.564453125,0.5218505859375
Total Model parameters after dst: 2828909 2365205
Total parameters under density level of 0.1: 0.2558702123754899 0.21392894068404836 after dst
Death rate: 0.1196053950808047


Training summary: Average loss: 1.2414, Accuracy: 32127/50000 (64.254%)


Evaluation: Average loss: 1.6784, Accuracy: 5532/10000 (55.320%)

Current learning rate: 0.1. Time taken for epoch: 88.74 seconds.

Train Epoch: 74 [0/50000 (0%)]	Loss: 1.196596 Accuracy: 66/100 (66.000%
Train Epoch: 74 [10000/50000 (20%)]	Loss: 1.437873 Accuracy: 6571/10100 (65.059%
Train Epoch: 74 [20000/50000 (40%)]	Loss: 1.344954 Accuracy: 13017/20100 (64.761%
Train Epoch: 74 [30000/50000 (60%)]	Loss: 1.561461 Accuracy: 19395/30100 (64.435%
Train Epoch: 74 [40000/50000 (80%)]	Loss: 1.409250 Accuracy: 25744/40100 (64.200%
current layer rate 0.46213586709148835
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4118.0
Total filter_masks items: 8080607.0
4118.0 / 7552 channels
Total channels to prune: 56.050068274919795
Layer ('layer2', 0, 'conv1'): Pruned 1/76.0 channels based on HE
Layer ('layer2', 0, 'conv2'): Pruned 1/76.0 channels based on HE
Layer ('layer2', 1, 'conv1'): Pruned 1/76.0 channels based on HE
Layer ('layer2', 1, 'conv2'): Pruned 1/76.0 channels based on HE
Layer ('layer2', 2, 'conv1'): Pruned 1/76.0 channels based on HE
Layer ('layer2', 2, 'conv2'): Pruned 1/76.0 channels based on HE
Layer ('layer2', 3, 'conv1'): Pruned 1/76.0 channels based on HE
Layer ('layer2', 3, 'conv2'): Pruned 1/76.0 channels based on HE
Layer ('layer3', 0, 'conv1'): Pruned 1/138.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/138.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/138.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/138.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/138.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/138.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/138.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/138.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/138.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/138.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/138.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/138.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 3/262.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 3/262.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 3/262.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 3/262.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 3/262.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 3/262.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4080.0
Total filter_masks items: 7968712.0
After apply_mask:
Total filter_names items: 4080.0
Total filter_masks items: 7968712.0
Total pruned: 38/56.050068274919795 channels
===========done ===============

Training summary: Average loss: 1.2458, Accuracy: 32013/50000 (64.026%)


Evaluation: Average loss: 1.5604, Accuracy: 5716/10000 (57.160%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 75 [0/50000 (0%)]	Loss: 1.248275 Accuracy: 63/100 (63.000%
Train Epoch: 75 [10000/50000 (20%)]	Loss: 1.166930 Accuracy: 6561/10100 (64.960%
Train Epoch: 75 [20000/50000 (40%)]	Loss: 1.453689 Accuracy: 13057/20100 (64.960%
Train Epoch: 75 [30000/50000 (60%)]	Loss: 1.740040 Accuracy: 19375/30100 (64.369%
Train Epoch: 75 [40000/50000 (80%)]	Loss: 1.547126 Accuracy: 25745/40100 (64.202%
current mest  death_rate 0.11843231554503537


dynamic sparse change prune
to kill 422559.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1146,1146 density 0.6631944444444444,0.6631944444444444
before tensor 4096 mask 675.0 4096
layer1.0.conv1.weight, mask/weight parameters,675,675 density 0.22440159574468085,0.22440159574468085
before tensor 36864 mask 3904.0 36864
layer1.0.conv2.weight, mask/weight parameters,3904,3904 density 0.19636839193199537,0.19636839193199537
before tensor 16384 mask 3855.0 16384
layer1.0.conv3.weight, mask/weight parameters,3855,3855 density 0.32039561170212766,0.32039561170212766
layer1.0.shortcut.0.weight, mask/weight parameters,5689,5689 density 0.34722900390625,0.34722900390625
before tensor 16384 mask 2819.0 16384
layer1.1.conv1.weight, mask/weight parameters,2819,2819 density 0.23429188829787234,0.23429188829787234
before tensor 36864 mask 4411.0 36864
layer1.1.conv2.weight, mask/weight parameters,4411,4411 density 0.22187012725718022,0.22187012725718022
before tensor 16384 mask 2541.0 16384
layer1.1.conv3.weight, mask/weight parameters,2541,2541 density 0.21118683510638298,0.21118683510638298
before tensor 16384 mask 2838.0 16384
layer1.2.conv1.weight, mask/weight parameters,2838,2838 density 0.23587101063829788,0.23587101063829788
before tensor 36864 mask 3375.0 36864
layer1.2.conv2.weight, mask/weight parameters,3375,3375 density 0.16976007243096425,0.16976007243096425
before tensor 16384 mask 1999.0 16384
layer1.2.conv3.weight, mask/weight parameters,1999,1999 density 0.1661402925531915,0.1661402925531915
before tensor 32768 mask 5672.0 32768
layer2.0.conv1.weight, mask/weight parameters,5672,5672 density 0.29541666666666666,0.29541666666666666
before tensor 147456 mask 12880.0 147456
layer2.0.conv2.weight, mask/weight parameters,12880,12880 density 0.25441975308641973,0.25441975308641973
before tensor 65536 mask 7203.0 65536
layer2.0.conv3.weight, mask/weight parameters,7203,7203 density 0.187578125,0.187578125
layer2.0.shortcut.0.weight, mask/weight parameters,32909,32909 density 0.25107574462890625,0.25107574462890625
before tensor 65536 mask 3723.0 65536
layer2.1.conv1.weight, mask/weight parameters,3723,3723 density 0.096953125,0.096953125
before tensor 147456 mask 3989.0 147456
layer2.1.conv2.weight, mask/weight parameters,3989,3989 density 0.07879506172839507,0.07879506172839507
before tensor 65536 mask 4356.0 65536
layer2.1.conv3.weight, mask/weight parameters,4356,4356 density 0.1134375,0.1134375
before tensor 65536 mask 10383.0 65536
layer2.2.conv1.weight, mask/weight parameters,10383,10383 density 0.270390625,0.270390625
before tensor 147456 mask 20659.0 147456
layer2.2.conv2.weight, mask/weight parameters,20659,20659 density 0.408079012345679,0.408079012345679
before tensor 65536 mask 12679.0 65536
layer2.2.conv3.weight, mask/weight parameters,12679,12679 density 0.3301822916666667,0.3301822916666667
before tensor 65536 mask 10897.0 65536
layer2.3.conv1.weight, mask/weight parameters,10897,10897 density 0.28377604166666665,0.28377604166666665
before tensor 147456 mask 20108.0 147456
layer2.3.conv2.weight, mask/weight parameters,20108,20108 density 0.3971950617283951,0.3971950617283951
before tensor 65536 mask 11065.0 65536
layer2.3.conv3.weight, mask/weight parameters,11065,11065 density 0.28815104166666666,0.28815104166666666
before tensor 131072 mask 31117.0 131072
layer3.0.conv1.weight, mask/weight parameters,31117,31117 density 0.44361598996350365,0.44361598996350365
before tensor 589824 mask 75100.0 589824
layer3.0.conv2.weight, mask/weight parameters,75100,75100 density 0.4445865226940404,0.4445865226940404
before tensor 262144 mask 58843.0 262144
layer3.0.conv3.weight, mask/weight parameters,58843,58843 density 0.419444286040146,0.419444286040146
layer3.0.shortcut.0.weight, mask/weight parameters,106406,106406 density 0.20295333862304688,0.20295333862304688
before tensor 262144 mask 29594.0 262144
layer3.1.conv1.weight, mask/weight parameters,29594,29594 density 0.2109517563868613,0.2109517563868613
before tensor 589824 mask 63420.0 589824
layer3.1.conv2.weight, mask/weight parameters,63420,63420 density 0.37544177455733746,0.37544177455733746
before tensor 262144 mask 46056.0 262144
layer3.1.conv3.weight, mask/weight parameters,46056,46056 density 0.3282960766423358,0.3282960766423358
before tensor 262144 mask 30165.0 262144
layer3.2.conv1.weight, mask/weight parameters,30165,30165 density 0.21502195483576642,0.21502195483576642
before tensor 589824 mask 54880.0 589824
layer3.2.conv2.weight, mask/weight parameters,54880,54880 density 0.3248855974094399,0.3248855974094399
before tensor 262144 mask 46243.0 262144
layer3.2.conv3.weight, mask/weight parameters,46243,46243 density 0.3296290488138686,0.3296290488138686
before tensor 262144 mask 31464.0 262144
layer3.3.conv1.weight, mask/weight parameters,31464,31464 density 0.2242814781021898,0.2242814781021898
before tensor 589824 mask 45702.0 589824
layer3.3.conv2.weight, mask/weight parameters,45702,45702 density 0.2705525067931163,0.2705525067931163
before tensor 262144 mask 38494.0 262144
layer3.3.conv3.weight, mask/weight parameters,38494,38494 density 0.274392677919708,0.274392677919708
before tensor 262144 mask 33916.0 262144
layer3.4.conv1.weight, mask/weight parameters,33916,33916 density 0.24175980839416059,0.24175980839416059
before tensor 589824 mask 46769.0 589824
layer3.4.conv2.weight, mask/weight parameters,46769,46769 density 0.27686906897307023,0.27686906897307023
before tensor 262144 mask 36579.0 262144
layer3.4.conv3.weight, mask/weight parameters,36579,36579 density 0.2607421875,0.2607421875
before tensor 262144 mask 38851.0 262144
layer3.5.conv1.weight, mask/weight parameters,38851,38851 density 0.27693744297445255,0.27693744297445255
before tensor 589824 mask 47464.0 589824
layer3.5.conv2.weight, mask/weight parameters,47464,47464 density 0.28098341828428675,0.28098341828428675
before tensor 262144 mask 35572.0 262144
layer3.5.conv3.weight, mask/weight parameters,35572,35572 density 0.2535640967153285,0.2535640967153285
before tensor 524288 mask 131274.0 524288
layer4.0.conv1.weight, mask/weight parameters,131274,131274 density 0.4949701375482625,0.4949701375482625
before tensor 2359296 mask 221051.0 2359296
layer4.0.conv2.weight, mask/weight parameters,221051,221051 density 0.36614275610414604,0.36614275610414604
before tensor 1048576 mask 114682.0 1048576
layer4.0.conv3.weight, mask/weight parameters,114682,114682 density 0.2162049046814672,0.2162049046814672
layer4.0.shortcut.0.weight, mask/weight parameters,167581,167581 density 0.07990884780883789,0.07990884780883789
before tensor 1048576 mask 104867.0 1048576
layer4.1.conv1.weight, mask/weight parameters,104867,104867 density 0.19770111908783783,0.19770111908783783
before tensor 2359296 mask 180746.0 2359296
layer4.1.conv2.weight, mask/weight parameters,180746,180746 density 0.2993826700390407,0.2993826700390407
before tensor 1048576 mask 88055.0 1048576
layer4.1.conv3.weight, mask/weight parameters,88055,88055 density 0.16600619872104247,0.16600619872104247
before tensor 1048576 mask 63951.0 1048576
layer4.2.conv1.weight, mask/weight parameters,63951,63951 density 0.12056399312258688,0.12056399312258688
before tensor 2359296 mask 62283.0 2359296
layer4.2.conv2.weight, mask/weight parameters,62283,62283 density 0.10316383675457035,0.10316383675457035
before tensor 1048576 mask 36379.0 1048576
layer4.2.conv3.weight, mask/weight parameters,36379,36379 density 0.06858372043918919,0.06858372043918919
classifier.weight, mask/weight parameters,107926,107926 density 0.526982421875,0.526982421875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.2161161922695405 0.2161161922695405 after dst
Death rate: 0.11843231554503537

dynamic sparse change grow
self.total_params*pruning_rate 2801164.9171052743
self.total_nonzero 2365205.0
to grow 435959.9171052743
len(all_scores) 10944136 7586834
increse 435959.0 before_mask 2801163.0 after_mask 2801163.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1212,1146 density 0.7013888888888888,0.6631944444444444
before tensor 4096 mask 735.0 4096
layer1.0.conv1.weight, mask/weight parameters,735,675 density 0.24434840425531915,0.22440159574468085
before tensor 36864 mask 4296.0 36864
layer1.0.conv2.weight, mask/weight parameters,4296,3904 density 0.21608570997434737,0.19636839193199537
before tensor 16384 mask 4325.0 16384
layer1.0.conv3.weight, mask/weight parameters,4325,3855 density 0.35945811170212766,0.32039561170212766
layer1.0.shortcut.0.weight, mask/weight parameters,6317,5689 density 0.38555908203125,0.34722900390625
before tensor 16384 mask 3166.0 16384
layer1.1.conv1.weight, mask/weight parameters,3166,2819 density 0.2631316489361702,0.23429188829787234
before tensor 36864 mask 4728.0 36864
layer1.1.conv2.weight, mask/weight parameters,4728,4411 density 0.23781499924551078,0.22187012725718022
before tensor 16384 mask 2923.0 16384
layer1.1.conv3.weight, mask/weight parameters,2923,2541 density 0.24293550531914893,0.21118683510638298
before tensor 16384 mask 3426.0 16384
layer1.2.conv1.weight, mask/weight parameters,3426,2838 density 0.2847406914893617,0.23587101063829788
before tensor 36864 mask 3768.0 36864
layer1.2.conv2.weight, mask/weight parameters,3768,3375 density 0.18952768975403653,0.16976007243096425
before tensor 16384 mask 2289.0 16384
layer1.2.conv3.weight, mask/weight parameters,2289,1999 density 0.19024268617021275,0.1661402925531915
before tensor 32768 mask 6840.0 32768
layer2.0.conv1.weight, mask/weight parameters,6840,5672 density 0.35625,0.29541666666666666
before tensor 147456 mask 14240.0 147456
layer2.0.conv2.weight, mask/weight parameters,14240,12880 density 0.28128395061728395,0.25441975308641973
before tensor 65536 mask 8222.0 65536
layer2.0.conv3.weight, mask/weight parameters,8222,7203 density 0.21411458333333333,0.187578125
layer2.0.shortcut.0.weight, mask/weight parameters,40385,32909 density 0.30811309814453125,0.25107574462890625
before tensor 65536 mask 4594.0 65536
layer2.1.conv1.weight, mask/weight parameters,4594,3723 density 0.11963541666666666,0.096953125
before tensor 147456 mask 5100.0 147456
layer2.1.conv2.weight, mask/weight parameters,5100,3989 density 0.10074074074074074,0.07879506172839507
before tensor 65536 mask 5010.0 65536
layer2.1.conv3.weight, mask/weight parameters,5010,4356 density 0.13046875,0.1134375
before tensor 65536 mask 12464.0 65536
layer2.2.conv1.weight, mask/weight parameters,12464,10383 density 0.32458333333333333,0.270390625
before tensor 147456 mask 24355.0 147456
layer2.2.conv2.weight, mask/weight parameters,24355,20659 density 0.4810864197530864,0.408079012345679
before tensor 65536 mask 15558.0 65536
layer2.2.conv3.weight, mask/weight parameters,15558,12679 density 0.40515625,0.3301822916666667
before tensor 65536 mask 12487.0 65536
layer2.3.conv1.weight, mask/weight parameters,12487,10897 density 0.3251822916666667,0.28377604166666665
before tensor 147456 mask 22143.0 147456
layer2.3.conv2.weight, mask/weight parameters,22143,20108 density 0.4373925925925926,0.3971950617283951
before tensor 65536 mask 13252.0 65536
layer2.3.conv3.weight, mask/weight parameters,13252,11065 density 0.34510416666666666,0.28815104166666666
before tensor 131072 mask 36073.0 131072
layer3.0.conv1.weight, mask/weight parameters,36073,31117 density 0.5142706432481752,0.44361598996350365
before tensor 589824 mask 85632.0 589824
layer3.0.conv2.weight, mask/weight parameters,85632,75100 density 0.5069351945584031,0.4445865226940404
before tensor 262144 mask 67125.0 262144
layer3.0.conv3.weight, mask/weight parameters,67125,58843 density 0.4784799840328467,0.419444286040146
layer3.0.shortcut.0.weight, mask/weight parameters,128800,106406 density 0.24566650390625,0.20295333862304688
before tensor 262144 mask 35138.0 262144
layer3.1.conv1.weight, mask/weight parameters,35138,29594 density 0.2504704607664234,0.2109517563868613
before tensor 589824 mask 73892.0 589824
layer3.1.conv2.weight, mask/weight parameters,73892,63420 density 0.4374352507977102,0.37544177455733746
before tensor 262144 mask 53150.0 262144
layer3.1.conv3.weight, mask/weight parameters,53150,46056 density 0.37886348083941607,0.3282960766423358
before tensor 262144 mask 36076.0 262144
layer3.2.conv1.weight, mask/weight parameters,36076,30165 density 0.2571567062043796,0.21502195483576642
before tensor 589824 mask 64207.0 589824
layer3.2.conv2.weight, mask/weight parameters,64207,54880 density 0.3801007571586718,0.3248855974094399
before tensor 262144 mask 54211.0 262144
layer3.2.conv3.weight, mask/weight parameters,54211,46243 density 0.38642649406934304,0.3296290488138686
before tensor 262144 mask 38517.0 262144
layer3.3.conv1.weight, mask/weight parameters,38517,31464 density 0.27455662636861317,0.2242814781021898
before tensor 589824 mask 54121.0 589824
layer3.3.conv2.weight, mask/weight parameters,54121,45702 density 0.32039237276596755,0.2705525067931163
before tensor 262144 mask 45571.0 262144
layer3.3.conv3.weight, mask/weight parameters,45571,38494 density 0.32483890282846717,0.274392677919708
before tensor 262144 mask 41031.0 262144
layer3.4.conv1.weight, mask/weight parameters,41031,33916 density 0.2924769046532847,0.24175980839416059
before tensor 589824 mask 55533.0 589824
layer3.4.conv2.weight, mask/weight parameters,55533,46769 density 0.32875130978386347,0.27686906897307023
before tensor 262144 mask 43100.0 262144
layer3.4.conv3.weight, mask/weight parameters,43100,36579 density 0.30722513686131386,0.2607421875
before tensor 262144 mask 45215.0 262144
layer3.5.conv1.weight, mask/weight parameters,45215,38851 density 0.3223012659671533,0.27693744297445255
before tensor 589824 mask 54606.0 589824
layer3.5.conv2.weight, mask/weight parameters,54606,47464 density 0.32326353739321934,0.28098341828428675
before tensor 262144 mask 41254.0 262144
layer3.5.conv3.weight, mask/weight parameters,41254,35572 density 0.29406649178832117,0.2535640967153285
before tensor 524288 mask 149292.0 524288
layer4.0.conv1.weight, mask/weight parameters,149292,131274 density 0.5629072152509652,0.4949701375482625
before tensor 2359296 mask 260058.0 2359296
layer4.0.conv2.weight, mask/weight parameters,260058,221051 density 0.43075287090731107,0.36614275610414604
before tensor 1048576 mask 139768.0 1048576
layer4.0.conv3.weight, mask/weight parameters,139768,114682 density 0.2634984314671815,0.2162049046814672
layer4.0.shortcut.0.weight, mask/weight parameters,213155,167581 density 0.10164022445678711,0.07990884780883789
before tensor 1048576 mask 125246.0 1048576
layer4.1.conv1.weight, mask/weight parameters,125246,104867 density 0.23612074686293436,0.19770111908783783
before tensor 2359296 mask 210501.0 2359296
layer4.1.conv2.weight, mask/weight parameters,210501,180746 density 0.3486680282047077,0.2993826700390407
before tensor 1048576 mask 106866.0 1048576
layer4.1.conv3.weight, mask/weight parameters,106866,88055 density 0.2014697454150579,0.16600619872104247
before tensor 1048576 mask 79795.0 1048576
layer4.2.conv1.weight, mask/weight parameters,79795,63951 density 0.15043398588320464,0.12056399312258688
before tensor 2359296 mask 78810.0 2359296
layer4.2.conv2.weight, mask/weight parameters,78810,62283 density 0.1305387019672734,0.10316383675457035
before tensor 1048576 mask 46438.0 1048576
layer4.2.conv3.weight, mask/weight parameters,46438,36379 density 0.08754750844594594,0.06858372043918919
classifier.weight, mask/weight parameters,116147,107926 density 0.5671240234375,0.526982421875
Total Model parameters after dst: 2801163 2365205
Total parameters under density level of 0.1: 0.25595104081308934 0.2161161922695405 after dst
Death rate: 0.11843231554503537


Training summary: Average loss: 1.2470, Accuracy: 32078/50000 (64.156%)


Evaluation: Average loss: 1.5684, Accuracy: 5738/10000 (57.380%)

Current learning rate: 0.1. Time taken for epoch: 88.74 seconds.

Train Epoch: 76 [0/50000 (0%)]	Loss: 0.987989 Accuracy: 69/100 (69.000%
Train Epoch: 76 [10000/50000 (20%)]	Loss: 1.190428 Accuracy: 6604/10100 (65.386%
Train Epoch: 76 [20000/50000 (40%)]	Loss: 1.413582 Accuracy: 13089/20100 (65.119%
Train Epoch: 76 [30000/50000 (60%)]	Loss: 1.376584 Accuracy: 19529/30100 (64.880%
Train Epoch: 76 [40000/50000 (80%)]	Loss: 1.423929 Accuracy: 25865/40100 (64.501%
current layer rate 0.46611811561219846
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4080.0
Total filter_masks items: 7968712.0
4080.0 / 7552 channels
Total channels to prune: 48.12400910332326
Layer ('layer3', 0, 'conv1'): Pruned 1/137.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/137.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/137.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/137.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/137.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/137.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/137.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/137.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/137.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/137.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/137.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/137.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 3/259.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 3/259.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 3/259.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 3/259.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 3/259.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 3/259.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4050.0
Total filter_masks items: 7866687.0
After apply_mask:
Total filter_names items: 4050.0
Total filter_masks items: 7866687.0
Total pruned: 30/48.12400910332326 channels
===========done ===============

Training summary: Average loss: 1.2368, Accuracy: 32158/50000 (64.316%)


Evaluation: Average loss: 1.6278, Accuracy: 5676/10000 (56.760%)

Current learning rate: 0.1. Time taken for epoch: 88.56 seconds.

Train Epoch: 77 [0/50000 (0%)]	Loss: 1.202493 Accuracy: 64/100 (64.000%
Train Epoch: 77 [10000/50000 (20%)]	Loss: 1.061900 Accuracy: 6619/10100 (65.535%
Train Epoch: 77 [20000/50000 (40%)]	Loss: 1.265126 Accuracy: 13125/20100 (65.299%
Train Epoch: 77 [30000/50000 (60%)]	Loss: 1.299121 Accuracy: 19456/30100 (64.638%
Train Epoch: 77 [40000/50000 (80%)]	Loss: 1.109636 Accuracy: 25867/40100 (64.506%
current mest  death_rate 0.11727457514062632


dynamic sparse change prune
to kill 398364.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1142,1142 density 0.6608796296296297,0.6608796296296297
before tensor 4096 mask 661.0 4096
layer1.0.conv1.weight, mask/weight parameters,661,661 density 0.21974734042553193,0.21974734042553193
before tensor 36864 mask 3811.0 36864
layer1.0.conv2.weight, mask/weight parameters,3811,3811 density 0.1916905588250088,0.1916905588250088
before tensor 16384 mask 3799.0 16384
layer1.0.conv3.weight, mask/weight parameters,3799,3799 density 0.31574135638297873,0.31574135638297873
layer1.0.shortcut.0.weight, mask/weight parameters,5646,5646 density 0.3446044921875,0.3446044921875
before tensor 16384 mask 2683.0 16384
layer1.1.conv1.weight, mask/weight parameters,2683,2683 density 0.22298869680851063,0.22298869680851063
before tensor 36864 mask 4316.0 36864
layer1.1.conv2.weight, mask/weight parameters,4316,4316 density 0.21709169558875308,0.21709169558875308
before tensor 16384 mask 2443.0 16384
layer1.1.conv3.weight, mask/weight parameters,2443,2443 density 0.20304188829787234,0.20304188829787234
before tensor 16384 mask 2885.0 16384
layer1.2.conv1.weight, mask/weight parameters,2885,2885 density 0.23977726063829788,0.23977726063829788
before tensor 36864 mask 3383.0 36864
layer1.2.conv2.weight, mask/weight parameters,3383,3383 density 0.17016246667672652,0.17016246667672652
before tensor 16384 mask 1979.0 16384
layer1.2.conv3.weight, mask/weight parameters,1979,1979 density 0.1644780585106383,0.1644780585106383
before tensor 32768 mask 5756.0 32768
layer2.0.conv1.weight, mask/weight parameters,5756,5756 density 0.2997916666666667,0.2997916666666667
before tensor 147456 mask 12987.0 147456
layer2.0.conv2.weight, mask/weight parameters,12987,12987 density 0.25653333333333334,0.25653333333333334
before tensor 65536 mask 7148.0 65536
layer2.0.conv3.weight, mask/weight parameters,7148,7148 density 0.18614583333333334,0.18614583333333334
layer2.0.shortcut.0.weight, mask/weight parameters,33580,33580 density 0.256195068359375,0.256195068359375
before tensor 65536 mask 3870.0 65536
layer2.1.conv1.weight, mask/weight parameters,3870,3870 density 0.10078125,0.10078125
before tensor 147456 mask 4425.0 147456
layer2.1.conv2.weight, mask/weight parameters,4425,4425 density 0.0874074074074074,0.0874074074074074
before tensor 65536 mask 4403.0 65536
layer2.1.conv3.weight, mask/weight parameters,4403,4403 density 0.11466145833333333,0.11466145833333333
before tensor 65536 mask 10885.0 65536
layer2.2.conv1.weight, mask/weight parameters,10885,10885 density 0.28346354166666665,0.28346354166666665
before tensor 147456 mask 21520.0 147456
layer2.2.conv2.weight, mask/weight parameters,21520,21520 density 0.4250864197530864,0.4250864197530864
before tensor 65536 mask 13334.0 65536
layer2.2.conv3.weight, mask/weight parameters,13334,13334 density 0.3472395833333333,0.3472395833333333
before tensor 65536 mask 10971.0 65536
layer2.3.conv1.weight, mask/weight parameters,10971,10971 density 0.285703125,0.285703125
before tensor 147456 mask 20074.0 147456
layer2.3.conv2.weight, mask/weight parameters,20074,20074 density 0.39652345679012346,0.39652345679012346
before tensor 65536 mask 11479.0 65536
layer2.3.conv3.weight, mask/weight parameters,11479,11479 density 0.2989322916666667,0.2989322916666667
before tensor 131072 mask 31087.0 131072
layer3.0.conv1.weight, mask/weight parameters,31087,31087 density 0.44644703584558826,0.44644703584558826
before tensor 589824 mask 74148.0 589824
layer3.0.conv2.weight, mask/weight parameters,74148,74148 density 0.4454296424452134,0.4454296424452134
before tensor 262144 mask 58902.0 262144
layer3.0.conv3.weight, mask/weight parameters,58902,58902 density 0.4229520909926471,0.4229520909926471
layer3.0.shortcut.0.weight, mask/weight parameters,107964,107964 density 0.20592498779296875,0.20592498779296875
before tensor 262144 mask 29614.0 262144
layer3.1.conv1.weight, mask/weight parameters,29614,29614 density 0.212646484375,0.212646484375
before tensor 589824 mask 62451.0 589824
layer3.1.conv2.weight, mask/weight parameters,62451,62451 density 0.3751621972318339,0.3751621972318339
before tensor 262144 mask 45619.0 262144
layer3.1.conv3.weight, mask/weight parameters,45619,45619 density 0.3275720932904412,0.3275720932904412
before tensor 262144 mask 30230.0 262144
layer3.2.conv1.weight, mask/weight parameters,30230,30230 density 0.2170697380514706,0.2170697380514706
before tensor 589824 mask 54844.0 589824
layer3.2.conv2.weight, mask/weight parameters,54844,54844 density 0.3294646289888504,0.3294646289888504
before tensor 262144 mask 46518.0 262144
layer3.2.conv3.weight, mask/weight parameters,46518,46518 density 0.3340274586397059,0.3340274586397059
before tensor 262144 mask 32326.0 262144
layer3.3.conv1.weight, mask/weight parameters,32326,32326 density 0.23212028952205882,0.23212028952205882
before tensor 589824 mask 46041.0 589824
layer3.3.conv2.weight, mask/weight parameters,46041,46041 density 0.27658232410611305,0.27658232410611305
before tensor 262144 mask 38850.0 262144
layer3.3.conv3.weight, mask/weight parameters,38850,38850 density 0.27896656709558826,0.27896656709558826
before tensor 262144 mask 34503.0 262144
layer3.4.conv1.weight, mask/weight parameters,34503,34503 density 0.24775247012867646,0.24775247012867646
before tensor 589824 mask 46807.0 589824
layer3.4.conv2.weight, mask/weight parameters,46807,46807 density 0.2811839196462899,0.2811839196462899
before tensor 262144 mask 36352.0 262144
layer3.4.conv3.weight, mask/weight parameters,36352,36352 density 0.2610294117647059,0.2610294117647059
before tensor 262144 mask 38562.0 262144
layer3.5.conv1.weight, mask/weight parameters,38562,38562 density 0.2768985523897059,0.2768985523897059
before tensor 589824 mask 46658.0 589824
layer3.5.conv2.weight, mask/weight parameters,46658,46658 density 0.280288831218762,0.280288831218762
before tensor 262144 mask 35039.0 262144
layer3.5.conv3.weight, mask/weight parameters,35039,35039 density 0.2516012752757353,0.2516012752757353
before tensor 524288 mask 130810.0 524288
layer4.0.conv1.weight, mask/weight parameters,130810,130810 density 0.49900054931640625,0.49900054931640625
before tensor 2359296 mask 219337.0 2359296
layer4.0.conv2.weight, mask/weight parameters,219337,219337 density 0.3718685574001736,0.3718685574001736
before tensor 1048576 mask 114648.0 1048576
layer4.0.conv3.weight, mask/weight parameters,114648,114648 density 0.2186737060546875,0.2186737060546875
layer4.0.shortcut.0.weight, mask/weight parameters,169072,169072 density 0.08061981201171875,0.08061981201171875
before tensor 1048576 mask 105423.0 1048576
layer4.1.conv1.weight, mask/weight parameters,105423,105423 density 0.2010784149169922,0.2010784149169922
before tensor 2359296 mask 178329.0 2359296
layer4.1.conv2.weight, mask/weight parameters,178329,178329 density 0.3023427327473958,0.3023427327473958
before tensor 1048576 mask 87140.0 1048576
layer4.1.conv3.weight, mask/weight parameters,87140,87140 density 0.16620635986328125,0.16620635986328125
before tensor 1048576 mask 64169.0 1048576
layer4.2.conv1.weight, mask/weight parameters,64169,64169 density 0.12239265441894531,0.12239265441894531
before tensor 2359296 mask 61942.0 2359296
layer4.2.conv2.weight, mask/weight parameters,61942,61942 density 0.10501776801215278,0.10501776801215278
before tensor 1048576 mask 35903.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35903,35903 density 0.06847953796386719,0.06847953796386719
classifier.weight, mask/weight parameters,108737,108737 density 0.5309423828125,0.5309423828125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.21814986029934577 0.21814986029934577 after dst
Death rate: 0.11727457514062632

dynamic sparse change grow
self.total_params*pruning_rate 2773782.004012498
self.total_nonzero 2365205.0
to grow 408577.0040124981
len(all_scores) 10842111 7477873
increse 408579.0 before_mask 2773781.0 after_mask 2773781.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1183,1142 density 0.6846064814814815,0.6608796296296297
before tensor 4096 mask 705.0 4096
layer1.0.conv1.weight, mask/weight parameters,705,661 density 0.234375,0.21974734042553193
before tensor 36864 mask 4120.0 36864
layer1.0.conv2.weight, mask/weight parameters,4120,3811 density 0.20723303656757708,0.1916905588250088
before tensor 16384 mask 4368.0 16384
layer1.0.conv3.weight, mask/weight parameters,4368,3799 density 0.363031914893617,0.31574135638297873
layer1.0.shortcut.0.weight, mask/weight parameters,6305,5646 density 0.38482666015625,0.3446044921875
before tensor 16384 mask 3317.0 16384
layer1.1.conv1.weight, mask/weight parameters,3317,2683 density 0.27568151595744683,0.22298869680851063
before tensor 36864 mask 4628.0 36864
layer1.1.conv2.weight, mask/weight parameters,4628,4316 density 0.2327850711734822,0.21709169558875308
before tensor 16384 mask 2831.0 16384
layer1.1.conv3.weight, mask/weight parameters,2831,2443 density 0.23528922872340424,0.20304188829787234
before tensor 16384 mask 3428.0 16384
layer1.2.conv1.weight, mask/weight parameters,3428,2885 density 0.284906914893617,0.23977726063829788
before tensor 36864 mask 3882.0 36864
layer1.2.conv2.weight, mask/weight parameters,3882,3383 density 0.1952618077561491,0.17016246667672652
before tensor 16384 mask 2276.0 16384
layer1.2.conv3.weight, mask/weight parameters,2276,1979 density 0.1891622340425532,0.1644780585106383
before tensor 32768 mask 6652.0 32768
layer2.0.conv1.weight, mask/weight parameters,6652,5756 density 0.3464583333333333,0.2997916666666667
before tensor 147456 mask 14295.0 147456
layer2.0.conv2.weight, mask/weight parameters,14295,12987 density 0.2823703703703704,0.25653333333333334
before tensor 65536 mask 8175.0 65536
layer2.0.conv3.weight, mask/weight parameters,8175,7148 density 0.212890625,0.18614583333333334
layer2.0.shortcut.0.weight, mask/weight parameters,39966,33580 density 0.3049163818359375,0.256195068359375
before tensor 65536 mask 4843.0 65536
layer2.1.conv1.weight, mask/weight parameters,4843,3870 density 0.12611979166666668,0.10078125
before tensor 147456 mask 4838.0 147456
layer2.1.conv2.weight, mask/weight parameters,4838,4425 density 0.09556543209876543,0.0874074074074074
before tensor 65536 mask 4833.0 65536
layer2.1.conv3.weight, mask/weight parameters,4833,4403 density 0.125859375,0.11466145833333333
before tensor 65536 mask 13086.0 65536
layer2.2.conv1.weight, mask/weight parameters,13086,10885 density 0.34078125,0.28346354166666665
before tensor 147456 mask 24741.0 147456
layer2.2.conv2.weight, mask/weight parameters,24741,21520 density 0.4887111111111111,0.4250864197530864
before tensor 65536 mask 15431.0 65536
layer2.2.conv3.weight, mask/weight parameters,15431,13334 density 0.40184895833333334,0.3472395833333333
before tensor 65536 mask 12654.0 65536
layer2.3.conv1.weight, mask/weight parameters,12654,10971 density 0.32953125,0.285703125
before tensor 147456 mask 22688.0 147456
layer2.3.conv2.weight, mask/weight parameters,22688,20074 density 0.448158024691358,0.39652345679012346
before tensor 65536 mask 13085.0 65536
layer2.3.conv3.weight, mask/weight parameters,13085,11479 density 0.34075520833333334,0.2989322916666667
before tensor 131072 mask 35878.0 131072
layer3.0.conv1.weight, mask/weight parameters,35878,31087 density 0.5152516084558824,0.44644703584558826
before tensor 589824 mask 84757.0 589824
layer3.0.conv2.weight, mask/weight parameters,84757,74148 density 0.5091611399461745,0.4454296424452134
before tensor 262144 mask 67081.0 262144
layer3.0.conv3.weight, mask/weight parameters,67081,58902 density 0.48168227251838236,0.4229520909926471
layer3.0.shortcut.0.weight, mask/weight parameters,129669,107964 density 0.24732398986816406,0.20592498779296875
before tensor 262144 mask 34624.0 262144
layer3.1.conv1.weight, mask/weight parameters,34624,29614 density 0.24862132352941177,0.212646484375
before tensor 589824 mask 74067.0 589824
layer3.1.conv2.weight, mask/weight parameters,74067,62451 density 0.44494305074971163,0.3751621972318339
before tensor 262144 mask 53649.0 262144
layer3.1.conv3.weight, mask/weight parameters,53649,45619 density 0.3852323644301471,0.3275720932904412
before tensor 262144 mask 35324.0 262144
layer3.2.conv1.weight, mask/weight parameters,35324,30230 density 0.2536477481617647,0.2170697380514706
before tensor 589824 mask 63587.0 589824
layer3.2.conv2.weight, mask/weight parameters,63587,54844 density 0.38198649557862363,0.3294646289888504
before tensor 262144 mask 53821.0 262144
layer3.2.conv3.weight, mask/weight parameters,53821,46518 density 0.38646742876838236,0.3340274586397059
before tensor 262144 mask 38240.0 262144
layer3.3.conv1.weight, mask/weight parameters,38240,32326 density 0.27458639705882354,0.23212028952205882
before tensor 589824 mask 53742.0 589824
layer3.3.conv2.weight, mask/weight parameters,53742,46041 density 0.32284457900807384,0.27658232410611305
before tensor 262144 mask 45533.0 262144
layer3.3.conv3.weight, mask/weight parameters,45533,38850 density 0.32695456112132354,0.27896656709558826
before tensor 262144 mask 39448.0 262144
layer3.4.conv1.weight, mask/weight parameters,39448,34503 density 0.2832605698529412,0.24775247012867646
before tensor 589824 mask 54323.0 589824
layer3.4.conv2.weight, mask/weight parameters,54323,46807 density 0.3263348231449443,0.2811839196462899
before tensor 262144 mask 43355.0 262144
layer3.4.conv3.weight, mask/weight parameters,43355,36352 density 0.31131519990808826,0.2610294117647059
before tensor 262144 mask 46027.0 262144
layer3.5.conv1.weight, mask/weight parameters,46027,38562 density 0.3305017807904412,0.2768985523897059
before tensor 589824 mask 54975.0 589824
layer3.5.conv2.weight, mask/weight parameters,54975,46658 density 0.330251585928489,0.280288831218762
before tensor 262144 mask 41134.0 262144
layer3.5.conv3.weight, mask/weight parameters,41134,35039 density 0.2953670726102941,0.2516012752757353
before tensor 524288 mask 148002.0 524288
layer4.0.conv1.weight, mask/weight parameters,148002,130810 density 0.5645828247070312,0.49900054931640625
before tensor 2359296 mask 255148.0 2359296
layer4.0.conv2.weight, mask/weight parameters,255148,219337 density 0.4325832790798611,0.3718685574001736
before tensor 1048576 mask 136496.0 1048576
layer4.0.conv3.weight, mask/weight parameters,136496,114648 density 0.260345458984375,0.2186737060546875
layer4.0.shortcut.0.weight, mask/weight parameters,211654,169072 density 0.10092449188232422,0.08061981201171875
before tensor 1048576 mask 124742.0 1048576
layer4.1.conv1.weight, mask/weight parameters,124742,105423 density 0.23792648315429688,0.2010784149169922
before tensor 2359296 mask 208701.0 2359296
layer4.1.conv2.weight, mask/weight parameters,208701,178329 density 0.3538360595703125,0.3023427327473958
before tensor 1048576 mask 104803.0 1048576
layer4.1.conv3.weight, mask/weight parameters,104803,87140 density 0.19989585876464844,0.16620635986328125
before tensor 1048576 mask 76177.0 1048576
layer4.2.conv1.weight, mask/weight parameters,76177,64169 density 0.1452960968017578,0.12239265441894531
before tensor 2359296 mask 76714.0 2359296
layer4.2.conv2.weight, mask/weight parameters,76714,61942 density 0.1300625271267361,0.10501776801215278
before tensor 1048576 mask 43674.0 1048576
layer4.2.conv3.weight, mask/weight parameters,43674,35903 density 0.08330154418945312,0.06847953796386719
classifier.weight, mask/weight parameters,116106,108737 density 0.566923828125,0.5309423828125
Total Model parameters after dst: 2773781 2365205
Total parameters under density level of 0.1: 0.2558340345344186 0.21814986029934577 after dst
Death rate: 0.11727457514062632


Training summary: Average loss: 1.2424, Accuracy: 32117/50000 (64.234%)


Evaluation: Average loss: 1.5780, Accuracy: 5721/10000 (57.210%)

Current learning rate: 0.1. Time taken for epoch: 88.72 seconds.

Train Epoch: 78 [0/50000 (0%)]	Loss: 1.283817 Accuracy: 68/100 (68.000%
Train Epoch: 78 [10000/50000 (20%)]	Loss: 1.130978 Accuracy: 6596/10100 (65.307%
Train Epoch: 78 [20000/50000 (40%)]	Loss: 1.263201 Accuracy: 13046/20100 (64.905%
Train Epoch: 78 [30000/50000 (60%)]	Loss: 1.549733 Accuracy: 19515/30100 (64.834%
Train Epoch: 78 [40000/50000 (80%)]	Loss: 1.093590 Accuracy: 25891/40100 (64.566%
current layer rate 0.4698108784706418
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4050.0
Total filter_masks items: 7866687.0
4050.0 / 7552 channels
Total channels to prune: 46.01175421028711
Layer ('layer3', 0, 'conv1'): Pruned 1/136.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/136.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/136.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/136.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/136.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/136.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/136.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/136.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/136.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/136.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/136.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/136.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 2/256.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 2/256.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 2/256.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 4026.0
Total filter_masks items: 7790209.0
After apply_mask:
Total filter_names items: 4026.0
Total filter_masks items: 7790209.0
Total pruned: 24/46.01175421028711 channels
===========done ===============

Training summary: Average loss: 1.2423, Accuracy: 32160/50000 (64.320%)


Evaluation: Average loss: 1.4641, Accuracy: 5920/10000 (59.200%)

Current learning rate: 0.1. Time taken for epoch: 88.53 seconds.

Train Epoch: 79 [0/50000 (0%)]	Loss: 1.020147 Accuracy: 72/100 (72.000%
Train Epoch: 79 [10000/50000 (20%)]	Loss: 1.074594 Accuracy: 6578/10100 (65.129%
Train Epoch: 79 [20000/50000 (40%)]	Loss: 1.476082 Accuracy: 13026/20100 (64.806%
Train Epoch: 79 [30000/50000 (60%)]	Loss: 1.279931 Accuracy: 19457/30100 (64.641%
Train Epoch: 79 [40000/50000 (80%)]	Loss: 1.265972 Accuracy: 25900/40100 (64.589%
current mest  death_rate 0.11613487782393661


dynamic sparse change prune
to kill 379614.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1137,1137 density 0.6579861111111112,0.6579861111111112
before tensor 4096 mask 643.0 4096
layer1.0.conv1.weight, mask/weight parameters,643,643 density 0.2137632978723404,0.2137632978723404
before tensor 36864 mask 3754.0 36864
layer1.0.conv2.weight, mask/weight parameters,3754,3754 density 0.18882349982395252,0.18882349982395252
before tensor 16384 mask 3885.0 16384
layer1.0.conv3.weight, mask/weight parameters,3885,3885 density 0.32288896276595747,0.32288896276595747
layer1.0.shortcut.0.weight, mask/weight parameters,5608,5608 density 0.34228515625,0.34228515625
before tensor 16384 mask 2846.0 16384
layer1.1.conv1.weight, mask/weight parameters,2846,2846 density 0.23653590425531915,0.23653590425531915
before tensor 36864 mask 4237.0 36864
layer1.1.conv2.weight, mask/weight parameters,4237,4237 density 0.2131180524118505,0.2131180524118505
before tensor 16384 mask 2438.0 16384
layer1.1.conv3.weight, mask/weight parameters,2438,2438 density 0.20262632978723405,0.20262632978723405
before tensor 16384 mask 2941.0 16384
layer1.2.conv1.weight, mask/weight parameters,2941,2941 density 0.2444315159574468,0.2444315159574468
before tensor 36864 mask 3490.0 36864
layer1.2.conv2.weight, mask/weight parameters,3490,3490 density 0.1755444897137971,0.1755444897137971
before tensor 16384 mask 1947.0 16384
layer1.2.conv3.weight, mask/weight parameters,1947,1947 density 0.1618184840425532,0.1618184840425532
before tensor 32768 mask 5676.0 32768
layer2.0.conv1.weight, mask/weight parameters,5676,5676 density 0.295625,0.295625
before tensor 147456 mask 13121.0 147456
layer2.0.conv2.weight, mask/weight parameters,13121,13121 density 0.25918024691358027,0.25918024691358027
before tensor 65536 mask 7164.0 65536
layer2.0.conv3.weight, mask/weight parameters,7164,7164 density 0.1865625,0.1865625
layer2.0.shortcut.0.weight, mask/weight parameters,33460,33460 density 0.255279541015625,0.255279541015625
before tensor 65536 mask 3979.0 65536
layer2.1.conv1.weight, mask/weight parameters,3979,3979 density 0.10361979166666667,0.10361979166666667
before tensor 147456 mask 4352.0 147456
layer2.1.conv2.weight, mask/weight parameters,4352,4352 density 0.08596543209876543,0.08596543209876543
before tensor 65536 mask 4319.0 65536
layer2.1.conv3.weight, mask/weight parameters,4319,4319 density 0.11247395833333333,0.11247395833333333
before tensor 65536 mask 11365.0 65536
layer2.2.conv1.weight, mask/weight parameters,11365,11365 density 0.29596354166666666,0.29596354166666666
before tensor 147456 mask 21993.0 147456
layer2.2.conv2.weight, mask/weight parameters,21993,21993 density 0.4344296296296296,0.4344296296296296
before tensor 65536 mask 13348.0 65536
layer2.2.conv3.weight, mask/weight parameters,13348,13348 density 0.34760416666666666,0.34760416666666666
before tensor 65536 mask 11088.0 65536
layer2.3.conv1.weight, mask/weight parameters,11088,11088 density 0.28875,0.28875
before tensor 147456 mask 20663.0 147456
layer2.3.conv2.weight, mask/weight parameters,20663,20663 density 0.40815802469135803,0.40815802469135803
before tensor 65536 mask 11384.0 65536
layer2.3.conv3.weight, mask/weight parameters,11384,11384 density 0.2964583333333333,0.2964583333333333
before tensor 131072 mask 31231.0 131072
layer3.0.conv1.weight, mask/weight parameters,31231,31231 density 0.45183738425925923,0.45183738425925923
before tensor 589824 mask 73950.0 589824
layer3.0.conv2.weight, mask/weight parameters,73950,73950 density 0.4508459076360311,0.4508459076360311
before tensor 262144 mask 59045.0 262144
layer3.0.conv3.weight, mask/weight parameters,59045,59045 density 0.4271195023148148,0.4271195023148148
layer3.0.shortcut.0.weight, mask/weight parameters,109627,109627 density 0.20909690856933594,0.20909690856933594
before tensor 262144 mask 29186.0 262144
layer3.1.conv1.weight, mask/weight parameters,29186,29186 density 0.21112557870370371,0.21112557870370371
before tensor 589824 mask 62667.0 589824
layer3.1.conv2.weight, mask/weight parameters,62667,62667 density 0.3820576131687243,0.3820576131687243
before tensor 262144 mask 45996.0 262144
layer3.1.conv3.weight, mask/weight parameters,45996,45996 density 0.33272569444444444,0.33272569444444444
before tensor 262144 mask 29962.0 262144
layer3.2.conv1.weight, mask/weight parameters,29962,29962 density 0.21673900462962964,0.21673900462962964
before tensor 589824 mask 54697.0 589824
layer3.2.conv2.weight, mask/weight parameters,54697,54697 density 0.3334674592287761,0.3334674592287761
before tensor 262144 mask 46816.0 262144
layer3.2.conv3.weight, mask/weight parameters,46816,46816 density 0.3386574074074074,0.3386574074074074
before tensor 262144 mask 32249.0 262144
layer3.3.conv1.weight, mask/weight parameters,32249,32249 density 0.23328269675925925,0.23328269675925925
before tensor 589824 mask 45966.0 589824
layer3.3.conv2.weight, mask/weight parameters,45966,45966 density 0.28023776863283034,0.28023776863283034
before tensor 262144 mask 38786.0 262144
layer3.3.conv3.weight, mask/weight parameters,38786,38786 density 0.28057002314814816,0.28057002314814816
before tensor 262144 mask 33525.0 262144
layer3.4.conv1.weight, mask/weight parameters,33525,33525 density 0.24251302083333334,0.24251302083333334
before tensor 589824 mask 46496.0 589824
layer3.4.conv2.weight, mask/weight parameters,46496,46496 density 0.28346898338667886,0.28346898338667886
before tensor 262144 mask 36605.0 262144
layer3.4.conv3.weight, mask/weight parameters,36605,36605 density 0.26479311342592593,0.26479311342592593
before tensor 262144 mask 39063.0 262144
layer3.5.conv1.weight, mask/weight parameters,39063,39063 density 0.2825737847222222,0.2825737847222222
before tensor 589824 mask 47435.0 589824
layer3.5.conv2.weight, mask/weight parameters,47435,47435 density 0.28919372046944064,0.28919372046944064
before tensor 262144 mask 35368.0 262144
layer3.5.conv3.weight, mask/weight parameters,35368,35368 density 0.2558449074074074,0.2558449074074074
before tensor 524288 mask 130885.0 524288
layer4.0.conv1.weight, mask/weight parameters,130885,130885 density 0.5032180425688977,0.5032180425688977
before tensor 2359296 mask 218517.0 2359296
layer4.0.conv2.weight, mask/weight parameters,218517,218517 density 0.37633558600450534,0.37633558600450534
before tensor 1048576 mask 113230.0 1048576
layer4.0.conv3.weight, mask/weight parameters,113230,113230 density 0.21766962967519685,0.21766962967519685
layer4.0.shortcut.0.weight, mask/weight parameters,169520,169520 density 0.08083343505859375,0.08083343505859375
before tensor 1048576 mask 105988.0 1048576
layer4.1.conv1.weight, mask/weight parameters,105988,105988 density 0.2037478469488189,0.2037478469488189
before tensor 2359296 mask 178255.0 2359296
layer4.1.conv2.weight, mask/weight parameters,178255,178255 density 0.30699533621289465,0.30699533621289465
before tensor 1048576 mask 86338.0 1048576
layer4.1.conv3.weight, mask/weight parameters,86338,86338 density 0.16597333292322836,0.16597333292322836
before tensor 1048576 mask 63056.0 1048576
layer4.2.conv1.weight, mask/weight parameters,63056,63056 density 0.12121678149606299,0.12121678149606299
before tensor 2359296 mask 62024.0 2359296
layer4.2.conv2.weight, mask/weight parameters,62024,62024 density 0.10681932474976061,0.10681932474976061
before tensor 1048576 mask 34959.0 1048576
layer4.2.conv3.weight, mask/weight parameters,34959,34959 density 0.06720403235728346,0.06720403235728346
classifier.weight, mask/weight parameters,108926,108926 density 0.531865234375,0.531865234375
Total Model parameters after dst: 2365206 2365206
Total parameters under density level of 0.1: 0.21969966837992713 0.21969966837992713 after dst
Death rate: 0.11613487782393661

dynamic sparse change grow
self.total_params*pruning_rate 2746825.846607839
self.total_nonzero 2365206.0
to grow 381619.8466078392
len(all_scores) 10765633 7395760
increse 381619.0 before_mask 2746824.0 after_mask 2746824.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1207,1137 density 0.6984953703703703,0.6579861111111112
before tensor 4096 mask 692.0 4096
layer1.0.conv1.weight, mask/weight parameters,692,643 density 0.2300531914893617,0.2137632978723404
before tensor 36864 mask 4241.0 36864
layer1.0.conv2.weight, mask/weight parameters,4241,3754 density 0.21331924953473166,0.18882349982395252
before tensor 16384 mask 4442.0 16384
layer1.0.conv3.weight, mask/weight parameters,4442,3885 density 0.36918218085106386,0.32288896276595747
layer1.0.shortcut.0.weight, mask/weight parameters,6291,5608 density 0.38397216796875,0.34228515625
before tensor 16384 mask 3043.0 16384
layer1.1.conv1.weight, mask/weight parameters,3043,2846 density 0.2529089095744681,0.23653590425531915
before tensor 36864 mask 4510.0 36864
layer1.1.conv2.weight, mask/weight parameters,4510,4237 density 0.2268497560484885,0.2131180524118505
before tensor 16384 mask 2889.0 16384
layer1.1.conv3.weight, mask/weight parameters,2889,2438 density 0.2401097074468085,0.20262632978723405
before tensor 16384 mask 3453.0 16384
layer1.2.conv1.weight, mask/weight parameters,3453,2941 density 0.2869847074468085,0.2444315159574468
before tensor 36864 mask 3983.0 36864
layer1.2.conv2.weight, mask/weight parameters,3983,3490 density 0.20034203510889795,0.1755444897137971
before tensor 16384 mask 2286.0 16384
layer1.2.conv3.weight, mask/weight parameters,2286,1947 density 0.18999335106382978,0.1618184840425532
before tensor 32768 mask 6599.0 32768
layer2.0.conv1.weight, mask/weight parameters,6599,5676 density 0.34369791666666666,0.295625
before tensor 147456 mask 14573.0 147456
layer2.0.conv2.weight, mask/weight parameters,14573,13121 density 0.28786172839506174,0.25918024691358027
before tensor 65536 mask 8160.0 65536
layer2.0.conv3.weight, mask/weight parameters,8160,7164 density 0.2125,0.1865625
layer2.0.shortcut.0.weight, mask/weight parameters,39549,33460 density 0.30173492431640625,0.255279541015625
before tensor 65536 mask 4885.0 65536
layer2.1.conv1.weight, mask/weight parameters,4885,3979 density 0.12721354166666668,0.10361979166666667
before tensor 147456 mask 4669.0 147456
layer2.1.conv2.weight, mask/weight parameters,4669,4352 density 0.09222716049382716,0.08596543209876543
before tensor 65536 mask 4972.0 65536
layer2.1.conv3.weight, mask/weight parameters,4972,4319 density 0.12947916666666667,0.11247395833333333
before tensor 65536 mask 12500.0 65536
layer2.2.conv1.weight, mask/weight parameters,12500,11365 density 0.3255208333333333,0.29596354166666666
before tensor 147456 mask 24557.0 147456
layer2.2.conv2.weight, mask/weight parameters,24557,21993 density 0.48507654320987653,0.4344296296296296
before tensor 65536 mask 15248.0 65536
layer2.2.conv3.weight, mask/weight parameters,15248,13348 density 0.39708333333333334,0.34760416666666666
before tensor 65536 mask 12749.0 65536
layer2.3.conv1.weight, mask/weight parameters,12749,11088 density 0.33200520833333336,0.28875
before tensor 147456 mask 23125.0 147456
layer2.3.conv2.weight, mask/weight parameters,23125,20663 density 0.4567901234567901,0.40815802469135803
before tensor 65536 mask 13402.0 65536
layer2.3.conv3.weight, mask/weight parameters,13402,11384 density 0.34901041666666666,0.2964583333333333
before tensor 131072 mask 36097.0 131072
layer3.0.conv1.weight, mask/weight parameters,36097,31231 density 0.5222366898148149,0.45183738425925923
before tensor 589824 mask 85028.0 589824
layer3.0.conv2.weight, mask/weight parameters,85028,73950 density 0.5183843926230758,0.4508459076360311
before tensor 262144 mask 66886.0 262144
layer3.0.conv3.weight, mask/weight parameters,66886,59045 density 0.4838396990740741,0.4271195023148148
layer3.0.shortcut.0.weight, mask/weight parameters,129005,109627 density 0.24605751037597656,0.20909690856933594
before tensor 262144 mask 34588.0 262144
layer3.1.conv1.weight, mask/weight parameters,34588,29186 density 0.2502025462962963,0.21112557870370371
before tensor 589824 mask 71004.0 589824
layer3.1.conv2.weight, mask/weight parameters,71004,62667 density 0.43288523090992226,0.3820576131687243
before tensor 262144 mask 52112.0 262144
layer3.1.conv3.weight, mask/weight parameters,52112,45996 density 0.3769675925925926,0.33272569444444444
before tensor 262144 mask 35799.0 262144
layer3.2.conv1.weight, mask/weight parameters,35799,29962 density 0.25896267361111114,0.21673900462962964
before tensor 589824 mask 63947.0 589824
layer3.2.conv2.weight, mask/weight parameters,63947,54697 density 0.389861301630849,0.3334674592287761
before tensor 262144 mask 54861.0 262144
layer3.2.conv3.weight, mask/weight parameters,54861,46816 density 0.3968532986111111,0.3386574074074074
before tensor 262144 mask 37861.0 262144
layer3.3.conv1.weight, mask/weight parameters,37861,32249 density 0.2738787615740741,0.23328269675925925
before tensor 589824 mask 53466.0 589824
layer3.3.conv2.weight, mask/weight parameters,53466,45966 density 0.32596250571559215,0.28023776863283034
before tensor 262144 mask 45211.0 262144
layer3.3.conv3.weight, mask/weight parameters,45211,38786 density 0.3270471643518518,0.28057002314814816
before tensor 262144 mask 39514.0 262144
layer3.4.conv1.weight, mask/weight parameters,39514,33525 density 0.28583622685185184,0.24251302083333334
before tensor 589824 mask 53825.0 589824
layer3.4.conv2.weight, mask/weight parameters,53825,46496 density 0.3281511964639537,0.28346898338667886
before tensor 262144 mask 43280.0 262144
layer3.4.conv3.weight, mask/weight parameters,43280,36605 density 0.3130787037037037,0.26479311342592593
before tensor 262144 mask 45892.0 262144
layer3.5.conv1.weight, mask/weight parameters,45892,39063 density 0.33197337962962964,0.2825737847222222
before tensor 589824 mask 55001.0 589824
layer3.5.conv2.weight, mask/weight parameters,55001,47435 density 0.33532083523853073,0.28919372046944064
before tensor 262144 mask 41807.0 262144
layer3.5.conv3.weight, mask/weight parameters,41807,35368 density 0.30242332175925923,0.2558449074074074
before tensor 524288 mask 146702.0 524288
layer4.0.conv1.weight, mask/weight parameters,146702,130885 density 0.5640302042322834,0.5032180425688977
before tensor 2359296 mask 250284.0 2359296
layer4.0.conv2.weight, mask/weight parameters,250284,218517 density 0.4310455287577242,0.37633558600450534
before tensor 1048576 mask 132703.0 1048576
layer4.0.conv3.weight, mask/weight parameters,132703,113230 density 0.2551038847194882,0.21766962967519685
layer4.0.shortcut.0.weight, mask/weight parameters,211798,169520 density 0.10099315643310547,0.08083343505859375
before tensor 1048576 mask 123434.0 1048576
layer4.1.conv1.weight, mask/weight parameters,123434,105988 density 0.23728546382874016,0.2037478469488189
before tensor 2359296 mask 201400.0 2359296
layer4.1.conv2.weight, mask/weight parameters,201400,178255 density 0.3468562492680541,0.30699533621289465
before tensor 1048576 mask 101351.0 1048576
layer4.1.conv3.weight, mask/weight parameters,101351,86338 density 0.19483383058562992,0.16597333292322836
before tensor 1048576 mask 75589.0 1048576
layer4.2.conv1.weight, mask/weight parameters,75589,63056 density 0.1453098086860236,0.12121678149606299
before tensor 2359296 mask 75806.0 2359296
layer4.2.conv2.weight, mask/weight parameters,75806,62024 density 0.13055503888785555,0.10681932474976061
before tensor 1048576 mask 44317.0 1048576
layer4.2.conv3.weight, mask/weight parameters,44317,34959 density 0.0851935439222441,0.06720403235728346
classifier.weight, mask/weight parameters,116231,108926 density 0.5675341796875,0.531865234375
Total Model parameters after dst: 2746824 2365206
Total parameters under density level of 0.1: 0.2551474678729992 0.21969966837992713 after dst
Death rate: 0.11613487782393661


Training summary: Average loss: 1.2400, Accuracy: 32195/50000 (64.390%)


Evaluation: Average loss: 1.5688, Accuracy: 5806/10000 (58.060%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.72 seconds.

Train Epoch: 80 [0/50000 (0%)]	Loss: 0.992015 Accuracy: 66/100 (66.000%
Train Epoch: 80 [10000/50000 (20%)]	Loss: 0.830338 Accuracy: 7368/10100 (72.950%
Train Epoch: 80 [20000/50000 (40%)]	Loss: 0.949379 Accuracy: 15002/20100 (74.637%
Train Epoch: 80 [30000/50000 (60%)]	Loss: 0.829171 Accuracy: 22753/30100 (75.591%
Train Epoch: 80 [40000/50000 (80%)]	Loss: 0.659231 Accuracy: 30646/40100 (76.424%
current layer rate 0.47322507965407373
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 4026.0
Total filter_masks items: 7790209.0
4026.0 / 7552 channels
Total channels to prune: 47.795801547565134
Layer ('layer3', 0, 'conv1'): Pruned 1/135.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/135.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/135.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/135.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/135.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/135.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/135.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/135.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/135.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/135.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/135.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/135.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 3/254.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 3/254.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 3/254.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 3/254.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 3/254.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 3/254.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3996.0
Total filter_masks items: 7689210.0
After apply_mask:
Total filter_names items: 3996.0
Total filter_masks items: 7689210.0
Total pruned: 30/47.795801547565134 channels
===========done ===============

Training summary: Average loss: 0.7926, Accuracy: 38442/50000 (76.884%)


Evaluation: Average loss: 0.9638, Accuracy: 7159/10000 (71.590%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.56 seconds.

Train Epoch: 81 [0/50000 (0%)]	Loss: 0.864753 Accuracy: 69/100 (69.000%
Train Epoch: 81 [10000/50000 (20%)]	Loss: 0.769216 Accuracy: 8129/10100 (80.485%
Train Epoch: 81 [20000/50000 (40%)]	Loss: 0.726168 Accuracy: 16141/20100 (80.303%
Train Epoch: 81 [30000/50000 (60%)]	Loss: 0.809883 Accuracy: 24200/30100 (80.399%
Train Epoch: 81 [40000/50000 (80%)]	Loss: 0.617242 Accuracy: 32298/40100 (80.544%
current mest  death_rate 0.11501588541085764


dynamic sparse change prune
to kill 347433.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1149,1149 density 0.6649305555555556,0.6649305555555556
before tensor 4096 mask 652.0 4096
layer1.0.conv1.weight, mask/weight parameters,652,652 density 0.21675531914893617,0.21675531914893617
before tensor 36864 mask 3804.0 36864
layer1.0.conv2.weight, mask/weight parameters,3804,3804 density 0.1913384638599668,0.1913384638599668
before tensor 16384 mask 3991.0 16384
layer1.0.conv3.weight, mask/weight parameters,3991,3991 density 0.33169880319148937,0.33169880319148937
layer1.0.shortcut.0.weight, mask/weight parameters,5693,5693 density 0.34747314453125,0.34747314453125
before tensor 16384 mask 2819.0 16384
layer1.1.conv1.weight, mask/weight parameters,2819,2819 density 0.23429188829787234,0.23429188829787234
before tensor 36864 mask 4257.0 36864
layer1.1.conv2.weight, mask/weight parameters,4257,4257 density 0.21412403802625624,0.21412403802625624
before tensor 16384 mask 2605.0 16384
layer1.1.conv3.weight, mask/weight parameters,2605,2605 density 0.2165059840425532,0.2165059840425532
before tensor 16384 mask 3023.0 16384
layer1.2.conv1.weight, mask/weight parameters,3023,3023 density 0.2512466755319149,0.2512466755319149
before tensor 36864 mask 3603.0 36864
layer1.2.conv2.weight, mask/weight parameters,3603,3603 density 0.1812283084351894,0.1812283084351894
before tensor 16384 mask 2018.0 16384
layer1.2.conv3.weight, mask/weight parameters,2018,2018 density 0.16771941489361702,0.16771941489361702
before tensor 32768 mask 5715.0 32768
layer2.0.conv1.weight, mask/weight parameters,5715,5715 density 0.29765625,0.29765625
before tensor 147456 mask 13258.0 147456
layer2.0.conv2.weight, mask/weight parameters,13258,13258 density 0.2618864197530864,0.2618864197530864
before tensor 65536 mask 7314.0 65536
layer2.0.conv3.weight, mask/weight parameters,7314,7314 density 0.19046875,0.19046875
layer2.0.shortcut.0.weight, mask/weight parameters,33785,33785 density 0.25775909423828125,0.25775909423828125
before tensor 65536 mask 4000.0 65536
layer2.1.conv1.weight, mask/weight parameters,4000,4000 density 0.10416666666666667,0.10416666666666667
before tensor 147456 mask 4384.0 147456
layer2.1.conv2.weight, mask/weight parameters,4384,4384 density 0.08659753086419752,0.08659753086419752
before tensor 65536 mask 4439.0 65536
layer2.1.conv3.weight, mask/weight parameters,4439,4439 density 0.11559895833333333,0.11559895833333333
before tensor 65536 mask 11382.0 65536
layer2.2.conv1.weight, mask/weight parameters,11382,11382 density 0.29640625,0.29640625
before tensor 147456 mask 22177.0 147456
layer2.2.conv2.weight, mask/weight parameters,22177,22177 density 0.4380641975308642,0.4380641975308642
before tensor 65536 mask 13602.0 65536
layer2.2.conv3.weight, mask/weight parameters,13602,13602 density 0.35421875,0.35421875
before tensor 65536 mask 11246.0 65536
layer2.3.conv1.weight, mask/weight parameters,11246,11246 density 0.2928645833333333,0.2928645833333333
before tensor 147456 mask 21034.0 147456
layer2.3.conv2.weight, mask/weight parameters,21034,21034 density 0.4154864197530864,0.4154864197530864
before tensor 65536 mask 11865.0 65536
layer2.3.conv3.weight, mask/weight parameters,11865,11865 density 0.308984375,0.308984375
before tensor 131072 mask 31607.0 131072
layer3.0.conv1.weight, mask/weight parameters,31607,31607 density 0.46068971548507465,0.46068971548507465
before tensor 589824 mask 74230.0 589824
layer3.0.conv2.weight, mask/weight parameters,74230,74230 density 0.4593326897849063,0.4593326897849063
before tensor 262144 mask 59663.0 262144
layer3.0.conv3.weight, mask/weight parameters,59663,59663 density 0.43481080923507465,0.43481080923507465
layer3.0.shortcut.0.weight, mask/weight parameters,110857,110857 density 0.2114429473876953,0.2114429473876953
before tensor 262144 mask 29331.0 262144
layer3.1.conv1.weight, mask/weight parameters,29331,29331 density 0.21375787080223882,0.21375787080223882
before tensor 589824 mask 61975.0 589824
layer3.1.conv2.weight, mask/weight parameters,61975,61975 density 0.38349917081260365,0.38349917081260365
before tensor 262144 mask 46442.0 262144
layer3.1.conv3.weight, mask/weight parameters,46442,46442 density 0.3384590718283582,0.3384590718283582
before tensor 262144 mask 29953.0 262144
layer3.2.conv1.weight, mask/weight parameters,29953,29953 density 0.218290869869403,0.218290869869403
before tensor 589824 mask 54592.0 589824
layer3.2.conv2.weight, mask/weight parameters,54592,54592 density 0.3378134204598896,0.3378134204598896
before tensor 262144 mask 47747.0 262144
layer3.2.conv3.weight, mask/weight parameters,47747,47747 density 0.3479696245335821,0.3479696245335821
before tensor 262144 mask 32485.0 262144
layer3.3.conv1.weight, mask/weight parameters,32485,32485 density 0.23674352845149255,0.23674352845149255
before tensor 589824 mask 45866.0 589824
layer3.3.conv2.weight, mask/weight parameters,45866,45866 density 0.28381723224672656,0.28381723224672656
before tensor 262144 mask 39344.0 262144
layer3.3.conv3.weight, mask/weight parameters,39344,39344 density 0.2867304104477612,0.2867304104477612
before tensor 262144 mask 33671.0 262144
layer3.4.conv1.weight, mask/weight parameters,33671,33671 density 0.2453868353544776,0.2453868353544776
before tensor 589824 mask 46314.0 589824
layer3.4.conv2.weight, mask/weight parameters,46314,46314 density 0.28658944085542437,0.28658944085542437
before tensor 262144 mask 37459.0 262144
layer3.4.conv3.weight, mask/weight parameters,37459,37459 density 0.27299294542910446,0.27299294542910446
before tensor 262144 mask 39487.0 262144
layer3.5.conv1.weight, mask/weight parameters,39487,39487 density 0.2877725629664179,0.2877725629664179
before tensor 589824 mask 47418.0 589824
layer3.5.conv2.weight, mask/weight parameters,47418,47418 density 0.29342095492685827,0.29342095492685827
before tensor 262144 mask 36266.0 262144
layer3.5.conv3.weight, mask/weight parameters,36266,36266 density 0.2642986240671642,0.2642986240671642
before tensor 524288 mask 130938.0 524288
layer4.0.conv1.weight, mask/weight parameters,130938,130938 density 0.5094388072709163,0.5094388072709163
before tensor 2359296 mask 215162.0 2359296
layer4.0.conv2.weight, mask/weight parameters,215162,215162 density 0.37946840349976807,0.37946840349976807
before tensor 1048576 mask 111953.0 1048576
layer4.0.conv3.weight, mask/weight parameters,111953,111953 density 0.21778705490537847,0.21778705490537847
layer4.0.shortcut.0.weight, mask/weight parameters,169925,169925 density 0.08102655410766602,0.08102655410766602
before tensor 1048576 mask 105919.0 1048576
layer4.1.conv1.weight, mask/weight parameters,105919,105919 density 0.2060488514691235,0.2060488514691235
before tensor 2359296 mask 175507.0 2359296
layer4.1.conv2.weight, mask/weight parameters,175507,175507 density 0.3095312420085043,0.3095312420085043
before tensor 1048576 mask 85334.0 1048576
layer4.1.conv3.weight, mask/weight parameters,85334,85334 density 0.16600395293824702,0.16600395293824702
before tensor 1048576 mask 62794.0 1048576
layer4.2.conv1.weight, mask/weight parameters,62794,62794 density 0.12215590761952191,0.12215590761952191
before tensor 2359296 mask 61043.0 2359296
layer4.2.conv2.weight, mask/weight parameters,61043,61043 density 0.10765790313733997,0.10765790313733997
before tensor 1048576 mask 34871.0 1048576
layer4.2.conv3.weight, mask/weight parameters,34871,34871 density 0.06783607756474104,0.06783607756474104
classifier.weight, mask/weight parameters,109237,109237 density 0.5333837890625,0.5333837890625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.22178023174541198 0.22178023174541198 after dst
Death rate: 0.11501588541085764

dynamic sparse change grow
self.total_params*pruning_rate 2720359.402245938
self.total_nonzero 2365205.0
to grow 355154.40224593785
len(all_scores) 10664634 7292536
increse 355154.0 before_mask 2720358.0 after_mask 2720358.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1178,1149 density 0.6817129629629629,0.6649305555555556
before tensor 4096 mask 718.0 4096
layer1.0.conv1.weight, mask/weight parameters,718,652 density 0.2386968085106383,0.21675531914893617
before tensor 36864 mask 4127.0 36864
layer1.0.conv2.weight, mask/weight parameters,4127,3804 density 0.2075851315326191,0.1913384638599668
before tensor 16384 mask 4396.0 16384
layer1.0.conv3.weight, mask/weight parameters,4396,3991 density 0.3653590425531915,0.33169880319148937
layer1.0.shortcut.0.weight, mask/weight parameters,6128,5693 density 0.3740234375,0.34747314453125
before tensor 16384 mask 3035.0 16384
layer1.1.conv1.weight, mask/weight parameters,3035,2819 density 0.25224401595744683,0.23429188829787234
before tensor 36864 mask 4462.0 36864
layer1.1.conv2.weight, mask/weight parameters,4462,4257 density 0.2244353905739148,0.21412403802625624
before tensor 16384 mask 2757.0 16384
layer1.1.conv3.weight, mask/weight parameters,2757,2605 density 0.22913896276595744,0.2165059840425532
before tensor 16384 mask 3294.0 16384
layer1.2.conv1.weight, mask/weight parameters,3294,3023 density 0.27376994680851063,0.2512466755319149
before tensor 36864 mask 3836.0 36864
layer1.2.conv2.weight, mask/weight parameters,3836,3603 density 0.19294804084301595,0.1812283084351894
before tensor 16384 mask 2204.0 16384
layer1.2.conv3.weight, mask/weight parameters,2204,2018 density 0.1831781914893617,0.16771941489361702
before tensor 32768 mask 6383.0 32768
layer2.0.conv1.weight, mask/weight parameters,6383,5715 density 0.3324479166666667,0.29765625
before tensor 147456 mask 14198.0 147456
layer2.0.conv2.weight, mask/weight parameters,14198,13258 density 0.2804543209876543,0.2618864197530864
before tensor 65536 mask 7959.0 65536
layer2.0.conv3.weight, mask/weight parameters,7959,7314 density 0.207265625,0.19046875
layer2.0.shortcut.0.weight, mask/weight parameters,37629,33785 density 0.28708648681640625,0.25775909423828125
before tensor 65536 mask 4403.0 65536
layer2.1.conv1.weight, mask/weight parameters,4403,4000 density 0.11466145833333333,0.10416666666666667
before tensor 147456 mask 4843.0 147456
layer2.1.conv2.weight, mask/weight parameters,4843,4384 density 0.09566419753086419,0.08659753086419752
before tensor 65536 mask 4690.0 65536
layer2.1.conv3.weight, mask/weight parameters,4690,4439 density 0.12213541666666666,0.11559895833333333
before tensor 65536 mask 12395.0 65536
layer2.2.conv1.weight, mask/weight parameters,12395,11382 density 0.32278645833333336,0.29640625
before tensor 147456 mask 24381.0 147456
layer2.2.conv2.weight, mask/weight parameters,24381,22177 density 0.4816,0.4380641975308642
before tensor 65536 mask 15248.0 65536
layer2.2.conv3.weight, mask/weight parameters,15248,13602 density 0.39708333333333334,0.35421875
before tensor 65536 mask 12567.0 65536
layer2.3.conv1.weight, mask/weight parameters,12567,11246 density 0.327265625,0.2928645833333333
before tensor 147456 mask 22835.0 147456
layer2.3.conv2.weight, mask/weight parameters,22835,21034 density 0.4510617283950617,0.4154864197530864
before tensor 65536 mask 13116.0 65536
layer2.3.conv3.weight, mask/weight parameters,13116,11865 density 0.3415625,0.308984375
before tensor 131072 mask 35478.0 131072
layer3.0.conv1.weight, mask/weight parameters,35478,31607 density 0.5171117070895522,0.46068971548507465
before tensor 589824 mask 82756.0 589824
layer3.0.conv2.weight, mask/weight parameters,82756,74230 density 0.5120912848691864,0.4593326897849063
before tensor 262144 mask 65484.0 262144
layer3.0.conv3.weight, mask/weight parameters,65484,59663 density 0.47723297574626866,0.43481080923507465
layer3.0.shortcut.0.weight, mask/weight parameters,122019,110857 density 0.23273277282714844,0.2114429473876953
before tensor 262144 mask 33877.0 262144
layer3.1.conv1.weight, mask/weight parameters,33877,29331 density 0.24688811800373134,0.21375787080223882
before tensor 589824 mask 71203.0 589824
layer3.1.conv2.weight, mask/weight parameters,71203,61975 density 0.4406017177792629,0.38349917081260365
before tensor 262144 mask 52205.0 262144
layer3.1.conv3.weight, mask/weight parameters,52205,46442 density 0.380458547108209,0.3384590718283582
before tensor 262144 mask 34415.0 262144
layer3.2.conv1.weight, mask/weight parameters,34415,29953 density 0.25080894356343286,0.218290869869403
before tensor 589824 mask 62205.0 589824
layer3.2.conv2.weight, mask/weight parameters,62205,54592 density 0.38492240291081903,0.3378134204598896
before tensor 262144 mask 53551.0 262144
layer3.2.conv3.weight, mask/weight parameters,53551,47747 density 0.39026789878731344,0.3479696245335821
before tensor 262144 mask 37760.0 262144
layer3.3.conv1.weight, mask/weight parameters,37760,32485 density 0.2751865671641791,0.23674352845149255
before tensor 589824 mask 53495.0 589824
layer3.3.conv2.weight, mask/weight parameters,53495,45866 density 0.33102522214796665,0.28381723224672656
before tensor 262144 mask 44921.0 262144
layer3.3.conv3.weight, mask/weight parameters,44921,39344 density 0.3273743586753731,0.2867304104477612
before tensor 262144 mask 39458.0 262144
layer3.4.conv1.weight, mask/weight parameters,39458,33671 density 0.28756121735074625,0.2453868353544776
before tensor 589824 mask 52874.0 589824
layer3.4.conv2.weight, mask/weight parameters,52874,46314 density 0.3271824954827851,0.28658944085542437
before tensor 262144 mask 42488.0 262144
layer3.4.conv3.weight, mask/weight parameters,42488,37459 density 0.30964319029850745,0.27299294542910446
before tensor 262144 mask 46106.0 262144
layer3.5.conv1.weight, mask/weight parameters,46106,39487 density 0.33601037779850745,0.2877725629664179
before tensor 589824 mask 53636.0 589824
layer3.5.conv2.weight, mask/weight parameters,53636,47418 density 0.3318977253038291,0.29342095492685827
before tensor 262144 mask 41336.0 262144
layer3.5.conv3.weight, mask/weight parameters,41336,36266 density 0.30124766791044777,0.2642986240671642
before tensor 524288 mask 143887.0 524288
layer4.0.conv1.weight, mask/weight parameters,143887,130938 density 0.5598193164840638,0.5094388072709163
before tensor 2359296 mask 243297.0 2359296
layer4.0.conv2.weight, mask/weight parameters,243297,215162 density 0.42908842716782275,0.37946840349976807
before tensor 1048576 mask 128870.0 1048576
layer4.0.conv3.weight, mask/weight parameters,128870,111953 density 0.25069643301792827,0.21778705490537847
layer4.0.shortcut.0.weight, mask/weight parameters,196047,169925 density 0.09348249435424805,0.08102655410766602
before tensor 1048576 mask 123850.0 1048576
layer4.1.conv1.weight, mask/weight parameters,123850,105919 density 0.2409308080179283,0.2060488514691235
before tensor 2359296 mask 206921.0 2359296
layer4.1.conv2.weight, mask/weight parameters,206921,175507 density 0.36493424266634217,0.3095312420085043
before tensor 1048576 mask 104253.0 1048576
layer4.1.conv3.weight, mask/weight parameters,104253,85334 density 0.20280790898904383,0.16600395293824702
before tensor 1048576 mask 84516.0 1048576
layer4.2.conv1.weight, mask/weight parameters,84516,62794 density 0.16441266185258965,0.12215590761952191
before tensor 2359296 mask 82309.0 2359296
layer4.2.conv2.weight, mask/weight parameters,82309,61043 density 0.14516348065021895,0.10765790313733997
before tensor 1048576 mask 49002.0 1048576
layer4.2.conv3.weight, mask/weight parameters,49002,34871 density 0.09532572833665338,0.06783607756474104
classifier.weight, mask/weight parameters,115357,109237 density 0.5632666015625,0.5333837890625
Total Model parameters after dst: 2720358 2365205
Total parameters under density level of 0.1: 0.25508217159632485 0.22178023174541198 after dst
Death rate: 0.11501588541085764


Training summary: Average loss: 0.6549, Accuracy: 40271/50000 (80.542%)


Evaluation: Average loss: 0.9093, Accuracy: 7323/10000 (73.230%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.73 seconds.

Train Epoch: 82 [0/50000 (0%)]	Loss: 0.476283 Accuracy: 86/100 (86.000%
Train Epoch: 82 [10000/50000 (20%)]	Loss: 0.504163 Accuracy: 8324/10100 (82.416%
Train Epoch: 82 [20000/50000 (40%)]	Loss: 0.711662 Accuracy: 16567/20100 (82.423%
Train Epoch: 82 [30000/50000 (60%)]	Loss: 0.602257 Accuracy: 24829/30100 (82.488%
Train Epoch: 82 [40000/50000 (80%)]	Loss: 0.372467 Accuracy: 33039/40100 (82.392%
current layer rate 0.47637164314974967
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3996.0
Total filter_masks items: 7689210.0
3996.0 / 7552 channels
Total channels to prune: 41.55864906690931
Layer ('layer3', 0, 'conv1'): Pruned 1/134.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/134.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/134.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/134.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/134.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/134.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/134.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/134.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/134.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/134.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/134.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/134.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 2/251.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 2/251.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 2/251.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 2/251.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 2/251.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 2/251.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3972.0
Total filter_masks items: 7613488.0
After apply_mask:
Total filter_names items: 3972.0
Total filter_masks items: 7613488.0
Total pruned: 24/41.55864906690931 channels
===========done ===============

Training summary: Average loss: 0.5960, Accuracy: 41108/50000 (82.216%)


Evaluation: Average loss: 0.9031, Accuracy: 7403/10000 (74.030%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.54 seconds.

Train Epoch: 83 [0/50000 (0%)]	Loss: 0.607998 Accuracy: 85/100 (85.000%
Train Epoch: 83 [10000/50000 (20%)]	Loss: 0.569326 Accuracy: 8418/10100 (83.347%
Train Epoch: 83 [20000/50000 (40%)]	Loss: 0.466626 Accuracy: 16774/20100 (83.453%
Train Epoch: 83 [30000/50000 (60%)]	Loss: 0.645942 Accuracy: 25038/30100 (83.183%
Train Epoch: 83 [40000/50000 (80%)]	Loss: 0.588250 Accuracy: 33304/40100 (83.052%
current mest  death_rate 0.11392021136001897


dynamic sparse change prune
to kill 329037.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1149,1149 density 0.6649305555555556,0.6649305555555556
before tensor 4096 mask 660.0 4096
layer1.0.conv1.weight, mask/weight parameters,660,660 density 0.21941489361702127,0.21941489361702127
before tensor 36864 mask 3817.0 36864
layer1.0.conv2.weight, mask/weight parameters,3817,3817 density 0.19199235450933053,0.19199235450933053
before tensor 16384 mask 3991.0 16384
layer1.0.conv3.weight, mask/weight parameters,3991,3991 density 0.33169880319148937,0.33169880319148937
layer1.0.shortcut.0.weight, mask/weight parameters,5695,5695 density 0.34759521484375,0.34759521484375
before tensor 16384 mask 2822.0 16384
layer1.1.conv1.weight, mask/weight parameters,2822,2822 density 0.23454122340425532,0.23454122340425532
before tensor 36864 mask 4262.0 36864
layer1.1.conv2.weight, mask/weight parameters,4262,4262 density 0.21437553442985766,0.21437553442985766
before tensor 16384 mask 2604.0 16384
layer1.1.conv3.weight, mask/weight parameters,2604,2604 density 0.21642287234042554,0.21642287234042554
before tensor 16384 mask 3043.0 16384
layer1.2.conv1.weight, mask/weight parameters,3043,3043 density 0.2529089095744681,0.2529089095744681
before tensor 36864 mask 3616.0 36864
layer1.2.conv2.weight, mask/weight parameters,3616,3616 density 0.18188219908455308,0.18188219908455308
before tensor 16384 mask 2039.0 16384
layer1.2.conv3.weight, mask/weight parameters,2039,2039 density 0.16946476063829788,0.16946476063829788
before tensor 32768 mask 5705.0 32768
layer2.0.conv1.weight, mask/weight parameters,5705,5705 density 0.29713541666666665,0.29713541666666665
before tensor 147456 mask 13274.0 147456
layer2.0.conv2.weight, mask/weight parameters,13274,13274 density 0.2622024691358025,0.2622024691358025
before tensor 65536 mask 7348.0 65536
layer2.0.conv3.weight, mask/weight parameters,7348,7348 density 0.19135416666666666,0.19135416666666666
layer2.0.shortcut.0.weight, mask/weight parameters,33640,33640 density 0.25665283203125,0.25665283203125
before tensor 65536 mask 3980.0 65536
layer2.1.conv1.weight, mask/weight parameters,3980,3980 density 0.10364583333333334,0.10364583333333334
before tensor 147456 mask 4417.0 147456
layer2.1.conv2.weight, mask/weight parameters,4417,4417 density 0.08724938271604939,0.08724938271604939
before tensor 65536 mask 4434.0 65536
layer2.1.conv3.weight, mask/weight parameters,4434,4434 density 0.11546875,0.11546875
before tensor 65536 mask 11364.0 65536
layer2.2.conv1.weight, mask/weight parameters,11364,11364 density 0.2959375,0.2959375
before tensor 147456 mask 22322.0 147456
layer2.2.conv2.weight, mask/weight parameters,22322,22322 density 0.4409283950617284,0.4409283950617284
before tensor 65536 mask 13754.0 65536
layer2.2.conv3.weight, mask/weight parameters,13754,13754 density 0.3581770833333333,0.3581770833333333
before tensor 65536 mask 11289.0 65536
layer2.3.conv1.weight, mask/weight parameters,11289,11289 density 0.293984375,0.293984375
before tensor 147456 mask 21135.0 147456
layer2.3.conv2.weight, mask/weight parameters,21135,21135 density 0.4174814814814815,0.4174814814814815
before tensor 65536 mask 11931.0 65536
layer2.3.conv3.weight, mask/weight parameters,11931,11931 density 0.310703125,0.310703125
before tensor 131072 mask 31702.0 131072
layer3.0.conv1.weight, mask/weight parameters,31702,31702 density 0.4655486372180451,0.4655486372180451
before tensor 589824 mask 73940.0 589824
layer3.0.conv2.weight, mask/weight parameters,73940,73940 density 0.46444431881709286,0.46444431881709286
before tensor 262144 mask 59667.0 262144
layer3.0.conv3.weight, mask/weight parameters,59667,59667 density 0.4381094337406015,0.4381094337406015
layer3.0.shortcut.0.weight, mask/weight parameters,110529,110529 density 0.2108173370361328,0.2108173370361328
before tensor 262144 mask 29276.0 262144
layer3.1.conv1.weight, mask/weight parameters,29276,29276 density 0.21496123120300753,0.21496123120300753
before tensor 589824 mask 61388.0 589824
layer3.1.conv2.weight, mask/weight parameters,61388,61388 density 0.3856005929610995,0.3856005929610995
before tensor 262144 mask 46723.0 262144
layer3.1.conv3.weight, mask/weight parameters,46723,46723 density 0.3430671405075188,0.3430671405075188
before tensor 262144 mask 29631.0 262144
layer3.2.conv1.weight, mask/weight parameters,29631,29631 density 0.21756784539473684,0.21756784539473684
before tensor 589824 mask 53968.0 589824
layer3.2.conv2.weight, mask/weight parameters,53968,53968 density 0.3389928455223271,0.3389928455223271
before tensor 262144 mask 47841.0 262144
layer3.2.conv3.weight, mask/weight parameters,47841,47841 density 0.3512761395676692,0.3512761395676692
before tensor 262144 mask 32613.0 262144
layer3.3.conv1.weight, mask/weight parameters,32613,32613 density 0.23946340460526316,0.23946340460526316
before tensor 589824 mask 45937.0 589824
layer3.3.conv2.weight, mask/weight parameters,45937,45937 density 0.2885471824925723,0.2885471824925723
before tensor 262144 mask 39878.0 262144
layer3.3.conv3.weight, mask/weight parameters,39878,39878 density 0.2928072133458647,0.2928072133458647
before tensor 262144 mask 33932.0 262144
layer3.4.conv1.weight, mask/weight parameters,33932,33932 density 0.24914826127819548,0.24914826127819548
before tensor 589824 mask 46242.0 589824
layer3.4.conv2.weight, mask/weight parameters,46242,46242 density 0.29046299960427385,0.29046299960427385
before tensor 262144 mask 37800.0 262144
layer3.4.conv3.weight, mask/weight parameters,37800,37800 density 0.27754934210526316,0.27754934210526316
before tensor 262144 mask 39826.0 262144
layer3.5.conv1.weight, mask/weight parameters,39826,39826 density 0.29242539943609025,0.29242539943609025
before tensor 589824 mask 46811.0 589824
layer3.5.conv2.weight, mask/weight parameters,46811,46811 density 0.29403709775692366,0.29403709775692366
before tensor 262144 mask 36460.0 262144
layer3.5.conv3.weight, mask/weight parameters,36460,36460 density 0.2677102913533835,0.2677102913533835
before tensor 524288 mask 130832.0 524288
layer4.0.conv1.weight, mask/weight parameters,130832,130832 density 0.5131149598393574,0.5131149598393574
before tensor 2359296 mask 213449.0 2359296
layer4.0.conv2.weight, mask/weight parameters,213449,213449 density 0.38251891994573567,0.38251891994573567
before tensor 1048576 mask 111252.0 1048576
layer4.0.conv3.weight, mask/weight parameters,111252,111252 density 0.2181617093373494,0.2181617093373494
layer4.0.shortcut.0.weight, mask/weight parameters,169230,169230 density 0.08069515228271484,0.08069515228271484
before tensor 1048576 mask 105773.0 1048576
layer4.1.conv1.weight, mask/weight parameters,105773,105773 density 0.2074175608684739,0.2074175608684739
before tensor 2359296 mask 176008.0 2359296
layer4.1.conv2.weight, mask/weight parameters,176008,176008 density 0.31542143585497723,0.31542143585497723
before tensor 1048576 mask 85352.0 1048576
layer4.1.conv3.weight, mask/weight parameters,85352,85352 density 0.1673726154618474,0.1673726154618474
before tensor 1048576 mask 64062.0 1048576
layer4.2.conv1.weight, mask/weight parameters,64062,64062 density 0.12562358810240964,0.12562358810240964
before tensor 2359296 mask 61910.0 2359296
layer4.2.conv2.weight, mask/weight parameters,61910,61910 density 0.11094803130415459,0.11094803130415459
before tensor 1048576 mask 35623.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35623,35623 density 0.06985559425200803,0.06985559425200803
classifier.weight, mask/weight parameters,109259,109259 density 0.5334912109375,0.5334912109375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.22336619664041027 0.22336619664041027 after dst
Death rate: 0.11392021136001897

dynamic sparse change grow
self.total_params*pruning_rate 2694444.484533932
self.total_nonzero 2365205.0
to grow 329239.48453393206
len(all_scores) 10588912 7219338
increse 329239.0 before_mask 2694443.0 after_mask 2694443.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1184,1149 density 0.6851851851851852,0.6649305555555556
before tensor 4096 mask 742.0 4096
layer1.0.conv1.weight, mask/weight parameters,742,660 density 0.2466755319148936,0.21941489361702127
before tensor 36864 mask 4156.0 36864
layer1.0.conv2.weight, mask/weight parameters,4156,3817 density 0.20904381067350736,0.19199235450933053
before tensor 16384 mask 4302.0 16384
layer1.0.conv3.weight, mask/weight parameters,4302,3991 density 0.3575465425531915,0.33169880319148937
layer1.0.shortcut.0.weight, mask/weight parameters,6183,5695 density 0.37738037109375,0.34759521484375
before tensor 16384 mask 3075.0 16384
layer1.1.conv1.weight, mask/weight parameters,3075,2822 density 0.25556848404255317,0.23454122340425532
before tensor 36864 mask 4629.0 36864
layer1.1.conv2.weight, mask/weight parameters,4629,4262 density 0.2328353704542025,0.21437553442985766
before tensor 16384 mask 2774.0 16384
layer1.1.conv3.weight, mask/weight parameters,2774,2604 density 0.23055186170212766,0.21642287234042554
before tensor 16384 mask 3390.0 16384
layer1.2.conv1.weight, mask/weight parameters,3390,3043 density 0.28174867021276595,0.2529089095744681
before tensor 36864 mask 3930.0 36864
layer1.2.conv2.weight, mask/weight parameters,3930,3616 density 0.1976761732307228,0.18188219908455308
before tensor 16384 mask 2171.0 16384
layer1.2.conv3.weight, mask/weight parameters,2171,2039 density 0.18043550531914893,0.16946476063829788
before tensor 32768 mask 6471.0 32768
layer2.0.conv1.weight, mask/weight parameters,6471,5705 density 0.33703125,0.29713541666666665
before tensor 147456 mask 14243.0 147456
layer2.0.conv2.weight, mask/weight parameters,14243,13274 density 0.2813432098765432,0.2622024691358025
before tensor 65536 mask 7811.0 65536
layer2.0.conv3.weight, mask/weight parameters,7811,7348 density 0.20341145833333332,0.19135416666666666
layer2.0.shortcut.0.weight, mask/weight parameters,36277,33640 density 0.27677154541015625,0.25665283203125
before tensor 65536 mask 4260.0 65536
layer2.1.conv1.weight, mask/weight parameters,4260,3980 density 0.1109375,0.10364583333333334
before tensor 147456 mask 4680.0 147456
layer2.1.conv2.weight, mask/weight parameters,4680,4417 density 0.09244444444444444,0.08724938271604939
before tensor 65536 mask 4605.0 65536
layer2.1.conv3.weight, mask/weight parameters,4605,4434 density 0.119921875,0.11546875
before tensor 65536 mask 12020.0 65536
layer2.2.conv1.weight, mask/weight parameters,12020,11364 density 0.31302083333333336,0.2959375
before tensor 147456 mask 23807.0 147456
layer2.2.conv2.weight, mask/weight parameters,23807,22322 density 0.47026172839506175,0.4409283950617284
before tensor 65536 mask 14816.0 65536
layer2.2.conv3.weight, mask/weight parameters,14816,13754 density 0.3858333333333333,0.3581770833333333
before tensor 65536 mask 12092.0 65536
layer2.3.conv1.weight, mask/weight parameters,12092,11289 density 0.3148958333333333,0.293984375
before tensor 147456 mask 22555.0 147456
layer2.3.conv2.weight, mask/weight parameters,22555,21135 density 0.44553086419753085,0.4174814814814815
before tensor 65536 mask 13050.0 65536
layer2.3.conv3.weight, mask/weight parameters,13050,11931 density 0.33984375,0.310703125
before tensor 131072 mask 34495.0 131072
layer3.0.conv1.weight, mask/weight parameters,34495,31702 density 0.5065642622180451,0.4655486372180451
before tensor 589824 mask 80545.0 589824
layer3.0.conv2.weight, mask/weight parameters,80545,73940 density 0.5059327516786954,0.46444431881709286
before tensor 262144 mask 65238.0 262144
layer3.0.conv3.weight, mask/weight parameters,65238,59667 density 0.47901492011278196,0.4381094337406015
layer3.0.shortcut.0.weight, mask/weight parameters,119440,110529 density 0.227813720703125,0.2108173370361328
before tensor 262144 mask 33066.0 262144
layer3.1.conv1.weight, mask/weight parameters,33066,29276 density 0.24278959116541354,0.21496123120300753
before tensor 589824 mask 68798.0 589824
layer3.1.conv2.weight, mask/weight parameters,68798,61388 density 0.43214552672407835,0.3856005929610995
before tensor 262144 mask 52432.0 262144
layer3.1.conv3.weight, mask/weight parameters,52432,46723 density 0.3849859022556391,0.3430671405075188
before tensor 262144 mask 33357.0 262144
layer3.2.conv1.weight, mask/weight parameters,33357,29631 density 0.24492628054511278,0.21756784539473684
before tensor 589824 mask 61519.0 589824
layer3.2.conv2.weight, mask/weight parameters,61519,53968 density 0.38642345211399426,0.3389928455223271
before tensor 262144 mask 53162.0 262144
layer3.2.conv3.weight, mask/weight parameters,53162,47841 density 0.39034598214285715,0.3512761395676692
before tensor 262144 mask 37450.0 262144
layer3.3.conv1.weight, mask/weight parameters,37450,32613 density 0.2749794407894737,0.23946340460526316
before tensor 589824 mask 54479.0 589824
layer3.3.conv2.weight, mask/weight parameters,54479,45937 density 0.34220262435537463,0.2885471824925723
before tensor 262144 mask 46109.0 262144
layer3.3.conv3.weight, mask/weight parameters,46109,39878 density 0.33855879934210525,0.2928072133458647
before tensor 262144 mask 40661.0 262144
layer3.4.conv1.weight, mask/weight parameters,40661,33932 density 0.2985564497180451,0.24914826127819548
before tensor 589824 mask 53601.0 589824
layer3.4.conv2.weight, mask/weight parameters,53601,46242 density 0.3366875836207059,0.29046299960427385
before tensor 262144 mask 43085.0 262144
layer3.4.conv3.weight, mask/weight parameters,43085,37800 density 0.31635485197368424,0.27754934210526316
before tensor 262144 mask 46852.0 262144
layer3.5.conv1.weight, mask/weight parameters,46852,39826 density 0.3440143327067669,0.29242539943609025
before tensor 589824 mask 54462.0 589824
layer3.5.conv2.weight, mask/weight parameters,54462,46811 density 0.3420958411065257,0.29403709775692366
before tensor 262144 mask 41906.0 262144
layer3.5.conv3.weight, mask/weight parameters,41906,36460 density 0.30769795582706766,0.2677102913533835
before tensor 524288 mask 145172.0 524288
layer4.0.conv1.weight, mask/weight parameters,145172,130832 density 0.569355547188755,0.5131149598393574
before tensor 2359296 mask 242287.0 2359296
layer4.0.conv2.weight, mask/weight parameters,242287,213449 density 0.43419908997883544,0.38251891994573567
before tensor 1048576 mask 128571.0 1048576
layer4.0.conv3.weight, mask/weight parameters,128571,111252 density 0.2521237292921687,0.2181617093373494
layer4.0.shortcut.0.weight, mask/weight parameters,192992,169230 density 0.0920257568359375,0.08069515228271484
before tensor 1048576 mask 127405.0 1048576
layer4.1.conv1.weight, mask/weight parameters,127405,105773 density 0.24983723958333334,0.2074175608684739
before tensor 2359296 mask 207603.0 2359296
layer4.1.conv2.weight, mask/weight parameters,207603,176008 density 0.3720423864131224,0.31542143585497723
before tensor 1048576 mask 99121.0 1048576
layer4.1.conv3.weight, mask/weight parameters,99121,85352 density 0.19437319590863453,0.1673726154618474
before tensor 1048576 mask 81372.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81372,64062 density 0.1595679593373494,0.12562358810240964
before tensor 2359296 mask 80048.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80048,61910 density 0.143452883376433,0.11094803130415459
before tensor 1048576 mask 42944.0 1048576
layer4.2.conv3.weight, mask/weight parameters,42944,35623 density 0.08421184738955824,0.06985559425200803
classifier.weight, mask/weight parameters,113048,109259 density 0.5519921875,0.5334912109375
Total Model parameters after dst: 2694443 2365205
Total parameters under density level of 0.1: 0.25445890947058586 0.22336619664041027 after dst
Death rate: 0.11392021136001897


Training summary: Average loss: 0.5633, Accuracy: 41502/50000 (83.004%)


Evaluation: Average loss: 0.8830, Accuracy: 7445/10000 (74.450%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.73 seconds.

Train Epoch: 84 [0/50000 (0%)]	Loss: 0.518100 Accuracy: 86/100 (86.000%
Train Epoch: 84 [10000/50000 (20%)]	Loss: 0.548821 Accuracy: 8530/10100 (84.455%
Train Epoch: 84 [20000/50000 (40%)]	Loss: 0.432759 Accuracy: 16924/20100 (84.199%
Train Epoch: 84 [30000/50000 (60%)]	Loss: 0.664928 Accuracy: 25354/30100 (84.233%
Train Epoch: 84 [40000/50000 (80%)]	Loss: 0.594954 Accuracy: 33739/40100 (84.137%
current layer rate 0.4792614929449249
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3972.0
Total filter_masks items: 7613488.0
3972.0 / 7552 channels
Total channels to prune: 39.38279472007298
Layer ('layer3', 0, 'conv1'): Pruned 1/133.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/133.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/133.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/133.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/133.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/133.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/133.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/133.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/133.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/133.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/133.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/133.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 2/249.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 2/249.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 2/249.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 2/249.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 2/249.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 2/249.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3948.0
Total filter_masks items: 7538090.0
After apply_mask:
Total filter_names items: 3948.0
Total filter_masks items: 7538090.0
Total pruned: 24/39.38279472007298 channels
===========done ===============

Training summary: Average loss: 0.5317, Accuracy: 41981/50000 (83.962%)


Evaluation: Average loss: 0.9302, Accuracy: 7305/10000 (73.050%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.54 seconds.

Train Epoch: 85 [0/50000 (0%)]	Loss: 0.460959 Accuracy: 84/100 (84.000%
Train Epoch: 85 [10000/50000 (20%)]	Loss: 0.348775 Accuracy: 8530/10100 (84.455%
Train Epoch: 85 [20000/50000 (40%)]	Loss: 0.386578 Accuracy: 16995/20100 (84.552%
Train Epoch: 85 [30000/50000 (60%)]	Loss: 0.581737 Accuracy: 25446/30100 (84.538%
Train Epoch: 85 [40000/50000 (80%)]	Loss: 0.257325 Accuracy: 33864/40100 (84.449%
current mest  death_rate 0.11285041466893497


dynamic sparse change prune
to kill 300679.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1146,1146 density 0.6631944444444444,0.6631944444444444
before tensor 4096 mask 674.0 4096
layer1.0.conv1.weight, mask/weight parameters,674,674 density 0.22406914893617022,0.22406914893617022
before tensor 36864 mask 3855.0 36864
layer1.0.conv2.weight, mask/weight parameters,3855,3855 density 0.19390372717670137,0.19390372717670137
before tensor 16384 mask 4023.0 16384
layer1.0.conv3.weight, mask/weight parameters,4023,4023 density 0.3343583776595745,0.3343583776595745
layer1.0.shortcut.0.weight, mask/weight parameters,5681,5681 density 0.34674072265625,0.34674072265625
before tensor 16384 mask 2811.0 16384
layer1.1.conv1.weight, mask/weight parameters,2811,2811 density 0.23362699468085107,0.23362699468085107
before tensor 36864 mask 4259.0 36864
layer1.1.conv2.weight, mask/weight parameters,4259,4259 density 0.2142246365876968,0.2142246365876968
before tensor 16384 mask 2595.0 16384
layer1.1.conv3.weight, mask/weight parameters,2595,2595 density 0.21567486702127658,0.21567486702127658
before tensor 16384 mask 3050.0 16384
layer1.2.conv1.weight, mask/weight parameters,3050,3050 density 0.2534906914893617,0.2534906914893617
before tensor 36864 mask 3641.0 36864
layer1.2.conv2.weight, mask/weight parameters,3641,3641 density 0.18313968110256024,0.18313968110256024
before tensor 16384 mask 2022.0 16384
layer1.2.conv3.weight, mask/weight parameters,2022,2022 density 0.16805186170212766,0.16805186170212766
before tensor 32768 mask 5734.0 32768
layer2.0.conv1.weight, mask/weight parameters,5734,5734 density 0.29864583333333333,0.29864583333333333
before tensor 147456 mask 13309.0 147456
layer2.0.conv2.weight, mask/weight parameters,13309,13309 density 0.2628938271604938,0.2628938271604938
before tensor 65536 mask 7335.0 65536
layer2.0.conv3.weight, mask/weight parameters,7335,7335 density 0.191015625,0.191015625
layer2.0.shortcut.0.weight, mask/weight parameters,33414,33414 density 0.2549285888671875,0.2549285888671875
before tensor 65536 mask 3960.0 65536
layer2.1.conv1.weight, mask/weight parameters,3960,3960 density 0.103125,0.103125
before tensor 147456 mask 4369.0 147456
layer2.1.conv2.weight, mask/weight parameters,4369,4369 density 0.08630123456790123,0.08630123456790123
before tensor 65536 mask 4432.0 65536
layer2.1.conv3.weight, mask/weight parameters,4432,4432 density 0.11541666666666667,0.11541666666666667
before tensor 65536 mask 11267.0 65536
layer2.2.conv1.weight, mask/weight parameters,11267,11267 density 0.2934114583333333,0.2934114583333333
before tensor 147456 mask 22281.0 147456
layer2.2.conv2.weight, mask/weight parameters,22281,22281 density 0.4401185185185185,0.4401185185185185
before tensor 65536 mask 13753.0 65536
layer2.2.conv3.weight, mask/weight parameters,13753,13753 density 0.35815104166666667,0.35815104166666667
before tensor 65536 mask 11246.0 65536
layer2.3.conv1.weight, mask/weight parameters,11246,11246 density 0.2928645833333333,0.2928645833333333
before tensor 147456 mask 21132.0 147456
layer2.3.conv2.weight, mask/weight parameters,21132,21132 density 0.4174222222222222,0.4174222222222222
before tensor 65536 mask 12008.0 65536
layer2.3.conv3.weight, mask/weight parameters,12008,12008 density 0.3127083333333333,0.3127083333333333
before tensor 131072 mask 31275.0 131072
layer3.0.conv1.weight, mask/weight parameters,31275,31275 density 0.46275745738636365,0.46275745738636365
before tensor 589824 mask 72658.0 589824
layer3.0.conv2.weight, mask/weight parameters,72658,72658 density 0.46333282318130803,0.46333282318130803
before tensor 262144 mask 59400.0 262144
layer3.0.conv3.weight, mask/weight parameters,59400,59400 density 0.439453125,0.439453125
layer3.0.shortcut.0.weight, mask/weight parameters,109984,109984 density 0.20977783203125,0.20977783203125
before tensor 262144 mask 29144.0 262144
layer3.1.conv1.weight, mask/weight parameters,29144,29144 density 0.21561316287878787,0.21561316287878787
before tensor 589824 mask 60249.0 589824
layer3.1.conv2.weight, mask/weight parameters,60249,60249 density 0.38420186715641264,0.38420186715641264
before tensor 262144 mask 47094.0 262144
layer3.1.conv3.weight, mask/weight parameters,47094,47094 density 0.3484108664772727,0.3484108664772727
before tensor 262144 mask 29397.0 262144
layer3.2.conv1.weight, mask/weight parameters,29397,29397 density 0.21748490767045456,0.21748490767045456
before tensor 589824 mask 53505.0 589824
layer3.2.conv2.weight, mask/weight parameters,53505,53505 density 0.34119605142332415,0.34119605142332415
before tensor 262144 mask 47915.0 262144
layer3.2.conv3.weight, mask/weight parameters,47915,47915 density 0.35448478929924243,0.35448478929924243
before tensor 262144 mask 32621.0 262144
layer3.3.conv1.weight, mask/weight parameters,32621,32621 density 0.24133670691287878,0.24133670691287878
before tensor 589824 mask 46202.0 589824
layer3.3.conv2.weight, mask/weight parameters,46202,46202 density 0.2946255484134272,0.2946255484134272
before tensor 262144 mask 40524.0 262144
layer3.3.conv3.weight, mask/weight parameters,40524,40524 density 0.2998046875,0.2998046875
before tensor 262144 mask 34748.0 262144
layer3.4.conv1.weight, mask/weight parameters,34748,34748 density 0.25707267992424243,0.25707267992424243
before tensor 589824 mask 46600.0 589824
layer3.4.conv2.weight, mask/weight parameters,46600,46600 density 0.29716355473931233,0.29716355473931233
before tensor 262144 mask 38247.0 262144
layer3.4.conv3.weight, mask/weight parameters,38247,38247 density 0.282958984375,0.282958984375
before tensor 262144 mask 40520.0 262144
layer3.5.conv1.weight, mask/weight parameters,40520,40520 density 0.2997750946969697,0.2997750946969697
before tensor 589824 mask 46950.0 589824
layer3.5.conv2.weight, mask/weight parameters,46950,46950 density 0.2993954698500153,0.2993954698500153
before tensor 262144 mask 36878.0 262144
layer3.5.conv3.weight, mask/weight parameters,36878,36878 density 0.2728308475378788,0.2728308475378788
before tensor 524288 mask 131223.0 524288
layer4.0.conv1.weight, mask/weight parameters,131223,131223 density 0.5188156313259109,0.5188156313259109
before tensor 2359296 mask 211851.0 2359296
layer4.0.conv2.weight, mask/weight parameters,211851,211851 density 0.38582832041174253,0.38582832041174253
before tensor 1048576 mask 110845.0 1048576
layer4.0.conv3.weight, mask/weight parameters,110845,110845 density 0.21912362411437247,0.21912362411437247
layer4.0.shortcut.0.weight, mask/weight parameters,168593,168593 density 0.08039140701293945,0.08039140701293945
before tensor 1048576 mask 106869.0 1048576
layer4.1.conv1.weight, mask/weight parameters,106869,106869 density 0.21126367978238866,0.21126367978238866
before tensor 2359296 mask 176962.0 2359296
layer4.1.conv2.weight, mask/weight parameters,176962,176962 density 0.3222876041968307,0.3222876041968307
before tensor 1048576 mask 85242.0 1048576
layer4.1.conv3.weight, mask/weight parameters,85242,85242 density 0.16851040612348178,0.16851040612348178
before tensor 1048576 mask 64875.0 1048576
layer4.2.conv1.weight, mask/weight parameters,64875,64875 density 0.1282479598937247,0.1282479598937247
before tensor 2359296 mask 62407.0 2359296
layer4.2.conv2.weight, mask/weight parameters,62407,62407 density 0.11365718354851105,0.11365718354851105
before tensor 1048576 mask 35400.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35400,35400 density 0.06998038967611336,0.06998038967611336
classifier.weight, mask/weight parameters,109030,109030 density 0.532373046875,0.532373046875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.2249680744230711 0.2249680744230711 after dst
Death rate: 0.11285041466893497

dynamic sparse change grow
self.total_params*pruning_rate 2669141.6189629193
self.total_nonzero 2365205.0
to grow 303936.61896291934
len(all_scores) 10513514 7147670
increse 303936.0 before_mask 2669140.0 after_mask 2669140.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1194,1146 density 0.6909722222222222,0.6631944444444444
before tensor 4096 mask 715.0 4096
layer1.0.conv1.weight, mask/weight parameters,715,674 density 0.2376994680851064,0.22406914893617022
before tensor 36864 mask 4073.0 36864
layer1.0.conv2.weight, mask/weight parameters,4073,3855 density 0.20486897037372365,0.19390372717670137
before tensor 16384 mask 4284.0 16384
layer1.0.conv3.weight, mask/weight parameters,4284,4023 density 0.3560505319148936,0.3343583776595745
layer1.0.shortcut.0.weight, mask/weight parameters,6149,5681 density 0.37530517578125,0.34674072265625
before tensor 16384 mask 2922.0 16384
layer1.1.conv1.weight, mask/weight parameters,2922,2811 density 0.24285239361702127,0.23362699468085107
before tensor 36864 mask 4375.0 36864
layer1.1.conv2.weight, mask/weight parameters,4375,4259 density 0.22005935315124994,0.2142246365876968
before tensor 16384 mask 2714.0 16384
layer1.1.conv3.weight, mask/weight parameters,2714,2595 density 0.22556515957446807,0.21567486702127658
before tensor 16384 mask 3317.0 16384
layer1.2.conv1.weight, mask/weight parameters,3317,3050 density 0.27568151595744683,0.2534906914893617
before tensor 36864 mask 3923.0 36864
layer1.2.conv2.weight, mask/weight parameters,3923,3641 density 0.1973240782656808,0.18313968110256024
before tensor 16384 mask 2154.0 16384
layer1.2.conv3.weight, mask/weight parameters,2154,2022 density 0.17902260638297873,0.16805186170212766
before tensor 32768 mask 6161.0 32768
layer2.0.conv1.weight, mask/weight parameters,6161,5734 density 0.32088541666666665,0.29864583333333333
before tensor 147456 mask 14178.0 147456
layer2.0.conv2.weight, mask/weight parameters,14178,13309 density 0.2800592592592593,0.2628938271604938
before tensor 65536 mask 8008.0 65536
layer2.0.conv3.weight, mask/weight parameters,8008,7335 density 0.20854166666666665,0.191015625
layer2.0.shortcut.0.weight, mask/weight parameters,36786,33414 density 0.2806549072265625,0.2549285888671875
before tensor 65536 mask 4867.0 65536
layer2.1.conv1.weight, mask/weight parameters,4867,3960 density 0.12674479166666666,0.103125
before tensor 147456 mask 4590.0 147456
layer2.1.conv2.weight, mask/weight parameters,4590,4369 density 0.09066666666666667,0.08630123456790123
before tensor 65536 mask 4611.0 65536
layer2.1.conv3.weight, mask/weight parameters,4611,4432 density 0.120078125,0.11541666666666667
before tensor 65536 mask 12256.0 65536
layer2.2.conv1.weight, mask/weight parameters,12256,11267 density 0.31916666666666665,0.2934114583333333
before tensor 147456 mask 23881.0 147456
layer2.2.conv2.weight, mask/weight parameters,23881,22281 density 0.47172345679012345,0.4401185185185185
before tensor 65536 mask 14693.0 65536
layer2.2.conv3.weight, mask/weight parameters,14693,13753 density 0.38263020833333333,0.35815104166666667
before tensor 65536 mask 12357.0 65536
layer2.3.conv1.weight, mask/weight parameters,12357,11246 density 0.321796875,0.2928645833333333
before tensor 147456 mask 22961.0 147456
layer2.3.conv2.weight, mask/weight parameters,22961,21132 density 0.45355061728395063,0.4174222222222222
before tensor 65536 mask 12878.0 65536
layer2.3.conv3.weight, mask/weight parameters,12878,12008 density 0.33536458333333335,0.3127083333333333
before tensor 131072 mask 34541.0 131072
layer3.0.conv1.weight, mask/weight parameters,34541,31275 density 0.5110825047348485,0.46275745738636365
before tensor 589824 mask 79698.0 589824
layer3.0.conv2.weight, mask/weight parameters,79698,72658 density 0.5082262014080196,0.46333282318130803
before tensor 262144 mask 64792.0 262144
layer3.0.conv3.weight, mask/weight parameters,64792,59400 density 0.4793442234848485,0.439453125
layer3.0.shortcut.0.weight, mask/weight parameters,117999,109984 density 0.2250652313232422,0.20977783203125
before tensor 262144 mask 33661.0 262144
layer3.1.conv1.weight, mask/weight parameters,33661,29144 density 0.24903083570075757,0.21561316287878787
before tensor 589824 mask 69927.0 589824
layer3.1.conv2.weight, mask/weight parameters,69927,60249 density 0.44591750841750843,0.38420186715641264
before tensor 262144 mask 53130.0 262144
layer3.1.conv3.weight, mask/weight parameters,53130,47094 density 0.39306640625,0.3484108664772727
before tensor 262144 mask 34236.0 262144
layer3.2.conv1.weight, mask/weight parameters,34236,29397 density 0.25328480113636365,0.21748490767045456
before tensor 589824 mask 62100.0 589824
layer3.2.conv2.weight, mask/weight parameters,62100,53505 density 0.39600550964187325,0.34119605142332415
before tensor 262144 mask 53391.0 262144
layer3.2.conv3.weight, mask/weight parameters,53391,47915 density 0.3949973366477273,0.35448478929924243
before tensor 262144 mask 36907.0 262144
layer3.3.conv1.weight, mask/weight parameters,36907,32621 density 0.2730453953598485,0.24133670691287878
before tensor 589824 mask 52032.0 589824
layer3.3.conv2.weight, mask/weight parameters,52032,46202 density 0.3318028772574227,0.2946255484134272
before tensor 262144 mask 45377.0 262144
layer3.3.conv3.weight, mask/weight parameters,45377,40524 density 0.33570815577651514,0.2998046875
before tensor 262144 mask 40866.0 262144
layer3.4.conv1.weight, mask/weight parameters,40866,34748 density 0.3023348721590909,0.25707267992424243
before tensor 589824 mask 53872.0 589824
layer3.4.conv2.weight, mask/weight parameters,53872,46600 density 0.34353637383940416,0.29716355473931233
before tensor 262144 mask 43085.0 262144
layer3.4.conv3.weight, mask/weight parameters,43085,38247 density 0.3187514796401515,0.282958984375
before tensor 262144 mask 45609.0 262144
layer3.5.conv1.weight, mask/weight parameters,45609,40520 density 0.3374245383522727,0.2997750946969697
before tensor 589824 mask 52862.0 589824
layer3.5.conv2.weight, mask/weight parameters,52862,46950 density 0.33709570451994697,0.2993954698500153
before tensor 262144 mask 41901.0 262144
layer3.5.conv3.weight, mask/weight parameters,41901,36878 density 0.3099920099431818,0.2728308475378788
before tensor 524288 mask 143772.0 524288
layer4.0.conv1.weight, mask/weight parameters,143772,131223 density 0.5684305414979757,0.5188156313259109
before tensor 2359296 mask 234634.0 2359296
layer4.0.conv2.weight, mask/weight parameters,234634,211851 density 0.4273212877517161,0.38582832041174253
before tensor 1048576 mask 125866.0 1048576
layer4.0.conv3.weight, mask/weight parameters,125866,110845 density 0.24881784539473684,0.21912362411437247
layer4.0.shortcut.0.weight, mask/weight parameters,183416,168593 density 0.08745956420898438,0.08039140701293945
before tensor 1048576 mask 130866.0 1048576
layer4.1.conv1.weight, mask/weight parameters,130866,106869 density 0.25870208122469635,0.21126367978238866
before tensor 2359296 mask 205676.0 2359296
layer4.1.conv2.weight, mask/weight parameters,205676,176962 density 0.3745822565340997,0.3222876041968307
before tensor 1048576 mask 97904.0 1048576
layer4.1.conv3.weight, mask/weight parameters,97904,85242 density 0.19354124493927125,0.16851040612348178
before tensor 1048576 mask 83932.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83932,64875 density 0.16592073633603238,0.1282479598937247
before tensor 2359296 mask 77991.0 2359296
layer4.2.conv2.weight, mask/weight parameters,77991,62407 density 0.14203915269331846,0.11365718354851105
before tensor 1048576 mask 42593.0 1048576
layer4.2.conv3.weight, mask/weight parameters,42593,35400 density 0.08419985134109312,0.06998038967611336
classifier.weight, mask/weight parameters,112457,109030 density 0.5491064453125,0.532373046875
Total Model parameters after dst: 2669140 2365205
Total parameters under density level of 0.1: 0.2538770576612158 0.2249680744230711 after dst
Death rate: 0.11285041466893497


Training summary: Average loss: 0.5061, Accuracy: 42256/50000 (84.512%)


Evaluation: Average loss: 0.8973, Accuracy: 7441/10000 (74.410%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.73 seconds.

Train Epoch: 86 [0/50000 (0%)]	Loss: 0.317542 Accuracy: 92/100 (92.000%
Train Epoch: 86 [10000/50000 (20%)]	Loss: 0.446515 Accuracy: 8738/10100 (86.515%
Train Epoch: 86 [20000/50000 (40%)]	Loss: 0.434723 Accuracy: 17332/20100 (86.229%
Train Epoch: 86 [30000/50000 (60%)]	Loss: 0.490460 Accuracy: 25863/30100 (85.924%
Train Epoch: 86 [40000/50000 (80%)]	Loss: 0.537615 Accuracy: 34361/40100 (85.688%
current layer rate 0.4819055530268548
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3948.0
Total filter_masks items: 7538090.0
3948.0 / 7552 channels
Total channels to prune: 35.350736458807205
Layer ('layer3', 0, 'conv1'): Pruned 1/132.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/132.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/132.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/132.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/132.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/132.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/132.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/132.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/132.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/132.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/132.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/132.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 2/247.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 2/247.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 2/247.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 2/247.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 2/247.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 2/247.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3924.0
Total filter_masks items: 7463016.0
After apply_mask:
Total filter_names items: 3924.0
Total filter_masks items: 7463016.0
Total pruned: 24/35.350736458807205 channels
===========done ===============

Training summary: Average loss: 0.4755, Accuracy: 42744/50000 (85.488%)


Evaluation: Average loss: 0.9058, Accuracy: 7414/10000 (74.140%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.56 seconds.

Train Epoch: 87 [0/50000 (0%)]	Loss: 0.554574 Accuracy: 83/100 (83.000%
Train Epoch: 87 [10000/50000 (20%)]	Loss: 0.594257 Accuracy: 8745/10100 (86.584%
Train Epoch: 87 [20000/50000 (40%)]	Loss: 0.447358 Accuracy: 17344/20100 (86.289%
Train Epoch: 87 [30000/50000 (60%)]	Loss: 0.457065 Accuracy: 25961/30100 (86.249%
Train Epoch: 87 [40000/50000 (80%)]	Loss: 0.602491 Accuracy: 34474/40100 (85.970%
current mest  death_rate 0.1118089938973469


dynamic sparse change prune
to kill 273674.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1153,1153 density 0.6672453703703703,0.6672453703703703
before tensor 4096 mask 681.0 4096
layer1.0.conv1.weight, mask/weight parameters,681,681 density 0.22639627659574468,0.22639627659574468
before tensor 36864 mask 3815.0 36864
layer1.0.conv2.weight, mask/weight parameters,3815,3815 density 0.19189175594788996,0.19189175594788996
before tensor 16384 mask 4037.0 16384
layer1.0.conv3.weight, mask/weight parameters,4037,4037 density 0.3355219414893617,0.3355219414893617
layer1.0.shortcut.0.weight, mask/weight parameters,5716,5716 density 0.348876953125,0.348876953125
before tensor 16384 mask 2757.0 16384
layer1.1.conv1.weight, mask/weight parameters,2757,2757 density 0.22913896276595744,0.22913896276595744
before tensor 36864 mask 4236.0 36864
layer1.1.conv2.weight, mask/weight parameters,4236,4236 density 0.21306775313113022,0.21306775313113022
before tensor 16384 mask 2575.0 16384
layer1.1.conv3.weight, mask/weight parameters,2575,2575 density 0.21401263297872342,0.21401263297872342
before tensor 16384 mask 3039.0 16384
layer1.2.conv1.weight, mask/weight parameters,3039,3039 density 0.25257646276595747,0.25257646276595747
before tensor 36864 mask 3667.0 36864
layer1.2.conv2.weight, mask/weight parameters,3667,3667 density 0.18444746240128765,0.18444746240128765
before tensor 16384 mask 2029.0 16384
layer1.2.conv3.weight, mask/weight parameters,2029,2029 density 0.16863364361702127,0.16863364361702127
before tensor 32768 mask 5661.0 32768
layer2.0.conv1.weight, mask/weight parameters,5661,5661 density 0.29484375,0.29484375
before tensor 147456 mask 13378.0 147456
layer2.0.conv2.weight, mask/weight parameters,13378,13378 density 0.26425679012345676,0.26425679012345676
before tensor 65536 mask 7408.0 65536
layer2.0.conv3.weight, mask/weight parameters,7408,7408 density 0.19291666666666665,0.19291666666666665
layer2.0.shortcut.0.weight, mask/weight parameters,33446,33446 density 0.2551727294921875,0.2551727294921875
before tensor 65536 mask 4029.0 65536
layer2.1.conv1.weight, mask/weight parameters,4029,4029 density 0.104921875,0.104921875
before tensor 147456 mask 4364.0 147456
layer2.1.conv2.weight, mask/weight parameters,4364,4364 density 0.08620246913580247,0.08620246913580247
before tensor 65536 mask 4406.0 65536
layer2.1.conv3.weight, mask/weight parameters,4406,4406 density 0.11473958333333334,0.11473958333333334
before tensor 65536 mask 11314.0 65536
layer2.2.conv1.weight, mask/weight parameters,11314,11314 density 0.29463541666666665,0.29463541666666665
before tensor 147456 mask 22210.0 147456
layer2.2.conv2.weight, mask/weight parameters,22210,22210 density 0.438716049382716,0.438716049382716
before tensor 65536 mask 13732.0 65536
layer2.2.conv3.weight, mask/weight parameters,13732,13732 density 0.35760416666666667,0.35760416666666667
before tensor 65536 mask 11298.0 65536
layer2.3.conv1.weight, mask/weight parameters,11298,11298 density 0.29421875,0.29421875
before tensor 147456 mask 21334.0 147456
layer2.3.conv2.weight, mask/weight parameters,21334,21334 density 0.42141234567901237,0.42141234567901237
before tensor 65536 mask 12009.0 65536
layer2.3.conv3.weight, mask/weight parameters,12009,12009 density 0.312734375,0.312734375
before tensor 131072 mask 31177.0 131072
layer3.0.conv1.weight, mask/weight parameters,31177,31177 density 0.46482884064885494,0.46482884064885494
before tensor 589824 mask 71819.0 589824
layer3.0.conv2.weight, mask/weight parameters,71819,71819 density 0.46500139204527063,0.46500139204527063
before tensor 262144 mask 59423.0 262144
layer3.0.conv3.weight, mask/weight parameters,59423,59423 density 0.44297918654580154,0.44297918654580154
layer3.0.shortcut.0.weight, mask/weight parameters,109460,109460 density 0.20877838134765625,0.20877838134765625
before tensor 262144 mask 29351.0 262144
layer3.1.conv1.weight, mask/weight parameters,29351,29351 density 0.21880218272900764,0.21880218272900764
before tensor 589824 mask 60395.0 589824
layer3.1.conv2.weight, mask/weight parameters,60395,60395 density 0.3910352284572901,0.3910352284572901
before tensor 262144 mask 47688.0 262144
layer3.1.conv3.weight, mask/weight parameters,47688,47688 density 0.3554985687022901,0.3554985687022901
before tensor 262144 mask 29715.0 262144
layer3.2.conv1.weight, mask/weight parameters,29715,29715 density 0.2215156846374046,0.2215156846374046
before tensor 589824 mask 53642.0 589824
layer3.2.conv2.weight, mask/weight parameters,53642,53642 density 0.3473120577018951,0.3473120577018951
before tensor 262144 mask 48104.0 262144
layer3.2.conv3.weight, mask/weight parameters,48104,48104 density 0.358599713740458,0.358599713740458
before tensor 262144 mask 32425.0 262144
layer3.3.conv1.weight, mask/weight parameters,32425,32425 density 0.2417178554389313,0.2417178554389313
before tensor 589824 mask 45510.0 589824
layer3.3.conv2.weight, mask/weight parameters,45510,45510 density 0.2946603733271177,0.2946603733271177
before tensor 262144 mask 40625.0 262144
layer3.3.conv3.weight, mask/weight parameters,40625,40625 density 0.3028461951335878,0.3028461951335878
before tensor 262144 mask 35319.0 262144
layer3.4.conv1.weight, mask/weight parameters,35319,35319 density 0.26329168654580154,0.26329168654580154
before tensor 589824 mask 46753.0 589824
layer3.4.conv2.weight, mask/weight parameters,46753,46753 density 0.30270833737997654,0.30270833737997654
before tensor 262144 mask 38491.0 262144
layer3.4.conv3.weight, mask/weight parameters,38491,38491 density 0.28693791746183206,0.28693791746183206
before tensor 262144 mask 40426.0 262144
layer3.5.conv1.weight, mask/weight parameters,40426,40426 density 0.3013627146946565,0.3013627146946565
before tensor 589824 mask 46346.0 589824
layer3.5.conv2.weight, mask/weight parameters,46346,46346 density 0.30007316330957146,0.30007316330957146
before tensor 262144 mask 37142.0 262144
layer3.5.conv3.weight, mask/weight parameters,37142,37142 density 0.2768815601145038,0.2768815601145038
before tensor 524288 mask 131244.0 524288
layer4.0.conv1.weight, mask/weight parameters,131244,131244 density 0.5231345663265307,0.5231345663265307
before tensor 2359296 mask 209056.0 2359296
layer4.0.conv2.weight, mask/weight parameters,209056,209056 density 0.3869794992827063,0.3869794992827063
before tensor 1048576 mask 110246.0 1048576
layer4.0.conv3.weight, mask/weight parameters,110246,110246 density 0.2197185905612245,0.2197185905612245
layer4.0.shortcut.0.weight, mask/weight parameters,166857,166857 density 0.07956361770629883,0.07956361770629883
before tensor 1048576 mask 108979.0 1048576
layer4.1.conv1.weight, mask/weight parameters,108979,108979 density 0.21719347895408164,0.21719347895408164
before tensor 2359296 mask 177601.0 2359296
layer4.1.conv2.weight, mask/weight parameters,177601,177601 density 0.3287537600074043,0.3287537600074043
before tensor 1048576 mask 85095.0 1048576
layer4.1.conv3.weight, mask/weight parameters,85095,85095 density 0.1695930325255102,0.1695930325255102
before tensor 1048576 mask 66675.0 1048576
layer4.2.conv1.weight, mask/weight parameters,66675,66675 density 0.13288225446428573,0.13288225446428573
before tensor 2359296 mask 62848.0 2359296
layer4.2.conv2.weight, mask/weight parameters,62848,62848 density 0.11633671155537045,0.11633671155537045
before tensor 1048576 mask 35613.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35613,35613 density 0.07097616390306122,0.07097616390306122
classifier.weight, mask/weight parameters,108886,108886 density 0.531669921875,0.531669921875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.22658606075237295 0.22658606075237295 after dst
Death rate: 0.1118089938973469

dynamic sparse change grow
self.total_params*pruning_rate 2644509.901547854
self.total_nonzero 2365205.0
to grow 279304.90154785383
len(all_scores) 10438440 7075416
increse 279304.0 before_mask 2644508.0 after_mask 2644508.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1184,1153 density 0.6851851851851852,0.6672453703703703
before tensor 4096 mask 729.0 4096
layer1.0.conv1.weight, mask/weight parameters,729,681 density 0.24235372340425532,0.22639627659574468
before tensor 36864 mask 4068.0 36864
layer1.0.conv2.weight, mask/weight parameters,4068,3815 density 0.20461747397012223,0.19189175594788996
before tensor 16384 mask 4275.0 16384
layer1.0.conv3.weight, mask/weight parameters,4275,4037 density 0.3553025265957447,0.3355219414893617
layer1.0.shortcut.0.weight, mask/weight parameters,6029,5716 density 0.36798095703125,0.348876953125
before tensor 16384 mask 2892.0 16384
layer1.1.conv1.weight, mask/weight parameters,2892,2757 density 0.2403590425531915,0.22913896276595744
before tensor 36864 mask 4415.0 36864
layer1.1.conv2.weight, mask/weight parameters,4415,4236 density 0.22207132438006136,0.21306775313113022
before tensor 16384 mask 2729.0 16384
layer1.1.conv3.weight, mask/weight parameters,2729,2575 density 0.22681183510638298,0.21401263297872342
before tensor 16384 mask 3254.0 16384
layer1.2.conv1.weight, mask/weight parameters,3254,3039 density 0.27044547872340424,0.25257646276595747
before tensor 36864 mask 3944.0 36864
layer1.2.conv2.weight, mask/weight parameters,3944,3667 density 0.1983803631608068,0.18444746240128765
before tensor 16384 mask 2138.0 16384
layer1.2.conv3.weight, mask/weight parameters,2138,2029 density 0.17769281914893617,0.16863364361702127
before tensor 32768 mask 6193.0 32768
layer2.0.conv1.weight, mask/weight parameters,6193,5661 density 0.32255208333333335,0.29484375
before tensor 147456 mask 14100.0 147456
layer2.0.conv2.weight, mask/weight parameters,14100,13378 density 0.2785185185185185,0.26425679012345676
before tensor 65536 mask 7806.0 65536
layer2.0.conv3.weight, mask/weight parameters,7806,7408 density 0.20328125,0.19291666666666665
layer2.0.shortcut.0.weight, mask/weight parameters,35982,33446 density 0.2745208740234375,0.2551727294921875
before tensor 65536 mask 4438.0 65536
layer2.1.conv1.weight, mask/weight parameters,4438,4029 density 0.11557291666666666,0.104921875
before tensor 147456 mask 4610.0 147456
layer2.1.conv2.weight, mask/weight parameters,4610,4364 density 0.09106172839506173,0.08620246913580247
before tensor 65536 mask 4571.0 65536
layer2.1.conv3.weight, mask/weight parameters,4571,4406 density 0.11903645833333333,0.11473958333333334
before tensor 65536 mask 12070.0 65536
layer2.2.conv1.weight, mask/weight parameters,12070,11314 density 0.3143229166666667,0.29463541666666665
before tensor 147456 mask 24107.0 147456
layer2.2.conv2.weight, mask/weight parameters,24107,22210 density 0.47618765432098764,0.438716049382716
before tensor 65536 mask 14853.0 65536
layer2.2.conv3.weight, mask/weight parameters,14853,13732 density 0.386796875,0.35760416666666667
before tensor 65536 mask 11959.0 65536
layer2.3.conv1.weight, mask/weight parameters,11959,11298 density 0.3114322916666667,0.29421875
before tensor 147456 mask 22648.0 147456
layer2.3.conv2.weight, mask/weight parameters,22648,21334 density 0.4473679012345679,0.42141234567901237
before tensor 65536 mask 12721.0 65536
layer2.3.conv3.weight, mask/weight parameters,12721,12009 density 0.3312760416666667,0.312734375
before tensor 131072 mask 34207.0 131072
layer3.0.conv1.weight, mask/weight parameters,34207,31177 density 0.5100041746183206,0.46482884064885494
before tensor 589824 mask 77740.0 589824
layer3.0.conv2.weight, mask/weight parameters,77740,71819 density 0.5033376713348743,0.46500139204527063
before tensor 262144 mask 64556.0 262144
layer3.0.conv3.weight, mask/weight parameters,64556,59423 density 0.481244036259542,0.44297918654580154
layer3.0.shortcut.0.weight, mask/weight parameters,117280,109460 density 0.22369384765625,0.20877838134765625
before tensor 262144 mask 32737.0 262144
layer3.1.conv1.weight, mask/weight parameters,32737,29351 density 0.24404371421755724,0.21880218272900764
before tensor 589824 mask 68919.0 589824
layer3.1.conv2.weight, mask/weight parameters,68919,60395 density 0.44622496746498846,0.3910352284572901
before tensor 262144 mask 53254.0 262144
layer3.1.conv3.weight, mask/weight parameters,53254,47688 density 0.3969912929389313,0.3554985687022901
before tensor 262144 mask 34905.0 262144
layer3.2.conv1.weight, mask/weight parameters,34905,29715 density 0.2602054508587786,0.2215156846374046
before tensor 589824 mask 60944.0 589824
layer3.2.conv2.weight, mask/weight parameters,60944,53642 density 0.3945897998692125,0.3473120577018951
before tensor 262144 mask 53274.0 262144
layer3.2.conv3.weight, mask/weight parameters,53274,48104 density 0.3971403864503817,0.358599713740458
before tensor 262144 mask 36793.0 262144
layer3.3.conv1.weight, mask/weight parameters,36793,32425 density 0.27427987833969464,0.2417178554389313
before tensor 589824 mask 50992.0 589824
layer3.3.conv2.weight, mask/weight parameters,50992,45510 density 0.3301542904130166,0.2946603733271177
before tensor 262144 mask 44964.0 262144
layer3.3.conv3.weight, mask/weight parameters,44964,40625 density 0.3351920324427481,0.3028461951335878
before tensor 262144 mask 41960.0 262144
layer3.4.conv1.weight, mask/weight parameters,41960,35319 density 0.31279818702290074,0.26329168654580154
before tensor 589824 mask 54049.0 589824
layer3.4.conv2.weight, mask/weight parameters,54049,46753 density 0.34994723177230025,0.30270833737997654
before tensor 262144 mask 43286.0 262144
layer3.4.conv3.weight, mask/weight parameters,43286,38491 density 0.3226830868320611,0.28693791746183206
before tensor 262144 mask 47059.0 262144
layer3.5.conv1.weight, mask/weight parameters,47059,40426 density 0.3508095777671756,0.3013627146946565
before tensor 589824 mask 52939.0 589824
layer3.5.conv2.weight, mask/weight parameters,52939,46346 density 0.3427603933984681,0.30007316330957146
before tensor 262144 mask 42048.0 262144
layer3.5.conv3.weight, mask/weight parameters,42048,37142 density 0.31345419847328243,0.2768815601145038
before tensor 524288 mask 144149.0 524288
layer4.0.conv1.weight, mask/weight parameters,144149,131244 density 0.5745735012755102,0.5231345663265307
before tensor 2359296 mask 231798.0 2359296
layer4.0.conv2.weight, mask/weight parameters,231798,209056 density 0.4290767735665695,0.3869794992827063
before tensor 1048576 mask 122363.0 1048576
layer4.0.conv3.weight, mask/weight parameters,122363,110246 density 0.2438675860969388,0.2197185905612245
layer4.0.shortcut.0.weight, mask/weight parameters,178724,166857 density 0.08522224426269531,0.07956361770629883
before tensor 1048576 mask 129346.0 1048576
layer4.1.conv1.weight, mask/weight parameters,129346,108979 density 0.25778459821428573,0.21719347895408164
before tensor 2359296 mask 203891.0 2359296
layer4.1.conv2.weight, mask/weight parameters,203891,177601 density 0.3774186681475311,0.3287537600074043
before tensor 1048576 mask 94256.0 1048576
layer4.1.conv3.weight, mask/weight parameters,94256,85095 density 0.18785076530612244,0.1695930325255102
before tensor 1048576 mask 83969.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83969,66675 density 0.16734893176020407,0.13288225446428573
before tensor 2359296 mask 80125.0 2359296
layer4.2.conv2.weight, mask/weight parameters,80125,62848 density 0.14831783053357397,0.11633671155537045
before tensor 1048576 mask 41508.0 1048576
layer4.2.conv3.weight, mask/weight parameters,41508,35613 density 0.08272480867346939,0.07097616390306122
classifier.weight, mask/weight parameters,110758,108886 density 0.540810546875,0.531669921875
Total Model parameters after dst: 2644508 2365205
Total parameters under density level of 0.1: 0.2533432198681029 0.22658606075237295 after dst
Death rate: 0.1118089938973469


Training summary: Average loss: 0.4650, Accuracy: 42886/50000 (85.772%)


Evaluation: Average loss: 0.9223, Accuracy: 7415/10000 (74.150%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.75 seconds.

Train Epoch: 88 [0/50000 (0%)]	Loss: 0.381440 Accuracy: 88/100 (88.000%
Train Epoch: 88 [10000/50000 (20%)]	Loss: 0.437872 Accuracy: 8774/10100 (86.871%
Train Epoch: 88 [20000/50000 (40%)]	Loss: 0.353600 Accuracy: 17454/20100 (86.836%
Train Epoch: 88 [30000/50000 (60%)]	Loss: 0.475697 Accuracy: 26044/30100 (86.525%
Train Epoch: 88 [40000/50000 (80%)]	Loss: 0.377504 Accuracy: 34688/40100 (86.504%
current layer rate 0.48431474738279473
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3924.0
Total filter_masks items: 7463016.0
3924.0 / 7552 channels
Total channels to prune: 29.544972234865327
Layer ('layer4', 0, 'conv1'): Pruned 1/245.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/245.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/245.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/245.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/245.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/245.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3918.0
Total filter_masks items: 7438549.0
After apply_mask:
Total filter_names items: 3918.0
Total filter_masks items: 7438549.0
Total pruned: 6/29.544972234865327 channels
===========done ===============

Training summary: Average loss: 0.4438, Accuracy: 43124/50000 (86.248%)


Evaluation: Average loss: 0.9183, Accuracy: 7453/10000 (74.530%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.54 seconds.

Train Epoch: 89 [0/50000 (0%)]	Loss: 0.497426 Accuracy: 88/100 (88.000%
Train Epoch: 89 [10000/50000 (20%)]	Loss: 0.372573 Accuracy: 8874/10100 (87.861%
Train Epoch: 89 [20000/50000 (40%)]	Loss: 0.444225 Accuracy: 17574/20100 (87.433%
Train Epoch: 89 [30000/50000 (60%)]	Loss: 0.360836 Accuracy: 26254/30100 (87.223%
Train Epoch: 89 [40000/50000 (80%)]	Loss: 0.501513 Accuracy: 34827/40100 (86.850%
current mest  death_rate 0.1107983813317212


dynamic sparse change prune
to kill 271722.7999999989 expect 2365203.200000001
conv1.weight, mask/weight parameters,1151,1151 density 0.6660879629629629,0.6660879629629629
before tensor 4096 mask 675.0 4096
layer1.0.conv1.weight, mask/weight parameters,675,675 density 0.22440159574468085,0.22440159574468085
before tensor 36864 mask 3824.0 36864
layer1.0.conv2.weight, mask/weight parameters,3824,3824 density 0.19234444947437251,0.19234444947437251
before tensor 16384 mask 3977.0 16384
layer1.0.conv3.weight, mask/weight parameters,3977,3977 density 0.33053523936170215,0.33053523936170215
layer1.0.shortcut.0.weight, mask/weight parameters,5655,5655 density 0.34515380859375,0.34515380859375
before tensor 16384 mask 2707.0 16384
layer1.1.conv1.weight, mask/weight parameters,2707,2707 density 0.22498337765957446,0.22498337765957446
before tensor 36864 mask 4228.0 36864
layer1.1.conv2.weight, mask/weight parameters,4228,4228 density 0.21266535888536794,0.21266535888536794
before tensor 16384 mask 2555.0 16384
layer1.1.conv3.weight, mask/weight parameters,2555,2555 density 0.21235039893617022,0.21235039893617022
before tensor 16384 mask 2974.0 16384
layer1.2.conv1.weight, mask/weight parameters,2974,2974 density 0.2471742021276596,0.2471742021276596
before tensor 36864 mask 3673.0 36864
layer1.2.conv2.weight, mask/weight parameters,3673,3673 density 0.18474925808560938,0.18474925808560938
before tensor 16384 mask 2014.0 16384
layer1.2.conv3.weight, mask/weight parameters,2014,2014 density 0.1673869680851064,0.1673869680851064
before tensor 32768 mask 5634.0 32768
layer2.0.conv1.weight, mask/weight parameters,5634,5634 density 0.2934375,0.2934375
before tensor 147456 mask 13310.0 147456
layer2.0.conv2.weight, mask/weight parameters,13310,13310 density 0.2629135802469136,0.2629135802469136
before tensor 65536 mask 7359.0 65536
layer2.0.conv3.weight, mask/weight parameters,7359,7359 density 0.191640625,0.191640625
layer2.0.shortcut.0.weight, mask/weight parameters,33067,33067 density 0.25228118896484375,0.25228118896484375
before tensor 65536 mask 3939.0 65536
layer2.1.conv1.weight, mask/weight parameters,3939,3939 density 0.102578125,0.102578125
before tensor 147456 mask 4332.0 147456
layer2.1.conv2.weight, mask/weight parameters,4332,4332 density 0.08557037037037037,0.08557037037037037
before tensor 65536 mask 4364.0 65536
layer2.1.conv3.weight, mask/weight parameters,4364,4364 density 0.11364583333333333,0.11364583333333333
before tensor 65536 mask 11179.0 65536
layer2.2.conv1.weight, mask/weight parameters,11179,11179 density 0.2911197916666667,0.2911197916666667
before tensor 147456 mask 22253.0 147456
layer2.2.conv2.weight, mask/weight parameters,22253,22253 density 0.4395654320987654,0.4395654320987654
before tensor 65536 mask 13690.0 65536
layer2.2.conv3.weight, mask/weight parameters,13690,13690 density 0.35651041666666666,0.35651041666666666
before tensor 65536 mask 11131.0 65536
layer2.3.conv1.weight, mask/weight parameters,11131,11131 density 0.28986979166666665,0.28986979166666665
before tensor 147456 mask 21191.0 147456
layer2.3.conv2.weight, mask/weight parameters,21191,21191 density 0.41858765432098766,0.41858765432098766
before tensor 65536 mask 11957.0 65536
layer2.3.conv3.weight, mask/weight parameters,11957,11957 density 0.31138020833333335,0.31138020833333335
before tensor 131072 mask 31041.0 131072
layer3.0.conv1.weight, mask/weight parameters,31041,31041 density 0.4628011688931298,0.4628011688931298
before tensor 589824 mask 71414.0 589824
layer3.0.conv2.weight, mask/weight parameters,71414,71414 density 0.4623791672331967,0.4623791672331967
before tensor 262144 mask 59462.0 262144
layer3.0.conv3.weight, mask/weight parameters,59462,59462 density 0.4432699188931298,0.4432699188931298
layer3.0.shortcut.0.weight, mask/weight parameters,108168,108168 density 0.2063140869140625,0.2063140869140625
before tensor 262144 mask 29201.0 262144
layer3.1.conv1.weight, mask/weight parameters,29201,29201 density 0.21768398139312978,0.21768398139312978
before tensor 589824 mask 60746.0 589824
layer3.1.conv2.weight, mask/weight parameters,60746,60746 density 0.3933078232944208,0.3933078232944208
before tensor 262144 mask 47955.0 262144
layer3.1.conv3.weight, mask/weight parameters,47955,47955 density 0.35748896708015265,0.35748896708015265
before tensor 262144 mask 30309.0 262144
layer3.2.conv1.weight, mask/weight parameters,30309,30309 density 0.22594376192748092,0.22594376192748092
before tensor 589824 mask 54003.0 589824
layer3.2.conv2.weight, mask/weight parameters,54003,54003 density 0.34964939883068197,0.34964939883068197
before tensor 262144 mask 48518.0 262144
layer3.2.conv3.weight, mask/weight parameters,48518,48518 density 0.3616859494274809,0.3616859494274809
before tensor 262144 mask 32708.0 262144
layer3.3.conv1.weight, mask/weight parameters,32708,32708 density 0.2438275286259542,0.2438275286259542
before tensor 589824 mask 45698.0 589824
layer3.3.conv2.weight, mask/weight parameters,45698,45698 density 0.2958776036102532,0.2958776036102532
before tensor 262144 mask 40793.0 262144
layer3.3.conv3.weight, mask/weight parameters,40793,40793 density 0.30409858062977096,0.30409858062977096
before tensor 262144 mask 36227.0 262144
layer3.4.conv1.weight, mask/weight parameters,36227,36227 density 0.27006053196564883,0.27006053196564883
before tensor 589824 mask 47589.0 589824
layer3.4.conv2.weight, mask/weight parameters,47589,47589 density 0.3081211273624303,0.3081211273624303
before tensor 262144 mask 39033.0 262144
layer3.4.conv3.weight, mask/weight parameters,39033,39033 density 0.2909783516221374,0.2909783516221374
before tensor 262144 mask 41373.0 262144
layer3.5.conv1.weight, mask/weight parameters,41373,41373 density 0.30842229246183206,0.30842229246183206
before tensor 589824 mask 47250.0 589824
layer3.5.conv2.weight, mask/weight parameters,47250,47250 density 0.30592622807528697,0.30592622807528697
before tensor 262144 mask 37701.0 262144
layer3.5.conv3.weight, mask/weight parameters,37701,37701 density 0.281048723759542,0.281048723759542
before tensor 524288 mask 131333.0 524288
layer4.0.conv1.weight, mask/weight parameters,131333,131333 density 0.525634765625,0.525634765625
before tensor 2359296 mask 207347.0 2359296
layer4.0.conv2.weight, mask/weight parameters,207347,207347 density 0.3869684821881812,0.3869684821881812
before tensor 1048576 mask 108957.0 1048576
layer4.0.conv3.weight, mask/weight parameters,108957,108957 density 0.21803959080430327,0.21803959080430327
layer4.0.shortcut.0.weight, mask/weight parameters,163842,163842 density 0.0781259536743164,0.0781259536743164
before tensor 1048576 mask 109579.0 1048576
layer4.1.conv1.weight, mask/weight parameters,109579,109579 density 0.2192843077612705,0.2192843077612705
before tensor 2359296 mask 178317.0 2359296
layer4.1.conv2.weight, mask/weight parameters,178317,178317 density 0.33279024455791456,0.33279024455791456
before tensor 1048576 mask 83998.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83998,83998 density 0.16809282146516394,0.16809282146516394
before tensor 1048576 mask 67907.0 1048576
layer4.2.conv1.weight, mask/weight parameters,67907,67907 density 0.13589227394979508,0.13589227394979508
before tensor 2359296 mask 64100.0 2359296
layer4.2.conv2.weight, mask/weight parameters,64100,64100 density 0.1196288333482636,0.1196288333482636
before tensor 1048576 mask 35406.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35406,35406 density 0.07085281121926229,0.07085281121926229
classifier.weight, mask/weight parameters,108391,108391 density 0.5292529296875,0.5292529296875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.22711841100413838 0.22711841100413838 after dst
Death rate: 0.1107983813317212

dynamic sparse change grow
self.total_params*pruning_rate 2620606.860806072
self.total_nonzero 2365205.0
to grow 255401.86080607213
len(all_scores) 10413973 7051239
increse 255401.0 before_mask 2620605.0 after_mask 2620605.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1186,1151 density 0.6863425925925926,0.6660879629629629
before tensor 4096 mask 711.0 4096
layer1.0.conv1.weight, mask/weight parameters,711,675 density 0.23636968085106383,0.22440159574468085
before tensor 36864 mask 3983.0 36864
layer1.0.conv2.weight, mask/weight parameters,3983,3824 density 0.20034203510889795,0.19234444947437251
before tensor 16384 mask 4105.0 16384
layer1.0.conv3.weight, mask/weight parameters,4105,3977 density 0.34117353723404253,0.33053523936170215
layer1.0.shortcut.0.weight, mask/weight parameters,5954,5655 density 0.3634033203125,0.34515380859375
before tensor 16384 mask 2766.0 16384
layer1.1.conv1.weight, mask/weight parameters,2766,2707 density 0.2298869680851064,0.22498337765957446
before tensor 36864 mask 4329.0 36864
layer1.1.conv2.weight, mask/weight parameters,4329,4228 density 0.2177455862381168,0.21266535888536794
before tensor 16384 mask 2619.0 16384
layer1.1.conv3.weight, mask/weight parameters,2619,2555 density 0.2176695478723404,0.21235039893617022
before tensor 16384 mask 3142.0 16384
layer1.2.conv1.weight, mask/weight parameters,3142,2974 density 0.2611369680851064,0.2471742021276596
before tensor 36864 mask 3823.0 36864
layer1.2.conv2.weight, mask/weight parameters,3823,3673 density 0.19229415019365223,0.18474925808560938
before tensor 16384 mask 2069.0 16384
layer1.2.conv3.weight, mask/weight parameters,2069,2014 density 0.17195811170212766,0.1673869680851064
before tensor 32768 mask 6125.0 32768
layer2.0.conv1.weight, mask/weight parameters,6125,5634 density 0.3190104166666667,0.2934375
before tensor 147456 mask 13813.0 147456
layer2.0.conv2.weight, mask/weight parameters,13813,13310 density 0.27284938271604936,0.2629135802469136
before tensor 65536 mask 7604.0 65536
layer2.0.conv3.weight, mask/weight parameters,7604,7359 density 0.19802083333333334,0.191640625
layer2.0.shortcut.0.weight, mask/weight parameters,34560,33067 density 0.263671875,0.25228118896484375
before tensor 65536 mask 4115.0 65536
layer2.1.conv1.weight, mask/weight parameters,4115,3939 density 0.10716145833333333,0.102578125
before tensor 147456 mask 4551.0 147456
layer2.1.conv2.weight, mask/weight parameters,4551,4332 density 0.0898962962962963,0.08557037037037037
before tensor 65536 mask 4562.0 65536
layer2.1.conv3.weight, mask/weight parameters,4562,4364 density 0.11880208333333334,0.11364583333333333
before tensor 65536 mask 11679.0 65536
layer2.2.conv1.weight, mask/weight parameters,11679,11179 density 0.304140625,0.2911197916666667
before tensor 147456 mask 23646.0 147456
layer2.2.conv2.weight, mask/weight parameters,23646,22253 density 0.4670814814814815,0.4395654320987654
before tensor 65536 mask 14768.0 65536
layer2.2.conv3.weight, mask/weight parameters,14768,13690 density 0.38458333333333333,0.35651041666666666
before tensor 65536 mask 11745.0 65536
layer2.3.conv1.weight, mask/weight parameters,11745,11131 density 0.305859375,0.28986979166666665
before tensor 147456 mask 22252.0 147456
layer2.3.conv2.weight, mask/weight parameters,22252,21191 density 0.4395456790123457,0.41858765432098766
before tensor 65536 mask 12531.0 65536
layer2.3.conv3.weight, mask/weight parameters,12531,11957 density 0.326328125,0.31138020833333335
before tensor 131072 mask 33575.0 131072
layer3.0.conv1.weight, mask/weight parameters,33575,31041 density 0.5005814646946565,0.4628011688931298
before tensor 589824 mask 75703.0 589824
layer3.0.conv2.weight, mask/weight parameters,75703,71414 density 0.4901488517245175,0.4623791672331967
before tensor 262144 mask 63354.0 262144
layer3.0.conv3.weight, mask/weight parameters,63354,59462 density 0.47228351622137404,0.4432699188931298
layer3.0.shortcut.0.weight, mask/weight parameters,116032,108168 density 0.2213134765625,0.2063140869140625
before tensor 262144 mask 32664.0 262144
layer3.1.conv1.weight, mask/weight parameters,32664,29201 density 0.24349952290076335,0.21768398139312978
before tensor 589824 mask 68194.0 589824
layer3.1.conv2.weight, mask/weight parameters,68194,60746 density 0.4415308613199179,0.3933078232944208
before tensor 262144 mask 54276.0 262144
layer3.1.conv3.weight, mask/weight parameters,54276,47955 density 0.4046099713740458,0.35748896708015265
before tensor 262144 mask 34715.0 262144
layer3.2.conv1.weight, mask/weight parameters,34715,30309 density 0.2587890625,0.22594376192748092
before tensor 589824 mask 60513.0 589824
layer3.2.conv2.weight, mask/weight parameters,60513,54003 density 0.3917992346988326,0.34964939883068197
before tensor 262144 mask 53696.0 262144
layer3.2.conv3.weight, mask/weight parameters,53696,48518 density 0.4002862595419847,0.3616859494274809
before tensor 262144 mask 38316.0 262144
layer3.3.conv1.weight, mask/weight parameters,38316,32708 density 0.28563334923664124,0.2438275286259542
before tensor 589824 mask 53217.0 589824
layer3.3.conv2.weight, mask/weight parameters,53217,45698 density 0.34456034030650895,0.2958776036102532
before tensor 262144 mask 46029.0 262144
layer3.3.conv3.weight, mask/weight parameters,46029,40793 density 0.3431312619274809,0.30409858062977096
before tensor 262144 mask 42197.0 262144
layer3.4.conv1.weight, mask/weight parameters,42197,36227 density 0.3145649451335878,0.27006053196564883
before tensor 589824 mask 54280.0 589824
layer3.4.conv2.weight, mask/weight parameters,54280,47589 density 0.3514428711095572,0.3081211273624303
before tensor 262144 mask 43975.0 262144
layer3.4.conv3.weight, mask/weight parameters,43975,39033 density 0.3278193583015267,0.2909783516221374
before tensor 262144 mask 47876.0 262144
layer3.5.conv1.weight, mask/weight parameters,47876,41373 density 0.3569000477099237,0.30842229246183206
before tensor 589824 mask 53391.0 589824
layer3.5.conv2.weight, mask/weight parameters,53391,47250 density 0.34568692578132587,0.30592622807528697
before tensor 262144 mask 41772.0 262144
layer3.5.conv3.weight, mask/weight parameters,41772,37701 density 0.3113967080152672,0.281048723759542
before tensor 524288 mask 143156.0 524288
layer4.0.conv1.weight, mask/weight parameters,143156,131333 density 0.5729540215163934,0.525634765625
before tensor 2359296 mask 228619.0 2359296
layer4.0.conv2.weight, mask/weight parameters,228619,207347 density 0.42666808504284987,0.3869684821881812
before tensor 1048576 mask 119749.0 1048576
layer4.0.conv3.weight, mask/weight parameters,119749,108957 density 0.2396360303534836,0.21803959080430327
layer4.0.shortcut.0.weight, mask/weight parameters,176508,163842 density 0.08416557312011719,0.0781259536743164
before tensor 1048576 mask 128196.0 1048576
layer4.1.conv1.weight, mask/weight parameters,128196,109579 density 0.2565397669057377,0.2192843077612705
before tensor 2359296 mask 200403.0 2359296
layer4.1.conv2.weight, mask/weight parameters,200403,178317 density 0.37400900295619455,0.33279024455791456
before tensor 1048576 mask 91496.0 1048576
layer4.1.conv3.weight, mask/weight parameters,91496,83998 density 0.18309746413934427,0.16809282146516394
before tensor 1048576 mask 83056.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83056,67907 density 0.1662077356557377,0.13589227394979508
before tensor 2359296 mask 78029.0 2359296
layer4.2.conv2.weight, mask/weight parameters,78029,64100 density 0.1456243094747529,0.1196288333482636
before tensor 1048576 mask 41045.0 1048576
layer4.2.conv3.weight, mask/weight parameters,41045,35406 density 0.08213731109118852,0.07085281121926229
classifier.weight, mask/weight parameters,109935,108391 density 0.5367919921875,0.5292529296875
Total Model parameters after dst: 2620605 2365205
Total parameters under density level of 0.1: 0.2516431529061963 0.22711841100413838 after dst
Death rate: 0.1107983813317212


Training summary: Average loss: 0.4323, Accuracy: 43276/50000 (86.552%)


Evaluation: Average loss: 0.9418, Accuracy: 7433/10000 (74.330%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.74 seconds.

Train Epoch: 90 [0/50000 (0%)]	Loss: 0.366887 Accuracy: 89/100 (89.000%
Train Epoch: 90 [10000/50000 (20%)]	Loss: 0.466077 Accuracy: 8934/10100 (88.455%
Train Epoch: 90 [20000/50000 (40%)]	Loss: 0.454979 Accuracy: 17694/20100 (88.030%
Train Epoch: 90 [30000/50000 (60%)]	Loss: 0.436065 Accuracy: 26338/30100 (87.502%
Train Epoch: 90 [40000/50000 (80%)]	Loss: 0.532583 Accuracy: 35018/40100 (87.327%
current layer rate 0.4865
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3918.0
Total filter_masks items: 7438549.0
3918.0 / 7552 channels
Total channels to prune: 40.04799999999932
Layer ('layer3', 0, 'conv1'): Pruned 1/131.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/131.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/131.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/131.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/131.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/131.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/131.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/131.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/131.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/131.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/131.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/131.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 2/244.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 2/244.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 2/244.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 2/244.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 2/244.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 2/244.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3894.0
Total filter_masks items: 7363907.0
After apply_mask:
Total filter_names items: 3894.0
Total filter_masks items: 7363907.0
Total pruned: 24/40.04799999999932 channels
===========done ===============

Training summary: Average loss: 0.4217, Accuracy: 43512/50000 (87.024%)


Evaluation: Average loss: 0.9907, Accuracy: 7328/10000 (73.280%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.53 seconds.

Train Epoch: 91 [0/50000 (0%)]	Loss: 0.527285 Accuracy: 81/100 (81.000%
Train Epoch: 91 [10000/50000 (20%)]	Loss: 0.319867 Accuracy: 8923/10100 (88.347%
Train Epoch: 91 [20000/50000 (40%)]	Loss: 0.407336 Accuracy: 17669/20100 (87.905%
Train Epoch: 91 [30000/50000 (60%)]	Loss: 0.388947 Accuracy: 26294/30100 (87.355%
Train Epoch: 91 [40000/50000 (80%)]	Loss: 0.495315 Accuracy: 34987/40100 (87.249%
current mest  death_rate 0.10982093730453253


dynamic sparse change prune
to kill 227560.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1152,1152 density 0.6666666666666666,0.6666666666666666
before tensor 4096 mask 673.0 4096
layer1.0.conv1.weight, mask/weight parameters,673,673 density 0.2237367021276596,0.2237367021276596
before tensor 36864 mask 3785.0 36864
layer1.0.conv2.weight, mask/weight parameters,3785,3785 density 0.19038277752628138,0.19038277752628138
before tensor 16384 mask 3938.0 16384
layer1.0.conv3.weight, mask/weight parameters,3938,3938 density 0.3272938829787234,0.3272938829787234
layer1.0.shortcut.0.weight, mask/weight parameters,5666,5666 density 0.3458251953125,0.3458251953125
before tensor 16384 mask 2652.0 16384
layer1.1.conv1.weight, mask/weight parameters,2652,2652 density 0.2204122340425532,0.2204122340425532
before tensor 36864 mask 4199.0 36864
layer1.1.conv2.weight, mask/weight parameters,4199,4199 density 0.21120667974447965,0.21120667974447965
before tensor 16384 mask 2518.0 16384
layer1.1.conv3.weight, mask/weight parameters,2518,2518 density 0.2092752659574468,0.2092752659574468
before tensor 16384 mask 2938.0 16384
layer1.2.conv1.weight, mask/weight parameters,2938,2938 density 0.24418218085106383,0.24418218085106383
before tensor 36864 mask 3659.0 36864
layer1.2.conv2.weight, mask/weight parameters,3659,3659 density 0.18404506815552538,0.18404506815552538
before tensor 16384 mask 2002.0 16384
layer1.2.conv3.weight, mask/weight parameters,2002,2002 density 0.16638962765957446,0.16638962765957446
before tensor 32768 mask 5601.0 32768
layer2.0.conv1.weight, mask/weight parameters,5601,5601 density 0.29171875,0.29171875
before tensor 147456 mask 13194.0 147456
layer2.0.conv2.weight, mask/weight parameters,13194,13194 density 0.2606222222222222,0.2606222222222222
before tensor 65536 mask 7265.0 65536
layer2.0.conv3.weight, mask/weight parameters,7265,7265 density 0.18919270833333332,0.18919270833333332
layer2.0.shortcut.0.weight, mask/weight parameters,32663,32663 density 0.24919891357421875,0.24919891357421875
before tensor 65536 mask 3855.0 65536
layer2.1.conv1.weight, mask/weight parameters,3855,3855 density 0.100390625,0.100390625
before tensor 147456 mask 4349.0 147456
layer2.1.conv2.weight, mask/weight parameters,4349,4349 density 0.08590617283950618,0.08590617283950618
before tensor 65536 mask 4368.0 65536
layer2.1.conv3.weight, mask/weight parameters,4368,4368 density 0.11375,0.11375
before tensor 65536 mask 11103.0 65536
layer2.2.conv1.weight, mask/weight parameters,11103,11103 density 0.289140625,0.289140625
before tensor 147456 mask 22188.0 147456
layer2.2.conv2.weight, mask/weight parameters,22188,22188 density 0.4382814814814815,0.4382814814814815
before tensor 65536 mask 13745.0 65536
layer2.2.conv3.weight, mask/weight parameters,13745,13745 density 0.35794270833333336,0.35794270833333336
before tensor 65536 mask 11054.0 65536
layer2.3.conv1.weight, mask/weight parameters,11054,11054 density 0.2878645833333333,0.2878645833333333
before tensor 147456 mask 21106.0 147456
layer2.3.conv2.weight, mask/weight parameters,21106,21106 density 0.41690864197530864,0.41690864197530864
before tensor 65536 mask 11879.0 65536
layer2.3.conv3.weight, mask/weight parameters,11879,11879 density 0.3093489583333333,0.3093489583333333
before tensor 131072 mask 30769.0 131072
layer3.0.conv1.weight, mask/weight parameters,30769,30769 density 0.46227463942307695,0.46227463942307695
before tensor 589824 mask 69780.0 589824
layer3.0.conv2.weight, mask/weight parameters,69780,69780 density 0.4587771203155819,0.4587771203155819
before tensor 262144 mask 58975.0 262144
layer3.0.conv3.weight, mask/weight parameters,58975,58975 density 0.44302133413461536,0.44302133413461536
layer3.0.shortcut.0.weight, mask/weight parameters,108003,108003 density 0.20599937438964844,0.20599937438964844
before tensor 262144 mask 29179.0 262144
layer3.1.conv1.weight, mask/weight parameters,29179,29179 density 0.21919320913461537,0.21919320913461537
before tensor 589824 mask 60212.0 589824
layer3.1.conv2.weight, mask/weight parameters,60212,60212 density 0.39587113740959895,0.39587113740959895
before tensor 262144 mask 48891.0 262144
layer3.1.conv3.weight, mask/weight parameters,48891,48891 density 0.3672701322115385,0.3672701322115385
before tensor 262144 mask 30613.0 262144
layer3.2.conv1.weight, mask/weight parameters,30613,30613 density 0.22996544471153846,0.22996544471153846
before tensor 589824 mask 53635.0 589824
layer3.2.conv2.weight, mask/weight parameters,53635,53635 density 0.3526298487836949,0.3526298487836949
before tensor 262144 mask 48654.0 262144
layer3.2.conv3.weight, mask/weight parameters,48654,48654 density 0.36548978365384616,0.36548978365384616
before tensor 262144 mask 33688.0 262144
layer3.3.conv1.weight, mask/weight parameters,33688,33688 density 0.2530649038461538,0.2530649038461538
before tensor 589824 mask 46381.0 589824
layer3.3.conv2.weight, mask/weight parameters,46381,46381 density 0.30493754109138727,0.30493754109138727
before tensor 262144 mask 41490.0 262144
layer3.3.conv3.weight, mask/weight parameters,41490,41490 density 0.31167367788461536,0.31167367788461536
before tensor 262144 mask 37017.0 262144
layer3.4.conv1.weight, mask/weight parameters,37017,37017 density 0.2780724158653846,0.2780724158653846
before tensor 589824 mask 47957.0 589824
layer3.4.conv2.weight, mask/weight parameters,47957,47957 density 0.3152991452991453,0.3152991452991453
before tensor 262144 mask 39475.0 262144
layer3.4.conv3.weight, mask/weight parameters,39475,39475 density 0.29653695913461536,0.29653695913461536
before tensor 262144 mask 42075.0 262144
layer3.5.conv1.weight, mask/weight parameters,42075,42075 density 0.31606820913461536,0.31606820913461536
before tensor 589824 mask 47151.0 589824
layer3.5.conv2.weight, mask/weight parameters,47151,47151 density 0.31,0.31
before tensor 262144 mask 37870.0 262144
layer3.5.conv3.weight, mask/weight parameters,37870,37870 density 0.2844801682692308,0.2844801682692308
before tensor 524288 mask 131547.0 524288
layer4.0.conv1.weight, mask/weight parameters,131547,131547 density 0.5308424263946281,0.5308424263946281
before tensor 2359296 mask 205556.0 2359296
layer4.0.conv2.weight, mask/weight parameters,205556,205556 density 0.38999309397506243,0.38999309397506243
before tensor 1048576 mask 108555.0 1048576
layer4.0.conv3.weight, mask/weight parameters,108555,108555 density 0.21903045906508264,0.21903045906508264
layer4.0.shortcut.0.weight, mask/weight parameters,162582,162582 density 0.07752513885498047,0.07752513885498047
before tensor 1048576 mask 111039.0 1048576
layer4.1.conv1.weight, mask/weight parameters,111039,111039 density 0.2240424037964876,0.2240424037964876
before tensor 2359296 mask 178086.0 2359296
layer4.1.conv2.weight, mask/weight parameters,178086,178086 density 0.33787537281151103,0.33787537281151103
before tensor 1048576 mask 83115.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83115,83115 density 0.16770039708161158,0.16770039708161158
before tensor 1048576 mask 69287.0 1048576
layer4.2.conv1.weight, mask/weight parameters,69287,69287 density 0.1397997643336777,0.1397997643336777
before tensor 2359296 mask 64398.0 2359296
layer4.2.conv2.weight, mask/weight parameters,64398,64398 density 0.12217972360722174,0.12217972360722174
before tensor 1048576 mask 35457.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35457,35457 density 0.07154127388946281,0.07154127388946281
classifier.weight, mask/weight parameters,108216,108216 density 0.5283984375,0.5283984375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.22875803086292526 0.22875803086292526 after dst
Death rate: 0.10982093730453253

dynamic sparse change grow
self.total_params*pruning_rate 2597488.3233967973
self.total_nonzero 2365205.0
to grow 232283.3233967973
len(all_scores) 10339331 6980348
increse 232283.0 before_mask 2597487.0 after_mask 2597487.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1187,1152 density 0.6869212962962963,0.6666666666666666
before tensor 4096 mask 711.0 4096
layer1.0.conv1.weight, mask/weight parameters,711,673 density 0.23636968085106383,0.2237367021276596
before tensor 36864 mask 4035.0 36864
layer1.0.conv2.weight, mask/weight parameters,4035,3785 density 0.2029575977063528,0.19038277752628138
before tensor 16384 mask 4113.0 16384
layer1.0.conv3.weight, mask/weight parameters,4113,3938 density 0.34183843085106386,0.3272938829787234
layer1.0.shortcut.0.weight, mask/weight parameters,5963,5666 density 0.36395263671875,0.3458251953125
before tensor 16384 mask 2834.0 16384
layer1.1.conv1.weight, mask/weight parameters,2834,2652 density 0.23553856382978725,0.2204122340425532
before tensor 36864 mask 4331.0 36864
layer1.1.conv2.weight, mask/weight parameters,4331,4199 density 0.21784618479955736,0.21120667974447965
before tensor 16384 mask 2610.0 16384
layer1.1.conv3.weight, mask/weight parameters,2610,2518 density 0.2169215425531915,0.2092752659574468
before tensor 16384 mask 3108.0 16384
layer1.2.conv1.weight, mask/weight parameters,3108,2938 density 0.25831117021276595,0.24418218085106383
before tensor 36864 mask 3814.0 36864
layer1.2.conv2.weight, mask/weight parameters,3814,3659 density 0.19184145666716965,0.18404506815552538
before tensor 16384 mask 2070.0 16384
layer1.2.conv3.weight, mask/weight parameters,2070,2002 density 0.17204122340425532,0.16638962765957446
before tensor 32768 mask 6157.0 32768
layer2.0.conv1.weight, mask/weight parameters,6157,5601 density 0.32067708333333333,0.29171875
before tensor 147456 mask 13694.0 147456
layer2.0.conv2.weight, mask/weight parameters,13694,13194 density 0.2704987654320988,0.2606222222222222
before tensor 65536 mask 7635.0 65536
layer2.0.conv3.weight, mask/weight parameters,7635,7265 density 0.198828125,0.18919270833333332
layer2.0.shortcut.0.weight, mask/weight parameters,34711,32663 density 0.26482391357421875,0.24919891357421875
before tensor 65536 mask 4443.0 65536
layer2.1.conv1.weight, mask/weight parameters,4443,3855 density 0.115703125,0.100390625
before tensor 147456 mask 4685.0 147456
layer2.1.conv2.weight, mask/weight parameters,4685,4349 density 0.09254320987654321,0.08590617283950618
before tensor 65536 mask 4586.0 65536
layer2.1.conv3.weight, mask/weight parameters,4586,4368 density 0.11942708333333334,0.11375
before tensor 65536 mask 11865.0 65536
layer2.2.conv1.weight, mask/weight parameters,11865,11103 density 0.308984375,0.289140625
before tensor 147456 mask 23902.0 147456
layer2.2.conv2.weight, mask/weight parameters,23902,22188 density 0.47213827160493826,0.4382814814814815
before tensor 65536 mask 14763.0 65536
layer2.2.conv3.weight, mask/weight parameters,14763,13745 density 0.384453125,0.35794270833333336
before tensor 65536 mask 12162.0 65536
layer2.3.conv1.weight, mask/weight parameters,12162,11054 density 0.31671875,0.2878645833333333
before tensor 147456 mask 22271.0 147456
layer2.3.conv2.weight, mask/weight parameters,22271,21106 density 0.43992098765432097,0.41690864197530864
before tensor 65536 mask 12466.0 65536
layer2.3.conv3.weight, mask/weight parameters,12466,11879 density 0.3246354166666667,0.3093489583333333
before tensor 131072 mask 33198.0 131072
layer3.0.conv1.weight, mask/weight parameters,33198,30769 density 0.49876802884615384,0.46227463942307695
before tensor 589824 mask 73791.0 589824
layer3.0.conv2.weight, mask/weight parameters,73791,69780 density 0.4851479289940828,0.4587771203155819
before tensor 262144 mask 62949.0 262144
layer3.0.conv3.weight, mask/weight parameters,62949,58975 density 0.4728740985576923,0.44302133413461536
layer3.0.shortcut.0.weight, mask/weight parameters,114556,108003 density 0.21849822998046875,0.20599937438964844
before tensor 262144 mask 31923.0 262144
layer3.1.conv1.weight, mask/weight parameters,31923,29179 density 0.23980618990384617,0.21919320913461537
before tensor 589824 mask 68141.0 589824
layer3.1.conv2.weight, mask/weight parameters,68141,60212 density 0.4480013149243918,0.39587113740959895
before tensor 262144 mask 53827.0 262144
layer3.1.conv3.weight, mask/weight parameters,53827,48891 density 0.4043494591346154,0.3672701322115385
before tensor 262144 mask 33911.0 262144
layer3.2.conv1.weight, mask/weight parameters,33911,30613 density 0.2547400841346154,0.22996544471153846
before tensor 589824 mask 58623.0 589824
layer3.2.conv2.weight, mask/weight parameters,58623,53635 density 0.3854240631163708,0.3526298487836949
before tensor 262144 mask 52893.0 262144
layer3.2.conv3.weight, mask/weight parameters,52893,48654 density 0.39733323317307695,0.36548978365384616
before tensor 262144 mask 38216.0 262144
layer3.3.conv1.weight, mask/weight parameters,38216,33688 density 0.2870793269230769,0.2530649038461538
before tensor 589824 mask 51508.0 589824
layer3.3.conv2.weight, mask/weight parameters,51508,46381 density 0.3386456278763971,0.30493754109138727
before tensor 262144 mask 45917.0 262144
layer3.3.conv3.weight, mask/weight parameters,45917,41490 density 0.34492938701923076,0.31167367788461536
before tensor 262144 mask 41922.0 262144
layer3.4.conv1.weight, mask/weight parameters,41922,37017 density 0.3149188701923077,0.2780724158653846
before tensor 589824 mask 53610.0 589824
layer3.4.conv2.weight, mask/weight parameters,53610,47957 density 0.352465483234714,0.3152991452991453
before tensor 262144 mask 43698.0 262144
layer3.4.conv3.weight, mask/weight parameters,43698,39475 density 0.3282602163461538,0.29653695913461536
before tensor 262144 mask 48178.0 262144
layer3.5.conv1.weight, mask/weight parameters,48178,42075 density 0.3619140625,0.31606820913461536
before tensor 589824 mask 52964.0 589824
layer3.5.conv2.weight, mask/weight parameters,52964,47151 density 0.34821827744904665,0.31
before tensor 262144 mask 40953.0 262144
layer3.5.conv3.weight, mask/weight parameters,40953,37870 density 0.3076397235576923,0.2844801682692308
before tensor 524288 mask 142306.0 524288
layer4.0.conv1.weight, mask/weight parameters,142306,131547 density 0.574259103822314,0.5308424263946281
before tensor 2359296 mask 223169.0 2359296
layer4.0.conv2.weight, mask/weight parameters,223169,205556 density 0.4234095272787985,0.38999309397506243
before tensor 1048576 mask 117550.0 1048576
layer4.0.conv3.weight, mask/weight parameters,117550,108555 density 0.23717959065082644,0.21903045906508264
layer4.0.shortcut.0.weight, mask/weight parameters,173037,162582 density 0.08251047134399414,0.07752513885498047
before tensor 1048576 mask 126235.0 1048576
layer4.1.conv1.weight, mask/weight parameters,126235,111039 density 0.2547032379907025,0.2240424037964876
before tensor 2359296 mask 200686.0 2359296
layer4.1.conv2.weight, mask/weight parameters,200686,178086 density 0.3807534397316516,0.33787537281151103
before tensor 1048576 mask 91907.0 1048576
layer4.1.conv3.weight, mask/weight parameters,91907,83115 density 0.18543993737086778,0.16770039708161158
before tensor 1048576 mask 84821.0 1048576
layer4.2.conv1.weight, mask/weight parameters,84821,69287 density 0.171142578125,0.1397997643336777
before tensor 2359296 mask 78471.0 2359296
layer4.2.conv2.weight, mask/weight parameters,78471,64398 density 0.14887985793320127,0.12217972360722174
before tensor 1048576 mask 40536.0 1048576
layer4.2.conv3.weight, mask/weight parameters,40536,35457 density 0.0817891270661157,0.07154127388946281
classifier.weight, mask/weight parameters,109875,108216 density 0.5364990234375,0.5283984375
Total Model parameters after dst: 2597487 2365205
Total parameters under density level of 0.1: 0.2512238944666729 0.22875803086292526 after dst
Death rate: 0.10982093730453253


Training summary: Average loss: 0.4232, Accuracy: 43497/50000 (86.994%)


Evaluation: Average loss: 0.9407, Accuracy: 7462/10000 (74.620%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.72 seconds.

Train Epoch: 92 [0/50000 (0%)]	Loss: 0.386444 Accuracy: 90/100 (90.000%
Train Epoch: 92 [10000/50000 (20%)]	Loss: 0.343360 Accuracy: 9022/10100 (89.327%
Train Epoch: 92 [20000/50000 (40%)]	Loss: 0.340613 Accuracy: 17775/20100 (88.433%
Train Epoch: 92 [30000/50000 (60%)]	Loss: 0.502267 Accuracy: 26496/30100 (88.027%
Train Epoch: 92 [40000/50000 (80%)]	Loss: 0.300313 Accuracy: 35246/40100 (87.895%
current layer rate 0.488472234865726
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3894.0
Total filter_masks items: 7363907.0
3894.0 / 7552 channels
Total channels to prune: 30.942317705962523
Layer ('layer3', 0, 'conv1'): Pruned 1/130.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/130.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/130.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/130.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/130.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/130.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/130.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/130.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/130.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/130.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/130.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/130.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 1/242.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/242.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/242.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/242.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/242.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/242.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3876.0
Total filter_masks items: 7313840.0
After apply_mask:
Total filter_names items: 3876.0
Total filter_masks items: 7313840.0
Total pruned: 18/30.942317705962523 channels
===========done ===============

Training summary: Average loss: 0.4010, Accuracy: 43814/50000 (87.628%)


Evaluation: Average loss: 0.9820, Accuracy: 7349/10000 (73.490%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.54 seconds.

Train Epoch: 93 [0/50000 (0%)]	Loss: 0.247599 Accuracy: 93/100 (93.000%
Train Epoch: 93 [10000/50000 (20%)]	Loss: 0.384984 Accuracy: 8938/10100 (88.495%
Train Epoch: 93 [20000/50000 (40%)]	Loss: 0.343511 Accuracy: 17783/20100 (88.473%
Train Epoch: 93 [30000/50000 (60%)]	Loss: 0.423095 Accuracy: 26525/30100 (88.123%
Train Epoch: 93 [40000/50000 (80%)]	Loss: 0.431082 Accuracy: 35243/40100 (87.888%
current mest  death_rate 0.1088789446815961


dynamic sparse change prune
to kill 213385.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1161,1161 density 0.671875,0.671875
before tensor 4096 mask 676.0 4096
layer1.0.conv1.weight, mask/weight parameters,676,676 density 0.2247340425531915,0.2247340425531915
before tensor 36864 mask 3833.0 36864
layer1.0.conv2.weight, mask/weight parameters,3833,3833 density 0.1927971430008551,0.1927971430008551
before tensor 16384 mask 3944.0 16384
layer1.0.conv3.weight, mask/weight parameters,3944,3944 density 0.32779255319148937,0.32779255319148937
layer1.0.shortcut.0.weight, mask/weight parameters,5655,5655 density 0.34515380859375,0.34515380859375
before tensor 16384 mask 2661.0 16384
layer1.1.conv1.weight, mask/weight parameters,2661,2661 density 0.22116023936170212,0.22116023936170212
before tensor 36864 mask 4181.0 36864
layer1.1.conv2.weight, mask/weight parameters,4181,4181 density 0.2103012926915145,0.2103012926915145
before tensor 16384 mask 2504.0 16384
layer1.1.conv3.weight, mask/weight parameters,2504,2504 density 0.2081117021276596,0.2081117021276596
before tensor 16384 mask 2929.0 16384
layer1.2.conv1.weight, mask/weight parameters,2929,2929 density 0.2434341755319149,0.2434341755319149
before tensor 36864 mask 3638.0 36864
layer1.2.conv2.weight, mask/weight parameters,3638,3638 density 0.18298878326039938,0.18298878326039938
before tensor 16384 mask 1978.0 16384
layer1.2.conv3.weight, mask/weight parameters,1978,1978 density 0.16439494680851063,0.16439494680851063
before tensor 32768 mask 5667.0 32768
layer2.0.conv1.weight, mask/weight parameters,5667,5667 density 0.29515625,0.29515625
before tensor 147456 mask 13146.0 147456
layer2.0.conv2.weight, mask/weight parameters,13146,13146 density 0.25967407407407406,0.25967407407407406
before tensor 65536 mask 7283.0 65536
layer2.0.conv3.weight, mask/weight parameters,7283,7283 density 0.18966145833333334,0.18966145833333334
layer2.0.shortcut.0.weight, mask/weight parameters,32538,32538 density 0.2482452392578125,0.2482452392578125
before tensor 65536 mask 3986.0 65536
layer2.1.conv1.weight, mask/weight parameters,3986,3986 density 0.10380208333333334,0.10380208333333334
before tensor 147456 mask 4375.0 147456
layer2.1.conv2.weight, mask/weight parameters,4375,4375 density 0.08641975308641975,0.08641975308641975
before tensor 65536 mask 4390.0 65536
layer2.1.conv3.weight, mask/weight parameters,4390,4390 density 0.11432291666666666,0.11432291666666666
before tensor 65536 mask 11124.0 65536
layer2.2.conv1.weight, mask/weight parameters,11124,11124 density 0.2896875,0.2896875
before tensor 147456 mask 22374.0 147456
layer2.2.conv2.weight, mask/weight parameters,22374,22374 density 0.44195555555555555,0.44195555555555555
before tensor 65536 mask 13787.0 65536
layer2.2.conv3.weight, mask/weight parameters,13787,13787 density 0.3590364583333333,0.3590364583333333
before tensor 65536 mask 11294.0 65536
layer2.3.conv1.weight, mask/weight parameters,11294,11294 density 0.29411458333333335,0.29411458333333335
before tensor 147456 mask 21073.0 147456
layer2.3.conv2.weight, mask/weight parameters,21073,21073 density 0.4162567901234568,0.4162567901234568
before tensor 65536 mask 11855.0 65536
layer2.3.conv3.weight, mask/weight parameters,11855,11855 density 0.3087239583333333,0.3087239583333333
before tensor 131072 mask 30588.0 131072
layer3.0.conv1.weight, mask/weight parameters,30588,30588 density 0.46311773255813954,0.46311773255813954
before tensor 589824 mask 68283.0 589824
layer3.0.conv2.weight, mask/weight parameters,68283,68283 density 0.45592212006489996,0.45592212006489996
before tensor 262144 mask 58490.0 262144
layer3.0.conv3.weight, mask/weight parameters,58490,58490 density 0.4427840358527132,0.4427840358527132
layer3.0.shortcut.0.weight, mask/weight parameters,107054,107054 density 0.20418930053710938,0.20418930053710938
before tensor 262144 mask 28903.0 262144
layer3.1.conv1.weight, mask/weight parameters,28903,28903 density 0.21880299176356588,0.21880299176356588
before tensor 589824 mask 60188.0 589824
layer3.1.conv2.weight, mask/weight parameters,60188,60188 density 0.40187221654681543,0.40187221654681543
before tensor 262144 mask 48936.0 262144
layer3.1.conv3.weight, mask/weight parameters,48936,48936 density 0.3704578488372093,0.3704578488372093
before tensor 262144 mask 30550.0 262144
layer3.2.conv1.weight, mask/weight parameters,30550,30550 density 0.23127119670542637,0.23127119670542637
before tensor 589824 mask 52721.0 589824
layer3.2.conv2.weight, mask/weight parameters,52721,52721 density 0.3520154371064773,0.3520154371064773
before tensor 262144 mask 48387.0 262144
layer3.2.conv3.weight, mask/weight parameters,48387,48387 density 0.3663017805232558,0.3663017805232558
before tensor 262144 mask 33949.0 262144
layer3.3.conv1.weight, mask/weight parameters,33949,33949 density 0.2570024830426357,0.2570024830426357
before tensor 589824 mask 45941.0 589824
layer3.3.conv2.weight, mask/weight parameters,45941,45941 density 0.30674572174482034,0.30674572174482034
before tensor 262144 mask 41648.0 262144
layer3.3.conv3.weight, mask/weight parameters,41648,41648 density 0.31528585271317827,0.31528585271317827
before tensor 262144 mask 37262.0 262144
layer3.4.conv1.weight, mask/weight parameters,37262,37262 density 0.28208272771317827,0.28208272771317827
before tensor 589824 mask 47532.0 589824
layer3.4.conv2.weight, mask/weight parameters,47532,47532 density 0.3173687478717225,0.3173687478717225
before tensor 262144 mask 39507.0 262144
layer3.4.conv3.weight, mask/weight parameters,39507,39507 density 0.2990779433139535,0.2990779433139535
before tensor 262144 mask 42930.0 262144
layer3.5.conv1.weight, mask/weight parameters,42930,42930 density 0.3249909156976744,0.3249909156976744
before tensor 589824 mask 47082.0 589824
layer3.5.conv2.weight, mask/weight parameters,47082,47082 density 0.31436412074594877,0.31436412074594877
before tensor 262144 mask 37351.0 262144
layer3.5.conv3.weight, mask/weight parameters,37351,37351 density 0.2827564801356589,0.2827564801356589
before tensor 524288 mask 131876.0 524288
layer4.0.conv1.weight, mask/weight parameters,131876,131876 density 0.5343782417012448,0.5343782417012448
before tensor 2359296 mask 203723.0 2359296
layer4.0.conv2.weight, mask/weight parameters,203723,203723 density 0.38972966871935555,0.38972966871935555
before tensor 1048576 mask 107672.0 1048576
layer4.0.conv3.weight, mask/weight parameters,107672,107672 density 0.21815028526970953,0.21815028526970953
layer4.0.shortcut.0.weight, mask/weight parameters,160672,160672 density 0.0766143798828125,0.0766143798828125
before tensor 1048576 mask 111951.0 1048576
layer4.1.conv1.weight, mask/weight parameters,111951,111951 density 0.22681981003630705,0.22681981003630705
before tensor 2359296 mask 180910.0 2359296
layer4.1.conv2.weight, mask/weight parameters,180910,180910 density 0.34608755205852365,0.34608755205852365
before tensor 1048576 mask 83503.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83503,83503 density 0.16918236190352698,0.16918236190352698
before tensor 1048576 mask 71569.0 1048576
layer4.2.conv1.weight, mask/weight parameters,71569,71569 density 0.14500332274377592,0.14500332274377592
before tensor 2359296 mask 66293.0 2359296
layer4.2.conv2.weight, mask/weight parameters,66293,66293 density 0.1268209722437439,0.1268209722437439
before tensor 1048576 mask 35679.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35679,35679 density 0.0722879116960581,0.0722879116960581
classifier.weight, mask/weight parameters,108003,108003 density 0.5273583984375,0.5273583984375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.22987115502138927 0.22987115502138927 after dst
Death rate: 0.1088789446815961

dynamic sparse change grow
self.total_params*pruning_rate 2575208.283735341
self.total_nonzero 2365205.0
to grow 210003.28373534093
len(all_scores) 10289264 6932004
increse 210003.0 before_mask 2575206.0 after_mask 2575206.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1194,1161 density 0.6909722222222222,0.671875
before tensor 4096 mask 697.0 4096
layer1.0.conv1.weight, mask/weight parameters,697,676 density 0.2317154255319149,0.2247340425531915
before tensor 36864 mask 3913.0 36864
layer1.0.conv2.weight, mask/weight parameters,3913,3833 density 0.19682108545847796,0.1927971430008551
before tensor 16384 mask 4053.0 16384
layer1.0.conv3.weight, mask/weight parameters,4053,3944 density 0.33685172872340424,0.32779255319148937
layer1.0.shortcut.0.weight, mask/weight parameters,5915,5655 density 0.36102294921875,0.34515380859375
before tensor 16384 mask 2720.0 16384
layer1.1.conv1.weight, mask/weight parameters,2720,2661 density 0.22606382978723405,0.22116023936170212
before tensor 36864 mask 4270.0 36864
layer1.1.conv2.weight, mask/weight parameters,4270,4181 density 0.21477792867561993,0.2103012926915145
before tensor 16384 mask 2569.0 16384
layer1.1.conv3.weight, mask/weight parameters,2569,2504 density 0.21351396276595744,0.2081117021276596
before tensor 16384 mask 3125.0 16384
layer1.2.conv1.weight, mask/weight parameters,3125,2929 density 0.25972406914893614,0.2434341755319149
before tensor 36864 mask 3725.0 36864
layer1.2.conv2.weight, mask/weight parameters,3725,3638 density 0.18736482068306423,0.18298878326039938
before tensor 16384 mask 2050.0 16384
layer1.2.conv3.weight, mask/weight parameters,2050,1978 density 0.17037898936170212,0.16439494680851063
before tensor 32768 mask 5932.0 32768
layer2.0.conv1.weight, mask/weight parameters,5932,5667 density 0.30895833333333333,0.29515625
before tensor 147456 mask 13542.0 147456
layer2.0.conv2.weight, mask/weight parameters,13542,13146 density 0.2674962962962963,0.25967407407407406
before tensor 65536 mask 7696.0 65536
layer2.0.conv3.weight, mask/weight parameters,7696,7283 density 0.20041666666666666,0.18966145833333334
layer2.0.shortcut.0.weight, mask/weight parameters,34173,32538 density 0.26071929931640625,0.2482452392578125
before tensor 65536 mask 4103.0 65536
layer2.1.conv1.weight, mask/weight parameters,4103,3986 density 0.10684895833333333,0.10380208333333334
before tensor 147456 mask 4546.0 147456
layer2.1.conv2.weight, mask/weight parameters,4546,4375 density 0.08979753086419753,0.08641975308641975
before tensor 65536 mask 4523.0 65536
layer2.1.conv3.weight, mask/weight parameters,4523,4390 density 0.11778645833333333,0.11432291666666666
before tensor 65536 mask 11785.0 65536
layer2.2.conv1.weight, mask/weight parameters,11785,11124 density 0.30690104166666665,0.2896875
before tensor 147456 mask 23741.0 147456
layer2.2.conv2.weight, mask/weight parameters,23741,22374 density 0.468958024691358,0.44195555555555555
before tensor 65536 mask 14610.0 65536
layer2.2.conv3.weight, mask/weight parameters,14610,13787 density 0.38046875,0.3590364583333333
before tensor 65536 mask 12146.0 65536
layer2.3.conv1.weight, mask/weight parameters,12146,11294 density 0.3163020833333333,0.29411458333333335
before tensor 147456 mask 22089.0 147456
layer2.3.conv2.weight, mask/weight parameters,22089,21073 density 0.43632592592592595,0.4162567901234568
before tensor 65536 mask 12427.0 65536
layer2.3.conv3.weight, mask/weight parameters,12427,11855 density 0.32361979166666666,0.3087239583333333
before tensor 131072 mask 32660.0 131072
layer3.0.conv1.weight, mask/weight parameters,32660,30588 density 0.49448885658914726,0.46311773255813954
before tensor 589824 mask 72855.0 589824
layer3.0.conv2.weight, mask/weight parameters,72855,68283 density 0.48644913166276066,0.45592212006489996
before tensor 262144 mask 62411.0 262144
layer3.0.conv3.weight, mask/weight parameters,62411,58490 density 0.4724669937015504,0.4427840358527132
layer3.0.shortcut.0.weight, mask/weight parameters,113159,107054 density 0.2158336639404297,0.20418930053710938
before tensor 262144 mask 31955.0 262144
layer3.1.conv1.weight, mask/weight parameters,31955,28903 density 0.24190740067829458,0.21880299176356588
before tensor 589824 mask 66844.0 589824
layer3.1.conv2.weight, mask/weight parameters,66844,60188 density 0.4463139902115925,0.40187221654681543
before tensor 262144 mask 53430.0 262144
layer3.1.conv3.weight, mask/weight parameters,53430,48936 density 0.40447856104651164,0.3704578488372093
before tensor 262144 mask 34453.0 262144
layer3.2.conv1.weight, mask/weight parameters,34453,30550 density 0.2608178900193798,0.23127119670542637
before tensor 589824 mask 59096.0 589824
layer3.2.conv2.weight, mask/weight parameters,59096,52721 density 0.39458098805493796,0.3520154371064773
before tensor 262144 mask 52693.0 262144
layer3.2.conv3.weight, mask/weight parameters,52693,48387 density 0.39889928536821706,0.3663017805232558
before tensor 262144 mask 37875.0 262144
layer3.3.conv1.weight, mask/weight parameters,37875,33949 density 0.28672329215116277,0.2570024830426357
before tensor 589824 mask 52131.0 589824
layer3.3.conv2.weight, mask/weight parameters,52131,45941 density 0.3480760370971296,0.30674572174482034
before tensor 262144 mask 45936.0 262144
layer3.3.conv3.weight, mask/weight parameters,45936,41648 density 0.3477470930232558,0.31528585271317827
before tensor 262144 mask 41530.0 262144
layer3.4.conv1.weight, mask/weight parameters,41530,37262 density 0.31439256298449614,0.28208272771317827
before tensor 589824 mask 52600.0 589824
layer3.4.conv2.weight, mask/weight parameters,52600,47532 density 0.3512075262571026,0.3173687478717225
before tensor 262144 mask 42884.0 262144
layer3.4.conv3.weight, mask/weight parameters,42884,39507 density 0.32464268410852715,0.2990779433139535
before tensor 262144 mask 47691.0 262144
layer3.5.conv1.weight, mask/weight parameters,47691,42930 density 0.3610328851744186,0.3249909156976744
before tensor 589824 mask 52178.0 589824
layer3.5.conv2.weight, mask/weight parameters,52178,47082 density 0.3483898537080437,0.31436412074594877
before tensor 262144 mask 41158.0 262144
layer3.5.conv3.weight, mask/weight parameters,41158,37351 density 0.3115764292635659,0.2827564801356589
before tensor 524288 mask 141782.0 524288
layer4.0.conv1.weight, mask/weight parameters,141782,131876 density 0.5745186073651453,0.5343782417012448
before tensor 2359296 mask 221819.0 2359296
layer4.0.conv2.weight, mask/weight parameters,221819,203723 density 0.42434798911099253,0.38972966871935555
before tensor 1048576 mask 116741.0 1048576
layer4.0.conv3.weight, mask/weight parameters,116741,107672 density 0.2365246531379668,0.21815028526970953
layer4.0.shortcut.0.weight, mask/weight parameters,167844,160672 density 0.08003425598144531,0.0766143798828125
before tensor 1048576 mask 126226.0 1048576
layer4.1.conv1.weight, mask/weight parameters,126226,111951 density 0.25574186332987553,0.22681981003630705
before tensor 2359296 mask 201284.0 2359296
layer4.1.conv2.weight, mask/weight parameters,201284,180910 density 0.38506377109362594,0.34608755205852365
before tensor 1048576 mask 90391.0 1048576
layer4.1.conv3.weight, mask/weight parameters,90391,83503 density 0.18313788576244813,0.16918236190352698
before tensor 1048576 mask 83029.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83029,71569 density 0.16822200790975103,0.14500332274377592
before tensor 2359296 mask 77394.0 2359296
layer4.2.conv2.weight, mask/weight parameters,77394,66293 density 0.14805759772272056,0.1268209722437439
before tensor 1048576 mask 40194.0 1048576
layer4.2.conv3.weight, mask/weight parameters,40194,35679 density 0.08143558739626557,0.0722879116960581
classifier.weight, mask/weight parameters,109419,108003 density 0.5342724609375,0.5273583984375
Total Model parameters after dst: 2575206 2365205
Total parameters under density level of 0.1: 0.25028087528903914 0.22987115502138927 after dst
Death rate: 0.1088789446815961


Training summary: Average loss: 0.3989, Accuracy: 43804/50000 (87.608%)


Evaluation: Average loss: 0.9801, Accuracy: 7371/10000 (73.710%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.74 seconds.

Train Epoch: 94 [0/50000 (0%)]	Loss: 0.371640 Accuracy: 90/100 (90.000%
Train Epoch: 94 [10000/50000 (20%)]	Loss: 0.338966 Accuracy: 9014/10100 (89.248%
Train Epoch: 94 [20000/50000 (40%)]	Loss: 0.456231 Accuracy: 17871/20100 (88.910%
Train Epoch: 94 [30000/50000 (60%)]	Loss: 0.421447 Accuracy: 26598/30100 (88.365%
Train Epoch: 94 [40000/50000 (80%)]	Loss: 0.292595 Accuracy: 35310/40100 (88.055%
current layer rate 0.49024237596722803
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3876.0
Total filter_masks items: 7313840.0
3876.0 / 7552 channels
Total channels to prune: 26.310423304506457
Layer ('layer4', 0, 'conv1'): Pruned 1/241.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/241.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/241.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/241.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/241.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/241.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3870.0
Total filter_masks items: 7289589.0
After apply_mask:
Total filter_names items: 3870.0
Total filter_masks items: 7289589.0
Total pruned: 6/26.310423304506457 channels
===========done ===============

Training summary: Average loss: 0.3910, Accuracy: 43878/50000 (87.756%)


Evaluation: Average loss: 1.0234, Accuracy: 7280/10000 (72.800%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.51 seconds.

Train Epoch: 95 [0/50000 (0%)]	Loss: 0.254321 Accuracy: 92/100 (92.000%
Train Epoch: 95 [10000/50000 (20%)]	Loss: 0.267559 Accuracy: 9031/10100 (89.416%
Train Epoch: 95 [20000/50000 (40%)]	Loss: 0.332913 Accuracy: 17901/20100 (89.060%
Train Epoch: 95 [30000/50000 (60%)]	Loss: 0.499830 Accuracy: 26677/30100 (88.628%
Train Epoch: 95 [40000/50000 (80%)]	Loss: 0.608205 Accuracy: 35412/40100 (88.309%
current mest  death_rate 0.1079746035303305


dynamic sparse change prune
to kill 202122.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1166,1166 density 0.6747685185185185,0.6747685185185185
before tensor 4096 mask 669.0 4096
layer1.0.conv1.weight, mask/weight parameters,669,669 density 0.22240691489361702,0.22240691489361702
before tensor 36864 mask 3780.0 36864
layer1.0.conv2.weight, mask/weight parameters,3780,3780 density 0.19013128112267993,0.19013128112267993
before tensor 16384 mask 3888.0 16384
layer1.0.conv3.weight, mask/weight parameters,3888,3888 density 0.32313829787234044,0.32313829787234044
layer1.0.shortcut.0.weight, mask/weight parameters,5636,5636 density 0.343994140625,0.343994140625
before tensor 16384 mask 2603.0 16384
layer1.1.conv1.weight, mask/weight parameters,2603,2603 density 0.21633976063829788,0.21633976063829788
before tensor 36864 mask 4133.0 36864
layer1.1.conv2.weight, mask/weight parameters,4133,4133 density 0.2078869272169408,0.2078869272169408
before tensor 16384 mask 2446.0 16384
layer1.1.conv3.weight, mask/weight parameters,2446,2446 density 0.20329122340425532,0.20329122340425532
before tensor 16384 mask 2940.0 16384
layer1.2.conv1.weight, mask/weight parameters,2940,2940 density 0.24434840425531915,0.24434840425531915
before tensor 36864 mask 3588.0 36864
layer1.2.conv2.weight, mask/weight parameters,3588,3588 density 0.1804738192243851,0.1804738192243851
before tensor 16384 mask 1954.0 16384
layer1.2.conv3.weight, mask/weight parameters,1954,1954 density 0.1624002659574468,0.1624002659574468
before tensor 32768 mask 5555.0 32768
layer2.0.conv1.weight, mask/weight parameters,5555,5555 density 0.28932291666666665,0.28932291666666665
before tensor 147456 mask 13050.0 147456
layer2.0.conv2.weight, mask/weight parameters,13050,13050 density 0.2577777777777778,0.2577777777777778
before tensor 65536 mask 7283.0 65536
layer2.0.conv3.weight, mask/weight parameters,7283,7283 density 0.18966145833333334,0.18966145833333334
layer2.0.shortcut.0.weight, mask/weight parameters,32236,32236 density 0.245941162109375,0.245941162109375
before tensor 65536 mask 3861.0 65536
layer2.1.conv1.weight, mask/weight parameters,3861,3861 density 0.100546875,0.100546875
before tensor 147456 mask 4289.0 147456
layer2.1.conv2.weight, mask/weight parameters,4289,4289 density 0.08472098765432098,0.08472098765432098
before tensor 65536 mask 4374.0 65536
layer2.1.conv3.weight, mask/weight parameters,4374,4374 density 0.11390625,0.11390625
before tensor 65536 mask 11082.0 65536
layer2.2.conv1.weight, mask/weight parameters,11082,11082 density 0.28859375,0.28859375
before tensor 147456 mask 22281.0 147456
layer2.2.conv2.weight, mask/weight parameters,22281,22281 density 0.4401185185185185,0.4401185185185185
before tensor 65536 mask 13728.0 65536
layer2.2.conv3.weight, mask/weight parameters,13728,13728 density 0.3575,0.3575
before tensor 65536 mask 11265.0 65536
layer2.3.conv1.weight, mask/weight parameters,11265,11265 density 0.293359375,0.293359375
before tensor 147456 mask 20955.0 147456
layer2.3.conv2.weight, mask/weight parameters,20955,20955 density 0.4139259259259259,0.4139259259259259
before tensor 65536 mask 11802.0 65536
layer2.3.conv3.weight, mask/weight parameters,11802,11802 density 0.30734375,0.30734375
before tensor 131072 mask 30504.0 131072
layer3.0.conv1.weight, mask/weight parameters,30504,30504 density 0.46184593023255816,0.46184593023255816
before tensor 589824 mask 68104.0 589824
layer3.0.conv2.weight, mask/weight parameters,68104,68104 density 0.45472694616375886,0.45472694616375886
before tensor 262144 mask 58523.0 262144
layer3.0.conv3.weight, mask/weight parameters,58523,58523 density 0.4430338541666667,0.4430338541666667
layer3.0.shortcut.0.weight, mask/weight parameters,106114,106114 density 0.20239639282226562,0.20239639282226562
before tensor 262144 mask 29141.0 262144
layer3.1.conv1.weight, mask/weight parameters,29141,29141 density 0.2206047117248062,0.2206047117248062
before tensor 589824 mask 60705.0 589824
layer3.1.conv2.weight, mask/weight parameters,60705,60705 density 0.40532419926687097,0.40532419926687097
before tensor 262144 mask 49303.0 262144
layer3.1.conv3.weight, mask/weight parameters,49303,49303 density 0.3732361312984496,0.3732361312984496
before tensor 262144 mask 31072.0 262144
layer3.2.conv1.weight, mask/weight parameters,31072,31072 density 0.23522286821705427,0.23522286821705427
before tensor 589824 mask 53760.0 589824
layer3.2.conv2.weight, mask/weight parameters,53760,53760 density 0.35895278729243035,0.35895278729243035
before tensor 262144 mask 48758.0 262144
layer3.2.conv3.weight, mask/weight parameters,48758,48758 density 0.36911034399224807,0.36911034399224807
before tensor 262144 mask 34193.0 262144
layer3.3.conv1.weight, mask/weight parameters,34193,34193 density 0.25884962451550386,0.25884962451550386
before tensor 589824 mask 47200.0 589824
layer3.3.conv2.weight, mask/weight parameters,47200,47200 density 0.3151520007478183,0.3151520007478183
before tensor 262144 mask 42085.0 262144
layer3.3.conv3.weight, mask/weight parameters,42085,42085 density 0.3185940528100775,0.3185940528100775
before tensor 262144 mask 37518.0 262144
layer3.4.conv1.weight, mask/weight parameters,37518,37518 density 0.2840207122093023,0.2840207122093023
before tensor 589824 mask 47937.0 589824
layer3.4.conv2.weight, mask/weight parameters,47937,47937 density 0.3200729122849188,0.3200729122849188
before tensor 262144 mask 39593.0 262144
layer3.4.conv3.weight, mask/weight parameters,39593,39593 density 0.2997289849806202,0.2997289849806202
before tensor 262144 mask 43207.0 262144
layer3.5.conv1.weight, mask/weight parameters,43207,43207 density 0.32708787548449614,0.32708787548449614
before tensor 589824 mask 47667.0 589824
layer3.5.conv2.weight, mask/weight parameters,47667,47667 density 0.3182701360094546,0.3182701360094546
before tensor 262144 mask 37866.0 262144
layer3.5.conv3.weight, mask/weight parameters,37866,37866 density 0.2866551598837209,0.2866551598837209
before tensor 524288 mask 131862.0 524288
layer4.0.conv1.weight, mask/weight parameters,131862,131862 density 0.5365478515625,0.5365478515625
before tensor 2359296 mask 202363.0 2359296
layer4.0.conv2.weight, mask/weight parameters,202363,202363 density 0.39036072530864196,0.39036072530864196
before tensor 1048576 mask 106968.0 1048576
layer4.0.conv3.weight, mask/weight parameters,106968,106968 density 0.217626953125,0.217626953125
layer4.0.shortcut.0.weight, mask/weight parameters,157599,157599 density 0.0751490592956543,0.0751490592956543
before tensor 1048576 mask 112522.0 1048576
layer4.1.conv1.weight, mask/weight parameters,112522,112522 density 0.22892659505208332,0.22892659505208332
before tensor 2359296 mask 181395.0 2359296
layer4.1.conv2.weight, mask/weight parameters,181395,181395 density 0.34991319444444446,0.34991319444444446
before tensor 1048576 mask 82953.0 1048576
layer4.1.conv3.weight, mask/weight parameters,82953,82953 density 0.168768310546875,0.168768310546875
before tensor 1048576 mask 71970.0 1048576
layer4.2.conv1.weight, mask/weight parameters,71970,71970 density 0.14642333984375,0.14642333984375
before tensor 2359296 mask 66200.0 2359296
layer4.2.conv2.weight, mask/weight parameters,66200,66200 density 0.12770061728395063,0.12770061728395063
before tensor 1048576 mask 35843.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35843,35843 density 0.07292277018229167,0.07292277018229167
classifier.weight, mask/weight parameters,107716,107716 density 0.52595703125,0.52595703125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.23041422353775878 0.23041422353775878 after dst
Death rate: 0.1079746035303305

dynamic sparse change grow
self.total_params*pruning_rate 2553818.77788669
self.total_nonzero 2365205.0
to grow 188613.7778866901
len(all_scores) 10265013 6907645
increse 188613.0 before_mask 2553817.0 after_mask 2553817.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1185,1166 density 0.6857638888888888,0.6747685185185185
before tensor 4096 mask 710.0 4096
layer1.0.conv1.weight, mask/weight parameters,710,669 density 0.2360372340425532,0.22240691489361702
before tensor 36864 mask 3906.0 36864
layer1.0.conv2.weight, mask/weight parameters,3906,3780 density 0.19646899049343594,0.19013128112267993
before tensor 16384 mask 4018.0 16384
layer1.0.conv3.weight, mask/weight parameters,4018,3888 density 0.33394281914893614,0.32313829787234044
layer1.0.shortcut.0.weight, mask/weight parameters,5892,5636 density 0.359619140625,0.343994140625
before tensor 16384 mask 2750.0 16384
layer1.1.conv1.weight, mask/weight parameters,2750,2603 density 0.22855718085106383,0.21633976063829788
before tensor 36864 mask 4242.0 36864
layer1.1.conv2.weight, mask/weight parameters,4242,4133 density 0.21336954881545195,0.2078869272169408
before tensor 16384 mask 2522.0 16384
layer1.1.conv3.weight, mask/weight parameters,2522,2446 density 0.20960771276595744,0.20329122340425532
before tensor 16384 mask 3146.0 16384
layer1.2.conv1.weight, mask/weight parameters,3146,2940 density 0.261469414893617,0.24434840425531915
before tensor 36864 mask 3772.0 36864
layer1.2.conv2.weight, mask/weight parameters,3772,3588 density 0.18972888687691766,0.1804738192243851
before tensor 16384 mask 2027.0 16384
layer1.2.conv3.weight, mask/weight parameters,2027,1954 density 0.16846742021276595,0.1624002659574468
before tensor 32768 mask 5902.0 32768
layer2.0.conv1.weight, mask/weight parameters,5902,5555 density 0.3073958333333333,0.28932291666666665
before tensor 147456 mask 13384.0 147456
layer2.0.conv2.weight, mask/weight parameters,13384,13050 density 0.2643753086419753,0.2577777777777778
before tensor 65536 mask 7581.0 65536
layer2.0.conv3.weight, mask/weight parameters,7581,7283 density 0.197421875,0.18966145833333334
layer2.0.shortcut.0.weight, mask/weight parameters,33475,32236 density 0.25539398193359375,0.245941162109375
before tensor 65536 mask 4030.0 65536
layer2.1.conv1.weight, mask/weight parameters,4030,3861 density 0.10494791666666667,0.100546875
before tensor 147456 mask 4424.0 147456
layer2.1.conv2.weight, mask/weight parameters,4424,4289 density 0.08738765432098765,0.08472098765432098
before tensor 65536 mask 4501.0 65536
layer2.1.conv3.weight, mask/weight parameters,4501,4374 density 0.11721354166666667,0.11390625
before tensor 65536 mask 11570.0 65536
layer2.2.conv1.weight, mask/weight parameters,11570,11082 density 0.30130208333333336,0.28859375
before tensor 147456 mask 23528.0 147456
layer2.2.conv2.weight, mask/weight parameters,23528,22281 density 0.4647506172839506,0.4401185185185185
before tensor 65536 mask 14370.0 65536
layer2.2.conv3.weight, mask/weight parameters,14370,13728 density 0.37421875,0.3575
before tensor 65536 mask 11782.0 65536
layer2.3.conv1.weight, mask/weight parameters,11782,11265 density 0.30682291666666667,0.293359375
before tensor 147456 mask 21827.0 147456
layer2.3.conv2.weight, mask/weight parameters,21827,20955 density 0.4311506172839506,0.4139259259259259
before tensor 65536 mask 12337.0 65536
layer2.3.conv3.weight, mask/weight parameters,12337,11802 density 0.3212760416666667,0.30734375
before tensor 131072 mask 32373.0 131072
layer3.0.conv1.weight, mask/weight parameters,32373,30504 density 0.4901435319767442,0.46184593023255816
before tensor 589824 mask 71768.0 589824
layer3.0.conv2.weight, mask/weight parameters,71768,68104 density 0.4791912879167251,0.45472694616375886
before tensor 262144 mask 62040.0 262144
layer3.0.conv3.weight, mask/weight parameters,62040,58523 density 0.46965843023255816,0.4430338541666667
layer3.0.shortcut.0.weight, mask/weight parameters,110914,106114 density 0.21155166625976562,0.20239639282226562
before tensor 262144 mask 31335.0 262144
layer3.1.conv1.weight, mask/weight parameters,31335,29141 density 0.23721384447674418,0.2206047117248062
before tensor 589824 mask 64886.0 589824
layer3.1.conv2.weight, mask/weight parameters,64886,60705 density 0.43324052373989275,0.40532419926687097
before tensor 262144 mask 52703.0 262144
layer3.1.conv3.weight, mask/weight parameters,52703,49303 density 0.3989749878875969,0.3732361312984496
before tensor 262144 mask 33419.0 262144
layer3.2.conv1.weight, mask/weight parameters,33419,31072 density 0.25299024951550386,0.23522286821705427
before tensor 589824 mask 58553.0 589824
layer3.2.conv2.weight, mask/weight parameters,58553,53760 density 0.39095540465650436,0.35895278729243035
before tensor 262144 mask 52761.0 262144
layer3.2.conv3.weight, mask/weight parameters,52761,48758 density 0.3994140625,0.36911034399224807
before tensor 262144 mask 36905.0 262144
layer3.3.conv1.weight, mask/weight parameters,36905,34193 density 0.2793801477713178,0.25884962451550386
before tensor 589824 mask 51580.0 589824
layer3.3.conv2.weight, mask/weight parameters,51580,47200 density 0.3443970381053489,0.3151520007478183
before tensor 262144 mask 45728.0 262144
layer3.3.conv3.weight, mask/weight parameters,45728,42085 density 0.34617248062015504,0.3185940528100775
before tensor 262144 mask 41179.0 262144
layer3.4.conv1.weight, mask/weight parameters,41179,37518 density 0.3117354045542636,0.2840207122093023
before tensor 589824 mask 52669.0 589824
layer3.4.conv2.weight, mask/weight parameters,52669,47937 density 0.3516682357497212,0.3200729122849188
before tensor 262144 mask 43153.0 262144
layer3.4.conv3.weight, mask/weight parameters,43153,39593 density 0.32667908187984496,0.2997289849806202
before tensor 262144 mask 47990.0 262144
layer3.5.conv1.weight, mask/weight parameters,47990,43207 density 0.36329639050387597,0.32708787548449614
before tensor 589824 mask 53893.0 589824
layer3.5.conv2.weight, mask/weight parameters,53893,47667 density 0.35984082153182567,0.3182701360094546
before tensor 262144 mask 41482.0 262144
layer3.5.conv3.weight, mask/weight parameters,41482,37866 density 0.31402919089147285,0.2866551598837209
before tensor 524288 mask 141285.0 524288
layer4.0.conv1.weight, mask/weight parameters,141285,131862 density 0.57489013671875,0.5365478515625
before tensor 2359296 mask 219174.0 2359296
layer4.0.conv2.weight, mask/weight parameters,219174,202363 density 0.42278935185185185,0.39036072530864196
before tensor 1048576 mask 116230.0 1048576
layer4.0.conv3.weight, mask/weight parameters,116230,106968 density 0.23647054036458334,0.217626953125
layer4.0.shortcut.0.weight, mask/weight parameters,164293,157599 density 0.07834100723266602,0.0751490592956543
before tensor 1048576 mask 127061.0 1048576
layer4.1.conv1.weight, mask/weight parameters,127061,112522 density 0.2585062662760417,0.22892659505208332
before tensor 2359296 mask 198489.0 2359296
layer4.1.conv2.weight, mask/weight parameters,198489,181395 density 0.3828877314814815,0.34991319444444446
before tensor 1048576 mask 89436.0 1048576
layer4.1.conv3.weight, mask/weight parameters,89436,82953 density 0.1819580078125,0.168768310546875
before tensor 1048576 mask 84767.0 1048576
layer4.2.conv1.weight, mask/weight parameters,84767,71970 density 0.17245890299479166,0.14642333984375
before tensor 2359296 mask 77361.0 2359296
layer4.2.conv2.weight, mask/weight parameters,77361,66200 density 0.14923032407407408,0.12770061728395063
before tensor 1048576 mask 39067.0 1048576
layer4.2.conv3.weight, mask/weight parameters,39067,35843 density 0.07948201497395833,0.07292277018229167
classifier.weight, mask/weight parameters,108442,107716 density 0.529501953125,0.52595703125
Total Model parameters after dst: 2553817 2365205
Total parameters under density level of 0.1: 0.24878848180708588 0.23041422353775878 after dst
Death rate: 0.1079746035303305


Training summary: Average loss: 0.3831, Accuracy: 44022/50000 (88.044%)


Evaluation: Average loss: 1.0089, Accuracy: 7306/10000 (73.060%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.72 seconds.

Train Epoch: 96 [0/50000 (0%)]	Loss: 0.363424 Accuracy: 86/100 (86.000%
Train Epoch: 96 [10000/50000 (20%)]	Loss: 0.486357 Accuracy: 9053/10100 (89.634%
Train Epoch: 96 [20000/50000 (40%)]	Loss: 0.259909 Accuracy: 17946/20100 (89.284%
Train Epoch: 96 [30000/50000 (60%)]	Loss: 0.340078 Accuracy: 26741/30100 (88.841%
Train Epoch: 96 [40000/50000 (80%)]	Loss: 0.484004 Accuracy: 35466/40100 (88.444%
current layer rate 0.49182134729176147
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3870.0
Total filter_masks items: 7289589.0
3870.0 / 7552 channels
Total channels to prune: 32.23481474738219
Layer ('layer3', 0, 'conv1'): Pruned 1/129.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/129.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/129.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/129.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/129.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/129.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/129.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/129.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/129.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/129.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/129.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/129.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 1/240.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/240.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/240.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/240.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/240.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/240.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3852.0
Total filter_masks items: 7239738.0
After apply_mask:
Total filter_names items: 3852.0
Total filter_masks items: 7239738.0
Total pruned: 18/32.23481474738219 channels
===========done ===============

Training summary: Average loss: 0.3790, Accuracy: 44079/50000 (88.158%)


Evaluation: Average loss: 1.0786, Accuracy: 7166/10000 (71.660%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.57 seconds.

Train Epoch: 97 [0/50000 (0%)]	Loss: 0.376327 Accuracy: 89/100 (89.000%
Train Epoch: 97 [10000/50000 (20%)]	Loss: 0.315922 Accuracy: 8964/10100 (88.752%
Train Epoch: 97 [20000/50000 (40%)]	Loss: 0.355596 Accuracy: 17823/20100 (88.672%
Train Epoch: 97 [30000/50000 (60%)]	Loss: 0.544834 Accuracy: 26623/30100 (88.449%
Train Epoch: 97 [40000/50000 (80%)]	Loss: 0.381829 Accuracy: 35368/40100 (88.200%
current mest  death_rate 0.1071100259813976


dynamic sparse change prune
to kill 168710.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1160,1160 density 0.6712962962962963,0.6712962962962963
before tensor 4096 mask 685.0 4096
layer1.0.conv1.weight, mask/weight parameters,685,685 density 0.22772606382978725,0.22772606382978725
before tensor 36864 mask 3766.0 36864
layer1.0.conv2.weight, mask/weight parameters,3766,3766 density 0.18942709119259596,0.18942709119259596
before tensor 16384 mask 3882.0 16384
layer1.0.conv3.weight, mask/weight parameters,3882,3882 density 0.3226396276595745,0.3226396276595745
layer1.0.shortcut.0.weight, mask/weight parameters,5613,5613 density 0.34259033203125,0.34259033203125
before tensor 16384 mask 2631.0 16384
layer1.1.conv1.weight, mask/weight parameters,2631,2631 density 0.21866688829787234,0.21866688829787234
before tensor 36864 mask 4140.0 36864
layer1.1.conv2.weight, mask/weight parameters,4140,4140 density 0.20823902218198279,0.20823902218198279
before tensor 16384 mask 2416.0 16384
layer1.1.conv3.weight, mask/weight parameters,2416,2416 density 0.20079787234042554,0.20079787234042554
before tensor 16384 mask 2972.0 16384
layer1.2.conv1.weight, mask/weight parameters,2972,2972 density 0.24700797872340424,0.24700797872340424
before tensor 36864 mask 3609.0 36864
layer1.2.conv2.weight, mask/weight parameters,3609,3609 density 0.1815301041195111,0.1815301041195111
before tensor 16384 mask 1963.0 16384
layer1.2.conv3.weight, mask/weight parameters,1963,1963 density 0.16314827127659576,0.16314827127659576
before tensor 32768 mask 5564.0 32768
layer2.0.conv1.weight, mask/weight parameters,5564,5564 density 0.28979166666666667,0.28979166666666667
before tensor 147456 mask 12954.0 147456
layer2.0.conv2.weight, mask/weight parameters,12954,12954 density 0.2558814814814815,0.2558814814814815
before tensor 65536 mask 7274.0 65536
layer2.0.conv3.weight, mask/weight parameters,7274,7274 density 0.18942708333333333,0.18942708333333333
layer2.0.shortcut.0.weight, mask/weight parameters,31949,31949 density 0.24375152587890625,0.24375152587890625
before tensor 65536 mask 3837.0 65536
layer2.1.conv1.weight, mask/weight parameters,3837,3837 density 0.099921875,0.099921875
before tensor 147456 mask 4256.0 147456
layer2.1.conv2.weight, mask/weight parameters,4256,4256 density 0.08406913580246914,0.08406913580246914
before tensor 65536 mask 4347.0 65536
layer2.1.conv3.weight, mask/weight parameters,4347,4347 density 0.113203125,0.113203125
before tensor 65536 mask 10995.0 65536
layer2.2.conv1.weight, mask/weight parameters,10995,10995 density 0.286328125,0.286328125
before tensor 147456 mask 22286.0 147456
layer2.2.conv2.weight, mask/weight parameters,22286,22286 density 0.44021728395061727,0.44021728395061727
before tensor 65536 mask 13623.0 65536
layer2.2.conv3.weight, mask/weight parameters,13623,13623 density 0.354765625,0.354765625
before tensor 65536 mask 11200.0 65536
layer2.3.conv1.weight, mask/weight parameters,11200,11200 density 0.2916666666666667,0.2916666666666667
before tensor 147456 mask 20858.0 147456
layer2.3.conv2.weight, mask/weight parameters,20858,20858 density 0.41200987654320986,0.41200987654320986
before tensor 65536 mask 11797.0 65536
layer2.3.conv3.weight, mask/weight parameters,11797,11797 density 0.30721354166666665,0.30721354166666665
before tensor 131072 mask 30357.0 131072
layer3.0.conv1.weight, mask/weight parameters,30357,30357 density 0.4632110595703125,0.4632110595703125
before tensor 589824 mask 66706.0 589824
layer3.0.conv2.weight, mask/weight parameters,66706,66706 density 0.4523790147569444,0.4523790147569444
before tensor 262144 mask 58229.0 262144
layer3.0.conv3.weight, mask/weight parameters,58229,58229 density 0.44425201416015625,0.44425201416015625
layer3.0.shortcut.0.weight, mask/weight parameters,105158,105158 density 0.20057296752929688,0.20057296752929688
before tensor 262144 mask 28945.0 262144
layer3.1.conv1.weight, mask/weight parameters,28945,28945 density 0.22083282470703125,0.22083282470703125
before tensor 589824 mask 59108.0 589824
layer3.1.conv2.weight, mask/weight parameters,59108,59108 density 0.4008517795138889,0.4008517795138889
before tensor 262144 mask 49024.0 262144
layer3.1.conv3.weight, mask/weight parameters,49024,49024 density 0.3740234375,0.3740234375
before tensor 262144 mask 30557.0 262144
layer3.2.conv1.weight, mask/weight parameters,30557,30557 density 0.23313140869140625,0.23313140869140625
before tensor 589824 mask 53112.0 589824
layer3.2.conv2.weight, mask/weight parameters,53112,53112 density 0.3601888020833333,0.3601888020833333
before tensor 262144 mask 48842.0 262144
layer3.2.conv3.weight, mask/weight parameters,48842,48842 density 0.3726348876953125,0.3726348876953125
before tensor 262144 mask 33725.0 262144
layer3.3.conv1.weight, mask/weight parameters,33725,33725 density 0.25730133056640625,0.25730133056640625
before tensor 589824 mask 46556.0 589824
layer3.3.conv2.weight, mask/weight parameters,46556,46556 density 0.3157280815972222,0.3157280815972222
before tensor 262144 mask 42087.0 262144
layer3.3.conv3.weight, mask/weight parameters,42087,42087 density 0.32109832763671875,0.32109832763671875
before tensor 262144 mask 37353.0 262144
layer3.4.conv1.weight, mask/weight parameters,37353,37353 density 0.28498077392578125,0.28498077392578125
before tensor 589824 mask 47706.0 589824
layer3.4.conv2.weight, mask/weight parameters,47706,47706 density 0.3235270182291667,0.3235270182291667
before tensor 262144 mask 39845.0 262144
layer3.4.conv3.weight, mask/weight parameters,39845,39845 density 0.30399322509765625,0.30399322509765625
before tensor 262144 mask 43783.0 262144
layer3.5.conv1.weight, mask/weight parameters,43783,43783 density 0.33403778076171875,0.33403778076171875
before tensor 589824 mask 48314.0 589824
layer3.5.conv2.weight, mask/weight parameters,48314,48314 density 0.3276502821180556,0.3276502821180556
before tensor 262144 mask 38275.0 262144
layer3.5.conv3.weight, mask/weight parameters,38275,38275 density 0.29201507568359375,0.29201507568359375
before tensor 524288 mask 132459.0 524288
layer4.0.conv1.weight, mask/weight parameters,132459,132459 density 0.5412321848849372,0.5412321848849372
before tensor 2359296 mask 202511.0 2359296
layer4.0.conv2.weight, mask/weight parameters,202511,202511 density 0.39392206407839886,0.39392206407839886
before tensor 1048576 mask 107501.0 1048576
layer4.0.conv3.weight, mask/weight parameters,107501,107501 density 0.2196264546286611,0.2196264546286611
layer4.0.shortcut.0.weight, mask/weight parameters,155578,155578 density 0.07418537139892578,0.07418537139892578
before tensor 1048576 mask 114889.0 1048576
layer4.1.conv1.weight, mask/weight parameters,114889,114889 density 0.23472027000523013,0.23472027000523013
before tensor 2359296 mask 182102.0 2359296
layer4.1.conv2.weight, mask/weight parameters,182102,182102 density 0.3542227124097189,0.3542227124097189
before tensor 1048576 mask 83045.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83045,83045 density 0.1696624117416318,0.1696624117416318
before tensor 1048576 mask 74464.0 1048576
layer4.2.conv1.weight, mask/weight parameters,74464,74464 density 0.1521312761506276,0.1521312761506276
before tensor 2359296 mask 67987.0 2359296
layer4.2.conv2.weight, mask/weight parameters,67987,67987 density 0.1322475291243345,0.1322475291243345
before tensor 1048576 mask 35749.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35749,35749 density 0.0730358427039749,0.0730358427039749
classifier.weight, mask/weight parameters,107461,107461 density 0.5247119140625,0.5247119140625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.2315386677176534 0.2315386677176534 after dst
Death rate: 0.1071100259813976

dynamic sparse change grow
self.total_params*pruning_rate 2533369.7620328474
self.total_nonzero 2365205.0
to grow 168164.7620328474
len(all_scores) 10215162 6859953
increse 168164.0 before_mask 2533368.0 after_mask 2533368.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1173,1160 density 0.6788194444444444,0.6712962962962963
before tensor 4096 mask 704.0 4096
layer1.0.conv1.weight, mask/weight parameters,704,685 density 0.23404255319148937,0.22772606382978725
before tensor 36864 mask 3935.0 36864
layer1.0.conv2.weight, mask/weight parameters,3935,3766 density 0.19792766963432423,0.18942709119259596
before tensor 16384 mask 4008.0 16384
layer1.0.conv3.weight, mask/weight parameters,4008,3882 density 0.33311170212765956,0.3226396276595745
layer1.0.shortcut.0.weight, mask/weight parameters,5755,5613 density 0.35125732421875,0.34259033203125
before tensor 16384 mask 2724.0 16384
layer1.1.conv1.weight, mask/weight parameters,2724,2631 density 0.22639627659574468,0.21866688829787234
before tensor 36864 mask 4308.0 36864
layer1.1.conv2.weight, mask/weight parameters,4308,4140 density 0.2166893013429908,0.20823902218198279
before tensor 16384 mask 2469.0 16384
layer1.1.conv3.weight, mask/weight parameters,2469,2416 density 0.2052027925531915,0.20079787234042554
before tensor 16384 mask 3115.0 16384
layer1.2.conv1.weight, mask/weight parameters,3115,2972 density 0.25889295212765956,0.24700797872340424
before tensor 36864 mask 3664.0 36864
layer1.2.conv2.weight, mask/weight parameters,3664,3609 density 0.1842965645591268,0.1815301041195111
before tensor 16384 mask 2032.0 16384
layer1.2.conv3.weight, mask/weight parameters,2032,1963 density 0.16888297872340424,0.16314827127659576
before tensor 32768 mask 5918.0 32768
layer2.0.conv1.weight, mask/weight parameters,5918,5564 density 0.30822916666666667,0.28979166666666667
before tensor 147456 mask 13455.0 147456
layer2.0.conv2.weight, mask/weight parameters,13455,12954 density 0.2657777777777778,0.2558814814814815
before tensor 65536 mask 7524.0 65536
layer2.0.conv3.weight, mask/weight parameters,7524,7274 density 0.1959375,0.18942708333333333
layer2.0.shortcut.0.weight, mask/weight parameters,33126,31949 density 0.2527313232421875,0.24375152587890625
before tensor 65536 mask 4022.0 65536
layer2.1.conv1.weight, mask/weight parameters,4022,3837 density 0.10473958333333333,0.099921875
before tensor 147456 mask 4444.0 147456
layer2.1.conv2.weight, mask/weight parameters,4444,4256 density 0.08778271604938272,0.08406913580246914
before tensor 65536 mask 4461.0 65536
layer2.1.conv3.weight, mask/weight parameters,4461,4347 density 0.116171875,0.113203125
before tensor 65536 mask 11307.0 65536
layer2.2.conv1.weight, mask/weight parameters,11307,10995 density 0.294453125,0.286328125
before tensor 147456 mask 22974.0 147456
layer2.2.conv2.weight, mask/weight parameters,22974,22286 density 0.4538074074074074,0.44021728395061727
before tensor 65536 mask 14189.0 65536
layer2.2.conv3.weight, mask/weight parameters,14189,13623 density 0.36950520833333333,0.354765625
before tensor 65536 mask 11684.0 65536
layer2.3.conv1.weight, mask/weight parameters,11684,11200 density 0.3042708333333333,0.2916666666666667
before tensor 147456 mask 21564.0 147456
layer2.3.conv2.weight, mask/weight parameters,21564,20858 density 0.42595555555555553,0.41200987654320986
before tensor 65536 mask 12274.0 65536
layer2.3.conv3.weight, mask/weight parameters,12274,11797 density 0.31963541666666667,0.30721354166666665
before tensor 131072 mask 31789.0 131072
layer3.0.conv1.weight, mask/weight parameters,31789,30357 density 0.4850616455078125,0.4632110595703125
before tensor 589824 mask 69619.0 589824
layer3.0.conv2.weight, mask/weight parameters,69619,66706 density 0.4721340603298611,0.4523790147569444
before tensor 262144 mask 61246.0 262144
layer3.0.conv3.weight, mask/weight parameters,61246,58229 density 0.4672698974609375,0.44425201416015625
layer3.0.shortcut.0.weight, mask/weight parameters,109573,105158 density 0.20899391174316406,0.20057296752929688
before tensor 262144 mask 31540.0 262144
layer3.1.conv1.weight, mask/weight parameters,31540,28945 density 0.240631103515625,0.22083282470703125
before tensor 589824 mask 65117.0 589824
layer3.1.conv2.weight, mask/weight parameters,65117,59108 density 0.4416029188368056,0.4008517795138889
before tensor 262144 mask 52567.0 262144
layer3.1.conv3.weight, mask/weight parameters,52567,49024 density 0.40105438232421875,0.3740234375
before tensor 262144 mask 32733.0 262144
layer3.2.conv1.weight, mask/weight parameters,32733,30557 density 0.24973297119140625,0.23313140869140625
before tensor 589824 mask 57238.0 589824
layer3.2.conv2.weight, mask/weight parameters,57238,53112 density 0.3881700303819444,0.3601888020833333
before tensor 262144 mask 52561.0 262144
layer3.2.conv3.weight, mask/weight parameters,52561,48842 density 0.40100860595703125,0.3726348876953125
before tensor 262144 mask 36948.0 262144
layer3.3.conv1.weight, mask/weight parameters,36948,33725 density 0.281890869140625,0.25730133056640625
before tensor 589824 mask 50873.0 589824
layer3.3.conv2.weight, mask/weight parameters,50873,46556 density 0.3450046115451389,0.3157280815972222
before tensor 262144 mask 45223.0 262144
layer3.3.conv3.weight, mask/weight parameters,45223,42087 density 0.34502410888671875,0.32109832763671875
before tensor 262144 mask 40170.0 262144
layer3.4.conv1.weight, mask/weight parameters,40170,37353 density 0.3064727783203125,0.28498077392578125
before tensor 589824 mask 51325.0 589824
layer3.4.conv2.weight, mask/weight parameters,51325,47706 density 0.3480699327256944,0.3235270182291667
before tensor 262144 mask 42841.0 262144
layer3.4.conv3.weight, mask/weight parameters,42841,39845 density 0.32685089111328125,0.30399322509765625
before tensor 262144 mask 47290.0 262144
layer3.5.conv1.weight, mask/weight parameters,47290,43783 density 0.3607940673828125,0.33403778076171875
before tensor 589824 mask 52192.0 589824
layer3.5.conv2.weight, mask/weight parameters,52192,48314 density 0.3539496527777778,0.3276502821180556
before tensor 262144 mask 41121.0 262144
layer3.5.conv3.weight, mask/weight parameters,41121,38275 density 0.31372833251953125,0.29201507568359375
before tensor 524288 mask 140899.0 524288
layer4.0.conv1.weight, mask/weight parameters,140899,132459 density 0.5757183250523012,0.5412321848849372
before tensor 2359296 mask 216813.0 2359296
layer4.0.conv2.weight, mask/weight parameters,216813,202511 density 0.4217421497055957,0.39392206407839886
before tensor 1048576 mask 114684.0 1048576
layer4.0.conv3.weight, mask/weight parameters,114684,107501 density 0.23430145135983263,0.2196264546286611
layer4.0.shortcut.0.weight, mask/weight parameters,162026,155578 density 0.07726001739501953,0.07418537139892578
before tensor 1048576 mask 125884.0 1048576
layer4.1.conv1.weight, mask/weight parameters,125884,114889 density 0.25718325052301255,0.23472027000523013
before tensor 2359296 mask 199757.0 2359296
layer4.1.conv2.weight, mask/weight parameters,199757,182102 density 0.3885650150071291,0.3542227124097189
before tensor 1048576 mask 89549.0 1048576
layer4.1.conv3.weight, mask/weight parameters,89549,83045 density 0.18295019939853557,0.1696624117416318
before tensor 1048576 mask 85720.0 1048576
layer4.2.conv1.weight, mask/weight parameters,85720,74464 density 0.17512748430962344,0.1521312761506276
before tensor 2359296 mask 77738.0 2359296
layer4.2.conv2.weight, mask/weight parameters,77738,67987 density 0.15121506198343088,0.1322475291243345
before tensor 1048576 mask 39200.0 1048576
layer4.2.conv3.weight, mask/weight parameters,39200,35749 density 0.08008629707112971,0.0730358427039749
classifier.weight, mask/weight parameters,108303,107461 density 0.5288232421875,0.5247119140625
Total Model parameters after dst: 2533368 2365205
Total parameters under density level of 0.1: 0.2480007659203055 0.2315386677176534 after dst
Death rate: 0.1071100259813976


Training summary: Average loss: 0.3864, Accuracy: 43963/50000 (87.926%)


Evaluation: Average loss: 1.0141, Accuracy: 7293/10000 (72.930%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.72 seconds.

Train Epoch: 98 [0/50000 (0%)]	Loss: 0.389549 Accuracy: 90/100 (90.000%
Train Epoch: 98 [10000/50000 (20%)]	Loss: 0.388654 Accuracy: 9064/10100 (89.743%
Train Epoch: 98 [20000/50000 (40%)]	Loss: 0.311902 Accuracy: 17951/20100 (89.308%
Train Epoch: 98 [30000/50000 (60%)]	Loss: 0.484300 Accuracy: 26745/30100 (88.854%
Train Epoch: 98 [40000/50000 (80%)]	Loss: 0.378143 Accuracy: 35534/40100 (88.613%
current layer rate 0.4932200728265817
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3852.0
Total filter_masks items: 7239738.0
3852.0 / 7552 channels
Total channels to prune: 24.79798998634442
Layer ('layer4', 0, 'conv1'): Pruned 1/239.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/239.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/239.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/239.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/239.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/239.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3846.0
Total filter_masks items: 7215595.0
After apply_mask:
Total filter_names items: 3846.0
Total filter_masks items: 7215595.0
Total pruned: 6/24.79798998634442 channels
===========done ===============

Training summary: Average loss: 0.3757, Accuracy: 44141/50000 (88.282%)


Evaluation: Average loss: 1.0199, Accuracy: 7293/10000 (72.930%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.52 seconds.

Train Epoch: 99 [0/50000 (0%)]	Loss: 0.345907 Accuracy: 89/100 (89.000%
Train Epoch: 99 [10000/50000 (20%)]	Loss: 0.262354 Accuracy: 8998/10100 (89.089%
Train Epoch: 99 [20000/50000 (40%)]	Loss: 0.278657 Accuracy: 17914/20100 (89.124%
Train Epoch: 99 [30000/50000 (60%)]	Loss: 0.388672 Accuracy: 26748/30100 (88.864%
Train Epoch: 99 [40000/50000 (80%)]	Loss: 0.524653 Accuracy: 35529/40100 (88.601%
current mest  death_rate 0.10628723129572296


dynamic sparse change prune
to kill 161052.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1154,1154 density 0.6678240740740741,0.6678240740740741
before tensor 4096 mask 673.0 4096
layer1.0.conv1.weight, mask/weight parameters,673,673 density 0.2237367021276596,0.2237367021276596
before tensor 36864 mask 3772.0 36864
layer1.0.conv2.weight, mask/weight parameters,3772,3772 density 0.18972888687691766,0.18972888687691766
before tensor 16384 mask 3854.0 16384
layer1.0.conv3.weight, mask/weight parameters,3854,3854 density 0.3203125,0.3203125
layer1.0.shortcut.0.weight, mask/weight parameters,5545,5545 density 0.33843994140625,0.33843994140625
before tensor 16384 mask 2597.0 16384
layer1.1.conv1.weight, mask/weight parameters,2597,2597 density 0.21584109042553193,0.21584109042553193
before tensor 36864 mask 4164.0 36864
layer1.1.conv2.weight, mask/weight parameters,4164,4164 density 0.20944620491926966,0.20944620491926966
before tensor 16384 mask 2377.0 16384
layer1.1.conv3.weight, mask/weight parameters,2377,2377 density 0.1975565159574468,0.1975565159574468
before tensor 16384 mask 2951.0 16384
layer1.2.conv1.weight, mask/weight parameters,2951,2951 density 0.24526263297872342,0.24526263297872342
before tensor 36864 mask 3556.0 36864
layer1.2.conv2.weight, mask/weight parameters,3556,3556 density 0.17886424224133596,0.17886424224133596
before tensor 16384 mask 1942.0 16384
layer1.2.conv3.weight, mask/weight parameters,1942,1942 density 0.1614029255319149,0.1614029255319149
before tensor 32768 mask 5483.0 32768
layer2.0.conv1.weight, mask/weight parameters,5483,5483 density 0.2855729166666667,0.2855729166666667
before tensor 147456 mask 12981.0 147456
layer2.0.conv2.weight, mask/weight parameters,12981,12981 density 0.2564148148148148,0.2564148148148148
before tensor 65536 mask 7225.0 65536
layer2.0.conv3.weight, mask/weight parameters,7225,7225 density 0.18815104166666666,0.18815104166666666
layer2.0.shortcut.0.weight, mask/weight parameters,31611,31611 density 0.24117279052734375,0.24117279052734375
before tensor 65536 mask 3811.0 65536
layer2.1.conv1.weight, mask/weight parameters,3811,3811 density 0.09924479166666667,0.09924479166666667
before tensor 147456 mask 4273.0 147456
layer2.1.conv2.weight, mask/weight parameters,4273,4273 density 0.08440493827160493,0.08440493827160493
before tensor 65536 mask 4311.0 65536
layer2.1.conv3.weight, mask/weight parameters,4311,4311 density 0.112265625,0.112265625
before tensor 65536 mask 10818.0 65536
layer2.2.conv1.weight, mask/weight parameters,10818,10818 density 0.28171875,0.28171875
before tensor 147456 mask 21937.0 147456
layer2.2.conv2.weight, mask/weight parameters,21937,21937 density 0.43332345679012346,0.43332345679012346
before tensor 65536 mask 13477.0 65536
layer2.2.conv3.weight, mask/weight parameters,13477,13477 density 0.35096354166666666,0.35096354166666666
before tensor 65536 mask 11080.0 65536
layer2.3.conv1.weight, mask/weight parameters,11080,11080 density 0.28854166666666664,0.28854166666666664
before tensor 147456 mask 20702.0 147456
layer2.3.conv2.weight, mask/weight parameters,20702,20702 density 0.4089283950617284,0.4089283950617284
before tensor 65536 mask 11732.0 65536
layer2.3.conv3.weight, mask/weight parameters,11732,11732 density 0.30552083333333335,0.30552083333333335
before tensor 131072 mask 30106.0 131072
layer3.0.conv1.weight, mask/weight parameters,30106,30106 density 0.459381103515625,0.459381103515625
before tensor 589824 mask 66091.0 589824
layer3.0.conv2.weight, mask/weight parameters,66091,66091 density 0.4482082790798611,0.4482082790798611
before tensor 262144 mask 58082.0 262144
layer3.0.conv3.weight, mask/weight parameters,58082,58082 density 0.4431304931640625,0.4431304931640625
layer3.0.shortcut.0.weight, mask/weight parameters,104107,104107 density 0.19856834411621094,0.19856834411621094
before tensor 262144 mask 29165.0 262144
layer3.1.conv1.weight, mask/weight parameters,29165,29165 density 0.22251129150390625,0.22251129150390625
before tensor 589824 mask 60297.0 589824
layer3.1.conv2.weight, mask/weight parameters,60297,60297 density 0.4089152018229167,0.4089152018229167
before tensor 262144 mask 49419.0 262144
layer3.1.conv3.weight, mask/weight parameters,49419,49419 density 0.37703704833984375,0.37703704833984375
before tensor 262144 mask 30501.0 262144
layer3.2.conv1.weight, mask/weight parameters,30501,30501 density 0.23270416259765625,0.23270416259765625
before tensor 589824 mask 53317.0 589824
layer3.2.conv2.weight, mask/weight parameters,53317,53317 density 0.3615790473090278,0.3615790473090278
before tensor 262144 mask 49269.0 262144
layer3.2.conv3.weight, mask/weight parameters,49269,49269 density 0.37589263916015625,0.37589263916015625
before tensor 262144 mask 34068.0 262144
layer3.3.conv1.weight, mask/weight parameters,34068,34068 density 0.259918212890625,0.259918212890625
before tensor 589824 mask 47187.0 589824
layer3.3.conv2.weight, mask/weight parameters,47187,47187 density 0.32000732421875,0.32000732421875
before tensor 262144 mask 42224.0 262144
layer3.3.conv3.weight, mask/weight parameters,42224,42224 density 0.3221435546875,0.3221435546875
before tensor 262144 mask 37337.0 262144
layer3.4.conv1.weight, mask/weight parameters,37337,37337 density 0.28485870361328125,0.28485870361328125
before tensor 589824 mask 47709.0 589824
layer3.4.conv2.weight, mask/weight parameters,47709,47709 density 0.32354736328125,0.32354736328125
before tensor 262144 mask 39968.0 262144
layer3.4.conv3.weight, mask/weight parameters,39968,39968 density 0.304931640625,0.304931640625
before tensor 262144 mask 43898.0 262144
layer3.5.conv1.weight, mask/weight parameters,43898,43898 density 0.3349151611328125,0.3349151611328125
before tensor 589824 mask 48498.0 589824
layer3.5.conv2.weight, mask/weight parameters,48498,48498 density 0.3288981119791667,0.3288981119791667
before tensor 262144 mask 38564.0 262144
layer3.5.conv3.weight, mask/weight parameters,38564,38564 density 0.294219970703125,0.294219970703125
before tensor 524288 mask 132608.0 524288
layer4.0.conv1.weight, mask/weight parameters,132608,132608 density 0.5441176470588235,0.5441176470588235
before tensor 2359296 mask 200872.0 2359296
layer4.0.conv2.weight, mask/weight parameters,200872,200872 density 0.39402427637721754,0.39402427637721754
before tensor 1048576 mask 106494.0 1048576
layer4.0.conv3.weight, mask/weight parameters,106494,106494 density 0.21848329175420167,0.21848329175420167
layer4.0.shortcut.0.weight, mask/weight parameters,153178,153178 density 0.07304096221923828,0.07304096221923828
before tensor 1048576 mask 115066.0 1048576
layer4.1.conv1.weight, mask/weight parameters,115066,115066 density 0.23606962316176472,0.23606962316176472
before tensor 2359296 mask 183819.0 2359296
layer4.1.conv2.weight, mask/weight parameters,183819,183819 density 0.36057364122119434,0.36057364122119434
before tensor 1048576 mask 83222.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83222,83222 density 0.170738412552521,0.170738412552521
before tensor 1048576 mask 75892.0 1048576
layer4.2.conv1.weight, mask/weight parameters,75892,75892 density 0.15570017069327732,0.15570017069327732
before tensor 2359296 mask 68968.0 2359296
layer4.2.conv2.weight, mask/weight parameters,68968,68968 density 0.1352854867437171,0.1352854867437171
before tensor 1048576 mask 36008.0 1048576
layer4.2.conv3.weight, mask/weight parameters,36008,36008 density 0.07387408088235294,0.07387408088235294
classifier.weight, mask/weight parameters,107245,107245 density 0.5236572265625,0.5236572265625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.23208719363588665 0.23208719363588665 after dst
Death rate: 0.10628723129572296

dynamic sparse change grow
self.total_params*pruning_rate 2513908.995797841
self.total_nonzero 2365205.0
to grow 148703.99579784088
len(all_scores) 10191019 6836782
increse 148703.0 before_mask 2513907.0 after_mask 2513907.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1184,1154 density 0.6851851851851852,0.6678240740740741
before tensor 4096 mask 688.0 4096
layer1.0.conv1.weight, mask/weight parameters,688,673 density 0.22872340425531915,0.2237367021276596
before tensor 36864 mask 3906.0 36864
layer1.0.conv2.weight, mask/weight parameters,3906,3772 density 0.19646899049343594,0.18972888687691766
before tensor 16384 mask 4039.0 16384
layer1.0.conv3.weight, mask/weight parameters,4039,3854 density 0.335688164893617,0.3203125
layer1.0.shortcut.0.weight, mask/weight parameters,5745,5545 density 0.35064697265625,0.33843994140625
before tensor 16384 mask 2635.0 16384
layer1.1.conv1.weight, mask/weight parameters,2635,2597 density 0.21899933510638298,0.21584109042553193
before tensor 36864 mask 4250.0 36864
layer1.1.conv2.weight, mask/weight parameters,4250,4164 density 0.21377194306121422,0.20944620491926966
before tensor 16384 mask 2412.0 16384
layer1.1.conv3.weight, mask/weight parameters,2412,2377 density 0.2004654255319149,0.1975565159574468
before tensor 16384 mask 3054.0 16384
layer1.2.conv1.weight, mask/weight parameters,3054,2951 density 0.25382313829787234,0.24526263297872342
before tensor 36864 mask 3626.0 36864
layer1.2.conv2.weight, mask/weight parameters,3626,3556 density 0.18238519189175595,0.17886424224133596
before tensor 16384 mask 2018.0 16384
layer1.2.conv3.weight, mask/weight parameters,2018,1942 density 0.16771941489361702,0.1614029255319149
before tensor 32768 mask 5634.0 32768
layer2.0.conv1.weight, mask/weight parameters,5634,5483 density 0.2934375,0.2855729166666667
before tensor 147456 mask 13297.0 147456
layer2.0.conv2.weight, mask/weight parameters,13297,12981 density 0.2626567901234568,0.2564148148148148
before tensor 65536 mask 7458.0 65536
layer2.0.conv3.weight, mask/weight parameters,7458,7225 density 0.19421875,0.18815104166666666
layer2.0.shortcut.0.weight, mask/weight parameters,32583,31611 density 0.24858856201171875,0.24117279052734375
before tensor 65536 mask 3959.0 65536
layer2.1.conv1.weight, mask/weight parameters,3959,3811 density 0.10309895833333334,0.09924479166666667
before tensor 147456 mask 4442.0 147456
layer2.1.conv2.weight, mask/weight parameters,4442,4273 density 0.08774320987654322,0.08440493827160493
before tensor 65536 mask 4375.0 65536
layer2.1.conv3.weight, mask/weight parameters,4375,4311 density 0.11393229166666667,0.112265625
before tensor 65536 mask 11218.0 65536
layer2.2.conv1.weight, mask/weight parameters,11218,10818 density 0.29213541666666665,0.28171875
before tensor 147456 mask 22826.0 147456
layer2.2.conv2.weight, mask/weight parameters,22826,21937 density 0.4508839506172839,0.43332345679012346
before tensor 65536 mask 14068.0 65536
layer2.2.conv3.weight, mask/weight parameters,14068,13477 density 0.36635416666666665,0.35096354166666666
before tensor 65536 mask 11725.0 65536
layer2.3.conv1.weight, mask/weight parameters,11725,11080 density 0.3053385416666667,0.28854166666666664
before tensor 147456 mask 21599.0 147456
layer2.3.conv2.weight, mask/weight parameters,21599,20702 density 0.4266469135802469,0.4089283950617284
before tensor 65536 mask 12138.0 65536
layer2.3.conv3.weight, mask/weight parameters,12138,11732 density 0.31609375,0.30552083333333335
before tensor 131072 mask 31469.0 131072
layer3.0.conv1.weight, mask/weight parameters,31469,30106 density 0.4801788330078125,0.459381103515625
before tensor 589824 mask 69068.0 589824
layer3.0.conv2.weight, mask/weight parameters,69068,66091 density 0.4683973524305556,0.4482082790798611
before tensor 262144 mask 61197.0 262144
layer3.0.conv3.weight, mask/weight parameters,61197,58082 density 0.46689605712890625,0.4431304931640625
layer3.0.shortcut.0.weight, mask/weight parameters,107497,104107 density 0.2050342559814453,0.19856834411621094
before tensor 262144 mask 31060.0 262144
layer3.1.conv1.weight, mask/weight parameters,31060,29165 density 0.236968994140625,0.22251129150390625
before tensor 589824 mask 64710.0 589824
layer3.1.conv2.weight, mask/weight parameters,64710,60297 density 0.4388427734375,0.4089152018229167
before tensor 262144 mask 52668.0 262144
layer3.1.conv3.weight, mask/weight parameters,52668,49419 density 0.401824951171875,0.37703704833984375
before tensor 262144 mask 32580.0 262144
layer3.2.conv1.weight, mask/weight parameters,32580,30501 density 0.248565673828125,0.23270416259765625
before tensor 589824 mask 57282.0 589824
layer3.2.conv2.weight, mask/weight parameters,57282,53317 density 0.3884684244791667,0.3615790473090278
before tensor 262144 mask 52712.0 262144
layer3.2.conv3.weight, mask/weight parameters,52712,49269 density 0.40216064453125,0.37589263916015625
before tensor 262144 mask 36561.0 262144
layer3.3.conv1.weight, mask/weight parameters,36561,34068 density 0.27893829345703125,0.259918212890625
before tensor 589824 mask 50956.0 589824
layer3.3.conv2.weight, mask/weight parameters,50956,47187 density 0.3455674913194444,0.32000732421875
before tensor 262144 mask 45261.0 262144
layer3.3.conv3.weight, mask/weight parameters,45261,42224 density 0.34531402587890625,0.3221435546875
before tensor 262144 mask 40603.0 262144
layer3.4.conv1.weight, mask/weight parameters,40603,37337 density 0.30977630615234375,0.28485870361328125
before tensor 589824 mask 51566.0 589824
layer3.4.conv2.weight, mask/weight parameters,51566,47709 density 0.3497043185763889,0.32354736328125
before tensor 262144 mask 42544.0 262144
layer3.4.conv3.weight, mask/weight parameters,42544,39968 density 0.3245849609375,0.304931640625
before tensor 262144 mask 47023.0 262144
layer3.5.conv1.weight, mask/weight parameters,47023,43898 density 0.35875701904296875,0.3349151611328125
before tensor 589824 mask 52001.0 589824
layer3.5.conv2.weight, mask/weight parameters,52001,48498 density 0.3526543511284722,0.3288981119791667
before tensor 262144 mask 41123.0 262144
layer3.5.conv3.weight, mask/weight parameters,41123,38564 density 0.31374359130859375,0.294219970703125
before tensor 524288 mask 140085.0 524288
layer4.0.conv1.weight, mask/weight parameters,140085,132608 density 0.5747973017331933,0.5441176470588235
before tensor 2359296 mask 214649.0 2359296
layer4.0.conv2.weight, mask/weight parameters,214649,200872 density 0.42104881168153535,0.39402427637721754
before tensor 1048576 mask 113084.0 1048576
layer4.0.conv3.weight, mask/weight parameters,113084,106494 density 0.23200334821428573,0.21848329175420167
layer4.0.shortcut.0.weight, mask/weight parameters,159464,153178 density 0.07603836059570312,0.07304096221923828
before tensor 1048576 mask 123996.0 1048576
layer4.1.conv1.weight, mask/weight parameters,123996,115066 density 0.2543904280462185,0.23606962316176472
before tensor 2359296 mask 199408.0 2359296
layer4.1.conv2.weight, mask/weight parameters,199408,183819 density 0.3911525394471514,0.36057364122119434
before tensor 1048576 mask 88800.0 1048576
layer4.1.conv3.weight, mask/weight parameters,88800,83222 density 0.18218224789915966,0.170738412552521
before tensor 1048576 mask 85617.0 1048576
layer4.2.conv1.weight, mask/weight parameters,85617,75892 density 0.17565199908088236,0.15570017069327732
before tensor 2359296 mask 76040.0 2359296
layer4.2.conv2.weight, mask/weight parameters,76040,68968 density 0.1491577022966049,0.1352854867437171
before tensor 1048576 mask 38028.0 1048576
layer4.2.conv3.weight, mask/weight parameters,38028,36008 density 0.07801831670168068,0.07387408088235294
classifier.weight, mask/weight parameters,107976,107245 density 0.5272265625,0.5236572265625
Total Model parameters after dst: 2513907 2365205
Total parameters under density level of 0.1: 0.24667866873764047 0.23208719363588665 after dst
Death rate: 0.10628723129572296


Training summary: Average loss: 0.3769, Accuracy: 44167/50000 (88.334%)


Evaluation: Average loss: 1.0493, Accuracy: 7306/10000 (73.060%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.71 seconds.

Train Epoch: 100 [0/50000 (0%)]	Loss: 0.479618 Accuracy: 82/100 (82.000%
Train Epoch: 100 [10000/50000 (20%)]	Loss: 0.335288 Accuracy: 8999/10100 (89.099%
Train Epoch: 100 [20000/50000 (40%)]	Loss: 0.306717 Accuracy: 17881/20100 (88.960%
Train Epoch: 100 [30000/50000 (60%)]	Loss: 0.423297 Accuracy: 26678/30100 (88.631%
Train Epoch: 100 [40000/50000 (80%)]	Loss: 0.371429 Accuracy: 35489/40100 (88.501%
current layer rate 0.494449476558944
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3846.0
Total filter_masks items: 7215595.0
3846.0 / 7552 channels
Total channels to prune: 28.082446973145125
Layer ('layer4', 0, 'conv1'): Pruned 1/238.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/238.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/238.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/238.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/238.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/238.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3840.0
Total filter_masks items: 7191506.0
After apply_mask:
Total filter_names items: 3840.0
Total filter_masks items: 7191506.0
Total pruned: 6/28.082446973145125 channels
===========done ===============

Training summary: Average loss: 0.3745, Accuracy: 44167/50000 (88.334%)


Evaluation: Average loss: 1.0273, Accuracy: 7270/10000 (72.700%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.55 seconds.

Train Epoch: 101 [0/50000 (0%)]	Loss: 0.312492 Accuracy: 91/100 (91.000%
Train Epoch: 101 [10000/50000 (20%)]	Loss: 0.208043 Accuracy: 9040/10100 (89.505%
Train Epoch: 101 [20000/50000 (40%)]	Loss: 0.362103 Accuracy: 17959/20100 (89.348%
Train Epoch: 101 [30000/50000 (60%)]	Loss: 0.511599 Accuracy: 26748/30100 (88.864%
Train Epoch: 101 [40000/50000 (80%)]	Loss: 0.420847 Accuracy: 35494/40100 (88.514%
current mest  death_rate 0.10550814114842003


dynamic sparse change prune
to kill 140277.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1162,1162 density 0.6724537037037037,0.6724537037037037
before tensor 4096 mask 672.0 4096
layer1.0.conv1.weight, mask/weight parameters,672,672 density 0.22340425531914893,0.22340425531914893
before tensor 36864 mask 3777.0 36864
layer1.0.conv2.weight, mask/weight parameters,3777,3777 density 0.18998038328051908,0.18998038328051908
before tensor 16384 mask 3860.0 16384
layer1.0.conv3.weight, mask/weight parameters,3860,3860 density 0.32081117021276595,0.32081117021276595
layer1.0.shortcut.0.weight, mask/weight parameters,5576,5576 density 0.34033203125,0.34033203125
before tensor 16384 mask 2528.0 16384
layer1.1.conv1.weight, mask/weight parameters,2528,2528 density 0.21010638297872342,0.21010638297872342
before tensor 36864 mask 4119.0 36864
layer1.1.conv2.weight, mask/weight parameters,4119,4119 density 0.2071827372868568,0.2071827372868568
before tensor 16384 mask 2330.0 16384
layer1.1.conv3.weight, mask/weight parameters,2330,2330 density 0.1936502659574468,0.1936502659574468
before tensor 16384 mask 2910.0 16384
layer1.2.conv1.weight, mask/weight parameters,2910,2910 density 0.24185505319148937,0.24185505319148937
before tensor 36864 mask 3543.0 36864
layer1.2.conv2.weight, mask/weight parameters,3543,3543 density 0.17821035159197224,0.17821035159197224
before tensor 16384 mask 1934.0 16384
layer1.2.conv3.weight, mask/weight parameters,1934,1934 density 0.1607380319148936,0.1607380319148936
before tensor 32768 mask 5380.0 32768
layer2.0.conv1.weight, mask/weight parameters,5380,5380 density 0.28020833333333334,0.28020833333333334
before tensor 147456 mask 12927.0 147456
layer2.0.conv2.weight, mask/weight parameters,12927,12927 density 0.25534814814814816,0.25534814814814816
before tensor 65536 mask 7197.0 65536
layer2.0.conv3.weight, mask/weight parameters,7197,7197 density 0.187421875,0.187421875
layer2.0.shortcut.0.weight, mask/weight parameters,31213,31213 density 0.23813629150390625,0.23813629150390625
before tensor 65536 mask 3763.0 65536
layer2.1.conv1.weight, mask/weight parameters,3763,3763 density 0.09799479166666666,0.09799479166666666
before tensor 147456 mask 4259.0 147456
layer2.1.conv2.weight, mask/weight parameters,4259,4259 density 0.0841283950617284,0.0841283950617284
before tensor 65536 mask 4289.0 65536
layer2.1.conv3.weight, mask/weight parameters,4289,4289 density 0.11169270833333333,0.11169270833333333
before tensor 65536 mask 10776.0 65536
layer2.2.conv1.weight, mask/weight parameters,10776,10776 density 0.280625,0.280625
before tensor 147456 mask 21842.0 147456
layer2.2.conv2.weight, mask/weight parameters,21842,21842 density 0.4314469135802469,0.4314469135802469
before tensor 65536 mask 13425.0 65536
layer2.2.conv3.weight, mask/weight parameters,13425,13425 density 0.349609375,0.349609375
before tensor 65536 mask 11128.0 65536
layer2.3.conv1.weight, mask/weight parameters,11128,11128 density 0.28979166666666667,0.28979166666666667
before tensor 147456 mask 20714.0 147456
layer2.3.conv2.weight, mask/weight parameters,20714,20714 density 0.40916543209876544,0.40916543209876544
before tensor 65536 mask 11671.0 65536
layer2.3.conv3.weight, mask/weight parameters,11671,11671 density 0.3039322916666667,0.3039322916666667
before tensor 131072 mask 30051.0 131072
layer3.0.conv1.weight, mask/weight parameters,30051,30051 density 0.4585418701171875,0.4585418701171875
before tensor 589824 mask 65882.0 589824
layer3.0.conv2.weight, mask/weight parameters,65882,65882 density 0.4467909071180556,0.4467909071180556
before tensor 262144 mask 58294.0 262144
layer3.0.conv3.weight, mask/weight parameters,58294,58294 density 0.4447479248046875,0.4447479248046875
layer3.0.shortcut.0.weight, mask/weight parameters,102666,102666 density 0.19581985473632812,0.19581985473632812
before tensor 262144 mask 29196.0 262144
layer3.1.conv1.weight, mask/weight parameters,29196,29196 density 0.222747802734375,0.222747802734375
before tensor 589824 mask 60562.0 589824
layer3.1.conv2.weight, mask/weight parameters,60562,60562 density 0.4107123480902778,0.4107123480902778
before tensor 262144 mask 49792.0 262144
layer3.1.conv3.weight, mask/weight parameters,49792,49792 density 0.3798828125,0.3798828125
before tensor 262144 mask 30578.0 262144
layer3.2.conv1.weight, mask/weight parameters,30578,30578 density 0.2332916259765625,0.2332916259765625
before tensor 589824 mask 53850.0 589824
layer3.2.conv2.weight, mask/weight parameters,53850,53850 density 0.3651936848958333,0.3651936848958333
before tensor 262144 mask 49690.0 262144
layer3.2.conv3.weight, mask/weight parameters,49690,49690 density 0.3791046142578125,0.3791046142578125
before tensor 262144 mask 34182.0 262144
layer3.3.conv1.weight, mask/weight parameters,34182,34182 density 0.2607879638671875,0.2607879638671875
before tensor 589824 mask 47673.0 589824
layer3.3.conv2.weight, mask/weight parameters,47673,47673 density 0.32330322265625,0.32330322265625
before tensor 262144 mask 42688.0 262144
layer3.3.conv3.weight, mask/weight parameters,42688,42688 density 0.32568359375,0.32568359375
before tensor 262144 mask 37866.0 262144
layer3.4.conv1.weight, mask/weight parameters,37866,37866 density 0.2888946533203125,0.2888946533203125
before tensor 589824 mask 48439.0 589824
layer3.4.conv2.weight, mask/weight parameters,48439,48439 density 0.3284979926215278,0.3284979926215278
before tensor 262144 mask 40120.0 262144
layer3.4.conv3.weight, mask/weight parameters,40120,40120 density 0.30609130859375,0.30609130859375
before tensor 262144 mask 44104.0 262144
layer3.5.conv1.weight, mask/weight parameters,44104,44104 density 0.33648681640625,0.33648681640625
before tensor 589824 mask 48808.0 589824
layer3.5.conv2.weight, mask/weight parameters,48808,48808 density 0.3310004340277778,0.3310004340277778
before tensor 262144 mask 38812.0 262144
layer3.5.conv3.weight, mask/weight parameters,38812,38812 density 0.296112060546875,0.296112060546875
before tensor 524288 mask 132547.0 524288
layer4.0.conv1.weight, mask/weight parameters,132547,132547 density 0.5461621505801688,0.5461621505801688
before tensor 2359296 mask 200009.0 2359296
layer4.0.conv2.weight, mask/weight parameters,200009,200009 density 0.3956492410799947,0.3956492410799947
before tensor 1048576 mask 105729.0 1048576
layer4.0.conv3.weight, mask/weight parameters,105729,105729 density 0.2178290644778481,0.2178290644778481
layer4.0.shortcut.0.weight, mask/weight parameters,151385,151385 density 0.07218599319458008,0.07218599319458008
before tensor 1048576 mask 114839.0 1048576
layer4.1.conv1.weight, mask/weight parameters,114839,114839 density 0.23659801885548523,0.23659801885548523
before tensor 2359296 mask 184845.0 2359296
layer4.1.conv2.weight, mask/weight parameters,184845,184845 density 0.36565246547621166,0.36565246547621166
before tensor 1048576 mask 82977.0 1048576
layer4.1.conv3.weight, mask/weight parameters,82977,82977 density 0.1709540644778481,0.1709540644778481
before tensor 1048576 mask 77342.0 1048576
layer4.2.conv1.weight, mask/weight parameters,77342,77342 density 0.15934450817510548,0.15934450817510548
before tensor 2359296 mask 68593.0 2359296
layer4.2.conv2.weight, mask/weight parameters,68593,68593 density 0.13568773601887954,0.13568773601887954
before tensor 1048576 mask 35602.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35602,35602 density 0.07334932093881856,0.07334932093881856
classifier.weight, mask/weight parameters,107089,107089 density 0.5228955078125,0.5228955078125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.2326370890721191 0.2326370890721191 after dst
Death rate: 0.10550814114842003

dynamic sparse change grow
self.total_params*pruning_rate 2495481.930702947
self.total_nonzero 2365205.0
to grow 130276.93070294708
len(all_scores) 10166930 6813187
increse 130276.0 before_mask 2495480.0 after_mask 2495480.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1180,1162 density 0.6828703703703703,0.6724537037037037
before tensor 4096 mask 690.0 4096
layer1.0.conv1.weight, mask/weight parameters,690,672 density 0.2293882978723404,0.22340425531914893
before tensor 36864 mask 3935.0 36864
layer1.0.conv2.weight, mask/weight parameters,3935,3777 density 0.19792766963432423,0.18998038328051908
before tensor 16384 mask 3991.0 16384
layer1.0.conv3.weight, mask/weight parameters,3991,3860 density 0.33169880319148937,0.32081117021276595
layer1.0.shortcut.0.weight, mask/weight parameters,5766,5576 density 0.3519287109375,0.34033203125
before tensor 16384 mask 2626.0 16384
layer1.1.conv1.weight, mask/weight parameters,2626,2528 density 0.21825132978723405,0.21010638297872342
before tensor 36864 mask 4175.0 36864
layer1.1.conv2.weight, mask/weight parameters,4175,4119 density 0.2099994970071928,0.2071827372868568
before tensor 16384 mask 2423.0 16384
layer1.1.conv3.weight, mask/weight parameters,2423,2330 density 0.20137965425531915,0.1936502659574468
before tensor 16384 mask 3082.0 16384
layer1.2.conv1.weight, mask/weight parameters,3082,2910 density 0.25615026595744683,0.24185505319148937
before tensor 36864 mask 3629.0 36864
layer1.2.conv2.weight, mask/weight parameters,3629,3543 density 0.1825360897339168,0.17821035159197224
before tensor 16384 mask 1986.0 16384
layer1.2.conv3.weight, mask/weight parameters,1986,1934 density 0.16505984042553193,0.1607380319148936
before tensor 32768 mask 5596.0 32768
layer2.0.conv1.weight, mask/weight parameters,5596,5380 density 0.2914583333333333,0.28020833333333334
before tensor 147456 mask 13196.0 147456
layer2.0.conv2.weight, mask/weight parameters,13196,12927 density 0.26066172839506174,0.25534814814814816
before tensor 65536 mask 7376.0 65536
layer2.0.conv3.weight, mask/weight parameters,7376,7197 density 0.19208333333333333,0.187421875
layer2.0.shortcut.0.weight, mask/weight parameters,32076,31213 density 0.244720458984375,0.23813629150390625
before tensor 65536 mask 4112.0 65536
layer2.1.conv1.weight, mask/weight parameters,4112,3763 density 0.10708333333333334,0.09799479166666666
before tensor 147456 mask 4343.0 147456
layer2.1.conv2.weight, mask/weight parameters,4343,4259 density 0.08578765432098766,0.0841283950617284
before tensor 65536 mask 4380.0 65536
layer2.1.conv3.weight, mask/weight parameters,4380,4289 density 0.1140625,0.11169270833333333
before tensor 65536 mask 11164.0 65536
layer2.2.conv1.weight, mask/weight parameters,11164,10776 density 0.29072916666666665,0.280625
before tensor 147456 mask 22402.0 147456
layer2.2.conv2.weight, mask/weight parameters,22402,21842 density 0.44250864197530865,0.4314469135802469
before tensor 65536 mask 13975.0 65536
layer2.2.conv3.weight, mask/weight parameters,13975,13425 density 0.3639322916666667,0.349609375
before tensor 65536 mask 11424.0 65536
layer2.3.conv1.weight, mask/weight parameters,11424,11128 density 0.2975,0.28979166666666667
before tensor 147456 mask 21324.0 147456
layer2.3.conv2.weight, mask/weight parameters,21324,20714 density 0.4212148148148148,0.40916543209876544
before tensor 65536 mask 11994.0 65536
layer2.3.conv3.weight, mask/weight parameters,11994,11671 density 0.31234375,0.3039322916666667
before tensor 131072 mask 31179.0 131072
layer3.0.conv1.weight, mask/weight parameters,31179,30051 density 0.4757537841796875,0.4585418701171875
before tensor 589824 mask 68470.0 589824
layer3.0.conv2.weight, mask/weight parameters,68470,65882 density 0.4643419053819444,0.4467909071180556
before tensor 262144 mask 60846.0 262144
layer3.0.conv3.weight, mask/weight parameters,60846,58294 density 0.4642181396484375,0.4447479248046875
layer3.0.shortcut.0.weight, mask/weight parameters,106242,102666 density 0.20264053344726562,0.19581985473632812
before tensor 262144 mask 30742.0 262144
layer3.1.conv1.weight, mask/weight parameters,30742,29196 density 0.2345428466796875,0.222747802734375
before tensor 589824 mask 63879.0 589824
layer3.1.conv2.weight, mask/weight parameters,63879,60562 density 0.4332071940104167,0.4107123480902778
before tensor 262144 mask 53005.0 262144
layer3.1.conv3.weight, mask/weight parameters,53005,49792 density 0.40439605712890625,0.3798828125
before tensor 262144 mask 32901.0 262144
layer3.2.conv1.weight, mask/weight parameters,32901,30578 density 0.25101470947265625,0.2332916259765625
before tensor 589824 mask 57500.0 589824
layer3.2.conv2.weight, mask/weight parameters,57500,53850 density 0.3899468315972222,0.3651936848958333
before tensor 262144 mask 52439.0 262144
layer3.2.conv3.weight, mask/weight parameters,52439,49690 density 0.40007781982421875,0.3791046142578125
before tensor 262144 mask 36028.0 262144
layer3.3.conv1.weight, mask/weight parameters,36028,34182 density 0.274871826171875,0.2607879638671875
before tensor 589824 mask 50303.0 589824
layer3.3.conv2.weight, mask/weight parameters,50303,47673 density 0.3411390516493056,0.32330322265625
before tensor 262144 mask 45027.0 262144
layer3.3.conv3.weight, mask/weight parameters,45027,42688 density 0.34352874755859375,0.32568359375
before tensor 262144 mask 41095.0 262144
layer3.4.conv1.weight, mask/weight parameters,41095,37866 density 0.31352996826171875,0.2888946533203125
before tensor 589824 mask 52072.0 589824
layer3.4.conv2.weight, mask/weight parameters,52072,48439 density 0.3531358506944444,0.3284979926215278
before tensor 262144 mask 42706.0 262144
layer3.4.conv3.weight, mask/weight parameters,42706,40120 density 0.3258209228515625,0.30609130859375
before tensor 262144 mask 46902.0 262144
layer3.5.conv1.weight, mask/weight parameters,46902,44104 density 0.3578338623046875,0.33648681640625
before tensor 589824 mask 51923.0 589824
layer3.5.conv2.weight, mask/weight parameters,51923,48808 density 0.3521253797743056,0.3310004340277778
before tensor 262144 mask 40985.0 262144
layer3.5.conv3.weight, mask/weight parameters,40985,38812 density 0.31269073486328125,0.296112060546875
before tensor 524288 mask 139434.0 524288
layer4.0.conv1.weight, mask/weight parameters,139434,132547 density 0.5745401503164557,0.5461621505801688
before tensor 2359296 mask 212187.0 2359296
layer4.0.conv2.weight, mask/weight parameters,212187,200009 density 0.4197392393194348,0.3956492410799947
before tensor 1048576 mask 111554.0 1048576
layer4.0.conv3.weight, mask/weight parameters,111554,105729 density 0.22983006988396623,0.2178290644778481
layer4.0.shortcut.0.weight, mask/weight parameters,156549,151385 density 0.07464838027954102,0.07218599319458008
before tensor 1048576 mask 123346.0 1048576
layer4.1.conv1.weight, mask/weight parameters,123346,114839 density 0.25412463739451474,0.23659801885548523
before tensor 2359296 mask 198267.0 2359296
layer4.1.conv2.weight, mask/weight parameters,198267,184845 density 0.39220329125792996,0.36565246547621166
before tensor 1048576 mask 88316.0 1048576
layer4.1.conv3.weight, mask/weight parameters,88316,82977 density 0.18195378428270043,0.1709540644778481
before tensor 1048576 mask 84036.0 1048576
layer4.2.conv1.weight, mask/weight parameters,84036,77342 density 0.17313587816455697,0.15934450817510548
before tensor 2359296 mask 74991.0 2359296
layer4.2.conv2.weight, mask/weight parameters,74991,68593 density 0.14834398570979246,0.13568773601887954
before tensor 1048576 mask 37978.0 1048576
layer4.2.conv3.weight, mask/weight parameters,37978,35602 density 0.07824449498945148,0.07334932093881856
classifier.weight, mask/weight parameters,107733,107089 density 0.5260400390625,0.5228955078125
Total Model parameters after dst: 2495480 2365205
Total parameters under density level of 0.1: 0.2454506916050371 0.2326370890721191 after dst
Death rate: 0.10550814114842003


Training summary: Average loss: 0.3758, Accuracy: 44124/50000 (88.248%)


Evaluation: Average loss: 1.0926, Accuracy: 7196/10000 (71.960%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.71 seconds.

Train Epoch: 102 [0/50000 (0%)]	Loss: 0.292973 Accuracy: 92/100 (92.000%
Train Epoch: 102 [10000/50000 (20%)]	Loss: 0.333508 Accuracy: 9003/10100 (89.139%
Train Epoch: 102 [20000/50000 (40%)]	Loss: 0.416894 Accuracy: 17919/20100 (89.149%
Train Epoch: 102 [30000/50000 (60%)]	Loss: 0.355812 Accuracy: 26804/30100 (89.050%
Train Epoch: 102 [40000/50000 (80%)]	Loss: 0.310273 Accuracy: 35667/40100 (88.945%
current layer rate 0.49552048247610375
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3840.0
Total filter_masks items: 7191506.0
3840.0 / 7552 channels
Total channels to prune: 30.170683659534916
Layer ('layer3', 0, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 0, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 1, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 1, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 2, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 2, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 3, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 3, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 4, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 4, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 5, 'conv1'): Pruned 1/128.0 channels based on HE
Layer ('layer3', 5, 'conv2'): Pruned 1/128.0 channels based on HE
Layer ('layer4', 0, 'conv1'): Pruned 1/237.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/237.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/237.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/237.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/237.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/237.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3822.0
Total filter_masks items: 7141925.0
After apply_mask:
Total filter_names items: 3822.0
Total filter_masks items: 7141925.0
Total pruned: 18/30.170683659534916 channels
===========done ===============

Training summary: Average loss: 0.3641, Accuracy: 44340/50000 (88.680%)


Evaluation: Average loss: 1.0761, Accuracy: 7222/10000 (72.220%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.55 seconds.

Train Epoch: 103 [0/50000 (0%)]	Loss: 0.265984 Accuracy: 94/100 (94.000%
Train Epoch: 103 [10000/50000 (20%)]	Loss: 0.293514 Accuracy: 9119/10100 (90.287%
Train Epoch: 103 [20000/50000 (40%)]	Loss: 0.347126 Accuracy: 18029/20100 (89.697%
Train Epoch: 103 [30000/50000 (60%)]	Loss: 0.388032 Accuracy: 26876/30100 (89.289%
Train Epoch: 103 [40000/50000 (80%)]	Loss: 0.339734 Accuracy: 35672/40100 (88.958%
current mest  death_rate 0.10477457514062674


dynamic sparse change prune
to kill 112639.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1164,1164 density 0.6736111111111112,0.6736111111111112
before tensor 4096 mask 668.0 4096
layer1.0.conv1.weight, mask/weight parameters,668,668 density 0.2220744680851064,0.2220744680851064
before tensor 36864 mask 3812.0 36864
layer1.0.conv2.weight, mask/weight parameters,3812,3812 density 0.19174085810572908,0.19174085810572908
before tensor 16384 mask 3871.0 16384
layer1.0.conv3.weight, mask/weight parameters,3871,3871 density 0.3217253989361702,0.3217253989361702
layer1.0.shortcut.0.weight, mask/weight parameters,5578,5578 density 0.3404541015625,0.3404541015625
before tensor 16384 mask 2534.0 16384
layer1.1.conv1.weight, mask/weight parameters,2534,2534 density 0.21060505319148937,0.21060505319148937
before tensor 36864 mask 4097.0 36864
layer1.1.conv2.weight, mask/weight parameters,4097,4097 density 0.20607615311101052,0.20607615311101052
before tensor 16384 mask 2349.0 16384
layer1.1.conv3.weight, mask/weight parameters,2349,2349 density 0.19522938829787234,0.19522938829787234
before tensor 16384 mask 2948.0 16384
layer1.2.conv1.weight, mask/weight parameters,2948,2948 density 0.2450132978723404,0.2450132978723404
before tensor 36864 mask 3547.0 36864
layer1.2.conv2.weight, mask/weight parameters,3547,3547 density 0.17841154871485337,0.17841154871485337
before tensor 16384 mask 1921.0 16384
layer1.2.conv3.weight, mask/weight parameters,1921,1921 density 0.15965757978723405,0.15965757978723405
before tensor 32768 mask 5405.0 32768
layer2.0.conv1.weight, mask/weight parameters,5405,5405 density 0.28151041666666665,0.28151041666666665
before tensor 147456 mask 12877.0 147456
layer2.0.conv2.weight, mask/weight parameters,12877,12877 density 0.25436049382716047,0.25436049382716047
before tensor 65536 mask 7158.0 65536
layer2.0.conv3.weight, mask/weight parameters,7158,7158 density 0.18640625,0.18640625
layer2.0.shortcut.0.weight, mask/weight parameters,30968,30968 density 0.23626708984375,0.23626708984375
before tensor 65536 mask 3878.0 65536
layer2.1.conv1.weight, mask/weight parameters,3878,3878 density 0.10098958333333333,0.10098958333333333
before tensor 147456 mask 4231.0 147456
layer2.1.conv2.weight, mask/weight parameters,4231,4231 density 0.08357530864197531,0.08357530864197531
before tensor 65536 mask 4280.0 65536
layer2.1.conv3.weight, mask/weight parameters,4280,4280 density 0.11145833333333334,0.11145833333333334
before tensor 65536 mask 10798.0 65536
layer2.2.conv1.weight, mask/weight parameters,10798,10798 density 0.28119791666666666,0.28119791666666666
before tensor 147456 mask 21685.0 147456
layer2.2.conv2.weight, mask/weight parameters,21685,21685 density 0.42834567901234566,0.42834567901234566
before tensor 65536 mask 13423.0 65536
layer2.2.conv3.weight, mask/weight parameters,13423,13423 density 0.34955729166666666,0.34955729166666666
before tensor 65536 mask 11002.0 65536
layer2.3.conv1.weight, mask/weight parameters,11002,11002 density 0.28651041666666666,0.28651041666666666
before tensor 147456 mask 20674.0 147456
layer2.3.conv2.weight, mask/weight parameters,20674,20674 density 0.4083753086419753,0.4083753086419753
before tensor 65536 mask 11604.0 65536
layer2.3.conv3.weight, mask/weight parameters,11604,11604 density 0.3021875,0.3021875
before tensor 131072 mask 29729.0 131072
layer3.0.conv1.weight, mask/weight parameters,29729,29729 density 0.45720041830708663,0.45720041830708663
before tensor 589824 mask 64514.0 589824
layer3.0.conv2.weight, mask/weight parameters,64514,64514 density 0.44443066663911107,0.44443066663911107
before tensor 262144 mask 57883.0 262144
layer3.0.conv3.weight, mask/weight parameters,57883,57883 density 0.4450895054133858,0.4450895054133858
layer3.0.shortcut.0.weight, mask/weight parameters,102219,102219 density 0.19496726989746094,0.19496726989746094
before tensor 262144 mask 28940.0 262144
layer3.1.conv1.weight, mask/weight parameters,28940,28940 density 0.222533218503937,0.222533218503937
before tensor 589824 mask 59582.0 589824
layer3.1.conv2.weight, mask/weight parameters,59582,59582 density 0.41045459868697515,0.41045459868697515
before tensor 262144 mask 50111.0 262144
layer3.1.conv3.weight, mask/weight parameters,50111,50111 density 0.3853269562007874,0.3853269562007874
before tensor 262144 mask 30914.0 262144
layer3.2.conv1.weight, mask/weight parameters,30914,30914 density 0.23771222933070865,0.23771222933070865
before tensor 589824 mask 53673.0 589824
layer3.2.conv2.weight, mask/weight parameters,53673,53673 density 0.36974807282947897,0.36974807282947897
before tensor 262144 mask 49669.0 262144
layer3.2.conv3.weight, mask/weight parameters,49669,49669 density 0.3819282111220472,0.3819282111220472
before tensor 262144 mask 34114.0 262144
layer3.3.conv1.weight, mask/weight parameters,34114,34114 density 0.26231852854330706,0.26231852854330706
before tensor 589824 mask 47172.0 589824
layer3.3.conv2.weight, mask/weight parameters,47172,47172 density 0.32496331659329986,0.32496331659329986
before tensor 262144 mask 42597.0 262144
layer3.3.conv3.weight, mask/weight parameters,42597,42597 density 0.32754828986220474,0.32754828986220474
before tensor 262144 mask 38372.0 262144
layer3.4.conv1.weight, mask/weight parameters,38372,38372 density 0.2950602854330709,0.2950602854330709
before tensor 589824 mask 48410.0 589824
layer3.4.conv2.weight, mask/weight parameters,48410,48410 density 0.3334917780946673,0.3334917780946673
before tensor 262144 mask 40265.0 262144
layer3.4.conv3.weight, mask/weight parameters,40265,40265 density 0.3096164493110236,0.3096164493110236
before tensor 262144 mask 44556.0 262144
layer3.5.conv1.weight, mask/weight parameters,44556,44556 density 0.3426119586614173,0.3426119586614173
before tensor 589824 mask 48774.0 589824
layer3.5.conv2.weight, mask/weight parameters,48774,48774 density 0.335999338665344,0.335999338665344
before tensor 262144 mask 38646.0 262144
layer3.5.conv3.weight, mask/weight parameters,38646,38646 density 0.2971671998031496,0.2971671998031496
before tensor 524288 mask 133228.0 524288
layer4.0.conv1.weight, mask/weight parameters,133228,133228 density 0.5512943591101694,0.5512943591101694
before tensor 2359296 mask 200208.0 2359296
layer4.0.conv2.weight, mask/weight parameters,200208,200208 density 0.3994063008713971,0.3994063008713971
before tensor 1048576 mask 105848.0 1048576
layer4.0.conv3.weight, mask/weight parameters,105848,105848 density 0.2189982786016949,0.2189982786016949
layer4.0.shortcut.0.weight, mask/weight parameters,149915,149915 density 0.07148504257202148,0.07148504257202148
before tensor 1048576 mask 115747.0 1048576
layer4.1.conv1.weight, mask/weight parameters,115747,115747 density 0.23947919425317796,0.23947919425317796
before tensor 2359296 mask 186298.0 2359296
layer4.1.conv2.weight, mask/weight parameters,186298,186298 density 0.3716564524881101,0.3716564524881101
before tensor 1048576 mask 83623.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83623,83623 density 0.17301501257944915,0.17301501257944915
before tensor 1048576 mask 77814.0 1048576
layer4.2.conv1.weight, mask/weight parameters,77814,77814 density 0.1609962592690678,0.1609962592690678
before tensor 2359296 mask 68984.0 2359296
layer4.2.conv2.weight, mask/weight parameters,68984,68984 density 0.13762009639631012,0.13762009639631012
before tensor 1048576 mask 35873.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35873,35873 density 0.07422081898834745,0.07422081898834745
classifier.weight, mask/weight parameters,107055,107055 density 0.5227294921875,0.5227294921875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.23377714853960263 0.23377714853960263 after dst
Death rate: 0.10477457514062674

dynamic sparse change grow
self.total_params*pruning_rate 2478131.6040125084
self.total_nonzero 2365205.0
to grow 112926.60401250841
len(all_scores) 10117349 6764891
increse 112926.0 before_mask 2478130.0 after_mask 2478130.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1192,1164 density 0.6898148148148148,0.6736111111111112
before tensor 4096 mask 684.0 4096
layer1.0.conv1.weight, mask/weight parameters,684,668 density 0.22739361702127658,0.2220744680851064
before tensor 36864 mask 3960.0 36864
layer1.0.conv2.weight, mask/weight parameters,3960,3812 density 0.19918515165233136,0.19174085810572908
before tensor 16384 mask 4040.0 16384
layer1.0.conv3.weight, mask/weight parameters,4040,3871 density 0.3357712765957447,0.3217253989361702
layer1.0.shortcut.0.weight, mask/weight parameters,5738,5578 density 0.3502197265625,0.3404541015625
before tensor 16384 mask 2620.0 16384
layer1.1.conv1.weight, mask/weight parameters,2620,2534 density 0.21775265957446807,0.21060505319148937
before tensor 36864 mask 4215.0 36864
layer1.1.conv2.weight, mask/weight parameters,4215,4097 density 0.21201146823600422,0.20607615311101052
before tensor 16384 mask 2439.0 16384
layer1.1.conv3.weight, mask/weight parameters,2439,2349 density 0.2027094414893617,0.19522938829787234
before tensor 16384 mask 3040.0 16384
layer1.2.conv1.weight, mask/weight parameters,3040,2948 density 0.2526595744680851,0.2450132978723404
before tensor 36864 mask 3662.0 36864
layer1.2.conv2.weight, mask/weight parameters,3662,3547 density 0.18419596599768623,0.17841154871485337
before tensor 16384 mask 1996.0 16384
layer1.2.conv3.weight, mask/weight parameters,1996,1921 density 0.1658909574468085,0.15965757978723405
before tensor 32768 mask 5636.0 32768
layer2.0.conv1.weight, mask/weight parameters,5636,5405 density 0.29354166666666665,0.28151041666666665
before tensor 147456 mask 13133.0 147456
layer2.0.conv2.weight, mask/weight parameters,13133,12877 density 0.2594172839506173,0.25436049382716047
before tensor 65536 mask 7332.0 65536
layer2.0.conv3.weight, mask/weight parameters,7332,7158 density 0.1909375,0.18640625
layer2.0.shortcut.0.weight, mask/weight parameters,31824,30968 density 0.2427978515625,0.23626708984375
before tensor 65536 mask 4117.0 65536
layer2.1.conv1.weight, mask/weight parameters,4117,3878 density 0.10721354166666666,0.10098958333333333
before tensor 147456 mask 4369.0 147456
layer2.1.conv2.weight, mask/weight parameters,4369,4231 density 0.08630123456790123,0.08357530864197531
before tensor 65536 mask 4330.0 65536
layer2.1.conv3.weight, mask/weight parameters,4330,4280 density 0.11276041666666667,0.11145833333333334
before tensor 65536 mask 11154.0 65536
layer2.2.conv1.weight, mask/weight parameters,11154,10798 density 0.29046875,0.28119791666666666
before tensor 147456 mask 22456.0 147456
layer2.2.conv2.weight, mask/weight parameters,22456,21685 density 0.4435753086419753,0.42834567901234566
before tensor 65536 mask 13882.0 65536
layer2.2.conv3.weight, mask/weight parameters,13882,13423 density 0.36151041666666667,0.34955729166666666
before tensor 65536 mask 11357.0 65536
layer2.3.conv1.weight, mask/weight parameters,11357,11002 density 0.29575520833333335,0.28651041666666666
before tensor 147456 mask 21348.0 147456
layer2.3.conv2.weight, mask/weight parameters,21348,20674 density 0.4216888888888889,0.4083753086419753
before tensor 65536 mask 11968.0 65536
layer2.3.conv3.weight, mask/weight parameters,11968,11604 density 0.31166666666666665,0.3021875
before tensor 131072 mask 30761.0 131072
layer3.0.conv1.weight, mask/weight parameters,30761,29729 density 0.4730714812992126,0.45720041830708663
before tensor 589824 mask 66966.0 589824
layer3.0.conv2.weight, mask/weight parameters,66966,64514 density 0.46132225597784526,0.44443066663911107
before tensor 262144 mask 60285.0 262144
layer3.0.conv3.weight, mask/weight parameters,60285,57883 density 0.46355960875984253,0.4450895054133858
layer3.0.shortcut.0.weight, mask/weight parameters,105005,102219 density 0.20028114318847656,0.19496726989746094
before tensor 262144 mask 29938.0 262144
layer3.1.conv1.weight, mask/weight parameters,29938,28940 density 0.23020730807086615,0.222533218503937
before tensor 589824 mask 63039.0 589824
layer3.1.conv2.weight, mask/weight parameters,63039,59582 density 0.4342695352057371,0.41045459868697515
before tensor 262144 mask 52771.0 262144
layer3.1.conv3.weight, mask/weight parameters,52771,50111 density 0.40578094242125984,0.3853269562007874
before tensor 262144 mask 32439.0 262144
layer3.2.conv1.weight, mask/weight parameters,32439,30914 density 0.2494386687992126,0.23771222933070865
before tensor 589824 mask 56355.0 589824
layer3.2.conv2.weight, mask/weight parameters,56355,53673 density 0.3882241097815529,0.36974807282947897
before tensor 262144 mask 51859.0 262144
layer3.2.conv3.weight, mask/weight parameters,51859,49669 density 0.39876814714566927,0.3819282111220472
before tensor 262144 mask 35947.0 262144
layer3.3.conv1.weight, mask/weight parameters,35947,34114 density 0.2764133243110236,0.26231852854330706
before tensor 589824 mask 50131.0 589824
layer3.3.conv2.weight, mask/weight parameters,50131,47172 density 0.34534757958404805,0.32496331659329986
before tensor 262144 mask 45050.0 262144
layer3.3.conv3.weight, mask/weight parameters,45050,42597 density 0.3464105561023622,0.32754828986220474
before tensor 262144 mask 40443.0 262144
layer3.4.conv1.weight, mask/weight parameters,40443,38372 density 0.3109851747047244,0.2950602854330709
before tensor 589824 mask 50605.0 589824
layer3.4.conv2.weight, mask/weight parameters,50605,48410 density 0.3486129194480611,0.3334917780946673
before tensor 262144 mask 42269.0 262144
layer3.4.conv3.weight, mask/weight parameters,42269,40265 density 0.32502614419291337,0.3096164493110236
before tensor 262144 mask 47028.0 262144
layer3.5.conv1.weight, mask/weight parameters,47028,44556 density 0.3616203248031496,0.3426119586614173
before tensor 589824 mask 50983.0 589824
layer3.5.conv2.weight, mask/weight parameters,50983,48774 density 0.3512169246560715,0.335999338665344
before tensor 262144 mask 40778.0 262144
layer3.5.conv3.weight, mask/weight parameters,40778,38646 density 0.3135611466535433,0.2971671998031496
before tensor 524288 mask 139578.0 524288
layer4.0.conv1.weight, mask/weight parameters,139578,133228 density 0.5775705111228814,0.5512943591101694
before tensor 2359296 mask 209522.0 2359296
layer4.0.conv2.weight, mask/weight parameters,209522,200208 density 0.4179873280347282,0.3994063008713971
before tensor 1048576 mask 110917.0 1048576
layer4.0.conv3.weight, mask/weight parameters,110917,105848 density 0.22948598053495764,0.2189982786016949
layer4.0.shortcut.0.weight, mask/weight parameters,154748,149915 density 0.07378959655761719,0.07148504257202148
before tensor 1048576 mask 123302.0 1048576
layer4.1.conv1.weight, mask/weight parameters,123302,115747 density 0.2551104012182203,0.23947919425317796
before tensor 2359296 mask 197979.0 2359296
layer4.1.conv2.weight, mask/weight parameters,197979,186298 density 0.39495954227712343,0.3716564524881101
before tensor 1048576 mask 88896.0 1048576
layer4.1.conv3.weight, mask/weight parameters,88896,83623 density 0.1839247881355932,0.17301501257944915
before tensor 1048576 mask 83420.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83420,77814 density 0.17259500794491525,0.1609962592690678
before tensor 2359296 mask 74379.0 2359296
layer4.2.conv2.weight, mask/weight parameters,74379,68984 density 0.1483828880589869,0.13762009639631012
before tensor 1048576 mask 38243.0 1048576
layer4.2.conv3.weight, mask/weight parameters,38243,35873 density 0.07912432137182203,0.07422081898834745
classifier.weight, mask/weight parameters,108002,107055 density 0.527353515625,0.5227294921875
Total Model parameters after dst: 2478130 2365205
Total parameters under density level of 0.1: 0.24493866921067958 0.23377714853960263 after dst
Death rate: 0.10477457514062674


Training summary: Average loss: 0.3679, Accuracy: 44319/50000 (88.638%)


Evaluation: Average loss: 1.0927, Accuracy: 7149/10000 (71.490%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.74 seconds.

Train Epoch: 104 [0/50000 (0%)]	Loss: 0.474840 Accuracy: 87/100 (87.000%
Train Epoch: 104 [10000/50000 (20%)]	Loss: 0.349673 Accuracy: 9049/10100 (89.594%
Train Epoch: 104 [20000/50000 (40%)]	Loss: 0.305612 Accuracy: 17896/20100 (89.035%
Train Epoch: 104 [30000/50000 (60%)]	Loss: 0.430760 Accuracy: 26753/30100 (88.880%
Train Epoch: 104 [40000/50000 (80%)]	Loss: 0.322443 Accuracy: 35615/40100 (88.815%
current layer rate 0.49644401456531634
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3822.0
Total filter_masks items: 7141925.0
3822.0 / 7552 channels
Total channels to prune: 19.145197997269406
Layer ('layer4', 0, 'conv1'): Pruned 1/236.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/236.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/236.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/236.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/236.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/236.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3816.0
Total filter_masks items: 7117944.0
After apply_mask:
Total filter_names items: 3816.0
Total filter_masks items: 7117944.0
Total pruned: 6/19.145197997269406 channels
===========done ===============

Training summary: Average loss: 0.3696, Accuracy: 44265/50000 (88.530%)


Evaluation: Average loss: 1.1024, Accuracy: 7164/10000 (71.640%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.53 seconds.

Train Epoch: 105 [0/50000 (0%)]	Loss: 0.393918 Accuracy: 87/100 (87.000%
Train Epoch: 105 [10000/50000 (20%)]	Loss: 0.304589 Accuracy: 9038/10100 (89.485%
Train Epoch: 105 [20000/50000 (40%)]	Loss: 0.293682 Accuracy: 17911/20100 (89.109%
Train Epoch: 105 [30000/50000 (60%)]	Loss: 0.430249 Accuracy: 26777/30100 (88.960%
Train Epoch: 105 [40000/50000 (80%)]	Loss: 0.446226 Accuracy: 35568/40100 (88.698%
current mest  death_rate 0.10408824654974473


dynamic sparse change prune
to kill 105292.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1172,1172 density 0.6782407407407407,0.6782407407407407
before tensor 4096 mask 662.0 4096
layer1.0.conv1.weight, mask/weight parameters,662,662 density 0.22007978723404256,0.22007978723404256
before tensor 36864 mask 3837.0 36864
layer1.0.conv2.weight, mask/weight parameters,3837,3837 density 0.19299834012373623,0.19299834012373623
before tensor 16384 mask 3928.0 16384
layer1.0.conv3.weight, mask/weight parameters,3928,3928 density 0.32646276595744683,0.32646276595744683
layer1.0.shortcut.0.weight, mask/weight parameters,5565,5565 density 0.33966064453125,0.33966064453125
before tensor 16384 mask 2517.0 16384
layer1.1.conv1.weight, mask/weight parameters,2517,2517 density 0.20919215425531915,0.20919215425531915
before tensor 36864 mask 4124.0 36864
layer1.1.conv2.weight, mask/weight parameters,4124,4124 density 0.20743423369045821,0.20743423369045821
before tensor 16384 mask 2331.0 16384
layer1.1.conv3.weight, mask/weight parameters,2331,2331 density 0.19373337765957446,0.19373337765957446
before tensor 16384 mask 2907.0 16384
layer1.2.conv1.weight, mask/weight parameters,2907,2907 density 0.2416057180851064,0.2416057180851064
before tensor 36864 mask 3579.0 36864
layer1.2.conv2.weight, mask/weight parameters,3579,3579 density 0.18002112569790252,0.18002112569790252
before tensor 16384 mask 1928.0 16384
layer1.2.conv3.weight, mask/weight parameters,1928,1928 density 0.16023936170212766,0.16023936170212766
before tensor 32768 mask 5417.0 32768
layer2.0.conv1.weight, mask/weight parameters,5417,5417 density 0.2821354166666667,0.2821354166666667
before tensor 147456 mask 12853.0 147456
layer2.0.conv2.weight, mask/weight parameters,12853,12853 density 0.2538864197530864,0.2538864197530864
before tensor 65536 mask 7111.0 65536
layer2.0.conv3.weight, mask/weight parameters,7111,7111 density 0.18518229166666667,0.18518229166666667
layer2.0.shortcut.0.weight, mask/weight parameters,30778,30778 density 0.2348175048828125,0.2348175048828125
before tensor 65536 mask 3892.0 65536
layer2.1.conv1.weight, mask/weight parameters,3892,3892 density 0.10135416666666666,0.10135416666666666
before tensor 147456 mask 4265.0 147456
layer2.1.conv2.weight, mask/weight parameters,4265,4265 density 0.08424691358024691,0.08424691358024691
before tensor 65536 mask 4250.0 65536
layer2.1.conv3.weight, mask/weight parameters,4250,4250 density 0.11067708333333333,0.11067708333333333
before tensor 65536 mask 10804.0 65536
layer2.2.conv1.weight, mask/weight parameters,10804,10804 density 0.2813541666666667,0.2813541666666667
before tensor 147456 mask 21691.0 147456
layer2.2.conv2.weight, mask/weight parameters,21691,21691 density 0.4284641975308642,0.4284641975308642
before tensor 65536 mask 13377.0 65536
layer2.2.conv3.weight, mask/weight parameters,13377,13377 density 0.348359375,0.348359375
before tensor 65536 mask 10941.0 65536
layer2.3.conv1.weight, mask/weight parameters,10941,10941 density 0.284921875,0.284921875
before tensor 147456 mask 20709.0 147456
layer2.3.conv2.weight, mask/weight parameters,20709,20709 density 0.4090666666666667,0.4090666666666667
before tensor 65536 mask 11566.0 65536
layer2.3.conv3.weight, mask/weight parameters,11566,11566 density 0.3011979166666667,0.3011979166666667
before tensor 131072 mask 29587.0 131072
layer3.0.conv1.weight, mask/weight parameters,29587,29587 density 0.4550166092519685,0.4550166092519685
before tensor 589824 mask 64455.0 589824
layer3.0.conv2.weight, mask/weight parameters,64455,64455 density 0.4440242213817761,0.4440242213817761
before tensor 262144 mask 58032.0 262144
layer3.0.conv3.weight, mask/weight parameters,58032,58032 density 0.44623523622047245,0.44623523622047245
layer3.0.shortcut.0.weight, mask/weight parameters,101216,101216 density 0.19305419921875,0.19305419921875
before tensor 262144 mask 28658.0 262144
layer3.1.conv1.weight, mask/weight parameters,28658,28658 density 0.22036478838582677,0.22036478838582677
before tensor 589824 mask 60133.0 589824
layer3.1.conv2.weight, mask/weight parameters,60133,60133 density 0.4142503840563237,0.4142503840563237
before tensor 262144 mask 50507.0 262144
layer3.1.conv3.weight, mask/weight parameters,50507,50507 density 0.38837198572834647,0.38837198572834647
before tensor 262144 mask 30856.0 262144
layer3.2.conv1.weight, mask/weight parameters,30856,30856 density 0.23726624015748032,0.23726624015748032
before tensor 589824 mask 53817.0 589824
layer3.2.conv2.weight, mask/weight parameters,53817,53817 density 0.370740074813483,0.370740074813483
before tensor 262144 mask 49745.0 262144
layer3.2.conv3.weight, mask/weight parameters,49745,49745 density 0.38251261072834647,0.38251261072834647
before tensor 262144 mask 34222.0 262144
layer3.3.conv1.weight, mask/weight parameters,34222,34222 density 0.2631489911417323,0.2631489911417323
before tensor 589824 mask 47722.0 589824
layer3.3.conv2.weight, mask/weight parameters,47722,47722 density 0.3287522130599817,0.3287522130599817
before tensor 262144 mask 43039.0 262144
layer3.3.conv3.weight, mask/weight parameters,43039,43039 density 0.3309470349409449,0.3309470349409449
before tensor 262144 mask 38413.0 262144
layer3.4.conv1.weight, mask/weight parameters,38413,38413 density 0.2953755536417323,0.2953755536417323
before tensor 589824 mask 48362.0 589824
layer3.4.conv2.weight, mask/weight parameters,48362,48362 density 0.333161110766666,0.333161110766666
before tensor 262144 mask 40411.0 262144
layer3.4.conv3.weight, mask/weight parameters,40411,40411 density 0.31073911171259844,0.31073911171259844
before tensor 262144 mask 44906.0 262144
layer3.5.conv1.weight, mask/weight parameters,44906,44906 density 0.34530327263779526,0.34530327263779526
before tensor 589824 mask 48774.0 589824
layer3.5.conv2.weight, mask/weight parameters,48774,48774 density 0.335999338665344,0.335999338665344
before tensor 262144 mask 39036.0 262144
layer3.5.conv3.weight, mask/weight parameters,39036,39036 density 0.300166092519685,0.300166092519685
before tensor 524288 mask 133744.0 524288
layer4.0.conv1.weight, mask/weight parameters,133744,133744 density 0.5557845744680852,0.5557845744680852
before tensor 2359296 mask 198549.0 2359296
layer4.0.conv2.weight, mask/weight parameters,198549,198549 density 0.39947487550928024,0.39947487550928024
before tensor 1048576 mask 105387.0 1048576
layer4.0.conv3.weight, mask/weight parameters,105387,105387 density 0.21897232380319148,0.21897232380319148
layer4.0.shortcut.0.weight, mask/weight parameters,148252,148252 density 0.07069206237792969,0.07069206237792969
before tensor 1048576 mask 116378.0 1048576
layer4.1.conv1.weight, mask/weight parameters,116378,116378 density 0.24180934175531915,0.24180934175531915
before tensor 2359296 mask 186662.0 2359296
layer4.1.conv2.weight, mask/weight parameters,186662,186662 density 0.3755585735123988,0.3755585735123988
before tensor 1048576 mask 84232.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84232,84232 density 0.17501662234042553,0.17501662234042553
before tensor 1048576 mask 77888.0 1048576
layer4.2.conv1.weight, mask/weight parameters,77888,77888 density 0.1618351063829787,0.1618351063829787
before tensor 2359296 mask 68821.0 2359296
layer4.2.conv2.weight, mask/weight parameters,68821,68821 density 0.13846587193803128,0.13846587193803128
before tensor 1048576 mask 36081.0 1048576
layer4.2.conv3.weight, mask/weight parameters,36081,36081 density 0.07496883311170213,0.07496883311170213
classifier.weight, mask/weight parameters,107116,107116 density 0.52302734375,0.52302734375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.2343325835340592 0.2343325835340592 after dst
Death rate: 0.10408824654974473

dynamic sparse change grow
self.total_params*pruning_rate 2461898.538218452
self.total_nonzero 2365205.0
to grow 96693.53821845213
len(all_scores) 10093368 6742424
increse 96693.0 before_mask 2461897.0 after_mask 2461897.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1180,1172 density 0.6828703703703703,0.6782407407407407
before tensor 4096 mask 679.0 4096
layer1.0.conv1.weight, mask/weight parameters,679,662 density 0.22573138297872342,0.22007978723404256
before tensor 36864 mask 3913.0 36864
layer1.0.conv2.weight, mask/weight parameters,3913,3837 density 0.19682108545847796,0.19299834012373623
before tensor 16384 mask 4032.0 16384
layer1.0.conv3.weight, mask/weight parameters,4032,3928 density 0.3351063829787234,0.32646276595744683
layer1.0.shortcut.0.weight, mask/weight parameters,5689,5565 density 0.34722900390625,0.33966064453125
before tensor 16384 mask 2548.0 16384
layer1.1.conv1.weight, mask/weight parameters,2548,2517 density 0.21176861702127658,0.20919215425531915
before tensor 36864 mask 4172.0 36864
layer1.1.conv2.weight, mask/weight parameters,4172,4124 density 0.20984859916503193,0.20743423369045821
before tensor 16384 mask 2378.0 16384
layer1.1.conv3.weight, mask/weight parameters,2378,2331 density 0.19763962765957446,0.19373337765957446
before tensor 16384 mask 3023.0 16384
layer1.2.conv1.weight, mask/weight parameters,3023,2907 density 0.2512466755319149,0.2416057180851064
before tensor 36864 mask 3614.0 36864
layer1.2.conv2.weight, mask/weight parameters,3614,3579 density 0.1817816005231125,0.18002112569790252
before tensor 16384 mask 1976.0 16384
layer1.2.conv3.weight, mask/weight parameters,1976,1928 density 0.16422872340425532,0.16023936170212766
before tensor 32768 mask 5583.0 32768
layer2.0.conv1.weight, mask/weight parameters,5583,5417 density 0.29078125,0.2821354166666667
before tensor 147456 mask 13041.0 147456
layer2.0.conv2.weight, mask/weight parameters,13041,12853 density 0.2576,0.2538864197530864
before tensor 65536 mask 7292.0 65536
layer2.0.conv3.weight, mask/weight parameters,7292,7111 density 0.18989583333333335,0.18518229166666667
layer2.0.shortcut.0.weight, mask/weight parameters,31593,30778 density 0.24103546142578125,0.2348175048828125
before tensor 65536 mask 4007.0 65536
layer2.1.conv1.weight, mask/weight parameters,4007,3892 density 0.10434895833333334,0.10135416666666666
before tensor 147456 mask 4319.0 147456
layer2.1.conv2.weight, mask/weight parameters,4319,4265 density 0.08531358024691359,0.08424691358024691
before tensor 65536 mask 4322.0 65536
layer2.1.conv3.weight, mask/weight parameters,4322,4250 density 0.11255208333333333,0.11067708333333333
before tensor 65536 mask 11045.0 65536
layer2.2.conv1.weight, mask/weight parameters,11045,10804 density 0.28763020833333336,0.2813541666666667
before tensor 147456 mask 22401.0 147456
layer2.2.conv2.weight, mask/weight parameters,22401,21691 density 0.4424888888888889,0.4284641975308642
before tensor 65536 mask 13942.0 65536
layer2.2.conv3.weight, mask/weight parameters,13942,13377 density 0.3630729166666667,0.348359375
before tensor 65536 mask 11161.0 65536
layer2.3.conv1.weight, mask/weight parameters,11161,10941 density 0.29065104166666667,0.284921875
before tensor 147456 mask 21229.0 147456
layer2.3.conv2.weight, mask/weight parameters,21229,20709 density 0.41933827160493825,0.4090666666666667
before tensor 65536 mask 11858.0 65536
layer2.3.conv3.weight, mask/weight parameters,11858,11566 density 0.3088020833333333,0.3011979166666667
before tensor 131072 mask 30559.0 131072
layer3.0.conv1.weight, mask/weight parameters,30559,29587 density 0.46996493602362205,0.4550166092519685
before tensor 589824 mask 66449.0 589824
layer3.0.conv2.weight, mask/weight parameters,66449,64455 density 0.45776069329916436,0.4440242213817761
before tensor 262144 mask 60155.0 262144
layer3.0.conv3.weight, mask/weight parameters,60155,58032 density 0.46255997785433073,0.44623523622047245
layer3.0.shortcut.0.weight, mask/weight parameters,104872,101216 density 0.2000274658203125,0.19305419921875
before tensor 262144 mask 29703.0 262144
layer3.1.conv1.weight, mask/weight parameters,29703,28658 density 0.22840028297244094,0.22036478838582677
before tensor 589824 mask 62404.0 589824
layer3.1.conv2.weight, mask/weight parameters,62404,60133 density 0.42989508201238624,0.4142503840563237
before tensor 262144 mask 52583.0 262144
layer3.1.conv3.weight, mask/weight parameters,52583,50507 density 0.4043353223425197,0.38837198572834647
before tensor 262144 mask 31726.0 262144
layer3.2.conv1.weight, mask/weight parameters,31726,30856 density 0.2439560777559055,0.23726624015748032
before tensor 589824 mask 55616.0 589824
layer3.2.conv2.weight, mask/weight parameters,55616,53817 density 0.38313321071086587,0.370740074813483
before tensor 262144 mask 51705.0 262144
layer3.2.conv3.weight, mask/weight parameters,51705,49745 density 0.397583968996063,0.38251261072834647
before tensor 262144 mask 35409.0 262144
layer3.3.conv1.weight, mask/weight parameters,35409,34222 density 0.2722763902559055,0.2631489911417323
before tensor 589824 mask 49843.0 589824
layer3.3.conv2.weight, mask/weight parameters,49843,47722 density 0.34336357561604014,0.3287522130599817
before tensor 262144 mask 44589.0 262144
layer3.3.conv3.weight, mask/weight parameters,44589,43039 density 0.3428657111220472,0.3309470349409449
before tensor 262144 mask 40219.0 262144
layer3.4.conv1.weight, mask/weight parameters,40219,38413 density 0.30926273375984253,0.2953755536417323
before tensor 589824 mask 50560.0 589824
layer3.4.conv2.weight, mask/weight parameters,50560,48362 density 0.34830291882805986,0.333161110766666
before tensor 262144 mask 42084.0 262144
layer3.4.conv3.weight, mask/weight parameters,42084,40411 density 0.323603592519685,0.31073911171259844
before tensor 262144 mask 46589.0 262144
layer3.5.conv1.weight, mask/weight parameters,46589,44906 density 0.35824464812992124,0.34530327263779526
before tensor 589824 mask 50528.0 589824
layer3.5.conv2.weight, mask/weight parameters,50528,48774 density 0.3480824739427257,0.335999338665344
before tensor 262144 mask 40463.0 262144
layer3.5.conv3.weight, mask/weight parameters,40463,39036 density 0.3111389640748031,0.300166092519685
before tensor 524288 mask 138715.0 524288
layer4.0.conv1.weight, mask/weight parameters,138715,133744 density 0.5764419880319149,0.5557845744680852
before tensor 2359296 mask 208463.0 2359296
layer4.0.conv2.weight, mask/weight parameters,208463,198549 density 0.41942155827171673,0.39947487550928024
before tensor 1048576 mask 110377.0 1048576
layer4.0.conv3.weight, mask/weight parameters,110377,105387 density 0.22934050864361702,0.21897232380319148
layer4.0.shortcut.0.weight, mask/weight parameters,153009,148252 density 0.07296037673950195,0.07069206237792969
before tensor 1048576 mask 122408.0 1048576
layer4.1.conv1.weight, mask/weight parameters,122408,116378 density 0.25433843085106383,0.24180934175531915
before tensor 2359296 mask 197684.0 2359296
layer4.1.conv2.weight, mask/weight parameters,197684,186662 density 0.3977345203963583,0.3755585735123988
before tensor 1048576 mask 88398.0 1048576
layer4.1.conv3.weight, mask/weight parameters,88398,84232 density 0.18367270611702127,0.17501662234042553
before tensor 1048576 mask 83264.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83264,77888 density 0.17300531914893616,0.1618351063829787
before tensor 2359296 mask 73572.0 2359296
layer4.2.conv2.weight, mask/weight parameters,73572,68821 density 0.1480247472461144,0.13846587193803128
before tensor 1048576 mask 37308.0 1048576
layer4.2.conv3.weight, mask/weight parameters,37308,36081 density 0.07751828457446809,0.07496883311170213
classifier.weight, mask/weight parameters,107646,107116 density 0.525615234375,0.52302734375
Total Model parameters after dst: 2461897 2365205
Total parameters under density level of 0.1: 0.24391233927069736 0.2343325835340592 after dst
Death rate: 0.10408824654974473


Training summary: Average loss: 0.3687, Accuracy: 44250/50000 (88.500%)


Evaluation: Average loss: 1.0814, Accuracy: 7153/10000 (71.530%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.73 seconds.

Train Epoch: 106 [0/50000 (0%)]	Loss: 0.263837 Accuracy: 92/100 (92.000%
Train Epoch: 106 [10000/50000 (20%)]	Loss: 0.303187 Accuracy: 9111/10100 (90.208%
Train Epoch: 106 [20000/50000 (40%)]	Loss: 0.315335 Accuracy: 18139/20100 (90.244%
Train Epoch: 106 [30000/50000 (60%)]	Loss: 0.498476 Accuracy: 27015/30100 (89.751%
Train Epoch: 106 [40000/50000 (80%)]	Loss: 0.463080 Accuracy: 35772/40100 (89.207%
current layer rate 0.49723099681383703
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3816.0
Total filter_masks items: 7117944.0
3816.0 / 7552 channels
Total channels to prune: 19.088487938097842
Layer ('layer4', 0, 'conv1'): Pruned 1/235.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/235.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/235.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/235.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/235.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/235.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3810.0
Total filter_masks items: 7094017.0
After apply_mask:
Total filter_names items: 3810.0
Total filter_masks items: 7094017.0
Total pruned: 6/19.088487938097842 channels
===========done ===============

Training summary: Average loss: 0.3553, Accuracy: 44463/50000 (88.926%)


Evaluation: Average loss: 1.0649, Accuracy: 7191/10000 (71.910%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.55 seconds.

Train Epoch: 107 [0/50000 (0%)]	Loss: 0.196718 Accuracy: 95/100 (95.000%
Train Epoch: 107 [10000/50000 (20%)]	Loss: 0.276042 Accuracy: 9108/10100 (90.178%
Train Epoch: 107 [20000/50000 (40%)]	Loss: 0.301684 Accuracy: 18049/20100 (89.796%
Train Epoch: 107 [30000/50000 (60%)]	Loss: 0.311256 Accuracy: 26915/30100 (89.419%
Train Epoch: 107 [40000/50000 (80%)]	Loss: 0.598998 Accuracy: 35695/40100 (89.015%
current mest  death_rate 0.10345075832799909


dynamic sparse change prune
to kill 89391.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1163,1163 density 0.6730324074074074,0.6730324074074074
before tensor 4096 mask 663.0 4096
layer1.0.conv1.weight, mask/weight parameters,663,663 density 0.2204122340425532,0.2204122340425532
before tensor 36864 mask 3809.0 36864
layer1.0.conv2.weight, mask/weight parameters,3809,3809 density 0.19158996026356823,0.19158996026356823
before tensor 16384 mask 3910.0 16384
layer1.0.conv3.weight, mask/weight parameters,3910,3910 density 0.3249667553191489,0.3249667553191489
layer1.0.shortcut.0.weight, mask/weight parameters,5567,5567 density 0.33978271484375,0.33978271484375
before tensor 16384 mask 2476.0 16384
layer1.1.conv1.weight, mask/weight parameters,2476,2476 density 0.2057845744680851,0.2057845744680851
before tensor 36864 mask 4088.0 36864
layer1.1.conv2.weight, mask/weight parameters,4088,4088 density 0.20562345958452793,0.20562345958452793
before tensor 16384 mask 2319.0 16384
layer1.1.conv3.weight, mask/weight parameters,2319,2319 density 0.19273603723404256,0.19273603723404256
before tensor 16384 mask 2913.0 16384
layer1.2.conv1.weight, mask/weight parameters,2913,2913 density 0.24210438829787234,0.24210438829787234
before tensor 36864 mask 3534.0 36864
layer1.2.conv2.weight, mask/weight parameters,3534,3534 density 0.17775765806548965,0.17775765806548965
before tensor 16384 mask 1910.0 16384
layer1.2.conv3.weight, mask/weight parameters,1910,1910 density 0.15874335106382978,0.15874335106382978
before tensor 32768 mask 5388.0 32768
layer2.0.conv1.weight, mask/weight parameters,5388,5388 density 0.280625,0.280625
before tensor 147456 mask 12753.0 147456
layer2.0.conv2.weight, mask/weight parameters,12753,12753 density 0.2519111111111111,0.2519111111111111
before tensor 65536 mask 7099.0 65536
layer2.0.conv3.weight, mask/weight parameters,7099,7099 density 0.18486979166666667,0.18486979166666667
layer2.0.shortcut.0.weight, mask/weight parameters,30630,30630 density 0.2336883544921875,0.2336883544921875
before tensor 65536 mask 3843.0 65536
layer2.1.conv1.weight, mask/weight parameters,3843,3843 density 0.100078125,0.100078125
before tensor 147456 mask 4215.0 147456
layer2.1.conv2.weight, mask/weight parameters,4215,4215 density 0.08325925925925926,0.08325925925925926
before tensor 65536 mask 4225.0 65536
layer2.1.conv3.weight, mask/weight parameters,4225,4225 density 0.11002604166666667,0.11002604166666667
before tensor 65536 mask 10741.0 65536
layer2.2.conv1.weight, mask/weight parameters,10741,10741 density 0.2797135416666667,0.2797135416666667
before tensor 147456 mask 21768.0 147456
layer2.2.conv2.weight, mask/weight parameters,21768,21768 density 0.4299851851851852,0.4299851851851852
before tensor 65536 mask 13468.0 65536
layer2.2.conv3.weight, mask/weight parameters,13468,13468 density 0.35072916666666665,0.35072916666666665
before tensor 65536 mask 10822.0 65536
layer2.3.conv1.weight, mask/weight parameters,10822,10822 density 0.28182291666666665,0.28182291666666665
before tensor 147456 mask 20673.0 147456
layer2.3.conv2.weight, mask/weight parameters,20673,20673 density 0.4083555555555556,0.4083555555555556
before tensor 65536 mask 11521.0 65536
layer2.3.conv3.weight, mask/weight parameters,11521,11521 density 0.3000260416666667,0.3000260416666667
before tensor 131072 mask 29590.0 131072
layer3.0.conv1.weight, mask/weight parameters,29590,29590 density 0.45506274606299213,0.45506274606299213
before tensor 589824 mask 64185.0 589824
layer3.0.conv2.weight, mask/weight parameters,64185,64185 density 0.44216421766176867,0.44216421766176867
before tensor 262144 mask 58172.0 262144
layer3.0.conv3.weight, mask/weight parameters,58172,58172 density 0.4473117618110236,0.4473117618110236
layer3.0.shortcut.0.weight, mask/weight parameters,101337,101337 density 0.1932849884033203,0.1932849884033203
before tensor 262144 mask 28602.0 262144
layer3.1.conv1.weight, mask/weight parameters,28602,28602 density 0.2199341781496063,0.2199341781496063
before tensor 589824 mask 60004.0 589824
layer3.1.conv2.weight, mask/weight parameters,60004,60004 density 0.4133617156123201,0.4133617156123201
before tensor 262144 mask 50724.0 262144
layer3.1.conv3.weight, mask/weight parameters,50724,50724 density 0.3900406003937008,0.3900406003937008
before tensor 262144 mask 30471.0 262144
layer3.2.conv1.weight, mask/weight parameters,30471,30471 density 0.23430579478346455,0.23430579478346455
before tensor 589824 mask 53574.0 589824
layer3.2.conv2.weight, mask/weight parameters,53574,53574 density 0.36906607146547626,0.36906607146547626
before tensor 262144 mask 49834.0 262144
layer3.2.conv3.weight, mask/weight parameters,49834,49834 density 0.3831969734251969,0.3831969734251969
before tensor 262144 mask 34015.0 262144
layer3.3.conv1.weight, mask/weight parameters,34015,34015 density 0.2615572711614173,0.2615572711614173
before tensor 589824 mask 47924.0 589824
layer3.3.conv2.weight, mask/weight parameters,47924,47924 density 0.3301437713986539,0.3301437713986539
before tensor 262144 mask 42979.0 262144
layer3.3.conv3.weight, mask/weight parameters,42979,42979 density 0.3304856668307087,0.3304856668307087
before tensor 262144 mask 38673.0 262144
layer3.4.conv1.weight, mask/weight parameters,38673,38673 density 0.2973748154527559,0.2973748154527559
before tensor 589824 mask 48658.0 589824
layer3.4.conv2.weight, mask/weight parameters,48658,48658 density 0.33520022595600746,0.33520022595600746
before tensor 262144 mask 40535.0 262144
layer3.4.conv3.weight, mask/weight parameters,40535,40535 density 0.31169260580708663,0.31169260580708663
before tensor 262144 mask 44770.0 262144
layer3.5.conv1.weight, mask/weight parameters,44770,44770 density 0.34425750492125984,0.34425750492125984
before tensor 589824 mask 48669.0 589824
layer3.5.conv2.weight, mask/weight parameters,48669,48669 density 0.3352760038853411,0.3352760038853411
before tensor 262144 mask 38990.0 262144
layer3.5.conv3.weight, mask/weight parameters,38990,38990 density 0.29981237696850394,0.29981237696850394
before tensor 524288 mask 133767.0 524288
layer4.0.conv1.weight, mask/weight parameters,133767,133767 density 0.5582557091346154,0.5582557091346154
before tensor 2359296 mask 198634.0 2359296
layer4.0.conv2.weight, mask/weight parameters,198634,198634 density 0.40306896859603414,0.40306896859603414
before tensor 1048576 mask 105353.0 1048576
layer4.0.conv3.weight, mask/weight parameters,105353,105353 density 0.219837156116453,0.219837156116453
layer4.0.shortcut.0.weight, mask/weight parameters,147219,147219 density 0.07019948959350586,0.07019948959350586
before tensor 1048576 mask 116649.0 1048576
layer4.1.conv1.weight, mask/weight parameters,116649,116649 density 0.243408203125,0.243408203125
before tensor 2359296 mask 187757.0 2359296
layer4.1.conv2.weight, mask/weight parameters,187757,187757 density 0.3809973133334957,0.3809973133334957
before tensor 1048576 mask 84469.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84469,84469 density 0.17625909788995728,0.17625909788995728
before tensor 1048576 mask 78689.0 1048576
layer4.2.conv1.weight, mask/weight parameters,78689,78689 density 0.16419813368055555,0.16419813368055555
before tensor 2359296 mask 68743.0 2359296
layer4.2.conv2.weight, mask/weight parameters,68743,68743 density 0.13949359177279405,0.13949359177279405
before tensor 1048576 mask 35722.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35722,35722 density 0.07454009748931624,0.07454009748931624
classifier.weight, mask/weight parameters,106999,106999 density 0.5224560546875,0.5224560546875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.23488940448630663 0.23488940448630663 after dst
Death rate: 0.10345075832799909

dynamic sparse change grow
self.total_params*pruning_rate 2446820.646398101
self.total_nonzero 2365205.0
to grow 81615.646398101
len(all_scores) 10069441 6721657
increse 81615.0 before_mask 2446819.0 after_mask 2446819.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1179,1163 density 0.6822916666666666,0.6730324074074074
before tensor 4096 mask 690.0 4096
layer1.0.conv1.weight, mask/weight parameters,690,663 density 0.2293882978723404,0.2204122340425532
before tensor 36864 mask 3892.0 36864
layer1.0.conv2.weight, mask/weight parameters,3892,3809 density 0.19576480056335194,0.19158996026356823
before tensor 16384 mask 4015.0 16384
layer1.0.conv3.weight, mask/weight parameters,4015,3910 density 0.33369348404255317,0.3249667553191489
layer1.0.shortcut.0.weight, mask/weight parameters,5740,5567 density 0.350341796875,0.33978271484375
before tensor 16384 mask 2597.0 16384
layer1.1.conv1.weight, mask/weight parameters,2597,2476 density 0.21584109042553193,0.2057845744680851
before tensor 36864 mask 4189.0 36864
layer1.1.conv2.weight, mask/weight parameters,4189,4088 density 0.21070368693727679,0.20562345958452793
before tensor 16384 mask 2367.0 16384
layer1.1.conv3.weight, mask/weight parameters,2367,2319 density 0.19672539893617022,0.19273603723404256
before tensor 16384 mask 3023.0 16384
layer1.2.conv1.weight, mask/weight parameters,3023,2913 density 0.2512466755319149,0.24210438829787234
before tensor 36864 mask 3608.0 36864
layer1.2.conv2.weight, mask/weight parameters,3608,3534 density 0.1814798048387908,0.17775765806548965
before tensor 16384 mask 1988.0 16384
layer1.2.conv3.weight, mask/weight parameters,1988,1910 density 0.16522606382978725,0.15874335106382978
before tensor 32768 mask 5615.0 32768
layer2.0.conv1.weight, mask/weight parameters,5615,5388 density 0.29244791666666664,0.280625
before tensor 147456 mask 13001.0 147456
layer2.0.conv2.weight, mask/weight parameters,13001,12753 density 0.25680987654320986,0.2519111111111111
before tensor 65536 mask 7240.0 65536
layer2.0.conv3.weight, mask/weight parameters,7240,7099 density 0.18854166666666666,0.18486979166666667
layer2.0.shortcut.0.weight, mask/weight parameters,31162,30630 density 0.2377471923828125,0.2336883544921875
before tensor 65536 mask 3858.0 65536
layer2.1.conv1.weight, mask/weight parameters,3858,3843 density 0.10046875,0.100078125
before tensor 147456 mask 4248.0 147456
layer2.1.conv2.weight, mask/weight parameters,4248,4215 density 0.08391111111111112,0.08325925925925926
before tensor 65536 mask 4287.0 65536
layer2.1.conv3.weight, mask/weight parameters,4287,4225 density 0.111640625,0.11002604166666667
before tensor 65536 mask 10889.0 65536
layer2.2.conv1.weight, mask/weight parameters,10889,10741 density 0.28356770833333333,0.2797135416666667
before tensor 147456 mask 22212.0 147456
layer2.2.conv2.weight, mask/weight parameters,22212,21768 density 0.43875555555555557,0.4299851851851852
before tensor 65536 mask 13936.0 65536
layer2.2.conv3.weight, mask/weight parameters,13936,13468 density 0.36291666666666667,0.35072916666666665
before tensor 65536 mask 11081.0 65536
layer2.3.conv1.weight, mask/weight parameters,11081,10822 density 0.28856770833333334,0.28182291666666665
before tensor 147456 mask 21138.0 147456
layer2.3.conv2.weight, mask/weight parameters,21138,20673 density 0.41754074074074077,0.4083555555555556
before tensor 65536 mask 11733.0 65536
layer2.3.conv3.weight, mask/weight parameters,11733,11521 density 0.305546875,0.3000260416666667
before tensor 131072 mask 30364.0 131072
layer3.0.conv1.weight, mask/weight parameters,30364,29590 density 0.46696604330708663,0.45506274606299213
before tensor 589824 mask 65777.0 589824
layer3.0.conv2.weight, mask/weight parameters,65777,64185 density 0.4531313507071459,0.44216421766176867
before tensor 262144 mask 59754.0 262144
layer3.0.conv3.weight, mask/weight parameters,59754,58172 density 0.45947650098425197,0.4473117618110236
layer3.0.shortcut.0.weight, mask/weight parameters,103754,101337 density 0.19789505004882812,0.1932849884033203
before tensor 262144 mask 29315.0 262144
layer3.1.conv1.weight, mask/weight parameters,29315,28602 density 0.2254167691929134,0.2199341781496063
before tensor 589824 mask 61953.0 589824
layer3.1.conv2.weight, mask/weight parameters,61953,60004 density 0.42678818690970716,0.4133617156123201
before tensor 262144 mask 52213.0 262144
layer3.1.conv3.weight, mask/weight parameters,52213,50724 density 0.401490218996063,0.3900406003937008
before tensor 262144 mask 31127.0 262144
layer3.2.conv1.weight, mask/weight parameters,31127,30471 density 0.23935008612204725,0.23430579478346455
before tensor 589824 mask 55021.0 589824
layer3.2.conv2.weight, mask/weight parameters,55021,53574 density 0.37903431362418283,0.36906607146547626
before tensor 262144 mask 51300.0 262144
layer3.2.conv3.weight, mask/weight parameters,51300,49834 density 0.3944697342519685,0.3831969734251969
before tensor 262144 mask 34815.0 262144
layer3.3.conv1.weight, mask/weight parameters,34815,34015 density 0.26770884596456695,0.2615572711614173
before tensor 589824 mask 49512.0 589824
layer3.3.conv2.weight, mask/weight parameters,49512,47924 density 0.34108334883336433,0.3301437713986539
before tensor 262144 mask 44357.0 262144
layer3.3.conv3.weight, mask/weight parameters,44357,42979 density 0.34108175442913385,0.3304856668307087
before tensor 262144 mask 40343.0 262144
layer3.4.conv1.weight, mask/weight parameters,40343,38673 density 0.31021622785433073,0.2973748154527559
before tensor 589824 mask 50757.0 589824
layer3.4.conv2.weight, mask/weight parameters,50757,48658 density 0.3496600326533986,0.33520022595600746
before tensor 262144 mask 42072.0 262144
layer3.4.conv3.weight, mask/weight parameters,42072,40535 density 0.3235113188976378,0.31169260580708663
before tensor 262144 mask 46283.0 262144
layer3.5.conv1.weight, mask/weight parameters,46283,44770 density 0.35589167076771655,0.34425750492125984
before tensor 589824 mask 50475.0 589824
layer3.5.conv2.weight, mask/weight parameters,50475,48669 density 0.34771736210139087,0.3352760038853411
before tensor 262144 mask 40789.0 262144
layer3.5.conv3.weight, mask/weight parameters,40789,38990 density 0.31364573080708663,0.29981237696850394
before tensor 524288 mask 138156.0 524288
layer4.0.conv1.weight, mask/weight parameters,138156,133767 density 0.5765725160256411,0.5582557091346154
before tensor 2359296 mask 207035.0 2359296
layer4.0.conv2.weight, mask/weight parameters,207035,198634 density 0.4201163139909579,0.40306896859603414
before tensor 1048576 mask 108997.0 1048576
layer4.0.conv3.weight, mask/weight parameters,108997,105353 density 0.2274409889155983,0.219837156116453
layer4.0.shortcut.0.weight, mask/weight parameters,151029,147219 density 0.07201623916625977,0.07019948959350586
before tensor 1048576 mask 121697.0 1048576
layer4.1.conv1.weight, mask/weight parameters,121697,116649 density 0.2539417234241453,0.243408203125
before tensor 2359296 mask 197429.0 2359296
layer4.1.conv2.weight, mask/weight parameters,197429,187757 density 0.4006237774044042,0.3809973133334957
before tensor 1048576 mask 87447.0 1048576
layer4.1.conv3.weight, mask/weight parameters,87447,84469 density 0.18247320713141027,0.17625909788995728
before tensor 1048576 mask 83342.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83342,78689 density 0.1739074185363248,0.16419813368055555
before tensor 2359296 mask 73285.0 2359296
layer4.2.conv2.weight, mask/weight parameters,73285,68743 density 0.14871023774157677,0.13949359177279405
before tensor 1048576 mask 37331.0 1048576
layer4.2.conv3.weight, mask/weight parameters,37331,35722 density 0.07789755275106838,0.07454009748931624
classifier.weight, mask/weight parameters,107402,106999 density 0.524423828125,0.5224560546875
Total Model parameters after dst: 2446819 2365205
Total parameters under density level of 0.1: 0.24299452174157432 0.23488940448630663 after dst
Death rate: 0.10345075832799909


Training summary: Average loss: 0.3614, Accuracy: 44379/50000 (88.758%)


Evaluation: Average loss: 1.1206, Accuracy: 7154/10000 (71.540%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.70 seconds.

Train Epoch: 108 [0/50000 (0%)]	Loss: 0.278017 Accuracy: 93/100 (93.000%
Train Epoch: 108 [10000/50000 (20%)]	Loss: 0.239572 Accuracy: 9129/10100 (90.386%
Train Epoch: 108 [20000/50000 (40%)]	Loss: 0.345506 Accuracy: 18122/20100 (90.159%
Train Epoch: 108 [30000/50000 (60%)]	Loss: 0.332645 Accuracy: 27056/30100 (89.887%
Train Epoch: 108 [40000/50000 (80%)]	Loss: 0.418297 Accuracy: 35914/40100 (89.561%
current layer rate 0.4978923532089213
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3810.0
Total filter_masks items: 7094017.0
3810.0 / 7552 channels
Total channels to prune: 18.083051433773107
Layer ('layer4', 0, 'conv1'): Pruned 1/234.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/234.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/234.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/234.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/234.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/234.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3804.0
Total filter_masks items: 7070144.0
After apply_mask:
Total filter_names items: 3804.0
Total filter_masks items: 7070144.0
Total pruned: 6/18.083051433773107 channels
===========done ===============

Training summary: Average loss: 0.3502, Accuracy: 44588/50000 (89.176%)


Evaluation: Average loss: 1.0936, Accuracy: 7189/10000 (71.890%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.53 seconds.

Train Epoch: 109 [0/50000 (0%)]	Loss: 0.462792 Accuracy: 85/100 (85.000%
Train Epoch: 109 [10000/50000 (20%)]	Loss: 0.248700 Accuracy: 9105/10100 (90.149%
Train Epoch: 109 [20000/50000 (40%)]	Loss: 0.285856 Accuracy: 18062/20100 (89.861%
Train Epoch: 109 [30000/50000 (60%)]	Loss: 0.282395 Accuracy: 26967/30100 (89.591%
Train Epoch: 109 [40000/50000 (80%)]	Loss: 0.423833 Accuracy: 35840/40100 (89.377%
current mest  death_rate 0.10286359935867019


dynamic sparse change prune
to kill 73617.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1168,1168 density 0.6759259259259259,0.6759259259259259
before tensor 4096 mask 673.0 4096
layer1.0.conv1.weight, mask/weight parameters,673,673 density 0.2237367021276596,0.2237367021276596
before tensor 36864 mask 3806.0 36864
layer1.0.conv2.weight, mask/weight parameters,3806,3806 density 0.19143906242140737,0.19143906242140737
before tensor 16384 mask 3907.0 16384
layer1.0.conv3.weight, mask/weight parameters,3907,3907 density 0.32471742021276595,0.32471742021276595
layer1.0.shortcut.0.weight, mask/weight parameters,5610,5610 density 0.3424072265625,0.3424072265625
before tensor 16384 mask 2524.0 16384
layer1.1.conv1.weight, mask/weight parameters,2524,2524 density 0.20977393617021275,0.20977393617021275
before tensor 36864 mask 4128.0 36864
layer1.1.conv2.weight, mask/weight parameters,4128,4128 density 0.20763543081333938,0.20763543081333938
before tensor 16384 mask 2313.0 16384
layer1.1.conv3.weight, mask/weight parameters,2313,2313 density 0.19223736702127658,0.19223736702127658
before tensor 16384 mask 2931.0 16384
layer1.2.conv1.weight, mask/weight parameters,2931,2931 density 0.24360039893617022,0.24360039893617022
before tensor 36864 mask 3532.0 36864
layer1.2.conv2.weight, mask/weight parameters,3532,3532 density 0.1776570595040491,0.1776570595040491
before tensor 16384 mask 1933.0 16384
layer1.2.conv3.weight, mask/weight parameters,1933,1933 density 0.16065492021276595,0.16065492021276595
before tensor 32768 mask 5431.0 32768
layer2.0.conv1.weight, mask/weight parameters,5431,5431 density 0.2828645833333333,0.2828645833333333
before tensor 147456 mask 12767.0 147456
layer2.0.conv2.weight, mask/weight parameters,12767,12767 density 0.25218765432098766,0.25218765432098766
before tensor 65536 mask 7089.0 65536
layer2.0.conv3.weight, mask/weight parameters,7089,7089 density 0.184609375,0.184609375
layer2.0.shortcut.0.weight, mask/weight parameters,30348,30348 density 0.231536865234375,0.231536865234375
before tensor 65536 mask 3762.0 65536
layer2.1.conv1.weight, mask/weight parameters,3762,3762 density 0.09796875,0.09796875
before tensor 147456 mask 4175.0 147456
layer2.1.conv2.weight, mask/weight parameters,4175,4175 density 0.08246913580246913,0.08246913580246913
before tensor 65536 mask 4207.0 65536
layer2.1.conv3.weight, mask/weight parameters,4207,4207 density 0.10955729166666667,0.10955729166666667
before tensor 65536 mask 10621.0 65536
layer2.2.conv1.weight, mask/weight parameters,10621,10621 density 0.2765885416666667,0.2765885416666667
before tensor 147456 mask 21670.0 147456
layer2.2.conv2.weight, mask/weight parameters,21670,21670 density 0.42804938271604936,0.42804938271604936
before tensor 65536 mask 13513.0 65536
layer2.2.conv3.weight, mask/weight parameters,13513,13513 density 0.3519010416666667,0.3519010416666667
before tensor 65536 mask 10819.0 65536
layer2.3.conv1.weight, mask/weight parameters,10819,10819 density 0.28174479166666666,0.28174479166666666
before tensor 147456 mask 20672.0 147456
layer2.3.conv2.weight, mask/weight parameters,20672,20672 density 0.4083358024691358,0.4083358024691358
before tensor 65536 mask 11458.0 65536
layer2.3.conv3.weight, mask/weight parameters,11458,11458 density 0.2983854166666667,0.2983854166666667
before tensor 131072 mask 29577.0 131072
layer3.0.conv1.weight, mask/weight parameters,29577,29577 density 0.45486281988188976,0.45486281988188976
before tensor 589824 mask 63993.0 589824
layer3.0.conv2.weight, mask/weight parameters,63993,63993 density 0.44084154834976336,0.44084154834976336
before tensor 262144 mask 58256.0 262144
layer3.0.conv3.weight, mask/weight parameters,58256,58256 density 0.44795767716535434,0.44795767716535434
layer3.0.shortcut.0.weight, mask/weight parameters,100790,100790 density 0.19224166870117188,0.19224166870117188
before tensor 262144 mask 28491.0 262144
layer3.1.conv1.weight, mask/weight parameters,28491,28491 density 0.2190806471456693,0.2190806471456693
before tensor 589824 mask 60060.0 589824
layer3.1.conv2.weight, mask/weight parameters,60060,60060 density 0.413747494161655,0.413747494161655
before tensor 262144 mask 50766.0 262144
layer3.1.conv3.weight, mask/weight parameters,50766,50766 density 0.39036355807086615,0.39036355807086615
before tensor 262144 mask 30180.0 262144
layer3.2.conv1.weight, mask/weight parameters,30180,30180 density 0.2320681594488189,0.2320681594488189
before tensor 589824 mask 53368.0 589824
layer3.2.conv2.weight, mask/weight parameters,53368,53368 density 0.36764695751613724,0.36764695751613724
before tensor 262144 mask 49737.0 262144
layer3.2.conv3.weight, mask/weight parameters,49737,49737 density 0.382451094980315,0.382451094980315
before tensor 262144 mask 33723.0 262144
layer3.3.conv1.weight, mask/weight parameters,33723,33723 density 0.2593119463582677,0.2593119463582677
before tensor 589824 mask 47922.0 589824
layer3.3.conv2.weight, mask/weight parameters,47922,47922 density 0.3301299935933205,0.3301299935933205
before tensor 262144 mask 42979.0 262144
layer3.3.conv3.weight, mask/weight parameters,42979,42979 density 0.3304856668307087,0.3304856668307087
before tensor 262144 mask 38952.0 262144
layer3.4.conv1.weight, mask/weight parameters,38952,38952 density 0.29952017716535434,0.29952017716535434
before tensor 589824 mask 49173.0 589824
layer3.4.conv2.weight, mask/weight parameters,49173,49173 density 0.338748010829355,0.338748010829355
before tensor 262144 mask 40763.0 262144
layer3.4.conv3.weight, mask/weight parameters,40763,40763 density 0.31344580462598426,0.31344580462598426
before tensor 262144 mask 44840.0 262144
layer3.5.conv1.weight, mask/weight parameters,44840,44840 density 0.3447957677165354,0.3447957677165354
before tensor 589824 mask 48965.0 589824
layer3.5.conv2.weight, mask/weight parameters,48965,48965 density 0.3373151190746826,0.3373151190746826
before tensor 262144 mask 39448.0 262144
layer3.5.conv3.weight, mask/weight parameters,39448,39448 density 0.30333415354330706,0.30333415354330706
before tensor 524288 mask 133837.0 524288
layer4.0.conv1.weight, mask/weight parameters,133837,133837 density 0.5609450442596566,0.5609450442596566
before tensor 2359296 mask 198049.0 2359296
layer4.0.conv2.weight, mask/weight parameters,198049,198049 density 0.4053389166211285,0.4053389166211285
before tensor 1048576 mask 104929.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104929,104929 density 0.21989211708690987,0.21989211708690987
layer4.0.shortcut.0.weight, mask/weight parameters,146074,146074 density 0.06965351104736328,0.06965351104736328
before tensor 1048576 mask 116886.0 1048576
layer4.1.conv1.weight, mask/weight parameters,116886,116886 density 0.24494953728540772,0.24494953728540772
before tensor 2359296 mask 188931.0 2359296
layer4.1.conv2.weight, mask/weight parameters,188931,188931 density 0.38667747303014116,0.38667747303014116
before tensor 1048576 mask 84286.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84286,84286 density 0.1766320748390558,0.1766320748390558
before tensor 1048576 mask 79318.0 1048576
layer4.2.conv1.weight, mask/weight parameters,79318,79318 density 0.16622099651287553,0.16622099651287553
before tensor 2359296 mask 69242.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69242,69242 density 0.14171481433726088,0.14171481433726088
before tensor 1048576 mask 35734.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35734,35734 density 0.07488515960300429,0.07488515960300429
classifier.weight, mask/weight parameters,106879,106879 density 0.5218701171875,0.5218701171875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.2354476123201794 0.2354476123201794 after dst
Death rate: 0.10286359935867019

dynamic sparse change grow
self.total_params*pruning_rate 2432933.1436664467
self.total_nonzero 2365205.0
to grow 67728.14366644667
len(all_scores) 10045568 6699661
increse 67728.0 before_mask 2432932.0 after_mask 2432932.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1178,1168 density 0.6817129629629629,0.6759259259259259
before tensor 4096 mask 693.0 4096
layer1.0.conv1.weight, mask/weight parameters,693,673 density 0.23038563829787234,0.2237367021276596
before tensor 36864 mask 3840.0 36864
layer1.0.conv2.weight, mask/weight parameters,3840,3806 density 0.19314923796589709,0.19143906242140737
before tensor 16384 mask 3970.0 16384
layer1.0.conv3.weight, mask/weight parameters,3970,3907 density 0.3299534574468085,0.32471742021276595
layer1.0.shortcut.0.weight, mask/weight parameters,5797,5610 density 0.35382080078125,0.3424072265625
before tensor 16384 mask 2547.0 16384
layer1.1.conv1.weight, mask/weight parameters,2547,2524 density 0.21168550531914893,0.20977393617021275
before tensor 36864 mask 4153.0 36864
layer1.1.conv2.weight, mask/weight parameters,4153,4128 density 0.2088929128313465,0.20763543081333938
before tensor 16384 mask 2345.0 16384
layer1.1.conv3.weight, mask/weight parameters,2345,2313 density 0.1948969414893617,0.19223736702127658
before tensor 16384 mask 3023.0 16384
layer1.2.conv1.weight, mask/weight parameters,3023,2931 density 0.2512466755319149,0.24360039893617022
before tensor 36864 mask 3567.0 36864
layer1.2.conv2.weight, mask/weight parameters,3567,3532 density 0.17941753432925908,0.1776570595040491
before tensor 16384 mask 1983.0 16384
layer1.2.conv3.weight, mask/weight parameters,1983,1933 density 0.16481050531914893,0.16065492021276595
before tensor 32768 mask 5604.0 32768
layer2.0.conv1.weight, mask/weight parameters,5604,5431 density 0.291875,0.2828645833333333
before tensor 147456 mask 12851.0 147456
layer2.0.conv2.weight, mask/weight parameters,12851,12767 density 0.2538469135802469,0.25218765432098766
before tensor 65536 mask 7174.0 65536
layer2.0.conv3.weight, mask/weight parameters,7174,7089 density 0.18682291666666667,0.184609375
layer2.0.shortcut.0.weight, mask/weight parameters,31424,30348 density 0.23974609375,0.231536865234375
before tensor 65536 mask 3804.0 65536
layer2.1.conv1.weight, mask/weight parameters,3804,3762 density 0.0990625,0.09796875
before tensor 147456 mask 4283.0 147456
layer2.1.conv2.weight, mask/weight parameters,4283,4175 density 0.08460246913580247,0.08246913580246913
before tensor 65536 mask 4309.0 65536
layer2.1.conv3.weight, mask/weight parameters,4309,4207 density 0.11221354166666667,0.10955729166666667
before tensor 65536 mask 10886.0 65536
layer2.2.conv1.weight, mask/weight parameters,10886,10621 density 0.28348958333333335,0.2765885416666667
before tensor 147456 mask 22245.0 147456
layer2.2.conv2.weight, mask/weight parameters,22245,21670 density 0.4394074074074074,0.42804938271604936
before tensor 65536 mask 13875.0 65536
layer2.2.conv3.weight, mask/weight parameters,13875,13513 density 0.361328125,0.3519010416666667
before tensor 65536 mask 11145.0 65536
layer2.3.conv1.weight, mask/weight parameters,11145,10819 density 0.290234375,0.28174479166666666
before tensor 147456 mask 21127.0 147456
layer2.3.conv2.weight, mask/weight parameters,21127,20672 density 0.41732345679012345,0.4083358024691358
before tensor 65536 mask 11642.0 65536
layer2.3.conv3.weight, mask/weight parameters,11642,11458 density 0.3031770833333333,0.2983854166666667
before tensor 131072 mask 30484.0 131072
layer3.0.conv1.weight, mask/weight parameters,30484,29577 density 0.4688115157480315,0.45486281988188976
before tensor 589824 mask 65073.0 589824
layer3.0.conv2.weight, mask/weight parameters,65073,63993 density 0.4482815632297931,0.44084154834976336
before tensor 262144 mask 59385.0 262144
layer3.0.conv3.weight, mask/weight parameters,59385,58256 density 0.4566390871062992,0.44795767716535434
layer3.0.shortcut.0.weight, mask/weight parameters,102915,100790 density 0.19629478454589844,0.19224166870117188
before tensor 262144 mask 28980.0 262144
layer3.1.conv1.weight, mask/weight parameters,28980,28491 density 0.2228407972440945,0.2190806471456693
before tensor 589824 mask 62227.0 589824
layer3.1.conv2.weight, mask/weight parameters,62227,60060 density 0.42867574624038135,0.413747494161655
before tensor 262144 mask 52385.0 262144
layer3.1.conv3.weight, mask/weight parameters,52385,50766 density 0.40281280757874016,0.39036355807086615
before tensor 262144 mask 31161.0 262144
layer3.2.conv1.weight, mask/weight parameters,31161,30180 density 0.2396115280511811,0.2320681594488189
before tensor 589824 mask 55165.0 589824
layer3.2.conv2.weight, mask/weight parameters,55165,53368 density 0.3800263156081868,0.36764695751613724
before tensor 262144 mask 51215.0 262144
layer3.2.conv3.weight, mask/weight parameters,51215,49737 density 0.39381612942913385,0.382451094980315
before tensor 262144 mask 34734.0 262144
layer3.3.conv1.weight, mask/weight parameters,34734,33723 density 0.26708599901574803,0.2593119463582677
before tensor 589824 mask 49268.0 589824
layer3.3.conv2.weight, mask/weight parameters,49268,47922 density 0.33940245658269097,0.3301299935933205
before tensor 262144 mask 44342.0 262144
layer3.3.conv3.weight, mask/weight parameters,44342,42979 density 0.3409664124015748,0.3304856668307087
before tensor 262144 mask 40195.0 262144
layer3.4.conv1.weight, mask/weight parameters,40195,38952 density 0.30907818651574803,0.29952017716535434
before tensor 589824 mask 50618.0 589824
layer3.4.conv2.weight, mask/weight parameters,50618,49173 density 0.3487024751827281,0.338748010829355
before tensor 262144 mask 41839.0 262144
layer3.4.conv3.weight, mask/weight parameters,41839,40763 density 0.3217196727362205,0.31344580462598426
before tensor 262144 mask 46073.0 262144
layer3.5.conv1.weight, mask/weight parameters,46073,44840 density 0.35427688238188976,0.3447957677165354
before tensor 589824 mask 50091.0 589824
layer3.5.conv2.weight, mask/weight parameters,50091,48965 density 0.3450720234773803,0.3373151190746826
before tensor 262144 mask 40632.0 262144
layer3.5.conv3.weight, mask/weight parameters,40632,39448 density 0.3124384842519685,0.30333415354330706
before tensor 524288 mask 137573.0 524288
layer4.0.conv1.weight, mask/weight parameters,137573,133837 density 0.5766035743025751,0.5609450442596566
before tensor 2359296 mask 204298.0 2359296
layer4.0.conv2.weight, mask/weight parameters,204298,198049 density 0.418128493392359,0.4053389166211285
before tensor 1048576 mask 107949.0 1048576
layer4.0.conv3.weight, mask/weight parameters,107949,104929 density 0.22622091268776823,0.21989211708690987
layer4.0.shortcut.0.weight, mask/weight parameters,149059,146074 density 0.07107686996459961,0.06965351104736328
before tensor 1048576 mask 121445.0 1048576
layer4.1.conv1.weight, mask/weight parameters,121445,116886 density 0.254503503889485,0.24494953728540772
before tensor 2359296 mask 196542.0 2359296
layer4.1.conv2.weight, mask/weight parameters,196542,188931 density 0.4022546003794507,0.38667747303014116
before tensor 1048576 mask 86658.0 1048576
layer4.1.conv3.weight, mask/weight parameters,86658,84286 density 0.18160290370171675,0.1766320748390558
before tensor 1048576 mask 83292.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83292,79318 density 0.1745490209227468,0.16622099651287553
before tensor 2359296 mask 72211.0 2359296
layer4.2.conv2.weight, mask/weight parameters,72211,69242 density 0.14779134713191336,0.14171481433726088
before tensor 1048576 mask 36602.0 1048576
layer4.2.conv3.weight, mask/weight parameters,36602,35734 density 0.07670416443133048,0.07488515960300429
classifier.weight, mask/weight parameters,107056,106879 density 0.522734375,0.5218701171875
Total Model parameters after dst: 2432932 2365205
Total parameters under density level of 0.1: 0.2421895904741275 0.2354476123201794 after dst
Death rate: 0.10286359935867019


Training summary: Average loss: 0.3544, Accuracy: 44461/50000 (88.922%)


Evaluation: Average loss: 1.0999, Accuracy: 7210/10000 (72.100%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.71 seconds.

Train Epoch: 110 [0/50000 (0%)]	Loss: 0.210718 Accuracy: 93/100 (93.000%
Train Epoch: 110 [10000/50000 (20%)]	Loss: 0.195506 Accuracy: 9179/10100 (90.881%
Train Epoch: 110 [20000/50000 (40%)]	Loss: 0.290327 Accuracy: 18168/20100 (90.388%
Train Epoch: 110 [30000/50000 (60%)]	Loss: 0.373824 Accuracy: 27022/30100 (89.774%
Train Epoch: 110 [40000/50000 (80%)]	Loss: 0.337630 Accuracy: 35830/40100 (89.352%
current layer rate 0.4984390077378243
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3804.0
Total filter_masks items: 7070144.0
3804.0 / 7552 channels
Total channels to prune: 16.211386436048542
update_filter_mask
After update_filter_mask:
Total filter_names items: 3804.0
Total filter_masks items: 7070144.0
After apply_mask:
Total filter_names items: 3804.0
Total filter_masks items: 7070144.0
Total pruned: 0/16.211386436048542 channels
===========done ===============

Training summary: Average loss: 0.3472, Accuracy: 44563/50000 (89.126%)


Evaluation: Average loss: 1.0833, Accuracy: 7239/10000 (72.390%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.53 seconds.

Train Epoch: 111 [0/50000 (0%)]	Loss: 0.362575 Accuracy: 90/100 (90.000%
Train Epoch: 111 [10000/50000 (20%)]	Loss: 0.216372 Accuracy: 9109/10100 (90.188%
Train Epoch: 111 [20000/50000 (40%)]	Loss: 0.334216 Accuracy: 18112/20100 (90.109%
Train Epoch: 111 [30000/50000 (60%)]	Loss: 0.255222 Accuracy: 27034/30100 (89.814%
Train Epoch: 111 [40000/50000 (80%)]	Loss: 0.435037 Accuracy: 35911/40100 (89.554%
current mest  death_rate 0.1023281409787368


dynamic sparse change prune
to kill 67728.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1170,1170 density 0.6770833333333334,0.6770833333333334
before tensor 4096 mask 679.0 4096
layer1.0.conv1.weight, mask/weight parameters,679,679 density 0.22573138297872342,0.22573138297872342
before tensor 36864 mask 3771.0 36864
layer1.0.conv2.weight, mask/weight parameters,3771,3771 density 0.18967858759619738,0.18967858759619738
before tensor 16384 mask 3873.0 16384
layer1.0.conv3.weight, mask/weight parameters,3873,3873 density 0.3218916223404255,0.3218916223404255
layer1.0.shortcut.0.weight, mask/weight parameters,5656,5656 density 0.34521484375,0.34521484375
before tensor 16384 mask 2485.0 16384
layer1.1.conv1.weight, mask/weight parameters,2485,2485 density 0.20653257978723405,0.20653257978723405
before tensor 36864 mask 4093.0 36864
layer1.1.conv2.weight, mask/weight parameters,4093,4093 density 0.20587495598812938,0.20587495598812938
before tensor 16384 mask 2281.0 16384
layer1.1.conv3.weight, mask/weight parameters,2281,2281 density 0.1895777925531915,0.1895777925531915
before tensor 16384 mask 2944.0 16384
layer1.2.conv1.weight, mask/weight parameters,2944,2944 density 0.24468085106382978,0.24468085106382978
before tensor 36864 mask 3500.0 36864
layer1.2.conv2.weight, mask/weight parameters,3500,3500 density 0.17604748252099994,0.17604748252099994
before tensor 16384 mask 1923.0 16384
layer1.2.conv3.weight, mask/weight parameters,1923,1923 density 0.15982380319148937,0.15982380319148937
before tensor 32768 mask 5415.0 32768
layer2.0.conv1.weight, mask/weight parameters,5415,5415 density 0.28203125,0.28203125
before tensor 147456 mask 12629.0 147456
layer2.0.conv2.weight, mask/weight parameters,12629,12629 density 0.24946172839506173,0.24946172839506173
before tensor 65536 mask 7037.0 65536
layer2.0.conv3.weight, mask/weight parameters,7037,7037 density 0.18325520833333334,0.18325520833333334
layer2.0.shortcut.0.weight, mask/weight parameters,30589,30589 density 0.23337554931640625,0.23337554931640625
before tensor 65536 mask 3702.0 65536
layer2.1.conv1.weight, mask/weight parameters,3702,3702 density 0.09640625,0.09640625
before tensor 147456 mask 4202.0 147456
layer2.1.conv2.weight, mask/weight parameters,4202,4202 density 0.08300246913580248,0.08300246913580248
before tensor 65536 mask 4228.0 65536
layer2.1.conv3.weight, mask/weight parameters,4228,4228 density 0.11010416666666667,0.11010416666666667
before tensor 65536 mask 10659.0 65536
layer2.2.conv1.weight, mask/weight parameters,10659,10659 density 0.277578125,0.277578125
before tensor 147456 mask 21726.0 147456
layer2.2.conv2.weight, mask/weight parameters,21726,21726 density 0.42915555555555557,0.42915555555555557
before tensor 65536 mask 13483.0 65536
layer2.2.conv3.weight, mask/weight parameters,13483,13483 density 0.3511197916666667,0.3511197916666667
before tensor 65536 mask 10875.0 65536
layer2.3.conv1.weight, mask/weight parameters,10875,10875 density 0.283203125,0.283203125
before tensor 147456 mask 20691.0 147456
layer2.3.conv2.weight, mask/weight parameters,20691,20691 density 0.40871111111111114,0.40871111111111114
before tensor 65536 mask 11360.0 65536
layer2.3.conv3.weight, mask/weight parameters,11360,11360 density 0.29583333333333334,0.29583333333333334
before tensor 131072 mask 29705.0 131072
layer3.0.conv1.weight, mask/weight parameters,29705,29705 density 0.4568313238188976,0.4568313238188976
before tensor 589824 mask 63474.0 589824
layer3.0.conv2.weight, mask/weight parameters,63474,63474 density 0.43726620786574905,0.43726620786574905
before tensor 262144 mask 57905.0 262144
layer3.0.conv3.weight, mask/weight parameters,57905,57905 density 0.44525867372047245,0.44525867372047245
layer3.0.shortcut.0.weight, mask/weight parameters,100065,100065 density 0.1908588409423828,0.1908588409423828
before tensor 262144 mask 28232.0 262144
layer3.1.conv1.weight, mask/weight parameters,28232,28232 density 0.2170890748031496,0.2170890748031496
before tensor 589824 mask 60352.0 589824
layer3.1.conv2.weight, mask/weight parameters,60352,60352 density 0.4157590537403297,0.4157590537403297
before tensor 262144 mask 50984.0 262144
layer3.1.conv3.weight, mask/weight parameters,50984,50984 density 0.3920398622047244,0.3920398622047244
before tensor 262144 mask 30206.0 262144
layer3.2.conv1.weight, mask/weight parameters,30206,30206 density 0.23226808562992127,0.23226808562992127
before tensor 589824 mask 53586.0 589824
layer3.2.conv2.weight, mask/weight parameters,53586,53586 density 0.3691487382974766,0.3691487382974766
before tensor 262144 mask 49818.0 262144
layer3.2.conv3.weight, mask/weight parameters,49818,49818 density 0.38307394192913385,0.38307394192913385
before tensor 262144 mask 33743.0 262144
layer3.3.conv1.weight, mask/weight parameters,33743,33743 density 0.25946573572834647,0.25946573572834647
before tensor 589824 mask 47915.0 589824
layer3.3.conv2.weight, mask/weight parameters,47915,47915 density 0.33008177127465366,0.33008177127465366
before tensor 262144 mask 43088.0 262144
layer3.3.conv3.weight, mask/weight parameters,43088,43088 density 0.3313238188976378,0.3313238188976378
before tensor 262144 mask 38911.0 262144
layer3.4.conv1.weight, mask/weight parameters,38911,38911 density 0.29920490895669294,0.29920490895669294
before tensor 589824 mask 49186.0 589824
layer3.4.conv2.weight, mask/weight parameters,49186,49186 density 0.33883756656402203,0.33883756656402203
before tensor 262144 mask 40596.0 262144
layer3.4.conv3.weight, mask/weight parameters,40596,40596 density 0.3121616633858268,0.3121616633858268
before tensor 262144 mask 44734.0 262144
layer3.5.conv1.weight, mask/weight parameters,44734,44734 density 0.3439806840551181,0.3439806840551181
before tensor 589824 mask 48676.0 589824
layer3.5.conv2.weight, mask/weight parameters,48676,48676 density 0.335324226204008,0.335324226204008
before tensor 262144 mask 39492.0 262144
layer3.5.conv3.weight, mask/weight parameters,39492,39492 density 0.3036724901574803,0.3036724901574803
before tensor 524288 mask 134315.0 524288
layer4.0.conv1.weight, mask/weight parameters,134315,134315 density 0.5629484643240343,0.5629484643240343
before tensor 2359296 mask 198212.0 2359296
layer4.0.conv2.weight, mask/weight parameters,198212,198212 density 0.40567252216020844,0.40567252216020844
before tensor 1048576 mask 104610.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104610,104610 density 0.2192236118562232,0.2192236118562232
layer4.0.shortcut.0.weight, mask/weight parameters,144444,144444 density 0.06887626647949219,0.06887626647949219
before tensor 1048576 mask 117410.0 1048576
layer4.1.conv1.weight, mask/weight parameters,117410,117410 density 0.24604764619098712,0.24604764619098712
before tensor 2359296 mask 190597.0 2359296
layer4.1.conv2.weight, mask/weight parameters,190597,190597 density 0.39008720817190307,0.39008720817190307
before tensor 1048576 mask 84168.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84168,84168 density 0.1763847907725322,0.1763847907725322
before tensor 1048576 mask 80121.0 1048576
layer4.2.conv1.weight, mask/weight parameters,80121,80121 density 0.16790378554184548,0.16790378554184548
before tensor 2359296 mask 69489.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69489,69489 density 0.14222033929525318,0.14222033929525318
before tensor 1048576 mask 35572.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35572,35572 density 0.07454566791845493,0.07454566791845493
classifier.weight, mask/weight parameters,106628,106628 density 0.52064453125,0.52064453125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.2354476123201794 0.2354476123201794 after dst
Death rate: 0.1023281409787368

dynamic sparse change grow
self.total_params*pruning_rate 2420268.464929594
self.total_nonzero 2365205.0
to grow 55063.46492959419
len(all_scores) 10045568 6699240
increse 55063.0 before_mask 2420267.0 after_mask 2420267.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1180,1170 density 0.6828703703703703,0.6770833333333334
before tensor 4096 mask 683.0 4096
layer1.0.conv1.weight, mask/weight parameters,683,679 density 0.22706117021276595,0.22573138297872342
before tensor 36864 mask 3823.0 36864
layer1.0.conv2.weight, mask/weight parameters,3823,3771 density 0.19229415019365223,0.18967858759619738
before tensor 16384 mask 3948.0 16384
layer1.0.conv3.weight, mask/weight parameters,3948,3873 density 0.328125,0.3218916223404255
layer1.0.shortcut.0.weight, mask/weight parameters,5727,5656 density 0.34954833984375,0.34521484375
before tensor 16384 mask 2502.0 16384
layer1.1.conv1.weight, mask/weight parameters,2502,2485 density 0.20794547872340424,0.20653257978723405
before tensor 36864 mask 4133.0 36864
layer1.1.conv2.weight, mask/weight parameters,4133,4093 density 0.2078869272169408,0.20587495598812938
before tensor 16384 mask 2311.0 16384
layer1.1.conv3.weight, mask/weight parameters,2311,2281 density 0.19207114361702127,0.1895777925531915
before tensor 16384 mask 2970.0 16384
layer1.2.conv1.weight, mask/weight parameters,2970,2944 density 0.24684175531914893,0.24468085106382978
before tensor 36864 mask 3548.0 36864
layer1.2.conv2.weight, mask/weight parameters,3548,3500 density 0.17846184799557366,0.17604748252099994
before tensor 16384 mask 1949.0 16384
layer1.2.conv3.weight, mask/weight parameters,1949,1923 density 0.1619847074468085,0.15982380319148937
before tensor 32768 mask 5484.0 32768
layer2.0.conv1.weight, mask/weight parameters,5484,5415 density 0.285625,0.28203125
before tensor 147456 mask 12826.0 147456
layer2.0.conv2.weight, mask/weight parameters,12826,12629 density 0.25335308641975307,0.24946172839506173
before tensor 65536 mask 7180.0 65536
layer2.0.conv3.weight, mask/weight parameters,7180,7037 density 0.18697916666666667,0.18325520833333334
layer2.0.shortcut.0.weight, mask/weight parameters,31158,30589 density 0.2377166748046875,0.23337554931640625
before tensor 65536 mask 3755.0 65536
layer2.1.conv1.weight, mask/weight parameters,3755,3702 density 0.09778645833333334,0.09640625
before tensor 147456 mask 4273.0 147456
layer2.1.conv2.weight, mask/weight parameters,4273,4202 density 0.08440493827160493,0.08300246913580248
before tensor 65536 mask 4261.0 65536
layer2.1.conv3.weight, mask/weight parameters,4261,4228 density 0.11096354166666667,0.11010416666666667
before tensor 65536 mask 10800.0 65536
layer2.2.conv1.weight, mask/weight parameters,10800,10659 density 0.28125,0.277578125
before tensor 147456 mask 22036.0 147456
layer2.2.conv2.weight, mask/weight parameters,22036,21726 density 0.435279012345679,0.42915555555555557
before tensor 65536 mask 13694.0 65536
layer2.2.conv3.weight, mask/weight parameters,13694,13483 density 0.35661458333333335,0.3511197916666667
before tensor 65536 mask 10952.0 65536
layer2.3.conv1.weight, mask/weight parameters,10952,10875 density 0.28520833333333334,0.283203125
before tensor 147456 mask 20890.0 147456
layer2.3.conv2.weight, mask/weight parameters,20890,20691 density 0.412641975308642,0.40871111111111114
before tensor 65536 mask 11487.0 65536
layer2.3.conv3.weight, mask/weight parameters,11487,11360 density 0.299140625,0.29583333333333334
before tensor 131072 mask 30158.0 131072
layer3.0.conv1.weight, mask/weight parameters,30158,29705 density 0.4637979822834646,0.4568313238188976
before tensor 589824 mask 64129.0 589824
layer3.0.conv2.weight, mask/weight parameters,64129,63474 density 0.4417784391124338,0.43726620786574905
before tensor 262144 mask 58794.0 262144
layer3.0.conv3.weight, mask/weight parameters,58794,57905 density 0.45209461122047245,0.44525867372047245
layer3.0.shortcut.0.weight, mask/weight parameters,101355,100065 density 0.19331932067871094,0.1908588409423828
before tensor 262144 mask 28650.0 262144
layer3.1.conv1.weight, mask/weight parameters,28650,28232 density 0.22030327263779528,0.2170890748031496
before tensor 589824 mask 61674.0 589824
layer3.1.conv2.weight, mask/weight parameters,61674,60352 density 0.42486618306569945,0.4157590537403297
before tensor 262144 mask 52260.0 262144
layer3.1.conv3.weight, mask/weight parameters,52260,50984 density 0.40185162401574803,0.3920398622047244
before tensor 262144 mask 30721.0 262144
layer3.2.conv1.weight, mask/weight parameters,30721,30206 density 0.2362281619094488,0.23226808562992127
before tensor 589824 mask 54271.0 589824
layer3.2.conv2.weight, mask/weight parameters,54271,53586 density 0.3738676366241621,0.3691487382974766
before tensor 262144 mask 50815.0 262144
layer3.2.conv3.weight, mask/weight parameters,50815,49818 density 0.39074034202755903,0.38307394192913385
before tensor 262144 mask 34468.0 262144
layer3.3.conv1.weight, mask/weight parameters,34468,33743 density 0.2650406003937008,0.25946573572834647
before tensor 589824 mask 48896.0 589824
layer3.3.conv2.weight, mask/weight parameters,48896,47915 density 0.3368397847906807,0.33008177127465366
before tensor 262144 mask 44050.0 262144
layer3.3.conv3.weight, mask/weight parameters,44050,43088 density 0.3387210875984252,0.3313238188976378
before tensor 262144 mask 39614.0 262144
layer3.4.conv1.weight, mask/weight parameters,39614,38911 density 0.30461060531496065,0.29920490895669294
before tensor 589824 mask 50263.0 589824
layer3.4.conv2.weight, mask/weight parameters,50263,49186 density 0.3462569147360517,0.33883756656402203
before tensor 262144 mask 41414.0 262144
layer3.4.conv3.weight, mask/weight parameters,41414,40596 density 0.3184516486220472,0.3121616633858268
before tensor 262144 mask 45804.0 262144
layer3.5.conv1.weight, mask/weight parameters,45804,44734 density 0.35220841535433073,0.3439806840551181
before tensor 589824 mask 49831.0 589824
layer3.5.conv2.weight, mask/weight parameters,49831,48676 density 0.3432809087840398,0.335324226204008
before tensor 262144 mask 40347.0 262144
layer3.5.conv3.weight, mask/weight parameters,40347,39492 density 0.31024698572834647,0.3036724901574803
before tensor 524288 mask 137402.0 524288
layer4.0.conv1.weight, mask/weight parameters,137402,134315 density 0.5758868696351931,0.5629484643240343
before tensor 2359296 mask 204380.0 2359296
layer4.0.conv2.weight, mask/weight parameters,204380,198212 density 0.4182963194917734,0.40567252216020844
before tensor 1048576 mask 107601.0 1048576
layer4.0.conv3.weight, mask/weight parameters,107601,104610 density 0.22549163425429183,0.2192236118562232
layer4.0.shortcut.0.weight, mask/weight parameters,146826,144444 density 0.07001209259033203,0.06887626647949219
before tensor 1048576 mask 120879.0 1048576
layer4.1.conv1.weight, mask/weight parameters,120879,117410 density 0.25331737862124465,0.24604764619098712
before tensor 2359296 mask 197348.0 2359296
layer4.1.conv2.weight, mask/weight parameters,197348,190597 density 0.4039042081371098,0.39008720817190307
before tensor 1048576 mask 86610.0 1048576
layer4.1.conv3.weight, mask/weight parameters,86610,84168 density 0.18150231357296137,0.1763847907725322
before tensor 1048576 mask 83579.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83579,80121 density 0.17515046606759657,0.16790378554184548
before tensor 2359296 mask 72686.0 2359296
layer4.2.conv2.weight, mask/weight parameters,72686,69489 density 0.1487635105126678,0.14222033929525318
before tensor 1048576 mask 36805.0 1048576
layer4.2.conv3.weight, mask/weight parameters,36805,35572 density 0.07712957685085838,0.07454566791845493
classifier.weight, mask/weight parameters,107067,106628 density 0.5227880859375,0.52064453125
Total Model parameters after dst: 2420267 2365205
Total parameters under density level of 0.1: 0.24092883548247346 0.2354476123201794 after dst
Death rate: 0.1023281409787368


Training summary: Average loss: 0.3457, Accuracy: 44629/50000 (89.258%)


Evaluation: Average loss: 1.0926, Accuracy: 7264/10000 (72.640%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.73 seconds.

Train Epoch: 112 [0/50000 (0%)]	Loss: 0.341438 Accuracy: 87/100 (87.000%
Train Epoch: 112 [10000/50000 (20%)]	Loss: 0.454921 Accuracy: 9146/10100 (90.554%
Train Epoch: 112 [20000/50000 (40%)]	Loss: 0.280628 Accuracy: 18205/20100 (90.572%
Train Epoch: 112 [30000/50000 (60%)]	Loss: 0.194954 Accuracy: 27098/30100 (90.027%
Train Epoch: 112 [40000/50000 (80%)]	Loss: 0.541414 Accuracy: 35996/40100 (89.766%
current layer rate 0.49888188438780157
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3804.0
Total filter_masks items: 7070144.0
3804.0 / 7552 channels
Total channels to prune: 19.555990896677486
Layer ('layer4', 0, 'conv1'): Pruned 1/233.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/233.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/233.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/233.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/233.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/233.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3798.0
Total filter_masks items: 7046325.0
After apply_mask:
Total filter_names items: 3798.0
Total filter_masks items: 7046325.0
Total pruned: 6/19.555990896677486 channels
===========done ===============

Training summary: Average loss: 0.3385, Accuracy: 44734/50000 (89.468%)


Evaluation: Average loss: 1.1502, Accuracy: 7121/10000 (71.210%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.55 seconds.

Train Epoch: 113 [0/50000 (0%)]	Loss: 0.281682 Accuracy: 93/100 (93.000%
Train Epoch: 113 [10000/50000 (20%)]	Loss: 0.312675 Accuracy: 9159/10100 (90.683%
Train Epoch: 113 [20000/50000 (40%)]	Loss: 0.381070 Accuracy: 18144/20100 (90.269%
Train Epoch: 113 [30000/50000 (60%)]	Loss: 0.399196 Accuracy: 27139/30100 (90.163%
Train Epoch: 113 [40000/50000 (80%)]	Loss: 0.420683 Accuracy: 36035/40100 (89.863%
current mest  death_rate 0.10184563377605589


dynamic sparse change prune
to kill 46781.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1175,1175 density 0.6799768518518519,0.6799768518518519
before tensor 4096 mask 676.0 4096
layer1.0.conv1.weight, mask/weight parameters,676,676 density 0.2247340425531915,0.2247340425531915
before tensor 36864 mask 3780.0 36864
layer1.0.conv2.weight, mask/weight parameters,3780,3780 density 0.19013128112267993,0.19013128112267993
before tensor 16384 mask 3892.0 16384
layer1.0.conv3.weight, mask/weight parameters,3892,3892 density 0.3234707446808511,0.3234707446808511
layer1.0.shortcut.0.weight, mask/weight parameters,5641,5641 density 0.34429931640625,0.34429931640625
before tensor 16384 mask 2466.0 16384
layer1.1.conv1.weight, mask/weight parameters,2466,2466 density 0.2049534574468085,0.2049534574468085
before tensor 36864 mask 4089.0 36864
layer1.1.conv2.weight, mask/weight parameters,4089,4089 density 0.20567375886524822,0.20567375886524822
before tensor 16384 mask 2277.0 16384
layer1.1.conv3.weight, mask/weight parameters,2277,2277 density 0.18924534574468085,0.18924534574468085
before tensor 16384 mask 2915.0 16384
layer1.2.conv1.weight, mask/weight parameters,2915,2915 density 0.24227061170212766,0.24227061170212766
before tensor 36864 mask 3502.0 36864
layer1.2.conv2.weight, mask/weight parameters,3502,3502 density 0.1761480810824405,0.1761480810824405
before tensor 16384 mask 1909.0 16384
layer1.2.conv3.weight, mask/weight parameters,1909,1909 density 0.15866023936170212,0.15866023936170212
before tensor 32768 mask 5372.0 32768
layer2.0.conv1.weight, mask/weight parameters,5372,5372 density 0.27979166666666666,0.27979166666666666
before tensor 147456 mask 12662.0 147456
layer2.0.conv2.weight, mask/weight parameters,12662,12662 density 0.2501135802469136,0.2501135802469136
before tensor 65536 mask 7066.0 65536
layer2.0.conv3.weight, mask/weight parameters,7066,7066 density 0.18401041666666668,0.18401041666666668
layer2.0.shortcut.0.weight, mask/weight parameters,30557,30557 density 0.23313140869140625,0.23313140869140625
before tensor 65536 mask 3674.0 65536
layer2.1.conv1.weight, mask/weight parameters,3674,3674 density 0.09567708333333333,0.09567708333333333
before tensor 147456 mask 4217.0 147456
layer2.1.conv2.weight, mask/weight parameters,4217,4217 density 0.08329876543209877,0.08329876543209877
before tensor 65536 mask 4204.0 65536
layer2.1.conv3.weight, mask/weight parameters,4204,4204 density 0.10947916666666667,0.10947916666666667
before tensor 65536 mask 10623.0 65536
layer2.2.conv1.weight, mask/weight parameters,10623,10623 density 0.276640625,0.276640625
before tensor 147456 mask 21655.0 147456
layer2.2.conv2.weight, mask/weight parameters,21655,21655 density 0.42775308641975307,0.42775308641975307
before tensor 65536 mask 13450.0 65536
layer2.2.conv3.weight, mask/weight parameters,13450,13450 density 0.3502604166666667,0.3502604166666667
before tensor 65536 mask 10768.0 65536
layer2.3.conv1.weight, mask/weight parameters,10768,10768 density 0.28041666666666665,0.28041666666666665
before tensor 147456 mask 20583.0 147456
layer2.3.conv2.weight, mask/weight parameters,20583,20583 density 0.40657777777777776,0.40657777777777776
before tensor 65536 mask 11307.0 65536
layer2.3.conv3.weight, mask/weight parameters,11307,11307 density 0.294453125,0.294453125
before tensor 131072 mask 29638.0 131072
layer3.0.conv1.weight, mask/weight parameters,29638,29638 density 0.4558009350393701,0.4558009350393701
before tensor 589824 mask 63037.0 589824
layer3.0.conv2.weight, mask/weight parameters,63037,63037 density 0.4342557574004037,0.4342557574004037
before tensor 262144 mask 57819.0 262144
layer3.0.conv3.weight, mask/weight parameters,57819,57819 density 0.44459737942913385,0.44459737942913385
layer3.0.shortcut.0.weight, mask/weight parameters,99452,99452 density 0.18968963623046875,0.18968963623046875
before tensor 262144 mask 28150.0 262144
layer3.1.conv1.weight, mask/weight parameters,28150,28150 density 0.21645853838582677,0.21645853838582677
before tensor 589824 mask 60427.0 589824
layer3.1.conv2.weight, mask/weight parameters,60427,60427 density 0.41627572144033176,0.41627572144033176
before tensor 262144 mask 51236.0 262144
layer3.1.conv3.weight, mask/weight parameters,51236,51236 density 0.39397760826771655,0.39397760826771655
before tensor 262144 mask 30137.0 262144
layer3.2.conv1.weight, mask/weight parameters,30137,30137 density 0.2317375123031496,0.2317375123031496
before tensor 589824 mask 53215.0 589824
layer3.2.conv2.weight, mask/weight parameters,53215,53215 density 0.366592955408133,0.366592955408133
before tensor 262144 mask 49797.0 262144
layer3.2.conv3.weight, mask/weight parameters,49797,49797 density 0.38291246309055116,0.38291246309055116
before tensor 262144 mask 33714.0 262144
layer3.3.conv1.weight, mask/weight parameters,33714,33714 density 0.2592427411417323,0.2592427411417323
before tensor 589824 mask 47950.0 589824
layer3.3.conv2.weight, mask/weight parameters,47950,47950 density 0.33032288286798794,0.33032288286798794
before tensor 262144 mask 43182.0 262144
layer3.3.conv3.weight, mask/weight parameters,43182,43182 density 0.33204662893700787,0.33204662893700787
before tensor 262144 mask 38791.0 262144
layer3.4.conv1.weight, mask/weight parameters,38791,38791 density 0.2982821727362205,0.2982821727362205
before tensor 589824 mask 49210.0 589824
layer3.4.conv2.weight, mask/weight parameters,49210,49210 density 0.33900290022802265,0.33900290022802265
before tensor 262144 mask 40555.0 262144
layer3.4.conv3.weight, mask/weight parameters,40555,40555 density 0.31184639517716534,0.31184639517716534
before tensor 262144 mask 44876.0 262144
layer3.5.conv1.weight, mask/weight parameters,44876,44876 density 0.34507258858267714,0.34507258858267714
before tensor 589824 mask 48873.0 589824
layer3.5.conv2.weight, mask/weight parameters,48873,48873 density 0.33668134002934674,0.33668134002934674
before tensor 262144 mask 39551.0 262144
layer3.5.conv3.weight, mask/weight parameters,39551,39551 density 0.3041261687992126,0.3041261687992126
before tensor 524288 mask 134441.0 524288
layer4.0.conv1.weight, mask/weight parameters,134441,134441 density 0.5659053407866379,0.5659053407866379
before tensor 2359296 mask 198138.0 2359296
layer4.0.conv2.weight, mask/weight parameters,198138,198138 density 0.40902447483154974,0.40902447483154974
before tensor 1048576 mask 104641.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104641,104641 density 0.2202337856950431,0.2202337856950431
layer4.0.shortcut.0.weight, mask/weight parameters,143668,143668 density 0.06850624084472656,0.06850624084472656
before tensor 1048576 mask 117706.0 1048576
layer4.1.conv1.weight, mask/weight parameters,117706,117706 density 0.2477311759159483,0.2477311759159483
before tensor 2359296 mask 191681.0 2359296
layer4.1.conv2.weight, mask/weight parameters,191681,191681 density 0.39569502246003435,0.39569502246003435
before tensor 1048576 mask 84336.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84336,84336 density 0.17749865301724138,0.17749865301724138
before tensor 1048576 mask 80874.0 1048576
layer4.2.conv1.weight, mask/weight parameters,80874,80874 density 0.1702123181573276,0.1702123181573276
before tensor 2359296 mask 69333.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69333,69333 density 0.14312698176773683,0.14312698176773683
before tensor 1048576 mask 35636.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35636,35636 density 0.07500168372844827,0.07500168372844827
classifier.weight, mask/weight parameters,106681,106681 density 0.5209033203125,0.5209033203125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.2360072079234872 0.2360072079234872 after dst
Death rate: 0.10184563377605589

dynamic sparse change grow
self.total_params*pruning_rate 2408856.1891315547
self.total_nonzero 2365205.0
to grow 43651.18913155468
len(all_scores) 10021749 6675792
increse 43651.0 before_mask 2408855.0 after_mask 2408855.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1185,1175 density 0.6857638888888888,0.6799768518518519
before tensor 4096 mask 680.0 4096
layer1.0.conv1.weight, mask/weight parameters,680,676 density 0.22606382978723405,0.2247340425531915
before tensor 36864 mask 3814.0 36864
layer1.0.conv2.weight, mask/weight parameters,3814,3780 density 0.19184145666716965,0.19013128112267993
before tensor 16384 mask 3939.0 16384
layer1.0.conv3.weight, mask/weight parameters,3939,3892 density 0.3273769946808511,0.3234707446808511
layer1.0.shortcut.0.weight, mask/weight parameters,5726,5641 density 0.3494873046875,0.34429931640625
before tensor 16384 mask 2527.0 16384
layer1.1.conv1.weight, mask/weight parameters,2527,2466 density 0.21002327127659576,0.2049534574468085
before tensor 36864 mask 4106.0 36864
layer1.1.conv2.weight, mask/weight parameters,4106,4089 density 0.20652884663749307,0.20567375886524822
before tensor 16384 mask 2293.0 16384
layer1.1.conv3.weight, mask/weight parameters,2293,2277 density 0.19057513297872342,0.18924534574468085
before tensor 16384 mask 2938.0 16384
layer1.2.conv1.weight, mask/weight parameters,2938,2915 density 0.24418218085106383,0.24227061170212766
before tensor 36864 mask 3526.0 36864
layer1.2.conv2.weight, mask/weight parameters,3526,3502 density 0.17735526381972738,0.1761480810824405
before tensor 16384 mask 1925.0 16384
layer1.2.conv3.weight, mask/weight parameters,1925,1909 density 0.15999002659574468,0.15866023936170212
before tensor 32768 mask 5529.0 32768
layer2.0.conv1.weight, mask/weight parameters,5529,5372 density 0.28796875,0.27979166666666666
before tensor 147456 mask 12785.0 147456
layer2.0.conv2.weight, mask/weight parameters,12785,12662 density 0.2525432098765432,0.2501135802469136
before tensor 65536 mask 7155.0 65536
layer2.0.conv3.weight, mask/weight parameters,7155,7066 density 0.186328125,0.18401041666666668
layer2.0.shortcut.0.weight, mask/weight parameters,30971,30557 density 0.23628997802734375,0.23313140869140625
before tensor 65536 mask 3713.0 65536
layer2.1.conv1.weight, mask/weight parameters,3713,3674 density 0.09669270833333334,0.09567708333333333
before tensor 147456 mask 4248.0 147456
layer2.1.conv2.weight, mask/weight parameters,4248,4217 density 0.08391111111111112,0.08329876543209877
before tensor 65536 mask 4274.0 65536
layer2.1.conv3.weight, mask/weight parameters,4274,4204 density 0.11130208333333333,0.10947916666666667
before tensor 65536 mask 10739.0 65536
layer2.2.conv1.weight, mask/weight parameters,10739,10623 density 0.27966145833333333,0.276640625
before tensor 147456 mask 21948.0 147456
layer2.2.conv2.weight, mask/weight parameters,21948,21655 density 0.4335407407407407,0.42775308641975307
before tensor 65536 mask 13721.0 65536
layer2.2.conv3.weight, mask/weight parameters,13721,13450 density 0.3573177083333333,0.3502604166666667
before tensor 65536 mask 10898.0 65536
layer2.3.conv1.weight, mask/weight parameters,10898,10768 density 0.28380208333333334,0.28041666666666665
before tensor 147456 mask 20762.0 147456
layer2.3.conv2.weight, mask/weight parameters,20762,20583 density 0.4101135802469136,0.40657777777777776
before tensor 65536 mask 11424.0 65536
layer2.3.conv3.weight, mask/weight parameters,11424,11307 density 0.2975,0.294453125
before tensor 131072 mask 30233.0 131072
layer3.0.conv1.weight, mask/weight parameters,30233,29638 density 0.4649514025590551,0.4558009350393701
before tensor 589824 mask 63714.0 589824
layer3.0.conv2.weight, mask/weight parameters,63714,63037 density 0.43891954450575565,0.4342557574004037
before tensor 262144 mask 58574.0 262144
layer3.0.conv3.weight, mask/weight parameters,58574,57819 density 0.4504029281496063,0.44459737942913385
layer3.0.shortcut.0.weight, mask/weight parameters,100819,99452 density 0.19229698181152344,0.18968963623046875
before tensor 262144 mask 28501.0 262144
layer3.1.conv1.weight, mask/weight parameters,28501,28150 density 0.21915754183070865,0.21645853838582677
before tensor 589824 mask 61351.0 589824
layer3.1.conv2.weight, mask/weight parameters,61351,60427 density 0.4226410675043572,0.41627572144033176
before tensor 262144 mask 52200.0 262144
layer3.1.conv3.weight, mask/weight parameters,52200,51236 density 0.4013902559055118,0.39397760826771655
before tensor 262144 mask 30580.0 262144
layer3.2.conv1.weight, mask/weight parameters,30580,30137 density 0.2351439468503937,0.2317375123031496
before tensor 589824 mask 54250.0 589824
layer3.2.conv2.weight, mask/weight parameters,54250,53215 density 0.37372296966816154,0.366592955408133
before tensor 262144 mask 51076.0 262144
layer3.2.conv3.weight, mask/weight parameters,51076,49797 density 0.39274729330708663,0.38291246309055116
before tensor 262144 mask 34331.0 262144
layer3.3.conv1.weight, mask/weight parameters,34331,33714 density 0.2639871432086614,0.2592427411417323
before tensor 589824 mask 48617.0 589824
layer3.3.conv2.weight, mask/weight parameters,48617,47950 density 0.334917780946673,0.33032288286798794
before tensor 262144 mask 43991.0 262144
layer3.3.conv3.weight, mask/weight parameters,43991,43182 density 0.33826740895669294,0.33204662893700787
before tensor 262144 mask 39257.0 262144
layer3.4.conv1.weight, mask/weight parameters,39257,38791 density 0.3018654650590551,0.2982821727362205
before tensor 589824 mask 49915.0 589824
layer3.4.conv2.weight, mask/weight parameters,49915,49210 density 0.3438595766080421,0.33900290022802265
before tensor 262144 mask 41072.0 262144
layer3.4.conv3.weight, mask/weight parameters,41072,40555 density 0.3158218503937008,0.31184639517716534
before tensor 262144 mask 45701.0 262144
layer3.5.conv1.weight, mask/weight parameters,45701,44876 density 0.3514164000984252,0.34507258858267714
before tensor 589824 mask 49569.0 589824
layer3.5.conv2.weight, mask/weight parameters,49569,48873 density 0.3414760162853659,0.33668134002934674
before tensor 262144 mask 40175.0 262144
layer3.5.conv3.weight, mask/weight parameters,40175,39551 density 0.30892439714566927,0.3041261687992126
before tensor 524288 mask 137138.0 524288
layer4.0.conv1.weight, mask/weight parameters,137138,134441 density 0.5772578798491379,0.5659053407866379
before tensor 2359296 mask 202165.0 2359296
layer4.0.conv2.weight, mask/weight parameters,202165,198138 density 0.41733757761923634,0.40902447483154974
before tensor 1048576 mask 106695.0 1048576
layer4.0.conv3.weight, mask/weight parameters,106695,104641 density 0.22455675848599138,0.2202337856950431
layer4.0.shortcut.0.weight, mask/weight parameters,146478,143668 density 0.06984615325927734,0.06850624084472656
before tensor 1048576 mask 121010.0 1048576
layer4.1.conv1.weight, mask/weight parameters,121010,117706 density 0.25468497440732757,0.2477311759159483
before tensor 2359296 mask 196598.0 2359296
layer4.1.conv2.weight, mask/weight parameters,196598,191681 density 0.4058453890870657,0.39569502246003435
before tensor 1048576 mask 85775.0 1048576
layer4.1.conv3.weight, mask/weight parameters,85775,84336 density 0.1805272595635776,0.17749865301724138
before tensor 1048576 mask 83017.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83017,80874 density 0.17472260573814655,0.1702123181573276
before tensor 2359296 mask 71786.0 2359296
layer4.2.conv2.weight, mask/weight parameters,71786,69333 density 0.1481908112035936,0.14312698176773683
before tensor 1048576 mask 36538.0 1048576
layer4.2.conv3.weight, mask/weight parameters,36538,35636 density 0.07690008755387931,0.07500168372844827
classifier.weight, mask/weight parameters,106903,106681 density 0.5219873046875,0.5209033203125
Total Model parameters after dst: 2408855 2365205
Total parameters under density level of 0.1: 0.24036273508745828 0.2360072079234872 after dst
Death rate: 0.10184563377605589


Training summary: Average loss: 0.3353, Accuracy: 44772/50000 (89.544%)


Evaluation: Average loss: 1.0624, Accuracy: 7241/10000 (72.410%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.74 seconds.

Train Epoch: 114 [0/50000 (0%)]	Loss: 0.436732 Accuracy: 85/100 (85.000%
Train Epoch: 114 [10000/50000 (20%)]	Loss: 0.213814 Accuracy: 9153/10100 (90.624%
Train Epoch: 114 [20000/50000 (40%)]	Loss: 0.259997 Accuracy: 18204/20100 (90.567%
Train Epoch: 114 [30000/50000 (60%)]	Loss: 0.505013 Accuracy: 27146/30100 (90.186%
Train Epoch: 114 [40000/50000 (80%)]	Loss: 0.468242 Accuracy: 36023/40100 (89.833%
current layer rate 0.4992319071461083
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3798.0
Total filter_masks items: 7046325.0
3798.0 / 7552 channels
Total channels to prune: 16.199362767410094
update_filter_mask
After update_filter_mask:
Total filter_names items: 3798.0
Total filter_masks items: 7046325.0
After apply_mask:
Total filter_names items: 3798.0
Total filter_masks items: 7046325.0
Total pruned: 0/16.199362767410094 channels
===========done ===============

Training summary: Average loss: 0.3314, Accuracy: 44790/50000 (89.580%)


Evaluation: Average loss: 1.1634, Accuracy: 7142/10000 (71.420%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.53 seconds.

Train Epoch: 115 [0/50000 (0%)]	Loss: 0.265615 Accuracy: 93/100 (93.000%
Train Epoch: 115 [10000/50000 (20%)]	Loss: 0.439071 Accuracy: 9120/10100 (90.297%
Train Epoch: 115 [20000/50000 (40%)]	Loss: 0.293095 Accuracy: 18115/20100 (90.124%
Train Epoch: 115 [30000/50000 (60%)]	Loss: 0.329175 Accuracy: 27057/30100 (89.890%
Train Epoch: 115 [40000/50000 (80%)]	Loss: 0.352133 Accuracy: 35928/40100 (89.596%
current mest  death_rate 0.10141720466855662


dynamic sparse change prune
to kill 43651.79999999888 expect 2365203.200000001
conv1.weight, mask/weight parameters,1177,1177 density 0.6811342592592593,0.6811342592592593
before tensor 4096 mask 667.0 4096
layer1.0.conv1.weight, mask/weight parameters,667,667 density 0.22174202127659576,0.22174202127659576
before tensor 36864 mask 3770.0 36864
layer1.0.conv2.weight, mask/weight parameters,3770,3770 density 0.1896282883154771,0.1896282883154771
before tensor 16384 mask 3865.0 16384
layer1.0.conv3.weight, mask/weight parameters,3865,3865 density 0.32122672872340424,0.32122672872340424
layer1.0.shortcut.0.weight, mask/weight parameters,5634,5634 density 0.3438720703125,0.3438720703125
before tensor 16384 mask 2464.0 16384
layer1.1.conv1.weight, mask/weight parameters,2464,2464 density 0.2047872340425532,0.2047872340425532
before tensor 36864 mask 4058.0 36864
layer1.1.conv2.weight, mask/weight parameters,4058,4058 density 0.20411448116291936,0.20411448116291936
before tensor 16384 mask 2244.0 16384
layer1.1.conv3.weight, mask/weight parameters,2244,2244 density 0.18650265957446807,0.18650265957446807
before tensor 16384 mask 2886.0 16384
layer1.2.conv1.weight, mask/weight parameters,2886,2886 density 0.23986037234042554,0.23986037234042554
before tensor 36864 mask 3499.0 36864
layer1.2.conv2.weight, mask/weight parameters,3499,3499 density 0.17599718324027966,0.17599718324027966
before tensor 16384 mask 1885.0 16384
layer1.2.conv3.weight, mask/weight parameters,1885,1885 density 0.1566655585106383,0.1566655585106383
before tensor 32768 mask 5435.0 32768
layer2.0.conv1.weight, mask/weight parameters,5435,5435 density 0.2830729166666667,0.2830729166666667
before tensor 147456 mask 12646.0 147456
layer2.0.conv2.weight, mask/weight parameters,12646,12646 density 0.24979753086419754,0.24979753086419754
before tensor 65536 mask 7056.0 65536
layer2.0.conv3.weight, mask/weight parameters,7056,7056 density 0.18375,0.18375
layer2.0.shortcut.0.weight, mask/weight parameters,30428,30428 density 0.232147216796875,0.232147216796875
before tensor 65536 mask 3635.0 65536
layer2.1.conv1.weight, mask/weight parameters,3635,3635 density 0.09466145833333334,0.09466145833333334
before tensor 147456 mask 4201.0 147456
layer2.1.conv2.weight, mask/weight parameters,4201,4201 density 0.08298271604938272,0.08298271604938272
before tensor 65536 mask 4224.0 65536
layer2.1.conv3.weight, mask/weight parameters,4224,4224 density 0.11,0.11
before tensor 65536 mask 10592.0 65536
layer2.2.conv1.weight, mask/weight parameters,10592,10592 density 0.2758333333333333,0.2758333333333333
before tensor 147456 mask 21624.0 147456
layer2.2.conv2.weight, mask/weight parameters,21624,21624 density 0.42714074074074077,0.42714074074074077
before tensor 65536 mask 13478.0 65536
layer2.2.conv3.weight, mask/weight parameters,13478,13478 density 0.35098958333333335,0.35098958333333335
before tensor 65536 mask 10728.0 65536
layer2.3.conv1.weight, mask/weight parameters,10728,10728 density 0.279375,0.279375
before tensor 147456 mask 20470.0 147456
layer2.3.conv2.weight, mask/weight parameters,20470,20470 density 0.4043456790123457,0.4043456790123457
before tensor 65536 mask 11232.0 65536
layer2.3.conv3.weight, mask/weight parameters,11232,11232 density 0.2925,0.2925
before tensor 131072 mask 29699.0 131072
layer3.0.conv1.weight, mask/weight parameters,29699,29699 density 0.4567390501968504,0.4567390501968504
before tensor 589824 mask 62709.0 589824
layer3.0.conv2.weight, mask/weight parameters,62709,62709 density 0.43199619732572797,0.43199619732572797
before tensor 262144 mask 57618.0 262144
layer3.0.conv3.weight, mask/weight parameters,57618,57618 density 0.44305179625984253,0.44305179625984253
layer3.0.shortcut.0.weight, mask/weight parameters,98987,98987 density 0.18880271911621094,0.18880271911621094
before tensor 262144 mask 28046.0 262144
layer3.1.conv1.weight, mask/weight parameters,28046,28046 density 0.21565883366141733,0.21565883366141733
before tensor 589824 mask 60209.0 589824
layer3.1.conv2.weight, mask/weight parameters,60209,60209 density 0.4147739406589924,0.4147739406589924
before tensor 262144 mask 51310.0 262144
layer3.1.conv3.weight, mask/weight parameters,51310,51310 density 0.39454662893700787,0.39454662893700787
before tensor 262144 mask 29998.0 262144
layer3.2.conv1.weight, mask/weight parameters,29998,29998 density 0.23066867618110237,0.23066867618110237
before tensor 589824 mask 53300.0 589824
layer3.2.conv2.weight, mask/weight parameters,53300,53300 density 0.36717851213480207,0.36717851213480207
before tensor 262144 mask 50160.0 262144
layer3.2.conv3.weight, mask/weight parameters,50160,50160 density 0.3857037401574803,0.3857037401574803
before tensor 262144 mask 33718.0 262144
layer3.3.conv1.weight, mask/weight parameters,33718,33718 density 0.25927349901574803,0.25927349901574803
before tensor 589824 mask 47728.0 589824
layer3.3.conv2.weight, mask/weight parameters,47728,47728 density 0.32879354647598186,0.32879354647598186
before tensor 262144 mask 43181.0 262144
layer3.3.conv3.weight, mask/weight parameters,43181,43181 density 0.33203893946850394,0.33203893946850394
before tensor 262144 mask 38519.0 262144
layer3.4.conv1.weight, mask/weight parameters,38519,38519 density 0.2961906373031496,0.2961906373031496
before tensor 589824 mask 48981.0 589824
layer3.4.conv2.weight, mask/weight parameters,48981,48981 density 0.3374253415173497,0.3374253415173497
before tensor 262144 mask 40287.0 262144
layer3.4.conv3.weight, mask/weight parameters,40287,40287 density 0.30978561761811024,0.30978561761811024
before tensor 262144 mask 44838.0 262144
layer3.5.conv1.weight, mask/weight parameters,44838,44838 density 0.34478038877952755,0.34478038877952755
before tensor 589824 mask 48731.0 589824
layer3.5.conv2.weight, mask/weight parameters,48731,48731 density 0.33570311585067614,0.33570311585067614
before tensor 262144 mask 39442.0 262144
layer3.5.conv3.weight, mask/weight parameters,39442,39442 density 0.30328801673228345,0.30328801673228345
before tensor 524288 mask 134987.0 524288
layer4.0.conv1.weight, mask/weight parameters,134987,134987 density 0.5682036301185345,0.5682036301185345
before tensor 2359296 mask 198260.0 2359296
layer4.0.conv2.weight, mask/weight parameters,198260,198260 density 0.4092763244814374,0.4092763244814374
before tensor 1048576 mask 104531.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104531,104531 density 0.22000227303340517,0.22000227303340517
layer4.0.shortcut.0.weight, mask/weight parameters,143304,143304 density 0.06833267211914062,0.06833267211914062
before tensor 1048576 mask 118488.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118488,118488 density 0.24937702047413793,0.24937702047413793
before tensor 2359296 mask 192674.0 2359296
layer4.1.conv2.weight, mask/weight parameters,192674,192674 density 0.3977449134628088,0.3977449134628088
before tensor 1048576 mask 84212.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84212,84212 density 0.17723767510775862,0.17723767510775862
before tensor 1048576 mask 81011.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81011,81011 density 0.17050065665409483,0.17050065665409483
before tensor 2359296 mask 69963.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69963,69963 density 0.14442751684502575,0.14442751684502575
before tensor 1048576 mask 35865.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35865,35865 density 0.07548365099676724,0.07548365099676724
classifier.weight, mask/weight parameters,106551,106551 density 0.5202685546875,0.5202685546875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.2360072079234872 0.2360072079234872 after dst
Death rate: 0.10141720466855662

dynamic sparse change grow
self.total_params*pruning_rate 2398722.970171251
self.total_nonzero 2365205.0
to grow 33517.97017125087
len(all_scores) 10021749 6675671
increse 33517.0 before_mask 2398721.0 after_mask 2398721.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1182,1177 density 0.6840277777777778,0.6811342592592593
before tensor 4096 mask 675.0 4096
layer1.0.conv1.weight, mask/weight parameters,675,667 density 0.22440159574468085,0.22174202127659576
before tensor 36864 mask 3780.0 36864
layer1.0.conv2.weight, mask/weight parameters,3780,3770 density 0.19013128112267993,0.1896282883154771
before tensor 16384 mask 3895.0 16384
layer1.0.conv3.weight, mask/weight parameters,3895,3865 density 0.32372007978723405,0.32122672872340424
layer1.0.shortcut.0.weight, mask/weight parameters,5689,5634 density 0.34722900390625,0.3438720703125
before tensor 16384 mask 2482.0 16384
layer1.1.conv1.weight, mask/weight parameters,2482,2464 density 0.20628324468085107,0.2047872340425532
before tensor 36864 mask 4071.0 36864
layer1.1.conv2.weight, mask/weight parameters,4071,4058 density 0.20476837181228308,0.20411448116291936
before tensor 16384 mask 2265.0 16384
layer1.1.conv3.weight, mask/weight parameters,2265,2244 density 0.18824800531914893,0.18650265957446807
before tensor 16384 mask 2907.0 16384
layer1.2.conv1.weight, mask/weight parameters,2907,2886 density 0.2416057180851064,0.23986037234042554
before tensor 36864 mask 3514.0 36864
layer1.2.conv2.weight, mask/weight parameters,3514,3499 density 0.17675167245108395,0.17599718324027966
before tensor 16384 mask 1908.0 16384
layer1.2.conv3.weight, mask/weight parameters,1908,1885 density 0.15857712765957446,0.1566655585106383
before tensor 32768 mask 5495.0 32768
layer2.0.conv1.weight, mask/weight parameters,5495,5435 density 0.28619791666666666,0.2830729166666667
before tensor 147456 mask 12769.0 147456
layer2.0.conv2.weight, mask/weight parameters,12769,12646 density 0.25222716049382715,0.24979753086419754
before tensor 65536 mask 7171.0 65536
layer2.0.conv3.weight, mask/weight parameters,7171,7056 density 0.18674479166666666,0.18375
layer2.0.shortcut.0.weight, mask/weight parameters,30787,30428 density 0.23488616943359375,0.232147216796875
before tensor 65536 mask 3670.0 65536
layer2.1.conv1.weight, mask/weight parameters,3670,3635 density 0.09557291666666666,0.09466145833333334
before tensor 147456 mask 4231.0 147456
layer2.1.conv2.weight, mask/weight parameters,4231,4201 density 0.08357530864197531,0.08298271604938272
before tensor 65536 mask 4232.0 65536
layer2.1.conv3.weight, mask/weight parameters,4232,4224 density 0.11020833333333334,0.11
before tensor 65536 mask 10650.0 65536
layer2.2.conv1.weight, mask/weight parameters,10650,10592 density 0.27734375,0.2758333333333333
before tensor 147456 mask 21803.0 147456
layer2.2.conv2.weight, mask/weight parameters,21803,21624 density 0.43067654320987653,0.42714074074074077
before tensor 65536 mask 13616.0 65536
layer2.2.conv3.weight, mask/weight parameters,13616,13478 density 0.3545833333333333,0.35098958333333335
before tensor 65536 mask 10850.0 65536
layer2.3.conv1.weight, mask/weight parameters,10850,10728 density 0.2825520833333333,0.279375
before tensor 147456 mask 20777.0 147456
layer2.3.conv2.weight, mask/weight parameters,20777,20470 density 0.4104098765432099,0.4043456790123457
before tensor 65536 mask 11365.0 65536
layer2.3.conv3.weight, mask/weight parameters,11365,11232 density 0.29596354166666666,0.2925
before tensor 131072 mask 30101.0 131072
layer3.0.conv1.weight, mask/weight parameters,30101,29699 density 0.46292138287401574,0.4567390501968504
before tensor 589824 mask 63381.0 589824
layer3.0.conv2.weight, mask/weight parameters,63381,62709 density 0.4366255399177465,0.43199619732572797
before tensor 262144 mask 58337.0 262144
layer3.0.conv3.weight, mask/weight parameters,58337,57618 density 0.4485805241141732,0.44305179625984253
layer3.0.shortcut.0.weight, mask/weight parameters,99899,98987 density 0.19054222106933594,0.18880271911621094
before tensor 262144 mask 28295.0 262144
layer3.1.conv1.weight, mask/weight parameters,28295,28046 density 0.21757351131889763,0.21565883366141733
before tensor 589824 mask 60848.0 589824
layer3.1.conv2.weight, mask/weight parameters,60848,60209 density 0.41917594946301,0.4147739406589924
before tensor 262144 mask 52087.0 262144
layer3.1.conv3.weight, mask/weight parameters,52087,51310 density 0.40052134596456695,0.39454662893700787
before tensor 262144 mask 30376.0 262144
layer3.2.conv1.weight, mask/weight parameters,30376,29998 density 0.23357529527559054,0.23066867618110237
before tensor 589824 mask 53891.0 589824
layer3.2.conv2.weight, mask/weight parameters,53891,53300 density 0.37124985361081836,0.36717851213480207
before tensor 262144 mask 50878.0 262144
layer3.2.conv3.weight, mask/weight parameters,50878,50160 density 0.39122477854330706,0.3857037401574803
before tensor 262144 mask 34036.0 262144
layer3.3.conv1.weight, mask/weight parameters,34036,33718 density 0.26171875,0.25927349901574803
before tensor 589824 mask 48457.0 589824
layer3.3.conv2.weight, mask/weight parameters,48457,47728 density 0.33381555652000194,0.32879354647598186
before tensor 262144 mask 44074.0 262144
layer3.3.conv3.weight, mask/weight parameters,44074,43181 density 0.3389056348425197,0.33203893946850394
before tensor 262144 mask 38965.0 262144
layer3.4.conv1.weight, mask/weight parameters,38965,38519 density 0.2996201402559055,0.2961906373031496
before tensor 589824 mask 49629.0 589824
layer3.4.conv2.weight, mask/weight parameters,49629,48981 density 0.34188935044536756,0.3374253415173497
before tensor 262144 mask 40930.0 262144
layer3.4.conv3.weight, mask/weight parameters,40930,40287 density 0.3147299458661417,0.30978561761811024
before tensor 262144 mask 45364.0 262144
layer3.5.conv1.weight, mask/weight parameters,45364,44838 density 0.34882504921259844,0.34478038877952755
before tensor 589824 mask 49310.0 589824
layer3.5.conv2.weight, mask/weight parameters,49310,48731 density 0.3396917904946921,0.33570311585067614
before tensor 262144 mask 40058.0 262144
layer3.5.conv3.weight, mask/weight parameters,40058,39442 density 0.3080247293307087,0.30328801673228345
before tensor 524288 mask 137065.0 524288
layer4.0.conv1.weight, mask/weight parameters,137065,134987 density 0.5769505994073276,0.5682036301185345
before tensor 2359296 mask 201795.0 2359296
layer4.0.conv2.weight, mask/weight parameters,201795,198260 density 0.4165737713040032,0.4092763244814374
before tensor 1048576 mask 106088.0 1048576
layer4.0.conv3.weight, mask/weight parameters,106088,104531 density 0.22327922952586207,0.22000227303340517
layer4.0.shortcut.0.weight, mask/weight parameters,144944,143304 density 0.06911468505859375,0.06833267211914062
before tensor 1048576 mask 120754.0 1048576
layer4.1.conv1.weight, mask/weight parameters,120754,118488 density 0.25414618130387934,0.24937702047413793
before tensor 2359296 mask 196585.0 2359296
layer4.1.conv2.weight, mask/weight parameters,196585,192674 density 0.4058185526489629,0.3977449134628088
before tensor 1048576 mask 85545.0 1048576
layer4.1.conv3.weight, mask/weight parameters,85545,84212 density 0.1800431876346983,0.17723767510775862
before tensor 1048576 mask 82539.0 1048576
layer4.2.conv1.weight, mask/weight parameters,82539,81011 density 0.1737165779903017,0.17050065665409483
before tensor 2359296 mask 71809.0 2359296
layer4.2.conv2.weight, mask/weight parameters,71809,69963 density 0.1482382910556216,0.14442751684502575
before tensor 1048576 mask 36246.0 1048576
layer4.2.conv3.weight, mask/weight parameters,36246,35865 density 0.07628552667025862,0.07548365099676724
classifier.weight, mask/weight parameters,106651,106551 density 0.5207568359375,0.5202685546875
Total Model parameters after dst: 2398721 2365205
Total parameters under density level of 0.1: 0.23935153434794665 0.2360072079234872 after dst
Death rate: 0.10141720466855662


Training summary: Average loss: 0.3434, Accuracy: 44618/50000 (89.236%)


Evaluation: Average loss: 1.1471, Accuracy: 7138/10000 (71.380%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.74 seconds.

Train Epoch: 116 [0/50000 (0%)]	Loss: 0.382667 Accuracy: 84/100 (84.000%
Train Epoch: 116 [10000/50000 (20%)]	Loss: 0.233052 Accuracy: 9160/10100 (90.693%
Train Epoch: 116 [20000/50000 (40%)]	Loss: 0.384215 Accuracy: 18158/20100 (90.338%
Train Epoch: 116 [30000/50000 (60%)]	Loss: 0.430569 Accuracy: 27084/30100 (89.980%
Train Epoch: 116 [40000/50000 (80%)]	Loss: 0.426952 Accuracy: 36034/40100 (89.860%
current layer rate 0.4995
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3798.0
Total filter_masks items: 7046325.0
3798.0 / 7552 channels
Total channels to prune: 18.224000000000615
Layer ('layer4', 0, 'conv1'): Pruned 1/232.0 channels based on HE
Layer ('layer4', 0, 'conv2'): Pruned 1/232.0 channels based on HE
Layer ('layer4', 1, 'conv1'): Pruned 1/232.0 channels based on HE
Layer ('layer4', 1, 'conv2'): Pruned 1/232.0 channels based on HE
Layer ('layer4', 2, 'conv1'): Pruned 1/232.0 channels based on HE
Layer ('layer4', 2, 'conv2'): Pruned 1/232.0 channels based on HE
update_filter_mask
After update_filter_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
After apply_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
Total pruned: 6/18.224000000000615 channels
===========done ===============

Training summary: Average loss: 0.3327, Accuracy: 44774/50000 (89.548%)


Evaluation: Average loss: 1.0781, Accuracy: 7229/10000 (72.290%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.53 seconds.

Train Epoch: 117 [0/50000 (0%)]	Loss: 0.221221 Accuracy: 92/100 (92.000%
Train Epoch: 117 [10000/50000 (20%)]	Loss: 0.239815 Accuracy: 9162/10100 (90.713%
Train Epoch: 117 [20000/50000 (40%)]	Loss: 0.438037 Accuracy: 18182/20100 (90.458%
Train Epoch: 117 [30000/50000 (60%)]	Loss: 0.280890 Accuracy: 27132/30100 (90.140%
Train Epoch: 117 [40000/50000 (80%)]	Loss: 0.383382 Accuracy: 35972/40100 (89.706%
current mest  death_rate 0.10104385427227106


dynamic sparse change prune
to kill 26039.799999998882 expect 2365203.200000001
conv1.weight, mask/weight parameters,1177,1177 density 0.6811342592592593,0.6811342592592593
before tensor 4096 mask 667.0 4096
layer1.0.conv1.weight, mask/weight parameters,667,667 density 0.22174202127659576,0.22174202127659576
before tensor 36864 mask 3747.0 36864
layer1.0.conv2.weight, mask/weight parameters,3747,3747 density 0.1884714048589105,0.1884714048589105
before tensor 16384 mask 3843.0 16384
layer1.0.conv3.weight, mask/weight parameters,3843,3843 density 0.31939827127659576,0.31939827127659576
layer1.0.shortcut.0.weight, mask/weight parameters,5638,5638 density 0.3441162109375,0.3441162109375
before tensor 16384 mask 2456.0 16384
layer1.1.conv1.weight, mask/weight parameters,2456,2456 density 0.20412234042553193,0.20412234042553193
before tensor 36864 mask 4044.0 36864
layer1.1.conv2.weight, mask/weight parameters,4044,4044 density 0.20341029123283538,0.20341029123283538
before tensor 16384 mask 2243.0 16384
layer1.1.conv3.weight, mask/weight parameters,2243,2243 density 0.1864195478723404,0.1864195478723404
before tensor 16384 mask 2870.0 16384
layer1.2.conv1.weight, mask/weight parameters,2870,2870 density 0.23853058510638298,0.23853058510638298
before tensor 36864 mask 3478.0 36864
layer1.2.conv2.weight, mask/weight parameters,3478,3478 density 0.17494089834515367,0.17494089834515367
before tensor 16384 mask 1878.0 16384
layer1.2.conv3.weight, mask/weight parameters,1878,1878 density 0.15608377659574468,0.15608377659574468
before tensor 32768 mask 5419.0 32768
layer2.0.conv1.weight, mask/weight parameters,5419,5419 density 0.2822395833333333,0.2822395833333333
before tensor 147456 mask 12677.0 147456
layer2.0.conv2.weight, mask/weight parameters,12677,12677 density 0.2504098765432099,0.2504098765432099
before tensor 65536 mask 7106.0 65536
layer2.0.conv3.weight, mask/weight parameters,7106,7106 density 0.18505208333333334,0.18505208333333334
layer2.0.shortcut.0.weight, mask/weight parameters,30442,30442 density 0.2322540283203125,0.2322540283203125
before tensor 65536 mask 3640.0 65536
layer2.1.conv1.weight, mask/weight parameters,3640,3640 density 0.09479166666666666,0.09479166666666666
before tensor 147456 mask 4207.0 147456
layer2.1.conv2.weight, mask/weight parameters,4207,4207 density 0.08310123456790124,0.08310123456790124
before tensor 65536 mask 4199.0 65536
layer2.1.conv3.weight, mask/weight parameters,4199,4199 density 0.10934895833333333,0.10934895833333333
before tensor 65536 mask 10557.0 65536
layer2.2.conv1.weight, mask/weight parameters,10557,10557 density 0.274921875,0.274921875
before tensor 147456 mask 21600.0 147456
layer2.2.conv2.weight, mask/weight parameters,21600,21600 density 0.4266666666666667,0.4266666666666667
before tensor 65536 mask 13459.0 65536
layer2.2.conv3.weight, mask/weight parameters,13459,13459 density 0.3504947916666667,0.3504947916666667
before tensor 65536 mask 10748.0 65536
layer2.3.conv1.weight, mask/weight parameters,10748,10748 density 0.27989583333333334,0.27989583333333334
before tensor 147456 mask 20599.0 147456
layer2.3.conv2.weight, mask/weight parameters,20599,20599 density 0.4068938271604938,0.4068938271604938
before tensor 65536 mask 11258.0 65536
layer2.3.conv3.weight, mask/weight parameters,11258,11258 density 0.2931770833333333,0.2931770833333333
before tensor 131072 mask 29764.0 131072
layer3.0.conv1.weight, mask/weight parameters,29764,29764 density 0.4577386811023622,0.4577386811023622
before tensor 589824 mask 62756.0 589824
layer3.0.conv2.weight, mask/weight parameters,62756,62756 density 0.4323199757510626,0.4323199757510626
before tensor 262144 mask 57807.0 262144
layer3.0.conv3.weight, mask/weight parameters,57807,57807 density 0.44450510580708663,0.44450510580708663
layer3.0.shortcut.0.weight, mask/weight parameters,98802,98802 density 0.18844985961914062,0.18844985961914062
before tensor 262144 mask 28021.0 262144
layer3.1.conv1.weight, mask/weight parameters,28021,28021 density 0.2154665969488189,0.2154665969488189
before tensor 589824 mask 60173.0 589824
layer3.1.conv2.weight, mask/weight parameters,60173,60173 density 0.41452594016299144,0.41452594016299144
before tensor 262144 mask 51530.0 262144
layer3.1.conv3.weight, mask/weight parameters,51530,51530 density 0.396238312007874,0.396238312007874
before tensor 262144 mask 30029.0 262144
layer3.2.conv1.weight, mask/weight parameters,30029,30029 density 0.23090704970472442,0.23090704970472442
before tensor 589824 mask 53330.0 589824
layer3.2.conv2.weight, mask/weight parameters,53330,53330 density 0.36738517921480285,0.36738517921480285
before tensor 262144 mask 50320.0 262144
layer3.2.conv3.weight, mask/weight parameters,50320,50320 density 0.38693405511811024,0.38693405511811024
before tensor 262144 mask 33681.0 262144
layer3.3.conv1.weight, mask/weight parameters,33681,33681 density 0.2589889886811024,0.2589889886811024
before tensor 589824 mask 47891.0 589824
layer3.3.conv2.weight, mask/weight parameters,47891,47891 density 0.329916437610653,0.329916437610653
before tensor 262144 mask 43560.0 262144
layer3.3.conv3.weight, mask/weight parameters,43560,43560 density 0.33495324803149606,0.33495324803149606
before tensor 262144 mask 38527.0 262144
layer3.4.conv1.weight, mask/weight parameters,38527,38527 density 0.2962521530511811,0.2962521530511811
before tensor 589824 mask 49066.0 589824
layer3.4.conv2.weight, mask/weight parameters,49066,49066 density 0.3380108982440187,0.3380108982440187
before tensor 262144 mask 40476.0 262144
layer3.4.conv3.weight, mask/weight parameters,40476,40476 density 0.31123892716535434,0.31123892716535434
before tensor 262144 mask 44834.0 262144
layer3.5.conv1.weight, mask/weight parameters,44834,44834 density 0.3447496309055118,0.3447496309055118
before tensor 589824 mask 48822.0 589824
layer3.5.conv2.weight, mask/weight parameters,48822,48822 density 0.33633000599334534,0.33633000599334534
before tensor 262144 mask 39588.0 262144
layer3.5.conv3.weight, mask/weight parameters,39588,39588 density 0.3044106791338583,0.3044106791338583
before tensor 524288 mask 135170.0 524288
layer4.0.conv1.weight, mask/weight parameters,135170,135170 density 0.5714370265151515,0.5714370265151515
before tensor 2359296 mask 197355.0 2359296
layer4.0.conv2.weight, mask/weight parameters,197355,197355 density 0.4109430732807356,0.4109430732807356
before tensor 1048576 mask 104409.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104409,104409 density 0.22069678368506493,0.22069678368506493
layer4.0.shortcut.0.weight, mask/weight parameters,143062,143062 density 0.06821727752685547,0.06821727752685547
before tensor 1048576 mask 118727.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118727,118727 density 0.25096176609848486,0.25096176609848486
before tensor 2359296 mask 192487.0 2359296
layer4.1.conv2.weight, mask/weight parameters,192487,192487 density 0.4008066648759289,0.4008066648759289
before tensor 1048576 mask 84159.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84159,84159 density 0.1778929078733766,0.1778929078733766
before tensor 1048576 mask 81091.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81091,81091 density 0.1714078564664502,0.1714078564664502
before tensor 2359296 mask 69924.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69924,69924 density 0.14559947027479495,0.14559947027479495
before tensor 1048576 mask 35448.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35448,35448 density 0.07492897727272728,0.07492897727272728
classifier.weight, mask/weight parameters,106444,106444 density 0.51974609375,0.51974609375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.23656819214753694 0.23656819214753694 after dst
Death rate: 0.10104385427227106

dynamic sparse change grow
self.total_params*pruning_rate 2389892.4746510917
self.total_nonzero 2365205.0
to grow 24687.474651091732
len(all_scores) 9997984 6653062
increse 24687.0 before_mask 2389891.0 after_mask 2389891.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1183,1177 density 0.6846064814814815,0.6811342592592593
before tensor 4096 mask 674.0 4096
layer1.0.conv1.weight, mask/weight parameters,674,667 density 0.22406914893617022,0.22174202127659576
before tensor 36864 mask 3764.0 36864
layer1.0.conv2.weight, mask/weight parameters,3764,3747 density 0.18932649263115536,0.1884714048589105
before tensor 16384 mask 3867.0 16384
layer1.0.conv3.weight, mask/weight parameters,3867,3843 density 0.32139295212765956,0.31939827127659576
layer1.0.shortcut.0.weight, mask/weight parameters,5696,5638 density 0.34765625,0.3441162109375
before tensor 16384 mask 2476.0 16384
layer1.1.conv1.weight, mask/weight parameters,2476,2456 density 0.2057845744680851,0.20412234042553193
before tensor 36864 mask 4076.0 36864
layer1.1.conv2.weight, mask/weight parameters,4076,4044 density 0.20501986821588453,0.20341029123283538
before tensor 16384 mask 2262.0 16384
layer1.1.conv3.weight, mask/weight parameters,2262,2243 density 0.18799867021276595,0.1864195478723404
before tensor 16384 mask 2875.0 16384
layer1.2.conv1.weight, mask/weight parameters,2875,2870 density 0.23894614361702127,0.23853058510638298
before tensor 36864 mask 3492.0 36864
layer1.2.conv2.weight, mask/weight parameters,3492,3478 density 0.17564508827523767,0.17494089834515367
before tensor 16384 mask 1891.0 16384
layer1.2.conv3.weight, mask/weight parameters,1891,1878 density 0.15716422872340424,0.15608377659574468
before tensor 32768 mask 5477.0 32768
layer2.0.conv1.weight, mask/weight parameters,5477,5419 density 0.2852604166666667,0.2822395833333333
before tensor 147456 mask 12723.0 147456
layer2.0.conv2.weight, mask/weight parameters,12723,12677 density 0.2513185185185185,0.2504098765432099
before tensor 65536 mask 7134.0 65536
layer2.0.conv3.weight, mask/weight parameters,7134,7106 density 0.18578125,0.18505208333333334
layer2.0.shortcut.0.weight, mask/weight parameters,30640,30442 density 0.2337646484375,0.2322540283203125
before tensor 65536 mask 3645.0 65536
layer2.1.conv1.weight, mask/weight parameters,3645,3640 density 0.094921875,0.09479166666666666
before tensor 147456 mask 4214.0 147456
layer2.1.conv2.weight, mask/weight parameters,4214,4207 density 0.08323950617283951,0.08310123456790124
before tensor 65536 mask 4233.0 65536
layer2.1.conv3.weight, mask/weight parameters,4233,4199 density 0.110234375,0.10934895833333333
before tensor 65536 mask 10601.0 65536
layer2.2.conv1.weight, mask/weight parameters,10601,10557 density 0.27606770833333333,0.274921875
before tensor 147456 mask 21748.0 147456
layer2.2.conv2.weight, mask/weight parameters,21748,21600 density 0.4295901234567901,0.4266666666666667
before tensor 65536 mask 13561.0 65536
layer2.2.conv3.weight, mask/weight parameters,13561,13459 density 0.35315104166666667,0.3504947916666667
before tensor 65536 mask 10823.0 65536
layer2.3.conv1.weight, mask/weight parameters,10823,10748 density 0.28184895833333334,0.27989583333333334
before tensor 147456 mask 20684.0 147456
layer2.3.conv2.weight, mask/weight parameters,20684,20599 density 0.40857283950617285,0.4068938271604938
before tensor 65536 mask 11314.0 65536
layer2.3.conv3.weight, mask/weight parameters,11314,11258 density 0.29463541666666665,0.2931770833333333
before tensor 131072 mask 30041.0 131072
layer3.0.conv1.weight, mask/weight parameters,30041,29764 density 0.4619986466535433,0.4577386811023622
before tensor 589824 mask 63015.0 589824
layer3.0.conv2.weight, mask/weight parameters,63015,62756 density 0.4341042015417364,0.4323199757510626
before tensor 262144 mask 58258.0 262144
layer3.0.conv3.weight, mask/weight parameters,58258,57807 density 0.4479730561023622,0.44450510580708663
layer3.0.shortcut.0.weight, mask/weight parameters,99256,98802 density 0.1893157958984375,0.18844985961914062
before tensor 262144 mask 28135.0 262144
layer3.1.conv1.weight, mask/weight parameters,28135,28021 density 0.2163431963582677,0.2154665969488189
before tensor 589824 mask 60773.0 589824
layer3.1.conv2.weight, mask/weight parameters,60773,60173 density 0.418659281763008,0.41452594016299144
before tensor 262144 mask 52177.0 262144
layer3.1.conv3.weight, mask/weight parameters,52177,51530 density 0.40121339812992124,0.396238312007874
before tensor 262144 mask 30357.0 262144
layer3.2.conv1.weight, mask/weight parameters,30357,30029 density 0.23342919537401574,0.23090704970472442
before tensor 589824 mask 53776.0 589824
layer3.2.conv2.weight, mask/weight parameters,53776,53330 density 0.3704576298041485,0.36738517921480285
before tensor 262144 mask 50821.0 262144
layer3.2.conv3.weight, mask/weight parameters,50821,50320 density 0.3907864788385827,0.38693405511811024
before tensor 262144 mask 33908.0 262144
layer3.3.conv1.weight, mask/weight parameters,33908,33681 density 0.26073449803149606,0.2589889886811024
before tensor 589824 mask 48225.0 589824
layer3.3.conv2.weight, mask/weight parameters,48225,47891 density 0.3322173311013289,0.329916437610653
before tensor 262144 mask 44010.0 262144
layer3.3.conv3.weight, mask/weight parameters,44010,43560 density 0.3384135088582677,0.33495324803149606
before tensor 262144 mask 38981.0 262144
layer3.4.conv1.weight, mask/weight parameters,38981,38527 density 0.2997431717519685,0.2962521530511811
before tensor 589824 mask 49541.0 589824
layer3.4.conv2.weight, mask/weight parameters,49541,49066 density 0.34128312701069846,0.3380108982440187
before tensor 262144 mask 41019.0 262144
layer3.4.conv3.weight, mask/weight parameters,41019,40476 density 0.31541430856299213,0.31123892716535434
before tensor 262144 mask 45252.0 262144
layer3.5.conv1.weight, mask/weight parameters,45252,44834 density 0.34796382874015747,0.3447496309055118
before tensor 589824 mask 49161.0 589824
layer3.5.conv2.weight, mask/weight parameters,49161,48822 density 0.33866534399735465,0.33633000599334534
before tensor 262144 mask 40022.0 262144
layer3.5.conv3.weight, mask/weight parameters,40022,39588 density 0.30774790846456695,0.3044106791338583
before tensor 524288 mask 136755.0 524288
layer4.0.conv1.weight, mask/weight parameters,136755,135170 density 0.5781376826298701,0.5714370265151515
before tensor 2359296 mask 200004.0 2359296
layer4.0.conv2.weight, mask/weight parameters,200004,197355 density 0.41645896191350734,0.4109430732807356
before tensor 1048576 mask 105495.0 1048576
layer4.0.conv3.weight, mask/weight parameters,105495,104409 density 0.22299233969155843,0.22069678368506493
layer4.0.shortcut.0.weight, mask/weight parameters,144109,143062 density 0.06871652603149414,0.06821727752685547
before tensor 1048576 mask 120289.0 1048576
layer4.1.conv1.weight, mask/weight parameters,120289,118727 density 0.25426347740800864,0.25096176609848486
before tensor 2359296 mask 195960.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195960,192487 density 0.4080383301162522,0.4008066648759289
before tensor 1048576 mask 85162.0 1048576
layer4.1.conv3.weight, mask/weight parameters,85162,84159 density 0.18001302083333334,0.1778929078733766
before tensor 1048576 mask 82379.0 1048576
layer4.2.conv1.weight, mask/weight parameters,82379,81091 density 0.17413039434523808,0.1714078564664502
before tensor 2359296 mask 71386.0 2359296
layer4.2.conv2.weight, mask/weight parameters,71386,69924 density 0.14864372440130016,0.14559947027479495
before tensor 1048576 mask 35956.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35956,35448 density 0.07600277326839827,0.07492897727272728
classifier.weight, mask/weight parameters,106615,106444 density 0.5205810546875,0.51974609375
Total Model parameters after dst: 2389891 2365205
Total parameters under density level of 0.1: 0.2390372899176474 0.23656819214753694 after dst
Death rate: 0.10104385427227106


Training summary: Average loss: 0.3369, Accuracy: 44688/50000 (89.376%)


Evaluation: Average loss: 1.0891, Accuracy: 7232/10000 (72.320%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.73 seconds.

Train Epoch: 118 [0/50000 (0%)]	Loss: 0.372738 Accuracy: 87/100 (87.000%
Train Epoch: 118 [10000/50000 (20%)]	Loss: 0.216473 Accuracy: 9149/10100 (90.584%
Train Epoch: 118 [20000/50000 (40%)]	Loss: 0.245524 Accuracy: 18242/20100 (90.756%
Train Epoch: 118 [30000/50000 (60%)]	Loss: 0.281177 Accuracy: 27234/30100 (90.478%
Train Epoch: 118 [40000/50000 (80%)]	Loss: 0.293612 Accuracy: 36148/40100 (90.145%
current layer rate 0.4996970869367319
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
3792.0 / 7552 channels
Total channels to prune: 13.712400546199206
update_filter_mask
After update_filter_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
After apply_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
Total pruned: 0/13.712400546199206 channels
===========done ===============

Training summary: Average loss: 0.3220, Accuracy: 44950/50000 (89.900%)


Evaluation: Average loss: 1.1237, Accuracy: 7185/10000 (71.850%)

Current learning rate: 0.010000000000000002. Time taken for epoch: 88.53 seconds.

Train Epoch: 119 [0/50000 (0%)]	Loss: 0.139018 Accuracy: 98/100 (98.000%
Train Epoch: 119 [10000/50000 (20%)]	Loss: 0.248198 Accuracy: 9202/10100 (91.109%
Train Epoch: 119 [20000/50000 (40%)]	Loss: 0.281190 Accuracy: 18230/20100 (90.697%
Train Epoch: 119 [30000/50000 (60%)]	Loss: 0.332252 Accuracy: 27189/30100 (90.329%
Train Epoch: 119 [40000/50000 (80%)]	Loss: 0.461959 Accuracy: 36072/40100 (89.955%
current mest  death_rate 0.1007264545643489


dynamic sparse change prune
to kill 24687.799999998882 expect 2365203.200000001
conv1.weight, mask/weight parameters,1179,1179 density 0.6822916666666666,0.6822916666666666
before tensor 4096 mask 668.0 4096
layer1.0.conv1.weight, mask/weight parameters,668,668 density 0.2220744680851064,0.2220744680851064
before tensor 36864 mask 3737.0 36864
layer1.0.conv2.weight, mask/weight parameters,3737,3737 density 0.18796841205170767,0.18796841205170767
before tensor 16384 mask 3828.0 16384
layer1.0.conv3.weight, mask/weight parameters,3828,3828 density 0.3181515957446808,0.3181515957446808
layer1.0.shortcut.0.weight, mask/weight parameters,5662,5662 density 0.3455810546875,0.3455810546875
before tensor 16384 mask 2449.0 16384
layer1.1.conv1.weight, mask/weight parameters,2449,2449 density 0.2035405585106383,0.2035405585106383
before tensor 36864 mask 4049.0 36864
layer1.1.conv2.weight, mask/weight parameters,4049,4049 density 0.2036617876364368,0.2036617876364368
before tensor 16384 mask 2237.0 16384
layer1.1.conv3.weight, mask/weight parameters,2237,2237 density 0.18592087765957446,0.18592087765957446
before tensor 16384 mask 2857.0 16384
layer1.2.conv1.weight, mask/weight parameters,2857,2857 density 0.23745013297872342,0.23745013297872342
before tensor 36864 mask 3472.0 36864
layer1.2.conv2.weight, mask/weight parameters,3472,3472 density 0.17463910266083196,0.17463910266083196
before tensor 16384 mask 1870.0 16384
layer1.2.conv3.weight, mask/weight parameters,1870,1870 density 0.15541888297872342,0.15541888297872342
before tensor 32768 mask 5403.0 32768
layer2.0.conv1.weight, mask/weight parameters,5403,5403 density 0.28140625,0.28140625
before tensor 147456 mask 12633.0 147456
layer2.0.conv2.weight, mask/weight parameters,12633,12633 density 0.24954074074074073,0.24954074074074073
before tensor 65536 mask 7063.0 65536
layer2.0.conv3.weight, mask/weight parameters,7063,7063 density 0.18393229166666666,0.18393229166666666
layer2.0.shortcut.0.weight, mask/weight parameters,30321,30321 density 0.23133087158203125,0.23133087158203125
before tensor 65536 mask 3621.0 65536
layer2.1.conv1.weight, mask/weight parameters,3621,3621 density 0.094296875,0.094296875
before tensor 147456 mask 4175.0 147456
layer2.1.conv2.weight, mask/weight parameters,4175,4175 density 0.08246913580246913,0.08246913580246913
before tensor 65536 mask 4200.0 65536
layer2.1.conv3.weight, mask/weight parameters,4200,4200 density 0.109375,0.109375
before tensor 65536 mask 10502.0 65536
layer2.2.conv1.weight, mask/weight parameters,10502,10502 density 0.27348958333333334,0.27348958333333334
before tensor 147456 mask 21553.0 147456
layer2.2.conv2.weight, mask/weight parameters,21553,21553 density 0.42573827160493827,0.42573827160493827
before tensor 65536 mask 13405.0 65536
layer2.2.conv3.weight, mask/weight parameters,13405,13405 density 0.34908854166666664,0.34908854166666664
before tensor 65536 mask 10724.0 65536
layer2.3.conv1.weight, mask/weight parameters,10724,10724 density 0.27927083333333336,0.27927083333333336
before tensor 147456 mask 20517.0 147456
layer2.3.conv2.weight, mask/weight parameters,20517,20517 density 0.40527407407407406,0.40527407407407406
before tensor 65536 mask 11197.0 65536
layer2.3.conv3.weight, mask/weight parameters,11197,11197 density 0.29158854166666665,0.29158854166666665
before tensor 131072 mask 29761.0 131072
layer3.0.conv1.weight, mask/weight parameters,29761,29761 density 0.4576925442913386,0.4576925442913386
before tensor 589824 mask 62425.0 589824
layer3.0.conv2.weight, mask/weight parameters,62425,62425 density 0.4300397489683868,0.4300397489683868
before tensor 262144 mask 57696.0 262144
layer3.0.conv3.weight, mask/weight parameters,57696,57696 density 0.4436515748031496,0.4436515748031496
layer3.0.shortcut.0.weight, mask/weight parameters,98207,98207 density 0.1873149871826172,0.1873149871826172
before tensor 262144 mask 27843.0 262144
layer3.1.conv1.weight, mask/weight parameters,27843,27843 density 0.2140978715551181,0.2140978715551181
before tensor 589824 mask 60160.0 589824
layer3.1.conv2.weight, mask/weight parameters,60160,60160 density 0.4144363844283244,0.4144363844283244
before tensor 262144 mask 51687.0 262144
layer3.1.conv3.weight, mask/weight parameters,51687,51687 density 0.39744555856299213,0.39744555856299213
before tensor 262144 mask 30027.0 262144
layer3.2.conv1.weight, mask/weight parameters,30027,30027 density 0.23089167076771652,0.23089167076771652
before tensor 589824 mask 53257.0 589824
layer3.2.conv2.weight, mask/weight parameters,53257,53257 density 0.36688228932013417,0.36688228932013417
before tensor 262144 mask 50311.0 262144
layer3.2.conv3.weight, mask/weight parameters,50311,50311 density 0.3868648499015748,0.3868648499015748
before tensor 262144 mask 33549.0 262144
layer3.3.conv1.weight, mask/weight parameters,33549,33549 density 0.2579739788385827,0.2579739788385827
before tensor 589824 mask 47707.0 589824
layer3.3.conv2.weight, mask/weight parameters,47707,47707 density 0.3286488795199813,0.3286488795199813
before tensor 262144 mask 43539.0 262144
layer3.3.conv3.weight, mask/weight parameters,43539,43539 density 0.33479176919291337,0.33479176919291337
before tensor 262144 mask 38571.0 262144
layer3.4.conv1.weight, mask/weight parameters,38571,38571 density 0.29659048966535434,0.29659048966535434
before tensor 589824 mask 49046.0 589824
layer3.4.conv2.weight, mask/weight parameters,49046,49046 density 0.33787312019068483,0.33787312019068483
before tensor 262144 mask 40571.0 262144
layer3.4.conv3.weight, mask/weight parameters,40571,40571 density 0.31196942667322836,0.31196942667322836
before tensor 262144 mask 44790.0 262144
layer3.5.conv1.weight, mask/weight parameters,44790,44790 density 0.3444112942913386,0.3444112942913386
before tensor 589824 mask 48656.0 589824
layer3.5.conv2.weight, mask/weight parameters,48656,48656 density 0.33518644815067405,0.33518644815067405
before tensor 262144 mask 39571.0 262144
layer3.5.conv3.weight, mask/weight parameters,39571,39571 density 0.3042799581692913,0.3042799581692913
before tensor 524288 mask 135519.0 524288
layer4.0.conv1.weight, mask/weight parameters,135519,135519 density 0.5729124391233766,0.5729124391233766
before tensor 2359296 mask 197811.0 2359296
layer4.0.conv2.weight, mask/weight parameters,197811,197811 density 0.41189258072374957,0.41189258072374957
before tensor 1048576 mask 104295.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104295,104295 density 0.22045581371753248,0.22045581371753248
layer4.0.shortcut.0.weight, mask/weight parameters,142219,142219 density 0.06781530380249023,0.06781530380249023
before tensor 1048576 mask 118863.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118863,118863 density 0.2512492390422078,0.2512492390422078
before tensor 2359296 mask 193864.0 2359296
layer4.1.conv2.weight, mask/weight parameters,193864,193864 density 0.40367392748345127,0.40367392748345127
before tensor 1048576 mask 84262.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84262,84262 density 0.17811062635281386,0.17811062635281386
before tensor 1048576 mask 81322.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81322,81322 density 0.1718961377164502,0.1718961377164502
before tensor 2359296 mask 70426.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70426,70426 density 0.1466447613633761,0.1466447613633761
before tensor 1048576 mask 35554.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35554,35554 density 0.07515303706709957,0.07515303706709957
classifier.weight, mask/weight parameters,106374,106374 density 0.519404296875,0.519404296875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.23656819214753694 0.23656819214753694 after dst
Death rate: 0.1007264545643489

dynamic sparse change grow
self.total_params*pruning_rate 2382385.326602526
self.total_nonzero 2365205.0
to grow 17180.32660252601
len(all_scores) 9997984 6653128
increse 17180.0 before_mask 2382384.0 after_mask 2382384.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1189,1179 density 0.6880787037037037,0.6822916666666666
before tensor 4096 mask 671.0 4096
layer1.0.conv1.weight, mask/weight parameters,671,668 density 0.2230718085106383,0.2220744680851064
before tensor 36864 mask 3746.0 36864
layer1.0.conv2.weight, mask/weight parameters,3746,3737 density 0.18842110557819022,0.18796841205170767
before tensor 16384 mask 3849.0 16384
layer1.0.conv3.weight, mask/weight parameters,3849,3828 density 0.3198969414893617,0.3181515957446808
layer1.0.shortcut.0.weight, mask/weight parameters,5711,5662 density 0.34857177734375,0.3455810546875
before tensor 16384 mask 2465.0 16384
layer1.1.conv1.weight, mask/weight parameters,2465,2449 density 0.20487034574468085,0.2035405585106383
before tensor 36864 mask 4056.0 36864
layer1.1.conv2.weight, mask/weight parameters,4056,4049 density 0.2040138826014788,0.2036617876364368
before tensor 16384 mask 2246.0 16384
layer1.1.conv3.weight, mask/weight parameters,2246,2237 density 0.18666888297872342,0.18592087765957446
before tensor 16384 mask 2864.0 16384
layer1.2.conv1.weight, mask/weight parameters,2864,2857 density 0.23803191489361702,0.23745013297872342
before tensor 36864 mask 3474.0 36864
layer1.2.conv2.weight, mask/weight parameters,3474,3472 density 0.17473970122227253,0.17463910266083196
before tensor 16384 mask 1873.0 16384
layer1.2.conv3.weight, mask/weight parameters,1873,1870 density 0.1556682180851064,0.15541888297872342
before tensor 32768 mask 5480.0 32768
layer2.0.conv1.weight, mask/weight parameters,5480,5403 density 0.28541666666666665,0.28140625
before tensor 147456 mask 12658.0 147456
layer2.0.conv2.weight, mask/weight parameters,12658,12633 density 0.2500345679012346,0.24954074074074073
before tensor 65536 mask 7086.0 65536
layer2.0.conv3.weight, mask/weight parameters,7086,7063 density 0.18453125,0.18393229166666666
layer2.0.shortcut.0.weight, mask/weight parameters,30441,30321 density 0.23224639892578125,0.23133087158203125
before tensor 65536 mask 3624.0 65536
layer2.1.conv1.weight, mask/weight parameters,3624,3621 density 0.094375,0.094296875
before tensor 147456 mask 4194.0 147456
layer2.1.conv2.weight, mask/weight parameters,4194,4175 density 0.08284444444444444,0.08246913580246913
before tensor 65536 mask 4225.0 65536
layer2.1.conv3.weight, mask/weight parameters,4225,4200 density 0.11002604166666667,0.109375
before tensor 65536 mask 10539.0 65536
layer2.2.conv1.weight, mask/weight parameters,10539,10502 density 0.274453125,0.27348958333333334
before tensor 147456 mask 21693.0 147456
layer2.2.conv2.weight, mask/weight parameters,21693,21553 density 0.4285037037037037,0.42573827160493827
before tensor 65536 mask 13552.0 65536
layer2.2.conv3.weight, mask/weight parameters,13552,13405 density 0.35291666666666666,0.34908854166666664
before tensor 65536 mask 10761.0 65536
layer2.3.conv1.weight, mask/weight parameters,10761,10724 density 0.280234375,0.27927083333333336
before tensor 147456 mask 20575.0 147456
layer2.3.conv2.weight, mask/weight parameters,20575,20517 density 0.40641975308641975,0.40527407407407406
before tensor 65536 mask 11219.0 65536
layer2.3.conv3.weight, mask/weight parameters,11219,11197 density 0.29216145833333335,0.29158854166666665
before tensor 131072 mask 29909.0 131072
layer3.0.conv1.weight, mask/weight parameters,29909,29761 density 0.45996862696850394,0.4576925442913386
before tensor 589824 mask 62763.0 589824
layer3.0.conv2.weight, mask/weight parameters,62763,62425 density 0.4323681980697295,0.4300397489683868
before tensor 262144 mask 58170.0 262144
layer3.0.conv3.weight, mask/weight parameters,58170,57696 density 0.44729638287401574,0.4436515748031496
layer3.0.shortcut.0.weight, mask/weight parameters,98856,98207 density 0.1885528564453125,0.1873149871826172
before tensor 262144 mask 28001.0 262144
layer3.1.conv1.weight, mask/weight parameters,28001,27843 density 0.21531280757874016,0.2140978715551181
before tensor 589824 mask 60566.0 589824
layer3.1.conv2.weight, mask/weight parameters,60566,60160 density 0.41723327891100226,0.4144363844283244
before tensor 262144 mask 52241.0 262144
layer3.1.conv3.weight, mask/weight parameters,52241,51687 density 0.4017055241141732,0.39744555856299213
before tensor 262144 mask 30235.0 262144
layer3.2.conv1.weight, mask/weight parameters,30235,30027 density 0.23249108021653545,0.23089167076771652
before tensor 589824 mask 53690.0 589824
layer3.2.conv2.weight, mask/weight parameters,53690,53257 density 0.3698651841748128,0.36688228932013417
before tensor 262144 mask 50772.0 262144
layer3.2.conv3.weight, mask/weight parameters,50772,50311 density 0.39040969488188976,0.3868648499015748
before tensor 262144 mask 33834.0 262144
layer3.3.conv1.weight, mask/weight parameters,33834,33549 density 0.26016547736220474,0.2579739788385827
before tensor 589824 mask 48074.0 589824
layer3.3.conv2.weight, mask/weight parameters,48074,47707 density 0.331177106798658,0.3286488795199813
before tensor 262144 mask 43978.0 262144
layer3.3.conv3.weight, mask/weight parameters,43978,43539 density 0.3381674458661417,0.33479176919291337
before tensor 262144 mask 38989.0 262144
layer3.4.conv1.weight, mask/weight parameters,38989,38571 density 0.2998046875,0.29659048966535434
before tensor 589824 mask 49565.0 589824
layer3.4.conv2.weight, mask/weight parameters,49565,49046 density 0.34144846067469914,0.33787312019068483
before tensor 262144 mask 41011.0 262144
layer3.4.conv3.weight, mask/weight parameters,41011,40571 density 0.31535279281496065,0.31196942667322836
before tensor 262144 mask 45331.0 262144
layer3.5.conv1.weight, mask/weight parameters,45331,44790 density 0.3485712967519685,0.3444112942913386
before tensor 589824 mask 48999.0 589824
layer3.5.conv2.weight, mask/weight parameters,48999,48656 density 0.3375493417653502,0.33518644815067405
before tensor 262144 mask 39866.0 262144
layer3.5.conv3.weight, mask/weight parameters,39866,39571 density 0.3065483513779528,0.3042799581692913
before tensor 524288 mask 136711.0 524288
layer4.0.conv1.weight, mask/weight parameters,136711,135519 density 0.5779516707251082,0.5729124391233766
before tensor 2359296 mask 199210.0 2359296
layer4.0.conv2.weight, mask/weight parameters,199210,197811 density 0.414805652900891,0.41189258072374957
before tensor 1048576 mask 104999.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104999,104295 density 0.2219439089556277,0.22045581371753248
layer4.0.shortcut.0.weight, mask/weight parameters,142808,142219 density 0.06809616088867188,0.06781530380249023
before tensor 1048576 mask 119639.0 1048576
layer4.1.conv1.weight, mask/weight parameters,119639,118863 density 0.2528895258387446,0.2512492390422078
before tensor 2359296 mask 195943.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195943,193864 density 0.4080029318124556,0.40367392748345127
before tensor 1048576 mask 84687.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84687,84262 density 0.17900897930194806,0.17811062635281386
before tensor 1048576 mask 81892.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81892,81322 density 0.17310098755411255,0.1718961377164502
before tensor 2359296 mask 71136.0 2359296
layer4.2.conv2.weight, mask/weight parameters,71136,70426 density 0.1481231611101741,0.1466447613633761
before tensor 1048576 mask 35844.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35844,35554 density 0.07576603084415584,0.07515303706709957
classifier.weight, mask/weight parameters,106474,106374 density 0.519892578125,0.519404296875
Total Model parameters after dst: 2382384 2365205
Total parameters under density level of 0.1: 0.23828643854601086 0.23656819214753694 after dst
Death rate: 0.1007264545643489


Training summary: Average loss: 0.3282, Accuracy: 44873/50000 (89.746%)


Evaluation: Average loss: 1.1431, Accuracy: 7106/10000 (71.060%)

Current learning rate: 0.001. Time taken for epoch: 88.72 seconds.

Train Epoch: 120 [0/50000 (0%)]	Loss: 0.235894 Accuracy: 93/100 (93.000%
Train Epoch: 120 [10000/50000 (20%)]	Loss: 0.173691 Accuracy: 9322/10100 (92.297%
Train Epoch: 120 [20000/50000 (40%)]	Loss: 0.176308 Accuracy: 18756/20100 (93.313%
Train Epoch: 120 [30000/50000 (60%)]	Loss: 0.170601 Accuracy: 28245/30100 (93.837%
Train Epoch: 120 [40000/50000 (80%)]	Loss: 0.169823 Accuracy: 37742/40100 (94.120%
current layer rate 0.4998340919435594
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
3792.0 / 7552 channels
Total channels to prune: 14.747062357760115
update_filter_mask
After update_filter_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
After apply_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
Total pruned: 0/14.747062357760115 channels
===========done ===============

Training summary: Average loss: 0.1969, Accuracy: 47208/50000 (94.416%)


Evaluation: Average loss: 0.9402, Accuracy: 7603/10000 (76.030%)

Current learning rate: 0.001. Time taken for epoch: 88.53 seconds.

Train Epoch: 121 [0/50000 (0%)]	Loss: 0.092167 Accuracy: 97/100 (97.000%
Train Epoch: 121 [10000/50000 (20%)]	Loss: 0.138940 Accuracy: 9705/10100 (96.089%
Train Epoch: 121 [20000/50000 (40%)]	Loss: 0.175443 Accuracy: 19340/20100 (96.219%
Train Epoch: 121 [30000/50000 (60%)]	Loss: 0.108218 Accuracy: 28954/30100 (96.193%
Train Epoch: 121 [40000/50000 (80%)]	Loss: 0.090518 Accuracy: 38572/40100 (96.190%
current mest  death_rate 0.10046574684651478


dynamic sparse change prune
to kill 17180.799999998882 expect 2365203.200000001
conv1.weight, mask/weight parameters,1184,1184 density 0.6851851851851852,0.6851851851851852
before tensor 4096 mask 666.0 4096
layer1.0.conv1.weight, mask/weight parameters,666,666 density 0.2214095744680851,0.2214095744680851
before tensor 36864 mask 3732.0 36864
layer1.0.conv2.weight, mask/weight parameters,3732,3732 density 0.18771691564810622,0.18771691564810622
before tensor 16384 mask 3822.0 16384
layer1.0.conv3.weight, mask/weight parameters,3822,3822 density 0.3176529255319149,0.3176529255319149
layer1.0.shortcut.0.weight, mask/weight parameters,5675,5675 density 0.34637451171875,0.34637451171875
before tensor 16384 mask 2452.0 16384
layer1.1.conv1.weight, mask/weight parameters,2452,2452 density 0.20378989361702127,0.20378989361702127
before tensor 36864 mask 4034.0 36864
layer1.1.conv2.weight, mask/weight parameters,4034,4034 density 0.20290729842563252,0.20290729842563252
before tensor 16384 mask 2240.0 16384
layer1.1.conv3.weight, mask/weight parameters,2240,2240 density 0.18617021276595744,0.18617021276595744
before tensor 16384 mask 2851.0 16384
layer1.2.conv1.weight, mask/weight parameters,2851,2851 density 0.23695146276595744,0.23695146276595744
before tensor 36864 mask 3463.0 36864
layer1.2.conv2.weight, mask/weight parameters,3463,3463 density 0.17418640913434938,0.17418640913434938
before tensor 16384 mask 1867.0 16384
layer1.2.conv3.weight, mask/weight parameters,1867,1867 density 0.1551695478723404,0.1551695478723404
before tensor 32768 mask 5424.0 32768
layer2.0.conv1.weight, mask/weight parameters,5424,5424 density 0.2825,0.2825
before tensor 147456 mask 12615.0 147456
layer2.0.conv2.weight, mask/weight parameters,12615,12615 density 0.24918518518518518,0.24918518518518518
before tensor 65536 mask 7040.0 65536
layer2.0.conv3.weight, mask/weight parameters,7040,7040 density 0.18333333333333332,0.18333333333333332
layer2.0.shortcut.0.weight, mask/weight parameters,30262,30262 density 0.2308807373046875,0.2308807373046875
before tensor 65536 mask 3599.0 65536
layer2.1.conv1.weight, mask/weight parameters,3599,3599 density 0.09372395833333333,0.09372395833333333
before tensor 147456 mask 4174.0 147456
layer2.1.conv2.weight, mask/weight parameters,4174,4174 density 0.08244938271604939,0.08244938271604939
before tensor 65536 mask 4203.0 65536
layer2.1.conv3.weight, mask/weight parameters,4203,4203 density 0.109453125,0.109453125
before tensor 65536 mask 10477.0 65536
layer2.2.conv1.weight, mask/weight parameters,10477,10477 density 0.27283854166666666,0.27283854166666666
before tensor 147456 mask 21566.0 147456
layer2.2.conv2.weight, mask/weight parameters,21566,21566 density 0.4259950617283951,0.4259950617283951
before tensor 65536 mask 13437.0 65536
layer2.2.conv3.weight, mask/weight parameters,13437,13437 density 0.349921875,0.349921875
before tensor 65536 mask 10713.0 65536
layer2.3.conv1.weight, mask/weight parameters,10713,10713 density 0.278984375,0.278984375
before tensor 147456 mask 20469.0 147456
layer2.3.conv2.weight, mask/weight parameters,20469,20469 density 0.4043259259259259,0.4043259259259259
before tensor 65536 mask 11158.0 65536
layer2.3.conv3.weight, mask/weight parameters,11158,11158 density 0.2905729166666667,0.2905729166666667
before tensor 131072 mask 29730.0 131072
layer3.0.conv1.weight, mask/weight parameters,29730,29730 density 0.4572157972440945,0.4572157972440945
before tensor 589824 mask 62367.0 589824
layer3.0.conv2.weight, mask/weight parameters,62367,62367 density 0.42964019261371855,0.42964019261371855
before tensor 262144 mask 57781.0 262144
layer3.0.conv3.weight, mask/weight parameters,57781,57781 density 0.44430517962598426,0.44430517962598426
layer3.0.shortcut.0.weight, mask/weight parameters,98157,98157 density 0.18721961975097656,0.18721961975097656
before tensor 262144 mask 27814.0 262144
layer3.1.conv1.weight, mask/weight parameters,27814,27814 density 0.21387487696850394,0.21387487696850394
before tensor 589824 mask 60088.0 589824
layer3.1.conv2.weight, mask/weight parameters,60088,60088 density 0.41394038343632245,0.41394038343632245
before tensor 262144 mask 51848.0 262144
layer3.1.conv3.weight, mask/weight parameters,51848,51848 density 0.398683562992126,0.398683562992126
before tensor 262144 mask 30004.0 262144
layer3.2.conv1.weight, mask/weight parameters,30004,30004 density 0.23071481299212598,0.23071481299212598
before tensor 589824 mask 53297.0 589824
layer3.2.conv2.weight, mask/weight parameters,53297,53297 density 0.36715784542680197,0.36715784542680197
before tensor 262144 mask 50392.0 262144
layer3.2.conv3.weight, mask/weight parameters,50392,50392 density 0.3874876968503937,0.3874876968503937
before tensor 262144 mask 33577.0 262144
layer3.3.conv1.weight, mask/weight parameters,33577,33577 density 0.25818928395669294,0.25818928395669294
before tensor 589824 mask 47716.0 589824
layer3.3.conv2.weight, mask/weight parameters,47716,47716 density 0.3287108796439815,0.3287108796439815
before tensor 262144 mask 43655.0 262144
layer3.3.conv3.weight, mask/weight parameters,43655,43655 density 0.3356837475393701,0.3356837475393701
before tensor 262144 mask 38663.0 262144
layer3.4.conv1.weight, mask/weight parameters,38663,38663 density 0.29729792076771655,0.29729792076771655
before tensor 589824 mask 49140.0 589824
layer3.4.conv2.weight, mask/weight parameters,49140,49140 density 0.3385206770413541,0.3385206770413541
before tensor 262144 mask 40694.0 262144
layer3.4.conv3.weight, mask/weight parameters,40694,40694 density 0.3129152312992126,0.3129152312992126
before tensor 262144 mask 44971.0 262144
layer3.5.conv1.weight, mask/weight parameters,44971,44971 density 0.34580308809055116,0.34580308809055116
before tensor 589824 mask 48654.0 589824
layer3.5.conv2.weight, mask/weight parameters,48654,48654 density 0.3351726703453407,0.3351726703453407
before tensor 262144 mask 39603.0 262144
layer3.5.conv3.weight, mask/weight parameters,39603,39603 density 0.3045260211614173,0.3045260211614173
before tensor 524288 mask 135768.0 524288
layer4.0.conv1.weight, mask/weight parameters,135768,135768 density 0.5739650974025974,0.5739650974025974
before tensor 2359296 mask 197657.0 2359296
layer4.0.conv2.weight, mask/weight parameters,197657,197657 density 0.4115719137364159,0.4115719137364159
before tensor 1048576 mask 104149.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104149,104149 density 0.2201472030573593,0.2201472030573593
layer4.0.shortcut.0.weight, mask/weight parameters,141860,141860 density 0.06764411926269531,0.06764411926269531
before tensor 1048576 mask 118717.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118717,118717 density 0.2509406283820346,0.2509406283820346
before tensor 2359296 mask 194111.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194111,194111 density 0.40418824401508385,0.40418824401508385
before tensor 1048576 mask 84120.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84120,84120 density 0.17781047077922077,0.17781047077922077
before tensor 1048576 mask 81197.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81197,81197 density 0.1716319162608225,0.1716319162608225
before tensor 2359296 mask 70426.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70426,70426 density 0.1466447613633761,0.1466447613633761
before tensor 1048576 mask 35557.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35557,35557 density 0.07515937838203464,0.07515937838203464
classifier.weight, mask/weight parameters,106369,106369 density 0.5193798828125,0.5193798828125
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.23656819214753694 0.23656819214753694 after dst
Death rate: 0.10046574684651478

dynamic sparse change grow
self.total_params*pruning_rate 2376219.0593176666
self.total_nonzero 2365205.0
to grow 11014.059317666572
len(all_scores) 9997984 6653135
increse 11014.0 before_mask 2376218.0 after_mask 2376218.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1187,1184 density 0.6869212962962963,0.6851851851851852
before tensor 4096 mask 667.0 4096
layer1.0.conv1.weight, mask/weight parameters,667,666 density 0.22174202127659576,0.2214095744680851
before tensor 36864 mask 3733.0 36864
layer1.0.conv2.weight, mask/weight parameters,3733,3732 density 0.18776721492882653,0.18771691564810622
before tensor 16384 mask 3827.0 16384
layer1.0.conv3.weight, mask/weight parameters,3827,3822 density 0.31806848404255317,0.3176529255319149
layer1.0.shortcut.0.weight, mask/weight parameters,5693,5675 density 0.34747314453125,0.34637451171875
before tensor 16384 mask 2456.0 16384
layer1.1.conv1.weight, mask/weight parameters,2456,2452 density 0.20412234042553193,0.20378989361702127
before tensor 36864 mask 4037.0 36864
layer1.1.conv2.weight, mask/weight parameters,4037,4034 density 0.20305819626779337,0.20290729842563252
before tensor 16384 mask 2251.0 16384
layer1.1.conv3.weight, mask/weight parameters,2251,2240 density 0.1870844414893617,0.18617021276595744
before tensor 16384 mask 2851.0 16384
layer1.2.conv1.weight, mask/weight parameters,2851,2851 density 0.23695146276595744,0.23695146276595744
before tensor 36864 mask 3464.0 36864
layer1.2.conv2.weight, mask/weight parameters,3464,3463 density 0.17423670841506966,0.17418640913434938
before tensor 16384 mask 1868.0 16384
layer1.2.conv3.weight, mask/weight parameters,1868,1867 density 0.15525265957446807,0.1551695478723404
before tensor 32768 mask 5424.0 32768
layer2.0.conv1.weight, mask/weight parameters,5424,5424 density 0.2825,0.2825
before tensor 147456 mask 12623.0 147456
layer2.0.conv2.weight, mask/weight parameters,12623,12615 density 0.2493432098765432,0.24918518518518518
before tensor 65536 mask 7052.0 65536
layer2.0.conv3.weight, mask/weight parameters,7052,7040 density 0.18364583333333334,0.18333333333333332
layer2.0.shortcut.0.weight, mask/weight parameters,30297,30262 density 0.23114776611328125,0.2308807373046875
before tensor 65536 mask 3601.0 65536
layer2.1.conv1.weight, mask/weight parameters,3601,3599 density 0.09377604166666667,0.09372395833333333
before tensor 147456 mask 4176.0 147456
layer2.1.conv2.weight, mask/weight parameters,4176,4174 density 0.08248888888888889,0.08244938271604939
before tensor 65536 mask 4218.0 65536
layer2.1.conv3.weight, mask/weight parameters,4218,4203 density 0.10984375,0.109453125
before tensor 65536 mask 10484.0 65536
layer2.2.conv1.weight, mask/weight parameters,10484,10477 density 0.2730208333333333,0.27283854166666666
before tensor 147456 mask 21581.0 147456
layer2.2.conv2.weight, mask/weight parameters,21581,21566 density 0.42629135802469137,0.4259950617283951
before tensor 65536 mask 13464.0 65536
layer2.2.conv3.weight, mask/weight parameters,13464,13437 density 0.350625,0.349921875
before tensor 65536 mask 10719.0 65536
layer2.3.conv1.weight, mask/weight parameters,10719,10713 density 0.279140625,0.278984375
before tensor 147456 mask 20501.0 147456
layer2.3.conv2.weight, mask/weight parameters,20501,20469 density 0.404958024691358,0.4043259259259259
before tensor 65536 mask 11192.0 65536
layer2.3.conv3.weight, mask/weight parameters,11192,11158 density 0.2914583333333333,0.2905729166666667
before tensor 131072 mask 29773.0 131072
layer3.0.conv1.weight, mask/weight parameters,29773,29730 density 0.45787709153543305,0.4572157972440945
before tensor 589824 mask 62482.0 589824
layer3.0.conv2.weight, mask/weight parameters,62482,62367 density 0.4304324164203884,0.42964019261371855
before tensor 262144 mask 57921.0 262144
layer3.0.conv3.weight, mask/weight parameters,57921,57781 density 0.4453817052165354,0.44430517962598426
layer3.0.shortcut.0.weight, mask/weight parameters,98331,98157 density 0.18755149841308594,0.18721961975097656
before tensor 262144 mask 27919.0 262144
layer3.1.conv1.weight, mask/weight parameters,27919,27814 density 0.21468227116141733,0.21387487696850394
before tensor 589824 mask 60215.0 589824
layer3.1.conv2.weight, mask/weight parameters,60215,60088 density 0.4148152740749926,0.41394038343632245
before tensor 262144 mask 52027.0 262144
layer3.1.conv3.weight, mask/weight parameters,52027,51848 density 0.40005997785433073,0.398683562992126
before tensor 262144 mask 30078.0 262144
layer3.2.conv1.weight, mask/weight parameters,30078,30004 density 0.23128383366141733,0.23071481299212598
before tensor 589824 mask 53425.0 589824
layer3.2.conv2.weight, mask/weight parameters,53425,53297 density 0.3680396249681388,0.36715784542680197
before tensor 262144 mask 50537.0 262144
layer3.2.conv3.weight, mask/weight parameters,50537,50392 density 0.3886026697834646,0.3874876968503937
before tensor 262144 mask 33627.0 262144
layer3.3.conv1.weight, mask/weight parameters,33627,33577 density 0.25857375738188976,0.25818928395669294
before tensor 589824 mask 47778.0 589824
layer3.3.conv2.weight, mask/weight parameters,47778,47716 density 0.32913799160931656,0.3287108796439815
before tensor 262144 mask 43768.0 262144
layer3.3.conv3.weight, mask/weight parameters,43768,43655 density 0.336552657480315,0.3356837475393701
before tensor 262144 mask 38769.0 262144
layer3.4.conv1.weight, mask/weight parameters,38769,38663 density 0.29811300442913385,0.29729792076771655
before tensor 589824 mask 49349.0 589824
layer3.4.conv2.weight, mask/weight parameters,49349,49140 density 0.33996045769869315,0.3385206770413541
before tensor 262144 mask 40877.0 262144
layer3.4.conv3.weight, mask/weight parameters,40877,40694 density 0.31432240403543305,0.3129152312992126
before tensor 262144 mask 45269.0 262144
layer3.5.conv1.weight, mask/weight parameters,45269,44971 density 0.3480945497047244,0.34580308809055116
before tensor 589824 mask 49027.0 589824
layer3.5.conv2.weight, mask/weight parameters,49027,48654 density 0.33774223104001766,0.3351726703453407
before tensor 262144 mask 39808.0 262144
layer3.5.conv3.weight, mask/weight parameters,39808,39603 density 0.3061023622047244,0.3045260211614173
before tensor 524288 mask 136477.0 524288
layer4.0.conv1.weight, mask/weight parameters,136477,135768 density 0.5769624255952381,0.5739650974025974
before tensor 2359296 mask 199186.0 2359296
layer4.0.conv2.weight, mask/weight parameters,199186,197657 density 0.4147556788249429,0.4115719137364159
before tensor 1048576 mask 104824.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104824,104149 density 0.22157399891774893,0.2201472030573593
layer4.0.shortcut.0.weight, mask/weight parameters,142210,141860 density 0.0678110122680664,0.06764411926269531
before tensor 1048576 mask 119704.0 1048576
layer4.1.conv1.weight, mask/weight parameters,119704,118717 density 0.253026920995671,0.2509406283820346
before tensor 2359296 mask 196009.0 2359296
layer4.1.conv2.weight, mask/weight parameters,196009,194111 density 0.4081403605213129,0.40418824401508385
before tensor 1048576 mask 84614.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84614,84120 density 0.17885467397186147,0.17781047077922077
before tensor 1048576 mask 81872.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81872,81197 density 0.17305871212121213,0.1716319162608225
before tensor 2359296 mask 70888.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70888,70426 density 0.14760676232537703,0.1466447613633761
before tensor 1048576 mask 35689.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35689,35557 density 0.07543839623917749,0.07515937838203464
classifier.weight, mask/weight parameters,106399,106369 density 0.5195263671875,0.5193798828125
Total Model parameters after dst: 2376218 2365205
Total parameters under density level of 0.1: 0.23766971421438562 0.23656819214753694 after dst
Death rate: 0.10046574684651478


Training summary: Average loss: 0.1435, Accuracy: 48136/50000 (96.272%)


Evaluation: Average loss: 0.9366, Accuracy: 7612/10000 (76.120%)

Current learning rate: 0.001. Time taken for epoch: 88.71 seconds.

Train Epoch: 122 [0/50000 (0%)]	Loss: 0.162722 Accuracy: 95/100 (95.000%
Train Epoch: 122 [10000/50000 (20%)]	Loss: 0.143672 Accuracy: 9797/10100 (97.000%
Train Epoch: 122 [20000/50000 (40%)]	Loss: 0.127282 Accuracy: 19505/20100 (97.040%
Train Epoch: 122 [30000/50000 (60%)]	Loss: 0.062227 Accuracy: 29188/30100 (96.970%
Train Epoch: 122 [40000/50000 (80%)]	Loss: 0.126771 Accuracy: 38913/40100 (97.040%
current layer rate 0.49992193900773785
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
3792.0 / 7552 channels
Total channels to prune: 15.410483386436226
update_filter_mask
After update_filter_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
After apply_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
Total pruned: 0/15.410483386436226 channels
===========done ===============

Training summary: Average loss: 0.1232, Accuracy: 48523/50000 (97.046%)


Evaluation: Average loss: 0.9402, Accuracy: 7640/10000 (76.400%)

Current learning rate: 0.001. Time taken for epoch: 88.53 seconds.

Train Epoch: 123 [0/50000 (0%)]	Loss: 0.138850 Accuracy: 97/100 (97.000%
Train Epoch: 123 [10000/50000 (20%)]	Loss: 0.164543 Accuracy: 9808/10100 (97.109%
Train Epoch: 123 [20000/50000 (40%)]	Loss: 0.140645 Accuracy: 19569/20100 (97.358%
Train Epoch: 123 [30000/50000 (60%)]	Loss: 0.092006 Accuracy: 29316/30100 (97.395%
Train Epoch: 123 [40000/50000 (80%)]	Loss: 0.096242 Accuracy: 39034/40100 (97.342%
current mest  death_rate 0.10026234001372378


dynamic sparse change prune
to kill 11014.799999998882 expect 2365203.200000001
conv1.weight, mask/weight parameters,1184,1184 density 0.6851851851851852,0.6851851851851852
before tensor 4096 mask 666.0 4096
layer1.0.conv1.weight, mask/weight parameters,666,666 density 0.2214095744680851,0.2214095744680851
before tensor 36864 mask 3725.0 36864
layer1.0.conv2.weight, mask/weight parameters,3725,3725 density 0.18736482068306423,0.18736482068306423
before tensor 16384 mask 3820.0 16384
layer1.0.conv3.weight, mask/weight parameters,3820,3820 density 0.31748670212765956,0.31748670212765956
layer1.0.shortcut.0.weight, mask/weight parameters,5664,5664 density 0.345703125,0.345703125
before tensor 16384 mask 2452.0 16384
layer1.1.conv1.weight, mask/weight parameters,2452,2452 density 0.20378989361702127,0.20378989361702127
before tensor 36864 mask 4022.0 36864
layer1.1.conv2.weight, mask/weight parameters,4022,4022 density 0.20230370705698908,0.20230370705698908
before tensor 16384 mask 2245.0 16384
layer1.1.conv3.weight, mask/weight parameters,2245,2245 density 0.18658577127659576,0.18658577127659576
before tensor 16384 mask 2843.0 16384
layer1.2.conv1.weight, mask/weight parameters,2843,2843 density 0.23628656914893617,0.23628656914893617
before tensor 36864 mask 3458.0 36864
layer1.2.conv2.weight, mask/weight parameters,3458,3458 density 0.17393491273074796,0.17393491273074796
before tensor 16384 mask 1864.0 16384
layer1.2.conv3.weight, mask/weight parameters,1864,1864 density 0.15492021276595744,0.15492021276595744
before tensor 32768 mask 5406.0 32768
layer2.0.conv1.weight, mask/weight parameters,5406,5406 density 0.2815625,0.2815625
before tensor 147456 mask 12592.0 147456
layer2.0.conv2.weight, mask/weight parameters,12592,12592 density 0.24873086419753088,0.24873086419753088
before tensor 65536 mask 7033.0 65536
layer2.0.conv3.weight, mask/weight parameters,7033,7033 density 0.18315104166666665,0.18315104166666665
layer2.0.shortcut.0.weight, mask/weight parameters,30213,30213 density 0.23050689697265625,0.23050689697265625
before tensor 65536 mask 3592.0 65536
layer2.1.conv1.weight, mask/weight parameters,3592,3592 density 0.09354166666666666,0.09354166666666666
before tensor 147456 mask 4157.0 147456
layer2.1.conv2.weight, mask/weight parameters,4157,4157 density 0.08211358024691358,0.08211358024691358
before tensor 65536 mask 4208.0 65536
layer2.1.conv3.weight, mask/weight parameters,4208,4208 density 0.10958333333333334,0.10958333333333334
before tensor 65536 mask 10460.0 65536
layer2.2.conv1.weight, mask/weight parameters,10460,10460 density 0.27239583333333334,0.27239583333333334
before tensor 147456 mask 21514.0 147456
layer2.2.conv2.weight, mask/weight parameters,21514,21514 density 0.4249679012345679,0.4249679012345679
before tensor 65536 mask 13429.0 65536
layer2.2.conv3.weight, mask/weight parameters,13429,13429 density 0.3497135416666667,0.3497135416666667
before tensor 65536 mask 10683.0 65536
layer2.3.conv1.weight, mask/weight parameters,10683,10683 density 0.278203125,0.278203125
before tensor 147456 mask 20445.0 147456
layer2.3.conv2.weight, mask/weight parameters,20445,20445 density 0.40385185185185185,0.40385185185185185
before tensor 65536 mask 11143.0 65536
layer2.3.conv3.weight, mask/weight parameters,11143,11143 density 0.29018229166666665,0.29018229166666665
before tensor 131072 mask 29670.0 131072
layer3.0.conv1.weight, mask/weight parameters,29670,29670 density 0.45629306102362205,0.45629306102362205
before tensor 589824 mask 62288.0 589824
layer3.0.conv2.weight, mask/weight parameters,62288,62288 density 0.4290959693030497,0.4290959693030497
before tensor 262144 mask 57696.0 262144
layer3.0.conv3.weight, mask/weight parameters,57696,57696 density 0.4436515748031496,0.4436515748031496
layer3.0.shortcut.0.weight, mask/weight parameters,97991,97991 density 0.1869029998779297,0.1869029998779297
before tensor 262144 mask 27793.0 262144
layer3.1.conv1.weight, mask/weight parameters,27793,27793 density 0.21371339812992127,0.21371339812992127
before tensor 589824 mask 59966.0 589824
layer3.1.conv2.weight, mask/weight parameters,59966,59966 density 0.4130999373109857,0.4130999373109857
before tensor 262144 mask 51801.0 262144
layer3.1.conv3.weight, mask/weight parameters,51801,51801 density 0.39832215797244097,0.39832215797244097
before tensor 262144 mask 29958.0 262144
layer3.2.conv1.weight, mask/weight parameters,29958,29958 density 0.23036109744094488,0.23036109744094488
before tensor 589824 mask 53164.0 589824
layer3.2.conv2.weight, mask/weight parameters,53164,53164 density 0.3662416213721316,0.3662416213721316
before tensor 262144 mask 50328.0 262144
layer3.2.conv3.weight, mask/weight parameters,50328,50328 density 0.3869955708661417,0.3869955708661417
before tensor 262144 mask 33478.0 262144
layer3.3.conv1.weight, mask/weight parameters,33478,33478 density 0.2574280265748031,0.2574280265748031
before tensor 589824 mask 47620.0 589824
layer3.3.conv2.weight, mask/weight parameters,47620,47620 density 0.3280495449879789,0.3280495449879789
before tensor 262144 mask 43595.0 262144
layer3.3.conv3.weight, mask/weight parameters,43595,43595 density 0.33522237942913385,0.33522237942913385
before tensor 262144 mask 38604.0 262144
layer3.4.conv1.weight, mask/weight parameters,38604,38604 density 0.29684424212598426,0.29684424212598426
before tensor 589824 mask 49131.0 589824
layer3.4.conv2.weight, mask/weight parameters,49131,49131 density 0.3384586769173538,0.3384586769173538
before tensor 262144 mask 40705.0 262144
layer3.4.conv3.weight, mask/weight parameters,40705,40705 density 0.3129998154527559,0.3129998154527559
before tensor 262144 mask 45014.0 262144
layer3.5.conv1.weight, mask/weight parameters,45014,45014 density 0.3461337352362205,0.3461337352362205
before tensor 589824 mask 48751.0 589824
layer3.5.conv2.weight, mask/weight parameters,48751,48751 density 0.33584089390401,0.33584089390401
before tensor 262144 mask 39639.0 262144
layer3.5.conv3.weight, mask/weight parameters,39639,39639 density 0.30480284202755903,0.30480284202755903
before tensor 524288 mask 135840.0 524288
layer4.0.conv1.weight, mask/weight parameters,135840,135840 density 0.5742694805194806,0.5742694805194806
before tensor 2359296 mask 197988.0 2359296
layer4.0.conv2.weight, mask/weight parameters,197988,197988 density 0.4122611395338668,0.4122611395338668
before tensor 1048576 mask 104263.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104263,104263 density 0.22038817302489178,0.22038817302489178
layer4.0.shortcut.0.weight, mask/weight parameters,141683,141683 density 0.06755971908569336,0.06755971908569336
before tensor 1048576 mask 118929.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118929,118929 density 0.2513887479707792,0.2513887479707792
before tensor 2359296 mask 194677.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194677,194677 density 0.40536679930619324,0.40536679930619324
before tensor 1048576 mask 84204.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84204,84204 density 0.1779880275974026,0.1779880275974026
before tensor 1048576 mask 81296.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81296,81296 density 0.17184117965367965,0.17184117965367965
before tensor 2359296 mask 70411.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70411,70411 density 0.1466135275659085,0.1466135275659085
before tensor 1048576 mask 35544.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35544,35544 density 0.07513189935064934,0.07513189935064934
classifier.weight, mask/weight parameters,106360,106360 density 0.5193359375,0.5193359375
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.23656819214753694 0.23656819214753694 after dst
Death rate: 0.10026234001372378

dynamic sparse change grow
self.total_params*pruning_rate 2371408.074399475
self.total_nonzero 2365205.0
to grow 6203.074399475008
len(all_scores) 9997984 6653021
increse 6203.0 before_mask 2371407.0 after_mask 2371407.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1188,1184 density 0.6875,0.6851851851851852
before tensor 4096 mask 666.0 4096
layer1.0.conv1.weight, mask/weight parameters,666,666 density 0.2214095744680851,0.2214095744680851
before tensor 36864 mask 3727.0 36864
layer1.0.conv2.weight, mask/weight parameters,3727,3725 density 0.1874654192445048,0.18736482068306423
before tensor 16384 mask 3828.0 16384
layer1.0.conv3.weight, mask/weight parameters,3828,3820 density 0.3181515957446808,0.31748670212765956
layer1.0.shortcut.0.weight, mask/weight parameters,5674,5664 density 0.3463134765625,0.345703125
before tensor 16384 mask 2453.0 16384
layer1.1.conv1.weight, mask/weight parameters,2453,2452 density 0.20387300531914893,0.20378989361702127
before tensor 36864 mask 4025.0 36864
layer1.1.conv2.weight, mask/weight parameters,4025,4022 density 0.20245460489914993,0.20230370705698908
before tensor 16384 mask 2246.0 16384
layer1.1.conv3.weight, mask/weight parameters,2246,2245 density 0.18666888297872342,0.18658577127659576
before tensor 16384 mask 2845.0 16384
layer1.2.conv1.weight, mask/weight parameters,2845,2843 density 0.2364527925531915,0.23628656914893617
before tensor 36864 mask 3465.0 36864
layer1.2.conv2.weight, mask/weight parameters,3465,3458 density 0.17428700769578995,0.17393491273074796
before tensor 16384 mask 1867.0 16384
layer1.2.conv3.weight, mask/weight parameters,1867,1864 density 0.1551695478723404,0.15492021276595744
before tensor 32768 mask 5407.0 32768
layer2.0.conv1.weight, mask/weight parameters,5407,5406 density 0.28161458333333333,0.2815625
before tensor 147456 mask 12595.0 147456
layer2.0.conv2.weight, mask/weight parameters,12595,12592 density 0.24879012345679014,0.24873086419753088
before tensor 65536 mask 7042.0 65536
layer2.0.conv3.weight, mask/weight parameters,7042,7033 density 0.18338541666666666,0.18315104166666665
layer2.0.shortcut.0.weight, mask/weight parameters,30239,30213 density 0.23070526123046875,0.23050689697265625
before tensor 65536 mask 3592.0 65536
layer2.1.conv1.weight, mask/weight parameters,3592,3592 density 0.09354166666666666,0.09354166666666666
before tensor 147456 mask 4158.0 147456
layer2.1.conv2.weight, mask/weight parameters,4158,4157 density 0.08213333333333334,0.08211358024691358
before tensor 65536 mask 4209.0 65536
layer2.1.conv3.weight, mask/weight parameters,4209,4208 density 0.109609375,0.10958333333333334
before tensor 65536 mask 10462.0 65536
layer2.2.conv1.weight, mask/weight parameters,10462,10460 density 0.2724479166666667,0.27239583333333334
before tensor 147456 mask 21516.0 147456
layer2.2.conv2.weight, mask/weight parameters,21516,21514 density 0.4250074074074074,0.4249679012345679
before tensor 65536 mask 13451.0 65536
layer2.2.conv3.weight, mask/weight parameters,13451,13429 density 0.35028645833333333,0.3497135416666667
before tensor 65536 mask 10686.0 65536
layer2.3.conv1.weight, mask/weight parameters,10686,10683 density 0.27828125,0.278203125
before tensor 147456 mask 20478.0 147456
layer2.3.conv2.weight, mask/weight parameters,20478,20445 density 0.4045037037037037,0.40385185185185185
before tensor 65536 mask 11167.0 65536
layer2.3.conv3.weight, mask/weight parameters,11167,11143 density 0.2908072916666667,0.29018229166666665
before tensor 131072 mask 29711.0 131072
layer3.0.conv1.weight, mask/weight parameters,29711,29670 density 0.4569235974409449,0.45629306102362205
before tensor 589824 mask 62330.0 589824
layer3.0.conv2.weight, mask/weight parameters,62330,62288 density 0.42938530321505086,0.4290959693030497
before tensor 262144 mask 57816.0 262144
layer3.0.conv3.weight, mask/weight parameters,57816,57696 density 0.44457431102362205,0.4436515748031496
layer3.0.shortcut.0.weight, mask/weight parameters,98132,97991 density 0.18717193603515625,0.1869029998779297
before tensor 262144 mask 27829.0 262144
layer3.1.conv1.weight, mask/weight parameters,27829,27793 density 0.213990218996063,0.21371339812992127
before tensor 589824 mask 60054.0 589824
layer3.1.conv2.weight, mask/weight parameters,60054,59966 density 0.4137061607456548,0.4130999373109857
before tensor 262144 mask 51966.0 262144
layer3.1.conv3.weight, mask/weight parameters,51966,51801 density 0.39959092027559057,0.39832215797244097
before tensor 262144 mask 29972.0 262144
layer3.2.conv1.weight, mask/weight parameters,29972,29958 density 0.23046875,0.23036109744094488
before tensor 589824 mask 53233.0 589824
layer3.2.conv2.weight, mask/weight parameters,53233,53164 density 0.36671695565613355,0.3662416213721316
before tensor 262144 mask 50463.0 262144
layer3.2.conv3.weight, mask/weight parameters,50463,50328 density 0.3880336491141732,0.3869955708661417
before tensor 262144 mask 33504.0 262144
layer3.3.conv1.weight, mask/weight parameters,33504,33478 density 0.2576279527559055,0.2574280265748031
before tensor 589824 mask 47674.0 589824
layer3.3.conv2.weight, mask/weight parameters,47674,47620 density 0.32842154573198035,0.3280495449879789
before tensor 262144 mask 43664.0 262144
layer3.3.conv3.weight, mask/weight parameters,43664,43595 density 0.3357529527559055,0.33522237942913385
before tensor 262144 mask 38660.0 262144
layer3.4.conv1.weight, mask/weight parameters,38660,38604 density 0.29727485236220474,0.29684424212598426
before tensor 589824 mask 49182.0 589824
layer3.4.conv2.weight, mask/weight parameters,49182,49131 density 0.3388100109533552,0.3384586769173538
before tensor 262144 mask 40795.0 262144
layer3.4.conv3.weight, mask/weight parameters,40795,40705 density 0.31369186761811024,0.3129998154527559
before tensor 262144 mask 45093.0 262144
layer3.5.conv1.weight, mask/weight parameters,45093,45014 density 0.3467412032480315,0.3461337352362205
before tensor 589824 mask 48857.0 589824
layer3.5.conv2.weight, mask/weight parameters,48857,48751 density 0.3365711175866796,0.33584089390401
before tensor 262144 mask 39696.0 262144
layer3.5.conv3.weight, mask/weight parameters,39696,39639 density 0.30524114173228345,0.30480284202755903
before tensor 524288 mask 136277.0 524288
layer4.0.conv1.weight, mask/weight parameters,136277,135840 density 0.5761169169372294,0.5742694805194806
before tensor 2359296 mask 198680.0 2359296
layer4.0.conv2.weight, mask/weight parameters,198680,197988 density 0.41370205872370375,0.4122611395338668
before tensor 1048576 mask 104546.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104546,104263 density 0.2209863704004329,0.22038817302489178
layer4.0.shortcut.0.weight, mask/weight parameters,141834,141683 density 0.06763172149658203,0.06755971908569336
before tensor 1048576 mask 119231.0 1048576
layer4.1.conv1.weight, mask/weight parameters,119231,118929 density 0.25202710700757575,0.2513887479707792
before tensor 2359296 mask 195745.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195745,194677 density 0.40759064568588377,0.40536679930619324
before tensor 1048576 mask 84607.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84607,84204 density 0.17883987757034633,0.1779880275974026
before tensor 1048576 mask 81800.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81800,81296 density 0.17290652056277056,0.17184117965367965
before tensor 2359296 mask 70973.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70973,70411 density 0.1477837538443599,0.1466135275659085
before tensor 1048576 mask 35650.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35650,35544 density 0.07535595914502165,0.07513189935064934
classifier.weight, mask/weight parameters,106447,106360 density 0.5197607421875,0.5193359375
Total Model parameters after dst: 2371407 2365205
Total parameters under density level of 0.1: 0.23718851720506853 0.23656819214753694 after dst
Death rate: 0.10026234001372378


Training summary: Average loss: 0.1139, Accuracy: 48684/50000 (97.368%)


Evaluation: Average loss: 0.9319, Accuracy: 7642/10000 (76.420%)

Current learning rate: 0.001. Time taken for epoch: 88.70 seconds.

Train Epoch: 124 [0/50000 (0%)]	Loss: 0.101227 Accuracy: 97/100 (97.000%
Train Epoch: 124 [10000/50000 (20%)]	Loss: 0.070547 Accuracy: 9874/10100 (97.762%
Train Epoch: 124 [20000/50000 (40%)]	Loss: 0.123573 Accuracy: 19626/20100 (97.642%
Train Epoch: 124 [30000/50000 (60%)]	Loss: 0.113749 Accuracy: 29385/30100 (97.625%
Train Epoch: 124 [40000/50000 (80%)]	Loss: 0.120570 Accuracy: 39139/40100 (97.603%
current layer rate 0.49997155211652256
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
3792.0 / 7552 channels
Total channels to prune: 15.785161583978152
update_filter_mask
After update_filter_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
After apply_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
Total pruned: 0/15.785161583978152 channels
===========done ===============

Training summary: Average loss: 0.1044, Accuracy: 48785/50000 (97.570%)


Evaluation: Average loss: 0.9260, Accuracy: 7636/10000 (76.360%)

Current learning rate: 0.001. Time taken for epoch: 88.52 seconds.

Train Epoch: 125 [0/50000 (0%)]	Loss: 0.081708 Accuracy: 98/100 (98.000%
Train Epoch: 125 [10000/50000 (20%)]	Loss: 0.091428 Accuracy: 9869/10100 (97.713%
Train Epoch: 125 [20000/50000 (40%)]	Loss: 0.068219 Accuracy: 19625/20100 (97.637%
Train Epoch: 125 [30000/50000 (60%)]	Loss: 0.081902 Accuracy: 29414/30100 (97.721%
Train Epoch: 125 [40000/50000 (80%)]	Loss: 0.099705 Accuracy: 39199/40100 (97.753%
current mest  death_rate 0.10011670913205867


dynamic sparse change prune
to kill 6203.799999998882 expect 2365203.200000001
conv1.weight, mask/weight parameters,1187,1187 density 0.6869212962962963,0.6869212962962963
before tensor 4096 mask 665.0 4096
layer1.0.conv1.weight, mask/weight parameters,665,665 density 0.22107712765957446,0.22107712765957446
before tensor 36864 mask 3720.0 36864
layer1.0.conv2.weight, mask/weight parameters,3720,3720 density 0.1871133242794628,0.1871133242794628
before tensor 16384 mask 3827.0 16384
layer1.0.conv3.weight, mask/weight parameters,3827,3827 density 0.31806848404255317,0.31806848404255317
layer1.0.shortcut.0.weight, mask/weight parameters,5669,5669 density 0.34600830078125,0.34600830078125
before tensor 16384 mask 2450.0 16384
layer1.1.conv1.weight, mask/weight parameters,2450,2450 density 0.20362367021276595,0.20362367021276595
before tensor 36864 mask 4019.0 36864
layer1.1.conv2.weight, mask/weight parameters,4019,4019 density 0.20215280921482823,0.20215280921482823
before tensor 16384 mask 2246.0 16384
layer1.1.conv3.weight, mask/weight parameters,2246,2246 density 0.18666888297872342,0.18666888297872342
before tensor 16384 mask 2841.0 16384
layer1.2.conv1.weight, mask/weight parameters,2841,2841 density 0.23612034574468085,0.23612034574468085
before tensor 36864 mask 3457.0 36864
layer1.2.conv2.weight, mask/weight parameters,3457,3457 density 0.17388461345002768,0.17388461345002768
before tensor 16384 mask 1861.0 16384
layer1.2.conv3.weight, mask/weight parameters,1861,1861 density 0.15467087765957446,0.15467087765957446
before tensor 32768 mask 5398.0 32768
layer2.0.conv1.weight, mask/weight parameters,5398,5398 density 0.2811458333333333,0.2811458333333333
before tensor 147456 mask 12583.0 147456
layer2.0.conv2.weight, mask/weight parameters,12583,12583 density 0.2485530864197531,0.2485530864197531
before tensor 65536 mask 7035.0 65536
layer2.0.conv3.weight, mask/weight parameters,7035,7035 density 0.183203125,0.183203125
layer2.0.shortcut.0.weight, mask/weight parameters,30192,30192 density 0.2303466796875,0.2303466796875
before tensor 65536 mask 3589.0 65536
layer2.1.conv1.weight, mask/weight parameters,3589,3589 density 0.09346354166666666,0.09346354166666666
before tensor 147456 mask 4155.0 147456
layer2.1.conv2.weight, mask/weight parameters,4155,4155 density 0.08207407407407408,0.08207407407407408
before tensor 65536 mask 4204.0 65536
layer2.1.conv3.weight, mask/weight parameters,4204,4204 density 0.10947916666666667,0.10947916666666667
before tensor 65536 mask 10447.0 65536
layer2.2.conv1.weight, mask/weight parameters,10447,10447 density 0.27205729166666665,0.27205729166666665
before tensor 147456 mask 21487.0 147456
layer2.2.conv2.weight, mask/weight parameters,21487,21487 density 0.42443456790123457,0.42443456790123457
before tensor 65536 mask 13424.0 65536
layer2.2.conv3.weight, mask/weight parameters,13424,13424 density 0.34958333333333336,0.34958333333333336
before tensor 65536 mask 10673.0 65536
layer2.3.conv1.weight, mask/weight parameters,10673,10673 density 0.27794270833333334,0.27794270833333334
before tensor 147456 mask 20437.0 147456
layer2.3.conv2.weight, mask/weight parameters,20437,20437 density 0.40369382716049385,0.40369382716049385
before tensor 65536 mask 11144.0 65536
layer2.3.conv3.weight, mask/weight parameters,11144,11144 density 0.29020833333333335,0.29020833333333335
before tensor 131072 mask 29657.0 131072
layer3.0.conv1.weight, mask/weight parameters,29657,29657 density 0.4560931348425197,0.4560931348425197
before tensor 589824 mask 62217.0 589824
layer3.0.conv2.weight, mask/weight parameters,62217,62217 density 0.42860685721371444,0.42860685721371444
before tensor 262144 mask 57691.0 262144
layer3.0.conv3.weight, mask/weight parameters,57691,57691 density 0.4436131274606299,0.4436131274606299
layer3.0.shortcut.0.weight, mask/weight parameters,97935,97935 density 0.1867961883544922,0.1867961883544922
before tensor 262144 mask 27784.0 262144
layer3.1.conv1.weight, mask/weight parameters,27784,27784 density 0.21364419291338582,0.21364419291338582
before tensor 589824 mask 59917.0 589824
layer3.1.conv2.weight, mask/weight parameters,59917,59917 density 0.4127623810803177,0.4127623810803177
before tensor 262144 mask 51833.0 262144
layer3.1.conv3.weight, mask/weight parameters,51833,51833 density 0.39856822096456695,0.39856822096456695
before tensor 262144 mask 29903.0 262144
layer3.2.conv1.weight, mask/weight parameters,29903,29903 density 0.22993817667322836,0.22993817667322836
before tensor 589824 mask 53120.0 589824
layer3.2.conv2.weight, mask/weight parameters,53120,53120 density 0.3659385096547971,0.3659385096547971
before tensor 262144 mask 50344.0 262144
layer3.2.conv3.weight, mask/weight parameters,50344,50344 density 0.38711860236220474,0.38711860236220474
before tensor 262144 mask 33435.0 262144
layer3.3.conv1.weight, mask/weight parameters,33435,33435 density 0.25709737942913385,0.25709737942913385
before tensor 589824 mask 47561.0 589824
layer3.3.conv2.weight, mask/weight parameters,47561,47561 density 0.3276430997306439,0.3276430997306439
before tensor 262144 mask 43555.0 262144
layer3.3.conv3.weight, mask/weight parameters,43555,43555 density 0.3349148006889764,0.3349148006889764
before tensor 262144 mask 38562.0 262144
layer3.4.conv1.weight, mask/weight parameters,38562,38562 density 0.2965212844488189,0.2965212844488189
before tensor 589824 mask 49054.0 589824
layer3.4.conv2.weight, mask/weight parameters,49054,49054 density 0.3379282314120184,0.3379282314120184
before tensor 262144 mask 40682.0 262144
layer3.4.conv3.weight, mask/weight parameters,40682,40682 density 0.31282295767716534,0.31282295767716534
before tensor 262144 mask 44957.0 262144
layer3.5.conv1.weight, mask/weight parameters,44957,44957 density 0.34569543553149606,0.34569543553149606
before tensor 589824 mask 48708.0 589824
layer3.5.conv2.weight, mask/weight parameters,48708,48708 density 0.33554467108934216,0.33554467108934216
before tensor 262144 mask 39626.0 262144
layer3.5.conv3.weight, mask/weight parameters,39626,39626 density 0.30470287893700787,0.30470287893700787
before tensor 524288 mask 135896.0 524288
layer4.0.conv1.weight, mask/weight parameters,135896,135896 density 0.5745062229437229,0.5745062229437229
before tensor 2359296 mask 198036.0 2359296
layer4.0.conv2.weight, mask/weight parameters,198036,198036 density 0.412361087685763,0.412361087685763
before tensor 1048576 mask 104243.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104243,104243 density 0.22034589759199133,0.22034589759199133
layer4.0.shortcut.0.weight, mask/weight parameters,141586,141586 density 0.06751346588134766,0.06751346588134766
before tensor 1048576 mask 118830.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118830,118830 density 0.25117948457792205,0.25117948457792205
before tensor 2359296 mask 194985.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194985,194985 density 0.40600813328086055,0.40600813328086055
before tensor 1048576 mask 84342.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84342,84342 density 0.17827972808441558,0.17827972808441558
before tensor 1048576 mask 81466.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81466,81466 density 0.17220052083333334,0.17220052083333334
before tensor 2359296 mask 70615.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70615,70615 density 0.14703830721146738,0.14703830721146738
before tensor 1048576 mask 35565.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35565,35565 density 0.0751762885551948,0.0751762885551948
classifier.weight, mask/weight parameters,106390,106390 density 0.519482421875,0.519482421875
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.23656819214753694 0.23656819214753694 after dst
Death rate: 0.10011670913205867

dynamic sparse change grow
self.total_params*pruning_rate 2367963.608126144
self.total_nonzero 2365205.0
to grow 2758.608126143925
len(all_scores) 9997984 6653176
increse 2758.0 before_mask 2367962.0 after_mask 2367962.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1188,1187 density 0.6875,0.6869212962962963
before tensor 4096 mask 665.0 4096
layer1.0.conv1.weight, mask/weight parameters,665,665 density 0.22107712765957446,0.22107712765957446
before tensor 36864 mask 3720.0 36864
layer1.0.conv2.weight, mask/weight parameters,3720,3720 density 0.1871133242794628,0.1871133242794628
before tensor 16384 mask 3827.0 16384
layer1.0.conv3.weight, mask/weight parameters,3827,3827 density 0.31806848404255317,0.31806848404255317
layer1.0.shortcut.0.weight, mask/weight parameters,5673,5669 density 0.34625244140625,0.34600830078125
before tensor 16384 mask 2450.0 16384
layer1.1.conv1.weight, mask/weight parameters,2450,2450 density 0.20362367021276595,0.20362367021276595
before tensor 36864 mask 4019.0 36864
layer1.1.conv2.weight, mask/weight parameters,4019,4019 density 0.20215280921482823,0.20215280921482823
before tensor 16384 mask 2246.0 16384
layer1.1.conv3.weight, mask/weight parameters,2246,2246 density 0.18666888297872342,0.18666888297872342
before tensor 16384 mask 2841.0 16384
layer1.2.conv1.weight, mask/weight parameters,2841,2841 density 0.23612034574468085,0.23612034574468085
before tensor 36864 mask 3457.0 36864
layer1.2.conv2.weight, mask/weight parameters,3457,3457 density 0.17388461345002768,0.17388461345002768
before tensor 16384 mask 1861.0 16384
layer1.2.conv3.weight, mask/weight parameters,1861,1861 density 0.15467087765957446,0.15467087765957446
before tensor 32768 mask 5416.0 32768
layer2.0.conv1.weight, mask/weight parameters,5416,5398 density 0.28208333333333335,0.2811458333333333
before tensor 147456 mask 12585.0 147456
layer2.0.conv2.weight, mask/weight parameters,12585,12583 density 0.2485925925925926,0.2485530864197531
before tensor 65536 mask 7035.0 65536
layer2.0.conv3.weight, mask/weight parameters,7035,7035 density 0.183203125,0.183203125
layer2.0.shortcut.0.weight, mask/weight parameters,30197,30192 density 0.23038482666015625,0.2303466796875
before tensor 65536 mask 3589.0 65536
layer2.1.conv1.weight, mask/weight parameters,3589,3589 density 0.09346354166666666,0.09346354166666666
before tensor 147456 mask 4155.0 147456
layer2.1.conv2.weight, mask/weight parameters,4155,4155 density 0.08207407407407408,0.08207407407407408
before tensor 65536 mask 4205.0 65536
layer2.1.conv3.weight, mask/weight parameters,4205,4204 density 0.10950520833333334,0.10947916666666667
before tensor 65536 mask 10447.0 65536
layer2.2.conv1.weight, mask/weight parameters,10447,10447 density 0.27205729166666665,0.27205729166666665
before tensor 147456 mask 21497.0 147456
layer2.2.conv2.weight, mask/weight parameters,21497,21487 density 0.4246320987654321,0.42443456790123457
before tensor 65536 mask 13431.0 65536
layer2.2.conv3.weight, mask/weight parameters,13431,13424 density 0.349765625,0.34958333333333336
before tensor 65536 mask 10675.0 65536
layer2.3.conv1.weight, mask/weight parameters,10675,10673 density 0.2779947916666667,0.27794270833333334
before tensor 147456 mask 20445.0 147456
layer2.3.conv2.weight, mask/weight parameters,20445,20437 density 0.40385185185185185,0.40369382716049385
before tensor 65536 mask 11149.0 65536
layer2.3.conv3.weight, mask/weight parameters,11149,11144 density 0.29033854166666667,0.29020833333333335
before tensor 131072 mask 29671.0 131072
layer3.0.conv1.weight, mask/weight parameters,29671,29657 density 0.4563084399606299,0.4560931348425197
before tensor 589824 mask 62228.0 589824
layer3.0.conv2.weight, mask/weight parameters,62228,62217 density 0.42868263514304805,0.42860685721371444
before tensor 262144 mask 57727.0 262144
layer3.0.conv3.weight, mask/weight parameters,57727,57691 density 0.44388994832677164,0.4436131274606299
layer3.0.shortcut.0.weight, mask/weight parameters,97971,97935 density 0.18686485290527344,0.1867961883544922
before tensor 262144 mask 27798.0 262144
layer3.1.conv1.weight, mask/weight parameters,27798,27784 density 0.21375184547244094,0.21364419291338582
before tensor 589824 mask 59946.0 589824
layer3.1.conv2.weight, mask/weight parameters,59946,59917 density 0.41296215925765184,0.4127623810803177
before tensor 262144 mask 51877.0 262144
layer3.1.conv3.weight, mask/weight parameters,51877,51833 density 0.39890655757874016,0.39856822096456695
before tensor 262144 mask 29913.0 262144
layer3.2.conv1.weight, mask/weight parameters,29913,29903 density 0.2300150713582677,0.22993817667322836
before tensor 589824 mask 53146.0 589824
layer3.2.conv2.weight, mask/weight parameters,53146,53120 density 0.36611762112413115,0.3659385096547971
before tensor 262144 mask 50394.0 262144
layer3.2.conv3.weight, mask/weight parameters,50394,50344 density 0.38750307578740156,0.38711860236220474
before tensor 262144 mask 33462.0 262144
layer3.3.conv1.weight, mask/weight parameters,33462,33435 density 0.25730499507874016,0.25709737942913385
before tensor 589824 mask 47614.0 589824
layer3.3.conv2.weight, mask/weight parameters,47614,47561 density 0.3280082115719787,0.3276430997306439
before tensor 262144 mask 43604.0 262144
layer3.3.conv3.weight, mask/weight parameters,43604,43555 density 0.33529158464566927,0.3349148006889764
before tensor 262144 mask 38580.0 262144
layer3.4.conv1.weight, mask/weight parameters,38580,38562 density 0.29665969488188976,0.2965212844488189
before tensor 589824 mask 49110.0 589824
layer3.4.conv2.weight, mask/weight parameters,49110,49054 density 0.33831400996135325,0.3379282314120184
before tensor 262144 mask 40751.0 262144
layer3.4.conv3.weight, mask/weight parameters,40751,40682 density 0.313353531003937,0.31282295767716534
before tensor 262144 mask 45013.0 262144
layer3.5.conv1.weight, mask/weight parameters,45013,44957 density 0.34612604576771655,0.34569543553149606
before tensor 589824 mask 48738.0 589824
layer3.5.conv2.weight, mask/weight parameters,48738,48708 density 0.335751338169343,0.33554467108934216
before tensor 262144 mask 39675.0 262144
layer3.5.conv3.weight, mask/weight parameters,39675,39626 density 0.3050796628937008,0.30470287893700787
before tensor 524288 mask 136134.0 524288
layer4.0.conv1.weight, mask/weight parameters,136134,135896 density 0.5755123782467533,0.5745062229437229
before tensor 2359296 mask 198309.0 2359296
layer4.0.conv2.weight, mask/weight parameters,198309,198036 density 0.41292954279967264,0.412361087685763
before tensor 1048576 mask 104332.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104332,104243 density 0.22053402326839827,0.22034589759199133
layer4.0.shortcut.0.weight, mask/weight parameters,141714,141586 density 0.06757450103759766,0.06751346588134766
before tensor 1048576 mask 118996.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118996,118830 density 0.25153037067099565,0.25117948457792205
before tensor 2359296 mask 195494.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195494,194985 density 0.4070680001415932,0.40600813328086055
before tensor 1048576 mask 84484.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84484,84342 density 0.17857988365800867,0.17827972808441558
before tensor 1048576 mask 81653.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81653,81466 density 0.17259579613095238,0.17220052083333334
before tensor 2359296 mask 70863.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70863,70615 density 0.14755470599626444,0.14703830721146738
before tensor 1048576 mask 35594.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35594,35565 density 0.07523758793290043,0.0751762885551948
classifier.weight, mask/weight parameters,106398,106390 density 0.519521484375,0.519482421875
Total Model parameters after dst: 2367962 2365205
Total parameters under density level of 0.1: 0.23684394773986436 0.23656819214753694 after dst
Death rate: 0.10011670913205867


Training summary: Average loss: 0.1001, Accuracy: 48870/50000 (97.740%)


Evaluation: Average loss: 0.9410, Accuracy: 7618/10000 (76.180%)

Current learning rate: 0.001. Time taken for epoch: 88.73 seconds.

Train Epoch: 126 [0/50000 (0%)]	Loss: 0.064079 Accuracy: 99/100 (99.000%
Train Epoch: 126 [10000/50000 (20%)]	Loss: 0.101204 Accuracy: 9903/10100 (98.050%
Train Epoch: 126 [20000/50000 (40%)]	Loss: 0.095346 Accuracy: 19694/20100 (97.980%
Train Epoch: 126 [30000/50000 (60%)]	Loss: 0.055363 Accuracy: 29497/30100 (97.997%
Train Epoch: 126 [40000/50000 (80%)]	Loss: 0.084818 Accuracy: 39297/40100 (97.998%
current layer rate 0.4999938552571689
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
3792.0 / 7552 channels
Total channels to prune: 15.95359490213923
update_filter_mask
After update_filter_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
After apply_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
Total pruned: 0/15.95359490213923 channels
===========done ===============

Training summary: Average loss: 0.0924, Accuracy: 48995/50000 (97.990%)


Evaluation: Average loss: 0.9436, Accuracy: 7632/10000 (76.320%)

Current learning rate: 0.001. Time taken for epoch: 88.54 seconds.

Train Epoch: 127 [0/50000 (0%)]	Loss: 0.086957 Accuracy: 100/100 (100.000%
Train Epoch: 127 [10000/50000 (20%)]	Loss: 0.074880 Accuracy: 9915/10100 (98.168%
Train Epoch: 127 [20000/50000 (40%)]	Loss: 0.093983 Accuracy: 19725/20100 (98.134%
Train Epoch: 127 [30000/50000 (60%)]	Loss: 0.113508 Accuracy: 29545/30100 (98.156%
Train Epoch: 127 [40000/50000 (80%)]	Loss: 0.061440 Accuracy: 39355/40100 (98.142%
current mest  death_rate 0.10002919432919162


dynamic sparse change prune
to kill 2758.7999999988824 expect 2365203.200000001
conv1.weight, mask/weight parameters,1186,1186 density 0.6863425925925926,0.6863425925925926
before tensor 4096 mask 665.0 4096
layer1.0.conv1.weight, mask/weight parameters,665,665 density 0.22107712765957446,0.22107712765957446
before tensor 36864 mask 3718.0 36864
layer1.0.conv2.weight, mask/weight parameters,3718,3718 density 0.18701272571802224,0.18701272571802224
before tensor 16384 mask 3824.0 16384
layer1.0.conv3.weight, mask/weight parameters,3824,3824 density 0.3178191489361702,0.3178191489361702
layer1.0.shortcut.0.weight, mask/weight parameters,5667,5667 density 0.34588623046875,0.34588623046875
before tensor 16384 mask 2447.0 16384
layer1.1.conv1.weight, mask/weight parameters,2447,2447 density 0.20337433510638298,0.20337433510638298
before tensor 36864 mask 4017.0 36864
layer1.1.conv2.weight, mask/weight parameters,4017,4017 density 0.20205221065338766,0.20205221065338766
before tensor 16384 mask 2243.0 16384
layer1.1.conv3.weight, mask/weight parameters,2243,2243 density 0.1864195478723404,0.1864195478723404
before tensor 16384 mask 2840.0 16384
layer1.2.conv1.weight, mask/weight parameters,2840,2840 density 0.2360372340425532,0.2360372340425532
before tensor 36864 mask 3457.0 36864
layer1.2.conv2.weight, mask/weight parameters,3457,3457 density 0.17388461345002768,0.17388461345002768
before tensor 16384 mask 1861.0 16384
layer1.2.conv3.weight, mask/weight parameters,1861,1861 density 0.15467087765957446,0.15467087765957446
before tensor 32768 mask 5411.0 32768
layer2.0.conv1.weight, mask/weight parameters,5411,5411 density 0.28182291666666665,0.28182291666666665
before tensor 147456 mask 12578.0 147456
layer2.0.conv2.weight, mask/weight parameters,12578,12578 density 0.24845432098765433,0.24845432098765433
before tensor 65536 mask 7027.0 65536
layer2.0.conv3.weight, mask/weight parameters,7027,7027 density 0.18299479166666666,0.18299479166666666
layer2.0.shortcut.0.weight, mask/weight parameters,30178,30178 density 0.2302398681640625,0.2302398681640625
before tensor 65536 mask 3588.0 65536
layer2.1.conv1.weight, mask/weight parameters,3588,3588 density 0.0934375,0.0934375
before tensor 147456 mask 4155.0 147456
layer2.1.conv2.weight, mask/weight parameters,4155,4155 density 0.08207407407407408,0.08207407407407408
before tensor 65536 mask 4202.0 65536
layer2.1.conv3.weight, mask/weight parameters,4202,4202 density 0.10942708333333333,0.10942708333333333
before tensor 65536 mask 10441.0 65536
layer2.2.conv1.weight, mask/weight parameters,10441,10441 density 0.2719010416666667,0.2719010416666667
before tensor 147456 mask 21480.0 147456
layer2.2.conv2.weight, mask/weight parameters,21480,21480 density 0.4242962962962963,0.4242962962962963
before tensor 65536 mask 13429.0 65536
layer2.2.conv3.weight, mask/weight parameters,13429,13429 density 0.3497135416666667,0.3497135416666667
before tensor 65536 mask 10666.0 65536
layer2.3.conv1.weight, mask/weight parameters,10666,10666 density 0.2777604166666667,0.2777604166666667
before tensor 147456 mask 20424.0 147456
layer2.3.conv2.weight, mask/weight parameters,20424,20424 density 0.40343703703703704,0.40343703703703704
before tensor 65536 mask 11137.0 65536
layer2.3.conv3.weight, mask/weight parameters,11137,11137 density 0.2900260416666667,0.2900260416666667
before tensor 131072 mask 29645.0 131072
layer3.0.conv1.weight, mask/weight parameters,29645,29645 density 0.4559085875984252,0.4559085875984252
before tensor 589824 mask 62177.0 589824
layer3.0.conv2.weight, mask/weight parameters,62177,62177 density 0.42833130110704665,0.42833130110704665
before tensor 262144 mask 57654.0 262144
layer3.0.conv3.weight, mask/weight parameters,57654,57654 density 0.44332861712598426,0.44332861712598426
layer3.0.shortcut.0.weight, mask/weight parameters,97875,97875 density 0.18668174743652344,0.18668174743652344
before tensor 262144 mask 27773.0 262144
layer3.1.conv1.weight, mask/weight parameters,27773,27773 density 0.2135596087598425,0.2135596087598425
before tensor 589824 mask 59896.0 589824
layer3.1.conv2.weight, mask/weight parameters,59896,59896 density 0.41261771412431714,0.41261771412431714
before tensor 262144 mask 51805.0 262144
layer3.1.conv3.weight, mask/weight parameters,51805,51805 density 0.3983529158464567,0.3983529158464567
before tensor 262144 mask 29889.0 262144
layer3.2.conv1.weight, mask/weight parameters,29889,29889 density 0.22983052411417323,0.22983052411417323
before tensor 589824 mask 53088.0 589824
layer3.2.conv2.weight, mask/weight parameters,53088,53088 density 0.3657180647694629,0.3657180647694629
before tensor 262144 mask 50344.0 262144
layer3.2.conv3.weight, mask/weight parameters,50344,50344 density 0.38711860236220474,0.38711860236220474
before tensor 262144 mask 33415.0 262144
layer3.3.conv1.weight, mask/weight parameters,33415,33415 density 0.2569435900590551,0.2569435900590551
before tensor 589824 mask 47565.0 589824
layer3.3.conv2.weight, mask/weight parameters,47565,47565 density 0.3276706553413107,0.3276706553413107
before tensor 262144 mask 43558.0 262144
layer3.3.conv3.weight, mask/weight parameters,43558,43558 density 0.3349378690944882,0.3349378690944882
before tensor 262144 mask 38536.0 262144
layer3.4.conv1.weight, mask/weight parameters,38536,38536 density 0.29632135826771655,0.29632135826771655
before tensor 589824 mask 49059.0 589824
layer3.4.conv2.weight, mask/weight parameters,49059,49059 density 0.33796267592535184,0.33796267592535184
before tensor 262144 mask 40696.0 262144
layer3.4.conv3.weight, mask/weight parameters,40696,40696 density 0.3129306102362205,0.3129306102362205
before tensor 262144 mask 44960.0 262144
layer3.5.conv1.weight, mask/weight parameters,44960,44960 density 0.34571850393700787,0.34571850393700787
before tensor 589824 mask 48685.0 589824
layer3.5.conv2.weight, mask/weight parameters,48685,48685 density 0.3353862263280082,0.3353862263280082
before tensor 262144 mask 39626.0 262144
layer3.5.conv3.weight, mask/weight parameters,39626,39626 density 0.30470287893700787,0.30470287893700787
before tensor 524288 mask 135973.0 524288
layer4.0.conv1.weight, mask/weight parameters,135973,135973 density 0.5748317437770563,0.5748317437770563
before tensor 2359296 mask 198030.0 2359296
layer4.0.conv2.weight, mask/weight parameters,198030,198030 density 0.412348594166776,0.412348594166776
before tensor 1048576 mask 104187.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104187,104187 density 0.22022752637987014,0.22022752637987014
layer4.0.shortcut.0.weight, mask/weight parameters,141568,141568 density 0.0675048828125,0.0675048828125
before tensor 1048576 mask 118834.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118834,118834 density 0.25118793966450215,0.25118793966450215
before tensor 2359296 mask 195171.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195171,195171 density 0.40639543236945835,0.40639543236945835
before tensor 1048576 mask 84383.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84383,84383 density 0.17836639272186147,0.17836639272186147
before tensor 1048576 mask 81505.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81505,81505 density 0.17228295792748918,0.17228295792748918
before tensor 2359296 mask 70730.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70730,70730 density 0.14727776632538536,0.14727776632538536
before tensor 1048576 mask 35551.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35551,35551 density 0.0751466957521645,0.0751466957521645
classifier.weight, mask/weight parameters,106386,106386 density 0.519462890625,0.519462890625
Total Model parameters after dst: 2365205 2365205
Total parameters under density level of 0.1: 0.23656819214753694 0.23656819214753694 after dst
Death rate: 0.10002919432919162

dynamic sparse change grow
self.total_params*pruning_rate 2365893.7052082587
self.total_nonzero 2365205.0
to grow 688.7052082587034
len(all_scores) 9997984 6653018
increse 688.0 before_mask 2365892.0 after_mask 2365892.0
total_nonzero_new None
conv1.weight, mask/weight parameters,1187,1186 density 0.6869212962962963,0.6863425925925926
before tensor 4096 mask 665.0 4096
layer1.0.conv1.weight, mask/weight parameters,665,665 density 0.22107712765957446,0.22107712765957446
before tensor 36864 mask 3718.0 36864
layer1.0.conv2.weight, mask/weight parameters,3718,3718 density 0.18701272571802224,0.18701272571802224
before tensor 16384 mask 3824.0 16384
layer1.0.conv3.weight, mask/weight parameters,3824,3824 density 0.3178191489361702,0.3178191489361702
layer1.0.shortcut.0.weight, mask/weight parameters,5667,5667 density 0.34588623046875,0.34588623046875
before tensor 16384 mask 2447.0 16384
layer1.1.conv1.weight, mask/weight parameters,2447,2447 density 0.20337433510638298,0.20337433510638298
before tensor 36864 mask 4017.0 36864
layer1.1.conv2.weight, mask/weight parameters,4017,4017 density 0.20205221065338766,0.20205221065338766
before tensor 16384 mask 2243.0 16384
layer1.1.conv3.weight, mask/weight parameters,2243,2243 density 0.1864195478723404,0.1864195478723404
before tensor 16384 mask 2840.0 16384
layer1.2.conv1.weight, mask/weight parameters,2840,2840 density 0.2360372340425532,0.2360372340425532
before tensor 36864 mask 3457.0 36864
layer1.2.conv2.weight, mask/weight parameters,3457,3457 density 0.17388461345002768,0.17388461345002768
before tensor 16384 mask 1861.0 16384
layer1.2.conv3.weight, mask/weight parameters,1861,1861 density 0.15467087765957446,0.15467087765957446
before tensor 32768 mask 5411.0 32768
layer2.0.conv1.weight, mask/weight parameters,5411,5411 density 0.28182291666666665,0.28182291666666665
before tensor 147456 mask 12578.0 147456
layer2.0.conv2.weight, mask/weight parameters,12578,12578 density 0.24845432098765433,0.24845432098765433
before tensor 65536 mask 7027.0 65536
layer2.0.conv3.weight, mask/weight parameters,7027,7027 density 0.18299479166666666,0.18299479166666666
layer2.0.shortcut.0.weight, mask/weight parameters,30178,30178 density 0.2302398681640625,0.2302398681640625
before tensor 65536 mask 3588.0 65536
layer2.1.conv1.weight, mask/weight parameters,3588,3588 density 0.0934375,0.0934375
before tensor 147456 mask 4155.0 147456
layer2.1.conv2.weight, mask/weight parameters,4155,4155 density 0.08207407407407408,0.08207407407407408
before tensor 65536 mask 4202.0 65536
layer2.1.conv3.weight, mask/weight parameters,4202,4202 density 0.10942708333333333,0.10942708333333333
before tensor 65536 mask 10441.0 65536
layer2.2.conv1.weight, mask/weight parameters,10441,10441 density 0.2719010416666667,0.2719010416666667
before tensor 147456 mask 21480.0 147456
layer2.2.conv2.weight, mask/weight parameters,21480,21480 density 0.4242962962962963,0.4242962962962963
before tensor 65536 mask 13429.0 65536
layer2.2.conv3.weight, mask/weight parameters,13429,13429 density 0.3497135416666667,0.3497135416666667
before tensor 65536 mask 10666.0 65536
layer2.3.conv1.weight, mask/weight parameters,10666,10666 density 0.2777604166666667,0.2777604166666667
before tensor 147456 mask 20424.0 147456
layer2.3.conv2.weight, mask/weight parameters,20424,20424 density 0.40343703703703704,0.40343703703703704
before tensor 65536 mask 11137.0 65536
layer2.3.conv3.weight, mask/weight parameters,11137,11137 density 0.2900260416666667,0.2900260416666667
before tensor 131072 mask 29645.0 131072
layer3.0.conv1.weight, mask/weight parameters,29645,29645 density 0.4559085875984252,0.4559085875984252
before tensor 589824 mask 62177.0 589824
layer3.0.conv2.weight, mask/weight parameters,62177,62177 density 0.42833130110704665,0.42833130110704665
before tensor 262144 mask 57660.0 262144
layer3.0.conv3.weight, mask/weight parameters,57660,57654 density 0.44337475393700787,0.44332861712598426
layer3.0.shortcut.0.weight, mask/weight parameters,97875,97875 density 0.18668174743652344,0.18668174743652344
before tensor 262144 mask 27773.0 262144
layer3.1.conv1.weight, mask/weight parameters,27773,27773 density 0.2135596087598425,0.2135596087598425
before tensor 589824 mask 59896.0 589824
layer3.1.conv2.weight, mask/weight parameters,59896,59896 density 0.41261771412431714,0.41261771412431714
before tensor 262144 mask 51813.0 262144
layer3.1.conv3.weight, mask/weight parameters,51813,51805 density 0.3984144315944882,0.3983529158464567
before tensor 262144 mask 29889.0 262144
layer3.2.conv1.weight, mask/weight parameters,29889,29889 density 0.22983052411417323,0.22983052411417323
before tensor 589824 mask 53090.0 589824
layer3.2.conv2.weight, mask/weight parameters,53090,53088 density 0.36573184257479624,0.3657180647694629
before tensor 262144 mask 50350.0 262144
layer3.2.conv3.weight, mask/weight parameters,50350,50344 density 0.38716473917322836,0.38711860236220474
before tensor 262144 mask 33415.0 262144
layer3.3.conv1.weight, mask/weight parameters,33415,33415 density 0.2569435900590551,0.2569435900590551
before tensor 589824 mask 47565.0 589824
layer3.3.conv2.weight, mask/weight parameters,47565,47565 density 0.3276706553413107,0.3276706553413107
before tensor 262144 mask 43566.0 262144
layer3.3.conv3.weight, mask/weight parameters,43566,43558 density 0.3349993848425197,0.3349378690944882
before tensor 262144 mask 38540.0 262144
layer3.4.conv1.weight, mask/weight parameters,38540,38536 density 0.2963521161417323,0.29632135826771655
before tensor 589824 mask 49062.0 589824
layer3.4.conv2.weight, mask/weight parameters,49062,49059 density 0.33798334263335195,0.33796267592535184
before tensor 262144 mask 40698.0 262144
layer3.4.conv3.weight, mask/weight parameters,40698,40696 density 0.31294598917322836,0.3129306102362205
before tensor 262144 mask 44960.0 262144
layer3.5.conv1.weight, mask/weight parameters,44960,44960 density 0.34571850393700787,0.34571850393700787
before tensor 589824 mask 48688.0 589824
layer3.5.conv2.weight, mask/weight parameters,48688,48685 density 0.3354068930360083,0.3353862263280082
before tensor 262144 mask 39629.0 262144
layer3.5.conv3.weight, mask/weight parameters,39629,39626 density 0.3047259473425197,0.30470287893700787
before tensor 524288 mask 136014.0 524288
layer4.0.conv1.weight, mask/weight parameters,136014,135973 density 0.575005073051948,0.5748317437770563
before tensor 2359296 mask 198062.0 2359296
layer4.0.conv2.weight, mask/weight parameters,198062,198030 density 0.4124152262680401,0.412348594166776
before tensor 1048576 mask 104215.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104215,104187 density 0.22028671198593072,0.22022752637987014
layer4.0.shortcut.0.weight, mask/weight parameters,141581,141568 density 0.06751108169555664,0.0675048828125
before tensor 1048576 mask 118860.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118860,118834 density 0.2512428977272727,0.25118793966450215
before tensor 2359296 mask 195328.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195328,195171 density 0.4067223461162855,0.40639543236945835
before tensor 1048576 mask 84459.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84459,84383 density 0.1785270393668831,0.17836639272186147
before tensor 1048576 mask 81593.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81593,81505 density 0.17246896983225107,0.17228295792748918
before tensor 2359296 mask 70859.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70859,70730 density 0.14754637698360643,0.14727776632538536
before tensor 1048576 mask 35594.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35594,35551 density 0.07523758793290043,0.0751466957521645
classifier.weight, mask/weight parameters,106394,106386 density 0.519501953125,0.519462890625
Total Model parameters after dst: 2365892 2365205
Total parameters under density level of 0.1: 0.23663690600024964 0.23656819214753694 after dst
Death rate: 0.10002919432919162


Training summary: Average loss: 0.0890, Accuracy: 49068/50000 (98.136%)


Evaluation: Average loss: 0.9465, Accuracy: 7626/10000 (76.260%)

Current learning rate: 0.001. Time taken for epoch: 88.74 seconds.

Train Epoch: 128 [0/50000 (0%)]	Loss: 0.052872 Accuracy: 100/100 (100.000%
Train Epoch: 128 [10000/50000 (20%)]	Loss: 0.066634 Accuracy: 9919/10100 (98.208%
Train Epoch: 128 [20000/50000 (40%)]	Loss: 0.061877 Accuracy: 19745/20100 (98.234%
Train Epoch: 128 [30000/50000 (60%)]	Loss: 0.048761 Accuracy: 29559/30100 (98.203%
Train Epoch: 128 [40000/50000 (80%)]	Loss: 0.090584 Accuracy: 39378/40100 (98.200%
current layer rate 0.49999977241693216
===========del layer===============
===========del layer with layer-wise HE===============
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
3792.0 / 7552 channels
Total channels to prune: 15.99828129267189
update_filter_mask
After update_filter_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
After apply_mask:
Total filter_names items: 3792.0
Total filter_masks items: 7022560.0
Total pruned: 0/15.99828129267189 channels
===========done ===============

Training summary: Average loss: 0.0855, Accuracy: 49088/50000 (98.176%)


Evaluation: Average loss: 0.9419, Accuracy: 7618/10000 (76.180%)

Current learning rate: 0.001. Time taken for epoch: 88.52 seconds.

Train Epoch: 129 [0/50000 (0%)]	Loss: 0.103279 Accuracy: 98/100 (98.000%
Train Epoch: 129 [10000/50000 (20%)]	Loss: 0.070342 Accuracy: 9943/10100 (98.446%
Train Epoch: 129 [20000/50000 (40%)]	Loss: 0.106662 Accuracy: 19760/20100 (98.308%
Train Epoch: 129 [30000/50000 (60%)]	Loss: 0.117353 Accuracy: 29596/30100 (98.326%
Train Epoch: 129 [40000/50000 (80%)]	Loss: 0.094245 Accuracy: 39396/40100 (98.244%
current dst rate 0.04671127095511953


dynamic sparse change
conv1.weight, mask/weight parameters,1154,1154 density 0.6678240740740741,0.6678240740740741
before tensor 4096 mask 652.0 4096
layer1.0.conv1.weight, mask/weight parameters,652,652 density 0.21675531914893617,0.21675531914893617
before tensor 36864 mask 3608.0 36864
layer1.0.conv2.weight, mask/weight parameters,3608,3608 density 0.1814798048387908,0.1814798048387908
before tensor 16384 mask 3653.0 16384
layer1.0.conv3.weight, mask/weight parameters,3653,3653 density 0.30360704787234044,0.30360704787234044
layer1.0.shortcut.0.weight, mask/weight parameters,5418,5418 density 0.3306884765625,0.3306884765625
before tensor 16384 mask 2341.0 16384
layer1.1.conv1.weight, mask/weight parameters,2341,2341 density 0.19456449468085107,0.19456449468085107
before tensor 36864 mask 3910.0 36864
layer1.1.conv2.weight, mask/weight parameters,3910,3910 density 0.19667018761631708,0.19667018761631708
before tensor 16384 mask 2130.0 16384
layer1.1.conv3.weight, mask/weight parameters,2130,2130 density 0.1770279255319149,0.1770279255319149
before tensor 16384 mask 2728.0 16384
layer1.2.conv1.weight, mask/weight parameters,2728,2728 density 0.22672872340425532,0.22672872340425532
before tensor 36864 mask 3365.0 36864
layer1.2.conv2.weight, mask/weight parameters,3365,3365 density 0.16925707962376138,0.16925707962376138
before tensor 16384 mask 1783.0 16384
layer1.2.conv3.weight, mask/weight parameters,1783,1783 density 0.14818816489361702,0.14818816489361702
before tensor 32768 mask 5131.0 32768
layer2.0.conv1.weight, mask/weight parameters,5131,5131 density 0.2672395833333333,0.2672395833333333
before tensor 147456 mask 12274.0 147456
layer2.0.conv2.weight, mask/weight parameters,12274,12274 density 0.24244938271604938,0.24244938271604938
before tensor 65536 mask 6733.0 65536
layer2.0.conv3.weight, mask/weight parameters,6733,6733 density 0.17533854166666665,0.17533854166666665
layer2.0.shortcut.0.weight, mask/weight parameters,28916,28916 density 0.220611572265625,0.220611572265625
before tensor 65536 mask 3463.0 65536
layer2.1.conv1.weight, mask/weight parameters,3463,3463 density 0.09018229166666666,0.09018229166666666
before tensor 147456 mask 4047.0 147456
layer2.1.conv2.weight, mask/weight parameters,4047,4047 density 0.07994074074074074,0.07994074074074074
before tensor 65536 mask 4032.0 65536
layer2.1.conv3.weight, mask/weight parameters,4032,4032 density 0.105,0.105
before tensor 65536 mask 10088.0 65536
layer2.2.conv1.weight, mask/weight parameters,10088,10088 density 0.2627083333333333,0.2627083333333333
before tensor 147456 mask 20712.0 147456
layer2.2.conv2.weight, mask/weight parameters,20712,20712 density 0.40912592592592595,0.40912592592592595
before tensor 65536 mask 12786.0 65536
layer2.2.conv3.weight, mask/weight parameters,12786,12786 density 0.33296875,0.33296875
before tensor 65536 mask 10268.0 65536
layer2.3.conv1.weight, mask/weight parameters,10268,10268 density 0.26739583333333333,0.26739583333333333
before tensor 147456 mask 19744.0 147456
layer2.3.conv2.weight, mask/weight parameters,19744,19744 density 0.39000493827160493,0.39000493827160493
before tensor 65536 mask 10664.0 65536
layer2.3.conv3.weight, mask/weight parameters,10664,10664 density 0.27770833333333333,0.27770833333333333
before tensor 131072 mask 28451.0 131072
layer3.0.conv1.weight, mask/weight parameters,28451,28451 density 0.4375461368110236,0.4375461368110236
before tensor 589824 mask 59790.0 589824
layer3.0.conv2.weight, mask/weight parameters,59790,59790 density 0.4118874904416476,0.4118874904416476
before tensor 262144 mask 55292.0 262144
layer3.0.conv3.weight, mask/weight parameters,55292,55292 density 0.425166092519685,0.425166092519685
layer3.0.shortcut.0.weight, mask/weight parameters,93540,93540 density 0.17841339111328125,0.17841339111328125
before tensor 262144 mask 26564.0 262144
layer3.1.conv1.weight, mask/weight parameters,26564,26564 density 0.20426304133858267,0.20426304133858267
before tensor 589824 mask 57337.0 589824
layer3.1.conv2.weight, mask/weight parameters,57337,57337 density 0.3949890122002466,0.3949890122002466
before tensor 262144 mask 49365.0 262144
layer3.1.conv3.weight, mask/weight parameters,49365,49365 density 0.3795906126968504,0.3795906126968504
before tensor 262144 mask 28544.0 262144
layer3.2.conv1.weight, mask/weight parameters,28544,28544 density 0.21948818897637795,0.21948818897637795
before tensor 589824 mask 50876.0 589824
layer3.2.conv2.weight, mask/weight parameters,50876,50876 density 0.35047981207073525,0.35047981207073525
before tensor 262144 mask 47983.0 262144
layer3.2.conv3.weight, mask/weight parameters,47983,47983 density 0.36896376722440943,0.36896376722440943
before tensor 262144 mask 31879.0 262144
layer3.3.conv1.weight, mask/weight parameters,31879,31879 density 0.24513256643700787,0.24513256643700787
before tensor 589824 mask 45475.0 589824
layer3.3.conv2.weight, mask/weight parameters,45475,45475 density 0.3132728487679198,0.3132728487679198
before tensor 262144 mask 41543.0 262144
layer3.3.conv3.weight, mask/weight parameters,41543,41543 density 0.3194435900590551,0.3194435900590551
before tensor 262144 mask 36718.0 262144
layer3.4.conv1.weight, mask/weight parameters,36718,36718 density 0.28234190452755903,0.28234190452755903
before tensor 589824 mask 46711.0 589824
layer3.4.conv2.weight, mask/weight parameters,46711,46711 density 0.3217875324639538,0.3217875324639538
before tensor 262144 mask 38635.0 262144
layer3.4.conv3.weight, mask/weight parameters,38635,38635 density 0.2970826156496063,0.2970826156496063
before tensor 262144 mask 42760.0 262144
layer3.5.conv1.weight, mask/weight parameters,42760,42760 density 0.32880167322834647,0.32880167322834647
before tensor 589824 mask 46508.0 589824
layer3.5.conv2.weight, mask/weight parameters,46508,46508 density 0.3203890852226149,0.3203890852226149
before tensor 262144 mask 37671.0 262144
layer3.5.conv3.weight, mask/weight parameters,37671,37671 density 0.289669968011811,0.289669968011811
before tensor 524288 mask 130076.0 524288
layer4.0.conv1.weight, mask/weight parameters,130076,130076 density 0.549901920995671,0.549901920995671
before tensor 2359296 mask 187905.0 2359296
layer4.0.conv2.weight, mask/weight parameters,187905,187905 density 0.3912657808761705,0.3912657808761705
before tensor 1048576 mask 98935.0 1048576
layer4.0.conv3.weight, mask/weight parameters,98935,98935 density 0.20912599770021645,0.20912599770021645
layer4.0.shortcut.0.weight, mask/weight parameters,133892,133892 density 0.06384468078613281,0.06384468078613281
before tensor 1048576 mask 112680.0 1048576
layer4.1.conv1.weight, mask/weight parameters,112680,112680 density 0.23817978896103897,0.23817978896103897
before tensor 2359296 mask 184408.0 2359296
layer4.1.conv2.weight, mask/weight parameters,184408,184408 density 0.38398414155989913,0.38398414155989913
before tensor 1048576 mask 80286.0 1048576
layer4.1.conv3.weight, mask/weight parameters,80286,80286 density 0.1697062702922078,0.1697062702922078
before tensor 1048576 mask 76670.0 1048576
layer4.2.conv1.weight, mask/weight parameters,76670,76670 density 0.16206287202380953,0.16206287202380953
before tensor 2359296 mask 66113.0 2359296
layer4.2.conv2.weight, mask/weight parameters,66113,66113 density 0.13766400346486926,0.13766400346486926
before tensor 1048576 mask 33956.0 1048576
layer4.2.conv3.weight, mask/weight parameters,33956,33956 density 0.07177522997835498,0.07177522997835498
classifier.weight, mask/weight parameters,105216,105216 density 0.51375,0.51375
Total Model parameters after dst: 2255379 2255379
Total parameters under density level of 0.1: 0.22558337760892597 0.22558337760892597 after dst
Death rate: 0.1

self.baseline_nonzero-self.total_nonzero 109824.20000000112
len(all_scores) 9997984 6762961
increse 109824.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1185,1154 density 0.6857638888888888,0.6678240740740741
before tensor 4096 mask 657.0 4096
layer1.0.conv1.weight, mask/weight parameters,657,652 density 0.21841755319148937,0.21675531914893617
before tensor 36864 mask 3708.0 36864
layer1.0.conv2.weight, mask/weight parameters,3708,3608 density 0.18650973291081938,0.1814798048387908
before tensor 16384 mask 3769.0 16384
layer1.0.conv3.weight, mask/weight parameters,3769,3653 density 0.3132480053191489,0.30360704787234044
layer1.0.shortcut.0.weight, mask/weight parameters,5615,5418 density 0.34271240234375,0.3306884765625
before tensor 16384 mask 2421.0 16384
layer1.1.conv1.weight, mask/weight parameters,2421,2341 density 0.20121343085106383,0.19456449468085107
before tensor 36864 mask 4000.0 36864
layer1.1.conv2.weight, mask/weight parameters,4000,3910 density 0.2011971228811428,0.19667018761631708
before tensor 16384 mask 2174.0 16384
layer1.1.conv3.weight, mask/weight parameters,2174,2130 density 0.18068484042553193,0.1770279255319149
before tensor 16384 mask 2786.0 16384
layer1.2.conv1.weight, mask/weight parameters,2786,2728 density 0.2315492021276596,0.22672872340425532
before tensor 36864 mask 3409.0 36864
layer1.2.conv2.weight, mask/weight parameters,3409,3365 density 0.17147024797545396,0.16925707962376138
before tensor 16384 mask 1853.0 16384
layer1.2.conv3.weight, mask/weight parameters,1853,1783 density 0.1540059840425532,0.14818816489361702
before tensor 32768 mask 5310.0 32768
layer2.0.conv1.weight, mask/weight parameters,5310,5131 density 0.2765625,0.2672395833333333
before tensor 147456 mask 12539.0 147456
layer2.0.conv2.weight, mask/weight parameters,12539,12274 density 0.24768395061728396,0.24244938271604938
before tensor 65536 mask 6911.0 65536
layer2.0.conv3.weight, mask/weight parameters,6911,6733 density 0.17997395833333332,0.17533854166666665
layer2.0.shortcut.0.weight, mask/weight parameters,30143,28916 density 0.22997283935546875,0.220611572265625
before tensor 65536 mask 3595.0 65536
layer2.1.conv1.weight, mask/weight parameters,3595,3463 density 0.09361979166666666,0.09018229166666666
before tensor 147456 mask 4051.0 147456
layer2.1.conv2.weight, mask/weight parameters,4051,4047 density 0.08001975308641976,0.07994074074074074
before tensor 65536 mask 4074.0 65536
layer2.1.conv3.weight, mask/weight parameters,4074,4032 density 0.10609375,0.105
before tensor 65536 mask 10284.0 65536
layer2.2.conv1.weight, mask/weight parameters,10284,10088 density 0.2678125,0.2627083333333333
before tensor 147456 mask 21143.0 147456
layer2.2.conv2.weight, mask/weight parameters,21143,20712 density 0.4176395061728395,0.40912592592592595
before tensor 65536 mask 13000.0 65536
layer2.2.conv3.weight, mask/weight parameters,13000,12786 density 0.3385416666666667,0.33296875
before tensor 65536 mask 10578.0 65536
layer2.3.conv1.weight, mask/weight parameters,10578,10268 density 0.27546875,0.26739583333333333
before tensor 147456 mask 20432.0 147456
layer2.3.conv2.weight, mask/weight parameters,20432,19744 density 0.40359506172839504,0.39000493827160493
before tensor 65536 mask 11115.0 65536
layer2.3.conv3.weight, mask/weight parameters,11115,10664 density 0.289453125,0.27770833333333333
before tensor 131072 mask 29429.0 131072
layer3.0.conv1.weight, mask/weight parameters,29429,28451 density 0.4525867372047244,0.4375461368110236
before tensor 589824 mask 61775.0 589824
layer3.0.conv2.weight, mask/weight parameters,61775,59790 density 0.42556196223503556,0.4118874904416476
before tensor 262144 mask 57254.0 262144
layer3.0.conv3.weight, mask/weight parameters,57254,55292 density 0.44025282972440943,0.425166092519685
layer3.0.shortcut.0.weight, mask/weight parameters,96154,93540 density 0.18339920043945312,0.17841339111328125
before tensor 262144 mask 27693.0 262144
layer3.1.conv1.weight, mask/weight parameters,27693,26564 density 0.21294445127952755,0.20426304133858267
before tensor 589824 mask 60819.0 589824
layer3.1.conv2.weight, mask/weight parameters,60819,57337 density 0.4189761712856759,0.3949890122002466
before tensor 262144 mask 51852.0 262144
layer3.1.conv3.weight, mask/weight parameters,51852,49365 density 0.3987143208661417,0.3795906126968504
before tensor 262144 mask 29986.0 262144
layer3.2.conv1.weight, mask/weight parameters,29986,28544 density 0.23057640255905512,0.21948818897637795
before tensor 589824 mask 52914.0 589824
layer3.2.conv2.weight, mask/weight parameters,52914,50876 density 0.3645193957054581,0.35047981207073525
before tensor 262144 mask 49881.0 262144
layer3.2.conv3.weight, mask/weight parameters,49881,47983 density 0.3835583784448819,0.36896376722440943
before tensor 262144 mask 33100.0 262144
layer3.3.conv1.weight, mask/weight parameters,33100,31879 density 0.254521407480315,0.24513256643700787
before tensor 589824 mask 47376.0 589824
layer3.3.conv2.weight, mask/weight parameters,47376,45475 density 0.3263686527373055,0.3132728487679198
before tensor 262144 mask 43424.0 262144
layer3.3.conv3.weight, mask/weight parameters,43424,41543 density 0.33390748031496065,0.3194435900590551
before tensor 262144 mask 38574.0 262144
layer3.4.conv1.weight, mask/weight parameters,38574,36718 density 0.29661355807086615,0.28234190452755903
before tensor 589824 mask 48684.0 589824
layer3.4.conv2.weight, mask/weight parameters,48684,46711 density 0.33537933742534154,0.3217875324639538
before tensor 262144 mask 40464.0 262144
layer3.4.conv3.weight, mask/weight parameters,40464,38635 density 0.31114665354330706,0.2970826156496063
before tensor 262144 mask 44756.0 262144
layer3.5.conv1.weight, mask/weight parameters,44756,42760 density 0.34414985236220474,0.32880167322834647
before tensor 589824 mask 48663.0 589824
layer3.5.conv2.weight, mask/weight parameters,48663,46508 density 0.3352346704693409,0.3203890852226149
before tensor 262144 mask 39795.0 262144
layer3.5.conv3.weight, mask/weight parameters,39795,37671 density 0.3060023991141732,0.289669968011811
before tensor 524288 mask 135548.0 524288
layer4.0.conv1.weight, mask/weight parameters,135548,130076 density 0.5730350378787878,0.549901920995671
before tensor 2359296 mask 197543.0 2359296
layer4.0.conv2.weight, mask/weight parameters,197543,187905 density 0.4113345368756624,0.3912657808761705
before tensor 1048576 mask 105619.0 1048576
layer4.0.conv3.weight, mask/weight parameters,105619,98935 density 0.22325444737554112,0.20912599770021645
layer4.0.shortcut.0.weight, mask/weight parameters,141926,133892 density 0.06767559051513672,0.06384468078613281
before tensor 1048576 mask 120596.0 1048576
layer4.1.conv1.weight, mask/weight parameters,120596,112680 density 0.2549124053030303,0.23817978896103897
before tensor 2359296 mask 194791.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194791,184408 density 0.4056041761669467,0.38398414155989913
before tensor 1048576 mask 85554.0 1048576
layer4.1.conv3.weight, mask/weight parameters,85554,80286 density 0.18084161931818182,0.1697062702922078
before tensor 1048576 mask 83249.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83249,76670 density 0.17596937567640691,0.16206287202380953
before tensor 2359296 mask 71447.0 2359296
layer4.2.conv2.weight, mask/weight parameters,71447,66113 density 0.14877074184433492,0.13766400346486926
before tensor 1048576 mask 35691.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35691,33956 density 0.07544262378246754,0.07177522997835498
classifier.weight, mask/weight parameters,105893,105216 density 0.5170556640625,0.51375
Total Model parameters after dst: 2365202 2255379
Total parameters under density level of 0.1: 0.23656789208704473 0.22558337760892597 after dst
Death rate: 0.1


Training summary: Average loss: 0.0818, Accuracy: 49130/50000 (98.260%)


Evaluation: Average loss: 0.9509, Accuracy: 7625/10000 (76.250%)

Current learning rate: 0.001. Time taken for epoch: 88.72 seconds.

Train Epoch: 130 [0/50000 (0%)]	Loss: 0.059617 Accuracy: 98/100 (98.000%
Train Epoch: 130 [10000/50000 (20%)]	Loss: 0.102468 Accuracy: 9941/10100 (98.426%
Train Epoch: 130 [20000/50000 (40%)]	Loss: 0.092432 Accuracy: 19799/20100 (98.502%
Train Epoch: 130 [30000/50000 (60%)]	Loss: 0.058879 Accuracy: 29655/30100 (98.522%
Train Epoch: 130 [40000/50000 (80%)]	Loss: 0.067478 Accuracy: 39507/40100 (98.521%

Training summary: Average loss: 0.0765, Accuracy: 49243/50000 (98.486%)


Evaluation: Average loss: 0.9510, Accuracy: 7670/10000 (76.700%)

best_acc 0.767
Saving best pre model
SAVING
Current learning rate: 0.001. Time taken for epoch: 88.67 seconds.

Train Epoch: 131 [0/50000 (0%)]	Loss: 0.053678 Accuracy: 100/100 (100.000%
Train Epoch: 131 [10000/50000 (20%)]	Loss: 0.087193 Accuracy: 9958/10100 (98.594%
Train Epoch: 131 [20000/50000 (40%)]	Loss: 0.079427 Accuracy: 19823/20100 (98.622%
Train Epoch: 131 [30000/50000 (60%)]	Loss: 0.073660 Accuracy: 29689/30100 (98.635%
Train Epoch: 131 [40000/50000 (80%)]	Loss: 0.060522 Accuracy: 39556/40100 (98.643%
current dst rate 0.041471559322361795


dynamic sparse change
conv1.weight, mask/weight parameters,1162,1162 density 0.6724537037037037,0.6724537037037037
before tensor 4096 mask 654.0 4096
layer1.0.conv1.weight, mask/weight parameters,654,654 density 0.21742021276595744,0.21742021276595744
before tensor 36864 mask 3623.0 36864
layer1.0.conv2.weight, mask/weight parameters,3623,3623 density 0.1822342940495951,0.1822342940495951
before tensor 16384 mask 3683.0 16384
layer1.0.conv3.weight, mask/weight parameters,3683,3683 density 0.3061003989361702,0.3061003989361702
layer1.0.shortcut.0.weight, mask/weight parameters,5453,5453 density 0.33282470703125,0.33282470703125
before tensor 16384 mask 2350.0 16384
layer1.1.conv1.weight, mask/weight parameters,2350,2350 density 0.1953125,0.1953125
before tensor 36864 mask 3927.0 36864
layer1.1.conv2.weight, mask/weight parameters,3927,3927 density 0.19752527538856193,0.19752527538856193
before tensor 16384 mask 2137.0 16384
layer1.1.conv3.weight, mask/weight parameters,2137,2137 density 0.1776097074468085,0.1776097074468085
before tensor 16384 mask 2742.0 16384
layer1.2.conv1.weight, mask/weight parameters,2742,2742 density 0.22789228723404256,0.22789228723404256
before tensor 36864 mask 3381.0 36864
layer1.2.conv2.weight, mask/weight parameters,3381,3381 density 0.17006186811528595,0.17006186811528595
before tensor 16384 mask 1793.0 16384
layer1.2.conv3.weight, mask/weight parameters,1793,1793 density 0.1490192819148936,0.1490192819148936
before tensor 32768 mask 5149.0 32768
layer2.0.conv1.weight, mask/weight parameters,5149,5149 density 0.26817708333333334,0.26817708333333334
before tensor 147456 mask 12313.0 147456
layer2.0.conv2.weight, mask/weight parameters,12313,12313 density 0.24321975308641974,0.24321975308641974
before tensor 65536 mask 6766.0 65536
layer2.0.conv3.weight, mask/weight parameters,6766,6766 density 0.17619791666666668,0.17619791666666668
layer2.0.shortcut.0.weight, mask/weight parameters,29057,29057 density 0.22168731689453125,0.22168731689453125
before tensor 65536 mask 3484.0 65536
layer2.1.conv1.weight, mask/weight parameters,3484,3484 density 0.09072916666666667,0.09072916666666667
before tensor 147456 mask 4048.0 147456
layer2.1.conv2.weight, mask/weight parameters,4048,4048 density 0.0799604938271605,0.0799604938271605
before tensor 65536 mask 4039.0 65536
layer2.1.conv3.weight, mask/weight parameters,4039,4039 density 0.10518229166666666,0.10518229166666666
before tensor 65536 mask 10106.0 65536
layer2.2.conv1.weight, mask/weight parameters,10106,10106 density 0.26317708333333334,0.26317708333333334
before tensor 147456 mask 20759.0 147456
layer2.2.conv2.weight, mask/weight parameters,20759,20759 density 0.4100543209876543,0.4100543209876543
before tensor 65536 mask 12821.0 65536
layer2.2.conv3.weight, mask/weight parameters,12821,12821 density 0.3338802083333333,0.3338802083333333
before tensor 65536 mask 10296.0 65536
layer2.3.conv1.weight, mask/weight parameters,10296,10296 density 0.268125,0.268125
before tensor 147456 mask 19847.0 147456
layer2.3.conv2.weight, mask/weight parameters,19847,19847 density 0.3920395061728395,0.3920395061728395
before tensor 65536 mask 10731.0 65536
layer2.3.conv3.weight, mask/weight parameters,10731,10731 density 0.279453125,0.279453125
before tensor 131072 mask 28571.0 131072
layer3.0.conv1.weight, mask/weight parameters,28571,28571 density 0.4393916092519685,0.4393916092519685
before tensor 589824 mask 59970.0 589824
layer3.0.conv2.weight, mask/weight parameters,59970,59970 density 0.4131274929216525,0.4131274929216525
before tensor 262144 mask 55652.0 262144
layer3.0.conv3.weight, mask/weight parameters,55652,55652 density 0.4279343011811024,0.4279343011811024
layer3.0.shortcut.0.weight, mask/weight parameters,93731,93731 density 0.17877769470214844,0.17877769470214844
before tensor 262144 mask 26674.0 262144
layer3.1.conv1.weight, mask/weight parameters,26674,26674 density 0.20510888287401574,0.20510888287401574
before tensor 589824 mask 57824.0 589824
layer3.1.conv2.weight, mask/weight parameters,57824,57824 density 0.3983439077989267,0.3983439077989267
before tensor 262144 mask 49854.0 262144
layer3.1.conv3.weight, mask/weight parameters,49854,49854 density 0.3833507627952756,0.3833507627952756
before tensor 262144 mask 28708.0 262144
layer3.2.conv1.weight, mask/weight parameters,28708,28708 density 0.2207492618110236,0.2207492618110236
before tensor 589824 mask 51146.0 589824
layer3.2.conv2.weight, mask/weight parameters,51146,51146 density 0.3523398157907427,0.3523398157907427
before tensor 262144 mask 48294.0 262144
layer3.2.conv3.weight, mask/weight parameters,48294,48294 density 0.37135519192913385,0.37135519192913385
before tensor 262144 mask 32058.0 262144
layer3.3.conv1.weight, mask/weight parameters,32058,32058 density 0.2465089812992126,0.2465089812992126
before tensor 589824 mask 45756.0 589824
layer3.3.conv2.weight, mask/weight parameters,45756,45756 density 0.3152086304172608,0.3152086304172608
before tensor 262144 mask 41879.0 262144
layer3.3.conv3.weight, mask/weight parameters,41879,41879 density 0.32202725147637795,0.32202725147637795
before tensor 262144 mask 36963.0 262144
layer3.4.conv1.weight, mask/weight parameters,36963,36963 density 0.2842258243110236,0.2842258243110236
before tensor 589824 mask 47010.0 589824
layer3.4.conv2.weight, mask/weight parameters,47010,47010 density 0.3238473143612954,0.3238473143612954
before tensor 262144 mask 38945.0 262144
layer3.4.conv3.weight, mask/weight parameters,38945,38945 density 0.2994663508858268,0.2994663508858268
before tensor 262144 mask 43102.0 262144
layer3.5.conv1.weight, mask/weight parameters,43102,43102 density 0.33143147145669294,0.33143147145669294
before tensor 589824 mask 46829.0 589824
layer3.5.conv2.weight, mask/weight parameters,46829,46829 density 0.32260042297862374,0.32260042297862374
before tensor 262144 mask 38003.0 262144
layer3.5.conv3.weight, mask/weight parameters,38003,38003 density 0.2922228715551181,0.2922228715551181
before tensor 524288 mask 131104.0 524288
layer4.0.conv1.weight, mask/weight parameters,131104,131104 density 0.5542478354978355,0.5542478354978355
before tensor 2359296 mask 188829.0 2359296
layer4.0.conv2.weight, mask/weight parameters,188829,188829 density 0.3931897828001724,0.3931897828001724
before tensor 1048576 mask 99365.0 1048576
layer4.0.conv3.weight, mask/weight parameters,99365,99365 density 0.21003491950757575,0.21003491950757575
layer4.0.shortcut.0.weight, mask/weight parameters,134101,134101 density 0.06394433975219727,0.06394433975219727
before tensor 1048576 mask 113330.0 1048576
layer4.1.conv1.weight, mask/weight parameters,113330,113330 density 0.23955374053030304,0.23955374053030304
before tensor 2359296 mask 185539.0 2359296
layer4.1.conv2.weight, mask/weight parameters,185539,185539 density 0.38633916988895345,0.38633916988895345
before tensor 1048576 mask 80563.0 1048576
layer4.1.conv3.weight, mask/weight parameters,80563,80563 density 0.17029178503787878,0.17029178503787878
before tensor 1048576 mask 77009.0 1048576
layer4.2.conv1.weight, mask/weight parameters,77009,77009 density 0.16277944061147187,0.16277944061147187
before tensor 2359296 mask 66508.0 2359296
layer4.2.conv2.weight, mask/weight parameters,66508,66508 density 0.13848649346484845,0.13848649346484845
before tensor 1048576 mask 34241.0 1048576
layer4.2.conv3.weight, mask/weight parameters,34241,34241 density 0.07237765489718614,0.07237765489718614
classifier.weight, mask/weight parameters,105235,105235 density 0.5138427734375,0.5138427734375
Total Model parameters after dst: 2267114 2267114
Total parameters under density level of 0.1: 0.22675711423422962 0.22675711423422962 after dst
Death rate: 0.10002919433368185

self.baseline_nonzero-self.total_nonzero 98089.20000000112
len(all_scores) 9997984 6751145
increse 98089.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1176,1162 density 0.6805555555555556,0.6724537037037037
before tensor 4096 mask 690.0 4096
layer1.0.conv1.weight, mask/weight parameters,690,654 density 0.2293882978723404,0.21742021276595744
before tensor 36864 mask 3703.0 36864
layer1.0.conv2.weight, mask/weight parameters,3703,3623 density 0.18625823650721796,0.1822342940495951
before tensor 16384 mask 3716.0 16384
layer1.0.conv3.weight, mask/weight parameters,3716,3683 density 0.308843085106383,0.3061003989361702
layer1.0.shortcut.0.weight, mask/weight parameters,5865,5453 density 0.35797119140625,0.33282470703125
before tensor 16384 mask 2662.0 16384
layer1.1.conv1.weight, mask/weight parameters,2662,2350 density 0.22124335106382978,0.1953125
before tensor 36864 mask 4041.0 36864
layer1.1.conv2.weight, mask/weight parameters,4041,3927 density 0.2032593933906745,0.19752527538856193
before tensor 16384 mask 2169.0 16384
layer1.1.conv3.weight, mask/weight parameters,2169,2137 density 0.1802692819148936,0.1776097074468085
before tensor 16384 mask 3230.0 16384
layer1.2.conv1.weight, mask/weight parameters,3230,2742 density 0.26845079787234044,0.22789228723404256
before tensor 36864 mask 3504.0 36864
layer1.2.conv2.weight, mask/weight parameters,3504,3381 density 0.17624867964388108,0.17006186811528595
before tensor 16384 mask 1846.0 16384
layer1.2.conv3.weight, mask/weight parameters,1846,1793 density 0.1534242021276596,0.1490192819148936
before tensor 32768 mask 6183.0 32768
layer2.0.conv1.weight, mask/weight parameters,6183,5149 density 0.32203125,0.26817708333333334
before tensor 147456 mask 12731.0 147456
layer2.0.conv2.weight, mask/weight parameters,12731,12313 density 0.25147654320987656,0.24321975308641974
before tensor 65536 mask 6850.0 65536
layer2.0.conv3.weight, mask/weight parameters,6850,6766 density 0.17838541666666666,0.17619791666666668
layer2.0.shortcut.0.weight, mask/weight parameters,32510,29057 density 0.2480316162109375,0.22168731689453125
before tensor 65536 mask 3573.0 65536
layer2.1.conv1.weight, mask/weight parameters,3573,3484 density 0.093046875,0.09072916666666667
before tensor 147456 mask 4679.0 147456
layer2.1.conv2.weight, mask/weight parameters,4679,4048 density 0.0924246913580247,0.0799604938271605
before tensor 65536 mask 4708.0 65536
layer2.1.conv3.weight, mask/weight parameters,4708,4039 density 0.12260416666666667,0.10518229166666666
before tensor 65536 mask 10680.0 65536
layer2.2.conv1.weight, mask/weight parameters,10680,10106 density 0.278125,0.26317708333333334
before tensor 147456 mask 22001.0 147456
layer2.2.conv2.weight, mask/weight parameters,22001,20759 density 0.43458765432098767,0.4100543209876543
before tensor 65536 mask 13465.0 65536
layer2.2.conv3.weight, mask/weight parameters,13465,12821 density 0.35065104166666666,0.3338802083333333
before tensor 65536 mask 10973.0 65536
layer2.3.conv1.weight, mask/weight parameters,10973,10296 density 0.28575520833333334,0.268125
before tensor 147456 mask 20343.0 147456
layer2.3.conv2.weight, mask/weight parameters,20343,19847 density 0.40183703703703705,0.3920395061728395
before tensor 65536 mask 10977.0 65536
layer2.3.conv3.weight, mask/weight parameters,10977,10731 density 0.285859375,0.279453125
before tensor 131072 mask 30994.0 131072
layer3.0.conv1.weight, mask/weight parameters,30994,28571 density 0.4766547736220472,0.4393916092519685
before tensor 589824 mask 61687.0 589824
layer3.0.conv2.weight, mask/weight parameters,61687,59970 density 0.42495573880036647,0.4131274929216525
before tensor 262144 mask 57253.0 262144
layer3.0.conv3.weight, mask/weight parameters,57253,55652 density 0.4402451402559055,0.4279343011811024
layer3.0.shortcut.0.weight, mask/weight parameters,99798,93731 density 0.19034957885742188,0.17877769470214844
before tensor 262144 mask 27841.0 262144
layer3.1.conv1.weight, mask/weight parameters,27841,26674 density 0.21408249261811024,0.20510888287401574
before tensor 589824 mask 61009.0 589824
layer3.1.conv2.weight, mask/weight parameters,61009,57824 density 0.4202850627923478,0.3983439077989267
before tensor 262144 mask 52128.0 262144
layer3.1.conv3.weight, mask/weight parameters,52128,49854 density 0.40083661417322836,0.3833507627952756
before tensor 262144 mask 30773.0 262144
layer3.2.conv1.weight, mask/weight parameters,30773,28708 density 0.23662801427165353,0.2207492618110236
before tensor 589824 mask 53133.0 589824
layer3.2.conv2.weight, mask/weight parameters,53133,51146 density 0.3660280653894641,0.3523398157907427
before tensor 262144 mask 50377.0 262144
layer3.2.conv3.weight, mask/weight parameters,50377,48294 density 0.38737235482283466,0.37135519192913385
before tensor 262144 mask 33581.0 262144
layer3.3.conv1.weight, mask/weight parameters,33581,32058 density 0.2582200418307087,0.2465089812992126
before tensor 589824 mask 47666.0 589824
layer3.3.conv2.weight, mask/weight parameters,47666,45756 density 0.3283664345106468,0.3152086304172608
before tensor 262144 mask 43551.0 262144
layer3.3.conv3.weight, mask/weight parameters,43551,41879 density 0.33488404281496065,0.32202725147637795
before tensor 262144 mask 39376.0 262144
layer3.4.conv1.weight, mask/weight parameters,39376,36963 density 0.3027805118110236,0.2842258243110236
before tensor 589824 mask 49168.0 589824
layer3.4.conv2.weight, mask/weight parameters,49168,47010 density 0.3387135663160215,0.3238473143612954
before tensor 262144 mask 40314.0 262144
layer3.4.conv3.weight, mask/weight parameters,40314,38945 density 0.30999323326771655,0.2994663508858268
before tensor 262144 mask 45251.0 262144
layer3.5.conv1.weight, mask/weight parameters,45251,43102 density 0.34795613927165353,0.33143147145669294
before tensor 589824 mask 48708.0 589824
layer3.5.conv2.weight, mask/weight parameters,48708,46829 density 0.33554467108934216,0.32260042297862374
before tensor 262144 mask 39307.0 262144
layer3.5.conv3.weight, mask/weight parameters,39307,38003 density 0.30224993848425197,0.2922228715551181
before tensor 524288 mask 135935.0 524288
layer4.0.conv1.weight, mask/weight parameters,135935,131104 density 0.5746710971320347,0.5542478354978355
before tensor 2359296 mask 195219.0 2359296
layer4.0.conv2.weight, mask/weight parameters,195219,188829 density 0.40649538052135453,0.3931897828001724
before tensor 1048576 mask 102349.0 1048576
layer4.0.conv3.weight, mask/weight parameters,102349,99365 density 0.21634241409632035,0.21003491950757575
layer4.0.shortcut.0.weight, mask/weight parameters,141451,134101 density 0.06744909286499023,0.06394433975219727
before tensor 1048576 mask 117930.0 1048576
layer4.1.conv1.weight, mask/weight parameters,117930,113330 density 0.2492770900974026,0.23955374053030304
before tensor 2359296 mask 192770.0 2359296
layer4.1.conv2.weight, mask/weight parameters,192770,185539 density 0.40139594252148364,0.38633916988895345
before tensor 1048576 mask 82865.0 1048576
layer4.1.conv3.weight, mask/weight parameters,82865,80563 density 0.17515768736471862,0.17029178503787878
before tensor 1048576 mask 81377.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81377,77009 density 0.1720123951569264,0.16277944061147187
before tensor 2359296 mask 70253.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70253,66508 density 0.14628453156591684,0.13848649346484845
before tensor 1048576 mask 35361.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35361,34241 density 0.07474507913961038,0.07237765489718614
classifier.weight, mask/weight parameters,105502,105235 density 0.515146484375,0.5138427734375
Total Model parameters after dst: 2365202 2267114
Total parameters under density level of 0.1: 0.23656789208704473 0.22675711423422962 after dst
Death rate: 0.10002919433368185


Training summary: Average loss: 0.0726, Accuracy: 49295/50000 (98.590%)


Evaluation: Average loss: 0.9492, Accuracy: 7629/10000 (76.290%)

Current learning rate: 0.001. Time taken for epoch: 88.74 seconds.

Train Epoch: 132 [0/50000 (0%)]	Loss: 0.079931 Accuracy: 98/100 (98.000%
Train Epoch: 132 [10000/50000 (20%)]	Loss: 0.057118 Accuracy: 9979/10100 (98.802%
Train Epoch: 132 [20000/50000 (40%)]	Loss: 0.066445 Accuracy: 19850/20100 (98.756%
Train Epoch: 132 [30000/50000 (60%)]	Loss: 0.066621 Accuracy: 29711/30100 (98.708%
Train Epoch: 132 [40000/50000 (80%)]	Loss: 0.107100 Accuracy: 39586/40100 (98.718%

Training summary: Average loss: 0.0698, Accuracy: 49345/50000 (98.690%)


Evaluation: Average loss: 0.9557, Accuracy: 7643/10000 (76.430%)

Current learning rate: 0.001. Time taken for epoch: 88.37 seconds.

Train Epoch: 133 [0/50000 (0%)]	Loss: 0.093982 Accuracy: 99/100 (99.000%
Train Epoch: 133 [10000/50000 (20%)]	Loss: 0.076398 Accuracy: 9949/10100 (98.505%
Train Epoch: 133 [20000/50000 (40%)]	Loss: 0.080907 Accuracy: 19812/20100 (98.567%
Train Epoch: 133 [30000/50000 (60%)]	Loss: 0.068727 Accuracy: 29670/30100 (98.571%
Train Epoch: 133 [40000/50000 (80%)]	Loss: 0.057250 Accuracy: 39528/40100 (98.574%
current dst rate 0.03655723824948228


dynamic sparse change
conv1.weight, mask/weight parameters,1165,1165 density 0.6741898148148148,0.6741898148148148
before tensor 4096 mask 662.0 4096
layer1.0.conv1.weight, mask/weight parameters,662,662 density 0.22007978723404256,0.22007978723404256
before tensor 36864 mask 3642.0 36864
layer1.0.conv2.weight, mask/weight parameters,3642,3642 density 0.18318998038328052,0.18318998038328052
before tensor 16384 mask 3687.0 16384
layer1.0.conv3.weight, mask/weight parameters,3687,3687 density 0.3064328457446808,0.3064328457446808
layer1.0.shortcut.0.weight, mask/weight parameters,5502,5502 density 0.3358154296875,0.3358154296875
before tensor 16384 mask 2391.0 16384
layer1.1.conv1.weight, mask/weight parameters,2391,2391 density 0.19872007978723405,0.19872007978723405
before tensor 36864 mask 3940.0 36864
layer1.1.conv2.weight, mask/weight parameters,3940,3940 density 0.19817916603792565,0.19817916603792565
before tensor 16384 mask 2152.0 16384
layer1.1.conv3.weight, mask/weight parameters,2152,2152 density 0.17885638297872342,0.17885638297872342
before tensor 16384 mask 2800.0 16384
layer1.2.conv1.weight, mask/weight parameters,2800,2800 density 0.2327127659574468,0.2327127659574468
before tensor 36864 mask 3393.0 36864
layer1.2.conv2.weight, mask/weight parameters,3393,3393 density 0.1706654594839294,0.1706654594839294
before tensor 16384 mask 1801.0 16384
layer1.2.conv3.weight, mask/weight parameters,1801,1801 density 0.1496841755319149,0.1496841755319149
before tensor 32768 mask 5265.0 32768
layer2.0.conv1.weight, mask/weight parameters,5265,5265 density 0.27421875,0.27421875
before tensor 147456 mask 12379.0 147456
layer2.0.conv2.weight, mask/weight parameters,12379,12379 density 0.24452345679012347,0.24452345679012347
before tensor 65536 mask 6780.0 65536
layer2.0.conv3.weight, mask/weight parameters,6780,6780 density 0.1765625,0.1765625
layer2.0.shortcut.0.weight, mask/weight parameters,29161,29161 density 0.22248077392578125,0.22248077392578125
before tensor 65536 mask 3488.0 65536
layer2.1.conv1.weight, mask/weight parameters,3488,3488 density 0.09083333333333334,0.09083333333333334
before tensor 147456 mask 4117.0 147456
layer2.1.conv2.weight, mask/weight parameters,4117,4117 density 0.08132345679012346,0.08132345679012346
before tensor 65536 mask 4094.0 65536
layer2.1.conv3.weight, mask/weight parameters,4094,4094 density 0.10661458333333333,0.10661458333333333
before tensor 65536 mask 10142.0 65536
layer2.2.conv1.weight, mask/weight parameters,10142,10142 density 0.2641145833333333,0.2641145833333333
before tensor 147456 mask 20914.0 147456
layer2.2.conv2.weight, mask/weight parameters,20914,20914 density 0.41311604938271607,0.41311604938271607
before tensor 65536 mask 12934.0 65536
layer2.2.conv3.weight, mask/weight parameters,12934,12934 density 0.3368229166666667,0.3368229166666667
before tensor 65536 mask 10372.0 65536
layer2.3.conv1.weight, mask/weight parameters,10372,10372 density 0.27010416666666665,0.27010416666666665
before tensor 147456 mask 19936.0 147456
layer2.3.conv2.weight, mask/weight parameters,19936,19936 density 0.39379753086419755,0.39379753086419755
before tensor 65536 mask 10765.0 65536
layer2.3.conv3.weight, mask/weight parameters,10765,10765 density 0.28033854166666666,0.28033854166666666
before tensor 131072 mask 28913.0 131072
layer3.0.conv1.weight, mask/weight parameters,28913,28913 density 0.4446512057086614,0.4446512057086614
before tensor 589824 mask 60195.0 589824
layer3.0.conv2.weight, mask/weight parameters,60195,60195 density 0.4146774960216587,0.4146774960216587
before tensor 262144 mask 55925.0 262144
layer3.0.conv3.weight, mask/weight parameters,55925,55925 density 0.43003352608267714,0.43003352608267714
layer3.0.shortcut.0.weight, mask/weight parameters,94202,94202 density 0.17967605590820312,0.17967605590820312
before tensor 262144 mask 26809.0 262144
layer3.1.conv1.weight, mask/weight parameters,26809,26809 density 0.20614696112204725,0.20614696112204725
before tensor 589824 mask 58298.0 589824
layer3.1.conv2.weight, mask/weight parameters,58298,58298 density 0.40160924766293976,0.40160924766293976
before tensor 262144 mask 50239.0 262144
layer3.1.conv3.weight, mask/weight parameters,50239,50239 density 0.3863112081692913,0.3863112081692913
before tensor 262144 mask 29045.0 262144
layer3.2.conv1.weight, mask/weight parameters,29045,29045 density 0.2233406126968504,0.2233406126968504
before tensor 589824 mask 51431.0 589824
layer3.2.conv2.weight, mask/weight parameters,51431,51431 density 0.35430315305075055,0.35430315305075055
before tensor 262144 mask 48676.0 262144
layer3.2.conv3.weight, mask/weight parameters,48676,48676 density 0.3742925688976378,0.3742925688976378
before tensor 262144 mask 32301.0 262144
layer3.3.conv1.weight, mask/weight parameters,32301,32301 density 0.2483775221456693,0.2483775221456693
before tensor 589824 mask 46069.0 589824
layer3.3.conv2.weight, mask/weight parameters,46069,46069 density 0.3173648569519361,0.3173648569519361
before tensor 262144 mask 42194.0 262144
layer3.3.conv3.weight, mask/weight parameters,42194,42194 density 0.3244494340551181,0.3244494340551181
before tensor 262144 mask 37405.0 262144
layer3.4.conv1.weight, mask/weight parameters,37405,37405 density 0.2876245693897638,0.2876245693897638
before tensor 589824 mask 47318.0 589824
layer3.4.conv2.weight, mask/weight parameters,47318,47318 density 0.3259690963826372,0.3259690963826372
before tensor 262144 mask 39183.0 262144
layer3.4.conv3.weight, mask/weight parameters,39183,39183 density 0.3012964443897638,0.3012964443897638
before tensor 262144 mask 43464.0 262144
layer3.5.conv1.weight, mask/weight parameters,43464,43464 density 0.3342150590551181,0.3342150590551181
before tensor 589824 mask 47151.0 589824
layer3.5.conv2.weight, mask/weight parameters,47151,47151 density 0.3248186496372993,0.3248186496372993
before tensor 262144 mask 38221.0 262144
layer3.5.conv3.weight, mask/weight parameters,38221,38221 density 0.2938991756889764,0.2938991756889764
before tensor 524288 mask 131935.0 524288
layer4.0.conv1.weight, mask/weight parameters,131935,131935 density 0.5577609239718615,0.5577609239718615
before tensor 2359296 mask 189544.0 2359296
layer4.0.conv2.weight, mask/weight parameters,189544,189544 density 0.39467859381279297,0.39467859381279297
before tensor 1048576 mask 99647.0 1048576
layer4.0.conv3.weight, mask/weight parameters,99647,99647 density 0.21063100311147187,0.21063100311147187
layer4.0.shortcut.0.weight, mask/weight parameters,134346,134346 density 0.06406116485595703,0.06406116485595703
before tensor 1048576 mask 113774.0 1048576
layer4.1.conv1.weight, mask/weight parameters,113774,113774 density 0.24049225514069264,0.24049225514069264
before tensor 2359296 mask 186348.0 2359296
layer4.1.conv2.weight, mask/weight parameters,186348,186348 density 0.38802371269903735,0.38802371269903735
before tensor 1048576 mask 80780.0 1048576
layer4.1.conv3.weight, mask/weight parameters,80780,80780 density 0.17075047348484848,0.17075047348484848
before tensor 1048576 mask 77430.0 1048576
layer4.2.conv1.weight, mask/weight parameters,77430,77430 density 0.16366933847402598,0.16366933847402598
before tensor 2359296 mask 66794.0 2359296
layer4.2.conv2.weight, mask/weight parameters,66794,66794 density 0.13908201786989666,0.13908201786989666
before tensor 1048576 mask 34381.0 1048576
layer4.2.conv3.weight, mask/weight parameters,34381,34381 density 0.07267358292748918,0.07267358292748918
classifier.weight, mask/weight parameters,105237,105237 density 0.5138525390625,0.5138525390625
Total Model parameters after dst: 2278737 2278737
Total parameters under density level of 0.1: 0.227919648601158 0.227919648601158 after dst
Death rate: 0.10011670915000782

self.baseline_nonzero-self.total_nonzero 86466.20000000112
len(all_scores) 9997984 6739603
increse 86466.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1179,1165 density 0.6822916666666666,0.6741898148148148
before tensor 4096 mask 671.0 4096
layer1.0.conv1.weight, mask/weight parameters,671,662 density 0.2230718085106383,0.22007978723404256
before tensor 36864 mask 3676.0 36864
layer1.0.conv2.weight, mask/weight parameters,3676,3642 density 0.18490015592777023,0.18318998038328052
before tensor 16384 mask 3771.0 16384
layer1.0.conv3.weight, mask/weight parameters,3771,3687 density 0.31341422872340424,0.3064328457446808
layer1.0.shortcut.0.weight, mask/weight parameters,5683,5502 density 0.34686279296875,0.3358154296875
before tensor 16384 mask 2416.0 16384
layer1.1.conv1.weight, mask/weight parameters,2416,2391 density 0.20079787234042554,0.19872007978723405
before tensor 36864 mask 3972.0 36864
layer1.1.conv2.weight, mask/weight parameters,3972,3940 density 0.1997887430209748,0.19817916603792565
before tensor 16384 mask 2177.0 16384
layer1.1.conv3.weight, mask/weight parameters,2177,2152 density 0.1809341755319149,0.17885638297872342
before tensor 16384 mask 2861.0 16384
layer1.2.conv1.weight, mask/weight parameters,2861,2800 density 0.23778257978723405,0.2327127659574468
before tensor 36864 mask 3434.0 36864
layer1.2.conv2.weight, mask/weight parameters,3434,3393 density 0.1727277299934611,0.1706654594839294
before tensor 16384 mask 1844.0 16384
layer1.2.conv3.weight, mask/weight parameters,1844,1801 density 0.15325797872340424,0.1496841755319149
before tensor 32768 mask 5472.0 32768
layer2.0.conv1.weight, mask/weight parameters,5472,5265 density 0.285,0.27421875
before tensor 147456 mask 12526.0 147456
layer2.0.conv2.weight, mask/weight parameters,12526,12379 density 0.24742716049382715,0.24452345679012347
before tensor 65536 mask 6878.0 65536
layer2.0.conv3.weight, mask/weight parameters,6878,6780 density 0.17911458333333333,0.1765625
layer2.0.shortcut.0.weight, mask/weight parameters,30128,29161 density 0.2298583984375,0.22248077392578125
before tensor 65536 mask 3551.0 65536
layer2.1.conv1.weight, mask/weight parameters,3551,3488 density 0.09247395833333333,0.09083333333333334
before tensor 147456 mask 4361.0 147456
layer2.1.conv2.weight, mask/weight parameters,4361,4117 density 0.08614320987654321,0.08132345679012346
before tensor 65536 mask 4223.0 65536
layer2.1.conv3.weight, mask/weight parameters,4223,4094 density 0.10997395833333333,0.10661458333333333
before tensor 65536 mask 10404.0 65536
layer2.2.conv1.weight, mask/weight parameters,10404,10142 density 0.2709375,0.2641145833333333
before tensor 147456 mask 21646.0 147456
layer2.2.conv2.weight, mask/weight parameters,21646,20914 density 0.4275753086419753,0.41311604938271607
before tensor 65536 mask 13264.0 65536
layer2.2.conv3.weight, mask/weight parameters,13264,12934 density 0.34541666666666665,0.3368229166666667
before tensor 65536 mask 10594.0 65536
layer2.3.conv1.weight, mask/weight parameters,10594,10372 density 0.27588541666666666,0.27010416666666665
before tensor 147456 mask 20209.0 147456
layer2.3.conv2.weight, mask/weight parameters,20209,19936 density 0.3991901234567901,0.39379753086419755
before tensor 65536 mask 10923.0 65536
layer2.3.conv3.weight, mask/weight parameters,10923,10765 density 0.284453125,0.28033854166666666
before tensor 131072 mask 29861.0 131072
layer3.0.conv1.weight, mask/weight parameters,29861,28913 density 0.459230437992126,0.4446512057086614
before tensor 589824 mask 61413.0 589824
layer3.0.conv2.weight, mask/weight parameters,61413,60195 density 0.4230681794696923,0.4146774960216587
before tensor 262144 mask 57644.0 262144
layer3.0.conv3.weight, mask/weight parameters,57644,55925 density 0.4432517224409449,0.43003352608267714
layer3.0.shortcut.0.weight, mask/weight parameters,97149,94202 density 0.18529701232910156,0.17967605590820312
before tensor 262144 mask 27912.0 262144
layer3.1.conv1.weight, mask/weight parameters,27912,26809 density 0.21462844488188976,0.20614696112204725
before tensor 589824 mask 61370.0 589824
layer3.1.conv2.weight, mask/weight parameters,61370,58298 density 0.42277195665502443,0.40160924766293976
before tensor 262144 mask 52580.0 262144
layer3.1.conv3.weight, mask/weight parameters,52580,50239 density 0.40431225393700787,0.3863112081692913
before tensor 262144 mask 30070.0 262144
layer3.2.conv1.weight, mask/weight parameters,30070,29045 density 0.23122231791338582,0.2233406126968504
before tensor 589824 mask 53333.0 589824
layer3.2.conv2.weight, mask/weight parameters,53333,51431 density 0.36740584592280295,0.35430315305075055
before tensor 262144 mask 50804.0 262144
layer3.2.conv3.weight, mask/weight parameters,50804,48676 density 0.39065575787401574,0.3742925688976378
before tensor 262144 mask 33489.0 262144
layer3.3.conv1.weight, mask/weight parameters,33489,32301 density 0.25751261072834647,0.2483775221456693
before tensor 589824 mask 47469.0 589824
layer3.3.conv2.weight, mask/weight parameters,47469,46069 density 0.327009320685308,0.3173648569519361
before tensor 262144 mask 43642.0 262144
layer3.3.conv3.weight, mask/weight parameters,43642,42194 density 0.3355837844488189,0.3244494340551181
before tensor 262144 mask 39160.0 262144
layer3.4.conv1.weight, mask/weight parameters,39160,37405 density 0.3011195866141732,0.2876245693897638
before tensor 589824 mask 49095.0 589824
layer3.4.conv2.weight, mask/weight parameters,49095,47318 density 0.33821067642135283,0.3259690963826372
before tensor 262144 mask 40698.0 262144
layer3.4.conv3.weight, mask/weight parameters,40698,39183 density 0.31294598917322836,0.3012964443897638
before tensor 262144 mask 45715.0 262144
layer3.5.conv1.weight, mask/weight parameters,45715,43464 density 0.3515240526574803,0.3342150590551181
before tensor 589824 mask 48804.0 589824
layer3.5.conv2.weight, mask/weight parameters,48804,47151 density 0.3362060057453448,0.3248186496372993
before tensor 262144 mask 39438.0 262144
layer3.5.conv3.weight, mask/weight parameters,39438,38221 density 0.3032572588582677,0.2938991756889764
before tensor 524288 mask 136407.0 524288
layer4.0.conv1.weight, mask/weight parameters,136407,131935 density 0.576666497564935,0.5577609239718615
before tensor 2359296 mask 196833.0 2359296
layer4.0.conv2.weight, mask/weight parameters,196833,189544 density 0.40985613712886443,0.39467859381279297
before tensor 1048576 mask 103775.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103775,99647 density 0.21935665246212122,0.21063100311147187
layer4.0.shortcut.0.weight, mask/weight parameters,140276,134346 density 0.06688880920410156,0.06406116485595703
before tensor 1048576 mask 118854.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118854,113774 density 0.2512302150974026,0.24049225514069264
before tensor 2359296 mask 194602.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194602,186348 density 0.4052106303188554,0.38802371269903735
before tensor 1048576 mask 84172.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84172,80780 density 0.17792038690476192,0.17075047348484848
before tensor 1048576 mask 83222.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83222,77430 density 0.17591230384199133,0.16366933847402598
before tensor 2359296 mask 70480.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70480,66794 density 0.14675720303425932,0.13908201786989666
before tensor 1048576 mask 35525.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35525,34381 density 0.07509173768939394,0.07267358292748918
classifier.weight, mask/weight parameters,105547,105237 density 0.5153662109375,0.5138525390625
Total Model parameters after dst: 2365202 2278737
Total parameters under density level of 0.1: 0.23656789208704473 0.227919648601158 after dst
Death rate: 0.10011670915000782


Training summary: Average loss: 0.0720, Accuracy: 49257/50000 (98.514%)


Evaluation: Average loss: 0.9597, Accuracy: 7655/10000 (76.550%)

Current learning rate: 0.001. Time taken for epoch: 88.77 seconds.

Train Epoch: 134 [0/50000 (0%)]	Loss: 0.079160 Accuracy: 99/100 (99.000%
Train Epoch: 134 [10000/50000 (20%)]	Loss: 0.089733 Accuracy: 9961/10100 (98.624%
Train Epoch: 134 [20000/50000 (40%)]	Loss: 0.049984 Accuracy: 19821/20100 (98.612%
Train Epoch: 134 [30000/50000 (60%)]	Loss: 0.072365 Accuracy: 29689/30100 (98.635%
Train Epoch: 134 [40000/50000 (80%)]	Loss: 0.051174 Accuracy: 39554/40100 (98.638%

Training summary: Average loss: 0.0677, Accuracy: 49339/50000 (98.678%)


Evaluation: Average loss: 0.9556, Accuracy: 7633/10000 (76.330%)

Current learning rate: 0.001. Time taken for epoch: 88.36 seconds.

Train Epoch: 135 [0/50000 (0%)]	Loss: 0.063775 Accuracy: 98/100 (98.000%
Train Epoch: 135 [10000/50000 (20%)]	Loss: 0.055768 Accuracy: 9988/10100 (98.891%
Train Epoch: 135 [20000/50000 (40%)]	Loss: 0.076350 Accuracy: 19869/20100 (98.851%
Train Epoch: 135 [30000/50000 (60%)]	Loss: 0.069144 Accuracy: 29706/30100 (98.691%
Train Epoch: 135 [40000/50000 (80%)]	Loss: 0.044632 Accuracy: 39592/40100 (98.733%
current dst rate 0.031975885263377204


dynamic sparse change
conv1.weight, mask/weight parameters,1172,1172 density 0.6782407407407407,0.6782407407407407
before tensor 4096 mask 660.0 4096
layer1.0.conv1.weight, mask/weight parameters,660,660 density 0.21941489361702127,0.21941489361702127
before tensor 36864 mask 3644.0 36864
layer1.0.conv2.weight, mask/weight parameters,3644,3644 density 0.1832905789447211,0.1832905789447211
before tensor 16384 mask 3709.0 16384
layer1.0.conv3.weight, mask/weight parameters,3709,3709 density 0.30826130319148937,0.30826130319148937
layer1.0.shortcut.0.weight, mask/weight parameters,5530,5530 density 0.3375244140625,0.3375244140625
before tensor 16384 mask 2388.0 16384
layer1.1.conv1.weight, mask/weight parameters,2388,2388 density 0.19847074468085107,0.19847074468085107
before tensor 36864 mask 3946.0 36864
layer1.1.conv2.weight, mask/weight parameters,3946,3946 density 0.19848096172224738,0.19848096172224738
before tensor 16384 mask 2155.0 16384
layer1.1.conv3.weight, mask/weight parameters,2155,2155 density 0.1791057180851064,0.1791057180851064
before tensor 16384 mask 2787.0 16384
layer1.2.conv1.weight, mask/weight parameters,2787,2787 density 0.23163231382978725,0.23163231382978725
before tensor 36864 mask 3405.0 36864
layer1.2.conv2.weight, mask/weight parameters,3405,3405 density 0.1712690508525728,0.1712690508525728
before tensor 16384 mask 1816.0 16384
layer1.2.conv3.weight, mask/weight parameters,1816,1816 density 0.15093085106382978,0.15093085106382978
before tensor 32768 mask 5262.0 32768
layer2.0.conv1.weight, mask/weight parameters,5262,5262 density 0.2740625,0.2740625
before tensor 147456 mask 12402.0 147456
layer2.0.conv2.weight, mask/weight parameters,12402,12402 density 0.24497777777777777,0.24497777777777777
before tensor 65536 mask 6793.0 65536
layer2.0.conv3.weight, mask/weight parameters,6793,6793 density 0.17690104166666668,0.17690104166666668
layer2.0.shortcut.0.weight, mask/weight parameters,29267,29267 density 0.22328948974609375,0.22328948974609375
before tensor 65536 mask 3505.0 65536
layer2.1.conv1.weight, mask/weight parameters,3505,3505 density 0.09127604166666667,0.09127604166666667
before tensor 147456 mask 4154.0 147456
layer2.1.conv2.weight, mask/weight parameters,4154,4154 density 0.08205432098765432,0.08205432098765432
before tensor 65536 mask 4118.0 65536
layer2.1.conv3.weight, mask/weight parameters,4118,4118 density 0.10723958333333333,0.10723958333333333
before tensor 65536 mask 10178.0 65536
layer2.2.conv1.weight, mask/weight parameters,10178,10178 density 0.26505208333333335,0.26505208333333335
before tensor 147456 mask 20993.0 147456
layer2.2.conv2.weight, mask/weight parameters,20993,20993 density 0.41467654320987657,0.41467654320987657
before tensor 65536 mask 12977.0 65536
layer2.2.conv3.weight, mask/weight parameters,12977,12977 density 0.33794270833333334,0.33794270833333334
before tensor 65536 mask 10390.0 65536
layer2.3.conv1.weight, mask/weight parameters,10390,10390 density 0.27057291666666666,0.27057291666666666
before tensor 147456 mask 19965.0 147456
layer2.3.conv2.weight, mask/weight parameters,19965,19965 density 0.39437037037037037,0.39437037037037037
before tensor 65536 mask 10794.0 65536
layer2.3.conv3.weight, mask/weight parameters,10794,10794 density 0.28109375,0.28109375
before tensor 131072 mask 28966.0 131072
layer3.0.conv1.weight, mask/weight parameters,28966,28966 density 0.44546628937007876,0.44546628937007876
before tensor 589824 mask 60320.0 589824
layer3.0.conv2.weight, mask/weight parameters,60320,60320 density 0.4155386088549955,0.4155386088549955
before tensor 262144 mask 56222.0 262144
layer3.0.conv3.weight, mask/weight parameters,56222,56222 density 0.43231729822834647,0.43231729822834647
layer3.0.shortcut.0.weight, mask/weight parameters,94461,94461 density 0.18017005920410156,0.18017005920410156
before tensor 262144 mask 26955.0 262144
layer3.1.conv1.weight, mask/weight parameters,26955,26955 density 0.20726962352362205,0.20726962352362205
before tensor 589824 mask 58723.0 589824
layer3.1.conv2.weight, mask/weight parameters,58723,58723 density 0.4045370312962848,0.4045370312962848
before tensor 262144 mask 50697.0 262144
layer3.1.conv3.weight, mask/weight parameters,50697,50697 density 0.3898329847440945,0.3898329847440945
before tensor 262144 mask 29179.0 262144
layer3.2.conv1.weight, mask/weight parameters,29179,29179 density 0.22437100147637795,0.22437100147637795
before tensor 589824 mask 51712.0 589824
layer3.2.conv2.weight, mask/weight parameters,51712,51712 density 0.3562389347000916,0.3562389347000916
before tensor 262144 mask 49113.0 262144
layer3.2.conv3.weight, mask/weight parameters,49113,49113 density 0.3776528666338583,0.3776528666338583
before tensor 262144 mask 32471.0 262144
layer3.3.conv1.weight, mask/weight parameters,32471,32471 density 0.24968473179133857,0.24968473179133857
before tensor 589824 mask 46264.0 589824
layer3.3.conv2.weight, mask/weight parameters,46264,46264 density 0.3187081929719415,0.3187081929719415
before tensor 262144 mask 42444.0 262144
layer3.3.conv3.weight, mask/weight parameters,42444,42444 density 0.3263718011811024,0.3263718011811024
before tensor 262144 mask 37669.0 262144
layer3.4.conv1.weight, mask/weight parameters,37669,37669 density 0.2896545890748031,0.2896545890748031
before tensor 589824 mask 47609.0 589824
layer3.4.conv2.weight, mask/weight parameters,47609,47609 density 0.3279737670586452,0.3279737670586452
before tensor 262144 mask 39512.0 262144
layer3.4.conv3.weight, mask/weight parameters,39512,39512 density 0.30382627952755903,0.30382627952755903
before tensor 262144 mask 43854.0 262144
layer3.5.conv1.weight, mask/weight parameters,43854,43854 density 0.33721395177165353,0.33721395177165353
before tensor 589824 mask 47369.0 589824
layer3.5.conv2.weight, mask/weight parameters,47369,47369 density 0.3263204304186386,0.3263204304186386
before tensor 262144 mask 38457.0 262144
layer3.5.conv3.weight, mask/weight parameters,38457,38457 density 0.2957138902559055,0.2957138902559055
before tensor 524288 mask 132728.0 524288
layer4.0.conv1.weight, mask/weight parameters,132728,132728 density 0.5611133658008658,0.5611133658008658
before tensor 2359296 mask 190482.0 2359296
layer4.0.conv2.weight, mask/weight parameters,190482,190482 density 0.39663174728109796,0.39663174728109796
before tensor 1048576 mask 100053.0 1048576
layer4.0.conv3.weight, mask/weight parameters,100053,100053 density 0.21148919439935066,0.21148919439935066
layer4.0.shortcut.0.weight, mask/weight parameters,134593,134593 density 0.0641789436340332,0.0641789436340332
before tensor 1048576 mask 114288.0 1048576
layer4.1.conv1.weight, mask/weight parameters,114288,114288 density 0.24157873376623376,0.24157873376623376
before tensor 2359296 mask 187445.0 2359296
layer4.1.conv2.weight, mask/weight parameters,187445,187445 density 0.39030794442049854,0.39030794442049854
before tensor 1048576 mask 81084.0 1048576
layer4.1.conv3.weight, mask/weight parameters,81084,81084 density 0.17139306006493507,0.17139306006493507
before tensor 1048576 mask 77899.0 1048576
layer4.2.conv1.weight, mask/weight parameters,77899,77899 density 0.16466069737554112,0.16466069737554112
before tensor 2359296 mask 67173.0 2359296
layer4.2.conv2.weight, mask/weight parameters,67173,67173 density 0.13987119181924376,0.13987119181924376
before tensor 1048576 mask 34582.0 1048576
layer4.2.conv3.weight, mask/weight parameters,34582,34582 density 0.07309845102813853,0.07309845102813853
classifier.weight, mask/weight parameters,105239,105239 density 0.5138623046875,0.5138623046875
Total Model parameters after dst: 2289573 2289573
Total parameters under density level of 0.1: 0.22900346709896716 0.22900346709896716 after dst
Death rate: 0.10026234005406989

self.baseline_nonzero-self.total_nonzero 75630.20000000112
len(all_scores) 9997984 6729381
increse 75630.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1175,1172 density 0.6799768518518519,0.6782407407407407
before tensor 4096 mask 663.0 4096
layer1.0.conv1.weight, mask/weight parameters,663,660 density 0.2204122340425532,0.21941489361702127
before tensor 36864 mask 3661.0 36864
layer1.0.conv2.weight, mask/weight parameters,3661,3644 density 0.18414566671696594,0.1832905789447211
before tensor 16384 mask 3733.0 16384
layer1.0.conv3.weight, mask/weight parameters,3733,3709 density 0.31025598404255317,0.30826130319148937
layer1.0.shortcut.0.weight, mask/weight parameters,5647,5530 density 0.34466552734375,0.3375244140625
before tensor 16384 mask 2437.0 16384
layer1.1.conv1.weight, mask/weight parameters,2437,2388 density 0.2025432180851064,0.19847074468085107
before tensor 36864 mask 3969.0 36864
layer1.1.conv2.weight, mask/weight parameters,3969,3946 density 0.19963784517881394,0.19848096172224738
before tensor 16384 mask 2174.0 16384
layer1.1.conv3.weight, mask/weight parameters,2174,2155 density 0.18068484042553193,0.1791057180851064
before tensor 16384 mask 2848.0 16384
layer1.2.conv1.weight, mask/weight parameters,2848,2787 density 0.23670212765957446,0.23163231382978725
before tensor 36864 mask 3426.0 36864
layer1.2.conv2.weight, mask/weight parameters,3426,3405 density 0.17232533574769882,0.1712690508525728
before tensor 16384 mask 1867.0 16384
layer1.2.conv3.weight, mask/weight parameters,1867,1816 density 0.1551695478723404,0.15093085106382978
before tensor 32768 mask 5385.0 32768
layer2.0.conv1.weight, mask/weight parameters,5385,5262 density 0.28046875,0.2740625
before tensor 147456 mask 12508.0 147456
layer2.0.conv2.weight, mask/weight parameters,12508,12402 density 0.2470716049382716,0.24497777777777777
before tensor 65536 mask 6897.0 65536
layer2.0.conv3.weight, mask/weight parameters,6897,6793 density 0.179609375,0.17690104166666668
layer2.0.shortcut.0.weight, mask/weight parameters,29977,29267 density 0.22870635986328125,0.22328948974609375
before tensor 65536 mask 3657.0 65536
layer2.1.conv1.weight, mask/weight parameters,3657,3505 density 0.095234375,0.09127604166666667
before tensor 147456 mask 4240.0 147456
layer2.1.conv2.weight, mask/weight parameters,4240,4154 density 0.08375308641975308,0.08205432098765432
before tensor 65536 mask 4186.0 65536
layer2.1.conv3.weight, mask/weight parameters,4186,4118 density 0.10901041666666667,0.10723958333333333
before tensor 65536 mask 10403.0 65536
layer2.2.conv1.weight, mask/weight parameters,10403,10178 density 0.27091145833333335,0.26505208333333335
before tensor 147456 mask 21362.0 147456
layer2.2.conv2.weight, mask/weight parameters,21362,20993 density 0.4219654320987654,0.41467654320987657
before tensor 65536 mask 13212.0 65536
layer2.2.conv3.weight, mask/weight parameters,13212,12977 density 0.3440625,0.33794270833333334
before tensor 65536 mask 10638.0 65536
layer2.3.conv1.weight, mask/weight parameters,10638,10390 density 0.27703125,0.27057291666666666
before tensor 147456 mask 20195.0 147456
layer2.3.conv2.weight, mask/weight parameters,20195,19965 density 0.3989135802469136,0.39437037037037037
before tensor 65536 mask 10845.0 65536
layer2.3.conv3.weight, mask/weight parameters,10845,10794 density 0.282421875,0.28109375
before tensor 131072 mask 29590.0 131072
layer3.0.conv1.weight, mask/weight parameters,29590,28966 density 0.45506274606299213,0.44546628937007876
before tensor 589824 mask 61280.0 589824
layer3.0.conv2.weight, mask/weight parameters,61280,60320 density 0.42215195541502193,0.4155386088549955
before tensor 262144 mask 57655.0 262144
layer3.0.conv3.weight, mask/weight parameters,57655,56222 density 0.4433363065944882,0.43231729822834647
layer3.0.shortcut.0.weight, mask/weight parameters,97894,94461 density 0.18671798706054688,0.18017005920410156
before tensor 262144 mask 28739.0 262144
layer3.1.conv1.weight, mask/weight parameters,28739,26955 density 0.22098763533464566,0.20726962352362205
before tensor 589824 mask 61430.0 589824
layer3.1.conv2.weight, mask/weight parameters,61430,58723 density 0.4231852908150261,0.4045370312962848
before tensor 262144 mask 52982.0 262144
layer3.1.conv3.weight, mask/weight parameters,52982,50697 density 0.40740342027559057,0.3898329847440945
before tensor 262144 mask 30443.0 262144
layer3.2.conv1.weight, mask/weight parameters,30443,29179 density 0.23409048966535434,0.22437100147637795
before tensor 589824 mask 53577.0 589824
layer3.2.conv2.weight, mask/weight parameters,53577,51712 density 0.36908673817347637,0.3562389347000916
before tensor 262144 mask 51180.0 262144
layer3.2.conv3.weight, mask/weight parameters,51180,49113 density 0.39354699803149606,0.3776528666338583
before tensor 262144 mask 34516.0 262144
layer3.3.conv1.weight, mask/weight parameters,34516,32471 density 0.26540969488188976,0.24968473179133857
before tensor 589824 mask 47975.0 589824
layer3.3.conv2.weight, mask/weight parameters,47975,46264 density 0.3304951054346553,0.3187081929719415
before tensor 262144 mask 44004.0 262144
layer3.3.conv3.weight, mask/weight parameters,44004,42444 density 0.3383673720472441,0.3263718011811024
before tensor 262144 mask 39741.0 262144
layer3.4.conv1.weight, mask/weight parameters,39741,37669 density 0.30558716781496065,0.2896545890748031
before tensor 589824 mask 48982.0 589824
layer3.4.conv2.weight, mask/weight parameters,48982,47609 density 0.3374322304200164,0.3279737670586452
before tensor 262144 mask 40618.0 262144
layer3.4.conv3.weight, mask/weight parameters,40618,39512 density 0.31233083169291337,0.30382627952755903
before tensor 262144 mask 46487.0 262144
layer3.5.conv1.weight, mask/weight parameters,46487,43854 density 0.3574603223425197,0.33721395177165353
before tensor 589824 mask 49426.0 589824
layer3.5.conv2.weight, mask/weight parameters,49426,47369 density 0.34049090320402864,0.3263204304186386
before tensor 262144 mask 39763.0 262144
layer3.5.conv3.weight, mask/weight parameters,39763,38457 density 0.3057563361220472,0.2957138902559055
before tensor 524288 mask 136615.0 524288
layer4.0.conv1.weight, mask/weight parameters,136615,132728 density 0.5775458265692641,0.5611133658008658
before tensor 2359296 mask 195098.0 2359296
layer4.0.conv2.weight, mask/weight parameters,195098,190482 density 0.4062434278884495,0.39663174728109796
before tensor 1048576 mask 103313.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103313,100053 density 0.21838008996212122,0.21148919439935066
layer4.0.shortcut.0.weight, mask/weight parameters,140047,134593 density 0.06677961349487305,0.0641789436340332
before tensor 1048576 mask 118655.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118655,114288 density 0.25080957454004327,0.24157873376623376
before tensor 2359296 mask 193463.0 2359296
layer4.1.conv2.weight, mask/weight parameters,193463,187445 density 0.4028389439644851,0.39030794442049854
before tensor 1048576 mask 83171.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83171,81084 density 0.17580450148809523,0.17139306006493507
before tensor 1048576 mask 82276.0 1048576
layer4.2.conv1.weight, mask/weight parameters,82276,77899 density 0.17391267586580086,0.16466069737554112
before tensor 2359296 mask 69871.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69871,67173 density 0.14548911085707622,0.13987119181924376
before tensor 1048576 mask 35708.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35708,34582 density 0.0754785579004329,0.07309845102813853
classifier.weight, mask/weight parameters,105598,105239 density 0.515615234375,0.5138623046875
Total Model parameters after dst: 2365202 2289573
Total parameters under density level of 0.1: 0.23656789208704473 0.22900346709896716 after dst
Death rate: 0.10026234005406989


Training summary: Average loss: 0.0656, Accuracy: 49359/50000 (98.718%)


Evaluation: Average loss: 0.9723, Accuracy: 7604/10000 (76.040%)

Current learning rate: 0.001. Time taken for epoch: 88.68 seconds.

Train Epoch: 136 [0/50000 (0%)]	Loss: 0.057630 Accuracy: 98/100 (98.000%
Train Epoch: 136 [10000/50000 (20%)]	Loss: 0.064090 Accuracy: 9979/10100 (98.802%
Train Epoch: 136 [20000/50000 (40%)]	Loss: 0.053557 Accuracy: 19860/20100 (98.806%
Train Epoch: 136 [30000/50000 (60%)]	Loss: 0.071073 Accuracy: 29749/30100 (98.834%
Train Epoch: 136 [40000/50000 (80%)]	Loss: 0.082342 Accuracy: 39653/40100 (98.885%

Training summary: Average loss: 0.0639, Accuracy: 49427/50000 (98.854%)


Evaluation: Average loss: 0.9568, Accuracy: 7636/10000 (76.360%)

Current learning rate: 0.001. Time taken for epoch: 88.38 seconds.

Train Epoch: 137 [0/50000 (0%)]	Loss: 0.041447 Accuracy: 100/100 (100.000%
Train Epoch: 137 [10000/50000 (20%)]	Loss: 0.096515 Accuracy: 9967/10100 (98.683%
Train Epoch: 137 [20000/50000 (40%)]	Loss: 0.051014 Accuracy: 19848/20100 (98.746%
Train Epoch: 137 [30000/50000 (60%)]	Loss: 0.034878 Accuracy: 29724/30100 (98.751%
Train Epoch: 137 [40000/50000 (80%)]	Loss: 0.062814 Accuracy: 39603/40100 (98.761%
current dst rate 0.027734564478290712


dynamic sparse change
conv1.weight, mask/weight parameters,1170,1170 density 0.6770833333333334,0.6770833333333334
before tensor 4096 mask 660.0 4096
layer1.0.conv1.weight, mask/weight parameters,660,660 density 0.21941489361702127,0.21941489361702127
before tensor 36864 mask 3644.0 36864
layer1.0.conv2.weight, mask/weight parameters,3644,3644 density 0.1832905789447211,0.1832905789447211
before tensor 16384 mask 3708.0 16384
layer1.0.conv3.weight, mask/weight parameters,3708,3708 density 0.3081781914893617,0.3081781914893617
layer1.0.shortcut.0.weight, mask/weight parameters,5535,5535 density 0.33782958984375,0.33782958984375
before tensor 16384 mask 2396.0 16384
layer1.1.conv1.weight, mask/weight parameters,2396,2396 density 0.19913563829787234,0.19913563829787234
before tensor 36864 mask 3946.0 36864
layer1.1.conv2.weight, mask/weight parameters,3946,3946 density 0.19848096172224738,0.19848096172224738
before tensor 16384 mask 2158.0 16384
layer1.1.conv3.weight, mask/weight parameters,2158,2158 density 0.17935505319148937,0.17935505319148937
before tensor 16384 mask 2796.0 16384
layer1.2.conv1.weight, mask/weight parameters,2796,2796 density 0.23238031914893617,0.23238031914893617
before tensor 36864 mask 3397.0 36864
layer1.2.conv2.weight, mask/weight parameters,3397,3397 density 0.17086665660681052,0.17086665660681052
before tensor 16384 mask 1829.0 16384
layer1.2.conv3.weight, mask/weight parameters,1829,1829 density 0.15201130319148937,0.15201130319148937
before tensor 32768 mask 5260.0 32768
layer2.0.conv1.weight, mask/weight parameters,5260,5260 density 0.27395833333333336,0.27395833333333336
before tensor 147456 mask 12406.0 147456
layer2.0.conv2.weight, mask/weight parameters,12406,12406 density 0.2450567901234568,0.2450567901234568
before tensor 65536 mask 6807.0 65536
layer2.0.conv3.weight, mask/weight parameters,6807,6807 density 0.177265625,0.177265625
layer2.0.shortcut.0.weight, mask/weight parameters,29288,29288 density 0.22344970703125,0.22344970703125
before tensor 65536 mask 3521.0 65536
layer2.1.conv1.weight, mask/weight parameters,3521,3521 density 0.09169270833333333,0.09169270833333333
before tensor 147456 mask 4131.0 147456
layer2.1.conv2.weight, mask/weight parameters,4131,4131 density 0.0816,0.0816
before tensor 65536 mask 4110.0 65536
layer2.1.conv3.weight, mask/weight parameters,4110,4110 density 0.10703125,0.10703125
before tensor 65536 mask 10222.0 65536
layer2.2.conv1.weight, mask/weight parameters,10222,10222 density 0.26619791666666665,0.26619791666666665
before tensor 147456 mask 21034.0 147456
layer2.2.conv2.weight, mask/weight parameters,21034,21034 density 0.4154864197530864,0.4154864197530864
before tensor 65536 mask 12996.0 65536
layer2.2.conv3.weight, mask/weight parameters,12996,12996 density 0.3384375,0.3384375
before tensor 65536 mask 10434.0 65536
layer2.3.conv1.weight, mask/weight parameters,10434,10434 density 0.27171875,0.27171875
before tensor 147456 mask 19987.0 147456
layer2.3.conv2.weight, mask/weight parameters,19987,19987 density 0.39480493827160495,0.39480493827160495
before tensor 65536 mask 10798.0 65536
layer2.3.conv3.weight, mask/weight parameters,10798,10798 density 0.28119791666666666,0.28119791666666666
before tensor 131072 mask 29019.0 131072
layer3.0.conv1.weight, mask/weight parameters,29019,29019 density 0.44628137303149606,0.44628137303149606
before tensor 589824 mask 60423.0 589824
layer3.0.conv2.weight, mask/weight parameters,60423,60423 density 0.416248165829665,0.416248165829665
before tensor 262144 mask 56434.0 262144
layer3.0.conv3.weight, mask/weight parameters,56434,56434 density 0.4339474655511811,0.4339474655511811
layer3.0.shortcut.0.weight, mask/weight parameters,94857,94857 density 0.1809253692626953,0.1809253692626953
before tensor 262144 mask 27230.0 262144
layer3.1.conv1.weight, mask/weight parameters,27230,27230 density 0.20938422736220472,0.20938422736220472
before tensor 589824 mask 59101.0 589824
layer3.1.conv2.weight, mask/weight parameters,59101,59101 density 0.40714103650429523,0.40714103650429523
before tensor 262144 mask 51127.0 262144
layer3.1.conv3.weight, mask/weight parameters,51127,51127 density 0.3931394562007874,0.3931394562007874
before tensor 262144 mask 29390.0 262144
layer3.2.conv1.weight, mask/weight parameters,29390,29390 density 0.22599347933070865,0.22599347933070865
before tensor 589824 mask 51980.0 589824
layer3.2.conv2.weight, mask/weight parameters,51980,51980 density 0.3580851606147657,0.3580851606147657
before tensor 262144 mask 49431.0 262144
layer3.2.conv3.weight, mask/weight parameters,49431,49431 density 0.38009811761811024,0.38009811761811024
before tensor 262144 mask 32877.0 262144
layer3.3.conv1.weight, mask/weight parameters,32877,32877 density 0.252806656003937,0.252806656003937
before tensor 589824 mask 46581.0 589824
layer3.3.conv2.weight, mask/weight parameters,46581,46581 density 0.32089197511728357,0.32089197511728357
before tensor 262144 mask 42773.0 262144
layer3.3.conv3.weight, mask/weight parameters,42773,42773 density 0.3289016363188976,0.3289016363188976
before tensor 262144 mask 38041.0 262144
layer3.4.conv1.weight, mask/weight parameters,38041,38041 density 0.2925150713582677,0.2925150713582677
before tensor 589824 mask 47813.0 589824
layer3.4.conv2.weight, mask/weight parameters,47813,47813 density 0.32937910320265085,0.32937910320265085
before tensor 262144 mask 39688.0 262144
layer3.4.conv3.weight, mask/weight parameters,39688,39688 density 0.30517962598425197,0.30517962598425197
before tensor 262144 mask 44382.0 262144
layer3.5.conv1.weight, mask/weight parameters,44382,44382 density 0.3412739911417323,0.3412739911417323
before tensor 589824 mask 47730.0 589824
layer3.5.conv2.weight, mask/weight parameters,47730,47730 density 0.3288073242813152,0.3288073242813152
before tensor 262144 mask 38717.0 262144
layer3.5.conv3.weight, mask/weight parameters,38717,38717 density 0.2977131520669291,0.2977131520669291
before tensor 524288 mask 133404.0 524288
layer4.0.conv1.weight, mask/weight parameters,133404,133404 density 0.563971185064935,0.563971185064935
before tensor 2359296 mask 190995.0 2359296
layer4.0.conv2.weight, mask/weight parameters,190995,190995 density 0.3976999431544886,0.3976999431544886
before tensor 1048576 mask 100391.0 1048576
layer4.0.conv3.weight, mask/weight parameters,100391,100391 density 0.21220364921536797,0.21220364921536797
layer4.0.shortcut.0.weight, mask/weight parameters,134948,134948 density 0.06434822082519531,0.06434822082519531
before tensor 1048576 mask 114744.0 1048576
layer4.1.conv1.weight, mask/weight parameters,114744,114744 density 0.24254261363636365,0.24254261363636365
before tensor 2359296 mask 188209.0 2359296
layer4.1.conv2.weight, mask/weight parameters,188209,188209 density 0.3918987858381798,0.3918987858381798
before tensor 1048576 mask 81260.0 1048576
layer4.1.conv3.weight, mask/weight parameters,81260,81260 density 0.17176508387445888,0.17176508387445888
before tensor 1048576 mask 78234.0 1048576
layer4.2.conv1.weight, mask/weight parameters,78234,78234 density 0.1653688108766234,0.1653688108766234
before tensor 2359296 mask 67527.0 2359296
layer4.2.conv2.weight, mask/weight parameters,67527,67527 density 0.14060830943947827,0.14060830943947827
before tensor 1048576 mask 34821.0 1048576
layer4.2.conv3.weight, mask/weight parameters,34821,34821 density 0.0736036424512987,0.0736036424512987
classifier.weight, mask/weight parameters,105245,105245 density 0.5138916015625,0.5138916015625
Total Model parameters after dst: 2299605 2299605
Total parameters under density level of 0.1: 0.230006869384868 0.230006869384868 after dst
Death rate: 0.10046574691814342

self.baseline_nonzero-self.total_nonzero 65598.20000000112
len(all_scores) 9997984 6718732
increse 65598.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1175,1170 density 0.6799768518518519,0.6770833333333334
before tensor 4096 mask 670.0 4096
layer1.0.conv1.weight, mask/weight parameters,670,660 density 0.22273936170212766,0.21941489361702127
before tensor 36864 mask 3659.0 36864
layer1.0.conv2.weight, mask/weight parameters,3659,3644 density 0.18404506815552538,0.1832905789447211
before tensor 16384 mask 3723.0 16384
layer1.0.conv3.weight, mask/weight parameters,3723,3708 density 0.3094248670212766,0.3081781914893617
layer1.0.shortcut.0.weight, mask/weight parameters,5625,5535 density 0.34332275390625,0.33782958984375
before tensor 16384 mask 2440.0 16384
layer1.1.conv1.weight, mask/weight parameters,2440,2396 density 0.20279255319148937,0.19913563829787234
before tensor 36864 mask 3979.0 36864
layer1.1.conv2.weight, mask/weight parameters,3979,3946 density 0.2001408379860168,0.19848096172224738
before tensor 16384 mask 2173.0 16384
layer1.1.conv3.weight, mask/weight parameters,2173,2158 density 0.18060172872340424,0.17935505319148937
before tensor 16384 mask 2859.0 16384
layer1.2.conv1.weight, mask/weight parameters,2859,2796 density 0.23761635638297873,0.23238031914893617
before tensor 36864 mask 3408.0 36864
layer1.2.conv2.weight, mask/weight parameters,3408,3397 density 0.17141994869473368,0.17086665660681052
before tensor 16384 mask 1847.0 16384
layer1.2.conv3.weight, mask/weight parameters,1847,1829 density 0.15350731382978725,0.15201130319148937
before tensor 32768 mask 5317.0 32768
layer2.0.conv1.weight, mask/weight parameters,5317,5260 density 0.2769270833333333,0.27395833333333336
before tensor 147456 mask 12484.0 147456
layer2.0.conv2.weight, mask/weight parameters,12484,12406 density 0.24659753086419753,0.2450567901234568
before tensor 65536 mask 6854.0 65536
layer2.0.conv3.weight, mask/weight parameters,6854,6807 density 0.17848958333333334,0.177265625
layer2.0.shortcut.0.weight, mask/weight parameters,29566,29288 density 0.2255706787109375,0.22344970703125
before tensor 65536 mask 3577.0 65536
layer2.1.conv1.weight, mask/weight parameters,3577,3521 density 0.09315104166666667,0.09169270833333333
before tensor 147456 mask 4163.0 147456
layer2.1.conv2.weight, mask/weight parameters,4163,4131 density 0.0822320987654321,0.0816
before tensor 65536 mask 4129.0 65536
layer2.1.conv3.weight, mask/weight parameters,4129,4110 density 0.10752604166666667,0.10703125
before tensor 65536 mask 10280.0 65536
layer2.2.conv1.weight, mask/weight parameters,10280,10222 density 0.2677083333333333,0.26619791666666665
before tensor 147456 mask 21324.0 147456
layer2.2.conv2.weight, mask/weight parameters,21324,21034 density 0.4212148148148148,0.4154864197530864
before tensor 65536 mask 13182.0 65536
layer2.2.conv3.weight, mask/weight parameters,13182,12996 density 0.34328125,0.3384375
before tensor 65536 mask 10529.0 65536
layer2.3.conv1.weight, mask/weight parameters,10529,10434 density 0.2741927083333333,0.27171875
before tensor 147456 mask 20252.0 147456
layer2.3.conv2.weight, mask/weight parameters,20252,19987 density 0.4000395061728395,0.39480493827160495
before tensor 65536 mask 10930.0 65536
layer2.3.conv3.weight, mask/weight parameters,10930,10798 density 0.28463541666666664,0.28119791666666666
before tensor 131072 mask 29457.0 131072
layer3.0.conv1.weight, mask/weight parameters,29457,29019 density 0.4530173474409449,0.44628137303149606
before tensor 589824 mask 61079.0 589824
layer3.0.conv2.weight, mask/weight parameters,61079,60423 density 0.4207672859790164,0.416248165829665
before tensor 262144 mask 57466.0 262144
layer3.0.conv3.weight, mask/weight parameters,57466,56434 density 0.4418829970472441,0.4339474655511811
layer3.0.shortcut.0.weight, mask/weight parameters,96510,94857 density 0.18407821655273438,0.1809253692626953
before tensor 262144 mask 27850.0 262144
layer3.1.conv1.weight, mask/weight parameters,27850,27230 density 0.21415169783464566,0.20938422736220472
before tensor 589824 mask 60484.0 589824
layer3.1.conv2.weight, mask/weight parameters,60484,59101 density 0.4166683888923333,0.40714103650429523
before tensor 262144 mask 52517.0 262144
layer3.1.conv3.weight, mask/weight parameters,52517,51127 density 0.40382781742125984,0.3931394562007874
before tensor 262144 mask 30285.0 262144
layer3.2.conv1.weight, mask/weight parameters,30285,29390 density 0.2328755536417323,0.22599347933070865
before tensor 589824 mask 53301.0 589824
layer3.2.conv2.weight, mask/weight parameters,53301,51980 density 0.3671854010374687,0.3580851606147657
before tensor 262144 mask 50654.0 262144
layer3.2.conv3.weight, mask/weight parameters,50654,49431 density 0.3895023375984252,0.38009811761811024
before tensor 262144 mask 33983.0 262144
layer3.3.conv1.weight, mask/weight parameters,33983,32877 density 0.2613112081692913,0.252806656003937
before tensor 589824 mask 47660.0 589824
layer3.3.conv2.weight, mask/weight parameters,47660,46581 density 0.32832510109464663,0.32089197511728357
before tensor 262144 mask 43868.0 262144
layer3.3.conv3.weight, mask/weight parameters,43868,42773 density 0.3373216043307087,0.3289016363188976
before tensor 262144 mask 39510.0 262144
layer3.4.conv1.weight, mask/weight parameters,39510,38041 density 0.30381090059055116,0.2925150713582677
before tensor 589824 mask 49525.0 589824
layer3.4.conv2.weight, mask/weight parameters,49525,47813 density 0.34117290456803134,0.32937910320265085
before tensor 262144 mask 41179.0 262144
layer3.4.conv3.weight, mask/weight parameters,41179,39688 density 0.31664462352362205,0.30517962598425197
before tensor 262144 mask 45599.0 262144
layer3.5.conv1.weight, mask/weight parameters,45599,44382 density 0.3506320743110236,0.3412739911417323
before tensor 589824 mask 48817.0 589824
layer3.5.conv2.weight, mask/weight parameters,48817,47730 density 0.33629556148001183,0.3288073242813152
before tensor 262144 mask 40023.0 262144
layer3.5.conv3.weight, mask/weight parameters,40023,38717 density 0.3077555979330709,0.2977131520669291
before tensor 524288 mask 136916.0 524288
layer4.0.conv1.weight, mask/weight parameters,136916,133404 density 0.5788183170995671,0.563971185064935
before tensor 2359296 mask 196861.0 2359296
layer4.0.conv2.weight, mask/weight parameters,196861,190995 density 0.40991444021747053,0.3976999431544886
before tensor 1048576 mask 104664.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104664,100391 density 0.22123579545454544,0.21220364921536797
layer4.0.shortcut.0.weight, mask/weight parameters,139874,134948 density 0.0666971206665039,0.06434822082519531
before tensor 1048576 mask 120301.0 1048576
layer4.1.conv1.weight, mask/weight parameters,120301,114744 density 0.2542888426677489,0.24254261363636365
before tensor 2359296 mask 194890.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194890,188209 density 0.40581031923023264,0.3918987858381798
before tensor 1048576 mask 84046.0 1048576
layer4.1.conv3.weight, mask/weight parameters,84046,81260 density 0.17765405167748918,0.17176508387445888
before tensor 1048576 mask 82476.0 1048576
layer4.2.conv1.weight, mask/weight parameters,82476,78234 density 0.17433543019480519,0.1653688108766234
before tensor 2359296 mask 70009.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70009,67527 density 0.14577646179377782,0.14060830943947827
before tensor 1048576 mask 35748.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35748,34821 density 0.07556310876623376,0.0736036424512987
classifier.weight, mask/weight parameters,105505,105245 density 0.5151611328125,0.5138916015625
Total Model parameters after dst: 2365202 2299605
Total parameters under density level of 0.1: 0.23656789208704473 0.230006869384868 after dst
Death rate: 0.10046574691814342


Training summary: Average loss: 0.0635, Accuracy: 49384/50000 (98.768%)


Evaluation: Average loss: 0.9709, Accuracy: 7661/10000 (76.610%)

Current learning rate: 0.001. Time taken for epoch: 88.72 seconds.

Train Epoch: 138 [0/50000 (0%)]	Loss: 0.067486 Accuracy: 99/100 (99.000%
Train Epoch: 138 [10000/50000 (20%)]	Loss: 0.069765 Accuracy: 9974/10100 (98.752%
Train Epoch: 138 [20000/50000 (40%)]	Loss: 0.039270 Accuracy: 19872/20100 (98.866%
Train Epoch: 138 [30000/50000 (60%)]	Loss: 0.071712 Accuracy: 29784/30100 (98.950%
Train Epoch: 138 [40000/50000 (80%)]	Loss: 0.069765 Accuracy: 39673/40100 (98.935%

Training summary: Average loss: 0.0604, Accuracy: 49456/50000 (98.912%)


Evaluation: Average loss: 0.9684, Accuracy: 7630/10000 (76.300%)

Current learning rate: 0.001. Time taken for epoch: 88.35 seconds.

Train Epoch: 139 [0/50000 (0%)]	Loss: 0.082847 Accuracy: 100/100 (100.000%
Train Epoch: 139 [10000/50000 (20%)]	Loss: 0.058625 Accuracy: 10005/10100 (99.059%
Train Epoch: 139 [20000/50000 (40%)]	Loss: 0.037769 Accuracy: 19906/20100 (99.035%
Train Epoch: 139 [30000/50000 (60%)]	Loss: 0.065581 Accuracy: 29804/30100 (99.017%
Train Epoch: 139 [40000/50000 (80%)]	Loss: 0.103768 Accuracy: 39685/40100 (98.965%
current dst rate 0.023839815703455104


dynamic sparse change
conv1.weight, mask/weight parameters,1171,1171 density 0.6776620370370371,0.6776620370370371
before tensor 4096 mask 663.0 4096
layer1.0.conv1.weight, mask/weight parameters,663,663 density 0.2204122340425532,0.2204122340425532
before tensor 36864 mask 3643.0 36864
layer1.0.conv2.weight, mask/weight parameters,3643,3643 density 0.1832402796640008,0.1832402796640008
before tensor 16384 mask 3706.0 16384
layer1.0.conv3.weight, mask/weight parameters,3706,3706 density 0.3080119680851064,0.3080119680851064
layer1.0.shortcut.0.weight, mask/weight parameters,5530,5530 density 0.3375244140625,0.3375244140625
before tensor 16384 mask 2399.0 16384
layer1.1.conv1.weight, mask/weight parameters,2399,2399 density 0.19938497340425532,0.19938497340425532
before tensor 36864 mask 3949.0 36864
layer1.1.conv2.weight, mask/weight parameters,3949,3949 density 0.19863185956440824,0.19863185956440824
before tensor 16384 mask 2160.0 16384
layer1.1.conv3.weight, mask/weight parameters,2160,2160 density 0.17952127659574468,0.17952127659574468
before tensor 16384 mask 2811.0 16384
layer1.2.conv1.weight, mask/weight parameters,2811,2811 density 0.23362699468085107,0.23362699468085107
before tensor 36864 mask 3394.0 36864
layer1.2.conv2.weight, mask/weight parameters,3394,3394 density 0.17071575876464967,0.17071575876464967
before tensor 16384 mask 1825.0 16384
layer1.2.conv3.weight, mask/weight parameters,1825,1825 density 0.15167885638297873,0.15167885638297873
before tensor 32768 mask 5258.0 32768
layer2.0.conv1.weight, mask/weight parameters,5258,5258 density 0.2738541666666667,0.2738541666666667
before tensor 147456 mask 12402.0 147456
layer2.0.conv2.weight, mask/weight parameters,12402,12402 density 0.24497777777777777,0.24497777777777777
before tensor 65536 mask 6812.0 65536
layer2.0.conv3.weight, mask/weight parameters,6812,6812 density 0.17739583333333334,0.17739583333333334
layer2.0.shortcut.0.weight, mask/weight parameters,29279,29279 density 0.22338104248046875,0.22338104248046875
before tensor 65536 mask 3534.0 65536
layer2.1.conv1.weight, mask/weight parameters,3534,3534 density 0.09203125,0.09203125
before tensor 147456 mask 4121.0 147456
layer2.1.conv2.weight, mask/weight parameters,4121,4121 density 0.08140246913580247,0.08140246913580247
before tensor 65536 mask 4105.0 65536
layer2.1.conv3.weight, mask/weight parameters,4105,4105 density 0.10690104166666667,0.10690104166666667
before tensor 65536 mask 10216.0 65536
layer2.2.conv1.weight, mask/weight parameters,10216,10216 density 0.2660416666666667,0.2660416666666667
before tensor 147456 mask 21057.0 147456
layer2.2.conv2.weight, mask/weight parameters,21057,21057 density 0.4159407407407407,0.4159407407407407
before tensor 65536 mask 13032.0 65536
layer2.2.conv3.weight, mask/weight parameters,13032,13032 density 0.339375,0.339375
before tensor 65536 mask 10437.0 65536
layer2.3.conv1.weight, mask/weight parameters,10437,10437 density 0.271796875,0.271796875
before tensor 147456 mask 20033.0 147456
layer2.3.conv2.weight, mask/weight parameters,20033,20033 density 0.39571358024691355,0.39571358024691355
before tensor 65536 mask 10818.0 65536
layer2.3.conv3.weight, mask/weight parameters,10818,10818 density 0.28171875,0.28171875
before tensor 131072 mask 29045.0 131072
layer3.0.conv1.weight, mask/weight parameters,29045,29045 density 0.4466812253937008,0.4466812253937008
before tensor 589824 mask 60441.0 589824
layer3.0.conv2.weight, mask/weight parameters,60441,60441 density 0.4163721660776655,0.4163721660776655
before tensor 262144 mask 56592.0 262144
layer3.0.conv3.weight, mask/weight parameters,56592,56592 density 0.4351624015748031,0.4351624015748031
layer3.0.shortcut.0.weight, mask/weight parameters,94975,94975 density 0.1811504364013672,0.1811504364013672
before tensor 262144 mask 27275.0 262144
layer3.1.conv1.weight, mask/weight parameters,27275,27275 density 0.2097302534448819,0.2097302534448819
before tensor 589824 mask 59165.0 589824
layer3.1.conv2.weight, mask/weight parameters,59165,59165 density 0.40758192627496365,0.40758192627496365
before tensor 262144 mask 51380.0 262144
layer3.1.conv3.weight, mask/weight parameters,51380,51380 density 0.39508489173228345,0.39508489173228345
before tensor 262144 mask 29509.0 262144
layer3.2.conv1.weight, mask/weight parameters,29509,29509 density 0.22690852608267717,0.22690852608267717
before tensor 589824 mask 52181.0 589824
layer3.2.conv2.weight, mask/weight parameters,52181,52181 density 0.3594698300507712,0.3594698300507712
before tensor 262144 mask 49633.0 262144
layer3.2.conv3.weight, mask/weight parameters,49633,49633 density 0.3816513902559055,0.3816513902559055
before tensor 262144 mask 33020.0 262144
layer3.3.conv1.weight, mask/weight parameters,33020,33020 density 0.25390625,0.25390625
before tensor 589824 mask 46755.0 589824
layer3.3.conv2.weight, mask/weight parameters,46755,46755 density 0.32209064418128835,0.32209064418128835
before tensor 262144 mask 42967.0 262144
layer3.3.conv3.weight, mask/weight parameters,42967,42967 density 0.3303933932086614,0.3303933932086614
before tensor 262144 mask 38257.0 262144
layer3.4.conv1.weight, mask/weight parameters,38257,38257 density 0.2941759965551181,0.2941759965551181
before tensor 589824 mask 48183.0 589824
layer3.4.conv2.weight, mask/weight parameters,48183,48183 density 0.3319279971893277,0.3319279971893277
before tensor 262144 mask 40051.0 262144
layer3.4.conv3.weight, mask/weight parameters,40051,40051 density 0.3079709030511811,0.3079709030511811
before tensor 262144 mask 44528.0 262144
layer3.5.conv1.weight, mask/weight parameters,44528,44528 density 0.34239665354330706,0.34239665354330706
before tensor 589824 mask 47889.0 589824
layer3.5.conv2.weight, mask/weight parameters,47889,47889 density 0.32990265980531963,0.32990265980531963
before tensor 262144 mask 38966.0 262144
layer3.5.conv3.weight, mask/weight parameters,38966,38966 density 0.29962782972440943,0.29962782972440943
before tensor 524288 mask 134027.0 524288
layer4.0.conv1.weight, mask/weight parameters,134027,134027 density 0.5666049445346321,0.5666049445346321
before tensor 2359296 mask 191939.0 2359296
layer4.0.conv2.weight, mask/weight parameters,191939,191939 density 0.3996655901417806,0.3996655901417806
before tensor 1048576 mask 100990.0 1048576
layer4.0.conv3.weight, mask/weight parameters,100990,100990 density 0.21346979843073594,0.21346979843073594
layer4.0.shortcut.0.weight, mask/weight parameters,135254,135254 density 0.06449413299560547,0.06449413299560547
before tensor 1048576 mask 115615.0 1048576
layer4.1.conv1.weight, mask/weight parameters,115615,115615 density 0.2443837087391775,0.2443837087391775
before tensor 2359296 mask 189384.0 2359296
layer4.1.conv2.weight, mask/weight parameters,189384,189384 density 0.39434543330647226,0.39434543330647226
before tensor 1048576 mask 81598.0 1048576
layer4.1.conv3.weight, mask/weight parameters,81598,81598 density 0.1724795386904762,0.1724795386904762
before tensor 1048576 mask 78719.0 1048576
layer4.2.conv1.weight, mask/weight parameters,78719,78719 density 0.16639399012445888,0.16639399012445888
before tensor 2359296 mask 67832.0 2359296
layer4.2.conv2.weight, mask/weight parameters,67832,67832 density 0.14124339665465208,0.14124339665465208
before tensor 1048576 mask 35038.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35038,35038 density 0.0740623308982684,0.0740623308982684
classifier.weight, mask/weight parameters,105254,105254 density 0.513935546875,0.513935546875
Total Model parameters after dst: 2308817 2308817
Total parameters under density level of 0.1: 0.23092825513623547 0.23092825513623547 after dst
Death rate: 0.10072645467607245

self.baseline_nonzero-self.total_nonzero 56386.20000000112
len(all_scores) 9997984 6709404
increse 56387.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1174,1171 density 0.6793981481481481,0.6776620370370371
before tensor 4096 mask 663.0 4096
layer1.0.conv1.weight, mask/weight parameters,663,663 density 0.2204122340425532,0.2204122340425532
before tensor 36864 mask 3695.0 36864
layer1.0.conv2.weight, mask/weight parameters,3695,3643 density 0.18585584226145566,0.1832402796640008
before tensor 16384 mask 3737.0 16384
layer1.0.conv3.weight, mask/weight parameters,3737,3706 density 0.31058843085106386,0.3080119680851064
layer1.0.shortcut.0.weight, mask/weight parameters,5587,5530 density 0.34100341796875,0.3375244140625
before tensor 16384 mask 2405.0 16384
layer1.1.conv1.weight, mask/weight parameters,2405,2399 density 0.19988364361702127,0.19938497340425532
before tensor 36864 mask 3966.0 36864
layer1.1.conv2.weight, mask/weight parameters,3966,3949 density 0.1994869473366531,0.19863185956440824
before tensor 16384 mask 2183.0 16384
layer1.1.conv3.weight, mask/weight parameters,2183,2160 density 0.18143284574468085,0.17952127659574468
before tensor 16384 mask 2840.0 16384
layer1.2.conv1.weight, mask/weight parameters,2840,2811 density 0.2360372340425532,0.23362699468085107
before tensor 36864 mask 3476.0 36864
layer1.2.conv2.weight, mask/weight parameters,3476,3394 density 0.1748402997837131,0.17071575876464967
before tensor 16384 mask 1863.0 16384
layer1.2.conv3.weight, mask/weight parameters,1863,1825 density 0.15483710106382978,0.15167885638297873
before tensor 32768 mask 5280.0 32768
layer2.0.conv1.weight, mask/weight parameters,5280,5258 density 0.275,0.2738541666666667
before tensor 147456 mask 12470.0 147456
layer2.0.conv2.weight, mask/weight parameters,12470,12402 density 0.24632098765432098,0.24497777777777777
before tensor 65536 mask 6879.0 65536
layer2.0.conv3.weight, mask/weight parameters,6879,6812 density 0.179140625,0.17739583333333334
layer2.0.shortcut.0.weight, mask/weight parameters,29605,29279 density 0.22586822509765625,0.22338104248046875
before tensor 65536 mask 3640.0 65536
layer2.1.conv1.weight, mask/weight parameters,3640,3534 density 0.09479166666666666,0.09203125
before tensor 147456 mask 4170.0 147456
layer2.1.conv2.weight, mask/weight parameters,4170,4121 density 0.08237037037037037,0.08140246913580247
before tensor 65536 mask 4152.0 65536
layer2.1.conv3.weight, mask/weight parameters,4152,4105 density 0.108125,0.10690104166666667
before tensor 65536 mask 10301.0 65536
layer2.2.conv1.weight, mask/weight parameters,10301,10216 density 0.26825520833333333,0.2660416666666667
before tensor 147456 mask 21289.0 147456
layer2.2.conv2.weight, mask/weight parameters,21289,21057 density 0.4205234567901235,0.4159407407407407
before tensor 65536 mask 13240.0 65536
layer2.2.conv3.weight, mask/weight parameters,13240,13032 density 0.34479166666666666,0.339375
before tensor 65536 mask 10675.0 65536
layer2.3.conv1.weight, mask/weight parameters,10675,10437 density 0.2779947916666667,0.271796875
before tensor 147456 mask 20351.0 147456
layer2.3.conv2.weight, mask/weight parameters,20351,20033 density 0.40199506172839505,0.39571358024691355
before tensor 65536 mask 10965.0 65536
layer2.3.conv3.weight, mask/weight parameters,10965,10818 density 0.285546875,0.28171875
before tensor 131072 mask 29625.0 131072
layer3.0.conv1.weight, mask/weight parameters,29625,29045 density 0.4556010088582677,0.4466812253937008
before tensor 589824 mask 61586.0 589824
layer3.0.conv2.weight, mask/weight parameters,61586,60441 density 0.42425995963103036,0.4163721660776655
before tensor 262144 mask 57847.0 262144
layer3.0.conv3.weight, mask/weight parameters,57847,56592 density 0.4448126845472441,0.4351624015748031
layer3.0.shortcut.0.weight, mask/weight parameters,96379,94975 density 0.18382835388183594,0.1811504364013672
before tensor 262144 mask 27921.0 262144
layer3.1.conv1.weight, mask/weight parameters,27921,27275 density 0.2146976500984252,0.2097302534448819
before tensor 589824 mask 60806.0 589824
layer3.1.conv2.weight, mask/weight parameters,60806,59165 density 0.41888661555100887,0.40758192627496365
before tensor 262144 mask 52833.0 262144
layer3.1.conv3.weight, mask/weight parameters,52833,51380 density 0.40625768946850394,0.39508489173228345
before tensor 262144 mask 30403.0 262144
layer3.2.conv1.weight, mask/weight parameters,30403,29509 density 0.23378291092519685,0.22690852608267717
before tensor 589824 mask 53704.0 589824
layer3.2.conv2.weight, mask/weight parameters,53704,52181 density 0.3699616288121465,0.3594698300507712
before tensor 262144 mask 50969.0 262144
layer3.2.conv3.weight, mask/weight parameters,50969,49633 density 0.39192452017716534,0.3816513902559055
before tensor 262144 mask 34242.0 262144
layer3.3.conv1.weight, mask/weight parameters,34242,33020 density 0.263302780511811,0.25390625
before tensor 589824 mask 48396.0 589824
layer3.3.conv2.weight, mask/weight parameters,48396,46755 density 0.3333953334573336,0.32209064418128835
before tensor 262144 mask 43966.0 262144
layer3.3.conv3.weight, mask/weight parameters,43966,42967 density 0.3380751722440945,0.3303933932086614
before tensor 262144 mask 39234.0 262144
layer3.4.conv1.weight, mask/weight parameters,39234,38257 density 0.3016886072834646,0.2941759965551181
before tensor 589824 mask 49339.0 589824
layer3.4.conv2.weight, mask/weight parameters,49339,48183 density 0.33989156867202625,0.3319279971893277
before tensor 262144 mask 41141.0 262144
layer3.4.conv3.weight, mask/weight parameters,41141,40051 density 0.31635242372047245,0.3079709030511811
before tensor 262144 mask 46031.0 262144
layer3.5.conv1.weight, mask/weight parameters,46031,44528 density 0.3539539247047244,0.34239665354330706
before tensor 589824 mask 49166.0 589824
layer3.5.conv2.weight, mask/weight parameters,49166,47889 density 0.33869978851068816,0.32990265980531963
before tensor 262144 mask 39864.0 262144
layer3.5.conv3.weight, mask/weight parameters,39864,38966 density 0.3065329724409449,0.29962782972440943
before tensor 524288 mask 137344.0 524288
layer4.0.conv1.weight, mask/weight parameters,137344,134027 density 0.5806277056277056,0.5666049445346321
before tensor 2359296 mask 197659.0 2359296
layer4.0.conv2.weight, mask/weight parameters,197659,191939 density 0.4115760782427449,0.3996655901417806
before tensor 1048576 mask 104133.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104133,100990 density 0.22011338271103897,0.21346979843073594
layer4.0.shortcut.0.weight, mask/weight parameters,137297,135254 density 0.06546831130981445,0.06449413299560547
before tensor 1048576 mask 119216.0 1048576
layer4.1.conv1.weight, mask/weight parameters,119216,115615 density 0.2519954004329004,0.2443837087391775
before tensor 2359296 mask 194666.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194666,189384 density 0.4053438945213837,0.39434543330647226
before tensor 1048576 mask 83764.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83764,81598 density 0.17705796807359309,0.1724795386904762
before tensor 1048576 mask 81709.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81709,78719 density 0.1727141673430736,0.16639399012445888
before tensor 2359296 mask 69948.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69948,67832 density 0.14564944435074306,0.14124339665465208
before tensor 1048576 mask 35863.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35863,35038 density 0.07580619250541125,0.0740623308982684
classifier.weight, mask/weight parameters,105545,105254 density 0.5153564453125,0.513935546875
Total Model parameters after dst: 2365202 2308817
Total parameters under density level of 0.1: 0.23656789208704473 0.23092825513623547 after dst
Death rate: 0.10072645467607245


Training summary: Average loss: 0.0593, Accuracy: 49462/50000 (98.924%)


Evaluation: Average loss: 0.9735, Accuracy: 7625/10000 (76.250%)

Current learning rate: 0.001. Time taken for epoch: 88.74 seconds.

Train Epoch: 140 [0/50000 (0%)]	Loss: 0.048532 Accuracy: 99/100 (99.000%
Train Epoch: 140 [10000/50000 (20%)]	Loss: 0.071225 Accuracy: 9999/10100 (99.000%
Train Epoch: 140 [20000/50000 (40%)]	Loss: 0.072985 Accuracy: 19883/20100 (98.920%
Train Epoch: 140 [30000/50000 (60%)]	Loss: 0.068904 Accuracy: 29775/30100 (98.920%
Train Epoch: 140 [40000/50000 (80%)]	Loss: 0.079594 Accuracy: 39655/40100 (98.890%

Training summary: Average loss: 0.0576, Accuracy: 49467/50000 (98.934%)


Evaluation: Average loss: 0.9743, Accuracy: 7616/10000 (76.160%)

Current learning rate: 0.001. Time taken for epoch: 88.35 seconds.

Train Epoch: 141 [0/50000 (0%)]	Loss: 0.044591 Accuracy: 100/100 (100.000%
Train Epoch: 141 [10000/50000 (20%)]	Loss: 0.045957 Accuracy: 10008/10100 (99.089%
Train Epoch: 141 [20000/50000 (40%)]	Loss: 0.047274 Accuracy: 19905/20100 (99.030%
Train Epoch: 141 [30000/50000 (60%)]	Loss: 0.052653 Accuracy: 29814/30100 (99.050%
Train Epoch: 141 [40000/50000 (80%)]	Loss: 0.051795 Accuracy: 39738/40100 (99.097%
current dst rate 0.020297644359183947


dynamic sparse change
conv1.weight, mask/weight parameters,1166,1166 density 0.6747685185185185,0.6747685185185185
before tensor 4096 mask 659.0 4096
layer1.0.conv1.weight, mask/weight parameters,659,659 density 0.21908244680851063,0.21908244680851063
before tensor 36864 mask 3656.0 36864
layer1.0.conv2.weight, mask/weight parameters,3656,3656 density 0.18389417031336452,0.18389417031336452
before tensor 16384 mask 3705.0 16384
layer1.0.conv3.weight, mask/weight parameters,3705,3705 density 0.30792885638297873,0.30792885638297873
layer1.0.shortcut.0.weight, mask/weight parameters,5537,5537 density 0.33795166015625,0.33795166015625
before tensor 16384 mask 2389.0 16384
layer1.1.conv1.weight, mask/weight parameters,2389,2389 density 0.19855385638297873,0.19855385638297873
before tensor 36864 mask 3952.0 36864
layer1.1.conv2.weight, mask/weight parameters,3952,3952 density 0.1987827574065691,0.1987827574065691
before tensor 16384 mask 2165.0 16384
layer1.1.conv3.weight, mask/weight parameters,2165,2165 density 0.17993683510638298,0.17993683510638298
before tensor 16384 mask 2797.0 16384
layer1.2.conv1.weight, mask/weight parameters,2797,2797 density 0.23246343085106383,0.23246343085106383
before tensor 36864 mask 3423.0 36864
layer1.2.conv2.weight, mask/weight parameters,3423,3423 density 0.17217443790553796,0.17217443790553796
before tensor 16384 mask 1835.0 16384
layer1.2.conv3.weight, mask/weight parameters,1835,1835 density 0.15250997340425532,0.15250997340425532
before tensor 32768 mask 5248.0 32768
layer2.0.conv1.weight, mask/weight parameters,5248,5248 density 0.2733333333333333,0.2733333333333333
before tensor 147456 mask 12390.0 147456
layer2.0.conv2.weight, mask/weight parameters,12390,12390 density 0.24474074074074073,0.24474074074074073
before tensor 65536 mask 6827.0 65536
layer2.0.conv3.weight, mask/weight parameters,6827,6827 density 0.17778645833333334,0.17778645833333334
layer2.0.shortcut.0.weight, mask/weight parameters,29335,29335 density 0.22380828857421875,0.22380828857421875
before tensor 65536 mask 3560.0 65536
layer2.1.conv1.weight, mask/weight parameters,3560,3560 density 0.09270833333333334,0.09270833333333334
before tensor 147456 mask 4130.0 147456
layer2.1.conv2.weight, mask/weight parameters,4130,4130 density 0.08158024691358025,0.08158024691358025
before tensor 65536 mask 4119.0 65536
layer2.1.conv3.weight, mask/weight parameters,4119,4119 density 0.107265625,0.107265625
before tensor 65536 mask 10242.0 65536
layer2.2.conv1.weight, mask/weight parameters,10242,10242 density 0.26671875,0.26671875
before tensor 147456 mask 21068.0 147456
layer2.2.conv2.weight, mask/weight parameters,21068,21068 density 0.41615802469135804,0.41615802469135804
before tensor 65536 mask 13069.0 65536
layer2.2.conv3.weight, mask/weight parameters,13069,13069 density 0.34033854166666666,0.34033854166666666
before tensor 65536 mask 10489.0 65536
layer2.3.conv1.weight, mask/weight parameters,10489,10489 density 0.27315104166666665,0.27315104166666665
before tensor 147456 mask 20088.0 147456
layer2.3.conv2.weight, mask/weight parameters,20088,20088 density 0.3968,0.3968
before tensor 65536 mask 10847.0 65536
layer2.3.conv3.weight, mask/weight parameters,10847,10847 density 0.28247395833333333,0.28247395833333333
before tensor 131072 mask 29166.0 131072
layer3.0.conv1.weight, mask/weight parameters,29166,29166 density 0.44854207677165353,0.44854207677165353
before tensor 589824 mask 60681.0 589824
layer3.0.conv2.weight, mask/weight parameters,60681,60681 density 0.4180255027176721,0.4180255027176721
before tensor 262144 mask 56848.0 262144
layer3.0.conv3.weight, mask/weight parameters,56848,56848 density 0.437130905511811,0.437130905511811
layer3.0.shortcut.0.weight, mask/weight parameters,95107,95107 density 0.18140220642089844,0.18140220642089844
before tensor 262144 mask 27348.0 262144
layer3.1.conv1.weight, mask/weight parameters,27348,27348 density 0.2102915846456693,0.2102915846456693
before tensor 589824 mask 59422.0 589824
layer3.1.conv2.weight, mask/weight parameters,59422,59422 density 0.4093523742603041,0.4093523742603041
before tensor 262144 mask 51672.0 262144
layer3.1.conv3.weight, mask/weight parameters,51672,51672 density 0.39733021653543305,0.39733021653543305
before tensor 262144 mask 29689.0 262144
layer3.2.conv1.weight, mask/weight parameters,29689,29689 density 0.22829263041338582,0.22829263041338582
before tensor 589824 mask 52482.0 589824
layer3.2.conv2.weight, mask/weight parameters,52482,52482 density 0.3615433897534462,0.3615433897534462
before tensor 262144 mask 49905.0 262144
layer3.2.conv3.weight, mask/weight parameters,49905,49905 density 0.3837429256889764,0.3837429256889764
before tensor 262144 mask 33266.0 262144
layer3.3.conv1.weight, mask/weight parameters,33266,33266 density 0.2557978592519685,0.2557978592519685
before tensor 589824 mask 47120.0 589824
layer3.3.conv2.weight, mask/weight parameters,47120,47120 density 0.32460509365463175,0.32460509365463175
before tensor 262144 mask 43116.0 262144
layer3.3.conv3.weight, mask/weight parameters,43116,43116 density 0.33153912401574803,0.33153912401574803
before tensor 262144 mask 38329.0 262144
layer3.4.conv1.weight, mask/weight parameters,38329,38329 density 0.29472963828740156,0.29472963828740156
before tensor 589824 mask 48336.0 589824
layer3.4.conv2.weight, mask/weight parameters,48336,48336 density 0.3329819992973319,0.3329819992973319
before tensor 262144 mask 40251.0 262144
layer3.4.conv3.weight, mask/weight parameters,40251,40251 density 0.3095087967519685,0.3095087967519685
before tensor 262144 mask 44784.0 262144
layer3.5.conv1.weight, mask/weight parameters,44784,44784 density 0.344365157480315,0.344365157480315
before tensor 589824 mask 48131.0 589824
layer3.5.conv2.weight, mask/weight parameters,48131,48131 density 0.3315697742506596,0.3315697742506596
before tensor 262144 mask 39114.0 262144
layer3.5.conv3.weight, mask/weight parameters,39114,39114 density 0.30076587106299213,0.30076587106299213
before tensor 524288 mask 134623.0 524288
layer4.0.conv1.weight, mask/weight parameters,134623,134623 density 0.5691245603354979,0.5691245603354979
before tensor 2359296 mask 192854.0 2359296
layer4.0.conv2.weight, mask/weight parameters,192854,192854 density 0.401570851787302,0.401570851787302
before tensor 1048576 mask 101397.0 1048576
layer4.0.conv3.weight, mask/weight parameters,101397,101397 density 0.21433010349025974,0.21433010349025974
layer4.0.shortcut.0.weight, mask/weight parameters,135350,135350 density 0.06453990936279297,0.06453990936279297
before tensor 1048576 mask 116034.0 1048576
layer4.1.conv1.weight, mask/weight parameters,116034,116034 density 0.24526937905844157,0.24526937905844157
before tensor 2359296 mask 190012.0 2359296
layer4.1.conv2.weight, mask/weight parameters,190012,190012 density 0.39565308829378093,0.39565308829378093
before tensor 1048576 mask 81825.0 1048576
layer4.1.conv3.weight, mask/weight parameters,81825,81825 density 0.1729593648538961,0.1729593648538961
before tensor 1048576 mask 79083.0 1048576
layer4.2.conv1.weight, mask/weight parameters,79083,79083 density 0.16716340300324675,0.16716340300324675
before tensor 2359296 mask 68079.0 2359296
layer4.2.conv2.weight, mask/weight parameters,68079,68079 density 0.1417577131862846,0.1417577131862846
before tensor 1048576 mask 35215.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35215,35215 density 0.07443646847943723,0.07443646847943723
classifier.weight, mask/weight parameters,105259,105259 density 0.5139599609375,0.5139599609375
Total Model parameters after dst: 2317194 2317194
Total parameters under density level of 0.1: 0.2317661240506086 0.2317661240506086 after dst
Death rate: 0.10104385443280847

self.baseline_nonzero-self.total_nonzero 48009.20000000112
len(all_scores) 9997984 6701143
increse 48009.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1174,1166 density 0.6793981481481481,0.6747685185185185
before tensor 4096 mask 666.0 4096
layer1.0.conv1.weight, mask/weight parameters,666,659 density 0.2214095744680851,0.21908244680851063
before tensor 36864 mask 3671.0 36864
layer1.0.conv2.weight, mask/weight parameters,3671,3656 density 0.1846486595241688,0.18389417031336452
before tensor 16384 mask 3738.0 16384
layer1.0.conv3.weight, mask/weight parameters,3738,3705 density 0.3106715425531915,0.30792885638297873
layer1.0.shortcut.0.weight, mask/weight parameters,5603,5537 density 0.34197998046875,0.33795166015625
before tensor 16384 mask 2410.0 16384
layer1.1.conv1.weight, mask/weight parameters,2410,2389 density 0.2002992021276596,0.19855385638297873
before tensor 36864 mask 3966.0 36864
layer1.1.conv2.weight, mask/weight parameters,3966,3952 density 0.1994869473366531,0.1987827574065691
before tensor 16384 mask 2186.0 16384
layer1.1.conv3.weight, mask/weight parameters,2186,2165 density 0.18168218085106383,0.17993683510638298
before tensor 16384 mask 2841.0 16384
layer1.2.conv1.weight, mask/weight parameters,2841,2797 density 0.23612034574468085,0.23246343085106383
before tensor 36864 mask 3465.0 36864
layer1.2.conv2.weight, mask/weight parameters,3465,3423 density 0.17428700769578995,0.17217443790553796
before tensor 16384 mask 1867.0 16384
layer1.2.conv3.weight, mask/weight parameters,1867,1835 density 0.1551695478723404,0.15250997340425532
before tensor 32768 mask 5383.0 32768
layer2.0.conv1.weight, mask/weight parameters,5383,5248 density 0.2803645833333333,0.2733333333333333
before tensor 147456 mask 12468.0 147456
layer2.0.conv2.weight, mask/weight parameters,12468,12390 density 0.2462814814814815,0.24474074074074073
before tensor 65536 mask 6872.0 65536
layer2.0.conv3.weight, mask/weight parameters,6872,6827 density 0.17895833333333333,0.17778645833333334
layer2.0.shortcut.0.weight, mask/weight parameters,29656,29335 density 0.22625732421875,0.22380828857421875
before tensor 65536 mask 3571.0 65536
layer2.1.conv1.weight, mask/weight parameters,3571,3560 density 0.09299479166666667,0.09270833333333334
before tensor 147456 mask 4182.0 147456
layer2.1.conv2.weight, mask/weight parameters,4182,4130 density 0.08260740740740741,0.08158024691358025
before tensor 65536 mask 4171.0 65536
layer2.1.conv3.weight, mask/weight parameters,4171,4119 density 0.10861979166666667,0.107265625
before tensor 65536 mask 10308.0 65536
layer2.2.conv1.weight, mask/weight parameters,10308,10242 density 0.2684375,0.26671875
before tensor 147456 mask 21275.0 147456
layer2.2.conv2.weight, mask/weight parameters,21275,21068 density 0.4202469135802469,0.41615802469135804
before tensor 65536 mask 13166.0 65536
layer2.2.conv3.weight, mask/weight parameters,13166,13069 density 0.3428645833333333,0.34033854166666666
before tensor 65536 mask 10563.0 65536
layer2.3.conv1.weight, mask/weight parameters,10563,10489 density 0.275078125,0.27315104166666665
before tensor 147456 mask 20263.0 147456
layer2.3.conv2.weight, mask/weight parameters,20263,20088 density 0.4002567901234568,0.3968
before tensor 65536 mask 10919.0 65536
layer2.3.conv3.weight, mask/weight parameters,10919,10847 density 0.28434895833333335,0.28247395833333333
before tensor 131072 mask 29589.0 131072
layer3.0.conv1.weight, mask/weight parameters,29589,29166 density 0.45504736712598426,0.44854207677165353
before tensor 589824 mask 61174.0 589824
layer3.0.conv2.weight, mask/weight parameters,61174,60681 density 0.42142173173235237,0.4180255027176721
before tensor 262144 mask 57655.0 262144
layer3.0.conv3.weight, mask/weight parameters,57655,56848 density 0.4433363065944882,0.437130905511811
layer3.0.shortcut.0.weight, mask/weight parameters,96361,95107 density 0.1837940216064453,0.18140220642089844
before tensor 262144 mask 27741.0 262144
layer3.1.conv1.weight, mask/weight parameters,27741,27348 density 0.21331354576771652,0.2102915846456693
before tensor 589824 mask 60959.0 589824
layer3.1.conv2.weight, mask/weight parameters,60959,59422 density 0.4199406176590131,0.4093523742603041
before tensor 262144 mask 53068.0 262144
layer3.1.conv3.weight, mask/weight parameters,53068,51672 density 0.4080647145669291,0.39733021653543305
before tensor 262144 mask 30215.0 262144
layer3.2.conv1.weight, mask/weight parameters,30215,29689 density 0.23233729084645668,0.22829263041338582
before tensor 589824 mask 53338.0 589824
layer3.2.conv2.weight, mask/weight parameters,53338,52482 density 0.3674402904361364,0.3615433897534462
before tensor 262144 mask 50834.0 262144
layer3.2.conv3.weight, mask/weight parameters,50834,49905 density 0.39088644192913385,0.3837429256889764
before tensor 262144 mask 33975.0 262144
layer3.3.conv1.weight, mask/weight parameters,33975,33266 density 0.26124969242125984,0.2557978592519685
before tensor 589824 mask 47889.0 589824
layer3.3.conv2.weight, mask/weight parameters,47889,47120 density 0.32990265980531963,0.32460509365463175
before tensor 262144 mask 43985.0 262144
layer3.3.conv3.weight, mask/weight parameters,43985,43116 density 0.33822127214566927,0.33153912401574803
before tensor 262144 mask 39434.0 262144
layer3.4.conv1.weight, mask/weight parameters,39434,38329 density 0.30322650098425197,0.29472963828740156
before tensor 589824 mask 49501.0 589824
layer3.4.conv2.weight, mask/weight parameters,49501,48336 density 0.3410075709040307,0.3329819992973319
before tensor 262144 mask 41154.0 262144
layer3.4.conv3.weight, mask/weight parameters,41154,40251 density 0.3164523868110236,0.3095087967519685
before tensor 262144 mask 46217.0 262144
layer3.5.conv1.weight, mask/weight parameters,46217,44784 density 0.3553841658464567,0.344365157480315
before tensor 589824 mask 49482.0 589824
layer3.5.conv2.weight, mask/weight parameters,49482,48131 density 0.3408766817533635,0.3315697742506596
before tensor 262144 mask 39812.0 262144
layer3.5.conv3.weight, mask/weight parameters,39812,39114 density 0.30613312007874016,0.30076587106299213
before tensor 524288 mask 137304.0 524288
layer4.0.conv1.weight, mask/weight parameters,137304,134623 density 0.5804586038961039,0.5691245603354979
before tensor 2359296 mask 197396.0 2359296
layer4.0.conv2.weight, mask/weight parameters,197396,192854 density 0.4110284456604803,0.401570851787302
before tensor 1048576 mask 103677.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103677,101397 density 0.2191495028409091,0.21433010349025974
layer4.0.shortcut.0.weight, mask/weight parameters,137453,135350 density 0.06554269790649414,0.06453990936279297
before tensor 1048576 mask 119290.0 1048576
layer4.1.conv1.weight, mask/weight parameters,119290,116034 density 0.25215181953463206,0.24526937905844157
before tensor 2359296 mask 195814.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195814,190012 density 0.4077343211542346,0.39565308829378093
before tensor 1048576 mask 83861.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83861,81825 density 0.17726300392316016,0.1729593648538961
before tensor 1048576 mask 82225.0 1048576
layer4.2.conv1.weight, mask/weight parameters,82225,79083 density 0.17380487351190477,0.16716340300324675
before tensor 2359296 mask 70396.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70396,68079 density 0.14658229376844095,0.1417577131862846
before tensor 1048576 mask 35673.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35673,35215 density 0.07540457589285714,0.07443646847943723
classifier.weight, mask/weight parameters,105346,105259 density 0.514384765625,0.5139599609375
Total Model parameters after dst: 2365202 2317194
Total parameters under density level of 0.1: 0.23656789208704473 0.2317661240506086 after dst
Death rate: 0.10104385443280847


Training summary: Average loss: 0.0544, Accuracy: 49551/50000 (99.102%)


Evaluation: Average loss: 0.9693, Accuracy: 7622/10000 (76.220%)

Current learning rate: 0.001. Time taken for epoch: 88.71 seconds.

Train Epoch: 142 [0/50000 (0%)]	Loss: 0.041120 Accuracy: 100/100 (100.000%
Train Epoch: 142 [10000/50000 (20%)]	Loss: 0.034425 Accuracy: 10013/10100 (99.139%
Train Epoch: 142 [20000/50000 (40%)]	Loss: 0.068780 Accuracy: 19923/20100 (99.119%
Train Epoch: 142 [30000/50000 (60%)]	Loss: 0.052200 Accuracy: 29828/30100 (99.096%
Train Epoch: 142 [40000/50000 (80%)]	Loss: 0.059009 Accuracy: 39722/40100 (99.057%

Training summary: Average loss: 0.0550, Accuracy: 49522/50000 (99.044%)


Evaluation: Average loss: 0.9861, Accuracy: 7642/10000 (76.420%)

Current learning rate: 0.001. Time taken for epoch: 88.37 seconds.

Train Epoch: 143 [0/50000 (0%)]	Loss: 0.045343 Accuracy: 99/100 (99.000%
Train Epoch: 143 [10000/50000 (20%)]	Loss: 0.016557 Accuracy: 10018/10100 (99.188%
Train Epoch: 143 [20000/50000 (40%)]	Loss: 0.060771 Accuracy: 19935/20100 (99.179%
Train Epoch: 143 [30000/50000 (60%)]	Loss: 0.056077 Accuracy: 29842/30100 (99.143%
Train Epoch: 143 [40000/50000 (80%)]	Loss: 0.037130 Accuracy: 39760/40100 (99.152%
current dst rate 0.01711351221694773


dynamic sparse change
conv1.weight, mask/weight parameters,1168,1168 density 0.6759259259259259,0.6759259259259259
before tensor 4096 mask 663.0 4096
layer1.0.conv1.weight, mask/weight parameters,663,663 density 0.2204122340425532,0.2204122340425532
before tensor 36864 mask 3652.0 36864
layer1.0.conv2.weight, mask/weight parameters,3652,3652 density 0.1836929731904834,0.1836929731904834
before tensor 16384 mask 3712.0 16384
layer1.0.conv3.weight, mask/weight parameters,3712,3712 density 0.30851063829787234,0.30851063829787234
layer1.0.shortcut.0.weight, mask/weight parameters,5542,5542 density 0.3382568359375,0.3382568359375
before tensor 16384 mask 2393.0 16384
layer1.1.conv1.weight, mask/weight parameters,2393,2393 density 0.19888630319148937,0.19888630319148937
before tensor 36864 mask 3949.0 36864
layer1.1.conv2.weight, mask/weight parameters,3949,3949 density 0.19863185956440824,0.19863185956440824
before tensor 16384 mask 2172.0 16384
layer1.1.conv3.weight, mask/weight parameters,2172,2172 density 0.18051861702127658,0.18051861702127658
before tensor 16384 mask 2794.0 16384
layer1.2.conv1.weight, mask/weight parameters,2794,2794 density 0.23221409574468085,0.23221409574468085
before tensor 36864 mask 3418.0 36864
layer1.2.conv2.weight, mask/weight parameters,3418,3418 density 0.17192294150193652,0.17192294150193652
before tensor 16384 mask 1838.0 16384
layer1.2.conv3.weight, mask/weight parameters,1838,1838 density 0.1527593085106383,0.1527593085106383
before tensor 32768 mask 5285.0 32768
layer2.0.conv1.weight, mask/weight parameters,5285,5285 density 0.2752604166666667,0.2752604166666667
before tensor 147456 mask 12406.0 147456
layer2.0.conv2.weight, mask/weight parameters,12406,12406 density 0.2450567901234568,0.2450567901234568
before tensor 65536 mask 6830.0 65536
layer2.0.conv3.weight, mask/weight parameters,6830,6830 density 0.17786458333333333,0.17786458333333333
layer2.0.shortcut.0.weight, mask/weight parameters,29361,29361 density 0.22400665283203125,0.22400665283203125
before tensor 65536 mask 3543.0 65536
layer2.1.conv1.weight, mask/weight parameters,3543,3543 density 0.092265625,0.092265625
before tensor 147456 mask 4138.0 147456
layer2.1.conv2.weight, mask/weight parameters,4138,4138 density 0.08173827160493827,0.08173827160493827
before tensor 65536 mask 4130.0 65536
layer2.1.conv3.weight, mask/weight parameters,4130,4130 density 0.10755208333333334,0.10755208333333334
before tensor 65536 mask 10240.0 65536
layer2.2.conv1.weight, mask/weight parameters,10240,10240 density 0.26666666666666666,0.26666666666666666
before tensor 147456 mask 21070.0 147456
layer2.2.conv2.weight, mask/weight parameters,21070,21070 density 0.41619753086419753,0.41619753086419753
before tensor 65536 mask 13051.0 65536
layer2.2.conv3.weight, mask/weight parameters,13051,13051 density 0.33986979166666664,0.33986979166666664
before tensor 65536 mask 10475.0 65536
layer2.3.conv1.weight, mask/weight parameters,10475,10475 density 0.2727864583333333,0.2727864583333333
before tensor 147456 mask 20127.0 147456
layer2.3.conv2.weight, mask/weight parameters,20127,20127 density 0.39757037037037035,0.39757037037037035
before tensor 65536 mask 10832.0 65536
layer2.3.conv3.weight, mask/weight parameters,10832,10832 density 0.28208333333333335,0.28208333333333335
before tensor 131072 mask 29229.0 131072
layer3.0.conv1.weight, mask/weight parameters,29229,29229 density 0.4495109498031496,0.4495109498031496
before tensor 589824 mask 60680.0 589824
layer3.0.conv2.weight, mask/weight parameters,60680,60680 density 0.41801861381500544,0.41801861381500544
before tensor 262144 mask 56960.0 262144
layer3.0.conv3.weight, mask/weight parameters,56960,56960 density 0.43799212598425197,0.43799212598425197
layer3.0.shortcut.0.weight, mask/weight parameters,95234,95234 density 0.18164443969726562,0.18164443969726562
before tensor 262144 mask 27422.0 262144
layer3.1.conv1.weight, mask/weight parameters,27422,27422 density 0.21086060531496062,0.21086060531496062
before tensor 589824 mask 59702.0 589824
layer3.1.conv2.weight, mask/weight parameters,59702,59702 density 0.4112812670069785,0.4112812670069785
before tensor 262144 mask 51971.0 262144
layer3.1.conv3.weight, mask/weight parameters,51971,51971 density 0.39962936761811024,0.39962936761811024
before tensor 262144 mask 29719.0 262144
layer3.2.conv1.weight, mask/weight parameters,29719,29719 density 0.22852331446850394,0.22852331446850394
before tensor 589824 mask 52535.0 589824
layer3.2.conv2.weight, mask/weight parameters,52535,52535 density 0.36190850159478094,0.36190850159478094
before tensor 262144 mask 50040.0 262144
layer3.2.conv3.weight, mask/weight parameters,50040,50040 density 0.38478100393700787,0.38478100393700787
before tensor 262144 mask 33331.0 262144
layer3.3.conv1.weight, mask/weight parameters,33331,33331 density 0.2562976747047244,0.2562976747047244
before tensor 589824 mask 47157.0 589824
layer3.3.conv2.weight, mask/weight parameters,47157,47157 density 0.32485998305329944,0.32485998305329944
before tensor 262144 mask 43255.0 262144
layer3.3.conv3.weight, mask/weight parameters,43255,43255 density 0.33260796013779526,0.33260796013779526
before tensor 262144 mask 38597.0 262144
layer3.4.conv1.weight, mask/weight parameters,38597,38597 density 0.2967904158464567,0.2967904158464567
before tensor 589824 mask 48562.0 589824
layer3.4.conv2.weight, mask/weight parameters,48562,48562 density 0.3345388913000048,0.3345388913000048
before tensor 262144 mask 40436.0 262144
layer3.4.conv3.weight, mask/weight parameters,40436,40436 density 0.3109313484251969,0.3109313484251969
before tensor 262144 mask 45064.0 262144
layer3.5.conv1.weight, mask/weight parameters,45064,45064 density 0.3465182086614173,0.3465182086614173
before tensor 589824 mask 48429.0 589824
layer3.5.conv2.weight, mask/weight parameters,48429,48429 density 0.3336226672453345,0.3336226672453345
before tensor 262144 mask 39225.0 262144
layer3.5.conv3.weight, mask/weight parameters,39225,39225 density 0.3016194020669291,0.3016194020669291
before tensor 524288 mask 135111.0 524288
layer4.0.conv1.weight, mask/weight parameters,135111,135111 density 0.571187601461039,0.571187601461039
before tensor 2359296 mask 193563.0 2359296
layer4.0.conv2.weight, mask/weight parameters,193563,193563 density 0.40304716928093554,0.40304716928093554
before tensor 1048576 mask 101665.0 1048576
layer4.0.conv3.weight, mask/weight parameters,101665,101665 density 0.21489659429112554,0.21489659429112554
layer4.0.shortcut.0.weight, mask/weight parameters,135579,135579 density 0.06464910507202148,0.06464910507202148
before tensor 1048576 mask 116552.0 1048576
layer4.1.conv1.weight, mask/weight parameters,116552,116552 density 0.24636431277056278,0.24636431277056278
before tensor 2359296 mask 191127.0 2359296
layer4.1.conv2.weight, mask/weight parameters,191127,191127 density 0.3979748005722032,0.3979748005722032
before tensor 1048576 mask 82085.0 1048576
layer4.1.conv3.weight, mask/weight parameters,82085,82085 density 0.17350894548160173,0.17350894548160173
before tensor 1048576 mask 79614.0 1048576
layer4.2.conv1.weight, mask/weight parameters,79614,79614 density 0.16828581574675325,0.16828581574675325
before tensor 2359296 mask 68501.0 2359296
layer4.2.conv2.weight, mask/weight parameters,68501,68501 density 0.1426364240217054,0.1426364240217054
before tensor 1048576 mask 35332.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35332,35332 density 0.07468377976190477,0.07468377976190477
classifier.weight, mask/weight parameters,105260,105260 density 0.51396484375,0.51396484375
Total Model parameters after dst: 2324726 2324726
Total parameters under density level of 0.1: 0.23251947592634675 0.23251947592634675 after dst
Death rate: 0.10141720488651279

self.baseline_nonzero-self.total_nonzero 40477.20000000112
len(all_scores) 9997984 6693537
increse 40477.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1170,1168 density 0.6770833333333334,0.6759259259259259
before tensor 4096 mask 667.0 4096
layer1.0.conv1.weight, mask/weight parameters,667,663 density 0.22174202127659576,0.2204122340425532
before tensor 36864 mask 3685.0 36864
layer1.0.conv2.weight, mask/weight parameters,3685,3652 density 0.18535284945425282,0.1836929731904834
before tensor 16384 mask 3759.0 16384
layer1.0.conv3.weight, mask/weight parameters,3759,3712 density 0.31241688829787234,0.30851063829787234
layer1.0.shortcut.0.weight, mask/weight parameters,5584,5542 density 0.3408203125,0.3382568359375
before tensor 16384 mask 2438.0 16384
layer1.1.conv1.weight, mask/weight parameters,2438,2393 density 0.20262632978723405,0.19888630319148937
before tensor 36864 mask 3986.0 36864
layer1.1.conv2.weight, mask/weight parameters,3986,3949 density 0.2004929329510588,0.19863185956440824
before tensor 16384 mask 2209.0 16384
layer1.1.conv3.weight, mask/weight parameters,2209,2172 density 0.18359375,0.18051861702127658
before tensor 16384 mask 2850.0 16384
layer1.2.conv1.weight, mask/weight parameters,2850,2794 density 0.23686835106382978,0.23221409574468085
before tensor 36864 mask 3467.0 36864
layer1.2.conv2.weight, mask/weight parameters,3467,3418 density 0.17438760625723052,0.17192294150193652
before tensor 16384 mask 1852.0 16384
layer1.2.conv3.weight, mask/weight parameters,1852,1838 density 0.15392287234042554,0.1527593085106383
before tensor 32768 mask 5368.0 32768
layer2.0.conv1.weight, mask/weight parameters,5368,5285 density 0.27958333333333335,0.2752604166666667
before tensor 147456 mask 12487.0 147456
layer2.0.conv2.weight, mask/weight parameters,12487,12406 density 0.2466567901234568,0.2450567901234568
before tensor 65536 mask 6885.0 65536
layer2.0.conv3.weight, mask/weight parameters,6885,6830 density 0.179296875,0.17786458333333333
layer2.0.shortcut.0.weight, mask/weight parameters,29565,29361 density 0.22556304931640625,0.22400665283203125
before tensor 65536 mask 3643.0 65536
layer2.1.conv1.weight, mask/weight parameters,3643,3543 density 0.09486979166666666,0.092265625
before tensor 147456 mask 4153.0 147456
layer2.1.conv2.weight, mask/weight parameters,4153,4138 density 0.08203456790123456,0.08173827160493827
before tensor 65536 mask 4149.0 65536
layer2.1.conv3.weight, mask/weight parameters,4149,4130 density 0.108046875,0.10755208333333334
before tensor 65536 mask 10370.0 65536
layer2.2.conv1.weight, mask/weight parameters,10370,10240 density 0.27005208333333336,0.26666666666666666
before tensor 147456 mask 21253.0 147456
layer2.2.conv2.weight, mask/weight parameters,21253,21070 density 0.4198123456790123,0.41619753086419753
before tensor 65536 mask 13167.0 65536
layer2.2.conv3.weight, mask/weight parameters,13167,13051 density 0.342890625,0.33986979166666664
before tensor 65536 mask 10565.0 65536
layer2.3.conv1.weight, mask/weight parameters,10565,10475 density 0.27513020833333335,0.2727864583333333
before tensor 147456 mask 20341.0 147456
layer2.3.conv2.weight, mask/weight parameters,20341,20127 density 0.4017975308641975,0.39757037037037035
before tensor 65536 mask 10955.0 65536
layer2.3.conv3.weight, mask/weight parameters,10955,10832 density 0.2852864583333333,0.28208333333333335
before tensor 131072 mask 29605.0 131072
layer3.0.conv1.weight, mask/weight parameters,29605,29229 density 0.45529343011811024,0.4495109498031496
before tensor 589824 mask 61268.0 589824
layer3.0.conv2.weight, mask/weight parameters,61268,60680 density 0.4220692885830216,0.41801861381500544
before tensor 262144 mask 57843.0 262144
layer3.0.conv3.weight, mask/weight parameters,57843,56960 density 0.44478192667322836,0.43799212598425197
layer3.0.shortcut.0.weight, mask/weight parameters,96086,95234 density 0.18326950073242188,0.18164443969726562
before tensor 262144 mask 28124.0 262144
layer3.1.conv1.weight, mask/weight parameters,28124,27422 density 0.21625861220472442,0.21086060531496062
before tensor 589824 mask 61171.0 589824
layer3.1.conv2.weight, mask/weight parameters,61171,59702 density 0.42140106502435226,0.4112812670069785
before tensor 262144 mask 52880.0 262144
layer3.1.conv3.weight, mask/weight parameters,52880,51971 density 0.406619094488189,0.39962936761811024
before tensor 262144 mask 30210.0 262144
layer3.2.conv1.weight, mask/weight parameters,30210,29719 density 0.232298843503937,0.22852331446850394
before tensor 589824 mask 53304.0 589824
layer3.2.conv2.weight, mask/weight parameters,53304,52535 density 0.3672060677454688,0.36190850159478094
before tensor 262144 mask 51113.0 262144
layer3.2.conv3.weight, mask/weight parameters,51113,50040 density 0.3930318036417323,0.38478100393700787
before tensor 262144 mask 34469.0 262144
layer3.3.conv1.weight, mask/weight parameters,34469,33331 density 0.26504828986220474,0.2562976747047244
before tensor 589824 mask 48468.0 589824
layer3.3.conv2.weight, mask/weight parameters,48468,47157 density 0.33389133444933555,0.32485998305329944
before tensor 262144 mask 44179.0 262144
layer3.3.conv3.weight, mask/weight parameters,44179,43255 density 0.33971302903543305,0.33260796013779526
before tensor 262144 mask 39654.0 262144
layer3.4.conv1.weight, mask/weight parameters,39654,38597 density 0.3049181840551181,0.2967904158464567
before tensor 589824 mask 50234.0 589824
layer3.4.conv2.weight, mask/weight parameters,50234,48562 density 0.34605713655871756,0.3345388913000048
before tensor 262144 mask 41860.0 262144
layer3.4.conv3.weight, mask/weight parameters,41860,40436 density 0.3218811515748031,0.3109313484251969
before tensor 262144 mask 46182.0 262144
layer3.5.conv1.weight, mask/weight parameters,46182,45064 density 0.3551150344488189,0.3465182086614173
before tensor 589824 mask 49392.0 589824
layer3.5.conv2.weight, mask/weight parameters,49392,48429 density 0.34025668051336105,0.3336226672453345
before tensor 262144 mask 39949.0 262144
layer3.5.conv3.weight, mask/weight parameters,39949,39225 density 0.3071865772637795,0.3016194020669291
before tensor 524288 mask 137594.0 524288
layer4.0.conv1.weight, mask/weight parameters,137594,135111 density 0.5816845914502164,0.571187601461039
before tensor 2359296 mask 197238.0 2359296
layer4.0.conv2.weight, mask/weight parameters,197238,193563 density 0.4106994496604886,0.40304716928093554
before tensor 1048576 mask 103303.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103303,101665 density 0.218358952245671,0.21489659429112554
layer4.0.shortcut.0.weight, mask/weight parameters,137294,135579 density 0.06546688079833984,0.06464910507202148
before tensor 1048576 mask 118967.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118967,116552 density 0.25146907129329005,0.24636431277056278
before tensor 2359296 mask 194869.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194869,191127 density 0.40576659191377806,0.3979748005722032
before tensor 1048576 mask 83052.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83052,82085 density 0.17555296266233766,0.17350894548160173
before tensor 1048576 mask 81465.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81465,79614 density 0.17219840706168832,0.16828581574675325
before tensor 2359296 mask 69790.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69790,68501 density 0.1453204483507514,0.1426364240217054
before tensor 1048576 mask 35731.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35731,35332 density 0.0755271746482684,0.07468377976190477
classifier.weight, mask/weight parameters,105340,105260 density 0.51435546875,0.51396484375
Total Model parameters after dst: 2365202 2324726
Total parameters under density level of 0.1: 0.23656789208704473 0.23251947592634675 after dst
Death rate: 0.10141720488651279


Training summary: Average loss: 0.0527, Accuracy: 49586/50000 (99.172%)


Evaluation: Average loss: 0.9753, Accuracy: 7658/10000 (76.580%)

Current learning rate: 0.001. Time taken for epoch: 88.76 seconds.

Train Epoch: 144 [0/50000 (0%)]	Loss: 0.045708 Accuracy: 100/100 (100.000%
Train Epoch: 144 [10000/50000 (20%)]	Loss: 0.087526 Accuracy: 10028/10100 (99.287%
Train Epoch: 144 [20000/50000 (40%)]	Loss: 0.048820 Accuracy: 19933/20100 (99.169%
Train Epoch: 144 [30000/50000 (60%)]	Loss: 0.034641 Accuracy: 29845/30100 (99.153%
Train Epoch: 144 [40000/50000 (80%)]	Loss: 0.079476 Accuracy: 39770/40100 (99.177%

Training summary: Average loss: 0.0516, Accuracy: 49584/50000 (99.168%)


Evaluation: Average loss: 0.9856, Accuracy: 7660/10000 (76.600%)

Current learning rate: 0.001. Time taken for epoch: 88.38 seconds.

Train Epoch: 145 [0/50000 (0%)]	Loss: 0.059321 Accuracy: 99/100 (99.000%
Train Epoch: 145 [10000/50000 (20%)]	Loss: 0.068667 Accuracy: 10026/10100 (99.267%
Train Epoch: 145 [20000/50000 (40%)]	Loss: 0.051592 Accuracy: 19948/20100 (99.244%
Train Epoch: 145 [30000/50000 (60%)]	Loss: 0.054948 Accuracy: 29856/30100 (99.189%
Train Epoch: 145 [40000/50000 (80%)]	Loss: 0.062645 Accuracy: 39765/40100 (99.165%
current dst rate 0.014292328977720148


dynamic sparse change
conv1.weight, mask/weight parameters,1166,1166 density 0.6747685185185185,0.6747685185185185
before tensor 4096 mask 663.0 4096
layer1.0.conv1.weight, mask/weight parameters,663,663 density 0.2204122340425532,0.2204122340425532
before tensor 36864 mask 3661.0 36864
layer1.0.conv2.weight, mask/weight parameters,3661,3661 density 0.18414566671696594,0.18414566671696594
before tensor 16384 mask 3737.0 16384
layer1.0.conv3.weight, mask/weight parameters,3737,3737 density 0.31058843085106386,0.31058843085106386
layer1.0.shortcut.0.weight, mask/weight parameters,5527,5527 density 0.33734130859375,0.33734130859375
before tensor 16384 mask 2404.0 16384
layer1.1.conv1.weight, mask/weight parameters,2404,2404 density 0.1998005319148936,0.1998005319148936
before tensor 36864 mask 3956.0 36864
layer1.1.conv2.weight, mask/weight parameters,3956,3956 density 0.19898395452945022,0.19898395452945022
before tensor 16384 mask 2189.0 16384
layer1.1.conv3.weight, mask/weight parameters,2189,2189 density 0.1819315159574468,0.1819315159574468
before tensor 16384 mask 2812.0 16384
layer1.2.conv1.weight, mask/weight parameters,2812,2812 density 0.23371010638297873,0.23371010638297873
before tensor 36864 mask 3432.0 36864
layer1.2.conv2.weight, mask/weight parameters,3432,3432 density 0.17262713143202052,0.17262713143202052
before tensor 16384 mask 1841.0 16384
layer1.2.conv3.weight, mask/weight parameters,1841,1841 density 0.15300864361702127,0.15300864361702127
before tensor 32768 mask 5288.0 32768
layer2.0.conv1.weight, mask/weight parameters,5288,5288 density 0.27541666666666664,0.27541666666666664
before tensor 147456 mask 12427.0 147456
layer2.0.conv2.weight, mask/weight parameters,12427,12427 density 0.2454716049382716,0.2454716049382716
before tensor 65536 mask 6846.0 65536
layer2.0.conv3.weight, mask/weight parameters,6846,6846 density 0.17828125,0.17828125
layer2.0.shortcut.0.weight, mask/weight parameters,29384,29384 density 0.22418212890625,0.22418212890625
before tensor 65536 mask 3558.0 65536
layer2.1.conv1.weight, mask/weight parameters,3558,3558 density 0.09265625,0.09265625
before tensor 147456 mask 4134.0 147456
layer2.1.conv2.weight, mask/weight parameters,4134,4134 density 0.08165925925925926,0.08165925925925926
before tensor 65536 mask 4119.0 65536
layer2.1.conv3.weight, mask/weight parameters,4119,4119 density 0.107265625,0.107265625
before tensor 65536 mask 10273.0 65536
layer2.2.conv1.weight, mask/weight parameters,10273,10273 density 0.26752604166666666,0.26752604166666666
before tensor 147456 mask 21088.0 147456
layer2.2.conv2.weight, mask/weight parameters,21088,21088 density 0.4165530864197531,0.4165530864197531
before tensor 65536 mask 13069.0 65536
layer2.2.conv3.weight, mask/weight parameters,13069,13069 density 0.34033854166666666,0.34033854166666666
before tensor 65536 mask 10486.0 65536
layer2.3.conv1.weight, mask/weight parameters,10486,10486 density 0.27307291666666667,0.27307291666666667
before tensor 147456 mask 20140.0 147456
layer2.3.conv2.weight, mask/weight parameters,20140,20140 density 0.39782716049382716,0.39782716049382716
before tensor 65536 mask 10860.0 65536
layer2.3.conv3.weight, mask/weight parameters,10860,10860 density 0.2828125,0.2828125
before tensor 131072 mask 29311.0 131072
layer3.0.conv1.weight, mask/weight parameters,29311,29311 density 0.45077202263779526,0.45077202263779526
before tensor 589824 mask 60799.0 589824
layer3.0.conv2.weight, mask/weight parameters,60799,60799 density 0.418838393232342,0.418838393232342
before tensor 262144 mask 57134.0 262144
layer3.0.conv3.weight, mask/weight parameters,57134,57134 density 0.439330093503937,0.439330093503937
layer3.0.shortcut.0.weight, mask/weight parameters,95314,95314 density 0.18179702758789062,0.18179702758789062
before tensor 262144 mask 27636.0 262144
layer3.1.conv1.weight, mask/weight parameters,27636,27636 density 0.21250615157480315,0.21250615157480315
before tensor 589824 mask 59976.0 589824
layer3.1.conv2.weight, mask/weight parameters,59976,59976 density 0.4131688263376527,0.4131688263376527
before tensor 262144 mask 52094.0 262144
layer3.1.conv3.weight, mask/weight parameters,52094,52094 density 0.4005751722440945,0.4005751722440945
before tensor 262144 mask 29763.0 262144
layer3.2.conv1.weight, mask/weight parameters,29763,29763 density 0.22886165108267717,0.22886165108267717
before tensor 589824 mask 52627.0 589824
layer3.2.conv2.weight, mask/weight parameters,52627,52627 density 0.36254228064011684,0.36254228064011684
before tensor 262144 mask 50287.0 262144
layer3.2.conv3.weight, mask/weight parameters,50287,50287 density 0.3866803026574803,0.3866803026574803
before tensor 262144 mask 33597.0 262144
layer3.3.conv1.weight, mask/weight parameters,33597,33597 density 0.25834307332677164,0.25834307332677164
before tensor 589824 mask 47525.0 589824
layer3.3.conv2.weight, mask/weight parameters,47525,47525 density 0.32739509923464294,0.32739509923464294
before tensor 262144 mask 43417.0 262144
layer3.3.conv3.weight, mask/weight parameters,43417,43417 density 0.33385365403543305,0.33385365403543305
before tensor 262144 mask 38835.0 262144
layer3.4.conv1.weight, mask/weight parameters,38835,38835 density 0.2986205093503937,0.2986205093503937
before tensor 589824 mask 49028.0 589824
layer3.4.conv2.weight, mask/weight parameters,49028,49028 density 0.3377491199426843,0.3377491199426843
before tensor 262144 mask 40872.0 262144
layer3.4.conv3.weight, mask/weight parameters,40872,40872 density 0.31428395669291337,0.31428395669291337
before tensor 262144 mask 45299.0 262144
layer3.5.conv1.weight, mask/weight parameters,45299,45299 density 0.34832523375984253,0.34832523375984253
before tensor 589824 mask 48590.0 589824
layer3.5.conv2.weight, mask/weight parameters,48590,48590 density 0.33473178057467223,0.33473178057467223
before tensor 262144 mask 39384.0 262144
layer3.5.conv3.weight, mask/weight parameters,39384,39384 density 0.3028420275590551,0.3028420275590551
before tensor 524288 mask 135532.0 524288
layer4.0.conv1.weight, mask/weight parameters,135532,135532 density 0.5729673971861472,0.5729673971861472
before tensor 2359296 mask 194049.0 2359296
layer4.0.conv2.weight, mask/weight parameters,194049,194049 density 0.40405914431888457,0.40405914431888457
before tensor 1048576 mask 101798.0 1048576
layer4.0.conv3.weight, mask/weight parameters,101798,101798 density 0.2151777259199134,0.2151777259199134
layer4.0.shortcut.0.weight, mask/weight parameters,135725,135725 density 0.06471872329711914,0.06471872329711914
before tensor 1048576 mask 116870.0 1048576
layer4.1.conv1.weight, mask/weight parameters,116870,116870 density 0.24703649215367965,0.24703649215367965
before tensor 2359296 mask 191630.0 2359296
layer4.1.conv2.weight, mask/weight parameters,191630,191630 density 0.3990221739139488,0.3990221739139488
before tensor 1048576 mask 82177.0 1048576
layer4.1.conv3.weight, mask/weight parameters,82177,82177 density 0.1737034124729437,0.1737034124729437
before tensor 1048576 mask 79760.0 1048576
layer4.2.conv1.weight, mask/weight parameters,79760,79760 density 0.1685944264069264,0.1685944264069264
before tensor 2359296 mask 68631.0 2359296
layer4.2.conv2.weight, mask/weight parameters,68631,68631 density 0.14290711693309097,0.14290711693309097
before tensor 1048576 mask 35419.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35419,35419 density 0.07486767789502165,0.07486767789502165
classifier.weight, mask/weight parameters,105259,105259 density 0.5139599609375,0.5139599609375
Total Model parameters after dst: 2331398 2331398
Total parameters under density level of 0.1: 0.23318681046098894 0.23318681046098894 after dst
Death rate: 0.10184563405990128

self.baseline_nonzero-self.total_nonzero 33805.20000000112
len(all_scores) 9997984 6686864
increse 33805.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1180,1166 density 0.6828703703703703,0.6747685185185185
before tensor 4096 mask 672.0 4096
layer1.0.conv1.weight, mask/weight parameters,672,663 density 0.22340425531914893,0.2204122340425532
before tensor 36864 mask 3675.0 36864
layer1.0.conv2.weight, mask/weight parameters,3675,3661 density 0.18484985664704995,0.18414566671696594
before tensor 16384 mask 3743.0 16384
layer1.0.conv3.weight, mask/weight parameters,3743,3737 density 0.3110871010638298,0.31058843085106386
layer1.0.shortcut.0.weight, mask/weight parameters,5631,5527 density 0.34368896484375,0.33734130859375
before tensor 16384 mask 2449.0 16384
layer1.1.conv1.weight, mask/weight parameters,2449,2404 density 0.2035405585106383,0.1998005319148936
before tensor 36864 mask 3959.0 36864
layer1.1.conv2.weight, mask/weight parameters,3959,3956 density 0.19913485237161108,0.19898395452945022
before tensor 16384 mask 2194.0 16384
layer1.1.conv3.weight, mask/weight parameters,2194,2189 density 0.1823470744680851,0.1819315159574468
before tensor 16384 mask 2934.0 16384
layer1.2.conv1.weight, mask/weight parameters,2934,2812 density 0.2438497340425532,0.23371010638297873
before tensor 36864 mask 3436.0 36864
layer1.2.conv2.weight, mask/weight parameters,3436,3432 density 0.17282832855490166,0.17262713143202052
before tensor 16384 mask 1849.0 16384
layer1.2.conv3.weight, mask/weight parameters,1849,1841 density 0.15367353723404256,0.15300864361702127
before tensor 32768 mask 5403.0 32768
layer2.0.conv1.weight, mask/weight parameters,5403,5288 density 0.28140625,0.27541666666666664
before tensor 147456 mask 12452.0 147456
layer2.0.conv2.weight, mask/weight parameters,12452,12427 density 0.24596543209876542,0.2454716049382716
before tensor 65536 mask 6856.0 65536
layer2.0.conv3.weight, mask/weight parameters,6856,6846 density 0.17854166666666665,0.17828125
layer2.0.shortcut.0.weight, mask/weight parameters,29766,29384 density 0.2270965576171875,0.22418212890625
before tensor 65536 mask 3572.0 65536
layer2.1.conv1.weight, mask/weight parameters,3572,3558 density 0.09302083333333333,0.09265625
before tensor 147456 mask 4178.0 147456
layer2.1.conv2.weight, mask/weight parameters,4178,4134 density 0.08252839506172839,0.08165925925925926
before tensor 65536 mask 4230.0 65536
layer2.1.conv3.weight, mask/weight parameters,4230,4119 density 0.11015625,0.107265625
before tensor 65536 mask 10448.0 65536
layer2.2.conv1.weight, mask/weight parameters,10448,10273 density 0.27208333333333334,0.26752604166666666
before tensor 147456 mask 21213.0 147456
layer2.2.conv2.weight, mask/weight parameters,21213,21088 density 0.41902222222222224,0.4165530864197531
before tensor 65536 mask 13168.0 65536
layer2.2.conv3.weight, mask/weight parameters,13168,13069 density 0.34291666666666665,0.34033854166666666
before tensor 65536 mask 10613.0 65536
layer2.3.conv1.weight, mask/weight parameters,10613,10486 density 0.2763802083333333,0.27307291666666667
before tensor 147456 mask 20188.0 147456
layer2.3.conv2.weight, mask/weight parameters,20188,20140 density 0.3987753086419753,0.39782716049382716
before tensor 65536 mask 10900.0 65536
layer2.3.conv3.weight, mask/weight parameters,10900,10860 density 0.2838541666666667,0.2828125
before tensor 131072 mask 29772.0 131072
layer3.0.conv1.weight, mask/weight parameters,29772,29311 density 0.4578617125984252,0.45077202263779526
before tensor 589824 mask 61042.0 589824
layer3.0.conv2.weight, mask/weight parameters,61042,60799 density 0.4205123965803487,0.418838393232342
before tensor 262144 mask 57530.0 262144
layer3.0.conv3.weight, mask/weight parameters,57530,57134 density 0.44237512303149606,0.439330093503937
layer3.0.shortcut.0.weight, mask/weight parameters,96889,95314 density 0.1848011016845703,0.18179702758789062
before tensor 262144 mask 27869.0 262144
layer3.1.conv1.weight, mask/weight parameters,27869,27636 density 0.21429779773622049,0.21250615157480315
before tensor 589824 mask 60918.0 589824
layer3.1.conv2.weight, mask/weight parameters,60918,59976 density 0.41965817264967864,0.4131688263376527
before tensor 262144 mask 52912.0 262144
layer3.1.conv3.weight, mask/weight parameters,52912,52094 density 0.406865157480315,0.4005751722440945
before tensor 262144 mask 30033.0 262144
layer3.2.conv1.weight, mask/weight parameters,30033,29763 density 0.23093780757874016,0.22886165108267717
before tensor 589824 mask 53027.0 589824
layer3.2.conv2.weight, mask/weight parameters,53027,52627 density 0.3652978417067945,0.36254228064011684
before tensor 262144 mask 50833.0 262144
layer3.2.conv3.weight, mask/weight parameters,50833,50287 density 0.3908787524606299,0.3866803026574803
before tensor 262144 mask 34033.0 262144
layer3.3.conv1.weight, mask/weight parameters,34033,33597 density 0.2616956815944882,0.25834307332677164
before tensor 589824 mask 47986.0 589824
layer3.3.conv2.weight, mask/weight parameters,47986,47525 density 0.33057088336398893,0.32739509923464294
before tensor 262144 mask 43825.0 262144
layer3.3.conv3.weight, mask/weight parameters,43825,43417 density 0.33699095718503935,0.33385365403543305
before tensor 262144 mask 39572.0 262144
layer3.4.conv1.weight, mask/weight parameters,39572,38835 density 0.30428764763779526,0.2986205093503937
before tensor 589824 mask 49613.0 589824
layer3.4.conv2.weight, mask/weight parameters,49613,49028 density 0.34177912800270044,0.3377491199426843
before tensor 262144 mask 41333.0 262144
layer3.4.conv3.weight, mask/weight parameters,41333,40872 density 0.31782880167322836,0.31428395669291337
before tensor 262144 mask 45791.0 262144
layer3.5.conv1.weight, mask/weight parameters,45791,45299 density 0.3521084522637795,0.34832523375984253
before tensor 589824 mask 49025.0 589824
layer3.5.conv2.weight, mask/weight parameters,49025,48590 density 0.33772845323468426,0.33473178057467223
before tensor 262144 mask 39872.0 262144
layer3.5.conv3.weight, mask/weight parameters,39872,39384 density 0.3065944881889764,0.3028420275590551
before tensor 524288 mask 137575.0 524288
layer4.0.conv1.weight, mask/weight parameters,137575,135532 density 0.5816042681277056,0.5729673971861472
before tensor 2359296 mask 197214.0 2359296
layer4.0.conv2.weight, mask/weight parameters,197214,194049 density 0.4106494755845405,0.40405914431888457
before tensor 1048576 mask 103904.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103904,101798 density 0.219629329004329,0.2151777259199134
layer4.0.shortcut.0.weight, mask/weight parameters,137923,135725 density 0.06576681137084961,0.06471872329711914
before tensor 1048576 mask 120255.0 1048576
layer4.1.conv1.weight, mask/weight parameters,120255,116870 density 0.25419160917207795,0.24703649215367965
before tensor 2359296 mask 195781.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195781,191630 density 0.40766560679980596,0.3990221739139488
before tensor 1048576 mask 83396.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83396,82177 density 0.17628010010822512,0.1737034124729437
before tensor 1048576 mask 81453.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81453,79760 density 0.17217304180194806,0.1685944264069264
before tensor 2359296 mask 70036.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70036,68631 density 0.14583268262921942,0.14290711693309097
before tensor 1048576 mask 35745.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35745,35419 density 0.0755567674512987,0.07486767789502165
classifier.weight, mask/weight parameters,105336,105259 density 0.5143359375,0.5139599609375
Total Model parameters after dst: 2365202 2331398
Total parameters under density level of 0.1: 0.23656789208704473 0.23318681046098894 after dst
Death rate: 0.10184563405990128


Training summary: Average loss: 0.0507, Accuracy: 49589/50000 (99.178%)


Evaluation: Average loss: 0.9892, Accuracy: 7630/10000 (76.300%)

Current learning rate: 0.001. Time taken for epoch: 88.69 seconds.

Train Epoch: 146 [0/50000 (0%)]	Loss: 0.039268 Accuracy: 100/100 (100.000%
Train Epoch: 146 [10000/50000 (20%)]	Loss: 0.064794 Accuracy: 10020/10100 (99.208%
Train Epoch: 146 [20000/50000 (40%)]	Loss: 0.029662 Accuracy: 19941/20100 (99.209%
Train Epoch: 146 [30000/50000 (60%)]	Loss: 0.037155 Accuracy: 29863/30100 (99.213%
Train Epoch: 146 [40000/50000 (80%)]	Loss: 0.048275 Accuracy: 39782/40100 (99.207%

Training summary: Average loss: 0.0496, Accuracy: 49598/50000 (99.196%)


Evaluation: Average loss: 0.9903, Accuracy: 7642/10000 (76.420%)

Current learning rate: 0.001. Time taken for epoch: 88.37 seconds.

Train Epoch: 147 [0/50000 (0%)]	Loss: 0.031150 Accuracy: 100/100 (100.000%
Train Epoch: 147 [10000/50000 (20%)]	Loss: 0.086281 Accuracy: 10027/10100 (99.277%
Train Epoch: 147 [20000/50000 (40%)]	Loss: 0.039117 Accuracy: 19951/20100 (99.259%
Train Epoch: 147 [30000/50000 (60%)]	Loss: 0.040399 Accuracy: 29866/30100 (99.223%
Train Epoch: 147 [40000/50000 (80%)]	Loss: 0.029648 Accuracy: 39785/40100 (99.214%
current dst rate 0.01183844470157307


dynamic sparse change
conv1.weight, mask/weight parameters,1173,1173 density 0.6788194444444444,0.6788194444444444
before tensor 4096 mask 665.0 4096
layer1.0.conv1.weight, mask/weight parameters,665,665 density 0.22107712765957446,0.22107712765957446
before tensor 36864 mask 3661.0 36864
layer1.0.conv2.weight, mask/weight parameters,3661,3661 density 0.18414566671696594,0.18414566671696594
before tensor 16384 mask 3725.0 16384
layer1.0.conv3.weight, mask/weight parameters,3725,3725 density 0.3095910904255319,0.3095910904255319
layer1.0.shortcut.0.weight, mask/weight parameters,5562,5562 density 0.3394775390625,0.3394775390625
before tensor 16384 mask 2404.0 16384
layer1.1.conv1.weight, mask/weight parameters,2404,2404 density 0.1998005319148936,0.1998005319148936
before tensor 36864 mask 3951.0 36864
layer1.1.conv2.weight, mask/weight parameters,3951,3951 density 0.1987324581258488,0.1987324581258488
before tensor 16384 mask 2184.0 16384
layer1.1.conv3.weight, mask/weight parameters,2184,2184 density 0.1815159574468085,0.1815159574468085
before tensor 16384 mask 2859.0 16384
layer1.2.conv1.weight, mask/weight parameters,2859,2859 density 0.23761635638297873,0.23761635638297873
before tensor 36864 mask 3424.0 36864
layer1.2.conv2.weight, mask/weight parameters,3424,3424 density 0.17222473718625825,0.17222473718625825
before tensor 16384 mask 1835.0 16384
layer1.2.conv3.weight, mask/weight parameters,1835,1835 density 0.15250997340425532,0.15250997340425532
before tensor 32768 mask 5301.0 32768
layer2.0.conv1.weight, mask/weight parameters,5301,5301 density 0.27609375,0.27609375
before tensor 147456 mask 12412.0 147456
layer2.0.conv2.weight, mask/weight parameters,12412,12412 density 0.24517530864197531,0.24517530864197531
before tensor 65536 mask 6837.0 65536
layer2.0.conv3.weight, mask/weight parameters,6837,6837 density 0.178046875,0.178046875
layer2.0.shortcut.0.weight, mask/weight parameters,29490,29490 density 0.2249908447265625,0.2249908447265625
before tensor 65536 mask 3552.0 65536
layer2.1.conv1.weight, mask/weight parameters,3552,3552 density 0.0925,0.0925
before tensor 147456 mask 4135.0 147456
layer2.1.conv2.weight, mask/weight parameters,4135,4135 density 0.08167901234567901,0.08167901234567901
before tensor 65536 mask 4153.0 65536
layer2.1.conv3.weight, mask/weight parameters,4153,4153 density 0.10815104166666667,0.10815104166666667
before tensor 65536 mask 10316.0 65536
layer2.2.conv1.weight, mask/weight parameters,10316,10316 density 0.2686458333333333,0.2686458333333333
before tensor 147456 mask 21092.0 147456
layer2.2.conv2.weight, mask/weight parameters,21092,21092 density 0.4166320987654321,0.4166320987654321
before tensor 65536 mask 13089.0 65536
layer2.2.conv3.weight, mask/weight parameters,13089,13089 density 0.340859375,0.340859375
before tensor 65536 mask 10522.0 65536
layer2.3.conv1.weight, mask/weight parameters,10522,10522 density 0.27401041666666665,0.27401041666666665
before tensor 147456 mask 20111.0 147456
layer2.3.conv2.weight, mask/weight parameters,20111,20111 density 0.39725432098765434,0.39725432098765434
before tensor 65536 mask 10857.0 65536
layer2.3.conv3.weight, mask/weight parameters,10857,10857 density 0.282734375,0.282734375
before tensor 131072 mask 29419.0 131072
layer3.0.conv1.weight, mask/weight parameters,29419,29419 density 0.45243294783464566,0.45243294783464566
before tensor 589824 mask 60761.0 589824
layer3.0.conv2.weight, mask/weight parameters,60761,60761 density 0.4185766149310076,0.4185766149310076
before tensor 262144 mask 57078.0 262144
layer3.0.conv3.weight, mask/weight parameters,57078,57078 density 0.43889948326771655,0.43889948326771655
layer3.0.shortcut.0.weight, mask/weight parameters,95770,95770 density 0.18266677856445312,0.18266677856445312
before tensor 262144 mask 27605.0 262144
layer3.1.conv1.weight, mask/weight parameters,27605,27605 density 0.2122677780511811,0.2122677780511811
before tensor 589824 mask 60131.0 589824
layer3.1.conv2.weight, mask/weight parameters,60131,60131 density 0.4142366062509903,0.4142366062509903
before tensor 262144 mask 52238.0 262144
layer3.1.conv3.weight, mask/weight parameters,52238,52238 density 0.4016824557086614,0.4016824557086614
before tensor 262144 mask 29754.0 262144
layer3.2.conv1.weight, mask/weight parameters,29754,29754 density 0.22879244586614172,0.22879244586614172
before tensor 589824 mask 52639.0 589824
layer3.2.conv2.weight, mask/weight parameters,52639,52639 density 0.36262494747211715,0.36262494747211715
before tensor 262144 mask 50364.0 262144
layer3.2.conv3.weight, mask/weight parameters,50364,50364 density 0.38727239173228345,0.38727239173228345
before tensor 262144 mask 33615.0 262144
layer3.3.conv1.weight, mask/weight parameters,33615,33615 density 0.25848148375984253,0.25848148375984253
before tensor 589824 mask 47509.0 589824
layer3.3.conv2.weight, mask/weight parameters,47509,47509 density 0.3272848767919758,0.3272848767919758
before tensor 262144 mask 43431.0 262144
layer3.3.conv3.weight, mask/weight parameters,43431,43431 density 0.3339613065944882,0.3339613065944882
before tensor 262144 mask 38953.0 262144
layer3.4.conv1.weight, mask/weight parameters,38953,38953 density 0.2995278666338583,0.2995278666338583
before tensor 589824 mask 49049.0 589824
layer3.4.conv2.weight, mask/weight parameters,49049,49049 density 0.33789378689868493,0.33789378689868493
before tensor 262144 mask 40834.0 262144
layer3.4.conv3.weight, mask/weight parameters,40834,40834 density 0.3139917568897638,0.3139917568897638
before tensor 262144 mask 45290.0 262144
layer3.5.conv1.weight, mask/weight parameters,45290,45290 density 0.34825602854330706,0.34825602854330706
before tensor 589824 mask 48536.0 589824
layer3.5.conv2.weight, mask/weight parameters,48536,48536 density 0.3343597798306708,0.3343597798306708
before tensor 262144 mask 39467.0 262144
layer3.5.conv3.weight, mask/weight parameters,39467,39467 density 0.3034802534448819,0.3034802534448819
before tensor 524288 mask 136008.0 524288
layer4.0.conv1.weight, mask/weight parameters,136008,136008 density 0.5749797077922078,0.5749797077922078
before tensor 2359296 mask 194588.0 2359296
layer4.0.conv2.weight, mask/weight parameters,194588,194588 density 0.40518147877455235,0.40518147877455235
before tensor 1048576 mask 102250.0 1048576
layer4.0.conv3.weight, mask/weight parameters,102250,102250 density 0.2161331507034632,0.2161331507034632
layer4.0.shortcut.0.weight, mask/weight parameters,136092,136092 density 0.06489372253417969,0.06489372253417969
before tensor 1048576 mask 117716.0 1048576
layer4.1.conv1.weight, mask/weight parameters,117716,117716 density 0.24882474296536797,0.24882474296536797
before tensor 2359296 mask 192693.0 2359296
layer4.1.conv2.weight, mask/weight parameters,192693,192693 density 0.4012356090278168,0.4012356090278168
before tensor 1048576 mask 82393.0 1048576
layer4.1.conv3.weight, mask/weight parameters,82393,82393 density 0.17415998714826839,0.17415998714826839
before tensor 1048576 mask 80049.0 1048576
layer4.2.conv1.weight, mask/weight parameters,80049,80049 density 0.16920530641233766,0.16920530641233766
before tensor 2359296 mask 68899.0 2359296
layer4.2.conv2.weight, mask/weight parameters,68899,68899 density 0.1434651607811781,0.1434651607811781
before tensor 1048576 mask 35499.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35499,35499 density 0.07503677962662338,0.07503677962662338
classifier.weight, mask/weight parameters,105262,105262 density 0.513974609375,0.513974609375
Total Model parameters after dst: 2337202 2337202
Total parameters under density level of 0.1: 0.23376732749322263 0.23376732749322263 after dst
Death rate: 0.10232814133678823

self.baseline_nonzero-self.total_nonzero 28001.200000001118
len(all_scores) 9997984 6681016
increse 28001.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1179,1173 density 0.6822916666666666,0.6788194444444444
before tensor 4096 mask 668.0 4096
layer1.0.conv1.weight, mask/weight parameters,668,665 density 0.2220744680851064,0.22107712765957446
before tensor 36864 mask 3665.0 36864
layer1.0.conv2.weight, mask/weight parameters,3665,3661 density 0.18434686383984708,0.18414566671696594
before tensor 16384 mask 3733.0 16384
layer1.0.conv3.weight, mask/weight parameters,3733,3725 density 0.31025598404255317,0.3095910904255319
layer1.0.shortcut.0.weight, mask/weight parameters,5623,5562 density 0.34320068359375,0.3394775390625
before tensor 16384 mask 2429.0 16384
layer1.1.conv1.weight, mask/weight parameters,2429,2404 density 0.2018783244680851,0.1998005319148936
before tensor 36864 mask 3952.0 36864
layer1.1.conv2.weight, mask/weight parameters,3952,3951 density 0.1987827574065691,0.1987324581258488
before tensor 16384 mask 2184.0 16384
layer1.1.conv3.weight, mask/weight parameters,2184,2184 density 0.1815159574468085,0.1815159574468085
before tensor 16384 mask 2870.0 16384
layer1.2.conv1.weight, mask/weight parameters,2870,2859 density 0.23853058510638298,0.23761635638297873
before tensor 36864 mask 3425.0 36864
layer1.2.conv2.weight, mask/weight parameters,3425,3424 density 0.17227503646697853,0.17222473718625825
before tensor 16384 mask 1837.0 16384
layer1.2.conv3.weight, mask/weight parameters,1837,1835 density 0.15267619680851063,0.15250997340425532
before tensor 32768 mask 5307.0 32768
layer2.0.conv1.weight, mask/weight parameters,5307,5301 density 0.27640625,0.27609375
before tensor 147456 mask 12432.0 147456
layer2.0.conv2.weight, mask/weight parameters,12432,12412 density 0.24557037037037038,0.24517530864197531
before tensor 65536 mask 6849.0 65536
layer2.0.conv3.weight, mask/weight parameters,6849,6837 density 0.178359375,0.178046875
layer2.0.shortcut.0.weight, mask/weight parameters,29609,29490 density 0.22589874267578125,0.2249908447265625
before tensor 65536 mask 3561.0 65536
layer2.1.conv1.weight, mask/weight parameters,3561,3552 density 0.092734375,0.0925
before tensor 147456 mask 4177.0 147456
layer2.1.conv2.weight, mask/weight parameters,4177,4135 density 0.08250864197530865,0.08167901234567901
before tensor 65536 mask 4191.0 65536
layer2.1.conv3.weight, mask/weight parameters,4191,4153 density 0.109140625,0.10815104166666667
before tensor 65536 mask 10388.0 65536
layer2.2.conv1.weight, mask/weight parameters,10388,10316 density 0.2705208333333333,0.2686458333333333
before tensor 147456 mask 21128.0 147456
layer2.2.conv2.weight, mask/weight parameters,21128,21092 density 0.4173432098765432,0.4166320987654321
before tensor 65536 mask 13117.0 65536
layer2.2.conv3.weight, mask/weight parameters,13117,13089 density 0.3415885416666667,0.340859375
before tensor 65536 mask 10554.0 65536
layer2.3.conv1.weight, mask/weight parameters,10554,10522 density 0.27484375,0.27401041666666665
before tensor 147456 mask 20159.0 147456
layer2.3.conv2.weight, mask/weight parameters,20159,20111 density 0.3982024691358025,0.39725432098765434
before tensor 65536 mask 10923.0 65536
layer2.3.conv3.weight, mask/weight parameters,10923,10857 density 0.284453125,0.282734375
before tensor 131072 mask 29617.0 131072
layer3.0.conv1.weight, mask/weight parameters,29617,29419 density 0.45547797736220474,0.45243294783464566
before tensor 589824 mask 60933.0 589824
layer3.0.conv2.weight, mask/weight parameters,60933,60761 density 0.41976150618967906,0.4185766149310076
before tensor 262144 mask 57526.0 262144
layer3.0.conv3.weight, mask/weight parameters,57526,57078 density 0.4423443651574803,0.43889948326771655
layer3.0.shortcut.0.weight, mask/weight parameters,96580,95770 density 0.18421173095703125,0.18266677856445312
before tensor 262144 mask 27790.0 262144
layer3.1.conv1.weight, mask/weight parameters,27790,27605 density 0.21369032972440946,0.2122677780511811
before tensor 589824 mask 60860.0 589824
layer3.1.conv2.weight, mask/weight parameters,60860,60131 density 0.4192586162950104,0.4142366062509903
before tensor 262144 mask 52751.0 262144
layer3.1.conv3.weight, mask/weight parameters,52751,52238 density 0.4056271530511811,0.4016824557086614
before tensor 262144 mask 29927.0 262144
layer3.2.conv1.weight, mask/weight parameters,29927,29754 density 0.23012272391732283,0.22879244586614172
before tensor 589824 mask 53164.0 589824
layer3.2.conv2.weight, mask/weight parameters,53164,52639 density 0.3662416213721316,0.36262494747211715
before tensor 262144 mask 51117.0 262144
layer3.2.conv3.weight, mask/weight parameters,51117,50364 density 0.39306256151574803,0.38727239173228345
before tensor 262144 mask 34027.0 262144
layer3.3.conv1.weight, mask/weight parameters,34027,33615 density 0.2616495447834646,0.25848148375984253
before tensor 589824 mask 48051.0 589824
layer3.3.conv2.weight, mask/weight parameters,48051,47509 density 0.33101866203732405,0.3272848767919758
before tensor 262144 mask 43961.0 262144
layer3.3.conv3.weight, mask/weight parameters,43961,43431 density 0.3380367249015748,0.3339613065944882
before tensor 262144 mask 39631.0 262144
layer3.4.conv1.weight, mask/weight parameters,39631,38953 density 0.30474132627952755,0.2995278666338583
before tensor 589824 mask 49636.0 589824
layer3.4.conv2.weight, mask/weight parameters,49636,49049 density 0.3419375727640344,0.33789378689868493
before tensor 262144 mask 41161.0 262144
layer3.4.conv3.weight, mask/weight parameters,41161,40834 density 0.31650621309055116,0.3139917568897638
before tensor 262144 mask 45748.0 262144
layer3.5.conv1.weight, mask/weight parameters,45748,45290 density 0.35177780511811024,0.34825602854330706
before tensor 589824 mask 48932.0 589824
layer3.5.conv2.weight, mask/weight parameters,48932,48536 density 0.3370877852866817,0.3343597798306708
before tensor 262144 mask 39834.0 262144
layer3.5.conv3.weight, mask/weight parameters,39834,39467 density 0.3063022883858268,0.3034802534448819
before tensor 524288 mask 137654.0 524288
layer4.0.conv1.weight, mask/weight parameters,137654,136008 density 0.5819382440476191,0.5749797077922078
before tensor 2359296 mask 196920.0 2359296
layer4.0.conv2.weight, mask/weight parameters,196920,194588 density 0.41003729315417625,0.40518147877455235
before tensor 1048576 mask 104362.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104362,102250 density 0.22059743641774893,0.2161331507034632
layer4.0.shortcut.0.weight, mask/weight parameters,137597,136092 density 0.06561136245727539,0.06489372253417969
before tensor 1048576 mask 120518.0 1048576
layer4.1.conv1.weight, mask/weight parameters,120518,117716 density 0.2547475311147186,0.24882474296536797
before tensor 2359296 mask 195992.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195992,192693 density 0.40810496221751635,0.4012356090278168
before tensor 1048576 mask 83610.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83610,82393 density 0.17673244724025974,0.17415998714826839
before tensor 1048576 mask 81744.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81744,80049 density 0.17278814935064934,0.16920530641233766
before tensor 2359296 mask 70498.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70498,68899 density 0.1467946835912204,0.1434651607811781
before tensor 1048576 mask 35787.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35787,35499 density 0.07564554586038962,0.07503677962662338
classifier.weight, mask/weight parameters,105314,105262 density 0.514228515625,0.513974609375
Total Model parameters after dst: 2365202 2337202
Total parameters under density level of 0.1: 0.23656789208704473 0.23376732749322263 after dst
Death rate: 0.10232814133678823


Training summary: Average loss: 0.0487, Accuracy: 49611/50000 (99.222%)


Evaluation: Average loss: 0.9969, Accuracy: 7620/10000 (76.200%)

Current learning rate: 0.001. Time taken for epoch: 89.11 seconds.

Train Epoch: 148 [0/50000 (0%)]	Loss: 0.027135 Accuracy: 100/100 (100.000%
Train Epoch: 148 [10000/50000 (20%)]	Loss: 0.022173 Accuracy: 10036/10100 (99.366%
Train Epoch: 148 [20000/50000 (40%)]	Loss: 0.048143 Accuracy: 19961/20100 (99.308%
Train Epoch: 148 [30000/50000 (60%)]	Loss: 0.024149 Accuracy: 29906/30100 (99.355%
Train Epoch: 148 [40000/50000 (80%)]	Loss: 0.030930 Accuracy: 39819/40100 (99.299%

Training summary: Average loss: 0.0472, Accuracy: 49639/50000 (99.278%)


Evaluation: Average loss: 0.9968, Accuracy: 7635/10000 (76.350%)

Current learning rate: 0.001. Time taken for epoch: 88.44 seconds.

Train Epoch: 149 [0/50000 (0%)]	Loss: 0.065060 Accuracy: 97/100 (97.000%
Train Epoch: 149 [10000/50000 (20%)]	Loss: 0.036795 Accuracy: 10013/10100 (99.139%
Train Epoch: 149 [20000/50000 (40%)]	Loss: 0.087225 Accuracy: 19947/20100 (99.239%
Train Epoch: 149 [30000/50000 (60%)]	Loss: 0.031827 Accuracy: 29885/30100 (99.286%
Train Epoch: 149 [40000/50000 (80%)]	Loss: 0.048964 Accuracy: 39794/40100 (99.237%
current dst rate 0.009755643100199147


dynamic sparse change
conv1.weight, mask/weight parameters,1176,1176 density 0.6805555555555556,0.6805555555555556
before tensor 4096 mask 665.0 4096
layer1.0.conv1.weight, mask/weight parameters,665,665 density 0.22107712765957446,0.22107712765957446
before tensor 36864 mask 3657.0 36864
layer1.0.conv2.weight, mask/weight parameters,3657,3657 density 0.1839444695940848,0.1839444695940848
before tensor 16384 mask 3723.0 16384
layer1.0.conv3.weight, mask/weight parameters,3723,3723 density 0.3094248670212766,0.3094248670212766
layer1.0.shortcut.0.weight, mask/weight parameters,5578,5578 density 0.3404541015625,0.3404541015625
before tensor 16384 mask 2410.0 16384
layer1.1.conv1.weight, mask/weight parameters,2410,2410 density 0.2002992021276596,0.2002992021276596
before tensor 36864 mask 3950.0 36864
layer1.1.conv2.weight, mask/weight parameters,3950,3950 density 0.19868215884512852,0.19868215884512852
before tensor 16384 mask 2179.0 16384
layer1.1.conv3.weight, mask/weight parameters,2179,2179 density 0.18110039893617022,0.18110039893617022
before tensor 16384 mask 2850.0 16384
layer1.2.conv1.weight, mask/weight parameters,2850,2850 density 0.23686835106382978,0.23686835106382978
before tensor 36864 mask 3419.0 36864
layer1.2.conv2.weight, mask/weight parameters,3419,3419 density 0.1719732407826568,0.1719732407826568
before tensor 16384 mask 1835.0 16384
layer1.2.conv3.weight, mask/weight parameters,1835,1835 density 0.15250997340425532,0.15250997340425532
before tensor 32768 mask 5271.0 32768
layer2.0.conv1.weight, mask/weight parameters,5271,5271 density 0.27453125,0.27453125
before tensor 147456 mask 12419.0 147456
layer2.0.conv2.weight, mask/weight parameters,12419,12419 density 0.24531358024691358,0.24531358024691358
before tensor 65536 mask 6827.0 65536
layer2.0.conv3.weight, mask/weight parameters,6827,6827 density 0.17778645833333334,0.17778645833333334
layer2.0.shortcut.0.weight, mask/weight parameters,29451,29451 density 0.22469329833984375,0.22469329833984375
before tensor 65536 mask 3554.0 65536
layer2.1.conv1.weight, mask/weight parameters,3554,3554 density 0.09255208333333333,0.09255208333333333
before tensor 147456 mask 4162.0 147456
layer2.1.conv2.weight, mask/weight parameters,4162,4162 density 0.08221234567901235,0.08221234567901235
before tensor 65536 mask 4161.0 65536
layer2.1.conv3.weight, mask/weight parameters,4161,4161 density 0.108359375,0.108359375
before tensor 65536 mask 10310.0 65536
layer2.2.conv1.weight, mask/weight parameters,10310,10310 density 0.26848958333333334,0.26848958333333334
before tensor 147456 mask 21066.0 147456
layer2.2.conv2.weight, mask/weight parameters,21066,21066 density 0.4161185185185185,0.4161185185185185
before tensor 65536 mask 13072.0 65536
layer2.2.conv3.weight, mask/weight parameters,13072,13072 density 0.34041666666666665,0.34041666666666665
before tensor 65536 mask 10504.0 65536
layer2.3.conv1.weight, mask/weight parameters,10504,10504 density 0.2735416666666667,0.2735416666666667
before tensor 147456 mask 20099.0 147456
layer2.3.conv2.weight, mask/weight parameters,20099,20099 density 0.3970172839506173,0.3970172839506173
before tensor 65536 mask 10875.0 65536
layer2.3.conv3.weight, mask/weight parameters,10875,10875 density 0.283203125,0.283203125
before tensor 131072 mask 29390.0 131072
layer3.0.conv1.weight, mask/weight parameters,29390,29390 density 0.4519869586614173,0.4519869586614173
before tensor 589824 mask 60743.0 589824
layer3.0.conv2.weight, mask/weight parameters,60743,60743 density 0.41845261468300715,0.41845261468300715
before tensor 262144 mask 57156.0 262144
layer3.0.conv3.weight, mask/weight parameters,57156,57156 density 0.4394992618110236,0.4394992618110236
layer3.0.shortcut.0.weight, mask/weight parameters,95846,95846 density 0.18281173706054688,0.18281173706054688
before tensor 262144 mask 27577.0 262144
layer3.1.conv1.weight, mask/weight parameters,27577,27577 density 0.21205247293307086,0.21205247293307086
before tensor 589824 mask 60200.0 589824
layer3.1.conv2.weight, mask/weight parameters,60200,60200 density 0.41471194053499216,0.41471194053499216
before tensor 262144 mask 52250.0 262144
layer3.1.conv3.weight, mask/weight parameters,52250,52250 density 0.4017747293307087,0.4017747293307087
before tensor 262144 mask 29739.0 262144
layer3.2.conv1.weight, mask/weight parameters,29739,29739 density 0.22867710383858267,0.22867710383858267
before tensor 589824 mask 52721.0 589824
layer3.2.conv2.weight, mask/weight parameters,52721,52721 density 0.3631898374907861,0.3631898374907861
before tensor 262144 mask 50578.0 262144
layer3.2.conv3.weight, mask/weight parameters,50578,50578 density 0.388917937992126,0.388917937992126
before tensor 262144 mask 33633.0 262144
layer3.3.conv1.weight, mask/weight parameters,33633,33633 density 0.25861989419291337,0.25861989419291337
before tensor 589824 mask 47582.0 589824
layer3.3.conv2.weight, mask/weight parameters,47582,47582 density 0.3277877666866445,0.3277877666866445
before tensor 262144 mask 43539.0 262144
layer3.3.conv3.weight, mask/weight parameters,43539,43539 density 0.33479176919291337,0.33479176919291337
before tensor 262144 mask 39091.0 262144
layer3.4.conv1.weight, mask/weight parameters,39091,39091 density 0.30058901328740156,0.30058901328740156
before tensor 589824 mask 49165.0 589824
layer3.4.conv2.weight, mask/weight parameters,49165,49165 density 0.33869289960802146,0.33869289960802146
before tensor 262144 mask 40825.0 262144
layer3.4.conv3.weight, mask/weight parameters,40825,40825 density 0.31392255167322836,0.31392255167322836
before tensor 262144 mask 45294.0 262144
layer3.5.conv1.weight, mask/weight parameters,45294,45294 density 0.34828678641732286,0.34828678641732286
before tensor 589824 mask 48583.0 589824
layer3.5.conv2.weight, mask/weight parameters,48583,48583 density 0.3346835582560054,0.3346835582560054
before tensor 262144 mask 39531.0 262144
layer3.5.conv3.weight, mask/weight parameters,39531,39531 density 0.30397237942913385,0.30397237942913385
before tensor 524288 mask 136280.0 524288
layer4.0.conv1.weight, mask/weight parameters,136280,136280 density 0.5761295995670995,0.5761295995670995
before tensor 2359296 mask 194911.0 2359296
layer4.0.conv2.weight, mask/weight parameters,194911,194911 density 0.4058540465466872,0.4058540465466872
before tensor 1048576 mask 102757.0 1048576
layer4.0.conv3.weight, mask/weight parameters,102757,102757 density 0.21720483292748918,0.21720483292748918
layer4.0.shortcut.0.weight, mask/weight parameters,136338,136338 density 0.06501102447509766,0.06501102447509766
before tensor 1048576 mask 118348.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118348,118348 density 0.25016064664502163,0.25016064664502163
before tensor 2359296 mask 193388.0 2359296
layer4.1.conv2.weight, mask/weight parameters,193388,193388 density 0.4026827749771473,0.4026827749771473
before tensor 1048576 mask 82699.0 1048576
layer4.1.conv3.weight, mask/weight parameters,82699,82699 density 0.17480680127164502,0.17480680127164502
before tensor 1048576 mask 80495.0 1048576
layer4.2.conv1.weight, mask/weight parameters,80495,80495 density 0.1701480485660173,0.1701480485660173
before tensor 2359296 mask 69397.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69397,69397 density 0.1445021228571012,0.1445021228571012
before tensor 1048576 mask 35598.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35598,35598 density 0.07524604301948051,0.07524604301948051
classifier.weight, mask/weight parameters,105261,105261 density 0.5139697265625,0.5139697265625
Total Model parameters after dst: 2342128 2342128
Total parameters under density level of 0.1: 0.2342600268214072 0.2342600268214072 after dst
Death rate: 0.1028635997990712

self.baseline_nonzero-self.total_nonzero 23075.200000001118
len(all_scores) 9997984 6675899
increse 23075.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1178,1176 density 0.6817129629629629,0.6805555555555556
before tensor 4096 mask 669.0 4096
layer1.0.conv1.weight, mask/weight parameters,669,665 density 0.22240691489361702,0.22107712765957446
before tensor 36864 mask 3659.0 36864
layer1.0.conv2.weight, mask/weight parameters,3659,3657 density 0.18404506815552538,0.1839444695940848
before tensor 16384 mask 3727.0 16384
layer1.0.conv3.weight, mask/weight parameters,3727,3723 density 0.3097573138297872,0.3094248670212766
layer1.0.shortcut.0.weight, mask/weight parameters,5633,5578 density 0.34381103515625,0.3404541015625
before tensor 16384 mask 2439.0 16384
layer1.1.conv1.weight, mask/weight parameters,2439,2410 density 0.2027094414893617,0.2002992021276596
before tensor 36864 mask 3963.0 36864
layer1.1.conv2.weight, mask/weight parameters,3963,3950 density 0.19933604949449224,0.19868215884512852
before tensor 16384 mask 2181.0 16384
layer1.1.conv3.weight, mask/weight parameters,2181,2179 density 0.18126662234042554,0.18110039893617022
before tensor 16384 mask 2851.0 16384
layer1.2.conv1.weight, mask/weight parameters,2851,2850 density 0.23695146276595744,0.23686835106382978
before tensor 36864 mask 3426.0 36864
layer1.2.conv2.weight, mask/weight parameters,3426,3419 density 0.17232533574769882,0.1719732407826568
before tensor 16384 mask 1840.0 16384
layer1.2.conv3.weight, mask/weight parameters,1840,1835 density 0.1529255319148936,0.15250997340425532
before tensor 32768 mask 5361.0 32768
layer2.0.conv1.weight, mask/weight parameters,5361,5271 density 0.27921875,0.27453125
before tensor 147456 mask 12424.0 147456
layer2.0.conv2.weight, mask/weight parameters,12424,12419 density 0.24541234567901235,0.24531358024691358
before tensor 65536 mask 6837.0 65536
layer2.0.conv3.weight, mask/weight parameters,6837,6827 density 0.178046875,0.17778645833333334
layer2.0.shortcut.0.weight, mask/weight parameters,29515,29451 density 0.22518157958984375,0.22469329833984375
before tensor 65536 mask 3568.0 65536
layer2.1.conv1.weight, mask/weight parameters,3568,3554 density 0.09291666666666666,0.09255208333333333
before tensor 147456 mask 4172.0 147456
layer2.1.conv2.weight, mask/weight parameters,4172,4162 density 0.08240987654320987,0.08221234567901235
before tensor 65536 mask 4171.0 65536
layer2.1.conv3.weight, mask/weight parameters,4171,4161 density 0.10861979166666667,0.108359375
before tensor 65536 mask 10324.0 65536
layer2.2.conv1.weight, mask/weight parameters,10324,10310 density 0.26885416666666667,0.26848958333333334
before tensor 147456 mask 21102.0 147456
layer2.2.conv2.weight, mask/weight parameters,21102,21066 density 0.4168296296296296,0.4161185185185185
before tensor 65536 mask 13097.0 65536
layer2.2.conv3.weight, mask/weight parameters,13097,13072 density 0.34106770833333333,0.34041666666666665
before tensor 65536 mask 10519.0 65536
layer2.3.conv1.weight, mask/weight parameters,10519,10504 density 0.27393229166666666,0.2735416666666667
before tensor 147456 mask 20155.0 147456
layer2.3.conv2.weight, mask/weight parameters,20155,20099 density 0.39812345679012345,0.3970172839506173
before tensor 65536 mask 10916.0 65536
layer2.3.conv3.weight, mask/weight parameters,10916,10875 density 0.2842708333333333,0.283203125
before tensor 131072 mask 29481.0 131072
layer3.0.conv1.weight, mask/weight parameters,29481,29390 density 0.45338644192913385,0.4519869586614173
before tensor 589824 mask 60863.0 589824
layer3.0.conv2.weight, mask/weight parameters,60863,60743 density 0.41927928300301043,0.41845261468300715
before tensor 262144 mask 57442.0 262144
layer3.0.conv3.weight, mask/weight parameters,57442,57156 density 0.4416984498031496,0.4394992618110236
layer3.0.shortcut.0.weight, mask/weight parameters,96113,95846 density 0.1833209991455078,0.18281173706054688
before tensor 262144 mask 27731.0 262144
layer3.1.conv1.weight, mask/weight parameters,27731,27577 density 0.21323665108267717,0.21205247293307086
before tensor 589824 mask 60700.0 589824
layer3.1.conv2.weight, mask/weight parameters,60700,60200 density 0.4181563918683393,0.41471194053499216
before tensor 262144 mask 53039.0 262144
layer3.1.conv3.weight, mask/weight parameters,53039,52250 density 0.407841719980315,0.4017747293307087
before tensor 262144 mask 30127.0 262144
layer3.2.conv1.weight, mask/weight parameters,30127,29739 density 0.23166061761811024,0.22867710383858267
before tensor 589824 mask 53044.0 589824
layer3.2.conv2.weight, mask/weight parameters,53044,52721 density 0.36541495305212834,0.3631898374907861
before tensor 262144 mask 50818.0 262144
layer3.2.conv3.weight, mask/weight parameters,50818,50578 density 0.3907634104330709,0.388917937992126
before tensor 262144 mask 33854.0 262144
layer3.3.conv1.weight, mask/weight parameters,33854,33633 density 0.26031926673228345,0.25861989419291337
before tensor 589824 mask 48101.0 589824
layer3.3.conv2.weight, mask/weight parameters,48101,47582 density 0.3313631071706588,0.3277877666866445
before tensor 262144 mask 43932.0 262144
layer3.3.conv3.weight, mask/weight parameters,43932,43539 density 0.33781373031496065,0.33479176919291337
before tensor 262144 mask 39437.0 262144
layer3.4.conv1.weight, mask/weight parameters,39437,39091 density 0.3032495693897638,0.30058901328740156
before tensor 589824 mask 49514.0 589824
layer3.4.conv2.weight, mask/weight parameters,49514,49165 density 0.34109712663869773,0.33869289960802146
before tensor 262144 mask 41289.0 262144
layer3.4.conv3.weight, mask/weight parameters,41289,40825 density 0.3174904650590551,0.31392255167322836
before tensor 262144 mask 45755.0 262144
layer3.5.conv1.weight, mask/weight parameters,45755,45294 density 0.3518316313976378,0.34828678641732286
before tensor 589824 mask 49030.0 589824
layer3.5.conv2.weight, mask/weight parameters,49030,48583 density 0.3377628977480177,0.3346835582560054
before tensor 262144 mask 39914.0 262144
layer3.5.conv3.weight, mask/weight parameters,39914,39531 density 0.3069174458661417,0.30397237942913385
before tensor 524288 mask 137475.0 524288
layer4.0.conv1.weight, mask/weight parameters,137475,136280 density 0.5811815137987013,0.5761295995670995
before tensor 2359296 mask 197162.0 2359296
layer4.0.conv2.weight, mask/weight parameters,197162,194911 density 0.4105411984199863,0.4058540465466872
before tensor 1048576 mask 104307.0 1048576
layer4.0.conv3.weight, mask/weight parameters,104307,102757 density 0.22048117897727273,0.21720483292748918
layer4.0.shortcut.0.weight, mask/weight parameters,137752,136338 density 0.06568527221679688,0.06501102447509766
before tensor 1048576 mask 120310.0 1048576
layer4.1.conv1.weight, mask/weight parameters,120310,118348 density 0.2543078666125541,0.25016064664502163
before tensor 2359296 mask 196427.0 2359296
layer4.1.conv2.weight, mask/weight parameters,196427,193388 density 0.4090107423440757,0.4026827749771473
before tensor 1048576 mask 83920.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83920,82699 density 0.17738771645021645,0.17480680127164502
before tensor 1048576 mask 82418.0 1048576
layer4.2.conv1.weight, mask/weight parameters,82418,80495 density 0.17421283143939395,0.1701480485660173
before tensor 2359296 mask 70309.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70309,69397 density 0.14640113774312907,0.1445021228571012
before tensor 1048576 mask 35846.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35846,35598 density 0.07577025838744589,0.07524604301948051
classifier.weight, mask/weight parameters,105365,105261 density 0.5144775390625,0.5139697265625
Total Model parameters after dst: 2365202 2342128
Total parameters under density level of 0.1: 0.23656789208704473 0.2342600268214072 after dst
Death rate: 0.1028635997990712


Training summary: Average loss: 0.0473, Accuracy: 49614/50000 (99.228%)


Evaluation: Average loss: 0.9858, Accuracy: 7641/10000 (76.410%)

Current learning rate: 0.001. Time taken for epoch: 88.74 seconds.

Train Epoch: 150 [0/50000 (0%)]	Loss: 0.020161 Accuracy: 100/100 (100.000%
Train Epoch: 150 [10000/50000 (20%)]	Loss: 0.042867 Accuracy: 10034/10100 (99.347%
Train Epoch: 150 [20000/50000 (40%)]	Loss: 0.065145 Accuracy: 19956/20100 (99.284%
Train Epoch: 150 [30000/50000 (60%)]	Loss: 0.038911 Accuracy: 29885/30100 (99.286%
Train Epoch: 150 [40000/50000 (80%)]	Loss: 0.066805 Accuracy: 39819/40100 (99.299%

Training summary: Average loss: 0.0468, Accuracy: 49655/50000 (99.310%)


Evaluation: Average loss: 1.0006, Accuracy: 7644/10000 (76.440%)

Current learning rate: 0.001. Time taken for epoch: 88.36 seconds.

Train Epoch: 151 [0/50000 (0%)]	Loss: 0.030502 Accuracy: 100/100 (100.000%
Train Epoch: 151 [10000/50000 (20%)]	Loss: 0.040276 Accuracy: 10024/10100 (99.248%
Train Epoch: 151 [20000/50000 (40%)]	Loss: 0.053300 Accuracy: 19940/20100 (99.204%
Train Epoch: 151 [30000/50000 (60%)]	Loss: 0.050771 Accuracy: 29880/30100 (99.269%
Train Epoch: 151 [40000/50000 (80%)]	Loss: 0.036986 Accuracy: 39816/40100 (99.292%
current dst rate 0.008047135702702556


dynamic sparse change
conv1.weight, mask/weight parameters,1176,1176 density 0.6805555555555556,0.6805555555555556
before tensor 4096 mask 668.0 4096
layer1.0.conv1.weight, mask/weight parameters,668,668 density 0.2220744680851064,0.2220744680851064
before tensor 36864 mask 3655.0 36864
layer1.0.conv2.weight, mask/weight parameters,3655,3655 density 0.18384387103264424,0.18384387103264424
before tensor 16384 mask 3722.0 16384
layer1.0.conv3.weight, mask/weight parameters,3722,3722 density 0.3093417553191489,0.3093417553191489
layer1.0.shortcut.0.weight, mask/weight parameters,5584,5584 density 0.3408203125,0.3408203125
before tensor 16384 mask 2420.0 16384
layer1.1.conv1.weight, mask/weight parameters,2420,2420 density 0.20113031914893617,0.20113031914893617
before tensor 36864 mask 3956.0 36864
layer1.1.conv2.weight, mask/weight parameters,3956,3956 density 0.19898395452945022,0.19898395452945022
before tensor 16384 mask 2179.0 16384
layer1.1.conv3.weight, mask/weight parameters,2179,2179 density 0.18110039893617022,0.18110039893617022
before tensor 16384 mask 2843.0 16384
layer1.2.conv1.weight, mask/weight parameters,2843,2843 density 0.23628656914893617,0.23628656914893617
before tensor 36864 mask 3421.0 36864
layer1.2.conv2.weight, mask/weight parameters,3421,3421 density 0.17207383934409737,0.17207383934409737
before tensor 16384 mask 1837.0 16384
layer1.2.conv3.weight, mask/weight parameters,1837,1837 density 0.15267619680851063,0.15267619680851063
before tensor 32768 mask 5314.0 32768
layer2.0.conv1.weight, mask/weight parameters,5314,5314 density 0.27677083333333335,0.27677083333333335
before tensor 147456 mask 12398.0 147456
layer2.0.conv2.weight, mask/weight parameters,12398,12398 density 0.24489876543209876,0.24489876543209876
before tensor 65536 mask 6824.0 65536
layer2.0.conv3.weight, mask/weight parameters,6824,6824 density 0.17770833333333333,0.17770833333333333
layer2.0.shortcut.0.weight, mask/weight parameters,29431,29431 density 0.22454071044921875,0.22454071044921875
before tensor 65536 mask 3553.0 65536
layer2.1.conv1.weight, mask/weight parameters,3553,3553 density 0.09252604166666667,0.09252604166666667
before tensor 147456 mask 4155.0 147456
layer2.1.conv2.weight, mask/weight parameters,4155,4155 density 0.08207407407407408,0.08207407407407408
before tensor 65536 mask 4150.0 65536
layer2.1.conv3.weight, mask/weight parameters,4150,4150 density 0.10807291666666667,0.10807291666666667
before tensor 65536 mask 10291.0 65536
layer2.2.conv1.weight, mask/weight parameters,10291,10291 density 0.2679947916666667,0.2679947916666667
before tensor 147456 mask 21060.0 147456
layer2.2.conv2.weight, mask/weight parameters,21060,21060 density 0.416,0.416
before tensor 65536 mask 13064.0 65536
layer2.2.conv3.weight, mask/weight parameters,13064,13064 density 0.34020833333333333,0.34020833333333333
before tensor 65536 mask 10502.0 65536
layer2.3.conv1.weight, mask/weight parameters,10502,10502 density 0.27348958333333334,0.27348958333333334
before tensor 147456 mask 20106.0 147456
layer2.3.conv2.weight, mask/weight parameters,20106,20106 density 0.39715555555555554,0.39715555555555554
before tensor 65536 mask 10875.0 65536
layer2.3.conv3.weight, mask/weight parameters,10875,10875 density 0.283203125,0.283203125
before tensor 131072 mask 29324.0 131072
layer3.0.conv1.weight, mask/weight parameters,29324,29324 density 0.4509719488188976,0.4509719488188976
before tensor 589824 mask 60698.0 589824
layer3.0.conv2.weight, mask/weight parameters,60698,60698 density 0.4181426140630059,0.4181426140630059
before tensor 262144 mask 57169.0 262144
layer3.0.conv3.weight, mask/weight parameters,57169,57169 density 0.4395992249015748,0.4395992249015748
layer3.0.shortcut.0.weight, mask/weight parameters,95744,95744 density 0.1826171875,0.1826171875
before tensor 262144 mask 27578.0 262144
layer3.1.conv1.weight, mask/weight parameters,27578,27578 density 0.2120601624015748,0.2120601624015748
before tensor 589824 mask 60241.0 589824
layer3.1.conv2.weight, mask/weight parameters,60241,60241 density 0.41499438554432666,0.41499438554432666
before tensor 262144 mask 52518.0 262144
layer3.1.conv3.weight, mask/weight parameters,52518,52518 density 0.4038355068897638,0.4038355068897638
before tensor 262144 mask 29873.0 262144
layer3.2.conv1.weight, mask/weight parameters,29873,29873 density 0.22970749261811024,0.22970749261811024
before tensor 589824 mask 52727.0 589824
layer3.2.conv2.weight, mask/weight parameters,52727,52727 density 0.36323117090678625,0.36323117090678625
before tensor 262144 mask 50501.0 262144
layer3.2.conv3.weight, mask/weight parameters,50501,50501 density 0.38832584891732286,0.38832584891732286
before tensor 262144 mask 33629.0 262144
layer3.3.conv1.weight, mask/weight parameters,33629,33629 density 0.2585891363188976,0.2585891363188976
before tensor 589824 mask 47713.0 589824
layer3.3.conv2.weight, mask/weight parameters,47713,47713 density 0.32869021293598144,0.32869021293598144
before tensor 262144 mask 43600.0 262144
layer3.3.conv3.weight, mask/weight parameters,43600,43600 density 0.33526082677165353,0.33526082677165353
before tensor 262144 mask 39085.0 262144
layer3.4.conv1.weight, mask/weight parameters,39085,39085 density 0.30054287647637795,0.30054287647637795
before tensor 589824 mask 49167.0 589824
layer3.4.conv2.weight, mask/weight parameters,49167,49167 density 0.3387066774133548,0.3387066774133548
before tensor 262144 mask 40967.0 262144
layer3.4.conv3.weight, mask/weight parameters,40967,40967 density 0.3150144562007874,0.3150144562007874
before tensor 262144 mask 45369.0 262144
layer3.5.conv1.weight, mask/weight parameters,45369,45369 density 0.3488634965551181,0.3488634965551181
before tensor 589824 mask 48674.0 589824
layer3.5.conv2.weight, mask/weight parameters,48674,48674 density 0.3353104483986746,0.3353104483986746
before tensor 262144 mask 39615.0 262144
layer3.5.conv3.weight, mask/weight parameters,39615,39615 density 0.3046182947834646,0.3046182947834646
before tensor 524288 mask 136443.0 524288
layer4.0.conv1.weight, mask/weight parameters,136443,136443 density 0.5768186891233766,0.5768186891233766
before tensor 2359296 mask 195453.0 2359296
layer4.0.conv2.weight, mask/weight parameters,195453,195453 density 0.4069826277618485,0.4069826277618485
before tensor 1048576 mask 103089.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103089,103089 density 0.21790660511363635,0.21790660511363635
layer4.0.shortcut.0.weight, mask/weight parameters,136563,136563 density 0.06511831283569336,0.06511831283569336
before tensor 1048576 mask 118669.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118669,118669 density 0.2508391673430736,0.2508391673430736
before tensor 2359296 mask 194102.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194102,194102 density 0.4041695037366033,0.4041695037366033
before tensor 1048576 mask 83000.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83000,83000 density 0.17544304653679654,0.17544304653679654
before tensor 1048576 mask 80996.0 1048576
layer4.2.conv1.weight, mask/weight parameters,80996,80996 density 0.17120704816017315,0.17120704816017315
before tensor 2359296 mask 69517.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69517,69517 density 0.1447519932368417,0.1447519932368417
before tensor 1048576 mask 35684.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35684,35684 density 0.07542782738095238,0.07542782738095238
classifier.weight, mask/weight parameters,105277,105277 density 0.5140478515625,0.5140478515625
Total Model parameters after dst: 2346169 2346169
Total parameters under density level of 0.1: 0.23466420830439416 0.23466420830439416 after dst
Death rate: 0.10345075885870102

self.baseline_nonzero-self.total_nonzero 19034.200000001118
len(all_scores) 9997984 6672095
increse 19034.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1178,1176 density 0.6817129629629629,0.6805555555555556
before tensor 4096 mask 668.0 4096
layer1.0.conv1.weight, mask/weight parameters,668,668 density 0.2220744680851064,0.2220744680851064
before tensor 36864 mask 3660.0 36864
layer1.0.conv2.weight, mask/weight parameters,3660,3655 density 0.18409536743624566,0.18384387103264424
before tensor 16384 mask 3731.0 16384
layer1.0.conv3.weight, mask/weight parameters,3731,3722 density 0.31008976063829785,0.3093417553191489
layer1.0.shortcut.0.weight, mask/weight parameters,5595,5584 density 0.34149169921875,0.3408203125
before tensor 16384 mask 2420.0 16384
layer1.1.conv1.weight, mask/weight parameters,2420,2420 density 0.20113031914893617,0.20113031914893617
before tensor 36864 mask 3961.0 36864
layer1.1.conv2.weight, mask/weight parameters,3961,3956 density 0.19923545093305164,0.19898395452945022
before tensor 16384 mask 2181.0 16384
layer1.1.conv3.weight, mask/weight parameters,2181,2179 density 0.18126662234042554,0.18110039893617022
before tensor 16384 mask 2846.0 16384
layer1.2.conv1.weight, mask/weight parameters,2846,2843 density 0.23653590425531915,0.23628656914893617
before tensor 36864 mask 3423.0 36864
layer1.2.conv2.weight, mask/weight parameters,3423,3421 density 0.17217443790553796,0.17207383934409737
before tensor 16384 mask 1849.0 16384
layer1.2.conv3.weight, mask/weight parameters,1849,1837 density 0.15367353723404256,0.15267619680851063
before tensor 32768 mask 5317.0 32768
layer2.0.conv1.weight, mask/weight parameters,5317,5314 density 0.2769270833333333,0.27677083333333335
before tensor 147456 mask 12415.0 147456
layer2.0.conv2.weight, mask/weight parameters,12415,12398 density 0.24523456790123457,0.24489876543209876
before tensor 65536 mask 6842.0 65536
layer2.0.conv3.weight, mask/weight parameters,6842,6824 density 0.17817708333333335,0.17770833333333333
layer2.0.shortcut.0.weight, mask/weight parameters,29480,29431 density 0.22491455078125,0.22454071044921875
before tensor 65536 mask 3560.0 65536
layer2.1.conv1.weight, mask/weight parameters,3560,3553 density 0.09270833333333334,0.09252604166666667
before tensor 147456 mask 4162.0 147456
layer2.1.conv2.weight, mask/weight parameters,4162,4155 density 0.08221234567901235,0.08207407407407408
before tensor 65536 mask 4171.0 65536
layer2.1.conv3.weight, mask/weight parameters,4171,4150 density 0.10861979166666667,0.10807291666666667
before tensor 65536 mask 10312.0 65536
layer2.2.conv1.weight, mask/weight parameters,10312,10291 density 0.2685416666666667,0.2679947916666667
before tensor 147456 mask 21104.0 147456
layer2.2.conv2.weight, mask/weight parameters,21104,21060 density 0.41686913580246915,0.416
before tensor 65536 mask 13100.0 65536
layer2.2.conv3.weight, mask/weight parameters,13100,13064 density 0.3411458333333333,0.34020833333333333
before tensor 65536 mask 10540.0 65536
layer2.3.conv1.weight, mask/weight parameters,10540,10502 density 0.27447916666666666,0.27348958333333334
before tensor 147456 mask 20154.0 147456
layer2.3.conv2.weight, mask/weight parameters,20154,20106 density 0.3981037037037037,0.39715555555555554
before tensor 65536 mask 10898.0 65536
layer2.3.conv3.weight, mask/weight parameters,10898,10875 density 0.28380208333333334,0.283203125
before tensor 131072 mask 29454.0 131072
layer3.0.conv1.weight, mask/weight parameters,29454,29324 density 0.45297121062992124,0.4509719488188976
before tensor 589824 mask 60833.0 589824
layer3.0.conv2.weight, mask/weight parameters,60833,60698 density 0.41907261592300965,0.4181426140630059
before tensor 262144 mask 57525.0 262144
layer3.0.conv3.weight, mask/weight parameters,57525,57169 density 0.4423366756889764,0.4395992249015748
layer3.0.shortcut.0.weight, mask/weight parameters,96031,95744 density 0.1831645965576172,0.1826171875
before tensor 262144 mask 27745.0 262144
layer3.1.conv1.weight, mask/weight parameters,27745,27578 density 0.2133443036417323,0.2120601624015748
before tensor 589824 mask 60916.0 589824
layer3.1.conv2.weight, mask/weight parameters,60916,60241 density 0.41964439484434524,0.41499438554432666
before tensor 262144 mask 53143.0 262144
layer3.1.conv3.weight, mask/weight parameters,53143,52518 density 0.4086414247047244,0.4038355068897638
before tensor 262144 mask 30034.0 262144
layer3.2.conv1.weight, mask/weight parameters,30034,29873 density 0.2309454970472441,0.22970749261811024
before tensor 589824 mask 52973.0 589824
layer3.2.conv2.weight, mask/weight parameters,52973,52727 density 0.364925840962793,0.36323117090678625
before tensor 262144 mask 50987.0 262144
layer3.2.conv3.weight, mask/weight parameters,50987,50501 density 0.3920629306102362,0.38832584891732286
before tensor 262144 mask 33839.0 262144
layer3.3.conv1.weight, mask/weight parameters,33839,33629 density 0.2602039247047244,0.2585891363188976
before tensor 589824 mask 48091.0 589824
layer3.3.conv2.weight, mask/weight parameters,48091,47713 density 0.33129421814399185,0.32869021293598144
before tensor 262144 mask 44192.0 262144
layer3.3.conv3.weight, mask/weight parameters,44192,43600 density 0.33981299212598426,0.33526082677165353
before tensor 262144 mask 39349.0 262144
layer3.4.conv1.weight, mask/weight parameters,39349,39085 density 0.3025728961614173,0.30054287647637795
before tensor 589824 mask 49511.0 589824
layer3.4.conv2.weight, mask/weight parameters,49511,49167 density 0.34107645993069763,0.3387066774133548
before tensor 262144 mask 41333.0 262144
layer3.4.conv3.weight, mask/weight parameters,41333,40967 density 0.31782880167322836,0.3150144562007874
before tensor 262144 mask 45941.0 262144
layer3.5.conv1.weight, mask/weight parameters,45941,45369 density 0.3532618725393701,0.3488634965551181
before tensor 589824 mask 49269.0 589824
layer3.5.conv2.weight, mask/weight parameters,49269,48674 density 0.3394093454853576,0.3353104483986746
before tensor 262144 mask 40189.0 262144
layer3.5.conv3.weight, mask/weight parameters,40189,39615 density 0.3090320497047244,0.3046182947834646
before tensor 524288 mask 137851.0 524288
layer4.0.conv1.weight, mask/weight parameters,137851,136443 density 0.5827710700757576,0.5768186891233766
before tensor 2359296 mask 197453.0 2359296
layer4.0.conv2.weight, mask/weight parameters,197453,195453 density 0.411147134090857,0.4069826277618485
before tensor 1048576 mask 103781.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103781,103089 density 0.21936933509199133,0.21790660511363635
layer4.0.shortcut.0.weight, mask/weight parameters,137165,136563 density 0.06540536880493164,0.06511831283569336
before tensor 1048576 mask 119957.0 1048576
layer4.1.conv1.weight, mask/weight parameters,119957,118669 density 0.25356170522186144,0.2508391673430736
before tensor 2359296 mask 197119.0 2359296
layer4.1.conv2.weight, mask/weight parameters,197119,194102 density 0.4104516615339126,0.4041695037366033
before tensor 1048576 mask 83702.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83702,83000 density 0.17692691423160173,0.17544304653679654
before tensor 1048576 mask 81806.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81806,80996 density 0.1729192031926407,0.17120704816017315
before tensor 2359296 mask 70273.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70273,69517 density 0.14632617662920694,0.1447519932368417
before tensor 1048576 mask 35846.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35846,35684 density 0.07577025838744589,0.07542782738095238
classifier.weight, mask/weight parameters,105327,105277 density 0.5142919921875,0.5140478515625
Total Model parameters after dst: 2365202 2346169
Total parameters under density level of 0.1: 0.23656789208704473 0.23466420830439416 after dst
Death rate: 0.10345075885870102


Training summary: Average loss: 0.0455, Accuracy: 49647/50000 (99.294%)


Evaluation: Average loss: 0.9982, Accuracy: 7636/10000 (76.360%)

Current learning rate: 0.001. Time taken for epoch: 88.71 seconds.

Train Epoch: 152 [0/50000 (0%)]	Loss: 0.052066 Accuracy: 99/100 (99.000%
Train Epoch: 152 [10000/50000 (20%)]	Loss: 0.055507 Accuracy: 10023/10100 (99.238%
Train Epoch: 152 [20000/50000 (40%)]	Loss: 0.040191 Accuracy: 19950/20100 (99.254%
Train Epoch: 152 [30000/50000 (60%)]	Loss: 0.050847 Accuracy: 29882/30100 (99.276%
Train Epoch: 152 [40000/50000 (80%)]	Loss: 0.072889 Accuracy: 39806/40100 (99.267%

Training summary: Average loss: 0.0447, Accuracy: 49641/50000 (99.282%)


Evaluation: Average loss: 0.9974, Accuracy: 7655/10000 (76.550%)

Current learning rate: 0.001. Time taken for epoch: 88.36 seconds.

Train Epoch: 153 [0/50000 (0%)]	Loss: 0.065316 Accuracy: 98/100 (98.000%
Train Epoch: 153 [10000/50000 (20%)]	Loss: 0.031093 Accuracy: 10027/10100 (99.277%
Train Epoch: 153 [20000/50000 (40%)]	Loss: 0.030425 Accuracy: 19961/20100 (99.308%
Train Epoch: 153 [30000/50000 (60%)]	Loss: 0.034899 Accuracy: 29891/30100 (99.306%
Train Epoch: 153 [40000/50000 (80%)]	Loss: 0.058554 Accuracy: 39830/40100 (99.327%
current dst rate 0.00671555690365525


dynamic sparse change
conv1.weight, mask/weight parameters,1176,1176 density 0.6805555555555556,0.6805555555555556
before tensor 4096 mask 667.0 4096
layer1.0.conv1.weight, mask/weight parameters,667,667 density 0.22174202127659576,0.22174202127659576
before tensor 36864 mask 3657.0 36864
layer1.0.conv2.weight, mask/weight parameters,3657,3657 density 0.1839444695940848,0.1839444695940848
before tensor 16384 mask 3727.0 16384
layer1.0.conv3.weight, mask/weight parameters,3727,3727 density 0.3097573138297872,0.3097573138297872
layer1.0.shortcut.0.weight, mask/weight parameters,5573,5573 density 0.34014892578125,0.34014892578125
before tensor 16384 mask 2410.0 16384
layer1.1.conv1.weight, mask/weight parameters,2410,2410 density 0.2002992021276596,0.2002992021276596
before tensor 36864 mask 3959.0 36864
layer1.1.conv2.weight, mask/weight parameters,3959,3959 density 0.19913485237161108,0.19913485237161108
before tensor 16384 mask 2175.0 16384
layer1.1.conv3.weight, mask/weight parameters,2175,2175 density 0.1807679521276596,0.1807679521276596
before tensor 16384 mask 2837.0 16384
layer1.2.conv1.weight, mask/weight parameters,2837,2837 density 0.23578789893617022,0.23578789893617022
before tensor 36864 mask 3421.0 36864
layer1.2.conv2.weight, mask/weight parameters,3421,3421 density 0.17207383934409737,0.17207383934409737
before tensor 16384 mask 1845.0 16384
layer1.2.conv3.weight, mask/weight parameters,1845,1845 density 0.15334109042553193,0.15334109042553193
before tensor 32768 mask 5293.0 32768
layer2.0.conv1.weight, mask/weight parameters,5293,5293 density 0.27567708333333335,0.27567708333333335
before tensor 147456 mask 12394.0 147456
layer2.0.conv2.weight, mask/weight parameters,12394,12394 density 0.24481975308641976,0.24481975308641976
before tensor 65536 mask 6824.0 65536
layer2.0.conv3.weight, mask/weight parameters,6824,6824 density 0.17770833333333333,0.17770833333333333
layer2.0.shortcut.0.weight, mask/weight parameters,29394,29394 density 0.2242584228515625,0.2242584228515625
before tensor 65536 mask 3551.0 65536
layer2.1.conv1.weight, mask/weight parameters,3551,3551 density 0.09247395833333333,0.09247395833333333
before tensor 147456 mask 4151.0 147456
layer2.1.conv2.weight, mask/weight parameters,4151,4151 density 0.08199506172839506,0.08199506172839506
before tensor 65536 mask 4149.0 65536
layer2.1.conv3.weight, mask/weight parameters,4149,4149 density 0.108046875,0.108046875
before tensor 65536 mask 10282.0 65536
layer2.2.conv1.weight, mask/weight parameters,10282,10282 density 0.26776041666666667,0.26776041666666667
before tensor 147456 mask 21057.0 147456
layer2.2.conv2.weight, mask/weight parameters,21057,21057 density 0.4159407407407407,0.4159407407407407
before tensor 65536 mask 13058.0 65536
layer2.2.conv3.weight, mask/weight parameters,13058,13058 density 0.3400520833333333,0.3400520833333333
before tensor 65536 mask 10518.0 65536
layer2.3.conv1.weight, mask/weight parameters,10518,10518 density 0.27390625,0.27390625
before tensor 147456 mask 20099.0 147456
layer2.3.conv2.weight, mask/weight parameters,20099,20099 density 0.3970172839506173,0.3970172839506173
before tensor 65536 mask 10868.0 65536
layer2.3.conv3.weight, mask/weight parameters,10868,10868 density 0.28302083333333333,0.28302083333333333
before tensor 131072 mask 29338.0 131072
layer3.0.conv1.weight, mask/weight parameters,29338,29338 density 0.45118725393700787,0.45118725393700787
before tensor 589824 mask 60669.0 589824
layer3.0.conv2.weight, mask/weight parameters,60669,60669 density 0.41794283588567177,0.41794283588567177
before tensor 262144 mask 57251.0 262144
layer3.0.conv3.weight, mask/weight parameters,57251,57251 density 0.4402297613188976,0.4402297613188976
layer3.0.shortcut.0.weight, mask/weight parameters,95699,95699 density 0.18253135681152344,0.18253135681152344
before tensor 262144 mask 27617.0 262144
layer3.1.conv1.weight, mask/weight parameters,27617,27617 density 0.21236005167322836,0.21236005167322836
before tensor 589824 mask 60413.0 589824
layer3.1.conv2.weight, mask/weight parameters,60413,60413 density 0.41617927680299804,0.41617927680299804
before tensor 262144 mask 52691.0 262144
layer3.1.conv3.weight, mask/weight parameters,52691,52691 density 0.4051657849409449,0.4051657849409449
before tensor 262144 mask 29882.0 262144
layer3.2.conv1.weight, mask/weight parameters,29882,29882 density 0.22977669783464566,0.22977669783464566
before tensor 589824 mask 52702.0 589824
layer3.2.conv2.weight, mask/weight parameters,52702,52702 density 0.3630589483401189,0.3630589483401189
before tensor 262144 mask 50634.0 262144
layer3.2.conv3.weight, mask/weight parameters,50634,50634 density 0.38934854822834647,0.38934854822834647
before tensor 262144 mask 33657.0 262144
layer3.3.conv1.weight, mask/weight parameters,33657,33657 density 0.25880444143700787,0.25880444143700787
before tensor 589824 mask 47764.0 589824
layer3.3.conv2.weight, mask/weight parameters,47764,47764 density 0.32904154697198285,0.32904154697198285
before tensor 262144 mask 43813.0 262144
layer3.3.conv3.weight, mask/weight parameters,43813,43813 density 0.33689868356299213,0.33689868356299213
before tensor 262144 mask 39064.0 262144
layer3.4.conv1.weight, mask/weight parameters,39064,39064 density 0.30038139763779526,0.30038139763779526
before tensor 589824 mask 49197.0 589824
layer3.4.conv2.weight, mask/weight parameters,49197,49197 density 0.33891334449335564,0.33891334449335564
before tensor 262144 mask 41005.0 262144
layer3.4.conv3.weight, mask/weight parameters,41005,41005 density 0.315306656003937,0.315306656003937
before tensor 262144 mask 45539.0 262144
layer3.5.conv1.weight, mask/weight parameters,45539,45539 density 0.3501707062007874,0.3501707062007874
before tensor 589824 mask 48855.0 589824
layer3.5.conv2.weight, mask/weight parameters,48855,48855 density 0.3365573397813462,0.3365573397813462
before tensor 262144 mask 39857.0 262144
layer3.5.conv3.weight, mask/weight parameters,39857,39857 density 0.3064791461614173,0.3064791461614173
before tensor 524288 mask 136831.0 524288
layer4.0.conv1.weight, mask/weight parameters,136831,136831 density 0.5784589759199135,0.5784589759199135
before tensor 2359296 mask 195776.0 2359296
layer4.0.conv2.weight, mask/weight parameters,195776,195776 density 0.40765519553398344,0.40765519553398344
before tensor 1048576 mask 103021.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103021,103021 density 0.21776286864177488,0.21776286864177488
layer4.0.shortcut.0.weight, mask/weight parameters,136526,136526 density 0.06510066986083984,0.06510066986083984
before tensor 1048576 mask 118755.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118755,118755 density 0.25102095170454547,0.25102095170454547
before tensor 2359296 mask 194924.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194924,194924 density 0.40588111583782577,0.40588111583782577
before tensor 1048576 mask 83123.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83123,83123 density 0.1757030404491342,0.1757030404491342
before tensor 1048576 mask 80973.0 1048576
layer4.2.conv1.weight, mask/weight parameters,80973,80973 density 0.17115843141233766,0.17115843141233766
before tensor 2359296 mask 69657.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69657,69657 density 0.1450435086798723,0.1450435086798723
before tensor 1048576 mask 35729.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35729,35729 density 0.07552294710497835,0.07552294710497835
classifier.weight, mask/weight parameters,105272,105272 density 0.5140234375,0.5140234375
Total Model parameters after dst: 2349319 2349319
Total parameters under density level of 0.1: 0.23497927182119915 0.23497927182119915 after dst
Death rate: 0.10408824717848789

self.baseline_nonzero-self.total_nonzero 15884.200000001118
len(all_scores) 9997984 6668907
increse 15884.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1177,1176 density 0.6811342592592593,0.6805555555555556
before tensor 4096 mask 669.0 4096
layer1.0.conv1.weight, mask/weight parameters,669,667 density 0.22240691489361702,0.22174202127659576
before tensor 36864 mask 3660.0 36864
layer1.0.conv2.weight, mask/weight parameters,3660,3657 density 0.18409536743624566,0.1839444695940848
before tensor 16384 mask 3735.0 16384
layer1.0.conv3.weight, mask/weight parameters,3735,3727 density 0.3104222074468085,0.3097573138297872
layer1.0.shortcut.0.weight, mask/weight parameters,5592,5573 density 0.34130859375,0.34014892578125
before tensor 16384 mask 2412.0 16384
layer1.1.conv1.weight, mask/weight parameters,2412,2410 density 0.2004654255319149,0.2002992021276596
before tensor 36864 mask 3965.0 36864
layer1.1.conv2.weight, mask/weight parameters,3965,3959 density 0.1994366480559328,0.19913485237161108
before tensor 16384 mask 2185.0 16384
layer1.1.conv3.weight, mask/weight parameters,2185,2175 density 0.18159906914893617,0.1807679521276596
before tensor 16384 mask 2837.0 16384
layer1.2.conv1.weight, mask/weight parameters,2837,2837 density 0.23578789893617022,0.23578789893617022
before tensor 36864 mask 3426.0 36864
layer1.2.conv2.weight, mask/weight parameters,3426,3421 density 0.17232533574769882,0.17207383934409737
before tensor 16384 mask 1849.0 16384
layer1.2.conv3.weight, mask/weight parameters,1849,1845 density 0.15367353723404256,0.15334109042553193
before tensor 32768 mask 5294.0 32768
layer2.0.conv1.weight, mask/weight parameters,5294,5293 density 0.2757291666666667,0.27567708333333335
before tensor 147456 mask 12413.0 147456
layer2.0.conv2.weight, mask/weight parameters,12413,12394 density 0.24519506172839506,0.24481975308641976
before tensor 65536 mask 6847.0 65536
layer2.0.conv3.weight, mask/weight parameters,6847,6824 density 0.17830729166666667,0.17770833333333333
layer2.0.shortcut.0.weight, mask/weight parameters,29455,29394 density 0.22472381591796875,0.2242584228515625
before tensor 65536 mask 3562.0 65536
layer2.1.conv1.weight, mask/weight parameters,3562,3551 density 0.09276041666666666,0.09247395833333333
before tensor 147456 mask 4165.0 147456
layer2.1.conv2.weight, mask/weight parameters,4165,4151 density 0.08227160493827161,0.08199506172839506
before tensor 65536 mask 4158.0 65536
layer2.1.conv3.weight, mask/weight parameters,4158,4149 density 0.10828125,0.108046875
before tensor 65536 mask 10318.0 65536
layer2.2.conv1.weight, mask/weight parameters,10318,10282 density 0.26869791666666665,0.26776041666666667
before tensor 147456 mask 21147.0 147456
layer2.2.conv2.weight, mask/weight parameters,21147,21057 density 0.41771851851851854,0.4159407407407407
before tensor 65536 mask 13125.0 65536
layer2.2.conv3.weight, mask/weight parameters,13125,13058 density 0.341796875,0.3400520833333333
before tensor 65536 mask 10582.0 65536
layer2.3.conv1.weight, mask/weight parameters,10582,10518 density 0.27557291666666667,0.27390625
before tensor 147456 mask 20133.0 147456
layer2.3.conv2.weight, mask/weight parameters,20133,20099 density 0.39768888888888887,0.3970172839506173
before tensor 65536 mask 10909.0 65536
layer2.3.conv3.weight, mask/weight parameters,10909,10868 density 0.2840885416666667,0.28302083333333333
before tensor 131072 mask 29634.0 131072
layer3.0.conv1.weight, mask/weight parameters,29634,29338 density 0.4557394192913386,0.45118725393700787
before tensor 589824 mask 60935.0 589824
layer3.0.conv2.weight, mask/weight parameters,60935,60669 density 0.41977528399501246,0.41794283588567177
before tensor 262144 mask 57542.0 262144
layer3.0.conv3.weight, mask/weight parameters,57542,57251 density 0.4424673966535433,0.4402297613188976
layer3.0.shortcut.0.weight, mask/weight parameters,96032,95699 density 0.18316650390625,0.18253135681152344
before tensor 262144 mask 28064.0 262144
layer3.1.conv1.weight, mask/weight parameters,28064,27617 density 0.2157972440944882,0.21236005167322836
before tensor 589824 mask 61725.0 589824
layer3.1.conv2.weight, mask/weight parameters,61725,60413 density 0.42521751710170086,0.41617927680299804
before tensor 262144 mask 53238.0 262144
layer3.1.conv3.weight, mask/weight parameters,53238,52691 density 0.40937192421259844,0.4051657849409449
before tensor 262144 mask 30127.0 262144
layer3.2.conv1.weight, mask/weight parameters,30127,29882 density 0.23166061761811024,0.22977669783464566
before tensor 589824 mask 53020.0 589824
layer3.2.conv2.weight, mask/weight parameters,53020,52702 density 0.36524961938812767,0.3630589483401189
before tensor 262144 mask 50943.0 262144
layer3.2.conv3.weight, mask/weight parameters,50943,50634 density 0.391724593996063,0.38934854822834647
before tensor 262144 mask 33940.0 262144
layer3.3.conv1.weight, mask/weight parameters,33940,33657 density 0.26098056102362205,0.25880444143700787
before tensor 589824 mask 48104.0 589824
layer3.3.conv2.weight, mask/weight parameters,48104,47764 density 0.33138377387865886,0.32904154697198285
before tensor 262144 mask 44065.0 262144
layer3.3.conv3.weight, mask/weight parameters,44065,43813 density 0.33883642962598426,0.33689868356299213
before tensor 262144 mask 39378.0 262144
layer3.4.conv1.weight, mask/weight parameters,39378,39064 density 0.3027958907480315,0.30038139763779526
before tensor 589824 mask 49512.0 589824
layer3.4.conv2.weight, mask/weight parameters,49512,49197 density 0.34108334883336433,0.33891334449335564
before tensor 262144 mask 41393.0 262144
layer3.4.conv3.weight, mask/weight parameters,41393,41005 density 0.3182901697834646,0.315306656003937
before tensor 262144 mask 46136.0 262144
layer3.5.conv1.weight, mask/weight parameters,46136,45539 density 0.3547613188976378,0.3501707062007874
before tensor 589824 mask 49223.0 589824
layer3.5.conv2.weight, mask/weight parameters,49223,48855 density 0.3390924559626897,0.3365573397813462
before tensor 262144 mask 40127.0 262144
layer3.5.conv3.weight, mask/weight parameters,40127,39857 density 0.3085553026574803,0.3064791461614173
before tensor 524288 mask 137667.0 524288
layer4.0.conv1.weight, mask/weight parameters,137667,136831 density 0.5819932021103896,0.5784589759199135
before tensor 2359296 mask 196899.0 2359296
layer4.0.conv2.weight, mask/weight parameters,196899,195776 density 0.4099935658377217,0.40765519553398344
before tensor 1048576 mask 103692.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103692,103021 density 0.21918120941558442,0.21776286864177488
layer4.0.shortcut.0.weight, mask/weight parameters,137101,136526 density 0.06537485122680664,0.06510066986083984
before tensor 1048576 mask 119813.0 1048576
layer4.1.conv1.weight, mask/weight parameters,119813,118755 density 0.25325732210497837,0.25102095170454547
before tensor 2359296 mask 196491.0 2359296
layer4.1.conv2.weight, mask/weight parameters,196491,194924 density 0.40914400654660393,0.40588111583782577
before tensor 1048576 mask 83524.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83524,83123 density 0.17655066287878787,0.1757030404491342
before tensor 1048576 mask 81874.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81874,80973 density 0.17306293966450217,0.17115843141233766
before tensor 2359296 mask 70226.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70226,69657 density 0.14622831073047524,0.1450435086798723
before tensor 1048576 mask 35859.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35859,35729 density 0.07579773741883117,0.07552294710497835
classifier.weight, mask/weight parameters,105303,105272 density 0.5141748046875,0.5140234375
Total Model parameters after dst: 2365202 2349319
Total parameters under density level of 0.1: 0.23656789208704473 0.23497927182119915 after dst
Death rate: 0.10408824717848789


Training summary: Average loss: 0.0440, Accuracy: 49663/50000 (99.326%)


Evaluation: Average loss: 0.9964, Accuracy: 7647/10000 (76.470%)

Current learning rate: 0.001. Time taken for epoch: 88.71 seconds.

Train Epoch: 154 [0/50000 (0%)]	Loss: 0.030104 Accuracy: 100/100 (100.000%
Train Epoch: 154 [10000/50000 (20%)]	Loss: 0.081161 Accuracy: 10043/10100 (99.436%
Train Epoch: 154 [20000/50000 (40%)]	Loss: 0.031216 Accuracy: 19978/20100 (99.393%
Train Epoch: 154 [30000/50000 (60%)]	Loss: 0.034535 Accuracy: 29911/30100 (99.372%
Train Epoch: 154 [40000/50000 (80%)]	Loss: 0.024173 Accuracy: 39844/40100 (99.362%

Training summary: Average loss: 0.0432, Accuracy: 49680/50000 (99.360%)


Evaluation: Average loss: 1.0103, Accuracy: 7624/10000 (76.240%)

Current learning rate: 0.001. Time taken for epoch: 88.38 seconds.

Train Epoch: 155 [0/50000 (0%)]	Loss: 0.034614 Accuracy: 99/100 (99.000%
Train Epoch: 155 [10000/50000 (20%)]	Loss: 0.057839 Accuracy: 10032/10100 (99.327%
Train Epoch: 155 [20000/50000 (40%)]	Loss: 0.025461 Accuracy: 19970/20100 (99.353%
Train Epoch: 155 [30000/50000 (60%)]	Loss: 0.040398 Accuracy: 29911/30100 (99.372%
Train Epoch: 155 [40000/50000 (80%)]	Loss: 0.054851 Accuracy: 39843/40100 (99.359%
current dst rate 0.005762959901050607


dynamic sparse change
conv1.weight, mask/weight parameters,1174,1174 density 0.6793981481481481,0.6793981481481481
before tensor 4096 mask 666.0 4096
layer1.0.conv1.weight, mask/weight parameters,666,666 density 0.2214095744680851,0.2214095744680851
before tensor 36864 mask 3655.0 36864
layer1.0.conv2.weight, mask/weight parameters,3655,3655 density 0.18384387103264424,0.18384387103264424
before tensor 16384 mask 3724.0 16384
layer1.0.conv3.weight, mask/weight parameters,3724,3724 density 0.30950797872340424,0.30950797872340424
layer1.0.shortcut.0.weight, mask/weight parameters,5579,5579 density 0.34051513671875,0.34051513671875
before tensor 16384 mask 2410.0 16384
layer1.1.conv1.weight, mask/weight parameters,2410,2410 density 0.2002992021276596,0.2002992021276596
before tensor 36864 mask 3958.0 36864
layer1.1.conv2.weight, mask/weight parameters,3958,3958 density 0.1990845530908908,0.1990845530908908
before tensor 16384 mask 2177.0 16384
layer1.1.conv3.weight, mask/weight parameters,2177,2177 density 0.1809341755319149,0.1809341755319149
before tensor 16384 mask 2826.0 16384
layer1.2.conv1.weight, mask/weight parameters,2826,2826 density 0.23487367021276595,0.23487367021276595
before tensor 36864 mask 3420.0 36864
layer1.2.conv2.weight, mask/weight parameters,3420,3420 density 0.17202354006337708,0.17202354006337708
before tensor 16384 mask 1846.0 16384
layer1.2.conv3.weight, mask/weight parameters,1846,1846 density 0.1534242021276596,0.1534242021276596
before tensor 32768 mask 5283.0 32768
layer2.0.conv1.weight, mask/weight parameters,5283,5283 density 0.27515625,0.27515625
before tensor 147456 mask 12401.0 147456
layer2.0.conv2.weight, mask/weight parameters,12401,12401 density 0.24495802469135802,0.24495802469135802
before tensor 65536 mask 6832.0 65536
layer2.0.conv3.weight, mask/weight parameters,6832,6832 density 0.17791666666666667,0.17791666666666667
layer2.0.shortcut.0.weight, mask/weight parameters,29404,29404 density 0.224334716796875,0.224334716796875
before tensor 65536 mask 3554.0 65536
layer2.1.conv1.weight, mask/weight parameters,3554,3554 density 0.09255208333333333,0.09255208333333333
before tensor 147456 mask 4150.0 147456
layer2.1.conv2.weight, mask/weight parameters,4150,4150 density 0.0819753086419753,0.0819753086419753
before tensor 65536 mask 4141.0 65536
layer2.1.conv3.weight, mask/weight parameters,4141,4141 density 0.10783854166666666,0.10783854166666666
before tensor 65536 mask 10294.0 65536
layer2.2.conv1.weight, mask/weight parameters,10294,10294 density 0.26807291666666666,0.26807291666666666
before tensor 147456 mask 21093.0 147456
layer2.2.conv2.weight, mask/weight parameters,21093,21093 density 0.41665185185185183,0.41665185185185183
before tensor 65536 mask 13088.0 65536
layer2.2.conv3.weight, mask/weight parameters,13088,13088 density 0.3408333333333333,0.3408333333333333
before tensor 65536 mask 10532.0 65536
layer2.3.conv1.weight, mask/weight parameters,10532,10532 density 0.27427083333333335,0.27427083333333335
before tensor 147456 mask 20096.0 147456
layer2.3.conv2.weight, mask/weight parameters,20096,20096 density 0.39695802469135805,0.39695802469135805
before tensor 65536 mask 10879.0 65536
layer2.3.conv3.weight, mask/weight parameters,10879,10879 density 0.2833072916666667,0.2833072916666667
before tensor 131072 mask 29440.0 131072
layer3.0.conv1.weight, mask/weight parameters,29440,29440 density 0.452755905511811,0.452755905511811
before tensor 589824 mask 60748.0 589824
layer3.0.conv2.weight, mask/weight parameters,60748,60748 density 0.4184870591963406,0.4184870591963406
before tensor 262144 mask 57291.0 262144
layer3.0.conv3.weight, mask/weight parameters,57291,57291 density 0.4405373400590551,0.4405373400590551
layer3.0.shortcut.0.weight, mask/weight parameters,95712,95712 density 0.18255615234375,0.18255615234375
before tensor 262144 mask 27842.0 262144
layer3.1.conv1.weight, mask/weight parameters,27842,27842 density 0.21409018208661418,0.21409018208661418
before tensor 589824 mask 60972.0 589824
layer3.1.conv2.weight, mask/weight parameters,60972,60972 density 0.4200301733936801,0.4200301733936801
before tensor 262144 mask 52819.0 262144
layer3.1.conv3.weight, mask/weight parameters,52819,52819 density 0.40615003690944884,0.40615003690944884
before tensor 262144 mask 29939.0 262144
layer3.2.conv1.weight, mask/weight parameters,29939,29939 density 0.23021499753937008,0.23021499753937008
before tensor 589824 mask 52741.0 589824
layer3.2.conv2.weight, mask/weight parameters,52741,52741 density 0.36332761554411996,0.36332761554411996
before tensor 262144 mask 50648.0 262144
layer3.2.conv3.weight, mask/weight parameters,50648,50648 density 0.38945620078740156,0.38945620078740156
before tensor 262144 mask 33719.0 262144
layer3.3.conv1.weight, mask/weight parameters,33719,33719 density 0.25928118848425197,0.25928118848425197
before tensor 589824 mask 47799.0 589824
layer3.3.conv2.weight, mask/weight parameters,47799,47799 density 0.32928265856531713,0.32928265856531713
before tensor 262144 mask 43766.0 262144
layer3.3.conv3.weight, mask/weight parameters,43766,43766 density 0.33653727854330706,0.33653727854330706
before tensor 262144 mask 39125.0 262144
layer3.4.conv1.weight, mask/weight parameters,39125,39125 density 0.3008504552165354,0.3008504552165354
before tensor 589824 mask 49227.0 589824
layer3.4.conv2.weight, mask/weight parameters,49227,49227 density 0.3391200115733565,0.3391200115733565
before tensor 262144 mask 41091.0 262144
layer3.4.conv3.weight, mask/weight parameters,41091,41091 density 0.3159679502952756,0.3159679502952756
before tensor 262144 mask 45720.0 262144
layer3.5.conv1.weight, mask/weight parameters,45720,45720 density 0.3515625,0.3515625
before tensor 589824 mask 48880.0 589824
layer3.5.conv2.weight, mask/weight parameters,48880,48880 density 0.3367295623480136,0.3367295623480136
before tensor 262144 mask 39854.0 262144
layer3.5.conv3.weight, mask/weight parameters,39854,39854 density 0.3064560777559055,0.3064560777559055
before tensor 524288 mask 136867.0 524288
layer4.0.conv1.weight, mask/weight parameters,136867,136867 density 0.578611167478355,0.578611167478355
before tensor 2359296 mask 195682.0 2359296
layer4.0.conv2.weight, mask/weight parameters,195682,195682 density 0.40745946373652003,0.40745946373652003
before tensor 1048576 mask 103065.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103065,103065 density 0.21785587459415584,0.21785587459415584
layer4.0.shortcut.0.weight, mask/weight parameters,136588,136588 density 0.06513023376464844,0.06513023376464844
before tensor 1048576 mask 118802.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118802,118802 density 0.25112029897186144,0.25112029897186144
before tensor 2359296 mask 194963.0 2359296
layer4.1.conv2.weight, mask/weight parameters,194963,194963 density 0.40596232371124147,0.40596232371124147
before tensor 1048576 mask 83120.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83120,83120 density 0.17569669913419914,0.17569669913419914
before tensor 1048576 mask 81153.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81153,81153 density 0.17153891030844157,0.17153891030844157
before tensor 2359296 mask 69789.0 2359296
layer4.2.conv2.weight, mask/weight parameters,69789,69789 density 0.1453183660975869,0.1453183660975869
before tensor 1048576 mask 35755.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35755,35755 density 0.07557790516774891,0.07557790516774891
classifier.weight, mask/weight parameters,105273,105273 density 0.5140283203125,0.5140283203125
Total Model parameters after dst: 2351572 2351572
Total parameters under density level of 0.1: 0.23520461725083777 0.23520461725083777 after dst
Death rate: 0.10477457587492235

self.baseline_nonzero-self.total_nonzero 13631.200000001118
len(all_scores) 9997984 6666694
increse 13631.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1175,1174 density 0.6799768518518519,0.6793981481481481
before tensor 4096 mask 667.0 4096
layer1.0.conv1.weight, mask/weight parameters,667,666 density 0.22174202127659576,0.2214095744680851
before tensor 36864 mask 3656.0 36864
layer1.0.conv2.weight, mask/weight parameters,3656,3655 density 0.18389417031336452,0.18384387103264424
before tensor 16384 mask 3724.0 16384
layer1.0.conv3.weight, mask/weight parameters,3724,3724 density 0.30950797872340424,0.30950797872340424
layer1.0.shortcut.0.weight, mask/weight parameters,5590,5579 density 0.3411865234375,0.34051513671875
before tensor 16384 mask 2411.0 16384
layer1.1.conv1.weight, mask/weight parameters,2411,2410 density 0.20038231382978725,0.2002992021276596
before tensor 36864 mask 3960.0 36864
layer1.1.conv2.weight, mask/weight parameters,3960,3958 density 0.19918515165233136,0.1990845530908908
before tensor 16384 mask 2180.0 16384
layer1.1.conv3.weight, mask/weight parameters,2180,2177 density 0.18118351063829788,0.1809341755319149
before tensor 16384 mask 2826.0 16384
layer1.2.conv1.weight, mask/weight parameters,2826,2826 density 0.23487367021276595,0.23487367021276595
before tensor 36864 mask 3420.0 36864
layer1.2.conv2.weight, mask/weight parameters,3420,3420 density 0.17202354006337708,0.17202354006337708
before tensor 16384 mask 1848.0 16384
layer1.2.conv3.weight, mask/weight parameters,1848,1846 density 0.1535904255319149,0.1534242021276596
before tensor 32768 mask 5283.0 32768
layer2.0.conv1.weight, mask/weight parameters,5283,5283 density 0.27515625,0.27515625
before tensor 147456 mask 12402.0 147456
layer2.0.conv2.weight, mask/weight parameters,12402,12401 density 0.24497777777777777,0.24495802469135802
before tensor 65536 mask 6834.0 65536
layer2.0.conv3.weight, mask/weight parameters,6834,6832 density 0.17796875,0.17791666666666667
layer2.0.shortcut.0.weight, mask/weight parameters,29408,29404 density 0.224365234375,0.224334716796875
before tensor 65536 mask 3555.0 65536
layer2.1.conv1.weight, mask/weight parameters,3555,3554 density 0.092578125,0.09255208333333333
before tensor 147456 mask 4150.0 147456
layer2.1.conv2.weight, mask/weight parameters,4150,4150 density 0.0819753086419753,0.0819753086419753
before tensor 65536 mask 4141.0 65536
layer2.1.conv3.weight, mask/weight parameters,4141,4141 density 0.10783854166666666,0.10783854166666666
before tensor 65536 mask 10295.0 65536
layer2.2.conv1.weight, mask/weight parameters,10295,10294 density 0.26809895833333336,0.26807291666666666
before tensor 147456 mask 21102.0 147456
layer2.2.conv2.weight, mask/weight parameters,21102,21093 density 0.4168296296296296,0.41665185185185183
before tensor 65536 mask 13107.0 65536
layer2.2.conv3.weight, mask/weight parameters,13107,13088 density 0.341328125,0.3408333333333333
before tensor 65536 mask 10534.0 65536
layer2.3.conv1.weight, mask/weight parameters,10534,10532 density 0.2743229166666667,0.27427083333333335
before tensor 147456 mask 20104.0 147456
layer2.3.conv2.weight, mask/weight parameters,20104,20096 density 0.39711604938271605,0.39695802469135805
before tensor 65536 mask 10883.0 65536
layer2.3.conv3.weight, mask/weight parameters,10883,10879 density 0.2834114583333333,0.2833072916666667
before tensor 131072 mask 29459.0 131072
layer3.0.conv1.weight, mask/weight parameters,29459,29440 density 0.45304810531496065,0.452755905511811
before tensor 589824 mask 60779.0 589824
layer3.0.conv2.weight, mask/weight parameters,60779,60748 density 0.41870061517900814,0.4184870591963406
before tensor 262144 mask 57476.0 262144
layer3.0.conv3.weight, mask/weight parameters,57476,57291 density 0.44195989173228345,0.4405373400590551
layer3.0.shortcut.0.weight, mask/weight parameters,95843,95712 density 0.18280601501464844,0.18255615234375
before tensor 262144 mask 27934.0 262144
layer3.1.conv1.weight, mask/weight parameters,27934,27842 density 0.2147976131889764,0.21409018208661418
before tensor 589824 mask 61472.0 589824
layer3.1.conv2.weight, mask/weight parameters,61472,60972 density 0.42347462472702724,0.4200301733936801
before tensor 262144 mask 53171.0 262144
layer3.1.conv3.weight, mask/weight parameters,53171,52819 density 0.40885672982283466,0.40615003690944884
before tensor 262144 mask 30015.0 262144
layer3.2.conv1.weight, mask/weight parameters,30015,29939 density 0.2307993971456693,0.23021499753937008
before tensor 589824 mask 52848.0 589824
layer3.2.conv2.weight, mask/weight parameters,52848,52741 density 0.3640647281294563,0.36332761554411996
before tensor 262144 mask 50849.0 262144
layer3.2.conv3.weight, mask/weight parameters,50849,50648 density 0.39100178395669294,0.38945620078740156
before tensor 262144 mask 33792.0 262144
layer3.3.conv1.weight, mask/weight parameters,33792,33719 density 0.25984251968503935,0.25928118848425197
before tensor 589824 mask 47924.0 589824
layer3.3.conv2.weight, mask/weight parameters,47924,47799 density 0.3301437713986539,0.32928265856531713
before tensor 262144 mask 43995.0 262144
layer3.3.conv3.weight, mask/weight parameters,43995,43766 density 0.3382981668307087,0.33653727854330706
before tensor 262144 mask 39345.0 262144
layer3.4.conv1.weight, mask/weight parameters,39345,39125 density 0.30254213828740156,0.3008504552165354
before tensor 589824 mask 49460.0 589824
layer3.4.conv2.weight, mask/weight parameters,49460,49227 density 0.3407251258946962,0.3391200115733565
before tensor 262144 mask 41286.0 262144
layer3.4.conv3.weight, mask/weight parameters,41286,41091 density 0.3174673966535433,0.3159679502952756
before tensor 262144 mask 46134.0 262144
layer3.5.conv1.weight, mask/weight parameters,46134,45720 density 0.3547459399606299,0.3515625
before tensor 589824 mask 49119.0 589824
layer3.5.conv2.weight, mask/weight parameters,49119,48880 density 0.3383760100853535,0.3367295623480136
before tensor 262144 mask 40020.0 262144
layer3.5.conv3.weight, mask/weight parameters,40020,39854 density 0.30773252952755903,0.3064560777559055
before tensor 524288 mask 137622.0 524288
layer4.0.conv1.weight, mask/weight parameters,137622,136867 density 0.5818029626623377,0.578611167478355
before tensor 2359296 mask 196698.0 2359296
layer4.0.conv2.weight, mask/weight parameters,196698,195682 density 0.4095750329516563,0.40745946373652003
before tensor 1048576 mask 103682.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103682,103065 density 0.2191600716991342,0.21785587459415584
layer4.0.shortcut.0.weight, mask/weight parameters,137133,136588 density 0.06539011001586914,0.06513023376464844
before tensor 1048576 mask 120172.0 1048576
layer4.1.conv1.weight, mask/weight parameters,120172,118802 density 0.2540161661255411,0.25112029897186144
before tensor 2359296 mask 197402.0 2359296
layer4.1.conv2.weight, mask/weight parameters,197402,194963 density 0.4110409391794673,0.40596232371124147
before tensor 1048576 mask 83677.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83677,83120 density 0.1768740699404762,0.17569669913419914
before tensor 1048576 mask 82586.0 1048576
layer4.2.conv1.weight, mask/weight parameters,82586,81153 density 0.17456794507575757,0.17153891030844157
before tensor 2359296 mask 70893.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70893,69789 density 0.14761717359119955,0.1453183660975869
before tensor 1048576 mask 35858.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35858,35755 density 0.07579562364718614,0.07557790516774891
classifier.weight, mask/weight parameters,105303,105273 density 0.5141748046875,0.5140283203125
Total Model parameters after dst: 2365202 2351572
Total parameters under density level of 0.1: 0.23656789208704473 0.23520461725083777 after dst
Death rate: 0.10477457587492235


Training summary: Average loss: 0.0424, Accuracy: 49678/50000 (99.356%)


Evaluation: Average loss: 1.0086, Accuracy: 7630/10000 (76.300%)

Current learning rate: 0.001. Time taken for epoch: 88.73 seconds.

Train Epoch: 156 [0/50000 (0%)]	Loss: 0.036995 Accuracy: 100/100 (100.000%
Train Epoch: 156 [10000/50000 (20%)]	Loss: 0.037079 Accuracy: 10048/10100 (99.485%
Train Epoch: 156 [20000/50000 (40%)]	Loss: 0.035219 Accuracy: 19999/20100 (99.498%
Train Epoch: 156 [30000/50000 (60%)]	Loss: 0.019087 Accuracy: 29931/30100 (99.439%
Train Epoch: 156 [40000/50000 (80%)]	Loss: 0.044119 Accuracy: 39885/40100 (99.464%

Training summary: Average loss: 0.0407, Accuracy: 49721/50000 (99.442%)


Evaluation: Average loss: 1.0089, Accuracy: 7670/10000 (76.700%)

Current learning rate: 0.001. Time taken for epoch: 88.39 seconds.

Train Epoch: 157 [0/50000 (0%)]	Loss: 0.057545 Accuracy: 100/100 (100.000%
Train Epoch: 157 [10000/50000 (20%)]	Loss: 0.036857 Accuracy: 10033/10100 (99.337%
Train Epoch: 157 [20000/50000 (40%)]	Loss: 0.031953 Accuracy: 19972/20100 (99.363%
Train Epoch: 157 [30000/50000 (60%)]	Loss: 0.059075 Accuracy: 29934/30100 (99.449%
Train Epoch: 157 [40000/50000 (80%)]	Loss: 0.048155 Accuracy: 39882/40100 (99.456%
current dst rate 0.00519081353042102


dynamic sparse change
conv1.weight, mask/weight parameters,1174,1174 density 0.6793981481481481,0.6793981481481481
before tensor 4096 mask 667.0 4096
layer1.0.conv1.weight, mask/weight parameters,667,667 density 0.22174202127659576,0.22174202127659576
before tensor 36864 mask 3653.0 36864
layer1.0.conv2.weight, mask/weight parameters,3653,3653 density 0.18374327247120367,0.18374327247120367
before tensor 16384 mask 3715.0 16384
layer1.0.conv3.weight, mask/weight parameters,3715,3715 density 0.3087599734042553,0.3087599734042553
layer1.0.shortcut.0.weight, mask/weight parameters,5570,5570 density 0.3399658203125,0.3399658203125
before tensor 16384 mask 2405.0 16384
layer1.1.conv1.weight, mask/weight parameters,2405,2405 density 0.19988364361702127,0.19988364361702127
before tensor 36864 mask 3956.0 36864
layer1.1.conv2.weight, mask/weight parameters,3956,3956 density 0.19898395452945022,0.19898395452945022
before tensor 16384 mask 2173.0 16384
layer1.1.conv3.weight, mask/weight parameters,2173,2173 density 0.18060172872340424,0.18060172872340424
before tensor 16384 mask 2819.0 16384
layer1.2.conv1.weight, mask/weight parameters,2819,2819 density 0.23429188829787234,0.23429188829787234
before tensor 36864 mask 3416.0 36864
layer1.2.conv2.weight, mask/weight parameters,3416,3416 density 0.17182234294049595,0.17182234294049595
before tensor 16384 mask 1845.0 16384
layer1.2.conv3.weight, mask/weight parameters,1845,1845 density 0.15334109042553193,0.15334109042553193
before tensor 32768 mask 5271.0 32768
layer2.0.conv1.weight, mask/weight parameters,5271,5271 density 0.27453125,0.27453125
before tensor 147456 mask 12390.0 147456
layer2.0.conv2.weight, mask/weight parameters,12390,12390 density 0.24474074074074073,0.24474074074074073
before tensor 65536 mask 6823.0 65536
layer2.0.conv3.weight, mask/weight parameters,6823,6823 density 0.17768229166666666,0.17768229166666666
layer2.0.shortcut.0.weight, mask/weight parameters,29366,29366 density 0.2240447998046875,0.2240447998046875
before tensor 65536 mask 3548.0 65536
layer2.1.conv1.weight, mask/weight parameters,3548,3548 density 0.09239583333333333,0.09239583333333333
before tensor 147456 mask 4141.0 147456
layer2.1.conv2.weight, mask/weight parameters,4141,4141 density 0.08179753086419753,0.08179753086419753
before tensor 65536 mask 4131.0 65536
layer2.1.conv3.weight, mask/weight parameters,4131,4131 density 0.107578125,0.107578125
before tensor 65536 mask 10275.0 65536
layer2.2.conv1.weight, mask/weight parameters,10275,10275 density 0.267578125,0.267578125
before tensor 147456 mask 21070.0 147456
layer2.2.conv2.weight, mask/weight parameters,21070,21070 density 0.41619753086419753,0.41619753086419753
before tensor 65536 mask 13077.0 65536
layer2.2.conv3.weight, mask/weight parameters,13077,13077 density 0.340546875,0.340546875
before tensor 65536 mask 10513.0 65536
layer2.3.conv1.weight, mask/weight parameters,10513,10513 density 0.2737760416666667,0.2737760416666667
before tensor 147456 mask 20075.0 147456
layer2.3.conv2.weight, mask/weight parameters,20075,20075 density 0.39654320987654323,0.39654320987654323
before tensor 65536 mask 10863.0 65536
layer2.3.conv3.weight, mask/weight parameters,10863,10863 density 0.282890625,0.282890625
before tensor 131072 mask 29350.0 131072
layer3.0.conv1.weight, mask/weight parameters,29350,29350 density 0.4513718011811024,0.4513718011811024
before tensor 589824 mask 60686.0 589824
layer3.0.conv2.weight, mask/weight parameters,60686,60686 density 0.4180599472310056,0.4180599472310056
before tensor 262144 mask 57252.0 262144
layer3.0.conv3.weight, mask/weight parameters,57252,57252 density 0.44023745078740156,0.44023745078740156
layer3.0.shortcut.0.weight, mask/weight parameters,95646,95646 density 0.18243026733398438,0.18243026733398438
before tensor 262144 mask 27777.0 262144
layer3.1.conv1.weight, mask/weight parameters,27777,27777 density 0.21359036663385828,0.21359036663385828
before tensor 589824 mask 60943.0 589824
layer3.1.conv2.weight, mask/weight parameters,60943,60943 density 0.41983039521634596,0.41983039521634596
before tensor 262144 mask 52815.0 262144
layer3.1.conv3.weight, mask/weight parameters,52815,52815 density 0.40611927903543305,0.40611927903543305
before tensor 262144 mask 29879.0 262144
layer3.2.conv1.weight, mask/weight parameters,29879,29879 density 0.22975362942913385,0.22975362942913385
before tensor 589824 mask 52672.0 589824
layer3.2.conv2.weight, mask/weight parameters,52672,52672 density 0.3628522812601181,0.3628522812601181
before tensor 262144 mask 50615.0 262144
layer3.2.conv3.weight, mask/weight parameters,50615,50615 density 0.38920244832677164,0.38920244832677164
before tensor 262144 mask 33660.0 262144
layer3.3.conv1.weight, mask/weight parameters,33660,33660 density 0.2588275098425197,0.2588275098425197
before tensor 589824 mask 47722.0 589824
layer3.3.conv2.weight, mask/weight parameters,47722,47722 density 0.3287522130599817,0.3287522130599817
before tensor 262144 mask 43748.0 262144
layer3.3.conv3.weight, mask/weight parameters,43748,43748 density 0.3363988681102362,0.3363988681102362
before tensor 262144 mask 39104.0 262144
layer3.4.conv1.weight, mask/weight parameters,39104,39104 density 0.3006889763779528,0.3006889763779528
before tensor 589824 mask 49228.0 589824
layer3.4.conv2.weight, mask/weight parameters,49228,49228 density 0.3391269004760232,0.3391269004760232
before tensor 262144 mask 41052.0 262144
layer3.4.conv3.weight, mask/weight parameters,41052,41052 density 0.31566806102362205,0.31566806102362205
before tensor 262144 mask 45820.0 262144
layer3.5.conv1.weight, mask/weight parameters,45820,45820 density 0.3523314468503937,0.3523314468503937
before tensor 589824 mask 48845.0 589824
layer3.5.conv2.weight, mask/weight parameters,48845,48845 density 0.3364884507546793,0.3364884507546793
before tensor 262144 mask 39825.0 262144
layer3.5.conv3.weight, mask/weight parameters,39825,39825 density 0.3062330831692913,0.3062330831692913
before tensor 524288 mask 136937.0 524288
layer4.0.conv1.weight, mask/weight parameters,136937,136937 density 0.578907095508658,0.578907095508658
before tensor 2359296 mask 195755.0 2359296
layer4.0.conv2.weight, mask/weight parameters,195755,195755 density 0.4076114682175288,0.4076114682175288
before tensor 1048576 mask 103112.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103112,103112 density 0.21795522186147187,0.21795522186147187
layer4.0.shortcut.0.weight, mask/weight parameters,136619,136619 density 0.06514501571655273,0.06514501571655273
before tensor 1048576 mask 119091.0 1048576
layer4.1.conv1.weight, mask/weight parameters,119091,119091 density 0.2517311789772727,0.2517311789772727
before tensor 2359296 mask 195689.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195689,195689 density 0.40747403950867156,0.40747403950867156
before tensor 1048576 mask 83270.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83270,83270 density 0.17601376488095238,0.17601376488095238
before tensor 1048576 mask 81653.0 1048576
layer4.2.conv1.weight, mask/weight parameters,81653,81653 density 0.17259579613095238,0.17259579613095238
before tensor 2359296 mask 70177.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70177,70177 density 0.14612628032541453,0.14612628032541453
before tensor 1048576 mask 35772.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35772,35772 density 0.07561383928571429,0.07561383928571429
classifier.weight, mask/weight parameters,105275,105275 density 0.5140380859375,0.5140380859375
Total Model parameters after dst: 2352925 2352925
Total parameters under density level of 0.1: 0.2353399445328178 0.2353399445328178 after dst
Death rate: 0.10550814199553304

self.baseline_nonzero-self.total_nonzero 12278.200000001118
len(all_scores) 9997984 6665416
increse 12278.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1175,1174 density 0.6799768518518519,0.6793981481481481
before tensor 4096 mask 670.0 4096
layer1.0.conv1.weight, mask/weight parameters,670,667 density 0.22273936170212766,0.22174202127659576
before tensor 36864 mask 3655.0 36864
layer1.0.conv2.weight, mask/weight parameters,3655,3653 density 0.18384387103264424,0.18374327247120367
before tensor 16384 mask 3716.0 16384
layer1.0.conv3.weight, mask/weight parameters,3716,3715 density 0.308843085106383,0.3087599734042553
layer1.0.shortcut.0.weight, mask/weight parameters,5578,5570 density 0.3404541015625,0.3399658203125
before tensor 16384 mask 2405.0 16384
layer1.1.conv1.weight, mask/weight parameters,2405,2405 density 0.19988364361702127,0.19988364361702127
before tensor 36864 mask 3956.0 36864
layer1.1.conv2.weight, mask/weight parameters,3956,3956 density 0.19898395452945022,0.19898395452945022
before tensor 16384 mask 2174.0 16384
layer1.1.conv3.weight, mask/weight parameters,2174,2173 density 0.18068484042553193,0.18060172872340424
before tensor 16384 mask 2833.0 16384
layer1.2.conv1.weight, mask/weight parameters,2833,2819 density 0.2354554521276596,0.23429188829787234
before tensor 36864 mask 3418.0 36864
layer1.2.conv2.weight, mask/weight parameters,3418,3416 density 0.17192294150193652,0.17182234294049595
before tensor 16384 mask 1845.0 16384
layer1.2.conv3.weight, mask/weight parameters,1845,1845 density 0.15334109042553193,0.15334109042553193
before tensor 32768 mask 5280.0 32768
layer2.0.conv1.weight, mask/weight parameters,5280,5271 density 0.275,0.27453125
before tensor 147456 mask 12394.0 147456
layer2.0.conv2.weight, mask/weight parameters,12394,12390 density 0.24481975308641976,0.24474074074074073
before tensor 65536 mask 6829.0 65536
layer2.0.conv3.weight, mask/weight parameters,6829,6823 density 0.17783854166666666,0.17768229166666666
layer2.0.shortcut.0.weight, mask/weight parameters,29374,29366 density 0.2241058349609375,0.2240447998046875
before tensor 65536 mask 3548.0 65536
layer2.1.conv1.weight, mask/weight parameters,3548,3548 density 0.09239583333333333,0.09239583333333333
before tensor 147456 mask 4141.0 147456
layer2.1.conv2.weight, mask/weight parameters,4141,4141 density 0.08179753086419753,0.08179753086419753
before tensor 65536 mask 4135.0 65536
layer2.1.conv3.weight, mask/weight parameters,4135,4131 density 0.10768229166666667,0.107578125
before tensor 65536 mask 10290.0 65536
layer2.2.conv1.weight, mask/weight parameters,10290,10275 density 0.26796875,0.267578125
before tensor 147456 mask 21081.0 147456
layer2.2.conv2.weight, mask/weight parameters,21081,21070 density 0.4164148148148148,0.41619753086419753
before tensor 65536 mask 13096.0 65536
layer2.2.conv3.weight, mask/weight parameters,13096,13077 density 0.3410416666666667,0.340546875
before tensor 65536 mask 10526.0 65536
layer2.3.conv1.weight, mask/weight parameters,10526,10513 density 0.27411458333333333,0.2737760416666667
before tensor 147456 mask 20085.0 147456
layer2.3.conv2.weight, mask/weight parameters,20085,20075 density 0.3967407407407407,0.39654320987654323
before tensor 65536 mask 10875.0 65536
layer2.3.conv3.weight, mask/weight parameters,10875,10863 density 0.283203125,0.282890625
before tensor 131072 mask 29428.0 131072
layer3.0.conv1.weight, mask/weight parameters,29428,29350 density 0.45257135826771655,0.4513718011811024
before tensor 589824 mask 60712.0 589824
layer3.0.conv2.weight, mask/weight parameters,60712,60686 density 0.4182390587003396,0.4180599472310056
before tensor 262144 mask 57360.0 262144
layer3.0.conv3.weight, mask/weight parameters,57360,57252 density 0.4410679133858268,0.44023745078740156
layer3.0.shortcut.0.weight, mask/weight parameters,95734,95646 density 0.18259811401367188,0.18243026733398438
before tensor 262144 mask 27907.0 262144
layer3.1.conv1.weight, mask/weight parameters,27907,27777 density 0.21458999753937008,0.21359036663385828
before tensor 589824 mask 61245.0 589824
layer3.1.conv2.weight, mask/weight parameters,61245,60943 density 0.42191084382168764,0.41983039521634596
before tensor 262144 mask 53272.0 262144
layer3.1.conv3.weight, mask/weight parameters,53272,52815 density 0.4096333661417323,0.40611927903543305
before tensor 262144 mask 30023.0 262144
layer3.2.conv1.weight, mask/weight parameters,30023,29879 density 0.23086091289370078,0.22975362942913385
before tensor 589824 mask 52833.0 589824
layer3.2.conv2.weight, mask/weight parameters,52833,52672 density 0.36396139458945587,0.3628522812601181
before tensor 262144 mask 50818.0 262144
layer3.2.conv3.weight, mask/weight parameters,50818,50615 density 0.3907634104330709,0.38920244832677164
before tensor 262144 mask 33976.0 262144
layer3.3.conv1.weight, mask/weight parameters,33976,33660 density 0.2612573818897638,0.2588275098425197
before tensor 589824 mask 48157.0 589824
layer3.3.conv2.weight, mask/weight parameters,48157,47722 density 0.33174888571999367,0.3287522130599817
before tensor 262144 mask 44022.0 262144
layer3.3.conv3.weight, mask/weight parameters,44022,43748 density 0.338505782480315,0.3363988681102362
before tensor 262144 mask 39269.0 262144
layer3.4.conv1.weight, mask/weight parameters,39269,39104 density 0.3019577386811024,0.3006889763779528
before tensor 589824 mask 49443.0 589824
layer3.4.conv2.weight, mask/weight parameters,49443,49228 density 0.34060801454936246,0.3391269004760232
before tensor 262144 mask 41264.0 262144
layer3.4.conv3.weight, mask/weight parameters,41264,41052 density 0.3172982283464567,0.31566806102362205
before tensor 262144 mask 46224.0 262144
layer3.5.conv1.weight, mask/weight parameters,46224,45820 density 0.35543799212598426,0.3523314468503937
before tensor 589824 mask 49053.0 589824
layer3.5.conv2.weight, mask/weight parameters,49053,48845 density 0.3379213425093517,0.3364884507546793
before tensor 262144 mask 40058.0 262144
layer3.5.conv3.weight, mask/weight parameters,40058,39825 density 0.3080247293307087,0.3062330831692913
before tensor 524288 mask 137612.0 524288
layer4.0.conv1.weight, mask/weight parameters,137612,136937 density 0.5817606872294372,0.578907095508658
before tensor 2359296 mask 196666.0 2359296
layer4.0.conv2.weight, mask/weight parameters,196666,195755 density 0.4095084008503922,0.4076114682175288
before tensor 1048576 mask 103741.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103741,103112 density 0.21928478422619047,0.21795522186147187
layer4.0.shortcut.0.weight, mask/weight parameters,137223,136619 density 0.06543302536010742,0.06514501571655273
before tensor 1048576 mask 119803.0 1048576
layer4.1.conv1.weight, mask/weight parameters,119803,119091 density 0.25323618438852813,0.2517311789772727
before tensor 2359296 mask 197119.0 2359296
layer4.1.conv2.weight, mask/weight parameters,197119,195689 density 0.4104516615339126,0.40747403950867156
before tensor 1048576 mask 83584.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83584,83270 density 0.17667748917748918,0.17601376488095238
before tensor 1048576 mask 83104.0 1048576
layer4.2.conv1.weight, mask/weight parameters,83104,81653 density 0.17566287878787878,0.17259579613095238
before tensor 2359296 mask 71191.0 2359296
layer4.2.conv2.weight, mask/weight parameters,71191,70177 density 0.14823768503422183,0.14612628032541453
before tensor 1048576 mask 35973.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35973,35772 density 0.07603870738636363,0.07561383928571429
classifier.weight, mask/weight parameters,105309,105275 density 0.5142041015625,0.5140380859375
Total Model parameters after dst: 2365202 2352925
Total parameters under density level of 0.1: 0.23656789208704473 0.2353399445328178 after dst
Death rate: 0.10550814199553304


Training summary: Average loss: 0.0404, Accuracy: 49719/50000 (99.438%)


Evaluation: Average loss: 1.0042, Accuracy: 7665/10000 (76.650%)

Current learning rate: 0.001. Time taken for epoch: 88.72 seconds.

Train Epoch: 158 [0/50000 (0%)]	Loss: 0.067219 Accuracy: 98/100 (98.000%
Train Epoch: 158 [10000/50000 (20%)]	Loss: 0.043586 Accuracy: 10038/10100 (99.386%
Train Epoch: 158 [20000/50000 (40%)]	Loss: 0.030821 Accuracy: 19979/20100 (99.398%
Train Epoch: 158 [30000/50000 (60%)]	Loss: 0.017610 Accuracy: 29922/30100 (99.409%
Train Epoch: 158 [40000/50000 (80%)]	Loss: 0.044765 Accuracy: 39861/40100 (99.404%

Training summary: Average loss: 0.0405, Accuracy: 49707/50000 (99.414%)


Evaluation: Average loss: 0.9987, Accuracy: 7643/10000 (76.430%)

Current learning rate: 0.001. Time taken for epoch: 88.37 seconds.

Train Epoch: 159 [0/50000 (0%)]	Loss: 0.043631 Accuracy: 98/100 (98.000%
Train Epoch: 159 [10000/50000 (20%)]	Loss: 0.042276 Accuracy: 10052/10100 (99.525%
Train Epoch: 159 [20000/50000 (40%)]	Loss: 0.021491 Accuracy: 20003/20100 (99.517%
Train Epoch: 159 [30000/50000 (60%)]	Loss: 0.031405 Accuracy: 29941/30100 (99.472%
Train Epoch: 159 [40000/50000 (80%)]	Loss: 0.025748 Accuracy: 39869/40100 (99.424%
current dst rate 0.005


dynamic sparse change
conv1.weight, mask/weight parameters,1172,1172 density 0.6782407407407407,0.6782407407407407
before tensor 4096 mask 669.0 4096
layer1.0.conv1.weight, mask/weight parameters,669,669 density 0.22240691489361702,0.22240691489361702
before tensor 36864 mask 3653.0 36864
layer1.0.conv2.weight, mask/weight parameters,3653,3653 density 0.18374327247120367,0.18374327247120367
before tensor 16384 mask 3707.0 16384
layer1.0.conv3.weight, mask/weight parameters,3707,3707 density 0.30809507978723405,0.30809507978723405
layer1.0.shortcut.0.weight, mask/weight parameters,5565,5565 density 0.33966064453125,0.33966064453125
before tensor 16384 mask 2403.0 16384
layer1.1.conv1.weight, mask/weight parameters,2403,2403 density 0.19971742021276595,0.19971742021276595
before tensor 36864 mask 3951.0 36864
layer1.1.conv2.weight, mask/weight parameters,3951,3951 density 0.1987324581258488,0.1987324581258488
before tensor 16384 mask 2169.0 16384
layer1.1.conv3.weight, mask/weight parameters,2169,2169 density 0.1802692819148936,0.1802692819148936
before tensor 16384 mask 2826.0 16384
layer1.2.conv1.weight, mask/weight parameters,2826,2826 density 0.23487367021276595,0.23487367021276595
before tensor 36864 mask 3412.0 36864
layer1.2.conv2.weight, mask/weight parameters,3412,3412 density 0.1716211458176148,0.1716211458176148
before tensor 16384 mask 1840.0 16384
layer1.2.conv3.weight, mask/weight parameters,1840,1840 density 0.1529255319148936,0.1529255319148936
before tensor 32768 mask 5271.0 32768
layer2.0.conv1.weight, mask/weight parameters,5271,5271 density 0.27453125,0.27453125
before tensor 147456 mask 12380.0 147456
layer2.0.conv2.weight, mask/weight parameters,12380,12380 density 0.2445432098765432,0.2445432098765432
before tensor 65536 mask 6821.0 65536
layer2.0.conv3.weight, mask/weight parameters,6821,6821 density 0.17763020833333334,0.17763020833333334
layer2.0.shortcut.0.weight, mask/weight parameters,29346,29346 density 0.2238922119140625,0.2238922119140625
before tensor 65536 mask 3540.0 65536
layer2.1.conv1.weight, mask/weight parameters,3540,3540 density 0.0921875,0.0921875
before tensor 147456 mask 4137.0 147456
layer2.1.conv2.weight, mask/weight parameters,4137,4137 density 0.08171851851851852,0.08171851851851852
before tensor 65536 mask 4132.0 65536
layer2.1.conv3.weight, mask/weight parameters,4132,4132 density 0.10760416666666667,0.10760416666666667
before tensor 65536 mask 10274.0 65536
layer2.2.conv1.weight, mask/weight parameters,10274,10274 density 0.26755208333333336,0.26755208333333336
before tensor 147456 mask 21050.0 147456
layer2.2.conv2.weight, mask/weight parameters,21050,21050 density 0.4158024691358025,0.4158024691358025
before tensor 65536 mask 13069.0 65536
layer2.2.conv3.weight, mask/weight parameters,13069,13069 density 0.34033854166666666,0.34033854166666666
before tensor 65536 mask 10502.0 65536
layer2.3.conv1.weight, mask/weight parameters,10502,10502 density 0.27348958333333334,0.27348958333333334
before tensor 147456 mask 20056.0 147456
layer2.3.conv2.weight, mask/weight parameters,20056,20056 density 0.3961679012345679,0.3961679012345679
before tensor 65536 mask 10860.0 65536
layer2.3.conv3.weight, mask/weight parameters,10860,10860 density 0.2828125,0.2828125
before tensor 131072 mask 29337.0 131072
layer3.0.conv1.weight, mask/weight parameters,29337,29337 density 0.451171875,0.451171875
before tensor 589824 mask 60627.0 589824
layer3.0.conv2.weight, mask/weight parameters,60627,60627 density 0.4176535019736706,0.4176535019736706
before tensor 262144 mask 57178.0 262144
layer3.0.conv3.weight, mask/weight parameters,57178,57178 density 0.43966843011811024,0.43966843011811024
layer3.0.shortcut.0.weight, mask/weight parameters,95545,95545 density 0.1822376251220703,0.1822376251220703
before tensor 262144 mask 27772.0 262144
layer3.1.conv1.weight, mask/weight parameters,27772,27772 density 0.21355191929133857,0.21355191929133857
before tensor 589824 mask 60827.0 589824
layer3.1.conv2.weight, mask/weight parameters,60827,60827 density 0.41903128250700944,0.41903128250700944
before tensor 262144 mask 52900.0 262144
layer3.1.conv3.weight, mask/weight parameters,52900,52900 density 0.4067728838582677,0.4067728838582677
before tensor 262144 mask 29875.0 262144
layer3.2.conv1.weight, mask/weight parameters,29875,29875 density 0.2297228715551181,0.2297228715551181
before tensor 589824 mask 52637.0 589824
layer3.2.conv2.weight, mask/weight parameters,52637,52637 density 0.36261116966678375,0.36261116966678375
before tensor 262144 mask 50605.0 262144
layer3.2.conv3.weight, mask/weight parameters,50605,50605 density 0.3891255536417323,0.3891255536417323
before tensor 262144 mask 33791.0 262144
layer3.3.conv1.weight, mask/weight parameters,33791,33791 density 0.2598348302165354,0.2598348302165354
before tensor 589824 mask 47855.0 589824
layer3.3.conv2.weight, mask/weight parameters,47855,47855 density 0.329668437114652,0.329668437114652
before tensor 262144 mask 43784.0 262144
layer3.3.conv3.weight, mask/weight parameters,43784,43784 density 0.33667568897637795,0.33667568897637795
before tensor 262144 mask 39055.0 262144
layer3.4.conv1.weight, mask/weight parameters,39055,39055 density 0.30031219242125984,0.30031219242125984
before tensor 589824 mask 49189.0 589824
layer3.4.conv2.weight, mask/weight parameters,49189,49189 density 0.3388582332720221,0.3388582332720221
before tensor 262144 mask 41057.0 262144
layer3.4.conv3.weight, mask/weight parameters,41057,41057 density 0.3157065083661417,0.3157065083661417
before tensor 262144 mask 45901.0 262144
layer3.5.conv1.weight, mask/weight parameters,45901,45901 density 0.3529542937992126,0.3529542937992126
before tensor 589824 mask 48846.0 589824
layer3.5.conv2.weight, mask/weight parameters,48846,48846 density 0.33649533965734596,0.33649533965734596
before tensor 262144 mask 39816.0 262144
layer3.5.conv3.weight, mask/weight parameters,39816,39816 density 0.3061638779527559,0.3061638779527559
before tensor 524288 mask 136968.0 524288
layer4.0.conv1.weight, mask/weight parameters,136968,136968 density 0.5790381493506493,0.5790381493506493
before tensor 2359296 mask 195772.0 2359296
layer4.0.conv2.weight, mask/weight parameters,195772,195772 density 0.40764686652132537,0.40764686652132537
before tensor 1048576 mask 103197.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103197,103197 density 0.2181348924512987,0.2181348924512987
layer4.0.shortcut.0.weight, mask/weight parameters,136641,136641 density 0.0651555061340332,0.0651555061340332
before tensor 1048576 mask 118946.0 1048576
layer4.1.conv1.weight, mask/weight parameters,118946,118946 density 0.2514246820887446,0.2514246820887446
before tensor 2359296 mask 195632.0 2359296
layer4.1.conv2.weight, mask/weight parameters,195632,195632 density 0.4073553510782948,0.4073553510782948
before tensor 1048576 mask 83277.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83277,83277 density 0.17602856128246752,0.17602856128246752
before tensor 1048576 mask 82013.0 1048576
layer4.2.conv1.weight, mask/weight parameters,82013,82013 density 0.17335675392316016,0.17335675392316016
before tensor 2359296 mask 70406.0 2359296
layer4.2.conv2.weight, mask/weight parameters,70406,70406 density 0.146603116300086,0.146603116300086
before tensor 1048576 mask 35850.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35850,35850 density 0.07577871347402597,0.07577871347402597
classifier.weight, mask/weight parameters,105272,105272 density 0.5140234375,0.5140234375
Total Model parameters after dst: 2353376 2353376
Total parameters under density level of 0.1: 0.23538505362681117 0.23538505362681117 after dst
Death rate: 0.10628723226265466

self.baseline_nonzero-self.total_nonzero 11827.200000001118
len(all_scores) 9997984 6664848
increse 11827.0 before_mask 2365202.0 after_mask 2365202.0
total_nonzero_new None
self.total_removed None
conv1.weight, mask/weight parameters,1174,1172 density 0.6793981481481481,0.6782407407407407
before tensor 4096 mask 670.0 4096
layer1.0.conv1.weight, mask/weight parameters,670,669 density 0.22273936170212766,0.22240691489361702
before tensor 36864 mask 3656.0 36864
layer1.0.conv2.weight, mask/weight parameters,3656,3653 density 0.18389417031336452,0.18374327247120367
before tensor 16384 mask 3710.0 16384
layer1.0.conv3.weight, mask/weight parameters,3710,3707 density 0.308344414893617,0.30809507978723405
layer1.0.shortcut.0.weight, mask/weight parameters,5571,5565 density 0.34002685546875,0.33966064453125
before tensor 16384 mask 2403.0 16384
layer1.1.conv1.weight, mask/weight parameters,2403,2403 density 0.19971742021276595,0.19971742021276595
before tensor 36864 mask 3951.0 36864
layer1.1.conv2.weight, mask/weight parameters,3951,3951 density 0.1987324581258488,0.1987324581258488
before tensor 16384 mask 2173.0 16384
layer1.1.conv3.weight, mask/weight parameters,2173,2169 density 0.18060172872340424,0.1802692819148936
before tensor 16384 mask 2832.0 16384
layer1.2.conv1.weight, mask/weight parameters,2832,2826 density 0.23537234042553193,0.23487367021276595
before tensor 36864 mask 3415.0 36864
layer1.2.conv2.weight, mask/weight parameters,3415,3412 density 0.17177204365977566,0.1716211458176148
before tensor 16384 mask 1841.0 16384
layer1.2.conv3.weight, mask/weight parameters,1841,1840 density 0.15300864361702127,0.1529255319148936
before tensor 32768 mask 5296.0 32768
layer2.0.conv1.weight, mask/weight parameters,5296,5271 density 0.2758333333333333,0.27453125
before tensor 147456 mask 12381.0 147456
layer2.0.conv2.weight, mask/weight parameters,12381,12380 density 0.24456296296296295,0.2445432098765432
before tensor 65536 mask 6823.0 65536
layer2.0.conv3.weight, mask/weight parameters,6823,6821 density 0.17768229166666666,0.17763020833333334
layer2.0.shortcut.0.weight, mask/weight parameters,29349,29346 density 0.22391510009765625,0.2238922119140625
before tensor 65536 mask 3540.0 65536
layer2.1.conv1.weight, mask/weight parameters,3540,3540 density 0.0921875,0.0921875
before tensor 147456 mask 4139.0 147456
layer2.1.conv2.weight, mask/weight parameters,4139,4137 density 0.08175802469135802,0.08171851851851852
before tensor 65536 mask 4133.0 65536
layer2.1.conv3.weight, mask/weight parameters,4133,4132 density 0.10763020833333334,0.10760416666666667
before tensor 65536 mask 10280.0 65536
layer2.2.conv1.weight, mask/weight parameters,10280,10274 density 0.2677083333333333,0.26755208333333336
before tensor 147456 mask 21062.0 147456
layer2.2.conv2.weight, mask/weight parameters,21062,21050 density 0.4160395061728395,0.4158024691358025
before tensor 65536 mask 13076.0 65536
layer2.2.conv3.weight, mask/weight parameters,13076,13069 density 0.34052083333333333,0.34033854166666666
before tensor 65536 mask 10507.0 65536
layer2.3.conv1.weight, mask/weight parameters,10507,10502 density 0.27361979166666667,0.27348958333333334
before tensor 147456 mask 20062.0 147456
layer2.3.conv2.weight, mask/weight parameters,20062,20056 density 0.3962864197530864,0.3961679012345679
before tensor 65536 mask 10874.0 65536
layer2.3.conv3.weight, mask/weight parameters,10874,10860 density 0.28317708333333336,0.2828125
before tensor 131072 mask 29368.0 131072
layer3.0.conv1.weight, mask/weight parameters,29368,29337 density 0.4516486220472441,0.451171875
before tensor 589824 mask 60669.0 589824
layer3.0.conv2.weight, mask/weight parameters,60669,60627 density 0.41794283588567177,0.4176535019736706
before tensor 262144 mask 57365.0 262144
layer3.0.conv3.weight, mask/weight parameters,57365,57178 density 0.44110636072834647,0.43966843011811024
layer3.0.shortcut.0.weight, mask/weight parameters,95719,95545 density 0.1825695037841797,0.1822376251220703
before tensor 262144 mask 27878.0 262144
layer3.1.conv1.weight, mask/weight parameters,27878,27772 density 0.2143670029527559,0.21355191929133857
before tensor 589824 mask 61232.0 589824
layer3.1.conv2.weight, mask/weight parameters,61232,60827 density 0.42182128808702063,0.41903128250700944
before tensor 262144 mask 53326.0 262144
layer3.1.conv3.weight, mask/weight parameters,53326,52900 density 0.4100485974409449,0.4067728838582677
before tensor 262144 mask 30131.0 262144
layer3.2.conv1.weight, mask/weight parameters,30131,29875 density 0.23169137549212598,0.2297228715551181
before tensor 589824 mask 53109.0 589824
layer3.2.conv2.weight, mask/weight parameters,53109,52637 density 0.36586273172546346,0.36261116966678375
before tensor 262144 mask 51108.0 262144
layer3.2.conv3.weight, mask/weight parameters,51108,50605 density 0.3929933562992126,0.3891255536417323
before tensor 262144 mask 33992.0 262144
layer3.3.conv1.weight, mask/weight parameters,33992,33791 density 0.2613804133858268,0.2598348302165354
before tensor 589824 mask 48075.0 589824
layer3.3.conv2.weight, mask/weight parameters,48075,47855 density 0.33118399570132473,0.329668437114652
before tensor 262144 mask 44114.0 262144
layer3.3.conv3.weight, mask/weight parameters,44114,43784 density 0.33921321358267714,0.33667568897637795
before tensor 262144 mask 39447.0 262144
layer3.4.conv1.weight, mask/weight parameters,39447,39055 density 0.3033264640748031,0.30031219242125984
before tensor 589824 mask 49474.0 589824
layer3.4.conv2.weight, mask/weight parameters,49474,49189 density 0.34082157053202994,0.3388582332720221
before tensor 262144 mask 41208.0 262144
layer3.4.conv3.weight, mask/weight parameters,41208,41057 density 0.3168676181102362,0.3157065083661417
before tensor 262144 mask 46469.0 262144
layer3.5.conv1.weight, mask/weight parameters,46469,45901 density 0.35732191190944884,0.3529542937992126
before tensor 589824 mask 49377.0 589824
layer3.5.conv2.weight, mask/weight parameters,49377,48846 density 0.34015334697336064,0.33649533965734596
before tensor 262144 mask 40132.0 262144
layer3.5.conv3.weight, mask/weight parameters,40132,39816 density 0.30859375,0.3061638779527559
before tensor 524288 mask 137718.0 524288
layer4.0.conv1.weight, mask/weight parameters,137718,136968 density 0.5822088068181818,0.5790381493506493
before tensor 2359296 mask 196670.0 2359296
layer4.0.conv2.weight, mask/weight parameters,196670,195772 density 0.4095167298630502,0.40764686652132537
before tensor 1048576 mask 103618.0 1048576
layer4.0.conv3.weight, mask/weight parameters,103618,103197 density 0.2190247903138528,0.2181348924512987
layer4.0.shortcut.0.weight, mask/weight parameters,136993,136641 density 0.0653233528137207,0.0651555061340332
before tensor 1048576 mask 119605.0 1048576
layer4.1.conv1.weight, mask/weight parameters,119605,118946 density 0.25281765760281383,0.2514246820887446
before tensor 2359296 mask 196770.0 2359296
layer4.1.conv2.weight, mask/weight parameters,196770,195632 density 0.40972495517950064,0.4073553510782948
before tensor 1048576 mask 83553.0 1048576
layer4.1.conv3.weight, mask/weight parameters,83553,83277 density 0.1766119622564935,0.17602856128246752
before tensor 1048576 mask 82820.0 1048576
layer4.2.conv1.weight, mask/weight parameters,82820,82013 density 0.17506256764069264,0.17335675392316016
before tensor 2359296 mask 71093.0 2359296
layer4.2.conv2.weight, mask/weight parameters,71093,70406 density 0.1480336242241004,0.146603116300086
before tensor 1048576 mask 35952.0 1048576
layer4.2.conv3.weight, mask/weight parameters,35952,35850 density 0.07599431818181818,0.07577871347402597
classifier.weight, mask/weight parameters,105299,105272 density 0.5141552734375,0.5140234375
Total Model parameters after dst: 2365202 2353376
Total parameters under density level of 0.1: 0.23656789208704473 0.23538505362681117 after dst
Death rate: 0.10628723226265466


Training summary: Average loss: 0.0399, Accuracy: 49708/50000 (99.416%)


Evaluation: Average loss: 1.0147, Accuracy: 7635/10000 (76.350%)

Current learning rate: 0.001. Time taken for epoch: 88.74 seconds.

best_acc 0.767
before merge

Evaluation: Average loss: 0.9510, Accuracy: 7670/10000 (76.700%)

begin merge

Evaluation: Average loss: 0.9510, Accuracy: 7671/10000 (76.710%)

update bn

Evaluation: Average loss: 0.9427, Accuracy: 7654/10000 (76.540%)

ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(64, 47, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(47, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(47, 47, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(47, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(47, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(256, 47, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(47, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(47, 47, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(47, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(47, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(256, 47, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(47, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(47, 47, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(47, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(47, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(256, 75, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(75, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(75, 75, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(75, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(75, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(512, 75, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(75, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(75, 75, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(75, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(75, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(512, 75, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(75, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(75, 75, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(75, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(75, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (3): Bottleneck(
      (conv1): Conv2d(512, 75, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(75, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(75, 75, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(75, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(75, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(512, 127, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(127, 127, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(127, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(1024, 127, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(127, 127, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(127, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(1024, 127, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(127, 127, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(127, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (3): Bottleneck(
      (conv1): Conv2d(1024, 127, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(127, 127, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(127, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (4): Bottleneck(
      (conv1): Conv2d(1024, 127, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(127, 127, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(127, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (5): Bottleneck(
      (conv1): Conv2d(1024, 127, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(127, 127, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(127, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(1024, 231, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(231, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(231, 231, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(231, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(231, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(2048, 231, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(231, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(231, 231, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(231, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(231, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (2): Bottleneck(
      (conv1): Conv2d(2048, 231, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(231, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(231, 231, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(231, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(231, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (classifier): Linear(in_features=2048, out_features=100, bias=False)
)
Congs!! ALL DONE, GOOD JOB!!
